./ ADD NAME=BLKING   0113-81349-87071-1448-00012-00015-00000-LS02155
        PROC 0


        CONTROL NOMSG NOFLUSH


        /*   CALL 'WDPSC.SHARED.LOAD(PGMUSAGE)' '&STR(BLKING  ,2)'  */


        ISPEXEC CONTROL DISPLAY REFRESH


        ISPEXEC DISPLAY PANEL(BLKPANEL)


        IF &LASTCC > 0 THEN EXIT


        FREE DDN(SYSOUT)


        ALLOC DDN(SYSOUT) DSN(*)


        SET &LRECL = &LRECL + 10000000


        SET &FILESIZE = &FILESIZE + 1000000000


        CALL 'WDPSC.SHARED.LOAD(BLKING)' '&SUBSTR(2:8,&LRECL)&SUBSTR(2:10,&FILES
IZE)'

        FREE DDN(SYSOUT)


./ ADD NAME=CATGET   0108-81322-83033-1807-00038-00009-00000-KK00150
        PROC 2 DSN CAT L


        CONTROL NOFLUSH MSG END(ENDO)


        IF &L = L THEN +


         CONTROL MSG LIST CONLIST SYMLIST


        IFALC F(VOLGET)


        IF &LASTCC = 0 THEN GOTO ONWIT


        ALLOC F(VOLGET) BLOCK(121) SP(10 10) NEW


        ONWIT: +


        GLOBAL RC VOL DEV


        SET RC = 0


        STACK DDOUT(VOLGET)


        LISTCAT ENT(&DSN) ALL CAT(&CAT)


        OPENFILE VOLGET


        GETFILE VOLGET


        IF &SUBSTR(1:7,&STR(&VOLGET)) NE &STR(NONVSAM) THEN DO


                    CLOSFILE VOLGET


                    SET RC = 12


                    EXIT CODE(12)


                                                            ENDO


        GETFILE VOLGET


        GETFILE VOLGET


        GETFILE VOLGET


        GETFILE VOLGET


        GETFILE VOLGET


        SET VOL = &SUBSTR(26:31,&STR(&VOLGET))


        SET DEV = &SUBSTR(58:59,&STR(&VOLGET))


        CLOSFILE VOLGET





        DEVTYPE VOL(&VOL)


        IF &LASTCC NE 0 THEN DO


              IF &SUBSTR(1:4,&VOL) = 3350 THEN DO


                                         SET &DEV = 3350


                                         EXIT


                                               ENDO


               SET RC = 8


               EXIT CODE(8)


                              ENDO


        SET &DEV = &STR(&DEVTYP)


./ ADD NAME=CENTER   0137-86245-86266-1316-00069-00030-00000-CG00150
        /*CLIST****************************************************************/


        /*   ISPF/PDF edit macro to center lines of text between the bounds.  */


        /*                                                                    */


        /*   To run:                                                          */


        /*    Enter CENTER on the COMMAND line and use the C line command     */


        /*    (in any form) to select the lines to be centered.               */


        /**********************************************************************/


        ISREDIT MACRO NOPROCESS


        CONTROL NOFLUSH NOMSG


        /*CONTROL LIST CONLIST SYMLIST





        GETMY SYSID


        IF &SYSID = H3AN THEN SET TYPSTR = &&STR


        IF &SYSID NE H3AN THEN SET TYPSTR = &&NRSTR





        ISREDIT (LEFTBND,RIGHTBND) = BOUNDS


        ISREDIT (LRECL) = DATA_WIDTH


        SET BNDSIZE = &EVAL(&RIGHTBND-&LEFTBND+1)





        /* PROCESS LINE COMMANDS, CHECK IF C  WAS SPECIFIED */


        ISREDIT PROCESS RANGE C


        SET RC = &LASTCC


        IF &RC >= 16 THEN +


        SET CODE(12)  /* LINE COMMAND CONFLICT - EDIT WILL CREATE MES
SAGE

        ELSE IF &RC >= 4 THEN +


        DO


          /* MISSING C LINE COMMAND */


          SET ZEDSMSG = &STR(ENTER "C" LINE CMD)


          SET ZEDLMSG = &STR(SPECIFY THE LINES TO BE CENTRED WITH THE " C" COMMA
ND)

          ISPEXEC SETMSG MSG(ISRZ001)


          EXIT CODE(12)


        END





        ISREDIT (ZFRANGE) = LINENUM .ZFRANGE


        ISREDIT (ZLRANGE) = LINENUM .ZLRANGE


        SET I = &ZFRANGE





        DO WHILE &I <= &ZLRANGE


        /* PUT THE LINE INTO THISLINE */


          ISREDIT (THISLINE) = LINE &I


          IF &LEFTBND = 1 THEN +


            SET LEFTPART = &TYPSTR()


          ELSE +


            SET LEFTPART = &SUBSTR(1:&EVAL(&LEFTBND-1),&THISLINE)


          SET MIDDLEPART = &SUBSTR(&LEFTBND:&EVAL+


                           (&BNDSIZE+&LEFTBND-1),&TYPSTR(&THISLINE))


             /*cg          (&BNDSIZE+&LEFTBND-1),&STR(&THISLINE))


          IF &RIGHTBND = &LRECL THEN +


            SET RIGHTPART = &TYPSTR()


          ELSE +


              SET RIGHTPART = &SUBSTR(&EVAL(&RIGHTBND+1):+


                              &LRECL,&TYPSTR(&THISLINE))


           /*cg               &LRECL,&STR(&THISLINE))





          SET STRING  = &TYPSTR(&MIDDLEPART)


          /*cg   SET STRING  = &STR(&MIDDLEPART)


          SET FLDSIZE = &BNDSIZE


          ISPEXEC VPUT (STRING,FLDSIZE) SHARED


          CENTRE


          ISPEXEC VGET (STRING) SHARED


          SET CENTERPART = &TYPSTR(&STRING)


          /*cg   SET CENTERPART = &STR(&STRING)


          SET NEWLINE = &TYPSTR(&LEFTPART)&TYPSTR(&CENTERPART)&TYPSTR(&RIGHTPART
)

   /*cg   SET NEWLINE = &STR(&LEFTPART)&STR(&CENTERPART)&STR(&RIGHTPART)


          /* REPLACE THE LINE WITH NEWLINE */


          ISREDIT LINE &I = (NEWLINE)


          SET I = &I+1


        END


        EXIT CODE(0)


./ ADD NAME=CHART    0111-84129-85280-1432-00287-00241-00062-KK00150
00010008PROC 0 DL(CHART.DATA) FL(CHART.FORMAT) IMPORT L NC D T K NLIB IPD +


00011011  PCG  PRIVATE IL(CHART.IMPORT) PAIRED IPNP SS(USER.TSO.GDDM.SYMBOLS)


00020000/* DL     SPECIFIES DATA LIBRARY                        */


00030000/* FL     SPECIFIES FORMAT LIBRARY                      */


00031000/* IL     SPECIFIES IMPORT LIBRARY                      */


00040000/* IMPORT ALLOWS CHART TO READ DATA FROM EXTERNAL FILE  */


00050000/* L      TURNS ON MSG LIST AND CONLIST                 */


00060000/* NC     EXITS BEFORE CHART CALL, ALLOWS TESTING       */


00070000/* D      DELETES LIBRARIES BEFORE TESTING ALLOCATION   */


00080000/* T      USES TSO TEST TO CALL CHART OR IMPORT         */


00090000/* K      USES ALTERNATE CHART FROM WDPSC.TSO.TESTLIB   */


00100000/* NLIB   ALLOWS EXECUTION OF CHART WITHOUT LIBRARIES   */


00110000/* IPD    USES DEFAULT IMPORT DATASET NAME W/O PROMPT   */


00110100/* IPNP   USES GIVEN   IMPORT DATASET NAME W/O PROMPT   */


00111000/* PRIVATE ALLOWS SHARING PREFIX BUT DIFFERENT LIBRARIES*/


00120000CONTROL NOFLUSH END(ENDO) NOMSG


00130000IF &L = L THEN CONTROL MSG LIST CONLIST


00130100IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


00130200   STACK


00130300   CLOG '&SYSDATE &SYSTIME &SYSICMD' U($$$@150) S


00131010IF &SYSPROC = TEST AND &SS EQ &STR(USER.TSO.GDDM.SYMBOLS) THEN +


00131110   SET &SS = &STR(USER.TSO.GDDM.SYMBOLS)


00131208IF &PRIVATE = PRIVATE AND &SYSPREF NE &SYSUID THEN DO


00132000  IF &DL = CHART.DATA THEN SET &DL = &SYSUID..CHART.DATA


00133000  IF &FL = CHART.FORMAT THEN SET &FL = &SYSUID..CHART.FORMAT


00133100  IF &IL = CHART.IMPORT THEN SET &IL = &SYSUID..CHART.IMPORT


00134000                                                ENDO


00140000IF &D = D THEN DEL (&DL &FL)


00150000FREE  ATTR(ADMAT)


00160000ATTR ADMAT RECFM(F) LRECL(400) BLK(400)


00170000


00180000/*** ALLOCATE SYMBOL SETS IF NOT ALREADY ALLOCATED    ***/


00190008IFALC FILE(ADMSYMBL) DSN('&SS')


00200000IF &LASTCC NE 0 THEN DO


00200100                     IFALC FILE(ADMSYMBL)


00200200                     IF &LASTCC = 0 THEN FREE F(ADMSYMBL)


00201008                     ALLOC F(ADMSYMBL) DSN('&SS')


00202000                     ENDO


00203000


00204000/*** ALLOCATE GEN MAPLIB  IF NOT ALREADY ALLOCATED    ***/


00205010IFALC FILE(ADMGGMAP) DSN('USER.TSO.GDDM.GENMAPS')


00206000IF &LASTCC NE 0 THEN DO


00207000                     IFALC FILE(ADMGGMAP)


00208000                     IF &LASTCC = 0 THEN FREE F(ADMGGMAP)


00209010                     ALLOC FI(ADMGGMAP) DSN('USER.TSO.GDDM.GENMAPS')


00209100                     ENDO


00210000


00220000/*** CHECK LIBRARIES FOR PRIOR ALLOCATION             ***/


00230000IF &NLIB EQ NLIB THEN GOTO CALLM              /* BYPASS LIB ALLOC   */


00240000  IFALC FILE(ADMCDATA) DA(&DL)                /* CHECK: IF BOTH     */


00250000  IF &LASTCC = 0 THEN DO                      /*  LIBRARIES HAVE    */


00260000       IFALC FILE(ADMCFORM) DA(&FL)           /*  ALREADY BEEN      */


00270000       IF &LASTCC =  0 THEN GOTO CALLM        /*  ALLOCATED,        */


00280000                      ENDO                    /*  BYPASS ALLOCATION */


00290000FREE F(ADMCDATA,ADMCFORM)


00300000


00310000DATASTAT &DL                                  /* CHECK: DO REQUESTD */


00320000 SET DLF = &LASTCC                            /*  LIBRARIES ALREADY */


00330000DATASTAT &FL                                  /*  EXIST?            */


00340000 SET FLF = &LASTCC


00350000IF &FLF = 0 AND &DLF = 0 THEN GOTO NORMAL     /* IF OKAY FOR CHART  */


00360000                                              /*  USE, CALL CHART   */


00370000IF &DLF NE 4 AND &DLF NE 0 THEN DO


00380000      WRITE ERROR WITH DATA LIBRARY: DATASTAT CODE &DLF


00390000      WRITE PLEASE CONTACT YOUR CHART CONSULTANT FOR HELP.


00400000      EXIT                                    /* IF DATA LIB THERE, */


00410000                                ENDO          /*  BUT NOT OK, EXIT  */


00420000IF &FLF NE 4 AND &FLF NE 0 THEN DO


00430000      WRITE ERROR WITH FORMAT LIBRARY: DATASTAT CODE &FLF


00440000      WRITE PLEASE CONTACT YOUR CHART CONSULTANT FOR HELP.


00450000      EXIT                                    /* IF FRMT LIB THERE, */


00460000                                ENDO          /*  BUT NOT OK, EXIT  */


00460100


00460200/*** DO EXTRA CHECKING FOR DSNS THE USER SPECIFIED:   ***/


00460401IF &DLF = 4  AND &DL NE CHART.DATA  THEN +


00460600    DO


00460700    DATASTAT '&DL'


00460800    IF &LASTCC = 0 THEN DO


00460900       SET &DL = &STR('&DL')


00461000       SET &DLF = 0


00461100                        ENDO


00461200    ENDO


00461300


00461401IF &FLF = 4  AND &FL NE CHART.FORMAT THEN +


00461600    DO


00461700    DATASTAT '&FL'


00461800    IF &LASTCC = 0 THEN DO


00461900       SET &FL = &STR('&FL')


00462000       SET &FLF = 0


00462100                        ENDO


00462200    ENDO


00462300


00462400IF &FLF = 0 AND &DLF = 0 THEN GOTO NORMAL     /* IF OKAY FOR CHART  */


00462500                                              /*  USE, CALL CHART   */


00470000KOMM CLEAR RESET


00480000


00490000/*** REQUEST VOLUME FOR LIBRARIES THAT DO NOT EXIST   ***/


00500000GVOLOOP: +


00510000IF &DLF = 4 AND &FLF = 4 THEN DO


00520000            WRITE ***  YOUR CHART LIBRARIES DO NOT EXIST.  ***


00530000            WRITE TO ALLOCATE THEM, ENTER ONE OF THE FOLLOWING:


00540000                              ENDO


00550000IF &DLF = 0 AND &FLF = 4 THEN DO


00560000            WRITE ***  YOUR FORMAT LIBRARY DOES NOT EXIST.  ***


00570000            WRITE TO ALLOCATE IT, ENTER ONE OF THE FOLLOWING:


00580000                              ENDO


00590000IF &DLF = 4 AND &FLF = 0 THEN DO


00600000            WRITE ***  YOUR DATA LIBRARY DOES NOT EXIST.  ***


00610000            WRITE TO ALLOCATE IT, ENTER ONE OF THE FOLLOWING:


00620000                              ENDO


00630000


00640000            WRITE    P - TO ALLOCATE AND KEEP INDEFINITELY.


00650000            WRITE    T - TO ALLOCATE AND KEEP FOR 3 DAYS.


00660000            WRITE YOU MAY ALSO ENTER A SPECIFIC VOLUME IF YOU WISH.


00670000             READ VOLP


00680003             IF &VOLP = P THEN DO


00681003                               SET VOL = TSOVOL


00682003                               SET DEVTYP = SYSDA


00683003                               GOTO NORMAL


00684003                               ENDO


00690000                          ELSE +


00700004             IF &VOLP = T THEN DO


00702004                               %DEFVOL


00702104                               SET VOL = &LASTCC


00703004                               ENDO


00710000                          ELSE SET VOL = &VOLP


00720000      DEVTYPE VOL(&VOL)


00730000      IF &LASTCC NE 0 THEN DO


00740000              WRITE '&VOLP' IS AN INVALID RESPONSE - PLEASE TRY AGAIN.


00750000              WRITE


00760000              GOTO GVOLOOP


00770000                           ENDO


00780000


00790000/*** ALLOCATE LIBRARIES THAT DO NOT EXIST             ***/


00800000NORMAL: +


00810000IF &DLF = 4 THEN DO


00820000      ALLOC F(ADMCDATA) DA(&DL) SP(3,3) TRACKS BLKSIZE(400) +


00830000            DIR(10) UNIT(&DEVTYP) VOL(&VOL) USING(ADMAT)


00840000      IF &LASTCC = 0 THEN +


00850000                   WRITE DATA LIBRARY &SYSPREF..&DL HAS BEEN ALLOCATED.


00860000                     ELSE DO


00870000                          WRITE ERROR CODE &LASTCC OCCURED


00880000                          WRITE IN ALLOCATION OF &SYSPREF..&DL


00890000                          WRITE PLEASE CONTACT YOUR CHART CONSULTANT.


00900000                          EXIT


00910000                          ENDO


00920000                 ENDO


00930000             ELSE ALLOC F(ADMCDATA) DA(&DL)


00940000IF &FLF = 4 THEN DO


00950000      ALLOC F(ADMCFORM) DA(&FL) SP(3,3) TRACKS BLKSIZE(400) +


00960000            DIR(10) UNIT(&DEVTYP) VOL(&VOL) USING(ADMAT)


00970000      IF &LASTCC = 0 THEN +


00980000                WRITE FORMAT LIBRARY &SYSPREF..&FL HAS BEEN ALLOCATED.


00990000                     ELSE DO


01000000                          WRITE ERROR CODE &LASTCC OCCURED


01010000                          WRITE IN ALLOCATION OF &SYSPREF..&FL


01020000                          WRITE PLEASE CONTACT YOUR CHART CONSULTANT.


01030000                          EXIT


01040000                          ENDO


01050000                 ENDO


01060000             ELSE ALLOC F(ADMCFORM) DA(&FL)


01070000IF &FLF = 4 OR &DLF = 4 THEN CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '2'


01080000


01100000CALLM: +


01111000IF &PAIRED = PAIRED THEN DO


01111100                         FILEINFO DSN(&DL) MEM(PAIRED)


01111200                         SET FRC = &LASTCC


01111300                         IF &FRC NE 0 AND &FRC NE 24 THEN DO


01111400                            WRITE FILEINFO ERROR &FRC WITH &DL :


01111500                            WRITE &OUTMSG


01111600                            CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '2'


01111700                            GOTO NOPAIR


01111800                                           ENDO


01111900                         IF &MEMFND = YES THEN GOTO NOPAIR


01112000                         COPY 'WDPSC.TSO.CHART.DATA(PAIRED)' '&FULLDSN(P
AIRED)' NONUM

01112100                         ENDO


01112200


01113000/*** CALL IMPORT VERSION OF CHART IF REQUESTED        ***/


01114000NOPAIR: +


01120000IF &IPD = IPD THEN DO


01130000                    IFALC F(DATA)


01140000                    IF &LASTCC = 0 THEN GOTO AFTALLOC


01150000                    SET &SYSDVAL = &STR(&IL)


01160000                    GOTO ALLOCIMP


01170000                   ENDO


01170100


01170200 SET &SYSDVAL = &STR(&IL)


01170300 IF &IL NE CHART.IMPORT AND &IL NE &SYSUID..CHART.IMPORT THEN +


01170400       GOTO ALLOCIMP


01170500 IF &IPNP = IPNP THEN GOTO ALLOCIMP


01170600


01171000IF &IMPORT EQ IMPORT THEN DO


01174000


01180000 ILNP: WRITE


01190000       WRITE ENTER NAME OF IMPORT DATA LIBRARY:


01200000       WRITE (JUST PRESS ENTER TO USE &SYSPREF..&IL)


01210000       READ


01220000       IF &SYSDVAL = &STR() THEN SET &SYSDVAL = &STR(&IL)


01220100       IF &SYSDVAL = &STR(TSO) THEN EXIT


01220200       IF &SYSDVAL = &STR(BYPASS) THEN GOTO NOIMPORT


01221000                          ENDO


01222000                     ELSE GOTO NOIMPORT


01223000


01230000ALLOCIMP: +


01280000       DATASTAT &SYSDVAL


01280100       SET ILF = &LASTCC


01280200       IF &ILF NE 0 THEN DO


01280300         IF &ILF = 4 AND &SYSDVAL NE CHART.IMPORT +


01280400                     AND &SYSDVAL NE &SYSUID..CHART.IMPORT THEN +


01280500            DO


01280600            DATASTAT '&SYSDVAL'


01280700            IF &LASTCC = 0 THEN DO


01280800                                SET &SYSDVAL = '&SYSDVAL'


01280900                                GOTO OKAI


01281000                                ENDO


01281100            ENDO


01281200         IF &ILF > 3 THEN WRITE IMPORT LIBRARY NOT FOUND.


01282000                     ELSE WRITE IMPORT LIBRARY IS WRONG TYPE DATASET.


01282500                 WRITE ENTER BYPASS TO GO DIRECTLY TO CHART,


01282600                 WRITE OR ENTER TSO TO RETURN TO TSO, OR


01282800                 GOTO ILNP


01284000                         ENDO


01290000OKAI:  IFALC F(DATA) DSN(&SYSDVAL)


01290100       IF &LASTCC = 0 THEN GOTO AFTALLOC


01290200       IFALC F(DATA)


01290300       IF &LASTCC = 0 THEN FREE F(DATA)


01291000       ALLOC F(DATA) DSN(&SYSDVAL)


01300000


01320000AFTALLOC: +


01321000       IF &NC EQ NC THEN EXIT


01330000       IF &K = K THEN DO


01340000               IF &T = T THEN TEST 'WDPSC.TSO.TESTLIB(ADMUSP6)'


01350000                         ELSE CALL 'WDPSC.TSO.TESTLIB(ADMUSP6)'


01360000                      EXIT


01370000                      ENDO


01380000       IF &T = T THEN TEST 'WDPSC.GDDM.GDDMLOAD(ADMUSP6)'


01390000                 ELSE CALL 'WDPSC.GDDM.GDDMLOAD(ADMUSP6)'


01400000       EXIT


01410000


01420000NOIMPORT: IF &NC EQ NC THEN EXIT


01430000


01440000/*** CALL NORMAL VERSION OF CHART                     ***/


01441009IF &K = K OR &SYSPROC = TEST THEN DO


01441108     IF &PCG = PCG THEN +


01441208                    CALL 'WDPSC.GDDMR4.GDDMLOAD(ADMUCDSO)'   +


01441308                               ' * * 1 1 * (21 1) ()'


01441408                   ELSE +


01442007     IF &T = T THEN TEST 'WDPSC.GDDMR4.GDDMLOAD(ADMCHART)'


01443007               ELSE CALL 'WDPSC.GDDMR4.GDDMLOAD(ADMCHART)'


01444006               GOTO CX


01445000                                  ENDO


01446010IF &PCG = PCG THEN +


01447010               CALL 'WDPSC.GDDM.GDDMLOAD(ADMUCDSO)'   +


01448010                          ' * * 1 1 * (21 1) ()'


01449010              ELSE +


01470000IF &T = T THEN TEST 'WDPSC.GDDM.GDDMLOAD(ADMCHART)'


01480000          ELSE CALL 'WDPSC.GDDM.GDDMLOAD(ADMCHART)'


01481005


01490006CX:   CONTROL NOMSG NOFLUSH


01500005      FREE F(INPDS,OUTMEMS)


01510005      CONTROL MSG


01520005      ALLOC F(INPDS) DA(&DL) SHR


01530005      ALLOC F(OUTMEMS) DUMMY


01540005      CALL 'WDPSC.SHARED.LOAD(LISTMEMS)'


01550005      SET &RC = &LASTCC


01560005      IF &RC EQ 8 THEN +


01561005          DO


01570005          WRITE DATASET &DL IS EMPTY


01580005          WRITE ENTER KEEP TO KEEP IT; PRESS ENTER TO DELETE IT.


01590005          READ


01600005          IF &SYSDVAL NE KEEP THEN DEL &DL


01610005          ENDO


01620005


01630005      CONTROL NOMSG NOFLUSH


01640005      FREE F(INPDS,OUTMEMS)


01650005      CONTROL MSG


01660005      ALLOC F(INPDS) DA(&FL) SHR


01670005      ALLOC F(OUTMEMS) DUMMY


01680005      CALL 'WDPSC.SHARED.LOAD(LISTMEMS)'


01690005      SET &RC = &LASTCC


01700005      IF &RC EQ 8 THEN +


01710005          DO


01720005          WRITE DATASET &FL IS EMPTY


01730005          WRITE ENTER KEEP TO KEEP IT; PRESS ENTER TO DELETE IT.


01740005          READ


01750006          IF &SYSDVAL NE KEEP THEN DEL &FL


01760005          ENDO


./ ADD NAME=CHDSCB   0103-77333-84009-1013-00030-00030-00009-KK00150
00010003PROC 1 DSN RECFM() LRECL() BL() DSORG() REC() LR() BLK() BLKSIZE() NOLIS
T

00020003IF &NOLIST = THEN LISTD &DSN


00030001CONTROL NOMSG END(ENDO)


00040000FREE F(REL) ATTR(KKKC)


00050001CONTROL MSG


00060000IF &REC.K NE K THEN SET &RECFM = &REC


00070000IF &LR.K NE K THEN SET &LRECL = &LR


00080000IF &BLK.K NE K THEN SET &BL = &BLK


00090000IF &BLKSIZE.K NE K THEN SET &BL = &BLKSIZE


00101003SET RF1 = &STR()


00102003SET RF2 = &STR()


00103003SET RF3 = &STR()


00110000SET &N = 1


00120000IF &RECFM.K = K THEN GOTO SKIPARS


00130000RFPARS: -


00140000IF &LENGTH(&RECFM.) GT 1 THEN DO


00150000                      SET &RF&N = &SUBSTR(1,&RECFM.)


00160000                      SET &RECFM = &SUBSTR(2:&LENGTH(&RECFM.),&RECFM.)


00170000                      SET &N = &N + 1


00180000                      GOTO RFPARS


00190000                              ENDO


00200000SET &RECFM = RECFM(&RF1 &RF2 &RF3 &RECFM.)


00210000SKIPARS: -


00220000IF &LRECL.K NE K THEN SET &LRECL = LRECL(&LRECL.)


00230000IF &BL.K    NE K THEN SET &BL    = BL(&BL.)


00240000IF &DSORG.K NE K THEN SET &DSORG = DSORG(&DSORG.)


00250000ATTR KKKC &RECFM &LRECL &BL &DSORG


00260000ALLOC F(REL) DA(&DSN.) MOD KEEP US(KKKC)


00270002CALL 'WDPSC.SYSLIBRY(RELSEQ)'


00280003IF &NOLIST = THEN LISTD &DSN


./ ADD NAME=CLERSCRN 0105-80329-85113-1608-00003-00008-00000-JS02150
            CALL 'WDPSC.SHARED.LOAD(TERMTYPE)'


            IF &LASTCC NE 0 THEN KOMM RESET CLEAR


                ELSE WRITE


./ ADD NAME=CLIB     0101-84242-85261-1059-00077-00074-00000-JS02150
                PROC 1 DSN  XLIB(NONE) PRINT()


                CONTROL NOMSG NOFLUSH END(ENDO)





                IF &PRINT = NO THEN SET &PRTOPT = &STR(NO)


                     ELSE SET &PRTOPT = &STR(YES)





                IF &STR(&XLIB) NE &STR(NONE) THEN %CLIB &XLIB PRINT(&PRTOPT)





                ERROR OFF





                FILEINFO DSN(&STR(&DSN))


                SET &RC = &LASTCC





                IF &RC EQ 96 THEN DO


                    WRITE


                    WRITE ERROR ===> INVALID SYNTAX OF DSNAME


                    GOTO ENDIT


                    ENDO





                IF &RC NE 0 THEN DO


                    WRITE


                    WRITE ERROR ===> &OUTMSG


                    GOTO ENDIT


                    ENDO





                IF &DSORG NE PO THEN DO


                    WRITE


                    WRITE ERROR ===> DATASET TO BE CONCATENATED IS NOT


                    WRITE            PARTITIONED DATASET


                    GOTO ENDIT


                    ENDO





                IF &MEMCNTL EQ YES THEN DO


                    WRITE


                    WRITE ERROR ===> DO NOT PROVIDE MEMBER NAME


                    GOTO ENDIT


                    ENDO





                IF &RECFM NE V THEN DO


                    WRITE


                    WRITE ERROR ===> &FULLDSN MUST CONTAIN


                    WRITE            VARIABLE LENGTH RECORDS


                    GOTO ENDIT


                    ENDO





                WHATDSN DDNAME(SYSPROC)


                SET &RC = &LASTCC





                IF &RC NE 0 THEN GOTO CONCATM





                IF &FULLDSN NE &DSNAME THEN GOTO CONCATM





                IF &PRINT = NO THEN GOTO ENDIT





                WRITE


                WRITE SUCCESSFUL COMPLETION


                WRITE        (BUT NO ACTION WAS TAKEN SINCE THE GIVEN


                WRITE         DATASET WAS ALREADY AT THE TOP OF THE STACK)


                GOTO ENDIT





         CONCATM: CONCATEM ACTCODE(A) DDNAME(SYSPROC) DSNAME('&FULLDSN')


                SET &RC = &LASTCC





                IF &PRINT = NO THEN GOTO ENDIT





                WRITE


                WRITE &OUTMSG


                WRITE        (RETURN CODE = &RC)





         ENDIT: IFALC FILE(SYSPROC)


                SET &RC = &LASTCC





                IF &RC = 0 THEN EXIT





                ALLOC F(SYSPROC) DA('WDPSC.MASTER.CLIST' 'USER.CLIST') SHR





                EXIT


./ ADD NAME=CMDOUT   0112-82348-84153-1711-00047-00005-00000-KK00150
        PROC 0 DDN(CMDOUT) FREE(NO) L PRC MOD USE(NONE) FORCE CYL


        CONTROL NOMSG NOFLUSH END(ENDO)


        IF &L = L THEN CONTROL MSG LIST CONLIST


        IF &FREE NE NO THEN DO


                            FREE F(CMD&FREE)


                            EXIT


                            ENDO


        IF &CYL = THEN SET CYL = TRACK


        SET &OUT = 1


        LOOP: IFALC F(CMD&OUT)


              IF &LASTCC NE 0 THEN GOTO GOTFN


        RTRY: SET &OUT = &OUT + 1


              GOTO LOOP


        GOTFN: ALLOC F(CMD&OUT) DUMMY


        IF &DDN = CMDOUT THEN SET &DDN = &DDN&OUT


        IF &SYSPREF = &SYSUID OR &SYSUID = &STR() +


                              THEN SET &CMDDSN = COMMAND.OUTPUT&OUT


                              ELSE SET &CMDDSN = &SYSUID..COMMAND.OUTPUT&OUT


        IF &USE = NONE THEN SET &U = &STR()


                       ELSE SET &U = &STR(US(&USE))


        IF &FORCE = FORCE THEN GOTO FREEIT


        SET FRC = 0


        IFALC F(&DDN) DA(&CMDDSN)


        IF &LASTCC = 0 THEN +


                   IF &U = THEN GOTO GOTCMDF


                           ELSE GOTO SETATTR


        FREEIT: +


        IFALC F(&DDN)


        IF &LASTCC = 0 THEN FREE F(&DDN)


        FILEINFO DSN(&CMDDSN)


        SET &FRC = &LASTCC


        SETATTR: ERROR EXIT CODE(99)


        IF &FRC = 0 THEN ALLOC F(&DDN) DSN(&CMDDSN) &U


                    ELSE +


        IF &FRC = 4 THEN ALLOC F(&DDN) DSN(&CMDDSN) NEW CAT &CYL  SP(1,1) &U


                    ELSE DO


                         WRITE ERROR IN CLIST CMDOUT ALLOCATING FOLLOWING DSN:


                         WRITE &CMDDSN : &OUTMSG


                         GOTO RTRY


                         ENDO


        GOTCMDF: ERROR OFF


                 IF &PRC = PRC THEN WRITE RC IS &OUT


                 IF &MOD = MOD THEN DO


                                    FREE F(&DDN.M)


                                    ALLOC F(&DDN.M) DSN(&CMDDSN) MOD &U


                                    ENDO


        EXCO:    EXIT CODE(&OUT)


./ ADD NAME=COM                                    17OCT89 12.47.57
ISREDIT MACRO


/*********************************************************************/


/*  THIS ISPF/PDF EDIT MACRO DISPLAYS ONLY COMMENT LINES, THAT IS    */


/*  LINES THAT CONTAIN A / FOLLOWED BY AN *.                         */


/*                                                                   */


/*  TO RUN:                                                          */


/*     ENTER COMMENTS ON THE COMMAND LINE                            */


/*********************************************************************/





/* EXCLUDE ALL LINES */


ISREDIT EXCLUDE ALL





/* FIND ALL COMMENT LINES


ISREDIT FIND ALL '/*'





EXIT


./ ADD NAME=CUT      0136-86247-86254-1050-00175-00170-00000-GS00150
        /*CLIST****************************************************************/


        /*   ISPF/PDF EDIT MACRO TO WRITE LINES FROM A FILE TO THE USER       */


        /*   PROFILE POOL FOR LATER INCLUSION BY THE PASTE MACRO.             */


        /*                                                                    */


        /*   A TUTORIAL IS AVAILABLE BY PRESSING THE PF(1) KEY.               */


        /**********************************************************************/


        ISREDIT MACRO (PARM1) NOPROCESS


        CONTROL NOFLUSH NOMSG


        /*CONTROL LIST CONLIST SYMLIST


        SET &MSGFLAG =      /* MESSAGE FLAG INDICATES NO PREVIOUS LINES CUT   */


        SET PARM = &STR(T)  /* PARAMETER FOR STRIPPING TRAILING BLANKS        */





        /* CHECK FOR INVALID PARAMETERS                                       */


        IF &PARM1 ¬= &STR( ) AND &PARM1 ¬= &STR(R) +


           AND &PARM1 ¬= &STR(REPLACE) THEN +


          DO


            IF &DATATYPE(&PARM1) = NUM AND &PARM1 > 0 THEN +


              DO


                /* SET NEW LIMIT FOR MAXIMUM NUMBER OF LINES CUT TO PROFILE   */


                SET CUTLIMIT = &PARM1


                ISPEXEC VPUT (CUTLIMIT) PROFILE


              END


            ELSE +


              DO


                /* AN INVALID CUT PARAMETER HAS BEEN PASSED                   */


                SET ZERRSM = &STR(INVALID PARAMETER!!!)


                SET MSG1 = &STR(USE "R" OR "REPLACE" TO REPLACE PREVIOUS)


                SET MSG2 = &STR( LINES CUT, NUMBER > 0 TO SET CUT LIMIT)


                SET ZERRLM = &STR(&MSG1&MSG2)


                SET ZERRALRM = YES


                SET ZERRHM = CUTHELP


                ISPEXEC SETMSG MSG(ISRZ002)


                EXIT CODE(12)


              END


          END





        /* PROCESS LINE COMMANDS, CHECK IF C OR M WAS SPECIFIED               */


        ISREDIT PROCESS RANGE C M


        SET RC = &LASTCC


        IF &RC >= 16 THEN +


          EXIT CODE(12) /* LINE COMMAND CONFLICT - EDIT WILL CREATE MESSAGE   */


        ELSE IF &RC >= 4 THEN +


          DO /* MISSING C OR M LINE COMMAND                                   */


            SET ZERRSM = &STR(MISSING LINE COMMAND!!!)


            SET MSG1 = &STR(CUT REQUIRES A "C", "M", )


            SET MSG2 = &STR("CC" OR "MM" LINE COMMAND...)


            SET ZERRLM = &STR(&MSG1&MSG2)


            SET ZERRALRM = YES


            SET ZERRHM = CUTHELP


            ISPEXEC SETMSG MSG(ISRZ002)


            EXIT CODE(12)


          END





        ISREDIT (CMD) = RANGE_CMD              /* GET LINE COMMAND            */


        ISREDIT (FSTLINE) = LINENUM .ZFRANGE   /* GET FIRST LINE IN RANGE     */


        ISREDIT (LSTLINE) = LINENUM .ZLRANGE   /* GET LAST LINE IN RANGE      */


        SET LINESTOCUT = &EVAL(&LSTLINE-&FSTLINE+1)





        /* GET THE NUMBER OF LINES THAT HAVE BEEN CUT BUT NOT PASTED,         */


        /* SET TO A VALUE OF 0 AND SET FLAG IF NONE EXIST                     */


        ISPEXEC VGET (LINESCUT) PROFILE


        IF &LASTCC ¬= 0 THEN +


          DO


            SET MSGFLAG = 1


            SET &LINESCUT = 0


          END





        /* GET THE MAXIMUM NUMBER OF LINES TO BE STORED IN THE PROFILE,       */


        /* INITIALIZE TO 500 IF FIRST TIME.                                   */


        ISPEXEC VGET (CUTLIMIT) PROFILE


        IF &LASTCC ¬= 0 THEN +


          DO


            SET CUTLIMIT = 500


            ISPEXEC VPUT (CUTLIMIT) PROFILE


          END





        /* STORE DATA WIDTH OF LARGER OF LINES CUT AND LINES TO BE CUT        */


        ISREDIT (NEWLRECL) = DATA_WIDTH


        ISPEXEC VGET (CUTLRECL) PROFILE


        IF &NEWLRECL > &CUTLRECL THEN +


          DO


            SET CUTLRECL = &NEWLRECL


            ISPEXEC VPUT (CUTLRECL) PROFILE


          END





        IF &PARM1 = &STR(R) OR &PARM1 = &STR(REPLACE) THEN +


          DO


            IF &LINESTOCUT < &LINESCUT THEN +


              DO


                /* DELETE VARIABLES THAT WILL NOT BE OVERWRITTEN              */


                SET LN = &LINESTOCUT+1


                DO WHILE &LN <= &LINESCUT


                  SET CUTLN&LN = &STR()


                  ISPEXEC VPUT (CUTLN&LN) PROFILE


                  SET LN = &LN+1


                END


              END


            SET MSGFLAG  = 1


            SET LINESCUT = 0


          END





        /* CHECK TO SEE IF THE LIMIT WILL BE EXCEEDED                         */


        /* BY STORING THE LINES INTO THE PROFILE.                             */


        SET TOTAL = &LINESCUT + &LINESTOCUT


        IF &TOTAL > &CUTLIMIT THEN +


          DO


            SET ZERRSM = &STR(CUT LIMIT EXCEEDED!!!)


            SET MSG1 = &STR(CUT LIMIT SET AT &CUTLIMIT, REDUCE RANGE )


            SET MSG2 = &STR(OF LINES TO CUT OR CHANGE CUT LIMIT...)


            SET ZERRLM = &STR(&MSG1&MSG2)


            SET ZERRALRM = YES


            SET ZERRHM = CUTHELP


            ISPEXEC SETMSG MSG(ISRZ002)


            EXIT CODE(12)


          END





        /* CUT THE LINES AND PLACE IN PROFILE                                 */


        SET LN = &LINESCUT+1


        SET I  = &FSTLINE


        DO WHILE &I <= &LSTLINE


          ISREDIT (CUTLN&LN) = LINE &I


        /*ISPEXEC VPUT (STRING,PARM) SHARED


        /*STRIP


        /*ISPEXEC VGET (STRING) SHARED


        /*SET CUTLN&LN = &STR(&STRING)


          ISPEXEC VPUT (CUTLN&LN) PROFILE


          SET &LN = &LN+1


          SET &I  = &I+1


        END





        /* PUT THE NUMBER OF LINES CUT INTO THE PROFILE FOR USE BY PASTE      */


        /* SAVE THE NUMBER OF LINES THAT WERE PREVIOUSLY CUT                  */


        SET PREVCUT  = &LINESCUT


        SET LINESCUT = &LN-1


        ISPEXEC VPUT (LINESCUT) PROFILE





        /* DISPLAY APPROPRIATE MESSAGE FOR LINES CUT                          */


        IF &CMD = &STR(M) THEN +


          DO


            /* DELETE LINES THAT WERE CUT IF LINE COMMAND OF M                */


            ISREDIT DELETE &FSTLINE &LSTLINE


            IF &MSGFLAG ¬=  THEN +


              DO


                SET ZEDSMSG = &STR(&LINESTOCUT LINES CUT && DELETED)


                SET MSG1 = &STR(&LINESTOCUT LINES WERE CUT AND )


                SET MSG2 = &STR(DELETED FROM THE CURRENT FILE...)


                SET ZEDLMSG = &STR(&MSG1&MSG2)


              END


            ELSE +


              DO


                SET ZEDSMSG = &STR(&LINESTOCUT LINES CUT && DELETED)


                SET MSG1 = &STR(A TOTAL OF &LINESCUT LINES HAVE BEEN CUT, )


                SET MSG2 = &STR(THE LAST &LINESTOCUT HAVE BEEN DELETED...)


                SET ZEDLMSG = &STR(&MSG1&MSG2)


              END


          END


        ELSE +


          DO


            IF &MSGFLAG ¬=  THEN +


              DO


                SET ZEDSMSG = &STR(&LINESTOCUT LINES CUT)


                SET MSG1 = &STR(&LINESTOCUT LINES WERE )


                SET MSG2 = &STR(CUT FROM THE CURRENT FILE...)


                SET ZEDLMSG = &STR(&MSG1&MSG2)


              END


            ELSE +


              DO


                SET ZEDSMSG = &STR(&LINESCUT LINES CUT IN ALL)


                SET MSG1 = &STR(&LINESTOCUT LINES CUT PLUS &PREVCUT )


                SET MSG2 = &STR(LINES PREVIOUSLY CUT TOTALS &LINESCUT....)


                SET ZEDLMSG = &STR(&MSG1&MSG2)


              END


          END


        ISPEXEC SETMSG MSG(ISRZ000)


        EXIT


./ ADD NAME=DECRYPT  0101-85289-85290-1240-00002-00002-00001-DS00150
00010000ISREDIT MACRO (KEY)


00020001ISREDIT !CRY DECRYPT,&KEY


./ ADD NAME=DOCADD   0122-86161-88077-1238-00139-00063-00000-KK00155
        PROC 1 DCNT OLDMEM(ZILCH) CCALL(DUMMY1)


        CONTROL NOFLUSH END(ENDO) NOMSG


        IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


        ISPEXEC VGET (DOCSLVL1 DOCSLVL2 DOCSMEM DOCADD LIB SAMPDOC SAMPNDEX LVL1
 LVL2 DTYPE)

        IF &LVL1 = &STR() THEN SET LVL1 = &DOCSLVL1


        IF &LVL2 = &STR() THEN SET LVL2 = &DOCSLVL2


        IF &LIB = &STR() THEN SET LIB = &DOCSMEM


        IF &DTYPE = &STR() THEN SET DTYPE = DOC02


        IF &DTYPE = DOC04 THEN SET CCALL = DOCISTAT


        IF &SAMPDOC = &STR() THEN SET SAMPDOC = '&LVL1..&LVL2..MEMO(SAMPDOC)'


        IF &SAMPNDEX = &STR() THEN SET SAMPNDEX = '&LVL1..&LVL2..INDEXES(SAMPNDE
X)'

        IF &DOCADD = &STR() THEN SET DOCADD = DOCADD


        ISPEXEC CONTROL DISPLAY SAVE





        ISPEXEC DISPLAY PANEL(&DOCADD&DCNT) CURSOR(DESCL1)


        IF &LASTCC NE 0 THEN GOTO EXIT





        RETRY: +


        IF &DOCDSN = &STR() THEN SET DDSN = '&LVL1..&LVL2..&LIB'


                            ELSE SET DDSN = &DOCDSN





        IF &DOCDSN = &STR() THEN SET &W = MEMBER


                            ELSE SET &W = DOCDSN





        IF &MEMBER = &STR() THEN FILEINFO DSN(&DDSN)


                            ELSE FILEINFO DSN(&DDSN) MEM(&MEMBER)


        SET FRC = &LASTCC


           IF &FRC NE 0 AND &FRC NE 24 THEN +


             DO


             SET GPML = &OUTMSG


             ISPEXEC DISPLAY MSG(GPM001A) CURSOR(&W)


             IF &LASTCC NE 0 THEN GOTO EXIT


             GOTO RETRY


             ENDO


           IF &DSORG NE PS AND &DSORG NE PO THEN +


             DO


             SET GPML = NOT A GOOD DOCUMENT TYPE - CANCELED


             ISPEXEC DISPLAY MSG(GPM001A) CURSOR(&W)


             IF &LASTCC NE 0 THEN GOTO EXIT


             GOTO RETRY


             ENDO


           IF &FRC = 0 AND &OLDMEM NE &MEMBER AND &MEMBER NE &STR() THEN +


             DO


             SET GPML = DOCUMENT ALREADY EXISTS. CHANGE NAME OR PRESS ENTER TO A
DD IT.

             SET OLDMEM = &MEMBER


             ISPEXEC DISPLAY MSG(GPM001A) CURSOR(MEMBER)


             IF &LASTCC NE 0 THEN GOTO EXIT


             GOTO RETRY


             ENDO


           IF &DSORG = PO AND &MEMBER = &STR() AND &MEMCNTL = NO THEN +


             DO


             SET GPML = ENTER A MEMBER NAME FOR THE DOCUMENT.


             SET OLDMEM = &MEMBER


             ISPEXEC DISPLAY MSG(GPM001A) CURSOR(MEMBER)


             IF &LASTCC NE 0 THEN GOTO EXIT


             GOTO RETRY


             ENDO





        IF &DOCDSN NE &STR() THEN +


           DO


           SET CMD = &DTYPE


           IF &DSORG = PO THEN +


             DO


             IF &MEMBER = &STR() AND &MEMCNTL = &STR(NO ) THEN +


               DO


               SET GPML = NO MEMBER WAS SPECIFIED - REQUEST CANCELED


               ISPEXEC SETMSG MSG(GPM001)


               GOTO EXIT


               ENDO


             IF &MEMCNTL = &STR(YES) THEN +


               SET OPS = DUMMY DUMMY &FULLDSN


             IF &MEMCNTL = &STR(NO ) THEN +


               SET OPS = &FULLDSN &MEMBER &CCALL


             ENDO


           IF &DSORG = PS THEN +


             DO


             SET OPS = DUMMY DUMMY &FULLDSN


             ENDO


           ENDO





        IF &DOCDSN = &STR() THEN +


           DO


           IF (&LVL1 = &DOCSLVL1 AND &LVL2 = &DOCSLVL2) OR +


               &DTYPE = DOC04 THEN +


             DO


             IF &LIB = INDEXES THEN +


                DO


                SET CMD = DOC01


                SET OPS = &MEMBER &LCNT DUMMY1


                ENDO


             ELSE +


                DO


                SET CMD = &DTYPE


                IF &CMD = DOC02 THEN SET CMD = DOC03


                IF &DSORG = PO THEN +


                  SET OPS = &LIB &MEMBER &CCALL


                ELSE SET OPS = DUMMY DUMMY &LIB


                ENDO


             ENDO


           ELSE +


             DO


             SET CMD = &DTYPE


             IF &DSORG = PO THEN +


               SET OPS = &LVL1..&LVL2..&LIB &MEMBER &CCALL


             ELSE SET OPS = DUMMY DUMMY &LVL1..&LVL2..&LIB


             ENDO


           ENDO





        /* NOW EDIT THE INDEX MEMBER  */





        ISPEXEC VPUT (CMD OPS DCNT) SHARED





        ERROR DO


              SET GPML = ERROR &LASTCC OCCURED IN INDEX EDIT


              ISPEXEC SETMSG MSG(GPM001)


              GOTO EXIT


              ENDO





        ISPEXEC EDIT DATASET('&DOCSLVL1..&DOCSLVL2..INDEXES(&DOCSMEM)') MACRO(DO
CEDIT)




        /* NOW EDIT THE NEW DOCUMENT  */





          ERROR OFF


          IF &FRC = 24 THEN +


             DO


             IF &DOCDSN = &STR() AND &LIB = INDEXES THEN +


                  DO


                  SET FADSN = &SAMPNDEX


                  SET FACMD = DOCIINIT


                  ENDO


             ELSE SET FADSN = &SAMPDOC


             ISPEXEC VPUT AUTOCOPY SHARED


             ISPEXEC CONTROL NONDISPL ENTER


             IF &MEMBER = THEN +


                ISPEXEC EDIT DATASET('&FULLDSN') PANEL(DOCEDIT)


                          ELSE +


                ISPEXEC EDIT DATASET('&FULLDSN(&MEMBER)') PANEL(DOCEDIT)


             ENDO


        EXIT: ISPEXEC CONTROL DISPLAY RESTORE


./ ADD NAME=DOCEDIT  0106-86163-86164-2240-00018-00013-00000-KK00150
        ISREDIT MACRO


        CONTROL ASIS


        ISPEXEC VGET (DESCL1 DESCL2 DESCL3 CMD OPS DCNT) SHARED





        SET B = &STR(                                                    )


        SET B = &STR(&B&B)


        SET PAD = &SUBSTR(1:70-&LENGTH(&STR(&DESCL1)),&B)





        IF &DCNT > 2 THEN +


           ISREDIT LINE_AFTER 3 = &STR("D3 &DESCL3")





        IF &DCNT > 1 THEN +


           ISREDIT LINE_AFTER 3 = &STR("D2 &DESCL2")





           ISREDIT LINE_AFTER 3 = &STR("D1 &DESCL1&PAD &CMD &OPS")





        ISREDIT SAVE


        ISREDIT END


./ ADD NAME=DOCEDUP  0102-86163-86191-1832-00007-00005-00000-KX00150
        ISREDIT MACRO





        ISREDIT LINE_AFTER 0 = MSGLINE &STR("   DO NOT DELETE ANY OF THE TITLE L
INES.     ")

        ISREDIT LINE_AFTER 0 = MSGLINE &STR("         IN COLUMNS 1-3 OR 74-200.
       ")

        ISREDIT LINE_AFTER 0 = MSGLINE &STR("WARNING: DO NOT CHANGE CONTROL INFO
RMATION")




        ISREDIT BOUNDS = 4 73


./ ADD NAME=DOCFINAL 0116-86168-86220-1310-00032-00028-00005-KK00150
00001000ISREDIT MACRO (L)


00001100IF &L NE &STR() THEN CONTROL LIST CONLIST


00001200IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


00001300/* DONT TOSS THIS IT'S USED IN STATUS RPT SYSTEM  */


00002000ISREDIT NUMBER OFF


00003000CONTROL NOFLUSH END(ENDO)


00004000ISPEXEC CONTROL ERRORS RETURN


00005900SET &MEMNAME = &STR()


00006000ISREDIT BOUNDS 1 74


00006100ISREDIT (DATA1) = DATAID


00006200ISREDIT (MEMNAME) = MEMBER


00006300IF &MEMNAME = FINAL THEN +


00006400  DO


00006500  ISREDIT RECOVERY ON


00030000  ISREDIT CAPS = OFF


00040000  ISREDIT (L1) = LINE 1


00050000  IF &LASTCC = 12 THEN DO


00050100        ISPEXEC VGET STATCON SHARED       /* CONTROL DATAID  */


00051000        ISREDIT COPY ALL AFTER 0


00051116  /*    ISREDIT CHANGE X'4B40' X'4B4F' ALL */


00051206        %DOCUPDAT &DATA1 SCRIPT &STATCON DATAIDS


00051300        IF &LASTCC NE 0 THEN EXIT


00052000        ISREDIT COPY SCRIPT AFTER 0


00053000        ISREDIT CHANGE X'40AA' X'4BA4A240' 1 ALL


00054000        ISREDIT CHANGE C'                                  ' X'4BA29240F
1' 1 ALL

00055013        ISREDIT CHANGE C'  ' C'QQ' 1 ALL


00056013        ISREDIT CHANGE C'QQ' C'' 1 ALL


00057014        ISREDIT CHANGE P'$ $===============================' X'4BA29240F
1' 1 ALL

00070000        ISREDIT RESET SPECIAL


00140000                       ENDO


00140100  EXIT


00141000  ENDO


./ ADD NAME=DOCIINIT 0104-86190-86191-1832-00014-00018-00000-KX00150
        ISREDIT MACRO


        CONTROL ASIS END(ENDO)





        ISREDIT LINE_AFTER 0 = MSGLINE &STR("   DO NOT DELETE ANY OF THE TITLE L
INES.    ")

        ISREDIT LINE_AFTER 0 = MSGLINE &STR("         IN COLUMNS 1-3 OR 74-200.
       ")

        ISREDIT LINE_AFTER 0 = MSGLINE &STR("WARNING: DO NOT CHANGE CONTROL INFO
RMATION")




        ISPEXEC VGET (DTYPE) SHARED


        ISREDIT (MNAME) = MEMBER


        IF &DTYPE = DOC04 THEN +


          DO


          ISREDIT CHANGE 'CONTROL' '&MNAME' ALL 1 200


          ENDO


        ISREDIT BOUNDS = 4 73


./ ADD NAME=DOCIMERG 0108-86059-88090-1351-00045-00056-00007-KK00155
00001000ISREDIT MACRO (L)


00001100IF &L NE &STR() THEN CONTROL LIST CONLIST


00001200IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


00001300/* DONT TOSS THIS IT'S USED IN STATUS RPT SYSTEM  */


00002000ISREDIT NUMBER OFF


00003000CONTROL NOFLUSH END(ENDO)


00004000ISPEXEC CONTROL ERRORS RETURN


00005900SET &MEMNAME = &STR()


00006000ISREDIT BOUNDS 1 74


00006100ISREDIT (DATA1) = DATAID


00006200ISREDIT (MEMNAME) = MEMBER


00150000IF &MEMNAME = ALL THEN +


00151000   DO


00151200   ISREDIT DELETE ALL NX


00152004   ISREDIT DEFINE DOCSMERG CMD MACRO


00160100   ISREDIT COPY PATTERN AFTER 0


00160200   ISREDIT RESET SPECIAL


00162000   ISREDIT (CURMBR) = MEMBER


00163000   ISPEXEC LMOPEN DATAID(&DATA1) OPTION(INPUT)


00164000   SET LMRC = &LASTCC


00165000      DO WHILE (&LMRC = 0)


00166000      ISPEXEC LMMLIST DATAID(&DATA1) MEMBER(MEMBER) STATS(YES)


00167000      SET LMRC = &LASTCC


00168000      IF &LMRC = 0 AND &ZLCNORC NE 0 THEN +


00169000         DO


00169100         IF (&MEMBER NE &CURMBR) AND +


00169200            (&MEMBER NE PATTERN) AND +


00169301            (&MEMBER NE SCRIPT) AND +


00169500            (&MEMBER NE FINAL) THEN +


00169600               DO


00169704               ISREDIT DOCSMERG &MEMBER &L


00169800               ISPEXEC VGET HAVDATA


00169900               IF &HAVDATA = YES THEN +


00170000               ISREDIT LINE_AFTER 0 = MSGLINE +


00170100                  '&MEMBER HAS TURNED IN A STATUS REPORT - &ZLMDATE.'


00170200               ENDO


00170300         ENDO


00170400      ENDO


00170506/* ISREDIT UP MAX  */


00170607   ISREDIT LINE_AFTER 0 = LINE 1


00170808   ISREDIT FIND '1' FIRST


00170908   ISREDIT DELETE 1


00171000   ISPEXEC LMMLIST DATAID(&DATA1) OPTION(FREE)


00172000   ISPEXEC LMCLOSE DATAID(&DATA1)


00180000   ENDO


./ ADD NAME=DOCINPRT 0100-84215-84215-1241-00005-00005-00000-KK00150
00010000PROC 0 M T V VM L OUT01() DIR() DSNB() CDCUR(MEMBER) PO(N)
 SF(NO)

00020000CONTROL NOFLUSH END(ENDO)


00041000     SET &GPM = NO PRINT AVAILABLE


00042000     SET &GPML = NO PRINT IS AVAILABLE FOR THIS SELECTION


00050000     ISPEXEC SETMSG MSG(GPM001)


./ ADD NAME=DOCINSEL 0100-84327-84327-2048-00002-00002-00000-KK00150
00009800PROC 1 OPERAND
 SF(NO)

00009900%SPFOZD &OPERAND


./ ADD NAME=DOCIOCTL 0102-87030-87030-1214-00061-00061-00000-KK00150
00190700  PROC 0 U


00190800  CONTROL NOMSG NOFLUSH END(ENDO)


00190900  FREE F(SYSOUT)


00191000  IFALC F(SYSOUT)


00191100  IF &LASTCC NE 0 THEN ALLOC F(SYSOUT) DSN(*)


00191200  SET &DOCSLVL1 =  DPSCD150


00191300  SET &DOCSLVL2 = DOCSYS


00191400  SET &DOCSTITL = &STR(IO CONTROL DOC SYSTEM)


00194000  SET &GPML = &STR(PLEASE WAIT - INDEXES ARE BEING LOADED)


00194100  SET &PSIZE = M


00195000  ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL GPML PSIZE)


00196000  ISPEXEC CONTROL DISPLAY LOCK


00197000  ISPEXEC DISPLAY PANEL(GPM)


00198000


00211000  IF &U = U OR &SYSUID = GCTR150 OR &SYSUID = JPTR150  +


00212000            OR &SYSUID = VWTR150 OR &SYSUID = SNTR150  +


00213000            OR &SYSUID = MHTR150 OR &SYSUID = LLTR150 THEN +


00220000     DO


00223000     SET &LIB = IOMEMO


00224000     SET &SAMPDOC = '&DOCSLVL1..&DOCSLVL2..IOMEMO(SAMPDOC)'


00250000     SET ACTTAB = &STR(S,SEL P,PRT E,EDT)


00260000     SET THDA1 = &STR(¢         USE "PF3¢TO EXIT,"PF5¢TO CHANGE INDEX,"P
F6¢TO ADD AN ENTRY)

00270000     SET THDA2 = &STR(¢             OPTIONS ARE"S¢FOR BROWSE,"P¢FOR PRIN
T,"E¢FOR EDIT)

00280000     SET DOCUPDT = YES


00290000     ISPEXEC VPUT (ACTTAB,THDA1,THDA2,SAMPDOC,LIB,DOCUPDT) SHARED


00300000     ENDO


00310000  ELSE +


00320000     DO


00330000     SET DOCUPDT = NO


00340000     ISPEXEC VPUT DOCUPDT SHARED


00350000     ENDO


00360000


00370000RESHOW: +


00371000  SET &DOCSMEM = IOPRIM


00390000  SET &DOCSEXIT = NO


00400000  ISPEXEC VPUT (DOCSMEM DOCSEXIT)


00410000  ISPEXEC SELECT PGM(PANLEXIT) PARM(TBLHNDLR,1,PRIMET)


00420000  ISPEXEC VGET DOCRSHOW SHARED


00430000  IF &DOCRSHOW = YES THEN +


00440000    DO


00450000    SET DOCRSHOW =


00460000    ISPEXEC VPUT DOCRSHOW SHARED


00470000    GOTO RESHOW


00480000    ENDO


00490000


00490100  SET &PSIZE =


00491000  IF &U = U THEN +


00510000    DO


00520000    SET THDA1 = &STR()


00530000    SET THDA2 = &STR()


00540000    SET ACTTAB = &STR(S,SEL P,PRT)


00550000    SET &SAMPDOC =


00560000    SET DOCUPDT =


00570000    SET &LIB =


00580000    ISPEXEC VPUT (ACTTAB,THDA1,THDA2 DOCUPDT SAMPDOC LIB PSIZE) SHARED


00590000    ENDO


00600000  ELSE +


00610000    DO


00620000    SET DOCUPDT =


00630000    ISPEXEC VPUT (DOCUPDT,PSIZE) SHARED


00640000    ENDO


./ ADD NAME=DOCISTAT 0113-86010-86034-1744-00020-00007-00000-KX00150
        ISREDIT MACRO


        ISREDIT NUMBER OFF


        CONTROL NOFLUSH END(ENDO)


        ISPEXEC CONTROL ERRORS RETURN


        ISREDIT CAPS = OFF


        ISREDIT RECOVERY ON


        ISREDIT RESET SPECIAL


        ISREDIT BOUNDS 3 74


        ISREDIT RIGHT 2


        ISREDIT (L1) = LINE 1


        IF &LASTCC = 12 THEN DO


                ISREDIT COPY PATTERN AFTER 0


                ISREDIT RESET SPECIAL


                             ENDO


                ISREDIT LINE_AFTER +


                    0 = MSGLINE '        Please do not create or copy a major to
pic line'

                ISREDIT LINE_AFTER +


                    0 = MSGLINE '            Please do not alter major topic lin
es'

                ISREDIT LINE_AFTER +


                    0 = MSGLINE '        You may delete any major topic you do n
ot need'

./ ADD NAME=DOCLCL   0105-84006-84009-1739-00038-00035-00014-KK00150
00012004PROC 0 L FN()


00020003CONTROL NOFLUSH NOMSG END(ENDO)


00030003IF &L = L THEN CONTROL MSG LIST CONLIST


00031000ISPEXEC VGET (PDOCN HPID DSPRTOPT)


00032000FILEINFO DSN('&PDOCN')


00033000IF &LASTCC NE 0 AND &LASTCC NE 44 THEN GOTO EL


00034000IF &DSORG = PS THEN GOTO DSPRINT


00035000   ELSE IF &DSORG = PO THEN GOTO LISTPDS


00036000        ELSE DO


00037000          EL:  SET GPM = PRINT ERROR


00038000               SET GPML = THE DATASET TO BE PRINTED IS NOT ACCEPTABLE.


00039000               ISPEXEC SETMSG MSG(GPM001)


00039100               ISPEXEC CONTROL NONDISPL END


00039200               EXIT


00039300             ENDO


00039400LISTPDS: +


00039501IF &MEMCNTL = YES THEN GOTO DSPRINT  /* NO NEED TO DO WHOLE LIB */


00039600FREE F(SYSPRINT SYSLIB SYSPUNCH SYSIN)


00039700ALLOC F(SYSIN) DUMMY


00039800ALLOC F(SYSPRINT) DUMMY


00039900ALLOC F(SYSLIB) DSN('&PDOCN')


00040104CMDOUT DDN(SYSPUNCH)


00040204SET FN = &LASTCC


00040300CALL 'WDPSC.SYSLIBRY(LISTPDS)' 'DECK,NOLIST'


00040402WHATDSN DDN(SYSPUNCH)


00040502CHDSCB '&DSNAME' RECFM(FBA) NOLIST


00040605FREE DSN('&DSNAME')


00040702GOTO DSPRIN2


00041200


00042000DSPRINT: +


00043002SET &DSNAME= &PDOCN


00044002DSPRIN2: +


00045002DSPRINT '&DSNAME' &HPID NONUM CCHAR &DSPRTOPT


00071000SET GPM = PRINT QUEUED


00072000SET GPML = THE DOCUMENT WAS QUEUED FOR PRINT ON PRINTER &HPID


00073000ISPEXEC SETMSG MSG(GPM001)


00080000ISPEXEC CONTROL NONDISPL END


00090004IF &FN NE THEN CMDOUT FREE(&FN)


./ ADD NAME=DOCMEMO  0100-86170-86170-1852-00015-00015-00000-KX00150
00001000  PROC 1 SET


00010000  CONTROL NOMSG NOFLUSH END(ENDO)


00020000  IF &SET = ON THEN +


00030000     DO


00040000     ISPEXEC VGET LIB SHARED


00050000     SET OLIB = &LIB


00143100     SET &LIB = OPERMEMO


00144000     ISPEXEC VPUT (LIB OLIB) SHARED


00145000     ENDO


00146000  IF &SET = OFF THEN +


00147000     DO


00148000     ISPEXEC VGET OLIB SHARED


00149000     SET &LIB = &OLIB


00160000     ISPEXEC VPUT (LIB) SHARED


00170000     ENDO


./ ADD NAME=DOCOMERG 0131-86010-86062-1230-00052-00007-00048-LL00150
00001015ISREDIT MACRO (L)


00001115IF &L NE &STR() THEN CONTROL LIST CONLIST


00001230IF &SYSPREF = KX00150 THEN CONTROL LIST CONLIST


00001300/* DONT TOSS THIS IT'S USED IN STATUS RPT SYSTEM  */


00002000ISREDIT NUMBER OFF


00003000CONTROL NOFLUSH END(ENDO)


00004000ISPEXEC CONTROL ERRORS RETURN


00005912SET &MEMNAME = &STR()


00006026ISREDIT BOUNDS 1 74


00006114ISREDIT (MEMNAME) = MEMBER


00006225IF &MEMNAME = FINAL THEN DO


00006321  ISREDIT RECOVERY ON


00030013  ISREDIT CAPS = OFF


00040013  ISREDIT (L1) = LINE 1


00050013  IF &LASTCC = 12 THEN DO


00051014        ISREDIT COPY ALL AFTER 0


00070013        ISREDIT RESET SPECIAL


00140013                       ENDO


00140113                          EXIT


00141013                          ENDO


00150014IF &MEMNAME = ALL THEN +


00151013   DO


00151229   ISREDIT DELETE ALL NX


00152018   ISREDIT DEFINE MERGSTAT CMD MACRO


00160114   ISREDIT COPY PATTERN AFTER 0


00160225   ISREDIT RESET SPECIAL


00161014   ISREDIT (DATA1) = DATAID


00162014   ISREDIT (CURMBR) = MEMBER


00163014   ISPEXEC LMOPEN DATAID(&DATA1) OPTION(INPUT)


00164014   SET LMRC = &LASTCC


00164131   IF &LMRC = 12 THEN SET LMRC = 0


00165024      DO WHILE (&LMRC = 0)


00166014      ISPEXEC LMMLIST DATAID(&DATA1) MEMBER(MEMBER) STATS(YES)


00167014      SET LMRC = &LASTCC


00168025      IF &LMRC = 0 AND &ZLCNORC NE 0 THEN +


00169014         DO


00169114         IF (&MEMBER NE &CURMBR) AND +


00169214            (&MEMBER NE PATTERN) AND +


00169325            (&MEMBER NE FINAL) THEN +


00169425               DO


00169518               ISREDIT MERGSTAT &MEMBER &L


00169627               ISPEXEC VGET HAVDATA


00169727               IF &HAVDATA = YES THEN +


00169825               ISREDIT LINE_AFTER 0 = MSGLINE +


00169925                  '&MEMBER HAS TURNED IN A STATUS REPORT - &ZLMDATE.'


00170025               ENDO


00170114         ENDO


00170214      ENDO


00170323   ISREDIT UP MAX


00170414   ISPEXEC LMMLIST DATAID(&DATA1) OPTION(FREE)


00171014   ISPEXEC LMCLOSE DATAID(&DATA1)


00180013   ENDO


./ ADD NAME=DOCOPER  0109-86128-86188-1754-00059-00020-00059-KX00150
00190706  PROC 0 U


00190806  CONTROL NOMSG NOFLUSH END(ENDO)


00190906  FREE F(SYSOUT)


00191006  IFALC F(SYSOUT)


00191106  IF &LASTCC NE 0 THEN ALLOC F(SYSOUT) DSN(*)


00191206  SET &DOCSLVL1 =  DPSCD150


00191306  SET &DOCSLVL2 = DOCSYS


00191406  SET &DOCSTITL = &STR(OPERATIONS DOC SYSTEM)


00194006  SET &GPML = &STR(PLEASE WAIT - INDEXES ARE BEING LOADED)


00194108  SET &PSIZE = M


00195008  ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL GPML PSIZE)


00196006  ISPEXEC CONTROL DISPLAY LOCK


00197006  ISPEXEC DISPLAY PANEL(GPM)


00198006


00211006  IF &U = U THEN +


00220006     DO


00223006     SET &LIB = OPERMEMO


00224006     SET &SAMPDOC = '&DOCSLVL1..&DOCSLVL2..OPERMEMO(SAMPDOC)'


00250006     SET ACTTAB = &STR(S,SEL P,PRT E,EDT)


00260006     SET THDA1 = &STR(¢         USE "PF3¢TO EXIT,"PF5¢TO CHANGE INDEX,"P
F6¢TO ADD AN ENTRY)

00270006     SET THDA2 = &STR(¢             OPTIONS ARE"S¢FOR BROWSE,"P¢FOR PRIN
T,"E¢FOR EDIT)

00280006     SET DOCUPDT = YES


00290006     ISPEXEC VPUT (ACTTAB,THDA1,THDA2,SAMPDOC,LIB,DOCUPDT) SHARED


00300006     ENDO


00310006  ELSE +


00320006     DO


00330006     SET DOCUPDT = NO


00340006     ISPEXEC VPUT DOCUPDT SHARED


00350006     ENDO


00360006


00370006RESHOW: +


00371006  SET &DOCSMEM = OPERPRIM


00390006  SET &DOCSEXIT = NO


00400006  ISPEXEC VPUT (DOCSMEM DOCSEXIT)


00410007  ISPEXEC SELECT PGM(PANLEXIT) PARM(TBLHNDLR,1,PRIMET)


00420006  ISPEXEC VGET DOCRSHOW SHARED


00430006  IF &DOCRSHOW = YES THEN +


00440006    DO


00450006    SET DOCRSHOW =


00460006    ISPEXEC VPUT DOCRSHOW SHARED


00470006    GOTO RESHOW


00480006    ENDO


00490006


00490109  SET &PSIZE =


00491006  IF &U = U THEN +


00510006    DO


00520006    SET THDA1 = &STR()


00530006    SET THDA2 = &STR()


00540006    SET ACTTAB = &STR(S,SEL P,PRT)


00550006    SET &SAMPDOC =


00560006    SET DOCUPDT =


00570006    SET &LIB =


00580009    ISPEXEC VPUT (ACTTAB,THDA1,THDA2 DOCUPDT SAMPDOC LIB PSIZE) SHARED


00590006    ENDO


00600006  ELSE +


00610006    DO


00620006    SET DOCUPDT =


00630009    ISPEXEC VPUT (DOCUPDT,PSIZE) SHARED


00640006    ENDO


./ ADD NAME=DOCR90   0103-86035-86189-1145-00055-00035-00023-KK00150
00010000PROC 0


00020000CONTROL NOFLUSH   MSG END(ENDO)


00030002ISPEXEC VGET (ZTEMPF PJOBC PDOCN PSIZE)


00031000FILEINFO DSN('&PDOCN')


00031100SET FICC = &LASTCC


00031200IF &FICC NE 0 AND &FICC NE 44 THEN GOTO EL


00032000IF &DSORG = PS THEN SET RSKEL = DOCR90


00033000   ELSE IF &DSORG = PO THEN DO


00033300               IF &MEMCNTL = YES THEN SET RSKEL = DOCR90


00033400                                 ELSE SET RSKEL = DOCPDR90


00033500                            ENDO


00034000        ELSE DO


00034100          EL:  SET GPM = PRINT ERROR &FICC


00034201               SET GPML = &PDOCN  &OUTMSG


00034300               ISPEXEC SETMSG MSG(GPM001)


00034500               ISPEXEC CONTROL NONDISPL END


00034600               EXIT


00035000             ENDO


00040000GETMY SYS


00050000SET PJN = &SUBSTR(1:2,&SYSUID)P&SYS&SUBSTR(5:7,&SYSUID)


00052002  DO


00053002  SET PCHSET = ET49


00054002  SET PFCB = F128


00055002  SET PTRNA =


00055103  SET PLMRG = 5


00056002  ENDO


00057002IF &PSIZE = M THEN +


00058002  DO


00059002  SET PCHSET = ET29


00059102  SET PFCB = STD8


00059202  SET PTRNA =


00059303  SET PLMRG =


00059402  ENDO


00059502IF &PSIZE = L THEN +


00059602  DO


00059702  SET PCHSET = ET39


00059802  SET PFCB = STD8


00059902  SET PTRNA = T


00060003  SET PLMRG =


00061002  ENDO


00070003ISPEXEC VPUT (PJN,PCHSET,PFCB,PTRNA,PLMRG)


00160000  DO


00172000   /* OPEN FILE TAILORING  */


00172100   ISPEXEC FTOPEN TEMP


00173000   /* TAILOR THE REQUEST   */


00173100   ISPEXEC FTINCL &RSKEL


00174000   /* CLOSE IT OFF         */


00174100   ISPEXEC FTCLOSE


00175000   /* SUBMIT THE JOB       */


00176000   SUBMIT '&ZTEMPF'


00180000  ENDO


00192000SET GPM = PRINT SUBMITTED


00200000SET GPML = A ROTATE90 JOB WAS SUMITTED IN JOB CLASS &PJOBC


00210000ISPEXEC SETMSG MSG(GPM001)


00220000ISPEXEC CONTROL NONDISPL END


./ ADD NAME=DOCSAMP  0103-86190-87124-1231-00059-00058-00004-KK00150
00010000  CONTROL NOMSG NOFLUSH END(ENDO)


00011002  IF &SYSPREF = KX00150 THEN CONTROL LIST MSG CONLIST


00012002  CLOG '&SYSDATE &SYSTIME &SYSICMD' U($$$$150) SAVE


00020000  FREE F(SYSOUT)


00021000  IFALC F(SYSOUT)


00022000  IF &LASTCC NE 0 THEN ALLOC F(SYSOUT) DSN(*)


00040000  SET &DOCSLVL1 =  WDPSC


00050000  SET &DOCSLVL2 = SAMPLE


00060000  SET &DOCSTITL = &STR(SAMPLE DOCUMENTATION SYSTEM)


00060100  SET &GPML = &STR(PLEASE WAIT - INDEXES ARE BEING LOADED)


00060200  ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL GPML)


00060300  ISPEXEC CONTROL DISPLAY LOCK


00060400  ISPEXEC DISPLAY PANEL(GPM)


00060500


00066100  GETMY ACFUID


00066200  SET U = &SUBSTR(1:10,&ACFUID)


00066300  IF &U = &STR(150D3100CS) OR &U = &STR(150D360004) OR &U = &STR(150D210
0  ) THEN +

00066400     DO


00066601/*   SET &SAMPDOC = '&DOCSLVL1..&DOCSLVL2..TECHBULL(MEMO1)'   */


00066700     SET ACTTAB = &STR(S,SEL P,PRT E,EDT)


00066800     SET THDA1 = &STR(¢         USE "PF3¢TO EXIT,"PF5¢TO CHANGE INDEX,"P
F6¢TO ADD AN ENTRY)

00066900     SET THDA2 = &STR(¢             OPTIONS ARE"S¢FOR BROWSE,"P¢FOR PRIN
T,"E¢FOR EDIT)

00067000     SET DOCUPDT = YES


00067100     ISPEXEC VPUT (ACTTAB,THDA1,THDA2,SAMPDOC,LIB,DOCUPDT) SHARED


00067200     ENDO


00067300  ELSE +


00067400     DO


00067500     SET DOCUPDT = NO


00067600     ISPEXEC VPUT DOCUPDT SHARED


00067700     ENDO


00067800


00067900RESHOW: +


00068000  SET &DOCSMEM = PRIM


00068100  SET &DOCSEXIT = NO


00068200  ISPEXEC VPUT (DOCSMEM DOCSEXIT)


00141003  ISPEXEC SELECT PGM(PANLEXIT) PARM(TBLHNDLR,1,PRIME)


00142200  ISPEXEC VGET DOCRSHOW SHARED


00142300  IF &DOCRSHOW = YES THEN +


00142400    DO


00142500    SET DOCRSHOW =


00142600    ISPEXEC VPUT DOCRSHOW SHARED


00142700    GOTO RESHOW


00142800    ENDO


00142900


00143000  IF &U = &STR(150D3100CS) OR &U = &STR(150D360004) OR &U = &STR(150D210
0  ) THEN +

00143100    DO


00143200    SET THDA1 = &STR()


00143300    SET THDA2 = &STR()


00143400    SET ACTTAB = &STR(S,SEL P,PRT)


00143500    SET &SAMPDOC =


00143600    SET DOCUPDT =


00143700    SET &LIB =


00143800    ISPEXEC VPUT (ACTTAB,THDA1,THDA2 DOCUPDT SAMPDOC LIB) SHARED


00143900    ENDO


00144000  ELSE +


00144100    DO


00144200    SET DOCUPDT =


00144300    ISPEXEC VPUT DOCUPDT SHARED


00144400    ENDO


./ ADD NAME=DOCSMERG 0106-86204-86246-1053-00108-00103-00012-KX00150
00010000ISREDIT MACRO (MNAME,L)


00012005/* IF &SYSUID = DCAD150 THEN CONTROL LIST CONLIST /* */


00013003IF &SYSPREF = KX00150 THEN CONTROL LIST CONLIST


00020000/* DONT TOSS THIS IT'S USED IN STATUS RPT SYSTEM  */


00030000ISREDIT NUMBER OFF


00040000CONTROL NOFLUSH END(ENDO)


00050000ISPEXEC CONTROL ERRORS RETURN


00051003SET &BLANKS = &SUBSTR(1:80,&STR(
                                                   ))

00060000/*                                                                   */


00061000/* LABEL LAST PATTERN LINE                                   */


00062000/*                                                                   */


00063100ISREDIT LABEL .ZL = .ENDPAT


00071000/*                                                                   */


00080000/* COPY  member at end of pattern                                    */


00081000/*                                                                   */


00090000ISREDIT COPY &MNAME AFTER .ENDPAT


00091000SET &HAVDATA = NO    /* SAY NO GOOD DATA AT FIRST  */


00100000ISREDIT (LN) = LINENUM .ENDPAT


00102000SET &LN = &LN+1


00102100ISREDIT LABEL &LN = .MSTART


00103000ISREDIT LABEL .ZL = .MEND


00103100ISREDIT CHANGE X'50' X'5050' .MSTART .MEND ALL  /* ampers make havok */


00104000/*                                                                   */


00110000/* LOOP: FIND TOPIC LINE                                             */


00110100/*                                                                   */


00110200ISREDIT LABEL 1 = .CURTOP


00111000SET &MD = GO


00120000   DO WHILE &MD = GO


00121000   ISREDIT CURSOR = .CURTOP       /*  KERMIT CHANGE TIL UZ41259 */


00130000   ISREDIT FIND X'AA'


00131000   IF &LASTCC = 0 THEN +


00132000      DO


00133000/*                                                                   */


00140000/*       search for matching topic                                   */


00140100/*                                                                   */


00140200      ISREDIT (CURTOP) = LINENUM .ZCSR


00140300      ISREDIT (ENDPAT) = LINENUM .ENDPAT


00140400      IF &CURTOP > &ENDPAT THEN GOTO DONE /* CHECK RE UZ41259 */


00140500      ISREDIT (TOPIC) = LINE .ZCSR


00140600      SET &TOPIC = &SUBSTR(1:50,&STR(&TOPIC))


00140700SKIP: SET &CURTOP = &CURTOP+1 /* POINT to next line
S */

00141000      ISREDIT LABEL &CURTOP = .NL


00141104      ISREDIT CURSOR = .NL 1


00141301      ISREDIT FIND X'BA' .NL .NL  2


00141400      IF &LASTCC = 0 THEN GOTO SKIP


00141500      SET &CURTOP = &CURTOP+1 /* SKIP ONE EXTRA LINE    */


00141600      ISREDIT (XX) = LINENUM .MSTART


00141700      ISREDIT CURSOR = &XX


00142000      ISREDIT FIND '&TOPIC' .MSTART .MEND NEXT


00143000/*                                                                   */


00150000/*       IF MATCH: GET 1ST (&FL) AND LAST (&LL) LINE NOS.            */


00150100/*                                                                   */


00151000      IF &LASTCC = 0 THEN +


00152000         DO


00153000         ISREDIT (FL) = LINENUM .ZCSR


00153100         SET &FL = &FL + 1


00154000         ISREDIT LABEL &FL = .TSTART


00154200         ISREDIT (XZ) = LINENUM .ZCSR


00154300         SET XZ = &XZ + 1


00154400         ISREDIT LABEL &XZ = .TSEARCH


00155000         ISREDIT FIND X'AA' .TSEARCH .MEND NEXT


00156000         IF &LASTCC = 0 THEN +


00156100           DO


00156200           ISREDIT (LL) = LINENUM .ZCSR


00156300           SET LL = &LL - 1


00156400           ENDO


00158000         ELSE ISREDIT (LL) = LINENUM .ZL


00158100/*                                                                   */


00158200/*        LOOP TO DELETE ANY LEADING BLANK LINES:                    */


00158400/*                                                                   */


00159000           DO WHILE &FL LE &LL


00159200           ISREDIT (LINE) = LINE &FL


00159500           ISREDIT LABEL &FL = .NL


00159603           ISREDIT CURSOR = .NL 1


00159701           ISREDIT FIND X'BA' .NL .NL  2


00159800           IF &LASTCC = 0 OR +


00159906              &SUBSTR(1:80,&NRSTR(&LINE)) = &BLANKS OR +


00160006              &SUBSTR(1:3,&NRSTR(&LINE)) = &STR(+ _) THEN +


00160100              SET &FL = &FL +1


00160200           ELSE +


00160300              DO


00160400              SET &HAVDATA = YES


00160500/*                                                                   */


00160600/*                 copy adjusted line nos from mem                   */


00160700/*                 after topic line                                  */


00160800/*                                                                   */


00160900              ISREDIT (OFFSET) = LINENUM .ENDPAT


00161000              SET FL = &FL-&OFFSET


00161100              SET LL = &LL-&OFFSET


00161200              IF &FL > &LL THEN WRITE FL > LL IN MERGSTAT


00161300              ISREDIT COPY &MNAME AFTER &CURTOP &FL &LL


00161400              GOTO DONECOPY


00161500              ENDO


00161600           ENDO


00161700         ENDO


00161800      DONECOPY: ISREDIT LABEL &CURTOP = .CURTOP


00161900      ENDO


00162000   ELSE SET &MD = STOP


00170000   ENDO


00171000/*                                                                   */


00180000/* no more topics: delete copied member from end                     */


00180100/*                                                                   */


00181004DONE: ISREDIT DELETE .MSTART .ZLAST


00181104SET DRC = &LASTCC


00181204IF &DRC NE 0 THEN WRITE DELETE RC WAS &DRC


00181300ISPEXEC VPUT HAVDATA


00182000/*                                                                   */


00190000/* return                                                            */


./ ADD NAME=DOCSOP   0108-84006-84030-1357-00043-00037-00017-JS02150
00001004PROC 0 L FN()


00020003CONTROL NOFLUSH NOMSG END(ENDO)


00030004IF &L = L THEN CONTROL LIST MSG CONLIST


00031000ISPEXEC VGET (PDOCN PSOC PDEST)


00031104SET &DSNAME = &PDOCN


00031400FILEINFO DSN('&PDOCN')


00031500IF &LASTCC NE 0 AND &LASTCC NE 44 THEN GOTO EL


00031600IF &DSORG = PS THEN GOTO FTL


00031700   ELSE IF &DSORG = PO THEN GOTO LISTPDS


00031800        ELSE DO


00031900          EL:  SET GPM = PRINT ERROR


00032000               SET GPML = THE DATASET TO BE PRINTED IS NOT ACCEPTABLE.


00032100               ISPEXEC SETMSG MSG(GPM001)


00032200               ISPEXEC CONTROL NONDISPL END


00032300               EXIT


00032400             ENDO


00032500FTL: +


00035000FREE F(IN01 OUT01 MESSAGES)


00040004ALLOC F(IN01) DSN('&DSNAME')


00050000ALLOC F(OUT01) SYSOUT(&PSOC) DEST(&PDEST)


00060000ALLOC F(MESSAGES) DUMMY


00070000CALL 'WDPSC.SYSLIBRY(FTL)' '01'


00070106FREE F(IN01 OUT01 MESSAGES)


00071000SET GPM = DOCUMENT PRINTED


00072000SET GPML = THE DOCUMENT WAS PRINTED ON SYSOUT CLASS &PSOC AT &PDEST


00073000ISPEXEC SETMSG MSG(GPM001)


00080000ISPEXEC CONTROL NONDISPL END


00081004IF &FN NE THEN CMDOUT FREE(&FN)


00090000EXIT


00091004


00100000LISTPDS: +


00101001IF &MEMCNTL = YES THEN GOTO FTL      /* NO NEED TO DO WHOLE LIB */


00110004FREE F(SYSPRINT SYSLIB SYSIN)


00120000ALLOC F(SYSIN) DUMMY


00130000ALLOC F(SYSPRINT) DUMMY


00140000ALLOC F(SYSLIB) DSN('&PDOCN')


00140204CMDOUT DDN(SYSPUNCH)


00140304SET FN = &LASTCC


00140404CALL 'WDPSC.SYSLIBRY(LISTPDS)' 'DECK,NOLIST'


00140504WHATDSN DDN(SYSPUNCH)


00140604CHDSCB '&DSNAME' RECFM(FBA) NOLIST


00140704FREE DSN('&DSNAME')


00140804GOTO FTL


./ ADD NAME=DOCSTAT  0103-86189-86210-1821-00026-00026-00002-KX00150
00001000  PROC 1 SET D1() D2()


00010000  CONTROL NOMSG NOFLUSH END(ENDO)


00020000  IF &SET = ON THEN +


00030000     DO


00050000     SET DTYPE = DOC04


00143100     SET LVL1 = &D1


00143200     SET LVL2 = &D2


00143300     ISPEXEC VGET (DOCSLVL1 DOCSLVL2 SAMPDOC SAMPNDEX)


00143400     IF &LVL1 = &STR() THEN SET &LVL1 = &DOCSLVL1


00143503     IF &LVL2 = &STR() THEN SET &LVL2 = &DOCSLVL2


00143600     SET OSDOC = &SAMPDOC


00143700     SET OSNDEX = &SAMPNDEX


00143800     SET SAMPDOC = '&LVL1..&LVL2..CONTROL(PATTERN)'


00143902     SET SAMPNDEX = '&DOCSLVL1..&DOCSLVL2..INDEXES(CONTROL)'


00144000     ISPEXEC VPUT (LVL1 LVL2 SAMPDOC SAMPNDEX DTYPE OSDOC OSNDEX)


00145000     ENDO


00146000  IF &SET = OFF THEN +


00147000     DO


00147100     SET DTYPE =


00147200     SET LVL1 =


00147300     SET LVL2 =


00147400     ISPEXEC VGET (OSDOC OSNDEX)


00147700     SET SAMPDOC = &OSDOC


00147800     SET SAMPNDEX = &OSNDEX


00147900     ISPEXEC VPUT (LVL1 LVL2 SAMPDOC SAMPNDEX DTYPE) SHARED


00170000     ENDO


./ ADD NAME=DOCSYS   0104-85177-86254-1643-00060-00014-00053-KK00150
00010000  CONTROL NOMSG NOFLUSH END(ENDO)


00011003  IF &SYSPREF = KX00150 THEN CONTROL LIST MSG CONLIST


00013004  CLOG '&SYSDATE &SYSTIME &SYSICMD' U($$$$150) SAVE


00020000  FREE F(SYSOUT)


00021000  IFALC F(SYSOUT)


00022000  IF &LASTCC NE 0 THEN ALLOC F(SYSOUT) DSN(*)


00040000  SET &DOCSLVL1 =  WDPSC


00050000  SET &DOCSLVL2 = DOCSYS


00060000  SET &DOCSTITL = &STR(WDPSC DOCUMENTATION SYSTEM)


00060102  SET &GPML = &STR(PLEASE WAIT - INDEXES ARE BEING LOADED)


00060202  ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL GPML)


00060302  ISPEXEC CONTROL DISPLAY LOCK


00060402  ISPEXEC DISPLAY PANEL(GPM)


00060502


00066102  GETMY ACFUID


00066202  SET U = &SUBSTR(1:10,&ACFUID)


00066302  IF &U = &STR(150D3100CS) OR &U = &STR(150D360004) OR &U = &STR(150D210
0  ) THEN +

00066402     DO


00066502     SET &LIB = TECHBULL


00066602     SET &SAMPDOC = '&DOCSLVL1..&DOCSLVL2..TECHBULL(MEMO1)'


00066702     SET ACTTAB = &STR(S,SEL P,PRT E,EDT)


00066802     SET THDA1 = &STR(¢         USE "PF3¢TO EXIT,"PF5¢TO CHANGE INDEX,"P
F6¢TO ADD AN ENTRY)

00066902     SET THDA2 = &STR(¢             OPTIONS ARE"S¢FOR BROWSE,"P¢FOR PRIN
T,"E¢FOR EDIT)

00067002     SET DOCUPDT = YES


00067102     ISPEXEC VPUT (ACTTAB,THDA1,THDA2,SAMPDOC,LIB,DOCUPDT) SHARED


00067202     ENDO


00067302  ELSE +


00067402     DO


00067502     SET DOCUPDT = NO


00067602     ISPEXEC VPUT DOCUPDT SHARED


00067702     ENDO


00067802


00067902RESHOW: +


00068002  SET &DOCSMEM = PRIM


00068102  SET &DOCSEXIT = NO


00068202  ISPEXEC VPUT (DOCSMEM DOCSEXIT)


00141002  ISPEXEC SELECT PGM(PANLEXIT) PARM(TBLHNDLR,1,PRIME)


00142202  ISPEXEC VGET DOCRSHOW SHARED


00142302  IF &DOCRSHOW = YES THEN +


00142402    DO


00142502    SET DOCRSHOW =


00142602    ISPEXEC VPUT DOCRSHOW SHARED


00142702    GOTO RESHOW


00142802    ENDO


00142902


00143002  IF &U = &STR(150D3100CS) OR &U = &STR(150D360004) OR &U = &STR(150D210
0  ) THEN +

00143102    DO


00143202    SET THDA1 = &STR()


00143302    SET THDA2 = &STR()


00143402    SET ACTTAB = &STR(S,SEL P,PRT)


00143502    SET &SAMPDOC =


00143602    SET DOCUPDT =


00143702    SET &LIB =


00143802    ISPEXEC VPUT (ACTTAB,THDA1,THDA2 DOCUPDT SAMPDOC LIB) SHARED


00143902    ENDO


00144002  ELSE +


00144102    DO


00144202    SET DOCUPDT =


00144302    ISPEXEC VPUT DOCUPDT SHARED


00144402    ENDO


./ ADD NAME=DOCTECH  0116-85120-86254-1643-00030-00016-00030-KK00150
00010004  CONTROL NOMSG NOFLUSH END(ENDO)


00020015  IF &SYSPREF = KX00150 THEN CONTROL LIST MSG CONLIST


00030016  CLOG '&SYSDATE &SYSTIME &SYSICMD' U($$$$150) SAVE


00040004  IFALC F(SYSOUT)


00050004  IF &LASTCC NE 0 THEN ALLOC F(SYSOUT) DSN(*)


00060004  SET &DOCSLVL1 =  SOFTD150


00070004  SET &DOCSLVL2 = DOCSYS


00080004  SET &DOCSTITL = &STR(TECHNICAL SERVICES DOC SYSTEM)


00100004  SET &DOCSEXIT = NO


00110004  SET &GPML = &STR(PLEASE WAIT - INDEXES ARE BEING LOADED)


00120011  ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL DOCSEXIT GPML)


00130004  ISPEXEC CONTROL DISPLAY LOCK


00140004  ISPEXEC DISPLAY PANEL(GPM)


00141010RESHOW: +


00142011  SET &DOCSMEM = TECHPRIM


00150004  SET ACTTAB = &STR(S,SEL P,PRT X,XFR Z,ZIP E,EDT)


00151013  SET THDA1 = &STR(¢         USE "PF3¢TO EXIT,"PF5¢TO CHANGE INDEX,"PF6¢
TO ADD AN ENTRY)

00151113  SET THDA2 = &STR(¢          SELECT OPTIONS ARE"S¢FOR BROWSE,"P¢FOR PRI
NT,"E¢FOR EDIT)

00152008  SET DOCUPDT = YES


00160012  ISPEXEC VPUT (ACTTAB,THDA1,THDA2,LIB DOCUPDT DOCSMEM) SHARED


00170015  ISPEXEC SELECT PGM(PANLEXIT) PARM(TBLHNDLR,1,PRIME)


00180014  SET THDA1 = &STR()


00180114  SET THDA2 = &STR()


00181008  SET DOCUPDT =


00190014  ISPEXEC VPUT (ACTTAB,THDA1,THDA2 DOCUPDT) SHARED


00260010  ISPEXEC VGET DOCRSHOW SHARED


00270010  IF &DOCRSHOW NE YES THEN EXIT


00280010  SET DOCRSHOW =


00290010  ISPEXEC VPUT DOCRSHOW SHARED


00300010  GOTO RESHOW


./ ADD NAME=DOCTMERG 0100-86204-86204-1516-00042-00042-00000-KK00150
00001000ISREDIT MACRO (L)


00001100IF &L NE &STR() THEN CONTROL LIST CONLIST


00001200IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


00001300/* DONT TOSS THIS IT'S USED IN STATUS RPT SYSTEM  */


00002000ISREDIT NUMBER OFF


00003000CONTROL NOFLUSH END(ENDO)


00004000ISPEXEC CONTROL ERRORS RETURN


00005900SET &MEMNAME = &STR()


00006000ISREDIT BOUNDS 1 74


00006100ISREDIT (DATA1) = DATAID


00006200ISREDIT (MEMNAME) = MEMBER


00150000IF &MEMNAME = ALL THEN +


00151000   DO


00151200   ISREDIT DELETE ALL NX


00152000   ISREDIT DEFINE DOCSMERG CMD MACRO


00160100   ISREDIT COPY PATTERN AFTER 0


00160200   ISREDIT RESET SPECIAL


00162000   ISREDIT (CURMBR) = MEMBER


00163000   ISPEXEC LMOPEN DATAID(&DATA1) OPTION(INPUT)


00164000   SET LMRC = &LASTCC


00165000      DO WHILE (&LMRC = 0)


00166000      ISPEXEC LMMLIST DATAID(&DATA1) MEMBER(MEMBER) STATS(YES)


00167000      SET LMRC = &LASTCC


00168000      IF &LMRC = 0 AND &ZLCNORC NE 0 THEN +


00169000         DO


00169100         IF (&MEMBER NE &CURMBR) AND +


00169200            (&MEMBER NE PATTERN) AND +


00169300            (&MEMBER NE SCRIPT) AND +


00169500            (&MEMBER NE FINAL) THEN +


00169600               DO


00169700               ISREDIT DOCQMERG &MEMBER &L


00169800               ISPEXEC VGET HAVDATA


00169900               IF &HAVDATA = YES THEN +


00170000               ISREDIT LINE_AFTER 0 = MSGLINE +


00170100                  '&MEMBER HAS TURNED IN A STATUS REPORT - &ZLMDATE.'


00170200               ENDO


00170300         ENDO


00170400      ENDO


00170500   ISREDIT UP MAX


00170600   ISPEXEC LMMLIST DATAID(&DATA1) OPTION(FREE)


00171000   ISPEXEC LMCLOSE DATAID(&DATA1)


00180000   ENDO


./ ADD NAME=DOCTOPRT 0100-84086-84086-1417-00050-00050-00000-KK00150
00011000PROC 6 DUMMYA DUMMYB LISTLIB HIQ MIDQ DDESC


00020000CONTROL NOFLUSH END(ENDO)


00030000IF &STR(&LISTLIB) = DUMMY1 THEN +


00040000    DO


00041000     SET &GPM = NO PRINT AVAILABLE


00042000     SET &GPML = NO PRINT IS AVAILABLE FOR THIS SELECTION


00050000     ISPEXEC SETMSG MSG(GPM001)


00060000     EXIT


00070000    ENDO


00070100


00070200          ISPEXEC VGET (DOCSLVL1 DOCSLVL2 DOCSTITL)


00070300          SET &DOCSAVL1 = &DOCSLVL1


00070400          SET &DOCSAVL2 = &DOCSLVL2


00070500          SET &DOCSAITL = &DOCSTITL


00070600          SET &DOCSLVL1 = &HIQ


00070700          SET &DOCSLVL2 = &MIDQ


00070800          SET &DOCSTITL = &STR(&DDESC)


00070900          ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL)


00071000


00080000SET PL = &LENGTH(&STR(&LISTLIB))


00090000IF &SUBSTR(&PL-1,&STR(&LISTLIB)) = &STR(-) THEN +


00100000  DO


00110000   SET PT = &SUBSTR(&PL,&STR(&LISTLIB))


00120000   SET &LISTLIB = &SUBSTR(1:&PL-2,&STR(&LISTLIB))


00130000  ENDO


00140000  ELSE SET PT = 1


00141000SET &PDOCN = &DOCSLVL1..&DOCSLVL2..&LISTLIB


00141200


00142200ISPEXEC SELECT PGM(PASSDEST)


00142300ISPEXEC VGET DEFDEST


00142400IF &DEFDEST = LOCAL THEN SET DEFDEST = WDPSC


00142500


00142600GETMY PROG SYS ACCT


00142700


00142800ISPEXEC VGET (PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00142900


00143000IF &PDEST = THEN SET &PDEST = &DEFDEST


00143100IF &PSOC = THEN SET &PSOC = A


00143200IF &STR(&PACCT) = THEN SET &PACCT = &STR(&ACCT)


00143300IF &STR(&PPROG) = THEN SET &PPROG = &PROG


00143400IF &PJOBC = THEN SET &PJOBC = D


00143500IF &PCOPIES = THEN SET &PCOPIES = 1


00143600


00143700ISPEXEC VPUT (PDOCN PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00143800


00143900ISPEXEC SELECT PANEL(DOCPM&PT)


00144000          SET &DOCSLVL1 = &DOCSAVL1


00145000          SET &DOCSLVL2 = &DOCSAVL2


00146000          SET &DOCSTITL = &DOCSAITL


00147000          ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL)


./ ADD NAME=DOCTOSEL 0111-84086-86254-1656-00027-00019-00027-KK00150
00010010  PROC 6 MEMNAME ENTRYCNT DUMMY1 HIQ MIDQ DDESC


00020010  CONTROL NOMSG NOFLUSH END(ENDO)


00021010  IF &SYSPREF = KX00150 THEN CONTROL LIST MSG CONLIST


00021111  GETMY ACFUID


00022011  IF &SUBSTR(1:4,&ACFUID) NE &STR(150D) THEN +


00023010     DO


00024010     SET GPM = NOT AVAILABLE


00024110     SET GPML = THIS SELECTION RESTRICTED TO WDPSC PERSONNEL


00025010     ISPEXEC SETMSG MSG(GPM001)


00025110     EXIT


00026010     ENDO


00030010  ISPEXEC VGET (DOCSLVL1 DOCSLVL2 DOCSTITL)


00040010  SET &DOCSAVL1 = &DOCSLVL1


00050010  SET &DOCSAVL2 = &DOCSLVL2


00060010  SET &DOCSAITL = &DOCSTITL


00070010  SET &DOCSLVL1 = &HIQ


00080010  SET &DOCSLVL2 = &MIDQ


00090010  SET &DOCSTITL = &STR(&DDESC)


00100010  ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL)


00141010  SET &DOCSMEM = &MEMNAME


00142010  ISPEXEC VPUT DOCSMEM


00143010  IF &MEMNAME = PRIM THEN SET &MEMNAME = PRIMET


00150010  ISPEXEC SELECT PGM(TBLHNDLR) PARM(&ENTRYCNT,&MEMNAME)


00160010  SET &DOCSLVL1 = &DOCSAVL1


00170010  SET &DOCSLVL2 = &DOCSAVL2


00180010  SET &DOCSTITL = &DOCSAITL


00190010  ISPEXEC VPUT (DOCSLVL1 DOCSLVL2 DOCSTITL)


./ ADD NAME=DOCUPDAT 0102-86169-86169-1845-00054-00052-00003-KK00150
00010000PROC 3 A B C DATAIDS


00020000CONTROL NOMSG NOFLUSH END(ENDO)


00021000IF &SYSPREF = KX00150 THEN CONTROL MSG CONLIST LIST


00030000


00061000/*  OPEN CONTROL FILE:    */


00061100


00061300   SET D1 = &STR(&A)


00061400   SET D2 = &STR(&C)


00061500   IF &DATAIDS = DATAIDS THEN +


00061600      DO


00061700      ISPEXEC LMQUERY DATAID(&A) DATASET(D1)


00061800      ISPEXEC LMQUERY DATAID(&C) DATASET(D2)


00061900      GOTO O


00062000      ENDO


00069300   ISPEXEC LMINIT DATAID(C) DATASET(&D2) ENQ(SHR)


00069500   IF &LASTCC NE 0 THEN +


00069600      DO


00070400ERRX: SET &GPM = &STR(&ZERRSM)


00070500      SET &GPML = &STR(&ZERRLM)


00070600      ISPEXEC SETMSG MSG(GPM001)


00070900      EXIT CODE(99)


00071000      ENDO


00071100O: ISPEXEC LMOPEN DATAID(&C)


00071200   SET ORC2 = &LASTCC


00071300   IF &ORC2 NE 0 AND &ORC2 NE 12 THEN GOTO ERRX


00071400   ISPEXEC LMMFIND DATAID(&C) MEMBER(&B) STATS(YES)


00071500   IF &LASTCC NE 0 THEN GOTO ERRX


00071600   SET CDATE = &STR(&ZLMDATE)


00071700   SET CTIME = &STR(&ZLMTIME)


00071800


00071900


00072000/*  OPEN STATUS FILE:    */


00072100


00072200IF &DATAIDS = DATAIDS THEN GOTO O2


00072300ISPEXEC LMINIT DATAID(A) DATASET('&D1') ENQ(SHR)


00103100IF &LASTCC NE 0 THEN GOTO ERRX


00103800O2: +


00103900ISPEXEC LMOPEN DATAID(&A)


00104000SET ORC1 = &LASTCC


00104100IF &ORC1 NE 0 AND &ORC1 NE 12 THEN GOTO ERRX


00104200ISPEXEC LMMFIND DATAID(&A) MEMBER(&B) STATS(YES)


00104300SET RC = &LASTCC


00104400IF &RC NE 0 AND &RC NE 8 THEN GOTO ERRX


00104500IF &ZLMDATE NE &CDATE OR &ZLMTIME NE &CTIME OR &RC = 8 THEN +


00104600  DO


00104702  SET &SYSOUTTRAP = 9


00105101  PDS &D2 COPY &B &D1 REPLACE SHR NOLIST


00105202  SET &SYSOUTTRAP = 0


00106000  ENDO


00107000


00108000IF &ORC1 = 0 THEN +


00140000  ISPEXEC LMCLOSE DATAID(&A)


00141000IF &ORC2 = 0 THEN +


00150000  ISPEXEC LMCLOSE DATAID(&C)


./ ADD NAME=DOCWMERG 0102-86168-86168-1557-00096-00096-00002-KK00150
00010000ISREDIT MACRO (MNAME,L)


00012002IF &SYSPREF = KX00150 THEN CONTROL LIST CONLIST


00020000/* DONT TOSS THIS IT'S USED IN STATUS RPT SYSTEM  */


00030000ISREDIT NUMBER OFF


00040000CONTROL NOFLUSH END(ENDO)


00050000ISPEXEC CONTROL ERRORS RETURN


00060000/*                                                                   */


00061000/* LABEL LAST PATTERN LINE                                   */


00062000/*                                                                   */


00063100ISREDIT LABEL .ZL = .ENDPAT


00071000/*                                                                   */


00080000/* COPY  member at end of pattern                                    */


00081000/*                                                                   */


00090000ISREDIT COPY &MNAME AFTER .ENDPAT


00091000SET &HAVDATA = NO    /* SAY NO GOOD DATA AT FIRST  */


00100000ISREDIT (LN) = LINENUM .ENDPAT


00102000SET &LN = &LN+1


00102100ISREDIT LABEL &LN = .MSTART


00103000ISREDIT LABEL .ZL = .MEND


00103102ISREDIT CHANGE X'50' X'5050' .MSTART .MEND ALL  /* ampers make havok */


00104000/*                                                                   */


00110000/* LOOP: FIND TOPIC LINE                                             */


00110100/*                                                                   */


00110200ISREDIT LABEL 1 = .CURTOP


00111000SET &MD = GO


00120000   DO WHILE &MD = GO


00121000   ISREDIT CURSOR = .CURTOP       /*  KERMIT CHANGE TIL UZ41259 */


00130000   ISREDIT FIND X'AA'


00131000   IF &LASTCC = 0 THEN +


00132000      DO


00133000/*                                                                   */


00140000/*       search for matching topic                                   */


00140100/*                                                                   */


00140200      ISREDIT (CURTOP) = LINENUM .ZCSR


00140300      ISREDIT (ENDPAT) = LINENUM .ENDPAT


00140400      IF &CURTOP > &ENDPAT THEN GOTO DONE /* CHECK RE UZ41259 */


00140500      SET &CURTOP = &CURTOP+2 /* POINT PAST UNDERLINE AND 1ST BLANK LINE
S */

00141000      ISREDIT (TOPIC) = LINE .ZCSR


00141100      SET &TOPIC = &SUBSTR(1:50,&STR(&TOPIC))


00141300      ISREDIT (XX) = LINENUM .MSTART


00141400      ISREDIT CURSOR = &XX


00142000      ISREDIT FIND '&TOPIC' .MSTART .MEND NEXT


00143000/*                                                                   */


00150000/*       IF MATCH: GET 1ST (&FL) AND LAST (&LL) LINE NOS.            */


00150100/*                                                                   */


00151000      IF &LASTCC = 0 THEN +


00152000         DO


00153000         ISREDIT (FL) = LINENUM .ZCSR


00153100         SET &FL = &FL + 1


00154000         ISREDIT LABEL &FL = .TSTART


00154200         ISREDIT (XZ) = LINENUM .ZCSR


00154300         SET XZ = &XZ + 1


00154400         ISREDIT LABEL &XZ = .TSEARCH


00155000         ISREDIT FIND X'AA' .TSEARCH .MEND NEXT


00156000         IF &LASTCC = 0 THEN +


00156100           DO


00156200           ISREDIT (LL) = LINENUM .ZCSR


00156300           SET LL = &LL - 1


00156400           ENDO


00158000         ELSE ISREDIT (LL) = LINENUM .ZL


00158100/*                                                                   */


00158200/*        LOOP TO DELETE ANY LEADING BLANK LINES:                    */


00158400/*                                                                   */


00159000           DO WHILE &FL LE &LL


00159100           ISREDIT (LINE) = LINE &FL


00159300           SET &BLANKS = &SUBSTR(1:80,&STR(
                                                              ))

00159500           IF &SUBSTR(1:80,&STR(&LINE)) = &BLANKS OR +


00159600              &SUBSTR(1:3,&STR(&LINE)) = &STR(+ _) THEN +


00159700              SET &FL = &FL +1


00159800           ELSE +


00159900              DO


00160000              SET &HAVDATA = YES


00160100/*                                                                   */


00160200/*                 copy adjusted line nos from mem                   */


00160300/*                 after topic line                                  */


00160400/*                                                                   */


00160500              ISREDIT (OFFSET) = LINENUM .ENDPAT


00160600              SET FL = &FL-&OFFSET


00160700              SET LL = &LL-&OFFSET


00160800              IF &FL > &LL THEN WRITE FL > LL IN MERGSTAT


00160900              ISREDIT COPY &MNAME AFTER &CURTOP &FL &LL


00161000              GOTO DONECOPY


00161100              ENDO


00161300           ENDO


00161400         ENDO


00161700      DONECOPY: ISREDIT LABEL &CURTOP = .CURTOP


00161800      ENDO


00162000   ELSE SET &MD = STOP


00170000   ENDO


00171000/*                                                                   */


00180000/* no more topics: delete copied member from end                     */


00180100/*                                                                   */


00181000DONE: ISREDIT DELETE .MSTART .MEND


00181100ISPEXEC VPUT HAVDATA


00182000/*                                                                   */


00190000/* return                                                            */


./ ADD NAME=DOC01EDT 0103-85179-86190-1820-00004-00004-00002-KX00150
00010002  PROC 3 MEMNAME ENTRYCNT DUMMY1 TYPE() D1() D2() D3()


00020000  CONTROL NOMSG NOFLUSH END(ENDO)


00021000  ISPEXEC VGET (DOCSLVL1 DOCSLVL2)


00150003  ISPEXEC EDIT   DATASET('&DOCSLVL1..&DOCSLVL2..INDEXES(&MEMNAME)') MACR
O(DOCEDUP)

./ ADD NAME=DOC01PRT 0116-83336-86189-1705-00039-00007-00036-KK00150
00010016PROC 3 DUMMYA DUMMYB LISTLIB TYPE() D1() D2() D3()


00020010CONTROL NOFLUSH END(ENDO)


00021011ISPEXEC VGET DOCSLVL1


00022011ISPEXEC VGET DOCSLVL2


00030012IF &STR(&LISTLIB) = DUMMY1 THEN +


00040000    DO


00041001     SET &GPM = NO PRINT AVAILABLE


00042001     SET &GPML = NO PRINT IS AVAILABLE FOR THIS SELECTION


00050001     ISPEXEC SETMSG MSG(GPM001)


00060000     EXIT


00070000    ENDO


00071006


00080012SET PL = &LENGTH(&STR(&LISTLIB))


00090012IF &SUBSTR(&PL-1,&STR(&LISTLIB)) = &STR(-) THEN +


00100002  DO


00110012   SET PT = &SUBSTR(&PL,&STR(&LISTLIB))


00120012   SET &LISTLIB = &SUBSTR(1:&PL-2,&STR(&LISTLIB))


00130002  ENDO


00140002  ELSE SET PT = 1


00141012SET &PDOCN = &DOCSLVL1..&DOCSLVL2..&LISTLIB


00141206


00142204ISPEXEC SELECT PGM(PASSDEST)


00142306ISPEXEC VGET DEFDEST


00142406IF &DEFDEST = LOCAL THEN SET DEFDEST = WDPSC


00142506


00142606GETMY PROG SYS ACCT


00142706


00142807ISPEXEC VGET (PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00142906


00143006IF &PDEST = THEN SET &PDEST = &DEFDEST


00143106IF &PSOC = THEN SET &PSOC = A


00143206IF &STR(&PACCT) = THEN SET &PACCT = &STR(&ACCT)


00143314IF &STR(&PPROG) = THEN SET &PPROG = &STR(&PROG)


00143406IF &PJOBC = THEN SET &PJOBC = D


00143506IF &PCOPIES = THEN SET &PCOPIES = 1


00143604


00143707ISPEXEC VPUT (PDOCN PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00143806


00143903ISPEXEC SELECT PANEL(DOCPM&PT)


./ ADD NAME=DOC01SEL 0113-83335-86189-1807-00025-00006-00000-KX00150
          PROC 3 MEMNAME ENTRYCNT DUMMY1 TYPE() D1() D2() D3()


          CONTROL NOMSG NOFLUSH END(ENDO)


          IF &SYSPREF = KX00150 THEN CONTROL LIST MSG CONLIST


          IF &D1 NE &STR() THEN SET &D1 = D1(&D1)


          IF &D2 NE &STR() THEN SET &D2 = D2(&D2)


          IF &D3 NE &STR() THEN SET &D3 = D3(&D3)


          ISPEXEC VGET DOCSMEM


          SET SAVEMEM = &DOCSMEM


        RESHOW: +


          SET &DOCSMEM = &MEMNAME


          ISPEXEC VPUT (DOCSMEM ENTRYCNT) SHARED


          IF &TYPE NE &STR() THEN &TYPE ON &D1 &D2 &D3


          ISPEXEC SELECT PGM(PANLEXIT) PARM(TBLHNDLR,&ENTRYCNT,&MEMNAME)


          SET RC = &LASTCC


          IF &SYSPREF = KX00150 THEN WRITE LASTCC WAS &RC


          IF &TYPE NE &STR() THEN &TYPE OFF &D1 &D2 &D3


          SET &DOCSMEM = &SAVEMEM


          ISPEXEC VPUT (DOCSMEM) SHARED


          ISPEXEC VGET DOCRSHOW SHARED


          IF &DOCRSHOW = YES THEN +


            DO


            SET DOCRSHOW =


            ISPEXEC VPUT DOCRSHOW SHARED


            GOTO RESHOW


            ENDO


./ ADD NAME=DOC02EDT 0100-85179-85179-1630-00011-00011-00000-KX00150
        PROC 3 A B C


        CONTROL NOFLUSH END(ENDO)





        SET PL = &LENGTH(&STR(&C))


        IF &SUBSTR(&PL-1,&STR(&C)) = &STR(-) THEN +


           SET &C = &SUBSTR(1:&PL-2,&STR(&C))





        IF &C = DUMMY1 THEN SET &PDOCN = &A(&B)


                       ELSE SET &PDOCN = &C





        ISPEXEC EDIT   DATASET('&PDOCN')


./ ADD NAME=DOC02PRT 0101-84081-84081-1357-00032-00034-00032-KK00150
00010001PROC 3 A B C


00020001CONTROL NOFLUSH END(ENDO)


00071001


00080001SET PL = &LENGTH(&STR(&C))


00090001IF &SUBSTR(&PL-1,&STR(&C)) = &STR(-) THEN +


00100001  DO


00110001   SET PT = &SUBSTR(&PL,&STR(&C))


00120001   SET &C = &SUBSTR(1:&PL-2,&STR(&C))


00130001  ENDO


00140001  ELSE SET PT = 1


00140101


00141001IF &C = DUMMY1 THEN SET &PDOCN = &A(&B)


00141101               ELSE SET &PDOCN = &C


00141201


00142201ISPEXEC SELECT PGM(PASSDEST)


00142301ISPEXEC VGET DEFDEST


00142401IF &DEFDEST = LOCAL THEN SET DEFDEST = WDPSC


00142501


00142601GETMY PROG SYS ACCT


00142701


00142801ISPEXEC VGET (PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00142901


00143001IF &PDEST = THEN SET &PDEST = &DEFDEST


00143101IF &PSOC = THEN SET &PSOC = A


00143201IF &STR(&PACCT) = THEN SET &PACCT = &STR(&ACCT)


00143301IF &STR(&PPROG) = THEN SET &PPROG = &STR(&PROG)


00143401IF &PJOBC = THEN SET &PJOBC = D


00143501IF &PCOPIES = THEN SET &PCOPIES = 1


00143601


00143701ISPEXEC VPUT (PDOCN PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00143801


00143901ISPEXEC SELECT PANEL(DOCPM&PT)


./ ADD NAME=DOC02SEL 0102-84081-87034-1823-00019-00010-00000-KK00150
        PROC 3 A B C


        CONTROL NOFLUSH END(ENDO)





        SET PL = &LENGTH(&STR(&C))


        IF &SUBSTR(&PL-1,&STR(&C)) = &STR(-) THEN +


           SET &C = &SUBSTR(1:&PL-2,&STR(&C))





        IF &C = DUMMY1 THEN SET &PDOCN = &A(&B)


                       ELSE SET &PDOCN = &C





        ISPEXEC CONTROL ERRORS RETURN


        ISPEXEC BROWSE DATASET('&PDOCN')


        IF &LASTCC NE 0 THEN +


            DO


            SET &GPM = &STR(NOT AVAILABLE)


            SET &GPML = THE ITEM SELECTED MAY BE EMPTY


            ISPEXEC SETMSG MSG(GPM001)


            EXIT


            ENDO


./ ADD NAME=DOC03EDT 0100-85179-85179-1635-00010-00010-00000-KX00150
        PROC 3 LISTLIB MEMNAME OPTLIB


        CONTROL MSG NOFLUSH END(ENDO)


        ISPEXEC VGET DOCSLVL1


        ISPEXEC VGET DOCSLVL2


        SET PL = &LENGTH(&STR(&OPTLIB))


        IF &SUBSTR(&PL-1,&STR(&OPTLIB)) = &STR(-) THEN +


           SET &OPTLIB = &SUBSTR(1:&PL-2,&STR(&OPTLIB))


        IF &OPTLIB = DUMMY1 THEN SET &LOWQUAL = &STR(&LISTLIB(&MEMNAME))


               ELSE SET &LOWQUAL = &OPTLIB


        ISPEXEC EDIT   DATASET('&DOCSLVL1..&DOCSLVL2..&LOWQUAL')


./ ADD NAME=DOC03PRT 0107-83341-84032-1639-00034-00037-00007-JS02150
00012000PROC 3 A B C


00020000CONTROL NOFLUSH END(ENDO)


00030006ISPEXEC VGET DOCSLVL1


00040006ISPEXEC VGET DOCSLVL2


00071005


00080000SET PL = &LENGTH(&STR(&C))


00090000IF &SUBSTR(&PL-1,&STR(&C)) = &STR(-) THEN +


00100000  DO


00110000   SET PT = &SUBSTR(&PL,&STR(&C))


00120000   SET &C = &SUBSTR(1:&PL-2,&STR(&C))


00130000  ENDO


00140000  ELSE SET PT = 1


00140102


00140206IF &C = DUMMY1 THEN SET &PDOCN = &DOCSLVL1..&DOCSLVL2..&A(&B)


00140306               ELSE SET &PDOCN = &DOCSLVL1..&DOCSLVL2..&C


00141100


00142200ISPEXEC SELECT PGM(PASSDEST)


00142300ISPEXEC VGET DEFDEST


00142400IF &DEFDEST = LOCAL THEN SET DEFDEST = WDPSC


00142500


00142600GETMY PROG SYS ACCT


00142700


00142800ISPEXEC VGET (PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00142900


00143000IF &PDEST = THEN SET &PDEST = &DEFDEST


00143100IF &PSOC = THEN SET &PSOC = A


00143200IF &STR(&PACCT) = THEN SET &PACCT = &STR(&ACCT)


00143307IF &STR(&PPROG) = THEN SET &PPROG = &STR(&PROG)


00143400IF &PJOBC = THEN SET &PJOBC = D


00143500IF &PCOPIES = THEN SET &PCOPIES = 1


00143600


00143700ISPEXEC VPUT (PDOCN PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00143800


00143900ISPEXEC SELECT PANEL(DOCPM&PT)


./ ADD NAME=DOC03SEL 0104-83335-87034-1824-00018-00003-00000-KK00150
        PROC 3 LISTLIB MEMNAME OPTLIB


        CONTROL MSG NOFLUSH END(ENDO)


        ISPEXEC VGET DOCSLVL1


        ISPEXEC VGET DOCSLVL2


        SET PL = &LENGTH(&STR(&OPTLIB))


        IF &SUBSTR(&PL-1,&STR(&OPTLIB)) = &STR(-) THEN +


           SET &OPTLIB = &SUBSTR(1:&PL-2,&STR(&OPTLIB))


        IF &OPTLIB = DUMMY1 THEN SET &LOWQUAL = &STR(&LISTLIB(&MEMNAME))


               ELSE SET &LOWQUAL = &OPTLIB


        ISPEXEC CONTROL ERRORS RETURN


        ISPEXEC BROWSE DATASET('&DOCSLVL1..&DOCSLVL2..&LOWQUAL')


        IF &LASTCC NE 0 THEN +


            DO


            SET &GPM = &STR(NOT AVAILABLE)


            SET &GPML = THE ITEM SELECTED MAY BE EMPTY


            ISPEXEC SETMSG MSG(GPM001)


            EXIT


            ENDO


./ ADD NAME=DOC04EDT 0110-86059-86189-1639-00081-00064-00029-KK00150
00010000PROC 3 A B C


00020002CONTROL NOMSG NOFLUSH END(ENDO)


00021000IF &SYSPREF = KX00150 THEN CONTROL MSG CONLIST LIST


00022010ISPEXEC CONTROL ERRORS RETURN


00023010ISPEXEC VGET (DOCSLVL1 DOCSLVL2)


00030000


00040000SET PL = &LENGTH(&STR(&C))


00050000IF &SUBSTR(&PL-1,&STR(&C)) = &STR(-) THEN +


00060000   SET &C = &SUBSTR(1:&PL-2,&STR(&C))


00060100


00061000/*  OPEN CONTROL FILE:    */


00061100


00062000   SET L = &LENGTH(&A)


00062110   IF &L < 9 THEN SET A = &DOCSLVL1..&DOCSLVL2..&A


00062210   SET L = &LENGTH(&A)


00063000      DO WHILE &L > 1


00064000         IF &SUBSTR(&L,&A) = &STR(.) THEN +


00065000            DO


00066000            SET SP = &SUBSTR(1:&L-1,&A)


00067000            SET &L = 1


00068000            ENDO


00069000         SET L = &L - 1


00069100      ENDO


00069200   SET CTLDSN = &SP..CONTROL


00069300   ISPEXEC LMINIT DATAID(STATCON) DATASET('&CTLDSN') ENQ(SHR)


00069500   IF &LASTCC NE 0 THEN +


00069600      DO


00070402ERRX: SET &GPM = &STR(&ZERRSM)


00070502      SET &GPML = &STR(&ZERRLM)


00070602      ISPEXEC SETMSG MSG(GPM001)


00070702      ISPEXEC LMCLOSE DATAID(&STATCON)


00070802      ISPEXEC LMCLOSE DATAID(&STATMON)


00070900      EXIT


00071000      ENDO


00071100   ISPEXEC LMOPEN DATAID(&STATCON)


00071200   IF &LASTCC NE 0 THEN GOTO ERRX


00071302   ISPEXEC LMMFIND DATAID(&STATCON) MEMBER(PATTERN) STATS(YES)


00071400   IF &LASTCC NE 0 THEN GOTO ERRX


00071502   SET CDATE = &STR(&ZLMDATE)


00071602   SET CTIME = &STR(&ZLMTIME)


00071700


00071800


00071900/*  OPEN STATUS FILE:    */


00072000


00072100ISPEXEC LMINIT DATAID(STATMON) DATASET('&A') ENQ(SHRW)


00072200IF &LASTCC NE 0 THEN +


00072300   DO


00072400   IFCAT '&A'


00072500   IF &LASTCC NE 0 THEN +


00073000     DO


00102300     IFALC DDN(KKCF)


00102500     IF &LASTCC NE 0 THEN ATTR KKCF RECFM(V B A) LRECL(85) BL(8000)


00102608     FILEINFO DSN('&CTLDSN')


00102700     ALLOC DSN('&A') NEW TRACK SP(1 1) US(KKCF) VOL(&VOLSER) DIR(5)


00102800     ISPEXEC LMINIT DATAID(STATMON) DATASET('&A') ENQ(SHRW)


00102900     IF &LASTCC NE 0 THEN GOTO ERRX


00103000     ENDO


00103100   ELSE GOTO ERRX


00103700   ENDO


00103800ISPEXEC LMOPEN DATAID(&STATMON)


00103900IF &LASTCC NE 0 THEN GOTO ERRX


00104002ISPEXEC LMMFIND DATAID(&STATMON) MEMBER(PATTERN) STATS(YES)


00104102SET RC = &LASTCC


00104202IF &RC NE 0 AND &RC NE 8 THEN GOTO ERRX


00104302IF &ZLMDATE NE &CDATE OR &ZLMTIME NE &CTIME OR &RC = 8 THEN +


00104400  DO


00104507  ISPEXEC LMCLOSE DATAID(&STATMON)


00104609/*  ISPEXEC LMOPEN DATAID(&STATMON) OPTION(OUTPUT)  */


00104707  IF &LASTCC NE 0 THEN GOTO ERRX


00104810  SET &SYSOUTTRAP = 9


00104910  PDS '&CTLDSN' COPY PATTERN '&A' REPLACE SHR NOLIST


00105010  SET &SYSOUTTRAP = 0


00105300  ENDO


00106000


00107007/* NOW TRANSFER TO EDIT MACRO  */


00108007


00111000ISPEXEC VPUT (STATCON STATMON) SHARED


00112007ISPEXEC LMCLOSE DATAID(&STATCON)


00113007ISPEXEC LMCLOSE DATAID(&STATMON)


00120000


00130003ISPEXEC EDIT DATAID(&STATMON) MEMBER(&B) MACRO(&C)


./ ADD NAME=DOC04PRT 0102-86010-86189-1642-00034-00032-00004-KK00150
00010000PROC 3 A B C


00020000CONTROL NOFLUSH END(ENDO)


00071000


00080000SET PL = &LENGTH(&STR(&C))


00090000IF &SUBSTR(&PL-1,&STR(&C)) = &STR(-) THEN +


00100000  DO


00110000   SET PT = &SUBSTR(&PL,&STR(&C))


00120000   SET &C = &SUBSTR(1:&PL-2,&STR(&C))


00130000  ENDO


00140000  ELSE SET PT = 1


00140100


00140202ISPEXEC VGET (DOCSLVL1 DOCSLVL2)


00140302SET L = &LENGTH(&A)


00140402IF &L < 9 THEN SET A = &DOCSLVL1..&DOCSLVL2..&A


00141001SET &PDOCN = &A(&B)


00141200


00142200ISPEXEC SELECT PGM(PASSDEST)


00142300ISPEXEC VGET DEFDEST


00142400IF &DEFDEST = LOCAL THEN SET DEFDEST = WDPSC


00142500


00142600GETMY PROG SYS ACCT


00142700


00142800ISPEXEC VGET (PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00142900


00143000IF &PDEST = THEN SET &PDEST = &DEFDEST


00143100IF &PSOC = THEN SET &PSOC = A


00143200IF &STR(&PACCT) = THEN SET &PACCT = &STR(&ACCT)


00143300IF &STR(&PPROG) = THEN SET &PPROG = &STR(&PROG)


00143400IF &PJOBC = THEN SET &PJOBC = D


00143500IF &PCOPIES = THEN SET &PCOPIES = 1


00143600


00143700ISPEXEC VPUT (PDOCN PSOC PDEST PACCT PJOBC PPROG PCOPIES)


00143800


00143900ISPEXEC SELECT PANEL(DOCPM&PT)


./ ADD NAME=DOC04SEL 0104-86010-86189-1644-00030-00011-00000-KK00150
        PROC 3 A B C


        CONTROL NOFLUSH END(ENDO)





        SET PL = &LENGTH(&STR(&C))


        IF &SUBSTR(&PL-1,&STR(&C)) = &STR(-) THEN +


           SET &C = &SUBSTR(1:&PL-2,&STR(&C))





        ISPEXEC VGET (DOCSLVL1 DOCSLVL2)


        SET L = &LENGTH(&A)


        IF &L < 9 THEN SET A = &DOCSLVL1..&DOCSLVL2..&A


        SET &PDOCN = &A(&B)





        FILEINFO DSN('&PDOCN')


        IF &LASTCC NE 0 THEN +


            DO


            SET &GPM = &STR(NOT AVAILABLE)


            SET &GPML = THE ITEM SELECTED MAY NOT EXIST YET


            ISPEXEC SETMSG MSG(GPM001)


            EXIT


            ENDO





        ISPEXEC CONTROL ERRORS RETURN


        ISPEXEC BROWSE DATASET('&PDOCN')


        IF &LASTCC NE 0 THEN +


            DO


            SET &GPM = &STR(NOT AVAILABLE)


            SET &GPML = THE ITEM SELECTED MAY BE EMPTY


            ISPEXEC SETMSG MSG(GPM001)


            EXIT


            ENDO


./ ADD NAME=DSN      0118-80046-85113-1609-00006-00003-00005-JS02150
00010000PROC 1 DSN


00020003IF &SUBSTR(1,&DSN) = &STR(') THEN +


00020103           SET &DSN = &SUBSTR(2:&LENGTH(&STR(&DSN))-1,&STR(&DSN))


00021003                             ELSE +


00022003           SET &DSN = &STR(&SYSPREF..&DSN)


00030010DSNQ  &DSN.*


./ ADD NAME=EDITAPP  0115-85291-89121-1021-00251-00236-00251-LL02155
00010013PROC 0 ZENVIR() ZSCREEND(24) MSGID(BMWE100) Z() +


00020013     W88APP01() W88APP02() W88APP03() W88APP04() W88APP05() W88APP06()+


00030013     W88APP07() W88APP08() W88APP09() W88APP10() W88APP11() W88APP12()+


00040013     W88APP13() W88APP14() W88APP15() W88APP16() W88APP17() W88APP18()+


00050013     W88APP19() W88APP20() W88APP21() W88APP22() W88APP23() W88APP24()


00060013


00070013 CONTROL NOMSG NOFLUSH END(ENDO)


00080013 IF &SYSPREF = KX00155 THEN CONTROL MSG LIST CONLIST


00090013


00091015/* %TRAK EDITAPP PROD###


00100013BEGIN:  SET W88X = &STR(&&W88X)


00110013        SET W88APP = &STR(&&W88APP)


00120013        SET S = &STR(&&S)


00130013


00140013            ISPEXEC VGET ( +


00150013 W88APP01 W88APP02 W88APP03 W88APP04 W88APP05 W88APP06 W88APP07 +


00160013 W88APP08 W88APP09 W88APP10 W88APP11 W88APP12 W88APP13 W88APP14 +


00170013 W88APP15 W88APP16 W88APP17 W88APP18 W88APP19 W88APP20 W88APP21 +


00180013 W88APP22 W88APP23 W88APP24) PROFILE


00190013


00200013/* START OF ISPF V2 RECOVERY CODE:  */


00210013/* NOTE NEW PARMS INITIALIZED ON PROC STATEMENT (Z VARS) */


00220013


00230013ISPEXEC VGET (ZENVIR ZSCREEND)


00240013IF &STR(&ZENVIR) NE &Z THEN +


00250013  DO


00260013  ISPEXEC EDREC INIT


00270013  SET DONE = NO


00280013  DO WHILE &DONE = NO


00290013    ISPEXEC EDREC QUERY


00300013    IF &LASTCC = 4 THEN +


00310013      DO


00320013      ISPEXEC DISPLAY PANEL(ISREDM02)


00330013      IF &LASTCC NE 0 THEN DO


00340013                           ISPEXEC EDREC DEFER


00350013                           EXIT


00360013                           ENDO


00370013      IF &ZEDCMD = C THEN ISPEXEC EDREC CANCEL


00380013      IF &ZEDCMD = D THEN ISPEXEC EDREC DEFER


00390013      IF &ZEDCMD = &Z THEN ISPEXEC EDREC PROCESS


00400013      ENDO


00410013    ELSE SET DONE = YES


00420013  ENDO


00430013ENDO


00440013/* END OF ISPF V2 RECOVERY CODE.  */


00450013


00460013/* FIRST TIME CHECK:  */


00470013


00480013ISPEXEC VGET KKMEF PROFILE


00490013IF &KKMEF = &STR() THEN DO


00500013   SET &KKMEF = Y


00510013   ISPEXEC VPUT KKMEF PROFILE


00520013   IF &W88APP01 NE &STR() THEN GOTO DSPLPANL


00530013   SET &APPNO = &STR(01)


00540013   SET W88APP01 = &STR(YOUR OLD BETTER EDIT DATASETS)


00550013   GOTO INITSET


00560013   ENDO


00570013


00580013 /* CHECK FOR APPL ALREADY SELECTED: */


00590013ISPEXEC VGET ZTRAIL SHARED


00600013IF &ZTRAIL NE &STR() THEN DO


00610013   SET &ZCMD = &ZTRAIL


00620013   SET &ZTRAIL = &STR()


00630013   ISPEXEC VPUT ZTRAIL SHARED


00640013   SET &RC = 0


00650013   GOTO NODISP


00660013   ENDO


00670013


00680013 /* START MAIN DISPLAY LOOP: */


00690013 DSPLPANL:  ISPEXEC DISPLAY PANEL(&SYSICMD)  MSG(&MSGID)


00700013            SET &RC = &LASTCC


00710013            IF &RC = 8 THEN GOTO CONTINU


00720013   NODISP:  SET &MSGID = &STR(BMWE100)


00730013


00740013/* ANALYZE ANY COMMAND ENTERED ON THE APPL PANEL:  */


00750013            IF &ZCMD = S THEN DO


00760013                SET &APPNO = &STR(01)


00770013                GOTO CONTINU


00780013                              ENDO


00790013


00800013            IF &ZCMD = N OR &ZCMD = D THEN DO


00810013                SET &AC = &APPNO + 1


00820013                IF &AC = 18 THEN SET &AC = 1


00830013                IF &AC < 10 THEN SET &APPNO = &STR(0&AC)


00840013                            ELSE SET &APPNO = &STR(&AC)


00850013                GOTO CONTINU


00860013                ENDO


00870013


00880013            IF &ZCMD = P OR &ZCMD = U OR &ZCMD = B THEN DO


00890013                SET &AC = &APPNO - 1


00900013                IF &AC = 0 THEN SET &AC = 17


00910013                IF &AC < 10 THEN SET &APPNO = &STR(0&AC)


00920013                            ELSE SET &APPNO = &STR(&AC)


00930013                GOTO CONTINU


00940013                ENDO


00950013


00960013            SET &LZ = &LENGTH(&ZCMD)


00970013            IF &LZ > 2 THEN +


00980013                DO


00990013                IF &SUBSTR(2,&ZCMD) = &STR(.) THEN DO


01000013                   SET &ZTRAIL = &SUBSTR(3:&LZ,&ZCMD)


01010013                   SET &ZCMD = &SUBSTR(1,&ZCMD)


01020013                   ISPEXEC VPUT ZTRAIL SHARED


01030013                   ENDO


01040013                ELSE IF &SUBSTR(3,&ZCMD) = &STR(.) THEN DO


01050013                   SET &ZTRAIL = &SUBSTR(4:&LZ,&ZCMD)


01060013                   SET &ZCMD = &SUBSTR(1:2,&ZCMD)


01070013                   ISPEXEC VPUT ZTRAIL SHARED


01080013                   ENDO


01090013                ENDO


01100013


01110013            IF &ZCMD NE &STR() THEN DO


01120013                IF &DATATYPE(&ZCMD) NE NUM THEN DO


01130013                    SET &MSGID = &STR(BMWE101)


01140013                    GOTO DSPLPANL


01150013                    ENDO


01160013


01170013                IF &ZCMD GT 17 THEN DO


01180013                    SET &MSGID = &STR(BMWE102)


01190013                    GOTO DSPLPANL


01200013                    ENDO


01210013


01220013                IF &ZCMD LT 1 THEN DO


01230013                    SET &MSGID = &STR(BMWE102)


01240013                    GOTO DSPLPANL


01250013                    ENDO


01260013


01270013                SET &AC = &ZCMD


01280013                IF &AC < 10 THEN SET &APPNO = &STR(0&AC)


01290013                            ELSE SET &APPNO = &STR(&AC)


01300013                GOTO CONTINU


01310013                ENDO


01320013


01330013/* NO COMMAND, SO SCAN FOR A SELECT CODE FOR AN APPL:   */


01340013                SET &AC = 1


01350013                DO WHILE &AC < 18


01360013                   IF &AC < 10 THEN SET &APPNO = &STR(0&AC)


01370013                               ELSE SET &APPNO = &STR(&AC)


01380013                   IF &STR(&S&APPNO) = &STR(S) THEN GOTO CONTINU


01390013                   IF &STR(&S&APPNO) = &STR(E) THEN GOTO CONTINU


01400013                   IF &STR(&S&APPNO) = &STR(L) THEN GOTO INITSET


01410013                   SET &AC = &AC + 1


01420013                ENDO


01430013


01440013                SET &APPNO = &STR(01)


01450013


01460013/* SAVE ANY CHANGES TO APPL NAMES :   */


01470013 CONTINU:  +


01480013            SET &ZCMD = &STR()


01490013            ISPEXEC VPUT +


01500013(W88APP01 W88APP02 W88APP03 W88APP04 W88APP05 W88APP06 W88APP07 +


01510013 W88APP08 W88APP09 W88APP10 W88APP11 W88APP12 W88APP13 W88APP14 +


01520013 W88APP15 W88APP16 W88APP17) PROFILE


01530013


01540013            IF &RC = 8 THEN EXIT


01550013


01560013/* NOW GET THE DSNAMES FOR THE APPL TO PASS TO BETTER EDIT PANEL: */


01570013            SET &W88X&APPNO.01  =


01580013            SET &W88X&APPNO.02  =


01590013            SET &W88X&APPNO.03  =


01600013            SET &W88X&APPNO.04  =


01610013            SET &W88X&APPNO.05  =


01620013            SET &W88X&APPNO.06  =


01630013            SET &W88X&APPNO.07  =


01640013            SET &W88X&APPNO.08  =


01650013            SET &W88X&APPNO.09  =


01660013            SET &W88X&APPNO.10  =


01670013            SET &W88X&APPNO.11  =


01680013            SET &W88X&APPNO.12  =


01690013            SET &W88X&APPNO.13  =


01700013            SET &W88X&APPNO.14  =


01710013            SET &W88X&APPNO.15  =


01720013            SET &W88X&APPNO.16  =


01730013            SET &W88X&APPNO.17  =


01740013


01750013            ISPEXEC VGET +


01760013(W88X&APPNO.01 W88X&APPNO.02 W88X&APPNO.03 W88X&APPNO.04 W88X&APPNO.05 W
88X&APPNO.06 W88X&APPNO.07 +

01770013 W88X&APPNO.08 W88X&APPNO.09 W88X&APPNO.10 W88X&APPNO.11 W88X&APPNO.12 W
88X&APPNO.13 W88X&APPNO.14 +

01780013 W88X&APPNO.15 W88X&APPNO.16 W88X&APPNO.17) PROFILE


01790013


01800013            SET &W88DSN01 = &STR(&W88X&APPNO.01)


01810013            SET &W88DSN02 = &STR(&W88X&APPNO.02)


01820013            SET &W88DSN03 = &STR(&W88X&APPNO.03)


01830013            SET &W88DSN04 = &STR(&W88X&APPNO.04)


01840013            SET &W88DSN05 = &STR(&W88X&APPNO.05)


01850013            SET &W88DSN06 = &STR(&W88X&APPNO.06)


01860013            SET &W88DSN07 = &STR(&W88X&APPNO.07)


01870013            SET &W88DSN08 = &STR(&W88X&APPNO.08)


01880013            SET &W88DSN09 = &STR(&W88X&APPNO.09)


01890013            SET &W88DSN10 = &STR(&W88X&APPNO.10)


01900013            SET &W88DSN11 = &STR(&W88X&APPNO.11)


01910013            SET &W88DSN12 = &STR(&W88X&APPNO.12)


01920013            SET &W88DSN13 = &STR(&W88X&APPNO.13)


01930013            SET &W88DSN14 = &STR(&W88X&APPNO.14)


01940013            SET &W88DSN15 = &STR(&W88X&APPNO.15)


01950013            SET &W88DSN16 = &STR(&W88X&APPNO.16)


01960013            SET &W88DSN17 = &STR(&W88X&APPNO.17)


01970013


01980013            ISPEXEC VPUT +


01990013(W88DSN01 W88DSN02 W88DSN03 W88DSN04 W88DSN05 W88DSN06 W88DSN07 +


02000013 W88DSN08 W88DSN09 W88DSN10 W88DSN11 W88DSN12 W88DSN13 W88DSN14 +


02010013 W88DSN15 W88DSN16 W88DSN17) PROFILE


02020013


02030013/*   CALL THE BETTER EDIT PROGRAM :   */


02040013            SET &KKMEAPP = &STR(&W88APP&APPNO)


02050013


02060013            ISPEXEC VGET BEMNAM PROFILE


02070013            IF &LASTCC NE 0 THEN SET &BEMNAM = MULTEDIT


02080013            SET &DYNPNAME = &BEMNAM


02090013            IF &DYNPNAME = &Z THEN SET &DYNPNAME = MULTEDIT


02100013            ISPEXEC VPUT (DYNPNAME KKMEAPP) SHARED


02110013


02120013            ISPEXEC SELECT PGM(PANLEXIT) PARM(DPSCEDT6)


02130013


02140013/*   GET ANY MODIFIED DATASET NAMES AND SAVE:   */


02150013INITSET: +


02160013            ISPEXEC VGET +


02170013(W88DSN01 W88DSN02 W88DSN03 W88DSN04 W88DSN05 W88DSN06 W88DSN07 +


02180013 W88DSN08 W88DSN09 W88DSN10 W88DSN11 W88DSN12 W88DSN13 W88DSN14 +


02190013 W88DSN15 W88DSN16 W88DSN17) PROFILE


02200013


02210013            SET &W88X&APPNO.01 =  &STR(&W88DSN01)


02220013            SET &W88X&APPNO.02 =  &STR(&W88DSN02)


02230013            SET &W88X&APPNO.03 =  &STR(&W88DSN03)


02240013            SET &W88X&APPNO.04 =  &STR(&W88DSN04)


02250013            SET &W88X&APPNO.05 =  &STR(&W88DSN05)


02260013            SET &W88X&APPNO.06 =  &STR(&W88DSN06)


02270013            SET &W88X&APPNO.07 =  &STR(&W88DSN07)


02280013            SET &W88X&APPNO.08 =  &STR(&W88DSN08)


02290013            SET &W88X&APPNO.09 =  &STR(&W88DSN09)


02300013            SET &W88X&APPNO.10 =  &STR(&W88DSN10)


02310013            SET &W88X&APPNO.11 =  &STR(&W88DSN11)


02320013            SET &W88X&APPNO.12 =  &STR(&W88DSN12)


02330013            SET &W88X&APPNO.13 =  &STR(&W88DSN13)


02340013            SET &W88X&APPNO.14 =  &STR(&W88DSN14)


02350013            SET &W88X&APPNO.15 =  &STR(&W88DSN15)


02360013            SET &W88X&APPNO.16 =  &STR(&W88DSN16)


02370013            SET &W88X&APPNO.17 =  &STR(&W88DSN17)


02380013


02390013            ISPEXEC VPUT +


02400013(W88X&APPNO.01 W88X&APPNO.02 W88X&APPNO.03 W88X&APPNO.04 W88X&APPNO.05 W
88X&APPNO.06 W88X&APPNO.07 +

02410013 W88X&APPNO.08 W88X&APPNO.09 W88X&APPNO.10 W88X&APPNO.11 W88X&APPNO.12 W
88X&APPNO.13 W88X&APPNO.14 +

02420013 W88X&APPNO.15 W88X&APPNO.16 W88X&APPNO.17) PROFILE


02430013


02440013/* CHECK FOR ANY COMMAND (UP/DOWN) PASSED BACK:  */


02450013            ISPEXEC VGET KCMD SHARED


02460013            IF &KCMD = &STR() THEN GOTO DSPLPANL


02470013            SET ZCMD = &SUBSTR(1,&KCMD)


02480013            SET KCMD = &STR()


02490013            ISPEXEC VPUT KCMD SHARED


02500013            GOTO NODISP


./ ADD NAME=EDITNEW  0114-84324-89121-1021-00038-00009-00038-LL02155
00010012PROC 0 ZENVIR() Z()


00020012


00030012 CONTROL NOMSG NOFLUSH END(ENDO)


00040012 IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


00050012


00060012/* START OF ISPF V2 RECOVERY CODE:  */


00070012/* NOTE NEW PARMS INITIALIZED ON PROC STATEMENT (Z VARS) */


00080012


00081014/* %TRAK EDITNEW PROD###


00090012ISPEXEC VGET (ZENVIR)


00100012IF &STR(&ZENVIR) NE &Z THEN +


00110012  DO


00120012  ISPEXEC EDREC INIT


00130012  SET DONE = NO


00140012    DO WHILE &DONE = NO


00150012      ISPEXEC EDREC QUERY


00160012      IF &LASTCC = 4 THEN +


00170012        DO


00180012        ISPEXEC DISPLAY PANEL(ISREDM02)


00190012        IF &LASTCC NE 0 THEN DO


00200012                             ISPEXEC EDREC DEFER


00210012                             EXIT


00220012                             ENDO


00230012        IF &ZEDCMD = C THEN ISPEXEC EDREC CANCEL


00240012        IF &ZEDCMD = D THEN ISPEXEC EDREC DEFER


00250012        IF &ZEDCMD = &Z THEN ISPEXEC EDREC PROCESS


00260012        ENDO


00270012      ELSE SET DONE = YES


00280012    ENDO


00290012  ENDO


00300012/* END OF ISPF V2 RECOVERY CODE.  */


00310012


00320012ISPEXEC VGET BEMNAM PROFILE


00330012IF &LASTCC NE 0 THEN SET &BEMNAM = MULTEDIT


00340012SET &DYNPNAME = &BEMNAM


00350012IF &DYNPNAME = &Z THEN SET DYNPNAME = MULTEDIT


00360012ISPEXEC VPUT DYNPNAME SHARED


00370012ISPEXEC SELECT PGM(DPSCEDT6)


./ ADD NAME=ENCRYPT  0101-85289-85290-1240-00002-00002-00001-DS00150
00010000ISREDIT MACRO (KEY)


00020001ISREDIT !CRY ENCRYPT,&KEY


./ ADD NAME=ERRORMSG 0105-82314-84157-1529-00116-00005-00000-JS02150
        PROC 1 CODE


        CONTROL NOMSG


        GLOBAL MSG


        STACK


        CLOG '&SYSDATE &SYSTIME ERRORMSG' U($$$#150) SAVE


        ERROR DO


              SET MSG = &STR(CLIST ERROR CODE WAS &CODE)


              EXIT CODE(0)


              END


        GOTO MSG&CODE


        MSG16:  SET MSG = &STR(NOT ENOUGH VIRTUAL STORAGE)


                EXIT


        MSG300: SET MSG = &STR(USER TRIED TO UPDATE AN UNAUTHORIZED VARIABLE)


                EXIT


        MSG304: SET MSG = &STR(INVALID KEYWORD ON EXIT STATEMENT)


                EXIT


        MSG308: SET MSG = &STR(CODE SPECIFIED, BUT NO CODE GIVEN ON EXIT STATEME
NT)

                EXIT


        MSG312: SET MSG = &STR(INTERNAL GLOBAL PROCESSING ERROR)


                EXIT


        MSG316: SET MSG = &STR(TERMIN DELIMITER GREATER THAN 256 CHARACTERS)


                EXIT


        MSG324: SET MSG = &STR(GETLINE ERROR)


                EXIT


        MSG328: SET MSG = &STR(MORE THAN 64 DELIMITERS ON TERMIN)


                EXIT


        MSG332: SET MSG = &STR(INVALID FILE NAME SYNTAX)


                EXIT


        MSG336: SET MSG = &STR(FILE ALREADY OPEN)


                EXIT


        MSG340: SET MSG = &STR(INVALID OPEN TYPE SYNTAX)


                EXIT


        MSG344: SET MSG = &STR(UNDEFINED OPEN TYPE)


                EXIT


        MSG348: SET MSG = &STR(FILE SPECIFIED DID NOT OPEN)


                EXIT


        MSG352: SET MSG = &STR(GETFILE - FILENAME NOT CURRENTLY OPEN)


                EXIT


        MSG356: SET MSG = &STR(GETFILE - THE FILE HAS BEEN CLOSED BY THE SYSTEM)


                EXIT


        MSG360: SET MSG = &STR(PUTFILE - FILE NAME NOT CURRENTLY OPEN)


                EXIT


        MSG364: SET MSG = &STR(PUTFILE - THE FILE HAS BEEN CLOSED BY THE SYSTEM)


                EXIT


        MSG368: SET MSG = &STR(PUTFILE - CLOSFILE - FILE NOT OPENED BY OPENFILE)


                EXIT


        MSG372: SET MSG = &STR(PUTFILE - ISSUED BEFORE GETFILE ON A FILE OPENED
FOR UPDATE)

                EXIT


        MSG400: SET MSG = &STR(GETFILE END OF FILE)


                EXIT


        MSG800: SET MSG = &STR(DATA FOUND WHERE OPERATOR WAS EXPECTED)


                EXIT


        MSG804: SET MSG = &STR(OPERATOR FOUND WHERE DATA WAS EXPECTED)


                EXIT


        MSG808: SET MSG = &STR(A COMPARISON OPERATOR WAS USED IN A SET STATEMENT
)

                EXIT


        MSG816: SET MSG = &STR(OPERATOR FOUND AT THE END OF A STATEMENT)


                EXIT


        MSG820: SET MSG = &STR(OPERATORS OUT OF ORDER)


                EXIT


        MSG824: SET MSG = &STR(MORE THAN ONE EXCLUSIVE OPERATOR FOUND)


                EXIT


        MSG828: SET MSG = &STR(MORE THAN ONE EXCLUSIVE COMPARISON OPERATOR)


                EXIT


        MSG840: SET MSG = &STR(NOT ENOUGH OPERANDS)


                EXIT


        MSG844: SET MSG = &STR(NO VALID OPERATORS)


                EXIT


        MSG848: SET MSG = &STR(ATTEMPT TO LOAD CHARACTER FROM NUMERIC VALUE)


                EXIT


        MSG852: SET MSG = &STR(ADDITION ERROR - CHARACTER DATA)


                EXIT


        MSG856: SET MSG = &STR(SUBTRACTION ERROR - CHARACTER DATA)


                EXIT


        MSG860: SET MSG = &STR(MULTIPLICATION ERROR - CHARACTER DATA)


                EXIT


        MSG864: SET MSG = &STR(DIVIDE ERROR - CHARACTER DATA OR DIVISION BY ZERO
)

                EXIT


        MSG868: SET MSG = &STR(PREFIX FOUND ON CHARACTER DATA)


                EXIT


        MSG872: SET MSG = &STR(NUMERIC VALUE TOO LARGE)


                EXIT


        MSG900: SET MSG = &STR(SINGLE AMPERSAND FOUND)


                EXIT


        MSG904: SET MSG = &STR(SYMBOLIC VARIABLE NOT FOUND)


                EXIT


        MSG908: SET MSG = &STR(ERROR OCCURD IN ERR ACTN RANGE THAT RECD CNTL BEC
AUSE OF ANOTHER ERR)

                EXIT


        MSG912: SET MSG = &STR(SUBSTRING RANGE INVALID)


                EXIT


        MSG916: SET MSG = &STR(NON-NUMERIC VALUE IN SUBSTRING RANGE)


                EXIT


        MSG920: SET MSG = &STR(SUBSTRING RANGE VALUE TOO SMALL: 0 OR NEGATIVE)


                EXIT


        MSG924: SET MSG = &STR(INVALID SUBSTRING SYNTAX)


                EXIT


        MSG932: SET MSG = &STR(SUBSTRING OUTSIDE OF RANGE OF THE STRING)


                EXIT


        MSG936: SET MSG = &STR(A BUILT-IN FUNCTION REQUIRING A VALUE WAS ENTERED
 WITHOUT A VALUE)

                EXIT


        MSG940: SET MSG = &STR(INVALID SYMBOLIC VARIABLE)


                EXIT


        MSG944: SET MSG = &STR(A LABEL WAS USED AS A SYMBOLIC VARIABLE)


                EXIT


        MSG948: SET MSG = &STR(INVALID LABEL SYNTAX ON A GOTO STATEMENT)


                EXIT


        MSG952: SET MSG = &STR(GOTO LABEL WAS NOT DEFINED)


                EXIT


        MSG956: SET MSG = &STR(GOTO STATEMENT HAS NO LABEL)


                EXIT


        MSG960: SET MSG = &STR(SYSSCAN WAS SET TO AN INVALID VALUE)


                EXIT


        MSG964: SET MSG = &STR(LASTCC SET TO INVALID VALUE, EXIT TRIED TO USE AS
 DEFAULT VALUE)

                EXIT


        MSG999: SET MSG = &STR(INTERNAL COMMAND PROCEDURE ERROR)


                EXIT


./ ADD NAME=EXPANDIR 0110-86083-87120-1140-00230-00236-00000-JS02150
00010100           CONTROL NOMSG NOFLUSH END(ENDO)


00010800


00010900           /*                                                */


00011000           /*    DETERMINE IF THIS CLIST IS BEING INVOKED    */


00011100           /*    FROM A NON FULL SCREEN TERMINAL (DIALUP)    */


00011200           /*                                                */


00012000


00022400           CALL 'WDPSC.SHARED.LOAD(TERMTYPE)'


00022500           SET &RC = &LASTCC


00022600


00022700           IF &RC = 0 THEN GOTO DIALUP


00022900


00023000           /*                                                */


00023100           /*    DETERMINE IF THIS CLIST IS BEING INVOKED    */


00023200           /*    FROM A READY RATHER THAN OPTION 6 OF SPF    */


00023300           /*    IF SO, INVOKE ISPF                          */


00023400           /*                                                */


00023500


00023600           ISPEXEC CONTROL DISPLAY REFRESH


00023700               SET &SPF = &LASTCC


00023805               IF &SPF ¬= 0 THEN DO


00023900                  ISPF CMD(%EXPANDIR)


00024000                  EXIT


00024100                  ENDO


00024300


00024400           SET &PROJECT =


00024500           SET &LIBRARY =


00024600           SET &TYPE    =


00024700


00024800           ISPEXEC VGET PROJECT PROFILE


00024900           ISPEXEC VGET LIBRARY PROFILE


00025000           ISPEXEC VGET TYPE    PROFILE


00025100


00025200           SET &ADR      =


00025300           SET &OTHERDSN =


00025400


00025500           SET &MSGID    = XDIR100


00026500           SET &KURSOR   = PROJECT


00026700


00027200 DSPLPANL: ISPEXEC DISPLAY PANEL(EXPANDIR) MSG(&MSGID) CURSOR(&KURSOR)


00027300           SET &RC = &LASTCC


00027400           IF &RC = 8 THEN GOTO ENDIALOG


00027500


00027600           IF &OTHERDSN NE THEN DO


00027700                 SET &PDSDSN = &OTHERDSN


00027800                 SET &LOCATION = OTHER


00027900                 GOTO DOFINFO


00028000                 ENDO


00028100


00028200           IF &PROJECT = OR +


00028300              &LIBRARY = OR +


00028400              &TYPE    = THEN DO


00028500                  SET &MSGID = &STR(XDIR101)


00028600                  SET &KURSOR = &STR(PROJECT)


00028700                  GOTO DSPLPANL


00028800                  ENDO


00028900


00029000           SET &PDSDSN = &STR('&PROJECT..&LIBRARY..&TYPE')


00029100           SET &LOCATION = SPFLIB


00029200


00029300 DOFINFO:  FILEINFO DSN(&STR(&PDSDSN))


00029400           SET &RC = &LASTCC


00029500


00029600           IF &RC EQ 96 THEN DO


00029700                  SET &MSGID = &STR(XDIR101)


00029800                  GOTO DOFINFO2


00029900                  ENDO


00030000


00030100           IF &RC NE 0 THEN DO


00030200                  SET &MSGID = &STR(XDIR102)


00030300                  GOTO DOFINFO2


00030400                  ENDO


00030500


00030600           IF &DSORG NE PO THEN DO


00030700                  SET &MSGID = &STR(XDIR103)


00030800                  GOTO DOFINFO2


00030900                  ENDO


00031000


00031100           IF &MEMCNTL EQ YES THEN DO


00031200                  SET &MSGID = &STR(XDIR104)


00031300                  GOTO DOFINFO2


00031400                  ENDO


00031500


00031600           IF &ADR = 0 THEN DO


00031700                  SET &MSGID = &STR(XDIR105)


00031800                  SET &KURSOR = &STR(ADR)


00031900                  GOTO DSPLPANL


00032100                  ENDO


00032200


00032300           GOTO XPANDIR


00033100


00033200 DOFINFO2: IF &LOCATION = SPFLIB THEN SET &KURSOR = &STR(PROJECT)


00033300                 ELSE SET &KURSOR = &STR(OTHERDSN)


00033400


00033500           GOTO DSPLPANL


00033600


00033700 XPANDIR:  SET &ADDAMT = 1000 + &ADR


00033900           SET &ADDAMT = &STR(&SUBSTR(2:4,&ADDAMT))


00034000


00035001           CONTROL NOMSG


00036004           FREE F(DUMDUM)


00037001


00038001           CONTROL MSG


00039004           ALLOC F(DUMDUM) DUMMY


00040200


00041000           CONTROL NOMSG


00042000           PROF NOWTPMSG


00043000


00043104           STACK DDOUT(DUMDUM)


00044004           PDS '&FULLDSN' FIXPDS EXPAND(&ADDAMT)


00062000           SET &RC = &LASTCC


00063000


00063100           PROF WTPMSG


00063200


00064000           IF &RC = 0 THEN SET &MSGID = &STR(XDIR106)


00064100              ELSE SET &MSGID = &STR(XDIR107)


00065000


00066000           GOTO DSPLPANL


00066100


00066300 ENDIALOG: ISPEXEC VPUT PROJECT PROFILE


00066400           ISPEXEC VPUT LIBRARY PROFILE


00066500           ISPEXEC VPUT TYPE    PROFILE


00067000


00067108           ISPEXEC CONTROL DISPLAY REFRESH


00068000           EXIT


00069000


00072000 DIALUP:   ERROR DO


00073000               WRITE


00074000               WRITE ***********************************


00075000               WRITE *  INVALID SYNTAX OF DATASET NAME *


00076000               WRITE ***********************************


00078000               WRITE


00079000               GOTO GETDSN


00079100               ENDO


00079200


00079300 GETDSN:   WRITE


00079400           WRITENR ENTER DATASET NAME==>


00079800           READ


00079900           SET &DSN = &STR(&SYSDVAL)


00080000


00081700           ERROR OFF


00081800           FILEINFO DSN(&STR(&DSN))


00081900           SET &RC = &LASTCC


00082000


00082100           IF &RC EQ 96 THEN DO


00082200               WRITE


00082300               WRITE ***********************************


00082400               WRITE *  INVALID SYNTAX OF DATASET NAME *


00082500               WRITE ***********************************


00082800               GOTO DIALUP


00082900               ENDO


00083100


00083200           IF &RC NE 0 THEN DO


00083300               WRITE


00083400               WRITE ***********************************


00083500               WRITE &OUTMSG


00083600               WRITE ***********************************


00083800               GOTO DIALUP


00083900               ENDO


00084000


00084100           IF &DSORG NE PO THEN DO


00084200               WRITE


00084300               WRITE ********************************


00084400               WRITE *  DATASET NOT PARTITIONED     *


00084500               WRITE ********************************


00084700               GOTO DIALUP


00084800               ENDO


00084900


00085000           IF &MEMCNTL EQ YES THEN DO


00085100               WRITE


00085200               WRITE ********************************


00085300               WRITE *  DO NOT PROVIDE MEMBER NAME  *


00085400               WRITE ********************************


00085600               GOTO DIALUP


00085700               ENDO


00085800


00086000 ERR2:     ERROR DO


00086100               WRITE


00086200               WRITE ***********************************


00086300               WRITE *  INVALID DIRECTORY ADDITION AMT *


00086400               WRITE ***********************************


00086600               WRITE


00086700               GOTO GTDIRADD


00086800               ENDO


00086900


00087000 GTDIRADD: WRITE


00087100           WRITE ENTER THE NUMBER OF DIRECTORY


00087200           WRITENR       BLOCKS TO ADD TO THE DIRECTORY===>


00087300           READ &ADR


00088000


00089000           IF &DATATYPE(&ADR) NE NUM THEN DO


00089200               WRITE


00089300               WRITE ***********************************


00089400               WRITE *  INVALID DIRECTORY ADDITION AMT *


00089500               WRITE ***********************************


00089700               WRITE


00089800               GOTO GTDIRADD


00089900               ENDO


00090000


00090100           IF &ADR = 0 OR +


00090200              &ADR GT 999 THEN DO


00090300               WRITE


00090400               WRITE ***********************************


00090500               WRITE *  INVALID DIRECTORY ADDITION AMT *


00090600               WRITE ***********************************


00090800               WRITE


00090900               GOTO GTDIRADD


00091000               ENDO


00091100


00091200           ERROR OFF


00091300


00091400           SET &ADDAMT = 1000 + &ADR


00091500           SET &ADDAMT = &STR(&SUBSTR(2:4,&ADDAMT))


00091600


00091700           CONTROL NOMSG


00091801           FREE F(DUMDUM)


00091900


00092000           CONTROL MSG


00092101           ALLOC F(DUMDUM) DUMMY


00092600


00092700           WRITE


00092800


00092904           STACK DDOUT(DUMDUM)


00093200           PDS '&FULLDSN' FIXPDS EXPAND(&ADDAMT)


00100000           SET &RC = &LASTCC


00101000


00102000           IF &RC = 0 THEN WRITE SUCCESSFUL COMPLETION


00105000


00110008           ISPEXEC CONTROL DISPLAY REFRESH


00120008           EXIT


./ ADD NAME=FINDTTR  0101-80157-80157-1124-00017-00012-00007-KK00150
00010001PROC 1 DSNAME T


00011000CONTROL NOFLUSH END(ENDO) NOMSG


00020000FREE F(PDS  PRINT)


00021000CONTROL MSG


00030000ALLOC F(PDS) DA(&DSNAME)


00040000ALLOC F(PRINT) DA(*)


00040100WRITE ENTER STRING TO FIND:


00040200READ


00040300SET &PRM = &STR(&SYSDVAL)


00041000IF &SUBSTR(1,&STR(&PRM)) = &STR(') THEN +


00042000  SET &PRM = &SUBSTR(2:&LENGTH(&STR(&PRM))-1,&STR(&PRM))


00043001IF &T NE T THEN DO


00043101                CALL 'KK00150.MY.LOAD(FINDTTR)' '&PRM'


00044001                ENDO


00045001           ELSE DO


00046001                TEST 'KK00150.MY.LOAD(FINDTTR)' '&PRM'


00047001                ENDO


./ ADD NAME=FIREUP   0104-83249-85113-1610-00176-00176-00000-JS02150
                    PROC 0 PANEL() MESSAGE() SKELETON() TABLEIN() TABLEOUT() -


                           TAILOUT() SPFLOAD() PRINT()





                    CONTROL NOMSG NOFLUSH END(ENDO)





        ISPPLIB:    IF &PANEL = THEN GOTO ISPMLIB





                    SET &THEDSN = &PANEL


                    SET &WHICHONE = 1


                    SET &WHICHLIB = &STR(PANEL LIBRARY)


                    SET &DDNAM = ISPPLIB


                    SET &RETERN = ISPMLIB


                    GOTO FINFO





        ISPMLIB:    IF &MESSAGE = THEN GOTO ISPSLIB





                    SET &THEDSN = &MESSAGE


                    SET &WHICHONE = 2


                    SET &WHICHLIB = &STR(MESSAGE LIBRARY)


                    SET &DDNAM = ISPMLIB


                    SET &RETERN = ISPSLIB


                    GOTO FINFO





        ISPSLIB:    IF &SKELETON = THEN GOTO ISPTLIB





                    SET &THEDSN = &SKELETON


                    SET &WHICHONE = 3


                    SET &WHICHLIB = &STR(SKELETON LIBRARY)


                    SET &DDNAM = ISPSLIB


                    SET &RETERN = ISPTLIB


                    GOTO FINFO





        ISPTLIB:    IF &TABLEIN = THEN GOTO ISPTABL





                    SET &THEDSN = &TABLEIN


                    SET &WHICHONE = 4


                    SET &WHICHLIB = &STR(TABLE INPUT LIBRARY)


                    SET &DDNAM = ISPTLIB


                    SET &RETERN = ISPTABL


                    GOTO FINFO





        ISPTABL:    IF &TABLEOUT = THEN GOTO ISPFILE





                    SET &THEDSN = &TABLEOUT


                    SET &WHICHONE = 5


                    SET &WHICHLIB = &STR(TABLE OUTPUT LIBRARY)


                    SET &DDNAM = ISPTABL


                    SET &RETERN = ISPFILE


                    GOTO FINFO





        ISPFILE:    IF &TAILOUT = THEN GOTO ISPLLIB





                    FREE F(ISPFILE)


                    CONTROL MSG


                    ALLOC F(ISPFILE) DA(&TAILOUT) SHR


                    SET &RC = &LASTCC


                    CONTROL NOMSG





                    IF &PRINT NE YES THEN GOTO ISPLLIB





                    IF &RC = 0 THEN DO


                          WRITE FILE TAILORING OUTPUT LIBRARY ALLOCATED


                          GOTO ISPLLIB


                          ENDO





        ISPLLIB:    IF &SPFLOAD = THEN GOTO KWIT





                    SET &THEDSN = &SPFLOAD


                    SET &WHICHONE = 7


                    SET &WHICHLIB = &STR(SPF LINK LIBRARY)


                    SET &DDNAM = ISPLLIB


                    SET &RETERN = KWIT


                    GOTO FINFO





        KWIT:       GOTO ENDIT





        FINFO:      FILEINFO DSN(&STR(&THEDSN))


                    SET &RC = &LASTCC





                    IF &RC EQ 96 THEN DO


                        WRITE **************************************************
*********

                        WRITE INVALID DSNAME SYNTAX OF &WHICHLIB


                        WRITE **************************************************
*********

                        GOTO EXITINFO


                        ENDO





                    IF &RC NE 0 THEN DO


                        WRITE *******************************************


                        WRITE &OUTMSG


                        WRITE *******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 6 THEN GOTO FINFO2





                    IF &DSORG NE PO THEN DO


                        WRITE *******************************************


                        WRITE THE &WHICHLIB MUST BE PARTITIONED


                        WRITE *******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &MEMCNTL EQ YES THEN DO


                        WRITE **************************


                        WRITE DO NOT PROVIDE MEMBER NAME


                        WRITE **************************


                        GOTO EXITINFO


                        ENDO





        FINFO2:     IF &WHICHONE NE 7 THEN GOTO FINFO3





                    IF &RECFM NE U THEN DO


                        WRITE **************************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN UNDEFINED RECORDS


                        WRITE **************************************************
****************

                        GOTO EXITINFO


                        ENDO





                    GOTO CONCAT





        FINFO3:     IF &RECFM NE F THEN DO


                        WRITE **************************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN FIXED LENGTH RECORDS


                        WRITE **************************************************
****************

                        GOTO EXITINFO


                        ENDO





                    IF &LRECL NE 80 THEN DO


                        WRITE **************************************************
*

                        WRITE LRECL OF &WHICHLIB MUST BE 80


                        WRITE **************************************************
*

                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 4 OR +


                       &WHICHONE = 5 OR +


                       &WHICHONE = 6 THEN GOTO CONCAT





                    IF &BLKSIZE LT 3120 THEN DO


                        WRITE ***********************************************


                        WRITE BLOCK SIZE OF &WHICHLIB


                        WRITE GREATER THAN OR EQUAL TO 3120


                        WRITE ***********************************************


                        GOTO EXITINFO


                        ENDO





        CONCAT:     WHATDSN DDNAME(&DDNAM)


                    SET &RC = &LASTCC





                    IF &RC NE 0 THEN GOTO CONCATM





                    IF &FULLDSN NE &DSNAME THEN GOTO CONCATM





                    IF &PRINT NE YES THEN GOTO EXITINFO





                    WRITE &WHICHLIB ALLOCATED   (PREVIOUSLY)


                    GOTO EXITINFO





        CONCATM:    CONCATEM ACTCODE(A) DDNAME(&DDNAM) DSNAME('&FULLDSN')


                    SET &RC = &LASTCC





                    IF &PRINT NE YES THEN GOTO EXITINFO





                    IF &RC = 0 THEN DO


                          WRITE &WHICHLIB ALLOCATED


                          GOTO EXITINFO


                          ENDO





                    WRITE *****************************************************


                    WRITE &OUTMSG


                    WRITE        (RETURN CODE = &RC)


                    WRITE *****************************************************





        EXITINFO:   GOTO &RETERN





        ENDIT:      EXIT


./ ADD NAME=FNDSMEM  0105-86048-86199-1259-00178-00176-00000-LL02155
                 CONTROL NOMSG NOFLUSH END(ENDO)





                 SET &OPENSW = &STR(NO)





                 SET &FNDSERR = &STR(FNDSMEM ERROR F01)


                 ISPEXEC VPUT FNDSERR SHARED





                 ISPEXEC VGET FNDSDSN SHARED


                 SET &RC = &LASTCC





                 IF &RC NE 0 THEN DO


                    SET &FNDSERR = &STR(FNDSMEM ERROR F02)


                    ISPEXEC VPUT FNDSERR SHARED


                    GOTO ENDIT


                    ENDO





                 ISPEXEC VGET FNDSRCH SHARED


                 SET &RC = &LASTCC





                 IF &RC NE 0 THEN DO


                    SET &FNDSERR = &STR(FNDSMEM ERROR F03)


                    ISPEXEC VPUT FNDSERR SHARED


                    GOTO ENDIT


                    ENDO





                 ISPEXEC VGET FNDSVOL SHARED


                 SET &RC = &LASTCC





                 IF &RC NE 0 THEN DO


                    SET &FNDSERR = &STR(FNDSMEM ERROR F07)


                    ISPEXEC VPUT FNDSERR SHARED


                    GOTO ENDIT


                    ENDO





                 IF &FNDSVOL = &STR(ABSENT) THEN DO


                      CONTROL NOMSG


                      FREE F(PROCLIB)


                      CONTROL MSG


                      ALLOC F(PROCLIB) DA('&FNDSDSN') SHR


                      SET &VOLPARAM =


                      SET &PANULMSG = &STR(&FNDSDSN)


                      GOTO ALLOCPRT


                      ENDO





                 CONTROL NOMSG


                 FREE F(PROCLIB)





                 DEVTYPE VOL(&FNDSVOL)


                 SET &RC = &LASTCC





                 IF &RC NE 0 THEN DO


                    SET &FNDSERR = &STR(FNDSMEM ERROR F08)


                    ISPEXEC VPUT FNDSERR SHARED


                    GOTO ENDIT


                    ENDO





                 CONTROL MSG


                 ALLOC F(PROCLIB) DA('&FNDSDSN') SHR -


                     UNIT(&DEVTYP) VOL(&FNDSVOL)





                 SET &VOLPARAM = &STR(VOLUME(&FNDSVOL))


                 SET &PANULMSG = &STR(VOL=&FNDSVOL  DSN=&FNDSDSN)





             ALLOCPRT: +


                 CONTROL NOMSG


                 FREE F(PRINT)


                 CONTROL MSG


                 ALLOC F(PRINT) NEW UNIT(SYSSQ) TRACKS SPACE(9,4)





                 IF &SUBSTR(1,&STR(&FNDSRCH)) = &STR(') THEN +


                     SET &FNDSRCH = &SUBSTR(2:&LENGTH(&STR(&FNDSRCH))-1,&STR(&FN
DSRCH))




                 CALL 'WDPSC.SHARED.LOAD(FINDEM)' '&FNDSRCH'


                 SET &FNDSRC = &LASTCC





                 CONTROL NOMSG


                 FREE F(PROCLIB)





                 ISPEXEC TBCREATE FNDSMEM NAMES(TYPCODE MBRNAME) NOWRITE


                 SET &RC = &LASTCC





                 IF &RC NE 0 THEN DO


                      SET &FNDSERR = &STR(FNDSMEM ERROR F04)


                      ISPEXEC VPUT FNDSERR SHARED


                      GOTO ENDIT


                      ENDO





                 SET &OPENSW = &STR(YES)





                 IF &FNDSRC NE 0 THEN DO


                      SET &FNDSERR = &STR(CANNOT SEARCH LIBRARIES WITH MORE THAN
 2500 MEMBERS)

                      ISPEXEC VPUT FNDSERR SHARED


                      GOTO ENDIT


                      ENDO





                 OPENFILE PRINT INPUT





                 SET &CTR = 0





        LOOP:    ERROR DO


                      SET &RC = &LASTCC


                      IF &RC = 400 THEN GOTO CLOS


                      SET &FNDSERR = &STR(FNDSMEM ERROR F05)


                      ISPEXEC VPUT FNDSERR SHARED


                      GOTO CLOS


                      ENDO





                 GETFILE PRINT


                 ERROR OFF


                 SET &BUFFER = &STR(&PRINT)





                 SET &TYPCODE = &STR(_)


                 SET &MBRNAME = &STR(&SUBSTR(26:33,&STR(&BUFFER))





                 ISPEXEC TBADD FNDSMEM


                 SET &RC = &LASTCC


                 IF &RC NE 0 THEN DO


                      SET &FNDSERR = &STR(FNDSMEM ERROR F06)


                      ISPEXEC VPUT FNDSERR SHARED


                      GOTO ENDIT


                      ENDO





                 SET &CTR = &CTR + 1


                 GOTO LOOP





        CLOS:    ERROR OFF


                 CLOSFILE PRINT





                 IF &CTR = 0 THEN DO


                      SET &FNDSERR = &STR(NO HITS FOUND IN ANY MEMBERS)


                      ISPEXEC VPUT FNDSERR SHARED


                      GOTO ENDIT


                      ENDO





                 ISPEXEC TBTOP FNDSMEM


                 SET &MSGID = &STR(FNDS100)





        DSPANEL: ISPEXEC TBDISPL FNDSMEM PANEL(FNDSMEM) MSG(&MSGID)


                 SET &RC = &LASTCC





                 IF &RC NE 0 THEN DO


                      SET &FNDSERR = &STR(NO ERROR ENCOUNTERED)


                      ISPEXEC VPUT FNDSERR SHARED


                      GOTO ENDIT


                      ENDO





                 ERROR DO


                      ERROR OFF


                      SET &MSGID = &STR(FNDS101)


                      GOTO DSPANEL


                      ENDO





                 IF &TYPCODE = &STR(S) OR +


                    &TYPCODE = &STR(E) THEN DO


                       SET &SERVICE = &STR(EDIT)


                       GOTO DOIT


                       ENDO





                 IF &TYPCODE = &STR(B) THEN DO


                       SET &SERVICE = &STR(BROWSE)


                       GOTO DOIT


                       ENDO





                 ERROR OFF





                 SET &MSGID = &STR(FNDS101)


                 GOTO DSPANEL





        DOIT:    ERROR OFF


                 SET &THEMEMBR = &SUBSTR(1:&LENGTH(&MBRNAME),&MBRNAME)





                 ISPEXEC &SERVICE DATASET('&FNDSDSN(&THEMEMBR)') &VOLPARAM





                 SET &MSGID = &STR(FNDS100)


                 GOTO DSPANEL





        ENDIT:   IF &OPENSW = &STR(YES) THEN ISPEXEC TBEND FNDSMEM


                 EXIT


./ ADD NAME=FULLUT1  0106-80207-82348-1035-00222-00213-00015-LL02150
00010000PROC 5 FSOPT SCREEN FORLIB ASMSRC ASMLOD +


00020000        CTL1() CTL2() CTL3() CTL4() CTL5() CTL6()


00030000CONTROL MAIN NOMSG END(ENDO)


00040000SET &CF = N


00050000IF &SYSPREF = CTEST THEN CONTROL MSG LIST CONLIST SYMLIST


00060000


00070000SET CTL = &STR(&&CTL)


00080000SET I = 1


00090000DO WHILE &I < 7


00100000     IF &STR(&CTL&I) = Q THEN SET CTL&I = &STR(?)


00110000     IF &STR(&CTL&I) = A THEN SET CTL&I = &STR('')


00120000     IF &STR(&CTL&I) = N THEN SET CTL&I = &STR(¬)


00130000     SET &I = &I + 1


00140000   ENDO


00150000


00160000IF &ASMSRC NE ¢¢¢ THEN DO


00170000    IF &SYSPREF = &SYSUID THEN SET &FULLGEN = &STR(FULLGEN)


00180000                          ELSE SET &FULLGEN = &STR(&SYSUID..FULLGEN)


00190000                       ENDO


00200000                  ELSE DO


00210000    IF &SYSPREF = &SYSUID THEN SET &FULLGEN = &STR(FULLGEN.&SCREEN)


00220000                 ELSE SET &FULLGEN = &STR(&SYSUID..FULLGEN.&SCREEN)


00230000                       ENDO


00240000


00250000IF &SUBSTR(1,&FORLIB) NE &STR(') THEN SET &FORLIB = &SYSPREF..&FORLIB


00260000       ELSE SET &FORLIB = &SUBSTR(2:&LENGTH(&FORLIB)-1,&FORLIB)


00270000IF &SUBSTR(1,&ASMSRC) NE &STR(') THEN SET &ASMSRC = &SYSPREF..&ASMSRC


00280000       ELSE SET &ASMSRC = &SUBSTR(2:&LENGTH(&ASMSRC)-1,&ASMSRC)


00290000IF &SUBSTR(1,&ASMLOD) NE &STR(') THEN SET &ASMLOD = &SYSPREF..&ASMLOD


00300000       ELSE SET &ASMLOD = &SUBSTR(2:&LENGTH(&ASMLOD)-1,&ASMLOD)


00310000


00320000IF &FSOPT NE A THEN DO


00330000     IF &FORLIB = &SYSPREF..¢¢¢ THEN DO


00340000                  WRITE ERROR - FORMAT LIBRARY WAS NOT ENTERED.


00350000                  EXIT


00360000                                     ENDO


00370000     ERROR  DO


00380000             SET RC = &LASTCC


00390000             IF &RC < 4 THEN WRITE DATASET IS NOT A PDS:


00400000               ELSE WRITE FORMAT LIBRARY COULD NOT BE FOUND:


00410000             WRITE       '&FORLIB'


00420000             EXIT


00430000            ENDO


00440000     DATASTAT '&FORLIB'


00450000     ERROR OFF


00460000                    ENDO


00470000


00480000IF &ASMSRC NE &SYSPREF..¢¢¢ THEN DO


00490000     ERROR  DO


00500000             SET RC = &LASTCC


00510000             IF &RC < 4 THEN WRITE DATASET IS NOT A PDS:


00520000               ELSE WRITE SOURCE LIBRARY COULD NOT BE FOUND:


00530000             WRITE       '&ASMSRC'


00540000             EXIT


00550000            ENDO


00560000     DATASTAT '&ASMSRC'


00570000     ERROR OFF


00580000                                 ENDO


00590000


00600000IF &FSOPT NE G THEN DO


00610000    IF &ASMLOD = &SYSPREF..¢¢¢ THEN DO


00620000                            WRITE ERROR - LOAD LIBRARY WAS NOT ENTERED.


00630000                            EXIT


00640000                                    ENDO


00650000     ERROR DO


00660000             SET RC = &LASTCC


00670000             IF &RC < 4 THEN WRITE DATASET IS NOT A PDS:


00680000               ELSE WRITE LOAD LIBRARY COULD NOT BE FOUND:


00690000            WRITE     '&ASMLOD'


00700000            EXIT


00710000           ENDO


00720000     DATASTAT '&ASMLOD'


00730000     ERROR OFF


00740000                    ENDO


00750000


00760000IF &FSOPT = A THEN DO


00770000


00780000       IF &ASMSRC = &SYSPREF..¢¢¢ THEN DO


00790000          ERROR DO


00800000                  SET RC = &LASTCC


00810000                  IF &RC < 2 THEN GOTO ASMIT


00820000                    ELSE WRITE ERROR - SOURCE COULD NOT BE FOUND:


00830000                  EXIT


00840000                ENDO


00850000          DATASTAT &FULLGEN..ASM


00860000          ERROR OFF


00870000          WRITE INVALID SOURCE DATASET.


00880000          EXIT


00890000                                       ENDO


00900000


00910000                                  ELSE GOTO ASMIT


00920000                   ENDO


00930000


00940000  ERROR DO


00950000     SET CC = &LASTCC


00960000     IF &CC NE 8 THEN DO


00970000                     WRITE UNKNOWN I/O ERROR- RETURN CODE WAS &CC


00980000                     WRITE PLEASE CHECK YOUR FORMAT LIBRARY NAME;


00990000                     EXIT


01000000                       ENDO


01010000     KOMM CLEAR RESET


01020000     WRITE MEMBER &SCREEN NOT FOUND IN '&FORLIB'.


01030000     WRITE MEMBER IS BEING CREATED - PLEASE WAIT.


01040000     ERROR OFF


01050000     FREE F(IN01,OUT01,MESSAGES)


01060000     ALLOC F(IN01) DSN('WDPSC.CARD(QUICK)') SHR


01070000     ALLOC F(OUT01) DSN('&FORLIB(&SCREEN)') SHR


01080000     ALLOC F(MESSAGES) DUMMY


01090000     ERROR DO


01100000           WRITE ERROR - &SCREEN COULD NOT BE CREATED.


01110000           EXIT


01120000           ENDO


01130000     CALL 'WDPSC.SYSLIBRY(FTL)' '01'


01140000     GOTO OPTLAB1


01150000        ENDO


01160000MEMSTAT '&FORLIB(&SCREEN)'  NOPRINT


01170000


01180000OPTLAB1:ERROR OFF


01190001FREE F(FILEOUT,SCREEN,CRSADDR) ATTR(KAT1)


01200000ALLOC F(SCREEN) DSN('&FORLIB(&SCREEN)') SHR


01201006ALLOC F(CRSADDR) DSN('WDPSC.FS.ADDRESS') SHR


01210000


01220000ERROR DO


01230000      ERROR


01240000      ATTR KAT1 LRECL(80) RECFM(F B) BLK(4000)


01250000      ALLOC F(FILEOUT) DSN(&FULLGEN..ASM) NEW TRACK SP(3,3) US(KAT1)


01260000      ENDO


01270000ALLOC F(FILEOUT) DSN(&FULLGEN..ASM)


01280000


01290000ERROR DO


01300000      SET QRC = &LASTCC


01310000      IF &QRC = 5 THEN EXIT CODE(0)


01320000      WRITE RETURN CODE WAS &QRC


01330000      WRITE UNKNOWN ERROR IN SCREEN GENERATOR.


01340000      EXIT


01350000      ENDO


01360000


01370002CALL 'WDPSC.SYSLIBRY(QUICK)' +


01380000 '&CTL1&CTL2&CTL3&CTL4&CTL5&CTL6&SCREEN/' /*  CALL SCREEN GENERATOR  */


01390000


01400000


01410000ERROR DO


01420000      SET &A = &LASTCC


01430000      ERROR OFF


01440000  KOMM RESET CLEAR


01450000      IF &A = SB37 OR &A = SD37 OR &A = SE37 THEN DO


01460000                  WRITE NO SPACE AVAILABLE TO PLACE &SCREEN


01470000                  WRITE INTO ASSEMBLER SOURCE DATASET &ASMSRC;


01480000                  WRITE ASSEMBLER SOURCE IS IN &SYSPREF..&FULLGEN..ASM


01490003                  EXIT


01500000                        ENDO


01510000      WRITE ERROR CODE &A OCCURED WHILE SAVING ASSEMBLER SOURCE.


01520000      WRITE ASSEMBLER SOURCE IS IN &SYSPREF..&FULLGEN..ASM


01521003      WRITE


01522003      WRITE POSSIBLY ANOTHER USER IS EDITING &ASMSRC


01523003      WRITE THIS MEANS THAT THIS APPLICATION CANNOT SUCCESSFULLY SAVE


01524003      WRITE YOUR NEW MEMBER


01525003      WRITE


01526003      WRITE EITHER SPECIFY ANOTHER LIBRARY WHICH IS NOT BEING USED AT


01527003      WRITE THIS TIME OR RECONSIDER SPECIFYING ONE AT ALL.  THIS LIBRARY


01528003      WRITE IS NOT REQUIRED


01530003      EXIT


01540000      ENDO


01550000CONTROL MSG


01560000IF &ASMSRC NE &SYSPREF..¢¢¢ THEN COPY &FULLGEN..ASM '&ASMSRC(&SCREEN)' N
ONUM

01570000      ELSE DO


01580000           KOMM CL RES


01590000           WRITE ASSEMBLER SOURCE IS IN &SYSPREF..&FULLGEN..ASM


01600000           SET &CF = Y


01610000           ENDO


01620000


01630000ASMCHK: IF &FSOPT = G THEN EXIT


01640000


01650000ASMIT:  CONTROL NOMSG


01660000  IF &CF = N THEN KOMM RESET CLEAR


01670000


01680000  WRITE


01690000  WRITE


01700000  WRITE ..................... INTERACTIVE ASSEMBLY AND LINK EDIT .......
...............

01710000  WRITE


01720000  WRITE ASSEMBLY IN PROGRESS


01730000  SET &TERMOPT = NOTERM


01740000  ERROR DO


01750000    WRITE


01760000    CONTROL MSG


01770000    SET &TERMOPT = TERM


01780000    ERROR DO


01790000           SET RC = &LASTCC


01800000           WRITE ERROR IN ASSEMBLY PROCESS: RETURN CODE WAS &RC


01810000           IF &RC GT 8 THEN EXIT


01820000       WRITE  ASSEMBLER LISTING WAS PLACED IN &SYSPREF..&FULLGEN..LIST


01830000           EXIT


01840000          ENDO


01850000        ENDO


01860000


01870000IF &FSOPT NE A OR &ASMSRC = &SYSPREF..¢¢¢ THEN +


01880004  ASM   &FULLGEN         OBJ(&FULLGEN) LIB('USER.TSO.MACLIB') +


01890000                         PRINT(&FULLGEN) &TERMOPT LIST


01900000                                          ELSE +


01910004  ASM '&ASMSRC(&SCREEN)' OBJ(&FULLGEN) LIB('USER.TSO.MACLIB') +


01920000                         PRINT(&FULLGEN) &TERMOPT LIST


01930000  WRITE


01940000  WRITE ASSEMBLER LISTING PLACED IN &SYSPREF..&FULLGEN..LIST


01950000  WRITE


01960000  WRITE LINK EDIT IN PROGRESS


01970000  CONTROL MSG


01980000  ERROR DO


01990000         SET RC = &LASTCC


02000000         WRITE ERROR IN LINKEDIT PROCESS: RETURN CODE WAS &RC


02010000         IF &RC GT 8 THEN EXIT


02020000   WRITE  LINK EDIT LISTING WAS PLACED IN &SYSPREF..&FULLGEN..LINKLIST


02030000         EXIT


02040000        ENDO


02050000  LINK &FULLGEN. LOAD('&ASMLOD(&SCREEN)') LIST MAP PRINT(&FULLGEN)


02060000  ERROR OFF


02070000  WRITE LINK EDIT LISTING PLACED IN &SYSPREF..&FULLGEN..LINKLIST


02080000  WRITE


02090000  WRITE


02100000  SET IS = &STR( LOAD MODULE &SCREEN PLACED IN &ASMLOD )


02110000  SET &L = &LENGTH(&IS)


02120000  SET PS = &STR(.....................................................)


02130000  WRITE &SUBSTR(1:(77-&L)/2,&PS)&IS&SUBSTR(1:(78-&L)/2,&PS)


./ ADD NAME=FULLUT2  0103-80207-80288-1716-00182-00180-00006-LG00150
00010000PROC 2 SCREEN ASMLOD SCRUFLG(0) IOBUFLG(0) SCRNFLG(0) DEST()


00020000CONTROL NOMSG NOFLUSH END(ENDO)


00030000IF &SYSPREF = CTEST THEN CONTROL MSG LIST CONLIST SYMLIST


00040000


00050000IF &SYSPREF = &SYSUID THEN SET &FULLANAL = &STR(FULLANAL)


00060000                      ELSE SET &FULLANAL = &STR(&SYSUID..FULLANAL)


00070000


00080000IF &SUBSTR(1,&ASMLOD) NE &STR(') THEN SET &ASMLOD = &SYSPREF..&ASMLOD


00090000       ELSE SET &ASMLOD = &SUBSTR(2:&LENGTH(&ASMLOD)-1,&ASMLOD)


00100000


00110000IF &DEST NE THEN DO


00120000                 SET &DEST = &STR(DEST(&DEST))


00130000                 ENDO


00140000


00150000FREE F(FILEOUT,JOBSTREM,IN,OUT,LIBR)


00160000


00170000ERROR DO


00180000      SET RC = &LASTCC


00190000      IF &RC < 4 THEN WRITE '&ASMLOD' IS NOT A PDS;


00200000                 ELSE WRITE '&ASMLOD' COULD NOT BE FOUND;


00210000      WRITE PLEASE CHECK YOUR DSNAME.


00220000      EXIT


00230000      ENDO


00240000DATASTAT '&ASMLOD'


00250000


00260000ERROR DO


00270000     SET CC = &LASTCC


00280000     IF &CC NE 8 THEN DO


00290000                     WRITE UNKNOWN ERROR- LASTCC WAS &CC.


00300000                     WRITE PLEASE NOTIFY TSO COORDINATOR OF ERROR 1 IN F
ULLSCREEN ANALYZER.

00310000                     EXIT


00320000                      ENDO


00330000     WRITE MEMBER &SCREEN NOT FOUND IN '&ASMLOD'


00340000     EXIT


00350000      ENDO


00360000MEMSTAT '&ASMLOD(&SCREEN)'  NOPRINT


00370000


00380000ERROR DO


00390000      ERROR OFF


00400000      FREE F(FILEOUT) ATTR(AT1)


00410000      ATTR AT1 BLKSIZE(800) LRECL(80) RECFM(F,B)


00420000      ALLOC F(FILEOUT) DSN(&FULLANAL..SCREEN) NEW SPACE(1,1) TRACKS US(A
T1)

00430000      RETURN


00440000      ENDO


00450000ALLOC F(FILEOUT) DSN(&FULLANAL..SCREEN)


00460000


00470000ERROR OFF


00480000SET &QUALNO1 = D&SUBSTR(1:2,&SYSDATE)&SUBSTR(4:5,&SYSDATE)&SUBSTR(7:8,&S
YSDATE)

00490000SET &QUALNO2 = T&SUBSTR(1:2,&SYSTIME)&SUBSTR(4:5,&SYSTIME)&SUBSTR(7:8,&S
YSTIME)

00500000FREE F(JOBSTREM) ATTR(AT5)


00510000ATTR AT5 BLKSIZE(80) LRECL(80) RECFM(F,B)


00520000ALLOC F(JOBSTREM) DSN(&FULLANAL..&QUALNO1..&QUALNO2..JOB) NEW -


00530000TRACKS SP(1,1) US(AT5)


00540000


00550000ALLOC F(LIBR) DSN('&ASMLOD') SHR


00560000


00570000IF &SYSPREF = CTEST THEN CALL 'WDPSC.SYSLIBRY(WAITER)' '10'


00580000


00590000ERROR DO


00600000      WRITE LASTCC IS &LASTCC


00610000      WRITE PLEASE NOTIFY TSO COORDINATOR OF ERROR 2 IN FULLSCREEN ANALY
ZER.

00620000      EXIT


00630000      ENDO


00640000


00650003CALL 'WDPSC.SYSLIBRY(TUBE)' '&SCREEN'


00660000


00670000ERROR OFF


00680000


00690002IF &SCRUFLG = 0 AND &IOBUFLG = 0 AND &SCRNFLG = 0 THEN GOTO FAX


00700000


00710000KOMM RESET CLEAR


00720000


00730000IF &SCRUFLG NE 0 THEN DO


00740000     FREE F(SYS260J,SYSIN,SYS260A,SYSPRINT)


00750000     ALLOC F(SYSPRINT) DUMMY


00760000     ALLOC F(SYS260J) SYSOUT(A) &DEST


00770000     ALLOC F(SYS260A) DSN(&FULLANAL..&QUALNO1..&QUALNO2..JOB) SHR


00780000     ALLOC F(SYSIN) DA('WDPSC.CARD(TUBEDYL)')


00790000     SET I = 0


00800000        DO WHILE &I < &SCRUFLG


00810000          SET I = &I+1


00820000          CALL 'WDPSC.SYSLIBRY(DYL260)'


00830000        ENDO


00840000     WRITE


00850000     IF &SCRUFLG = 1 THEN WRITE ONE COPY OF SCRUFF WAS PRINTED.


00860000                     ELSE +


00870000     WRITE &SCRUFLG COPIES OF SCRUFF WERE PRINTED.


00880000                      ENDO


00890000


00900000IF &IOBUFLG NE 0 THEN DO


00910000     FREE F(SYS260A,SYSIN,SYSPRINT)


00920000     ALLOC F(SYS260A) DSN(&FULLANAL..SCREEN) SHR


00930000     ALLOC F(SYSIN) DSN('WDPSC.CARD(TUBE)') SHR


00940000     ALLOC F(SYSPRINT) SYSOUT(A) &DEST


00950000     SET I = 0


00960000        DO WHILE &I < &IOBUFLG


00970000          SET I = &I+1


00980000          CALL 'WDPSC.SYSLIBRY(DYL260)'


00990000        ENDO


01000000     WRITE


01010000     IF &IOBUFLG = 1 THEN WRITE ONE COPY OF THE I/O BUFFERS WAS PRINTED.


01020000                     ELSE +


01030000     WRITE &IOBUFLG COPIES OF THE I/O BUFFERS WERE PRINTED.


01040000                      ENDO


01050000


01060000IF &IOBUFLG NE 0 OR &SCRUFLG NE 0 THEN DO


01070000     FREE F(SYSIN,SYSPRINT,SYS260J)


01080000     ALLOC F(SYSIN) DA(*)


01090000     ALLOC F(SYSPRINT) DA(*)


01100000                                       ENDO


01110000


01120000IF &SCRNFLG NE 0 THEN DO


01130000


01140000     GETMY PROG SYS ACCT          /*  FIND JOBCARD INFO   */


01150000


01160000     IF &STR(&PROG) = &STR(*TSO* 0000 T) THEN DO


01170000        WRITENR PLEASE ENTER YOUR PROGRAMMER NAME FIELD ==>


01180000        READ


01190000        SET &L = &LENGTH(&SYSDVAL)


01200000


01210000        IF &L GE 20 THEN  SET &PROG = &SUBSTR(1:20,&SYSDVAL)


01220000                    ELSE +


01230000                          SET &PROG = +


01240000           &STR(&SYSDVAL&SUBSTR(&L+1:20,&STR(*TSO* 0000 T          )))


01250000


01260000        WRITE


01270000        WRITE TO AVOID BEING PROMPTED FOR PROGRAMMER NAME FIELD;


01280000        WRITE PLEASE USE THE PROG OPERAND ON AT LEAST ONE LOGON COMMAND.


01290000                                              ENDO


01300000


01310000       ERROR DO


01320000             ERROR OFF


01330000             COPY 'WDPSC.CARD(TUBE)' &FULLANAL..WORK


01340000             ERROR DO


01350000                   WRITE LASTCC IS &LASTCC.


01360000                   WRITE PLEASE NOTIFY TSO COORDINATOR OF ERROR 3 IN FUL
LSCREEN ANALYZER

01370000                   EXIT


01380000                   ENDO


01390000             ENDO


01400000


01410000     EDIT '&SYSPREF..&FULLANAL..WORK' OLD CNTL


01420000       ERROR DO


01430000             WRITE LASTCC IS &LASTCC.


01440000             WRITE PLEASE NOTIFY TSO COORDINATOR OF ERROR 4 IN FULLSCREE
N ANALYZER

01450000             END NOSAVE


01460000             EXIT


01470000             ENDO


01480000     TOP


01490000     DEL * 99999


01500000     SET JOBNAME = &SUBSTR(1:2,&SYSUID)F&SYS&SUBSTR(5:7,&SYSUID)


01510000     010 //&JOBNAME JOB (&ACCT),'&PROG',CLASS=A


01520000     030 /*ROUTE  PRINT LOCAL


01530000     040 //JOBCAT DD DSN=SYS1.USERCAT1,DISP=SHR


01540000     050 //*


01550000     060 //STEP1  EXEC  PGM=DYL260


01560000     070 //SYSPRINT DD  DUMMY


01570000     080 //SYS260A  DD DSN=&SYSPREF..&FULLANAL..&QUALNO1..&QUALNO2..JOB,


01580000     085 //   DISP=(OLD,DELETE)


01590000     090 //SYS260R  DD  SYSOUT=A,FLASH=NULL,CHARS=TN,COPIES=&SCRNFLG


01600000     100 //SYSIN  DD  *


01610000     110 C


01620000     120 FA F


01630000     130 R011060100   1


01640000     140 T1 5


01650000     150 T2F5


01660000     160 P   10 U1         01        X


01670000     170 P   80 A1         11        X


01680000     180 P   10 U1         91        X


01690000     WRITE


01700000     IF &SCRNFLG = 1 THEN +


01710000     WRITE THE FOLLOWING JOB WILL PRINT ONE COPY OF THE SCREEN:


01720000                     ELSE +


01730000     WRITE THE FOLLOWING JOB WILL PRINT &SCRNFLG COPIES OF THE SCREEN:


01740000     CONTROL MSG


01750000     IF &SYSPREF = CTEST THEN L


01760000                         ELSE SUB *


01770000     END NO


01770102     ERROR OFF


01771001     FREE DA('&SYSPREF..&FULLANAL..&QUALNO1..&QUALNO2..JOB') KEEP


01780000                       ENDO


01800002FAX: IF &SCRNFLG = 0 THEN +


01810002     FREE DA('&SYSPREF..&FULLANAL..&QUALNO1..&QUALNO2..JOB') DELETE


./ ADD NAME=HOSEDOWN 0108-81317-85113-1610-00161-00196-00000-JS02150
                    PROC 0 PANEL() MESSAGE() SKELETON() TABLEIN() TABLEOUT() -


                           TAILOUT() SPFLOAD() PRINT()





                    CONTROL NOMSG NOFLUSH END(ENDO)





                    IF &TABLEIN = AND +


                       &TABLEOUT = THEN GOTO ISPPLIB





                    IF &TABLEIN NE AND +


                       &TABLEOUT NE THEN GOTO DOTABLES





                    WRITE *****************************************


                    WRITE *  YOU MUST EITHER SPECIFY BOTH THE TABLE


                    WRITE *  INPUT AND OUTPUT LIBRARIES OR DO NOT


                    WRITE *  SPECIFY EITHER ONE AT ALL


                    WRITE *****************************************


                    GOTO ISPPLIB





        DOTABLES:   FREE F(ISPTABL)


                    FREE F(ISPTLIB)





                    IF &PRINT EQ YES THEN DO


                         WRITE &STR(TABLE INPUT LIBRARY DE-ALLOCATED)


                         WRITE &STR(TABLE OUTPUT LIBRARY DE-ALLOCATED)


                         ENDO





        ISPPLIB:    IF &PANEL = THEN GOTO ISPMLIB





                    SET &THEDSN = &PANEL


                    SET &WHICHONE = 1


                    SET &WHICHLIB = &STR(PANEL LIBRARY)


                    SET &DDNAM = ISPPLIB


                    SET &RETERN = ISPMLIB


                    GOTO FINFO





        ISPMLIB:    IF &MESSAGE = THEN GOTO ISPSLIB





                    SET &THEDSN = &MESSAGE


                    SET &WHICHONE = 2


                    SET &WHICHLIB = &STR(MESSAGE LIBRARY)


                    SET &DDNAM = ISPMLIB


                    SET &RETERN = ISPSLIB


                    GOTO FINFO





        ISPSLIB:    IF &SKELETON = THEN GOTO ISPFILE





                    SET &THEDSN = &SKELETON


                    SET &WHICHONE = 3


                    SET &WHICHLIB = &STR(SKELETON LIBRARY)


                    SET &DDNAM = ISPSLIB


                    SET &RETERN = ISPFILE


                    GOTO FINFO





        ISPFILE:    IF &TAILOUT = THEN GOTO ISPLLIB





                    FREE F(ISPFILE)





                    IF &PRINT EQ YES THEN DO


                          WRITE FILE TAILORING OUTPUT LIBRARY &STR(DE-ALLOCATED)


                          GOTO ISPLLIB


                          ENDO





        ISPLLIB:    IF &SPFLOAD = THEN GOTO KWIT





                    SET &THEDSN = &SPFLOAD


                    SET &WHICHONE = 7


                    SET &WHICHLIB = &STR(SPF LINK LIBRARY)


                    SET &DDNAM = ISPLLIB


                    SET &RETERN = KWIT


                    GOTO FINFO





        KWIT:       GOTO ENDIT





        FINFO:      FILEINFO DSN(&STR(&THEDSN))


                    SET &RC = &LASTCC





                    IF &RC EQ 96 THEN DO


                        WRITE **************************************************
*********

                        WRITE INVALID DSNAME SYNTAX OF &WHICHLIB


                        WRITE **************************************************
*********

                        GOTO EXITINFO


                        ENDO





                    IF &RC NE 0 THEN DO


                        WRITE *******************************************


                        WRITE &OUTMSG


                        WRITE *******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 6 THEN GOTO FINFO2





                    IF &DSORG NE PO THEN DO


                        WRITE *******************************************


                        WRITE THE &WHICHLIB MUST BE PARTITIONED


                        WRITE *******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &MEMCNTL EQ YES THEN DO


                        WRITE **************************


                        WRITE DO NOT PROVIDE MEMBER NAME


                        WRITE **************************


                        GOTO EXITINFO


                        ENDO





        FINFO2:     IF &WHICHONE NE 7 THEN GOTO FINFO3





                    IF &RECFM NE U THEN DO


                        WRITE **************************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN UNDEFINED RECORDS


                        WRITE **************************************************
****************

                        GOTO EXITINFO


                        ENDO





                    GOTO UNCONCAT





        FINFO3:     IF &RECFM NE F THEN DO


                        WRITE **************************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN FIXED LENGTH RECORDS


                        WRITE **************************************************
****************

                        GOTO EXITINFO


                        ENDO





                    IF &LRECL NE 80 THEN DO


                        WRITE **************************************************
*

                        WRITE LRECL OF &WHICHLIB MUST BE 80


                        WRITE **************************************************
*

                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 4 OR +


                       &WHICHONE = 5 OR +


                       &WHICHONE = 6 THEN GOTO UNCONCAT





                    IF &BLKSIZE LT 3120 THEN DO


                        WRITE ***********************************************


                        WRITE BLOCK SIZE OF &WHICHLIB


                        WRITE GREATER THAN OR EQUAL TO 3120


                        WRITE ***********************************************


                        GOTO EXITINFO


                        ENDO





        UNCONCAT:   CONCATEM ACTCODE(D) DDNAME(&DDNAM) DSNAME('&FULLDSN')


                    SET &RC = &LASTCC





                    IF &PRINT NE YES THEN GOTO EXITINFO





                    IF &RC = 0 THEN DO


                          WRITE &WHICHLIB &STR(DE-ALLOCATED)


                          GOTO EXITINFO


                          ENDO





                    WRITE *****************************************************


                    WRITE &OUTMSG


                    WRITE        (RETURN CODE = &RC)


                    WRITE *****************************************************





        EXITINFO:   GOTO &RETERN





        ENDIT:      EXIT


./ ADD NAME=HOTKEY   0101-89255-89255-1325-00358-00358-00001-KK00155
00010000PROC 2 DSN FTN L CPOS(1) ISDDN(NO) OKDSN(NO) ML() U M C R +


00011000       FILEAID(NO) ACF2(YES)


00012000/* IF NOT USING ACF2 TO LIMIT ZAP ACCESS, CHANGE ACF2 PARM TO NO */


00020000CONTROL NOFLUSH NOMSG END(ENDO)


00021000SET &CURLVL = V2M0


00022000IF &L = L THEN CONTROL NOFLUSH MSG LIST CONLIST SYMLIST


00023000IF &SYSPREFIX = GX00155 THEN CONTROL NOFLUSH MSG LIST CONLIST SYMLIST


00024000ISPEXEC CONTROL ERRORS RETURN


00025000STACK FAST


00025100SET ACFUID = XXXXYYYY


00026000GETMY PROG SYS ACCT TERMID SYSID ACFUID


00027000ISPEXEC VPUT (PROG SYS ACCT TERMID SYSID ACFUID) SHARED


00028000SET &COMMLIST = &STR(BROWSE EDIT LIB INFO PDS TO FROM ZAP)


00029000ISPEXEC VGET (ERRPNL HOTLVL) PROFILE


00030000ISPEXEC VGET ZAPPLID ASIS


00040000IF &ERRPNL = &STR() THEN SET ERRPNL = DISP


00041000


00041100IF &HOTLVL ¬= &CURLVL THEN +


00041200  DO


00041300  SET &HOTISR = ISR(OFF)


00041400  SET &HOTIOF = IOF(OFF)


00041500  SET &HOTFAXE = FAXE(OFF)


00041600  SET HOT&ZAPPLID = &ZAPPLID(ON)


00041700  WRITE PLEASE WAIT.  HOTKEYS FOR &SYSUID IS BEING UPDATED TO CURRENT LE
VEL...

00041800  %HOTKEYS REFRESH &HOTISR &HOTIOF &HOTFAXE


00041900  WRITE HOTKEYS NOW AT &CURLVL LEVEL


00042000  SET &HOTLVL = &CURLVL


00042100  ISPEXEC VPUT HOTLVL PROFILE


00042200  ENDO


00042300


00042400IF &STR(&DSN) = &STR(=) THEN +


00042500  DO


00042600  ISPEXEC SELECT PGM(ISPCDSN) PARM(DSN (SCREEN))


00042700  SET CDSRC = &LASTCC


00042800  IF &CDSRC NE 0 THEN +


00042900    DO


00043000    IF &ERRPNL = DISP THEN +


00043100      DO


00043200      IF &STR(&DSN) = &STR(=) THEN EXIT


00043300      SET &GPM = &STR(BAD DSN-&CDSRC)


00043400      SET &GPML = &STR(THE ITEM SELECTED MAY BE INVALID - &DSN)


00043500      ISPEXEC DISPLAY PANEL(GPM)


00043600      ENDO


00043700    EXIT


00043800    ENDO


00043900  ISPEXEC VGET (DSN ISPCPOS) SHARED


00044000  IF &LASTCC = 0 THEN +


00045000    SET &CPOS = &ISPCPOS


00046000  ELSE +


00047000    EXIT CODE(99)


00048000  ENDO


00049000ELSE +


00050000  SET &ISPCPOS = &CPOS


00060000IF &SYSINDEX(&FTN,&COMMLIST) ¬= 0 THEN GOTO VCOMM


00070000                                  ELSE GOTO V&FTN


00080000


00090000VBROWSE: GOTO VEDIT


00100000VEDIT: +


00110000IF &ISDDN = YES THEN +


00120000  DO


00130000  ISPEXEC LMINIT DATAID(ID) DDNAME(&DSN)


00131000  IF &LASTCC ¬= 0 THEN SET &ERRFLAG = ON


00132000  SET &EDBRCMD = ISPEXEC &FTN DATAID(&ID)


00132100  SET &BADLMSG = &STR(YOUR DDNAME SELECTION WAS - &DSN)


00132200  ENDO


00132300ELSE +


00132400  IF &OKDSN = YES THEN +


00132500    DO


00132600    SET &EDBRCMD = ISPEXEC &FTN DATASET(&DSN)


00132700    SET &BADLMSG = &STR(YOUR DATASET SELECTION WAS - &DSN)


00132800    ENDO


00132900ELSE +


00133000  DO


00133100    SET &ERRFLAG = ON


00133200    SET &BADSMSG = &STR(NOT FOUND)


00133300    SET &BADLMSG = &STR(THE ITEM SELECTED MAY BE INVALID - &DSN)


00133400  ENDO


00133500GOTO &FTN


00133600


00133700VLIB:  GOTO VINFO


00133800VINFO: +


00133900IF &ISDDN = YES THEN +


00134000  DO


00134100  WHATDSN DDN(&DSN)


00134200  SET FADSN = '&DSNAME'


00134300  ENDO


00134400ELSE +


00134500  SET FADSN = &STR(&DSN)


00134600SET MEMP = &SYSINDEX((,&STR(&FADSN))


00134700IF &MEMP ¬= 0 THEN +


00134800  DO


00134900    SET FADSN = &SUBSTR(1:&MEMP-1,&STR(&FADSN))


00135000    IF &SYSINDEX(',&STR(&FADSN)) = 1 THEN +


00135100      SET &FADSN = &FADSN'


00135200  ENDO


00135300GOTO &FTN


00135400


00135500VPDS: +


00135600IF &U ¬= U THEN +


00135700  DO


00135800  IF &ML ¬= &Z THEN SET &ML = &STR(ML &ML)


00135900               ELSE SET &ML = &STR(ML :)


00136000  SET &ML = &STR(&ML NOLKED)


00137000  ENDO


00138000ELSE +


00139000  SET ML = &STR()


00140000IF &ISDDN = YES THEN +


00141000  SET &PDSCMD = PDS FILE(&DSN) &ML


00142000ELSE IF &OKDSN = YES THEN +


00143000  SET &PDSCMD = PDS &DSN &ML


00144000GOTO &FTN


00145000


00146000VFROM: GOTO VTO


00147000VTO: +


00148000IF &FTN = FROM THEN SET NEXT = TO


00149000               ELSE SET NEXT = FROM


00150000IF &ISDDN = YES THEN +


00160000  DO


00170000  WHATDSN DDN(&DSN)


00180000  SET &DSN = '&DSNAME'


00190000  ENDO


00191000SET &HOT&FTN = &DSN


00192000ISPEXEC VPUT HOT&FTN PROFILE


00193000SET ZPF = &&ZPF


00194000SET ZPFL = &&ZPFL


00195000SET I = 1


00196000DO WHILE &I < 25


00197000  SET J = &SUBSTR(2:3,&EVAL(100+&I))


00198000  ISPEXEC VGET (ZPF&J ZPFL&J) PROFILE


00199000  IF &STR(&ZPFL&J) = &STR(&FTN) THEN SET I = 25


00199100  IF &STR(&ZPFL&J) = &STR(&FTN) THEN SET ZPF&J = &STR(OTSO %HOTKEY = &NE
XT)

00199200  IF &STR(&ZPFL&J) = &STR(&FTN) THEN SET ZPFL&J = &STR(&NEXT)


00199300  ISPEXEC VPUT (ZPF&J ZPFL&J) PROFILE


00199400  SET I = &I+1


00199500  ENDO


00199600GOTO &FTN


00199700


00199800VMENU: +


00199900IF &ISDDN = YES THEN +


00200000  DO


00210000  WHATDSN DDN(&DSN)


00220000  SET FULLDSN = &DSNAME


00230000  ENDO


00240000SET DSN = &FULLDSN


00250000IF &SUBSTR(1:8,&ACFUID) = &STR(155D2100) OR   +


00260000   &SUBSTR(1:8,&ACFUID) = &STR(155D2300) OR   +


00261000   &ACF2 NE YES THEN +


00270000  DO


00280000  SET ZAPP = &STR( ZAP)


00290000  SET ZAPPT = &STR(     - ACTIVATE URZAP FOR THIS DATASET)


00300000  ENDO


00310000SET CO = &STR( F)


00320000SET COT = &STR((3.3)- COPY FROM ABOVE DATASET )


00330000ISPEXEC VGET HOTFROM PROFILE


00340000IF &HOTFROM NE &STR() THEN +


00350000  DO


00360000  SET REPT = &STR(REPLACE OPTION==>)


00370000  SET CO = &STR( T)


00380000  SET COT = &STR((3.3)- COPY TO ABOVE DATASET FROM &HOTFROM)


00390000  ENDO


00400000ISPEXEC DISPLAY PANEL(HOTMENU)


00410000IF &LASTCC NE 0 THEN EXIT


00420000IF &STR(&DSN) NE &STR('&FULLDSN') THEN GOTO VCOMM


00430000EXIT


00440000


00450000VZAP: +


00460000  IF &ISDDN = YES THEN +


00470000    DO


00480000    WHATDSN DDN(&DSN)


00490000    SET &DSN = '&DSNAME'


00500000    ENDO


00510000ELSE +


00520000  DO


00530000  FILEINFO DSN(&DSN)


00540000  SET &DSN = '&FULLDSN'


00550000  ENDO


00560000GOTO &FTN


00570000


00580000VFLIST: +


00590000SET &FADSN = &DSN


00600000SET FADSNL = &LENGTH(&FADSN)


00610000SET FCHR = &SUBSTR(1,&DSN)


00620000IF &FCHR ¬= &STR(') THEN +


00630000  DO


00640000  IF &FCHR = $ | &FCHR = # | &FCHR = @ THEN +


00650000    DO


00660000    SET &FADSN = &SUBSTR(2:&FADSNL,&FADSN)


00670000    IF &CPOS > 1 THEN SET &CPOS = &CPOS - 1


00680000    ENDO


00681000  IF &SYSDSN('&FADSN') = OK THEN +


00682000    SET &OKDSN = YES


00683000  ELSE +


00684000    DO


00685000    SET &PFXFADSN = '&SYSPREF..&FADSN'


00685100    IF &SYSDSN(&PFXFADSN) = OK THEN +


00685200      DO


00685300      SET &PFXLEN = &LENGTH(&SYSPREF)


00685400      SET &FADSN = &PFXFADSN


00685500      SET &CPOS = &CPOS + &PFXLEN + 2


00685600      SET &OKDSN = YES


00685700      ENDO


00685800    ENDO


00685900  ENDO


00686000ELSE +


00687000  IF &SYSDSN(&FADSN) = OK THEN SET &OKDSN = YES


00687100SET FADSNL = &LENGTH(&FADSN)


00687200IF &OKDSN = NO && &ISPCPOS = 1 THEN +


00687300  SET &CPOS = &FADSNL


00687400IF &SUBSTR(1,&FADSN) = &STR(') THEN +


00687500  DO


00687600  SET &FADSN = &SUBSTR(2:&FADSNL,&FADSN)


00687700  IF &CPOS > 1 THEN SET &CPOS = &CPOS - 1


00687800  SET &FADSNL = &FADSNL - 1


00687900  ENDO


00688000IF &SUBSTR(&FADSNL,&FADSN) = &STR(') THEN +


00688100  DO


00688200  SET &FADSN = &SUBSTR(1:&EVAL(&FADSNL-1),&FADSN)


00688300  IF &CPOS = &FADSNL THEN SET &CPOS = &CPOS - 1


00688400  SET &FADSNL = &FADSNL - 1


00688500  ENDO


00688600SET &FDELPOS = &SYSINDEX(.,&FADSN)


00688700IF &FDELPOS = 0 THEN +


00688800  SET &CPOS = &FADSNL


00688900ELSE IF &CPOS < &FDELPOS THEN +


00689000  SET &CPOS = &FDELPOS


00689100SET &POSTPOS = &CPOS + 1


00689200IF &POSTPOS > &FADSNL THEN +


00689300  SET &FADSN = &FADSN..


00689400SET &POSTCHR = &SUBSTR(&POSTPOS,&FADSN)


00689500IF &POSTCHR = &STR(.) THEN +


00689600  SET &CPOS = &CPOS+1


00689700SET &FADSN = &SUBSTR(1:&CPOS,&FADSN)


00689800SET &FADSN = &STR(&FADSN*)


00689900GOTO &FTN


00690000


00690100VCOMM: +


00690200SET F = &SUBSTR(1,&DSN)


00690300IF &LENGTH(&STR(&DSN)) < 9 AND &F NE &STR(') THEN +


00690400  DO


00690500  SET P = &SYSINDEX(&STR(.),&STR(&DSN))


00690600  SET M = &SYSINDEX((,&STR(&DSN))


00690700  IF &P = 0 AND &M = 0 THEN +


00690800    DO


00690900    IFALC F(&DSN)


00691000    IF &LASTCC = 0 THEN +


00691100      DO


00691200      SET &ISDDN = YES


00691300      SET &OKDSN = YES


00691400      ENDO


00691500    ENDO


00691600  ENDO


00691700IF &ISDDN = NO THEN +


00691800  DO


00691900  IF &SYSDSN(&DSN) = OK THEN +


00692000    SET &OKDSN = YES


00692100  ELSE +


00692200    DO


00692300    IF &F ¬= &STR(') THEN +


00692400      DO


00692500      IF &SYSDSN('&DSN') = OK THEN +


00692600        DO


00692700        SET &DSN = &STR('&DSN')


00692800        SET &OKDSN = YES


00692900        ENDO


00693000      ELSE IF &F = $ OR &F = # OR &F = @ THEN +


00693100        DO


00693200        SET &NADSN = '&SUBSTR(2:&LENGTH(&DSN),&DSN)'


00693300        IF &SYSDSN(&NADSN) = OK THEN +


00693400          DO


00693500          SET &DSN = &NADSN


00693600          SET &OKDSN = YES


00693700          ENDO


00693800        ENDO


00693900      ENDO


00694000    ENDO


00694100  ENDO


00694200IF &OKDSN = NO THEN +


00694300  DO


00694400  WHATDDN DS('&DSN')


00694500  IF &LASTCC = 0 THEN +


00694600    DO


00694700    SET &DSN = &DDNAME1


00694800    SET &ISDDN = YES


00694900    ENDO


00695000  ENDO


00695100GOTO V&FTN


00695200


00695300BROWSE: GOTO EDIT


00695400EDIT: +


00695500&EDBRCMD


00695600IF (&LASTCC > 4 | &ERRFLAG = ON) && &ERRPNL = DISP THEN +


00695700  DO


00695800    ISPEXEC SETMSG MSG(ISRZ002)


00695900    SET &GPM  = &STR(&BADSMSG)


00696000    SET &GPML = &STR(&BADLMSG)


00697000    ISPEXEC DISPLAY PANEL(GPM)


00698000  ENDO


00699000EXIT


00700000


00701000LIB: +


00702000SET &FADCMD = ISPEXEC SELECT PGM(ISRUDA) PARM(ISRUDA1)


00703000GOTO FADCOMM


00703100


00703200INFO: +


00703300SET DMPDSN =


00703400ISPEXEC VPUT DMPDSN PROFILE


00703500SET &FADCMD = ISPEXEC SELECT PANEL(IFAMU01) OPT(3.2)


00703600IF &FILEAID NE YES THEN +


00703700  DO


00703800  SET FAOPT = I


00703900  GOTO LIB


00704000  ENDO


00704100GOTO FADCOMM


00704200


00704300PDS: +


00704400&PDSCMD


00704500EXIT


00705000


00706000FROM: +


00707000EXIT


00708000


00709000TO: +


00710000IF &R = R THEN SET R = Y


00720000          ELSE SET R = N


00730000IF &U = U THEN SET FAOPT = WAIT


00740000          ELSE SET FAOPT = C&R


00750000IF &M = M THEN SET FAOPT = M&R


00760000ISPEXEC VPUT (FAOPT) PROFILE


00770000ISPEXEC SELECT PGM(ISRUMC)


00780000SET HOTFROM =


00790000SET HOTTO =


00791000SET FAOPT =


00792000ISPEXEC VPUT (HOTFROM HOTTO FAOPT) PROFILE


00793000EXIT


00794000


00795000ZAP: +


00796000WRITENR


00797000URZAP &DSN


00798000ISPEXEC SELECT PGM(CLRSPFIO)


00799000ISPEXEC CONTROL DISPLAY REFRESH


00800000EXIT


00810000


00820000FLIST: +


00830000SET &FADCMD = ISPEXEC SELECT PANEL(IFAMU01) OPT(3.4)


00830100IF &FILEAID NE YES THEN +


00831000  SET &FADCMD = ISPEXEC SELECT PGM(ISRUDL) PARM(ISRUDLP)


00840000GOTO FADCOMM


00850000


00860000FADCOMM: +


00870000IF &U = U THEN SET FAOPT = WAIT


00880001/*        ELSE SET FAOPT = */


00890000ISPEXEC VPUT (FAOPT FADSN) SHARED


00900000&FADCMD


00910000SET FAOPT =


00920000SET FADSN =


00930000SET &ZTRAIL =


00940000ISPEXEC VPUT (FAOPT FADSN ZTRAIL) SHARED


00950000EXIT


./ ADD NAME=HOTKEYO  0105-88307-88309-1540-00305-00257-00065-GS00155
00010003PROC 2 DSN FTN L CPOS(1) ALCRC(4) FRC(4) U M C R


00020000CONTROL NOFLUSH NOMSG END(ENDO)


00030000IF &L = L THEN CONTROL NOFLUSH MSG LIST CONLIST SYMLIST


00040000ISPEXEC CONTROL ERRORS RETURN


00040100STACK FAST


00040200ISPEXEC VGET ERRPNL PROFILE


00040300IF &ERRPNL = &STR() THEN SET ERRPNL = DISP


00040400GETMY PROG SYS ACCT TERMID SYSID ACFUID


00040500ISPEXEC VPUT (PROG SYS ACCT TERMID SYSID ACFUID) SHARED


00040600


00040700RETEST: +


00040800IF &STR(&DSN) = &STR(=) THEN +


00040900  DO


00041001  ISPEXEC SELECT PGM(ISPCDSN) PARM(DSN (SCREEN))


00042000  SET CDSRC = &LASTCC


00043000  IF &CDSRC NE 0 THEN +


00044000    DO


00045000    IF &ERRPNL = DISP THEN +


00046000      DO


00047000      IF &STR(&DSN) = &STR(=) THEN EXIT


00048000      SET &GPM = &STR(BAD DSN-&CDSRC)


00049000      SET &GPML = &STR(THE ITEM SELECTED MAY BE INVALID - &DSN)


00050000      ISPEXEC DISPLAY PANEL(GPM)


00060000      ENDO


00070000    EXIT


00080000    ENDO


00090001  ISPEXEC VGET (DSN ISPCPOS) SHARED


00100000  IF &LASTCC NE 0 THEN +


00110000    DO


00120000    EXIT CODE(99)


00130000    ENDO


00131003  SET &CPOS = &ISPCPOS


00140000  ENDO


00150000


00160000SET F = &SUBSTR(1,&DSN)


00170000IF &LENGTH(&STR(&DSN)) < 9 AND &F NE &STR(') THEN +


00180000  DO


00190000  SET P = &SYSINDEX(&STR(.),&STR(&DSN))


00200000  SET M = &SYSINDEX((,&STR(&DSN))


00210000  IF &P = 0 AND &M = 0 THEN +


00220000    DO


00230000    IFALC F(&DSN)


00240000    SET ALCRC = &LASTCC


00250000    ENDO


00260000  ENDO


00270000


00280000IF &ALCRC NE 0 THEN +


00290000  DO


00300000  SET FULLDSN = &DSN


00310000  IF &SYSDSN(&DSN) = OK THEN SET FRC = 0


00320000     ELSE SET FRC = 4


00330000  IF &FRC NE 0 AND &F NE &STR(') THEN +


00340000    DO


00350000    IF &SYSDSN('&DSN') = OK THEN SET FRC = 0


00360000       ELSE SET FRC = 4


00370000    IF &FRC = 0 THEN +


00371000      DO


00372000      SET DSN = &STR('&DSN')


00373000      SET FULLDSN = &DSN


00374000      ENDO


00375000    ELSE IF &F = $ OR &F = # OR &F = @ THEN +


00376000      DO


00376100      SET &NADSN = '&SUBSTR(2:&LENGTH(&DSN),&DSN)'


00376200      IF &SYSDSN(&NADSN) = OK THEN +


00376300        DO


00376400        SET FRC = 0


00376500        SET &DSN = &NADSN


00376600        SET &FULLDSN = &NADSN


00376700        ENDO


00376800      ELSE SET FRC = 4


00376900      ENDO


00377000    ENDO


00378000  ENDO


00379000


00380000IF &ALCRC NE 0 AND &FRC NE 0 THEN +


00390000  DO


00400000  WHATDDN DS('&DSN')


00410000  IF &LASTCC = 0 THEN +


00420000    DO


00430000    SET &ALCRC = 0


00440000    SET &DSN = &DDNAME1


00450000    ENDO


00460000  ENDO


00470000


00480000IF &FTN = MENU THEN +


00490000  DO


00500000  IF &ALCRC = 0 THEN +


00510000    DO


00520000    WHATDSN DDN(&DSN)


00530000    SET FULLDSN = &DSNAME


00540000    ENDO


00550000  SET DSN = &FULLDSN


00560000  IF &SUBSTR(1:8,&ACFUID) = &STR(155D2100) OR   +


00570000     &SUBSTR(1:8,&ACFUID) = &STR(155D2300) THEN +


00580000    DO


00581000    SET ZAP = &STR( ZAP)


00582000    SET ZAPT = &STR(     - ACTIVATE URZAP FOR THIS DATASET)


00583000    ENDO


00584000  SET CO = &STR( F)


00585000  SET COT = &STR((3.3)- COPY FROM ABOVE DATASET )


00586000  ISPEXEC VGET HOTFROM PROFILE


00587000  IF &HOTFROM NE &STR() THEN +


00588000    DO


00589000    SET REPT = &STR(REPLACE OPTION==>)


00590000    SET CO = &STR( T)


00600000    SET COT = &STR((3.3)- COPY TO ABOVE DATASET FROM &HOTFROM)


00610000    ENDO


00611000  ISPEXEC DISPLAY PANEL(HOTMENU)


00612000  IF &LASTCC NE 0 THEN EXIT


00613000  IF &STR(&DSN) NE &STR('&FULLDSN') THEN GOTO RETEST


00614000  ENDO


00615000


00615100IF &FTN = EDIT OR &FTN = BROWSE THEN +


00615200  DO


00615300  IF &ALCRC = 0 THEN +


00615400    DO


00615500    ISPEXEC LMINIT DATAID(ID) DDNAME(&DSN)


00615600    SET INITRC = &LASTCC


00615700    IF &INITRC = 0 THEN ISPEXEC &FTN DATAID(&ID)


00615800    SET FTNRC = &LASTCC


00615900    IF &INITRC NE 0 OR &FTNRC NE 0 THEN +


00616000      DO


00617000      ISPEXEC SETMSG MSG(ISRZ002)


00618000      SET &GPML = &STR(YOUR DDNAME SELECTION WAS - &DSN)


00619000      ISPEXEC DISPLAY PANEL(GPM)


00620000      ENDO


00630000    EXIT


00631000    ENDO


00632000  IF &FRC = 0 THEN +


00633000    DO


00634000    ISPEXEC &FTN DATASET(&FULLDSN)


00635000    IF &LASTCC > 4 THEN +


00636000      DO


00637000      ISPEXEC SETMSG MSG(ISRZ002)


00638000      SET &GPML = &STR(YOUR DATASET SELECTION WAS - &DSN)


00639000      ISPEXEC DISPLAY PANEL(GPM)


00640000      ENDO


00640100    ENDO


00640200  IF &ALCRC NE 0 AND &FRC NE 0 THEN +


00640300    DO


00640400    IF &ERRPNL = DISP THEN +


00640500      DO


00640600      SET &GPM = &STR(NOT FOUND)


00640700      SET &GPML = &STR(THE ITEM SELECTED MAY BE INVALID - &DSN)


00640800      ISPEXEC DISPLAY PANEL(GPM)


00640900      ENDO


00641000    EXIT


00642000    ENDO


00643000  ENDO


00644000


00645000IF &FTN = LIB OR &FTN = LIBRARY OR &FTN = INFO OR &FTN = FLIST THEN +


00646000  DO


00647001  IF &ALCRC = 0 THEN +


00648001    DO


00649001    WHATDSN DDN(&DSN)


00650001    SET FADSN = '&DSNAME'


00651001    ENDO


00651101  ELSE +


00651201    SET FADSN = &DSN


00651400  SET MEMP = &SYSINDEX((,&STR(&FADSN))


00651500  IF &MEMP ¬= 0 THEN +


00651600    DO


00651700      SET FADSN = &SUBSTR(1:&MEMP-1,&FADSN)


00651800      IF &SYSINDEX(',&STR(&FADSN)) = 1 THEN +


00651900        SET &FADSN = &FADSN'


00652000    ENDO


00652100  IF &U = U THEN SET FAOPT = WAIT


00653000            ELSE SET FAOPT =


00654000  ISPEXEC VPUT (FAOPT FADSN) SHARED


00655000  IF &FTN = LIB OR &FTN = LIBRARY  THEN +


00656000    ISPEXEC SELECT PGM(ISRUDA) PARM(ISRUDA1)


00657000  IF &FTN = INFO THEN +


00658000    DO


00659000    SET DMPDSN =


00660000    ISPEXEC VPUT DMPDSN PROFILE


00661000    ISPEXEC SELECT PANEL(IFAMU01) OPT(3.2)


00662000    ENDO


00662104


00663000  IF &FTN = FLIST THEN +


00664000    DO


00664202    SET FADSNL = &LENGTH(&FADSN)


00664304    SET &OKDSN = NO


00664402    IF &SUBSTR(1,&FADSN) ¬= &STR(') THEN +


00664502      DO


00664704      IF &SYSDSN('&FADSN') = OK THEN +


00664804        SET &OKDSN = YES


00664904      ELSE +


00665004        DO


00665104        SET &PFXFADSN = '&SYSPREF..&FADSN'


00665204        IF &SYSDSN(&PFXFADSN) = OK THEN +


00665304          DO


00665404          SET &PFXLEN = &LENGTH(&SYSPREF)


00665504          SET &FADSN = &PFXFADSN


00665604          SET &FADSNL = &FADSNL + &PFXLEN + 3


00665704          SET &CPOS = &CPOS + &PFXLEN + 2


00665804          SET &OKDSN = YES


00665904          ENDO


00666004        ENDO


00666104      ENDO


00666204        ELSE +


00666504          IF &SYSDSN(&FADSN) = OK THEN SET &OKDSN = YES


00666604    IF &OKDSN = NO && &ISPCPOS = 1 THEN +


00666704      SET &CPOS = &FADSNL


00666803    IF &SUBSTR(1,&FADSN) = &STR(') THEN +


00666903      DO


00667003      SET &FADSN = &SUBSTR(2:&FADSNL,&FADSN)


00667104      IF &CPOS > 1 THEN SET &CPOS = &CPOS - 1


00667203      SET &FADSNL = &FADSNL - 1


00667303      ENDO


00667403    IF &SUBSTR(&FADSNL,&FADSN) = &STR(') THEN +


00667503      DO


00667603      SET &FADSN = &SUBSTR(1:&EVAL(&FADSNL-1),&FADSN)


00667704      IF &CPOS = &FADSNL THEN SET &CPOS = &CPOS - 1


00667804      SET &FADSNL = &FADSNL - 1


00667903      ENDO


00668004    SET &FDELPOS = &SYSINDEX(.,&FADSN)


00668104    IF &FDELPOS = 0 THEN +


00668204      SET &CPOS = &FADSNL


00668303    ELSE IF &CPOS < &FDELPOS THEN +


00668403      SET &CPOS = &FDELPOS


00668503    SET &POSTPOS = &CPOS + 1


00668603    IF &POSTPOS > &FADSNL THEN +


00668703      DO


00668803      SET &FADSN = &FADSN..


00668903      SET &FADSNL = &FADSNL + 1


00669003      ENDO


00669103    SET &POSTCHR = &SUBSTR(&POSTPOS,&FADSN)


00669201    IF &POSTCHR = &STR(.) THEN +


00669303      SET &CPOS = &CPOS+1


00669403    SET &FADSN = &SUBSTR(1:&CPOS,&FADSN)


00669501    SET &FADSN = &STR(&FADSN*)


00669600    ISPEXEC VPUT FADSN SHARED


00669700    ISPEXEC SELECT PANEL(IFAMU01) OPT(3.4)


00669800    ENDO


00669900  SET FAOPT =


00670000  SET FADSN =


00670105  SET &ZTRAIL =


00670205  ISPEXEC VPUT (FAOPT FADSN ZTRAIL) SHARED


00670300  ENDO


00670400


00670500IF &FTN = PDS THEN +


00670600  DO


00670700  IF &U = U THEN SET ML = &STR()


00670800            ELSE SET ML = &STR(MEMLIST :)


00670900  IF &ALCRC = 0 THEN +


00671000    DO


00671100    PDS FILE(&DSN) &ML


00671200    EXIT


00671300    ENDO


00671400  IF &FRC = 0 THEN +


00671500    PDS &DSN &ML


00671600  ENDO


00671700


00671800IF &FTN = ZAP THEN +


00671900  DO


00672000  FILEINFO DSN(&DSN)


00672100  IF &ALCRC = 0 THEN +


00672200    DO


00672300    WHATDSN DDN(&DSN)


00672400    SET FULLDSN = '&DSNAME'


00672500    ENDO


00672600  URZAP '&FULLDSN'


00672700  ISPEXEC SELECT PGM(CLRSPFIO)


00672800  ISPEXEC CONTROL DISPLAY REFRESH


00672900  ENDO


00673000


00673100IF &FTN = FROM OR &FTN = TO THEN +


00673200  DO


00673300  IF &FTN = FROM THEN SET NEXT = TO


00673400                 ELSE SET NEXT = FROM


00673500  IF &ALCRC = 0 THEN +


00673600    DO


00674000    WHATDSN DDN(&DSN)


00675000    SET FULLDSN = '&DSNAME'


00676000    ENDO


00677000  SET HOT&FTN = &FULLDSN


00678000  ISPEXEC VPUT HOT&FTN PROFILE


00679000  SET ZPF = &&ZPF


00680000  SET ZPFL = &&ZPFL


00690000  SET I = 1


00690100  DO WHILE &I < 25


00690200    SET J = &SUBSTR(2:3,&EVAL(100+&I))


00690300    ISPEXEC VGET (ZPF&J ZPFL&J) PROFILE


00690400    IF &STR(&ZPFL&J) = &STR(&FTN) THEN SET I = 25


00690500    IF &STR(&ZPFL&J) = &STR(&FTN) THEN SET ZPF&J = &STR(OTSO %HOTKEY = &
NEXT)

00690600    IF &STR(&ZPFL&J) = &STR(&FTN) THEN SET ZPFL&J = &STR(&NEXT)


00690700    ISPEXEC VPUT (ZPF&J ZPFL&J) PROFILE


00690800    SET I = &I+1


00690900    ENDO


00691000  IF &FTN = TO THEN +


00691100    DO


00691200    IF &R = R THEN SET R = Y


00691300              ELSE SET R = N


00691400    IF &U = U THEN SET FAOPT = WAIT


00691500              ELSE SET FAOPT = C&R


00691600    IF &M = M THEN SET FAOPT = M&R


00691700    ISPEXEC VPUT (FAOPT) PROFILE


00691800    ISPEXEC SELECT PGM(ISRUMC)


00691900    SET HOTFROM =


00692000    SET HOTTO =


00693000    SET FAOPT =


00694000    ISPEXEC VPUT (HOTFROM HOTTO FAOPT) PROFILE


00695000    ENDO


00696000  ENDO


00697000


./ ADD NAME=HOTKEYS  0100-89254-89254-2249-00210-00210-00000-KK00155
00010000PROC 0 ON OFF NOSHOW LOW HI SHOW L MENU(KEY) APPL() ERRPNL(DISP) +


00011000       ISR(ON) IOF(ON) FAXE(ON) REFRESH ACF2(YES) TSO(OTSO)


00011100/*


00011200/* CHANGE IOF  PARM TO NO ABOVE IF NOT USING IOF                  */


00011300/* CHANGE FAXE PARM TO NO ABOVE IF NOT USING FILEAID              */


00011400/* CHANGE ACF2 PARM TO NO ABOVE IF NOT USING ACF2 TO LIMIT URZAP  */


00011500/* CHANGE TSO  PARM TO TSO ABOVE IF NOT USING RTSO IN CMD TABLE   */


00011600/*


00012000CONTROL END(ENDO)


00013000IF &L = L THEN CONTROL MSG LIST CONLIST SYMLIST


00014000IF &SYSPREF = GX00155 THEN CONTROL MSG LIST CONLIST SYMLIST


00015000STACK FAST


00016000IF &REFRESH = REFRESH THEN +


00017000  DO


00018000  %HOTKEYS OFF &NOSHOW &SHOW &HI &LOW MENU(&MENU) ISR(&ISR) IOF(&IOF) FA
XE(&FAXE)

00019000  %HOTKEYS ON &NOSHOW &SHOW &L MENU(&MENU) &HI &LOW ISR(&ISR) IOF(&IOF)
FAXE(&FAXE)

00020000  EXIT


00030000  ENDO


00030100IF &LOW NE LOW THEN SET HI = HI


00030200IF &OFF NE OFF THEN SET ON = ON


00030300


00030400IF &APPL = &Z THEN +


00030500  DO


00030600  ISPEXEC VPUT ERRPNL PROFILE


00030700  IF &ISR = ON THEN +


00030800    DO


00030900    ISPEXEC SELECT NEWAPPL(ISR) +


00031000     CMD(%&SYSICMD &ON &OFF &NOSHOW &LOW &HI &SHOW &L MENU(&MENU) APPL(I
SR))

00031100    ENDO


00031200  IF &IOF = ON THEN +


00031300    DO


00031400    ISPEXEC SELECT NEWAPPL(IOF) +


00031500     CMD(%&SYSICMD &ON &OFF &NOSHOW &LOW &HI &SHOW &L MENU(&MENU) APPL(I
OF))

00031600    ENDO


00031700  IF &FAXE = ON THEN +


00031800    DO


00031900    ISPEXEC SELECT NEWAPPL(FAXE) +


00032000     CMD(%&SYSICMD &ON &OFF &NOSHOW &LOW &HI &SHOW &L MENU(&MENU) APPL(F
AXE))

00032100    ENDO


00032200


00032300  IF &SHOW = &Z AND &NOSHOW = &Z THEN +


00032400    DO


00032500    IF &ON = ON THEN SET &SHOWSTAT = ON


00032600                ELSE SET &SHOWSTAT = OFF


00032700    ENDO


00032800  ELSE +


00032900    DO


00033000    IF &SHOW = SHOW THEN SET &SHOWSTAT = ON


00033100                    ELSE SET &SHOWSTAT = OFF


00033200    ENDO


00033300  ISPEXEC SELECT PGM(ISPOPF) PARM(&SHOWSTAT) NOFUNC


00033400  EXIT


00033500  ENDO


00033600


00033700IF &ON = ON THEN +


00033800  DO


00033900  IF &LOW = LOW THEN SET ZPFSET = ALT


00034000                ELSE SET ZPFSET = PRI


00035000  SET ZPFFMT = MAX


00036000  ISPEXEC VPUT (ZPFSET ZPFFMT) PROFILE


00037000  ENDO


00038000


00039000SET KEY = &&KEY


00040000SET KEYL = &&KEYL


00041000SET OPF = &&OPF


00041100SET OPFL = &&OPFL


00041200SET ZPF = &&ZPF


00041300SET ZPFL = &&ZPFL


00041400IF &LOW = LOW THEN SET K = 1


00041500              ELSE SET K = 13


00041600IF &LOW = LOW THEN SET T = 12


00041700              ELSE SET T = 24


00041800IF &OFF = OFF THEN SET K = 1


00041900IF &OFF = OFF THEN SET T = 24


00042000GETMY PROG SYS ACCT TERMID SYSID ACFUID


00042100ISPEXEC VPUT (PROG SYS ACCT TERMID SYSID ACFUID) SHARED


00042200


00042300IF &MENU NE KEY THEN +


00042400  DO


00042500  IF &DATATYPE(&MENU) NE NUM THEN EXIT


00042600  SET K = &MENU


00042700  IF &K > 24 THEN EXIT


00042800  IF &K < 1 THEN EXIT


00042900  IF &K < 13 THEN SET P = &SUBSTR(2:3,&EVAL(100+&K))


00043000             ELSE SET P = &SUBSTR(2:3,&EVAL(100+&K-12))


00043100  SET KEY&P = &STR(&TSO %HOTKEY = MENU)


00043200  SET KEYL&P = MENU


00043300  GOTO SETIT


00043400  ENDO


00043500


00043600SET KEY01 = &STR(&TSO %HOTKEY = BROWSE)


00043700SET KEYL01 = BROWSE


00043800SET KEY02 = &STR(&TSO %HOTKEY = EDIT)


00043900SET KEYL02 = EDIT


00044000SET KEY03 =


00044100SET KEYL03 =


00044400IF &ACF2 = YES THEN +


00044500  DO


00044600  SET KEY03 = END


00044700  SET KEYL03 = END


00044800  IF &SUBSTR(1:8,&ACFUID) = &STR(155D2100) OR   +


00044900     &SUBSTR(1:8,&ACFUID) = &STR(155D2300) THEN +


00045000    DO


00045100    SET KEY03 =


00045200    SET KEYL03 =


00045300    ENDO


00045400  ENDO


00045500SET KEY04 = &STR(&TSO %HOTKEY = LIB)


00045600SET KEYL04 = LIB


00045700SET KEY05 = &STR(&TSO %HOTKEY = INFO)


00045800IF &FAXE = ON THEN +


00045900  SET KEY05 = &STR(&TSO %HOTKEY = INFO FILEAID(YES))


00046000SET KEYL05 = INFO


00046100SET KEY06 = &STR(&TSO %HOTKEY = PDS)


00046200SET KEYL06 = PDS ML


00046300SET KEY07 = &STR(&TSO %HOTKEY = FROM)


00046400SET KEYL07 = FROM


00046500SET KEY08 = &STR(&TSO %HOTKEY = MENU)


00046600SET KEYL08 = MENU


00046700SET KEY09 = &STR(&TSO %HOTKEY = ZAP)


00046800SET KEYL09 = ZAP


00046900IF &ACF2 = YES THEN +


00047000  DO


00047100  SET KEY09 =


00047200  SET KEYL09 =


00047300  IF &SUBSTR(1:8,&ACFUID) = &STR(155D2100) OR   +


00047400     &SUBSTR(1:8,&ACFUID) = &STR(155D2300) THEN +


00047500    DO


00047600    SET KEY09 = &STR(&TSO %HOTKEY = ZAP)


00047700    SET KEYL09 = ZAP


00047800    ENDO


00047900  ENDO


00048000SET KEY10 = &STR(&TSO %HOTKEY = FLIST)


00048100IF &FAXE = ON THEN +


00048200  SET KEY10 = &STR(&TSO %HOTKEY = FLIST FILEAID(YES))


00048300SET KEYL10 = FLIST


00048400SET KEY11 =


00048500SET KEYL11 =


00048600SET KEY12 =


00048700SET KEYL12 =


00049000SETIT: +


00050000IF &ON = ON THEN +


00060000  DO WHILE &K < &T +1


00070000    SET J = &SUBSTR(2:3,&EVAL(100+&K))


00080000    ISPEXEC VGET (ZPF&J ZPFL&J OPF&J OPFL&J) PROFILE


00090000    IF &STR(&OPF&J) = &Z THEN SET OPF&J = &STR(&ZPF&J)


00100000    IF &STR(&OPFL&J) = &Z THEN SET OPFL&J = &STR(&ZPFL&J)


00110000    SET ZPFL&J = NOSHOW


00120000    IF &K < 13 THEN SET P = &SUBSTR(2:3,&EVAL(100+&K))


00130000               ELSE SET P = &SUBSTR(2:3,&EVAL(100+&K-12))


00140000    IF &STR(&KEY&P) NE &Z THEN SET ZPF&J = &STR(&KEY&P)


00150000    IF &STR(&KEYL&P) NE &Z THEN SET ZPFL&J = &STR(&KEYL&P)


00151000    ISPEXEC VPUT (ZPF&J ZPFL&J OPF&J OPFL&J) PROFILE


00152000    IF &MENU NE KEY THEN EXIT


00153000    SET K = &K + 1


00154000  ENDO


00155000IF &OFF = OFF THEN +


00156000  DO WHILE &K < &T +1


00157000    SET J = &SUBSTR(2:3,&EVAL(100+&K))


00158000    ISPEXEC VGET (OPF&J OPFL&J) PROFILE


00159000    IF &STR(&OPF&J) NE &Z THEN +


00160000      DO


00170000      SET ZPF&J = &STR(&OPF&J)


00180000      SET ZPFL&J = &STR(&OPFL&J)


00190000      ISPEXEC VPUT (ZPF&J ZPFL&J) PROFILE


00200000      ENDO


00210000    IF &MENU NE KEY THEN EXIT


00220000    SET K = &K + 1


00230000  ENDO


00240000


00250000SET &KEY = &STR(&&TPFL)


00260000SET &ZKEY = &STR(&&ZPFL)


00270000SET &I = 1


00280000SET &FOUNDEM = NO


00290000DO WHILE &I <= 24 && &FOUNDEM = NO


00291000  SET &K = &SUBSTR(2:3,&EVAL(100+&I))


00292000  ISPEXEC VGET TPFL&K PROFILE


00293000  IF &KEY&K ¬= &Z THEN SET &FOUNDEM = YES


00294000  SET &I = &I + 1


00295000ENDO


00296000


00297000EXIT


00298000


00299000IF &SHOWSTAT = ON && &FOUNDEM = YES THEN +


00300000  DO


00310000    SET &I = 1


00320000    DO WHILE &I <= 24


00330000      SET &K = &SUBSTR(2:3,&EVAL(100+&I))


00340000      ISPEXEC VGET TPFL&K PROFILE


00350000      SET &ZPFL&K = &KEY&K


00360000      SET TPFL&K = &Z


00370000      ISPEXEC VPUT (ZPFL&K TPFL&K) PROFILE


00380000      SET &I = &I + 1


00390000    ENDO


00400000  ENDO


00410000ELSE +


00420000  DO


00430000    IF &SHOWSTAT = OFF && &FOUNDEM = NO THEN +


00440000      DO


00450000        SET &I = 1


00460000        DO WHILE &I <= 24


00470000          SET &K = &SUBSTR(2:3,&EVAL(100+&I))


00480000          ISPEXEC VGET (ZPFL&K) PROFILE


00490000          SET &TPFL&K = &ZKEY&K


00500000          SET &ZPFL&K = NOSHOW


00510000          ISPEXEC VPUT (ZPFL&K TPFL&K) PROFILE


00520000          SET I = &I + 1


00530000        ENDO


00540000      ENDO


00550000  ENDO


./ ADD NAME=IMD      0110-83307-85280-1434-00228-00184-00102-KK00150
00010007PROC 0 MSL(GDDM.MAPS) L NC ADS(GDDM.ADS) T K NLIB PRIVATE VPRE() +


00011010   SS(USER.TSO.GDDM.SYMBOLS)


00020000/* MSL    MAP SPECIFICATION LIBRARY                     */


00050000/* L      TURNS ON MSG LIST AND CONLIST                 */


00060000/* NC     EXITS BEFORE IMD CALL, ALLOWS TESTING         */


00080000/* T      USES TSO TEST TO CALL IMD OR IMPORT           */


00090000/* K      USES ALTERNATE IMD FROM WDPSC.TSO.TESTLIB     */


00100000/* NLIB   ALLOWS EXECUTION OF IMD WITHOUT LIBRARIES     */


00111000/* PRIVATE ALLOWS SHARING PREFIX BUT DIFFERENT LIBRARIES*/


00120000CONTROL NOFLUSH END(ENDO) NOMSG


00130000IF &L = L THEN CONTROL MSG LIST CONLIST


00130108IF &SYSPROC = TEST AND &SS EQ &STR(USER.TSO.GDDMR3.SYMBOLS) THEN +


00130210   SET &SS = &STR(USER.TSO.GDDM.SYMBOLS)


00131000IF &PRIVATE = PRIVATE AND &SYSPREF NE &SYSUID THEN DO


00132000  IF &MSL = GDDM.MAPS THEN SET &MSL = &SYSUID..GDDM.MAPS


00133000  IF &ADS = GDDM.ADS THEN SET &ADS = &SYSUID..GDDM.ADS


00134000                                                ENDO


00135007


00136007/*** ALLOCATE SYMBOL SETS IF NOT ALREADY ALLOCATED    ***/


00137007IFALC FILE(ADMSYMBL) DSN('&SS')


00138007IF &LASTCC NE 0 THEN DO


00139007                     IFALC FILE(ADMSYMBL)


00140007                     IF &LASTCC = 0 THEN FREE F(ADMSYMBL)


00150007                     ALLOC F(ADMSYMBL) DSN('&SS')


00160007                     ENDO


00170000


00202200/*** ALLOCATE PRINT FILE  IF NOT ALREADY ALLOCATED    ***/


00202300IFALC FILE(ADMLIST)


00202400IF &LASTCC NE 0 THEN DO


00202700                     ALLOC F(ADMLIST) SYSOUT(A)


00202800                     ENDO


00203000


00204000/*** ALLOCATE IMD PANELS  IF NOT ALREADY ALLOCATED    ***/


00205009IFALC FILE(ADMGIMP) DSN('WDPSC.GDDMR4.GDDMMAP')


00206000IF &LASTCC NE 0 THEN DO


00207000                     IFALC FILE(ADMGIMP)


00208000                     IF &LASTCC = 0 THEN FREE F(ADMGIMP)


00208109                     ALLOC FILE(ADMGIMP) DSN('WDPSC.GDDMR4.GDDMMAP')


00209100                     ENDO


00209200


00209300/*** ALLOCATE GEN MAPLIB  IF NOT ALREADY ALLOCATED    ***/


00209410IFALC FILE(ADMGGMAP) DSN('USER.TSO.GDDM.GENMAPS')


00209500IF &LASTCC NE 0 THEN DO


00209600                     IFALC FILE(ADMGGMAP)


00209700                     IF &LASTCC = 0 THEN FREE F(ADMGGMAP)


00209810                     ALLOC FI(ADMGGMAP) DSN('USER.TSO.GDDM.GENMAPS')


00210000                     ENDO


00211000


00220000/*** CHECK LIBRARIES FOR PRIOR ALLOCATION             ***/


00230000IF &NLIB EQ NLIB THEN GOTO CALLM              /* BYPASS LIB ALLOC   */


00231000


00240000  IFALC FILE(ADMGNADS) DA(&ADS)               /* CHECK: IF BOTH     */


00250000  IF &LASTCC = 0 THEN DO                      /*  LIBRARIES HAVE    */


00260000       IFALC FILE(ADMMSL1) DA(&MSL)           /*  ALREADY BEEN      */


00270000       IF &LASTCC =  0 THEN GOTO CALLM        /*  ALLOCATED,        */


00280000                      ENDO                    /*  BYPASS ALLOCATION */


00290000FREE F(ADMGNADS,ADMMSL1)


00300000


00310000DATASTAT &ADS                                 /* CHECK: DO REQUESTD */


00320002SET ADSF = &LASTCC                           /*  LIBRARIES ALREADY */


00321002                                              /*  EXIST?            */


00330002DATASTAT &MSL


00330102SET MSLF = &LASTCC


00330202IF &MSLF = 4 THEN DO


00330402    DATASTAT '&MSL'


00330502    IF &LASTCC = 2 THEN DO


00330602       SET &MSL = &STR('&MSL')


00330702       SET &MSLF = 2


00330902                        ENDO


00331002                  ENDO


00331102 IF &MSLF = 4 THEN DO


00331202     DATASTAT 'VSAMA.&SYSPREF..&MSL'


00331302    IF &LASTCC = 2 THEN DO


00331402       SET &MSL = &STR('VSAMA.&SYSPREF..&MSL')


00331502       SET &MSLF = 2


00331602                        ENDO


00331702                   ENDO


00331802 IF &MSLF = 4 THEN DO


00331902     DATASTAT 'VSAMT.&SYSPREF..&MSL'


00332002    IF &LASTCC = 2 THEN DO


00332102       SET &MSL = &STR('VSAMT.&SYSPREF..&MSL')


00332202       SET &MSLF = 2


00332302                        ENDO


00332402                   ENDO


00332502 IF &MSLF = 4 THEN DO


00332602     DATASTAT 'VSAMA.&MSL'


00333002    IF &LASTCC = 2 THEN DO


00334002       SET &MSL = &STR('VSAMA.&MSL')


00335002       SET &MSLF = 2


00336002                        ENDO


00337002                   ENDO


00338002 IF &MSLF = 4 THEN DO


00338102     DATASTAT 'VSAMT.&MSL'


00339102    IF &LASTCC = 2 THEN DO


00339202       SET &MSL = &STR('VSAMT.&MSL')


00339302       SET &MSLF = 2


00339402                        ENDO


00339502                   ENDO


00346002


00349802


00350001IF &MSLF = 2 AND &ADSF = 0 THEN GOTO NORMAL   /* IF OKAY FOR IMD    */


00360000                                              /*  USE, CALL IMD     */


00370000IF &ADSF NE 4 AND &ADSF NE 0 THEN DO


00380000      WRITE ERROR WITH ADS  LIBRARY: DATASTAT CODE &ADSF


00390000      WRITE PLEASE CONTACT YOUR IMD CONSULTANT FOR HELP.


00400000      EXIT                                    /* IF DATA LIB THERE, */


00410000                                ENDO          /*  BUT NOT OK, EXIT  */


00420001IF &MSLF NE 4 AND &MSLF NE 2 THEN DO


00430000      WRITE ERROR WITH MSL LIBRARY: DATASTAT CODE &MSLF


00440000      WRITE PLEASE CONTACT YOUR IMD CONSULTANT FOR HELP.


00450000      EXIT                                    /* IF FRMT LIB THERE, */


00460000                                ENDO          /*  BUT NOT OK, EXIT  */


00460100


00460200/*** DO EXTRA CHECKING FOR DSNS THE USER SPECIFIED:   ***/


00460400IF &ADSF = 4 AND &ADS NE GDDM.ADS +


00460500             AND &ADS NE &SYSUID..GDDM.ADS THEN +


00460600    DO


00460700    DATASTAT '&ADS'


00460800    IF &LASTCC = 0 THEN DO


00460900       SET &ADS = &STR('&ADS')


00461000       SET &ADSF = 0


00461100                        ENDO


00461200    ENDO


00462400


00462501IF &MSLF = 2 AND &ADSF = 0 THEN GOTO NORMAL   /* IF OKAY FOR IMD    */


00462600                                              /*  USE, CALL IMD     */


00470000KOMM CLEAR RESET


00480000


00490000/*** REQUEST VOLUME FOR LIBRARIES THAT DO NOT EXIST   ***/


00500000GVOLOOP: +


00510000IF &ADSF = 4 AND &MSLF = 4 THEN DO


00520000            WRITE ***  YOUR IMD LIBRARIES DO NOT EXIST.    ***


00530000            WRITE TO ALLOCATE THEM, ENTER ONE OF THE FOLLOWING:


00540000                              ENDO


00550000IF &ADSF = 0 AND &MSLF = 4 THEN DO


00560000            WRITE ***  YOUR MSL LIBRARY DOES NOT EXIST.  ***


00570000            WRITE TO ALLOCATE IT, ENTER ONE OF THE FOLLOWING:


00580000                              ENDO


00590001IF &ADSF = 4 AND &MSLF = 2 THEN DO


00600000            WRITE ***  YOUR ADS LIBRARY DOES NOT EXIST.  ***


00610000            WRITE TO ALLOCATE IT, ENTER ONE OF THE FOLLOWING:


00620000                              ENDO


00630000


00640000            WRITE    P - TO ALLOCATE AND KEEP INDEFINITELY.


00650000            WRITE    T - TO ALLOCATE AND KEEP FOR 3 DAYS.


00660000            WRITE YOU MAY ALSO ENTER A SPECIFIC ADS VOLUME IF YOU WISH.


00670000             READ VOLP


00680002             IF &VOLP = P THEN DO


00681006                               SET VOL = TSOVOL


00681106                               SET DEVTYP = SYSDA


00682002                               SET VOLV = 335043


00683002                               SET VPRE = VSAMA


00683102                               SET VCAT = USERCAT8


00683206                               GOTO NORMAL


00684002                               ENDO


00690000                          ELSE +


00700002             IF &VOLP = T THEN DO


00701002                               SET VOL = 335112


00701102                               SET VOLV = 338019


00701202                               SET VPRE = VSAMT


00701302                               SET VCAT = USERCATT


00702002                               ENDO


00712002                          ELSE DO


00713002                               SET VOL = &VOLP


00714002                               SET VOLV = 335043


00718102                               SET VPRE = VSAMA


00718202                               SET VCAT = USERCAT8


00718302                               ENDO


00720000      DEVTYPE VOL(&VOL)


00730000      IF &LASTCC NE 0 THEN DO


00740000              WRITE '&VOLP' IS AN INVALID RESPONSE - PLEASE TRY AGAIN.


00750000              WRITE


00760000              GOTO GVOLOOP


00770000                           ENDO


00780000


00790000/*** ALLOCATE LIBRARIES THAT DO NOT EXIST             ***/


00800000NORMAL: +


00801000FREE  ATTR(ADMAT)


00802000ATTR ADMAT RECFM(F,B) LRECL(80) BLK(3120)


00810000IF &ADSF = 4 THEN DO


00820000      ALLOC F(ADMGNADS) DA(&ADS) SP(3,3) TRACKS BLKSIZE(400) +


00830000            DIR(10) UNIT(&DEVTYP) VOL(&VOL) USING(ADMAT)


00831002      SET ARC = &LASTCC


00840002      IF &ARC    = 0 THEN +


00850000                   WRITE DATA LIBRARY &SYSPREF..&ADS HAS BEEN ALLOCATED.


00860000                     ELSE DO


00870002                          WRITE ERROR CODE &ARC OCCURED


00880000                          WRITE IN ALLOCATION OF &SYSPREF..&ADS


00890000                          WRITE PLEASE CONTACT YOUR IMD CONSULTANT.


00900000                          EXIT


00910000                          ENDO


00920000                 ENDO


00930000             ELSE ALLOC F(ADMGNADS) DA(&ADS)


00940000IF &MSLF = 4 THEN DO


00940102      IF &SUBSTR(1,&STR(&MSL)) NE &STR(') THEN +


00941002                SET &MSL = '&VPRE..&SYSPREF..&MSL'


00950002      DEFINE CLUSTER (NAME(&MSL) +


00960000                      VOL(&VOLV) SHR(3 3) RECSZ(256 256) +


00961000                      CISZ(2048) KEYS(21 0)) +


00962002             DATA (RECORDS(400 400)) CAT('SYS1.&VCAT')


00963002      SET DRC = &LASTCC


00970002      IF &DRC    = 0 THEN +


00980002                WRITE MSL LIBRARY &MSL HAS BEEN ALLOCATED.


00990000                     ELSE DO


01000002                          WRITE ERROR CODE &DRC OCCURED


01010002                          WRITE IN ALLOCATION OF &MSL


01020000                          WRITE PLEASE CONTACT YOUR IMD CONSULTANT.


01030000                          EXIT


01040000                          ENDO


01050000                 ENDO


01060002


01060102ALLOC F(ADMMSL1) DSN(&MSL)


01062002


01070000IF &MSLF = 4 OR &ADSF = 4 THEN CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '2'


01080000


01100000CALLM: +


01110005CONTROL MSG


01110200


01420000NOIMPORT: IF &NC EQ NC THEN EXIT


01430000


01440000/*** CALL IMD                                         ***/


01441008IF &K = K OR &SYSPROC = TEST THEN DO


01442107 IF &T = T THEN TEST 'WDPSC.GDDMR4.GDDMLOAD(ADMIMD)' 'ADMMSL1'


01443007           ELSE CALL 'WDPSC.GDDMR4.GDDMLOAD(ADMIMD)' 'ADMMSL1'


01444000                EXIT


01445000               ENDO


01470005IF &T = T THEN TEST 'WDPSC.GDDM.GDDMLOAD(ADMIMD)'    'ADMMSL1'


01480005          ELSE CALL 'WDPSC.GDDM.GDDMLOAD(ADMIMD)'    'ADMMSL1'


./ ADD NAME=ISSE     0104-85206-85280-1433-00038-00036-00004-KK00150
00700004PROC 0 SS(USER.TSO.GDDM.SYMBOLS) L NC VOL(NONE) SSN(ADMCOLSD) F


00710000CONTROL NOFLUSH END(ENDO) NOMSG


00720000IF &L = L THEN CONTROL MSG LIST CONLIST


00721002IF &SYSPROC = TEST AND &SS EQ &STR(USER.TSO.GDDMR3.SYMBOLS) THEN +


00722004   SET &SS = &STR(USER.TSO.GDDM.SYMBOLS)


00730000IF &F = F THEN FREE F(ADMSYMBL)


00740000IFALC F(ADMSYMBL) DA(&SS)


00750000IF &LASTCC = 0 THEN GOTO CALLM


00760000IFALC F(ADMSYMBL) DA('&SS')


00770000IF &LASTCC = 0 THEN GOTO CALLM


00780000IFALC F(ADMSYMBL)


00790000IF &LASTCC = 0 THEN FREE F(ADMSYMBL)


00800000DATASTAT &SS


00810000IF &LASTCC NE 0 THEN DO


00820000       DATASTAT '&SS'


00830000       SET DRC = &LASTCC


00840000       IF &DRC    NE 0 THEN DO


00850000          WRITE DATASTAT RC IS &DRC


00860000          WRITE SYMBOL SET LIBRARY CANNOT BE ALLOCATED : &SS


00870000          WRITE PLEASE CHECK YOUR SS NAME.


00880000          EXIT


00890000                            ENDO


00900000       SET &SS = &STR('&SS')


00910000                     ENDO


00920000ALLOC F(ADMSYMBL) DA(&SS)


00930000       SET ARC = &LASTCC


00940000       IF &ARC    NE 0 THEN DO


00950000          WRITE ALLOC RC IS &ARC


00960000          WRITE SYMBOL SET LIBRARY CANNOT BE ALLOCATED :


00970000          WRITE PLEASE CHECK YOUR SS NAME.


00980000          EXIT


00990000                            ENDO


01000000CALLM: +


01030000  IF &NC = NC THEN EXIT


01050002  IF &SYSPROC = TEST THEN +


01060000               CALL 'WDPSC.GDDMR4.GDDMLOAD(ADMISSE)' '&SSN'


01070000                     ELSE +


01080000               CALL 'WDPSC.GDDM.GDDMLOAD(ADMISSE)' '&SSN'


./ ADD NAME=LASTLINK 0110-82127-85317-1402-00193-00187-00000-JS02150
                   PROC 0 VOL() CON


                   IF &CON = CON THEN CONTROL LIST CONLIST


                   CLERSCRN


                   CONTROL NOMSG NOFLUSH END(ENDO)





                   SET &ZEEVOL =


                   IF &VOL NE  THEN DO


                       SET &ZEEVOL = &STR(VOL(&VOL))


                       ENDO





        ERR1:   ERROR DO


                    WRITE


                    WRITE ***********************************


                    WRITE *  INVALID SYNTAX OF DATASET NAME *


                    WRITE ***********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO GETDSN


                    ENDO





        GETDSN: WRITE


                WRITE ENTER DATASET NAME OF LOAD MODULE LIBRARY


                WRITE   (UNQUOTED DATASET WILL HAVE PREFIX APPENDED)


                WRITE


                WRITENR ENTER DSN HERE ==>


                READ


                SET &DSN = &STR(&SYSDVAL)





                CLERSCRN





        ERR2:   ERROR DO


                    WRITE


                    WRITE **********************************


                    WRITE *  INVALID SYNTAX OF MEMBER NAME *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO GETMEM


                    ENDO





        GETMEM: WRITE


                WRITENR ENTER MEMBER NAME ===>


                READ &MEMNAME





        FINFO:  ERROR OFF


                FILEINFO DSN(&STR(&DSN)) &ZEEVOL MEM(&STR(&MEMNAME))


                SET &MYCC = &LASTCC





                IF &MYCC EQ 96 THEN DO


                    WRITE


                    WRITE ***********************************


                    WRITE *  INVALID SYNTAX OF DATASET NAME *


                    WRITE ***********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO ERR1


                    ENDO





                IF &MYCC EQ 48 THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE *  INVALID SYNTAX OF MEMBER NAME *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO ERR2


                    ENDO





                IF &MYCC = 28 THEN GOTO ALLOCIT





                IF &MYCC = 24 THEN DO


                    WRITE


                    WRITE *****************************


                    WRITE *   MEMBER NAME NOT FOUND   *


                    WRITE *****************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO ERR2


                    ENDO





                IF &MYCC NE 0 THEN DO


                    WRITE


                    WRITE ******************************


                    WRITE &OUTMSG


                    WRITE ******************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO ERR1


                    ENDO





                IF &DSORG NE PO THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE *   LOAD MODULE LIBRARY MUST BE  *


                    WRITE *   A PARTITIONED DATASET        *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO ERR1


                    ENDO





                IF &RECFM NE U THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE *   LOAD MODULE LIBRARY MUST     *


                    WRITE *   HAVE RECFM=U                 *


                    WRITE *                                *


                    WRITE *   THIS DATASET MUST NOT BE     *


                    WRITE *   A LOAD MODULE LIBRARY        *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO ERR1


                    ENDO





                   SET &LODLIB = &FULLDSN


                   GOTO DOIT





        ALLOCIT: DEVTYPE VOL(&VOL)


                 IF &LASTCC NE 0 THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE &OUTMSG


                    WRITE **********************************


                    EXIT


                    ENDO





                 FREE F(FINDMEDD)


                 ALLOC F(FINDMEDD) DA('&FULLDSN') SHR -


                 VOL(&VOL) UNIT(&DEVTYP)


                 IF &LASTCC NE 0 THEN DO


                    WRITE


                    WRITE ***************************************


                    WRITE UNSUCCESSFUL ALLOCATION OF LOAD LIBRARY


                    WRITE ***************************************


                    EXIT


                    ENDO





                 GOTO FINFO





        DOIT:      FREE F(SYSIN)


                   ALLOC F(SYSIN) NEW SPACE(1,1) BLK(80)


                   OPENFILE SYSIN OUTPUT


                   SET &SYSIN = &STR( LISTIDR MEMBER=&MEMNAME)


                   PUTFILE SYSIN


                   CLOSFILE SYSIN


                   FREE F(SYSPRINT SYSLIB)


                   ERROR DO


                        CONTROL MSG


                        ALLOC F(SYSPRINT) DSN('&SYSUID..LASTLINK.SYSPRINT') -


                        NEW SPACE(1,1) TRACKS UNIT(SYSDA)


                        CONTROL NOMSG


                        ERROR OFF


                        GOTO CONT1


                        ENDO


                   ALLOC F(SYSPRINT) DA('&SYSUID..LASTLINK.SYSPRINT') SHR


                   ERROR OFF


        CONT1:     CONTROL MSG


                   DEVTYPE VOL(&VOLSER)


                   IF &LASTCC NE 0 THEN DO


                      WRITE


                      WRITE **********************************


                      WRITE &OUTMSG


                      WRITE **********************************


                      EXIT


                      ENDO





                   SET &VOLPAR = &STR(VOL(&VOLSER))


                   SET &UNIT = &STR(UNIT(&DEVTYP))


                   ALLOC F(SYSLIB) DA('&LODLIB') SHR &VOLPAR &UNIT


                   CONTROL NOMSG


                   CLERSCRN


                   WRITE


                   CALL 'SYS1.LINKLIB(AMBLIST)'


                   FREE F(SYSIN SYSPRINT SYSLIB)


                   FREE F(SYS260A,SYS260J)


                   FREE ATTRLIST(SYSJATTR)


                   ATTR SYSJATTR RECFM(F) LRECL(80) BLKSIZE(80)


                   CONTROL MSG


                   ALLOC F(SYS260A) DA('&SYSUID..LASTLINK.SYSPRINT') SHR


                   ALLOC F(SYS260J) DSN(*) USING(SYSJATTR)


                   ALLOC F(SYSPRINT) DUMMY


                   ALLOC F(SYSIN) DA('WDPSC.MASTER.CLIST.PARMS(LLINKDYL)') SHR


                   CALL 'WDPSC.SYSLIBRY(DYL260)'


                   CONTROL NOMSG


                   FREE F(SYSIN SYSPRINT)


                   ALLOC F(SYSIN) DSN(*)


                   ALLOC F(SYSPRINT) DSN(*)


           /*  THE FOLLOWING 3 STATEMENTS WERE ADDED IN ORDER   */


           /*  TO FIX PROBLEM EXPERIENCED ONLY BY 3290S         */


                   WRITE


                   WRITE PRESS ENTER TO EXIT THIS CLIST


                   READ


./ ADD NAME=LASTOPEN 0101-85021-85113-1611-00070-00073-00000-JS02150
                CLERSCRN





                CONTROL NOMSG NOFLUSH END(ENDO)





                ATTN DO


                    END


                    RETURN


                    ENDO





        D1T1:   ERROR DO


                    WRITE


                    WRITE *******************************


                    WRITE *  INVALID SYNTAX OF DSNAME   *


                    WRITE *******************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO D1T2


                    ENDO





        D1T2:   WRITE


                WRITE ENTER DATASET NAME &STR(           (OR ENTER 'QUIT' TO EXI
T))

                WRITE    UNQUOTED DATASET WILL HAVE PREFIX APPENDED:


                READ


                SET &DSN = &STR(&SYSDVAL)





                IF &DSN = QUIT THEN EXIT





                ERROR OFF





                FILEINFO DSN(&STR(&DSN))


                SET &FILECC = &LASTCC





                IF &FILECC EQ 96 THEN DO


                    WRITE


                    WRITE *******************************


                    WRITE *  INVALID SYNTAX OF DSNAME   *


                    WRITE *******************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO D1T1


                    ENDO





                IF &FILECC NE 0 THEN DO


                    WRITE


                    WRITE *******************************


                    WRITE &OUTMSG


                    WRITE *******************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO D1T1


                    ENDO





                IF &DSORG NE PO THEN GOTO DOIT





                IF &MEMCNTL EQ YES THEN DO


                    WRITE


                    WRITE *********************************


                    WRITE *   DO NOT PROVIDE MEMBER NAME  *


                    WRITE *********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    CLERSCRN


                    GOTO D1T1


                    ENDO





        DOIT:   WRITE


                SET &FULLDSN = &STR(&FULLDSN&SUBSTR(1:44-&LENGTH(&FULLDSN),
                                       )

                FREE F(OUTPUT)


                CONTROL MSG


                ALLOC F(OUTPUT) DSN(*) NEW


                CALL 'WDPSC.SHARED.LOAD(GETDSCB1)' '999999,&STR(&FULLDSN)'


./ ADD NAME=LPQ      0101-85211-85279-1533-00018-00018-00003-KX00150
00010001PROC 0 A Q T D R3 Q81 Q33 DSN('''ADMPRINT.REQUEST.QUEUE''') R4


00050200IF &Q81 = Q81 THEN SET DSN = &STR('USER.TSO.GDDMR3.QUEUE81')


00050300IF &Q33 = Q33 THEN SET DSN = &STR('USER.TSO.GDDMR3.QUEUE33')


00050401IF &R3 = R3 THEN SET DSN = &STR('USER.TSO.GDDMR3.PRINTQ')


00050501IF &R4 = R4 THEN SET DSN = &STR('USER.TSO.GDDMR4.PRINTQ')


00050600IF &T = T THEN SET DSN = &STR('SOFTD150.DSPRINT.QUEUE')


00050700IF &A = A THEN SET DSN = &STR('USER.TSO.DSPRINT.ALTQUEUE')


00050800IF &Q = Q THEN SET DSN = &STR('USER.TSO.DSPRINT.QUEUE')


00050900IF &D = D THEN SET DSN = &STR('DSPRINT.REQUEST.QUEUE')


00051000WRITE STATUS REPORT FOR PRINT QUEUE &DSN


00051100CONTROL NOMSG


00052000IFALC F(DRQ) DSN(&DSN)


00053000IF &LASTCC = 0 THEN GOTO CALLLPQ


00060000FREE F(DRQ,DRQATT)


00061000CONTROL MSG


00062000ATTR DRQATT BUFNO(10)


00070000ALLOC FI(DRQ)  DA(&DSN)   SHR  US(DRQATT)


00080000CALLLPQ: CALL 'WDPSC.SYSLIBRY(LPRTQ)'


./ ADD NAME=NEWSPF   0125-83272-86339-1303-00089-00149-00026-LL02150
00010004PROC 0 L PROFDSN(NONE) F MYCMD T NC TABL SETUP CLEANUP


00020000CONTROL MAIN END(ENDO)


00030000IF &L = L THEN CONTROL LIST MSG CONLIST


00030120IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


00031000


00031105IF &CLEANUP = CLEANUP THEN GOTO MRCLEAN


00032003


00081100/*************************************************************/


00081200/*  IF THE USER WANTS TO ENTER A DIFFERENT COMMAND STRING... */


00081300/*************************************************************/


00081400IF &MYCMD = MYCMD THEN DO


00081500        WRITE ENTER ISPF INVOCATION COMMAND:


00081600        READ


00081700                       ENDO


00081800                  ELSE +


00081900        SET &SYSDVAL = PDF


00082000


00083000/*************************************************************/


00090000/*  IF ISPPROF IS ALREADY ALLOCATED, ASSUME CONVERSION DONE: */


00090100/*************************************************************/


00100000IFALC F(ISPPROF)


00110000IF &LASTCC = 0 THEN GOTO CHEKLIBS


00111000


00112000/*************************************************************/


00120000/*  IF ISPPROF LIB EXISTS, ASSUME CONVERSION DONE:           */


00120100/*************************************************************/


00121000IF &PROFDSN = NONE THEN +


00122019     IF &SYSUID = &SYSPREF OR &SYSPREF = &STR() +


00122119                           THEN SET &PROFDSN = &SYSUID..ISPF.ISPPROF


00123000                           ELSE SET &PROFDSN = &SYSPREF..&SYSUID..ISPF.I
SPPROF

00124000CONTROL NOMSG


00130000ALLOC DDN(ISPPROF) DSN('&PROFDSN')


00140000IF &LASTCC = 0 THEN GOTO CHEKLIBS


00141000


00141100/*************************************************************/


00142000/* USER PROFILE LIB DOES NOT EXIST; WE MUST BUILD IT:        */


00143000/*************************************************************/


00144000FREE ATTR(KKISPRO)


00145000CONTROL MSG


00150000ATTR KKISPRO RECFM(F B) LRECL(80) BLKSIZE(3120)


00160000ALLOC DDN(ISPPROF) DSN('&PROFDSN') NEW CATALOG TRACK SP(1 1) DIR(2) +


00170021      USING(KKISPRO) UNIT(3380) VOL(SYS028)


00171000IF &LASTCC NE 0 THEN DO


00172000      WRITE ERROR ALLOCATING PROFILE DATASET (USER PARMS)


00172112      WRITE PLEASE CONTACT WDPSC CUSTOMER TECHNICAL SUPPORT AT 3-4170


00172218      ALLOC DDN(ISPPROF) DUMMY


00173000      EXIT


00180000                     ENDO


00181000


00182000/*************************************************************/


00190000/* NEW PROFILE LIB ALLOCATED, NOW TRY TO CONVERT OLD PARMS:  */


00190112/* 02/09/84 - SPFMVS GONE, NO CONVERSION ALLOWED NOW.......  */


00191000/*************************************************************/


00370000


00371000/*************************************************************/


00380000/* NOW WE CHECK IF ISPF LIBS ARE PRESENT:                    */


00381000/*************************************************************/


00400100CHEKLIBS: CONTROL MSG


00414112/*               ALLOCATE ANY NEW LIBS THAT AREN'T THERE:  ***/


00440023SPFCONC DDN(ISPPLIB) DSN('WDPSC.ISP.V2R2.ISPPLIB')


00460023SPFCONC DDN(ISPSLIB) DSN('WDPSC.ISP.V2R2.ISPSLIB')


00480023SPFCONC DDN(ISPMLIB) DSN('WDPSC.ISP.V2R2.ISPMLIB')


00490023SPFCONC DDN(ISPTLIB) DSN('WDPSC.ISP.V2R2.ISPTLIB')


00520100/*                                                           */


00520200/*  THEN ALLOCATE TEST LIBRARIES IF REQUESTED:             ***/


00521000IF &T = T THEN DO


00521322  SPFCONC DDN(ISPPLIB) DSN('WDPSC.ISP.LOCAL.ISPPLIB')


00521422  SPFCONC DDN(ISPSLIB) DSN('WDPSC.ISP.LOCAL.ISPSLIB')


00521522  SPFCONC DDN(ISPMLIB) DSN('WDPSC.ISP.LOCAL.ISPMLIB')


00521622  SPFCONC DDN(ISPTLIB) DSN('WDPSC.ISP.LOCAL.ISPTLIB')


00521700  IF &TABL = TABL THEN +


00521822  SPFCONC DDN(ISPTABL) DSN('WDPSC.ISP.LOCAL.ISPTLIB')


00521900               ENDO


00522000


00523000/*************************************************************/


00530107/*  THEN WE CAN ISSUE THE ISPF/PDF COMMAND IF NEEDED:        */


00530200/*************************************************************/


00531000NEWSPF: +


00535100     IF &SETUP = SETUP THEN EXIT


00535507     IF &NC = NC THEN GOTO MRCLEAN


00535600     STACK T(ISPLLIB)


00535700     &SYSDVAL


00536100


00552000/*************************************************************/


00553007/* THIS SECTION IS USED WHILE SPFMVS IS PRODUCTION VERSION.  */


00553107/* PUT THE OLD SPF LIBS BACK IN PLACE NOW:                   */


00554000/*************************************************************/


00555005MRCLEAN: +


00555209EXIT    /* PDF IS NOW PRODUCTION VERSION  */


./ ADD NAME=PASTE    0116-86252-86303-1641-00134-00028-00000-GS00150
        /*CLIST****************************************************************/


        /*   ISPF/PDF EDIT MACRO TO WRITE LINES FROM THE USER PROFILE POOL    */


        /*   INTO THE CURRENT FILE.  THIS MACRO IS USED IN CONJUNCTION WITH   */


        /*   THE CUT MACRO.                                                   */


        /*                                                                    */


        /*   A TUTORIAL IS AVAILABLE BY PRESSING THE PF(1) KEY                */


        /**********************************************************************/


        ISREDIT MACRO (PARM1) NOPROCESS


        CONTROL NOFLUSH NOMSG


        /*CONTROL LIST CONLIST SYMLIST


        SET MSGFLAG = KEEP


        SET OFLAG = OK





        /* CHECK FOR INVALID PARAMETERS                                       */


        IF &PARM1 ¬= &STR( ) AND &PARM1 ¬= &STR(K) AND +


           &PARM1 ¬= &STR(KEEP) THEN +


          DO


            /* AN INVALID PASTE PARAMETER HAS BEEN PASSED                     */


            SET ZERRSM = &STR(INVALID PARAMETER!!!)


            SET MSG1 = &STR(USE PARAMETER "K" OR "KEEP" )


            SET MSG2 = &STR(TO PREVENT VARIABLE DELETION...)


            SET ZERRLM = &STR(&MSG1&MSG2)


            SET ZERRALRM = YES


            SET ZERRHM = PASTEHLP


            ISPEXEC SETMSG MSG(ISRZ002)


            EXIT CODE(12)


          END





        /* PROCESS LINE COMMANDS, CHECK IF A OR B WAS SPECIFIED               */


        ISREDIT PROCESS DEST


        SET RC = &LASTCC


        IF &RC >= 16 THEN +


          EXIT CODE(12)


        ELSE IF &RC >= 4 THEN +


          DO


            SET ZERRSM = &STR(MISSING LINE COMMAND!!!)


            SET MSG1 = &STR(PASTE REQUIRES USER TO ISSUE A )


            SET MSG2 = &STR(LINE COMMAND OF EITHER "A" OR "B"...)


            SET ZERRLM = &STR(&MSG1&MSG2)


            SET ZERRALRM = YES


            SET ZERRHM = PASTEHLP


            ISPEXEC SETMSG MSG(ISRZ002)


            EXIT CODE(12)


          END





        /* GET LINE COMMAND AND NUMBER OF LINES TO PASTE                      */


        ISREDIT (PASTEPT) = LINENUM .ZDEST


        ISPEXEC VGET (LINESCUT) PROFILE


        SET CUT = &LINESCUT





        /* CHECK THAT THERE ARE LINES TO BE PASTED                            */


        IF &LINESCUT = 0 THEN +


          DO


            SET ZEDSMSG = &STR(NO LINES TO PASTE!!!)


            SET MSG1 = &STR(LINES MUST FIRST BE CUT IN ORDER TO )


            SET MSG2 = &STR(BE PASTED BY THE PASTE COMMAND...)


            SET ZEDLMSG = &STR(&MSG1&MSG2)


            ISPEXEC SETMSG MSG(ISRZ000)


            EXIT CODE(0)


          END





        /* CHECK FOR TRUNCATION OF DATA                                       */


        ISREDIT (PSTLRECL) = DATA_WIDTH


        ISPEXEC VGET (CUTLRECL) PROFILE


        SET CTLRECL = &CUTLRECL


        IF &CUTLRECL > &PSTLRECL THEN +


          SET OFLAG = OVERFLOW





        /* PASTE LINES FROM PROFILE AFTER SELECTED POINT                  */


        SET LN = 1


        DO WHILE &LN <= &LINESCUT


          ISPEXEC VGET (CUTLN&LN) PROFILE


          ISREDIT LINE_AFTER &PASTEPT = DATALINE (CUTLN&LN)


          SET LN = &LN+1


          SET PASTEPT = &PASTEPT+1


        END





        /* DELETE LINES FROM PROFILE IF KEEP NOT SPECIFIED                    */


        IF &PARM1 ¬= &STR(K) AND &PARM1 ¬= &STR(KEEP) THEN +


          DO


            SET LN = 1


            DO WHILE &LN <= &LINESCUT


              SET CUTLN&LN = &STR()


              ISPEXEC VPUT (CUTLN&LN) PROFILE


              SET LN = &LN+1


            END


            SET MSGFLAG = DELETE


            SET LINESCUT = 0


            SET CUTLRECL = 0


            ISPEXEC VPUT (LINESCUT) PROFILE


            ISPEXEC VPUT (CUTLRECL) PROFILE


          END





        /* IF TRUNCATION OF DATA, DISPLAY MESSAGE                             /*


        IF &OFLAG = OVERFLOW THEN +


          DO


            SET TRNC = &CTLRECL-&PSTLRECL


            SET ZERRSM = &STR(TRUNCATION OCCURED!!!)


            SET MSG1 = &STR(LRECL OF LINES CUT IS &CTLRECL, FILE LRECL )


            SET MSG2 = &STR(ONLY &PSTLRECL - &TRNC COLUMNS TRUNCATED... )


            SET ZERRLM = &STR(&MSG1&MSG2)


            SET ZERRALRM = YES


            SET ZERRHM = PASTEHLP


            ISPEXEC SETMSG MSG(ISRZ002)


            EXIT CODE(0)


          END





        /* DISPLAY APPROPRIATE PASTE COMPLETION MESSAGE                       /*


        IF &MSGFLAG = KEEP THEN +


          DO


            SET ZEDSMSG = &STR(&CUT LINES PASTED && KEPT)


            SET MSG1 = &STR(A TOTAL OF &CUT LINES WERE )


            SET MSG2 = &STR(PASTED, THEY REMAIN IN PROFILE...)


            SET ZEDLMSG = &STR(&MSG1&MSG2)


          END


        ELSE +


          DO


            SET ZEDSMSG = &STR(&CUT PASTED && DELETED)


            SET MSG1 = &STR(A TOTAL OF &CUT LINES WERE )


            SET MSG2 = &STR(PASTED AND DELETED FROM PROFILE...)


            SET ZEDLMSG = &STR(&MSG1&MSG2)


          END


        ISPEXEC SETMSG MSG(ISRZ000)





        /* IF TRUNCATION OF DATA, DISPLAY MESSAGE                             /*


        IF &OFLAG = OVERFLOW THEN +


          DO


            SET TRNC = &CTLRECL-&PSTLRECL


            SET ZERRSM = &STR(TRUNCATION OCCURED!!!)


            SET MSG1 = &STR(LRECL OF LINES CUT IS &CTLRECL, FILE LRECL )


            SET MSG2 = &STR(ONLY &PSTLRECL - &TRNC COLUMNS TRUNCATED... )


            SET ZERRLM = &STR(&MSG1&MSG2)


          END


        EXIT


./ ADD NAME=POSTDIAL 0132-83245-86094-1820-00018-00001-00018-KK00150
00010016    PROC 0


00020016    CONTROL NOFLUSH END(ENDO)


00031029      ISPEXEC VGET (POXC PCMD PDXF)


00031129      /* NOTE PCMD IS NEVER XL IN POSTDIAL, USE PDXF TO CHECK XL */


00032006      IF &POXC = &STR(A03) THEN EXIT


00040032      ISPEXEC SELECT PGM(NEWMWILE) PARM(2) /* */


00041021      IF &SYSPREF NE KK00150 THEN EXIT


00050030      IF &SYSPROC = SPFSMPR1 THEN DO


00060030         IF &PDXF = &STR(ZL) OR &PDXF = &STR(XL) THEN +


00070009         ISPEXEC SELECT PGM(WDPSCXS) PARM(SMOFF)


00071017         ENDO


00080029      IF &PDXF = &STR(XL) THEN +


00080124         SET ZSETFDSP = J


00120021                          ELSE +


00125024         SET ZSETFDSP = K


00125330      IF &PDXF = &STR(ZL) THEN EXIT


00125430      IF &PCMD = &STR(Z)  THEN EXIT


00126024     ISPEXEC VPUT (ZSETFDSP) SHARED


./ ADD NAME=PREDIAL  0106-83245-86094-1819-00001-00001-00001-KK00150
00040002ISPEXEC SELECT PGM(NEWMWILE) PARM(1)


./ ADD NAME=SHOWFLOW 0101-86141-86161-1759-00033-00033-00000-KK00150
        ISREDIT MACRO


        /*********************************************************************/


        /*  THIS ISPF/PDF EDIT MACRO EXCLUDES ALL LINES IN THE DATA SET AND  */


        /*  THEN FINDS ALL FLOW OF CONTROL WORDS FOR A PL/I PROGRAM.         */


        /*                                                                   */


        /*  TO RUN:                                                          */


        /*     ENTER SHOWFLOW ON THE COMMAND LINE                            */


        /*********************************************************************/





        /* SAVE USER STATE SO THAT LAST FIND STRING WILL NOT BE AFFECTED     */


        ISREDIT (USTATE) = USER_STATE





        /* EXCLUDE ALL LINES */


        ISREDIT EXCLUDE ALL





        /* FIND CONTROL WORDS */


        ISREDIT FIND ALL WORD PROCEDURE


        ISREDIT FIND ALL WORD PROC


        ISREDIT FIND ALL WORD CALL


        ISREDIT FIND ALL WORD DO


        ISREDIT FIND ALL WORD END


        ISREDIT FIND ALL WORD ENDO


        ISREDIT FIND ALL WORD IF


        ISREDIT FIND ALL WORD THEN


        ISREDIT FIND ALL WORD ELSE


        ISREDIT FIND ALL WORD SELECT


        ISREDIT FIND ALL WORD WHEN


        ISREDIT FIND ALL WORD OTHERWISE





        /* RESET USER STATE */


        ISREDIT USER_STATE = (USTATE)





        EXIT


./ ADD NAME=SPFBATU  0100-83318-83318-1449-00148-00148-00000-KK00150
00010000PROC 0 FI(NONE) L SF(Y)


00020000CONTROL NOFLUSH   MSG END(ENDO)


00030000IF &L = L THEN CONTROL MSG LIST CONLIST  /* */


00040000GLOBAL GCRC GCVOL GCDEVT


00050000GLOBAL EMSG


00060000ERROR DO


00070000      %ERRORMSG &LASTCC


00080000      GOTO MAINLOOP


00090000      ENDO


00100000/* */


00110000/*   INITIALIZE VARIABLES FIRST:                         */


00120000/* */


00130000SET EMSG = &STR()


00131000SET OPT = &STR()


00140000SET &CDCUR = MEMBER


00150000ISPEXEC VGET (PRJ0 LIB0 TYP0 DSN) PROFILE


00160000/* */


00170000/*   DISPLAY OPTION/DATA PANEL:                         */


00180000/* */


00190000MAINLOOP: GOTO DISPLAY


00200000DISPLAY: ERROR OFF


00210000CONTROL MSG NOLIST NOCONLIST


00220000ISPEXEC DISPLAY PANEL(SPFBATU) CURSOR(&CDCUR)


00230000   SET DRC = &LASTCC


00231000IF &L = L THEN CONTROL MSG LIST CONLIST  /* */


00240000   IF &DRC NE 0 THEN DO


00250000         IF &FI NE NONE THEN %CMDOUT FREE(&FI)


00260000         ISPEXEC VPUT (PRJ0 LIB0 TYP0 DSN) PROFILE


00261000         FREE F(SYSIN)


00262000         ALLOC F(SYSIN) DA(*)


00270000         EXIT


00280000                     ENDO


00290000SET EMSG = &STR()


00291000IF &OPT = U THEN GOTO OPTVER


00300000IF &FI = NONE THEN DO


00310000              CONTROL NOMSG


00320000              FREE ATTR(KKKASBU)


00330000              ATTR KKKASBU RECFM(F,B) LRECL(121) BLK(1210)


00340000              CONTROL MSG


00350000              %CMDOUT DDN(SYSPRINT) USE(KKKASBU) FORCE &L


00360000              SET &FI = &LASTCC


00370000              IF &FI = 99 THEN DO


00380000                  SET FI = NONE


00390000                  SET EMSG = ERROR ALLOCATING CMD FILE


00400000                  GOTO MAINLOOP


00410000                               ENDO


00420000              OPENFILE SYSPRINT OUTPUT


00430000              CLOSFILE SYSPRINT


00440000              SET SVOL = &VOL


00450000              WHATDSN DDN(SYSPRINT)


00460000              SET VOL = &SVOL


00470000                   ENDO


00480000GOTO OPTVER     /* VERIFY PARMS ENTERED   */


00490000


00500000OPTSEL:GOTO OPT&OPT


00511000


00520000ENDOPT: +


00530000CALL 'WDPSC.CMDLIB(CLRSPFIO)'


00540000ISPEXEC EDIT DATASET('&DSNAME.')


00550000OPENFILE SYSPRINT OUTPUT


00560000CLOSFILE SYSPRINT


00561000SET CDCUR = MEMBER


00570000GOTO MAINLOOP


00580000


00590000/*   OPTVER VERIFICATION SUBROUTINE:   */


00600000


00610000OPTVER: +


00610100 IF &OPT NE Z AND &OPT NE U AND &MEMBER = THEN DO


00610200     SET CDCUR = MEMBER


00610300     SET EMSG = ENTER MEMBER NAME


00610400     GOTO MAINLOOP


00610500                                 ENDO


00610600 IF &DSN = THEN SET &LIB = '&PRJ0..&LIB0..&TYP0'


00610700           ELSE SET &LIB = &DSN


00610800 SET &VO =


00610900 SET &MO =


00611000 IF &VOL NE &STR() THEN SET VO = VOL(&VOL)


00611100 IF &MEMBER NE &STR() THEN SET MO = MEM(&MEMBER)


00611200 FILEINFO DSN(&LIB) &VO &MO


00611300 SET &FRC = &LASTCC


00611400 IF &FRC NE 0 THEN DO


00611500       IF &FRC = 24 THEN SET CDCUR = MEMBER


00611600                    ELSE IF &DSN = THEN SET CDCUR = PRJ0


00611700                                   ELSE SET CDCUR = DSN


00611800       SET EMSG = &STR(&OUTMSG)


00611900       GOTO MAINLOOP


00612000                   ENDO


00612100 IF &MEMCNTL = YES THEN DO


00612200       SET CDCUR = DSN


00612300       SET EMSG = MEMBER NAME NOT ALLOWED HERE


00612400       GOTO MAINLOOP


00612500                        ENDO


00613000GOTO OPTSEL


00620000


00623100OPTU: STACK


00624500URZAP '&FULLDSN' &VO


00624600KOMM RES(1)


00624700ISPEXEC CONTROL DISPLAY REFRESH


00624800GOTO MAINLOOP


00624900


00625000OPTZ: +


00625100CONTROL NOMSG


00625200FREE F(SYSIN)


00625300CONTROL MSG


00625400ALLOC F(SYSIN) DA(*)


00625500IF &VOL = &STR() THEN GOTO FREELIB


00625600IFALC F(SYSLIB) DA('&FULLDSN')


00625700IF &LASTCC = 0 THEN GOTO CALLZAP


00625800FREELIB: CONTROL NOMSG


00625900FREE F(SYSLIB)


00626000CONTROL MSG


00626100IF &VOL = &STR() THEN ALLOC F(SYSLIB) DA('&FULLDSN') SHR


00626200                 ELSE ALLOC F(SYSLIB) DA('&FULLDSN') VOL(&VOL.) SHR UNIT
(SYSALLDA)

00626300CALLZAP: ISPEXEC CONTROL DISPLAY SM START(1)


00626400         CALL 'SYS1.LINKLIB(AMASPZAP)'


00626500GOTO ENDOPT


00626600


00626700OPTI: GOTO OPTB


00626800OPTD: GOTO OPTB


00627000


00630000OPTB: +


00631000IF &VOL = &STR() THEN GOTO FREELIB2


00641000CONTROL NOMSG


00642000FREE F(SYSLIB SYSIN)


00643000GOTO ALLOCS


00650000FREELIB2: CONTROL NOMSG


00660000FREE F(SYSIN)


00670000ALLOCS: CONTROL MSG


00680000ALLOC F(SYSIN) SP(1) TRACK


00681000IFALC F(SYSLIB) DA('&FULLDSN')


00682000IF &LASTCC = 0 THEN GOTO BILDCTL


00683000CONTROL NOMSG


00684000FREE F(SYSLIB)


00685000CONTROL MSG


00690000IF &VOL = &STR() THEN ALLOC F(SYSLIB) DA('&FULLDSN') SHR


00700000                 ELSE ALLOC F(SYSLIB) DA('&FULLDSN') VOL(&VOL.) SHR UNIT
(SYSALLDA)

00710000BILDCTL: OPENFILE SYSIN OUTPUT


00711000IF &OPT = I THEN +


00711100       SET SYSIN = &STR( LISTIDR OUTPUT=ALL,MEMBER=&MEMBER)


00713000IF &OPT = B THEN +


00720000       SET SYSIN = &STR( LISTLOAD OUTPUT=XREF,MEMBER=&MEMBER)


00720100IF &OPT = D THEN +


00722000       SET SYSIN = &STR( DUMPT &MEMBER &CSECT)


00730000PUTFILE SYSIN


00740000CLOSFILE SYSIN


00741000IF &OPT = D THEN CALL 'SYS1.LINKLIB(AMASPZAP)'


00750000            ELSE CALL 'SYS1.LINKLIB(AMBLIST)'


00780000GOTO ENDOPT


./ ADD NAME=SPFCATCC 0102-84079-84079-1143-00273-00274-00003-KK00150
00010000PROC 0 TYPE(C) L CAT(NONE)


00020000CONTROL NOFLUSH NOMSG END(ENDO)


00021000IF &L = L THEN CONTROL MSG LIST CONLIST


00022000   /**********************************************************/


00022100   /* VERIFY THAT INPUT AND OUTPUT FILES ARE ALLOCATED:      */


00022200   /**********************************************************/


00023000ERROR EXIT CODE(99)


00030000IFALC F(BILDLIST)


00040000IFALC F(SYSIN)


00121000   /**********************************************************/


00122000   /* CALL THE INITALIZATION SUBROUTINE FOR VARIABLES:       */


00123000   /**********************************************************/


00124000GOTO INITVARS


00130000INITDONE: CONTROL NOFLUSH


00131000   /**********************************************************/


00132000   /* ESTABLISH END OF FILE EXIT ROUTINE:                    */


00133000   /**********************************************************/


00140000ERROR DO


00150000  ERROR OFF


00160000  CLOSFILE BILDLIST


00170000  CLOSFILE SYSIN


00180000  EXIT


00190000      ENDO


00191000   /**********************************************************/


00192000   /* OPEN THE INPUT AND OUTPUT FILES:                       */


00193000   /**********************************************************/


00200000OPENFILE BILDLIST INPUT


00210000OPENFILE SYSIN OUTPUT


00211000


00220000   /**********************************************************/


00221000   /**********************************************************/


00230000   /* BEGIN MAIN PROCESSING LOOP:                            */


00231000   /* LOOP READING THE IDCAMS LISTING FOR KNOWN ENTRIES:     */


00232000   /* PERFORM SEPARATE SUBROUTINE FOR NVSAM,ALIAS,GDG:       */


00240000   /**********************************************************/


00241000   /**********************************************************/


00250000LOOP: +


00260000 GETFILE BILDLIST


00270000 LOOP1:   IF &SUBSTR(1,&STR(&BILDLIST)) = &STR( ) THEN GOTO LOOP


00280000 SET &SYSDVAL = &STR(&BILDLIST)


00290000 READDVAL P1 P2 P3 P4


00310000   /**********************************************************/


00320000   /*                                    STANDARD NONVSAM:   */


00330000   /**********************************************************/


00350000 IF &STR(&P1) = NONVSAM THEN GOTO NVSAM


00370000   /**********************************************************/


01200000 /*                                      STANDARD GDG:       */


01201000   /**********************************************************/


01202000 IF &STR(&P1) = GDG THEN GOTO GDG


01204000   /**********************************************************/


01205000 /*                                      STANDARD ALIAS:     */


01206000   /**********************************************************/


01207000 IF &STR(&P1) = ALIAS THEN GOTO ALIAS


01210000GOTO LOOP


01210100


01210300   /**********************************************************/


01210400   /*          INDIVIDUAL ENTRY SUBROUTINES:                 */


01210500   /**********************************************************/


01210600


01210700   /**********************************************************/


01210800   /*                                    STANDARD NONVSAM:   */


01210900   /**********************************************************/


01211202NVSAM: SET DSN = &STR(&P3)


01211300   /**********************************************************/


01211400   /*                FIRST FIND THE VOLSER RECORD:           */


01211500   /**********************************************************/


01211600   FINDV: +


01211700          GETFILE BILDLIST


01211800          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOOP1


01211900          SET &SYSDVAL = &STR(&BILDLIST)


01212000          READDVAL P1 P2 P3 P4


01212100          IF &STR(&P1) NE &STR(VOLUMES) THEN GOTO FINDV


01212200          GETFILE BILDLIST


01212300          SET &SYSDVAL = &STR(&BILDLIST)


01212400          READDVAL P1 P2 P3 P4


01212500          SET VOL = &SUBSTR(19:&LENGTH(&STR(&P1)),&STR(&P1))


01212600          DO WHILE &SUBSTR(1,&STR(&VOL)) = &STR(-)


01212700             SET VOL = &SUBSTR(2:&LENGTH(&STR(&VOL)),&STR(&VOL))


01212800             ENDO


01212900          SET DEV = &SUBSTR(16:&LENGTH(&STR(&P1))-1,&STR(&P2))


01213000   /**********************************************************/


01213100   /*                THEN  FIND THE DEVICE TYPE:             */


01213200   /**********************************************************/


01213300          SET DT = &STR(&D&DEV)


01213400   /*     DEVTYPE VOL(&VOL)   */


01213500          IF &LASTCC NE 0 THEN DO


01213600              SET SYSIN = &STR(***** &VOL ***** ERROR ==> &OUTMSG )


01213700              PUTFILE SYSIN


01213800              GOTO LOOP


01213900                               ENDO


01214000


01214100   /**********************************************************/


01214200   /*                THEN  BUILD THE DESIRED CTL CARD:       */


01214300   /**********************************************************/


01214400          IF &TYPE = D THEN SET SYSIN = &STR( DEL '&DSN' )


01214500                       ELSE  +


01214600          IF &TYPE = U THEN SET SYSIN = &STR( DEL '&DSN' NSCR)


01214700                       ELSE  DO


01214800          SET SYSIN = &STR( DEF NVSAM&LP. NAME('&DSN') +)


01214900                              PUTFILE SYSIN


01215000/*        SET SYSIN = &STR(           VOL(&VOL) DEVT(&DEVTYP) &RP) */


01215100          SET SYSIN = &STR(           VOL(&VOL) DEVT(&DT) &RP)


01215200                             ENDO


01215300   /**********************************************************/


01215400   /*                THEN  WRITE SYSIN DESIRED CTL CARD:     */


01215500   /**********************************************************/


01215600          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01215700                         ELSE DO


01215800                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01215900                              PUTFILE SYSIN


01216000                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01216100                              PUTFILE SYSIN


01216200                              ENDO


01216300   /**********************************************************/


01216400   /*   NOW SEE IF ANY ALIASES NEED TO BE MOVED:             */


01216500   /**********************************************************/


01216600          GETFILE BILDLIST


01216700          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOOP1


01216800          SET &SYSDVAL = &STR(&BILDLIST)


01216900          READDVAL P1 P2 P3 P4


01217000          IF &STR(&P1) = &STR(ASSOCIATIONS--------(NULL)) THEN GOTO LOOP


01217100          IF &TYPE = D THEN GOTO LOOP


01217200          IF &TYPE = U THEN GOTO LOOP


01217300   /**********************************************************/


01217400   /*   LOOP2   IF ANY ALIASES NEED TO BE MOVED:             */


01217500   /**********************************************************/


01217600  LOOP2:  GETFILE BILDLIST


01217700          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOOP1


01217800          SET &SYSDVAL = &STR(&BILDLIST)


01217900          READDVAL P1 P2 P3 P4


01218000          IF &STR(&P1) = NONVSAM THEN GOTO LOOP1


01218100          IF &SUBSTR(1:9,&STR(&P1)) = &STR(ALIAS----) THEN DO


01218200             SET AN = &SUBSTR(10:&LENGTH(&STR(&P1)),&STR(&P1))


01218300             SET SYSIN = &STR( DEF ALIAS&LP. NAME('&AN') +)


01218400                              PUTFILE SYSIN


01218500             SET SYSIN = &STR(           REL('&DSN') &RP)


01218600          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01218700                         ELSE DO


01218800                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01218900                              PUTFILE SYSIN


01219000                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01219100                              PUTFILE SYSIN


01219200                              ENDO


01219300                                                           ENDO


01219400          GOTO LOOP2


01219500   /**********************************************************/


01219600   /*      END OF NVSAM ENTRY CODE                           */


01219700   /**********************************************************/


01219800


01219900


01220000   /**********************************************************/


01220100   /*                                    STANDARD GDG:       */


01220200   /**********************************************************/


01220401GDG:      SET DSN = &STR(&P4)


01220500   /**********************************************************/


01220600   /*                FIRST FIND THE ATTR   RECORD:           */


01220700   /**********************************************************/


01220800   FINDA: +


01220900          GETFILE BILDLIST


01221000          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOOP1


01221100          SET &SYSDVAL = &STR(&BILDLIST)


01221200          READDVAL P1 P2 P3 P4


01221300          IF &STR(&P1) NE &STR(ATTRIBUTES) THEN GOTO FINDA


01221400          GETFILE BILDLIST


01221500          SET &SYSDVAL = &STR(&BILDLIST)


01221600          READDVAL P1 P2 P3 P4


01221700          SET LIM = &SUBSTR(20:&LENGTH(&STR(&P1)),&STR(&P1))


01221800          DO WHILE &SUBSTR(1,&STR(&LIM)) = &STR(-)


01221900             SET LIM = &SUBSTR(2:&LENGTH(&STR(&LIM)),&STR(&LIM))


01222000             ENDO


01222100          SET SCR = &P2


01222200          SET EMO = &P3


01223300


01223400   /**********************************************************/


01223500   /*                THEN  BUILD THE DESIRED CTL CARD:       */


01223600   /**********************************************************/


01223700          IF &TYPE = D THEN SET SYSIN = &STR( DEL '&DSN' )


01223800                       ELSE  +


01223900          IF &TYPE = U THEN SET SYSIN = &STR( DEL '&DSN' NSCR)


01224000                       ELSE  DO


01224100          SET SYSIN = &STR( DEF GDG&LP. NAME('&DSN') +)


01224200                              PUTFILE SYSIN


01224300          SET SYSIN = &STR(           LIM(&LIM) &SCR &EMO &RP)


01224500                             ENDO


01224600   /**********************************************************/


01224700   /*                THEN  WRITE SYSIN DESIRED CTL CARD:     */


01224800   /**********************************************************/


01224900          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01225000                         ELSE DO


01225100                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01225200                              PUTFILE SYSIN


01225300                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01225400                              PUTFILE SYSIN


01225500                              ENDO


01225600   GOTO LOOP


01225700   /**********************************************************/


01225800   /*      END OF GDG ENTRY CODE                             */


01225900   /**********************************************************/


01229000


01229100


01229200   /**********************************************************/


01229300   /*                                    STANDARD ALIAS:     */


01229400   /**********************************************************/


01229501ALIAS:    SET DSN = &STR(&P3)


01229600   /**********************************************************/


01229700   /*                FIRST FIND THE REL    RECORD:           */


01229800   /**********************************************************/


01229900   FINDR: +


01230000          GETFILE BILDLIST


01230100          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOOP1


01230200          SET &SYSDVAL = &STR(&BILDLIST)


01230300          READDVAL P1 P2 P3 P4


01230400          IF &STR(&P1) NE &STR(ASSOCIATIONS) THEN GOTO FINDR


01230500          GETFILE BILDLIST


01230600          SET &SYSDVAL = &STR(&BILDLIST)


01230700          READDVAL P1 P2 P3 P4


01230800          SET REL = &SUBSTR(10:&LENGTH(&STR(&P1)),&STR(&P1))


01231400


01231500   /**********************************************************/


01231600   /*                THEN  BUILD THE DESIRED CTL CARD:       */


01231700   /**********************************************************/


01231800          IF &TYPE = D THEN SET SYSIN = &STR( DEL '&DSN' )


01231900                       ELSE  +


01232000          IF &TYPE = U THEN SET SYSIN = &STR( DEL '&DSN' NSCR)


01232100                       ELSE  DO


01232200          SET SYSIN = &STR( DEF ALIAS&LP. NAME('&DSN') +)


01232300                              PUTFILE SYSIN


01232400          SET SYSIN = &STR(           REL('&REL') &RP)


01232500                             ENDO


01232600   /**********************************************************/


01232700   /*                THEN  WRITE SYSIN DESIRED CTL CARD:     */


01232800   /**********************************************************/


01232900          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01233000                         ELSE DO


01233100                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01233200                              PUTFILE SYSIN


01233300                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01233400                              PUTFILE SYSIN


01233500                              ENDO


01233600   GOTO LOOP


01233700   /**********************************************************/


01233800   /*      END OF ALIAS ENTRY CODE                           */


01233900   /**********************************************************/


01234000


01234100   /**********************************************************/


01234200   /**********************************************************/


01234300   /* INITIALIZE VARIABLES SUBROUTINE :                      */


01234400   /**********************************************************/


01234500   /**********************************************************/


01234600INITVARS: +


01235000SET &LP = &SUBSTR(1,&STR(()))


01240000SET &RP = &SUBSTR(2,&STR(()))


01250000SET &D = &STR(&&D)


01260000SET D30502009 = &STR(3330)


01270000SET D3050200D = &STR(3330-1)


01280000SET D3050200B = &STR(3350)


01290000SET D3010200E = &STR(3380)


01300000SET D30502006 = &STR(2305-1)


01310000SET D30502007 = &STR(2305-2)


01320000SET D00012000 = &STR(SYSDA)


01330000SET D00022000 = &STR(SYSSQ)


01340000SET D00082000 = &STR(WORK)


01350000SET D00092000 = &STR(WORK)


01360000SET D00058000 = &STR(TAPE8)


01370000SET D00068000 = &STR(TAPE16)


01380000SET D30008001 = &STR(2400)


01390000SET D34008001 = &STR(2400-3)


01400000SET D34208001 = &STR(2400-4)


01410000SET D34008003 = &STR(3400-3)


01420000SET D34208003 = &STR(3400-4)


01430000SET D32008003 = &STR(3400-5)


01440000SET D32108003 = &STR(3400-6)


01450000GOTO INITDONE


./ ADD NAME=SPFCATNV 0102-85273-86084-1745-00754-00753-00000-KK00150
        PROC 0 FI(NONE) L


        CONTROL NOFLUSH   MSG END(ENDO)


        /*IF &SYSUID = KK00150 THEN CONTROL MSG LIST CONLIST  /* */


        IF &L = L THEN CONTROL MSG LIST CONLIST  /* */


        GLOBAL GCRC GCVOL GCDEVT


        GLOBAL EMSG


        ERROR DO


              %ERRORMSG &LASTCC


              GOTO MAINLOOP


              ENDO


        /******************************************************************/


        /*   INITIALIZE VARIABLES FIRST:                                  */


        /******************************************************************/


        SET PATTR = &STR(LOW)


        SET CN = &STR(&&CN)


        SET CO = &STR(&&CO)


        SET CP = &STR(&&CP)


        SET PF = &STR(&&PF)


        SET &P  = &STR(&&P)


        SET &EO  = &STR(&&EO)


        SET EMSG = &STR()


        SET DEVT = &STR()


        SET ALIAS = &STR()


        SET &CDCUR = DSN


        SET &VF = N


        SET REP = &STR(&&REP)


        SET REP1 = NONE


        SET REP2 = NONE


        SET REP3 = NONE


        SET REP4 = NONE


        SET REP5 = NONE


        SET REP6 = NONE


        SET REP7 = NONE


        SET REP8 = NONE


        ERROR OFF


        ISPEXEC VGET (CN7 CN8 LF PASSDS) PROFILE


        IF &PASSDS NE YES THEN SET &DSN = &STR()


        IF &PASSDS NE YES THEN SET &VOL = &STR()


        ERROR DO


              %ERRORMSG &LASTCC


              GOTO MAINLOOP


              ENDO


        INITCATS: SET ICF = N


        SET CN1 = &STR(SYS1.SOFTCAT)


        SET CD1 = &STR(SOFTWARE CAT)


        SET PF1 = N


        SET CN2 = &STR(SYS1.C03MCAT)


        SET CD2 = &STR(Q1CD MASTER)


        SET PF2 = N


        SET CN3 = &STR(SYS1.E07MCAT)


        SET CD3 = &STR(Q2EF MASTER)


        SET PF3 = N


        SET CN4 = &STR(SYS1.G29MCAT)


        SET CD4 = &STR(H3AN MASTER)


        SET PF4 = U


        SET CN5 = &STR(SYS1.K15MCAT)


        SET CD5 = &STR(K1K1 MASTER)


        SET PF5 = U


        SET CN6 = &STR(SYS1.USERCAT1)


        SET CD6 = &STR(USERCAT1)


        SET PF6 = N


        SET PF7 = N


        SET CD7 = &STR((OPTIONAL CAT))


        SET PF8 = N


        SET CD8 = &STR((OPTIONAL CAT))





        /******************************************************************/


        /*   MAIN DIALOG LOOP START: DISPLAY PANEL AND GET RESPONSE:      */


        /******************************************************************/


        MAINLOOP: IF &ICF = Y THEN GOTO INITCATS


        DISPLAY: ERROR OFF


        CONTROL MSG NOLIST NOCONLIST


        ISPEXEC DISPLAY PANEL(&SYSICMD) CURSOR(&CDCUR)


           SET DRC = &LASTCC


           IF &DRC NE 0 THEN DO


                 IF &FI NE NONE THEN %CMDOUT FREE(&FI)


                 ISPEXEC VPUT (CN7 CN8 LF) PROFILE


                 EXIT


                             ENDO


        IF &LF = L THEN DO


                        ISPEXEC CONTROL DISPLAY SM START(1)


                        CONTROL MSG LIST CONLIST


                        SET VF = E


                        SET L = L


                        ENDO


                   ELSE DO


                        SET VF = N


                        IF &LF = Y THEN SET VF = Y


                        IF &LF = B THEN SET VF = Y


                        IF &LF = E THEN SET VF = E


                        ENDO


        IF &STR(&DEVT) = &STR() THEN SET CDT = Y


                                ELSE SET CDT = N


        SET EMSG = &STR()


        SET PATTR = &STR()





        /******************************************************************/


        /*   ALLOCATE AN OUTPUT FILE FOR DISPLAYING THE RESULTS:          */


        /******************************************************************/


        IF &FI = NONE THEN DO


                      CONTROL NOMSG


                      IF &LF = L THEN CONTROL MSG


                      FREE ATTR(KKKACUNV)


                      ATTR KKKACUNV RECFM(V,B) LRECL(137) BLK(3155)


                      CONTROL MSG


                      %CMDOUT MOD USE(KKKACUNV) FORCE &L


                      SET &FI = &LASTCC


                      IF &FI = 99 THEN DO


                          SET FI = NONE


                          SET EMSG = ERROR ALLOCATING CMD FILE


                          GOTO MAINLOOP


                                       ENDO


                      OPENFILE CMDOUT&FI OUTPUT


                      CLOSFILE CMDOUT&FI


                      SET SVOL = &VOL


                      WHATDSN DDN(CMDOUT&FI)


                      SET &CDSN = &DSNAME


                      SET VOL = &SVOL


                           ENDO





        /******************************************************************/


        /*   MAKE ONE PASS   THROUGH ALL CATALOGS VERIFYING  REQUESTS:    */


        /******************************************************************/


        GOTO CATVER     /* VERIFY PARMS ENTERED   */





        /******************************************************************/


        /*   MAKE 3 PASSES THROUGH ALL CATALOGS PROCESSING REQUESTS:      */


        /******************************************************************/


        CATLOOP: +


        SET PASS = 1


        DO WHILE &PASS < 4


                                 /*  INNER LOOP THROUGH EACH CATLOG:   */


          SET CDF = YES


          SET &I = 1


          DO WHILE &I < 9


            IF &CO&I NE &STR( ) THEN GOTO CATFUNC /* CATALOG NEEDS SOMETHING */


            CATDONE: +


            IF &CDF = YES THEN SET &CO&I =


            SET CDF = YES


            SET &I = &I + 1


          ENDO





          SET PASS = &PASS + 1


        ENDO





        /******************************************************************/


        /*   ALL CATALOG FTNS DONE: DISPLAY RESULTS AND RESTART DIALOG:   */


        /******************************************************************/





        SET CDCUR = DSN


        ENDLOOP: IF &CDT = Y THEN SET DEVT = &STR()


                 IF &VF = N THEN DO


                            OPENFILE CMDOUT&FI OUTPUT


                            CLOSFILE CMDOUT&FI


                            GOTO MAINLOOP


                                 ENDO


        ISPEXEC SELECT PGM(CLRSPFIO)


        ISPEXEC CONTROL ERRORS RETURN


        IF &VF = Y THEN ISPEXEC BROWSE DATASET('&CDSN.')


        IF &VF = E THEN ISPEXEC EDIT DATASET('&CDSN.')


        OPENFILE CMDOUT&FI OUTPUT


        CLOSFILE CMDOUT&FI


        SET VF = N


        GOTO MAINLOOP





        /******************************************************************/


        /*   ALL DIALOG INTERNAL SUBROUTINES FOLLOW HERE:                 */


        /******************************************************************/





        /*   CATVER VERIFICATION SUBROUTINE:   */





        CATVER: SET NAME = &STR(&DSN)


        /*                                                                   */


        /*  1 = NO OP                           6 = DELETE                   */


        /*  2 = LISTCAT                         7 = CATALOG                  */


        /*  3 = LISTCAT LVL                    11 = RECATALOG                */


        /*  4 = UNCATALOG                      13 = RENAME                   */


        /*  5 = DEF ALIAS                      17 = DEF GDG                  */


        /* 19 = COPY FROM CATALOG              23 = MOVE FROM CATALOG        */


        /*                                                                   */


        /*  8 = COPY LIST(L) FROM CAT  (FL)  9 = COPY LIST(LL) FROM CAT (FLL)*/


        /* 10 = MOVE LIST(L) FROM CAT  (ML) 12 = MOVE LIST(LL) FROM CAT (MLL)*/


        /* 14 = CATALOG FROM LIST BILT BY 8,9,10,12  (THIS IS CL)            */


        /*                                                                   */


        /* 15 = UNCATALOG BY LEVEL                                           */


        /* 16 = DELETE    BY LEVEL                                           */


        /*                                                                   */


        /* 18 = INVOKE FLIST FACILITY                                        */


        /* 20 = ALTER (VIA PARM FIELD)                                       */


        /*                                                                   */





        /* DO PRELIMINARY PROCESSING:  VERIFY OPTION COMBINATIONS   */


        /*     THEN VERIFY VOL AND DEVT FOR LATER CAT OR RECAT OPT  */





        /* SET OP FLAGS OFF  */


        SET &FF = NO


        SET &MFF = NO


        SET &CATF = NO


        SET &CATLF = NO


        SET &RECATF = NO


        SET &COPYF = NO


        SET &MOVEF = NO


        SET &BILDF = NO


        SET &DELF = NO


        SET &RENF = NO


        SET &GDGF = NO


        SET &ALIASF = NO


        SET &ULLF = NO


        SET &ALTF = NO





        SET &J = 1


        DO WHILE &J < 9


          IF &CO&J = 5 THEN SET &ALIASF = YES


          IF &CO&J = 6 THEN SET &DELF = YES


          IF &CO&J = 7 THEN SET &CATF = YES


          IF &CO&J = 8  OR &CO&J = 9 OR &CO&J = 10 OR &CO&J = 12 THEN +


                             SET &BILDF = YES


          IF &CO&J = 11 THEN SET &RECATF = YES


          IF &CO&J = 13 THEN SET &RENF = YES


          IF &CO&J = 14 THEN SET &CATLF = YES


          IF &CO&J = 15 THEN SET &ULLF = YES


          IF &CO&J = 17 THEN SET &GDGF = YES


          IF &CO&J = 19 THEN SET &COPYF = YES


          IF &CO&J = 20 THEN SET &ALTF = YES


          IF &CO&J = 23 THEN SET &MOVEF = YES


          SET &J = &J + 1


        ENDO





        IF &BILDF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &GDGF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            IF &CATLF = NO THEN DO


                SET EMSG = &STR(SPECIFY DEST FOR CATALOG-A-LIST)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO





        IF &CATLF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &GDGF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            IF &BILDF = NO THEN DO


                SET EMSG = &STR(SPECIFY SOURCE FOR CATALOG-A-LIST)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO





        IF &ULLF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &GDGF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO





        IF &GDGF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &CATLF = YES  OR BILDF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO








        IF &CATF = NO AND &RECATF = NO  THEN GOTO CATLOOP /* NO VER NEEDED */


        IF &COPYF = YES OR &MOVEF = YES THEN GOTO CATLOOP /* GET VOL LATER */





        IF &STR(&VOL) = &STR() THEN DO





          IF &RECATF = YES       THEN DO


              SET EMSG = &STR(ERROR - VOLUME IS NEEDED TO RECATALOG DATASET.)


              SET CDCUR = VOL


              GOTO MAINLOOP


                                      ENDO





          IF &CATF = YES       THEN DO


              FILEINFO DSN(&NAME)


              SET FIRC = &LASTCC


               IF &FIRC = 4 THEN DO


                    SET EMSG = &STR(VOLUME NEEDED TO CATALOG &NAME)


                    SET CDCUR = VOL


                    GOTO MAINLOOP


                                  ENDO


               IF &FIRC NE 0 THEN DO


                    SET EMSG = &STR(UNABLE TO CATALOG &NAME - &OUTMSG)


                    SET CDCUR = VOL


                    GOTO MAINLOOP


                                  ENDO


              SET &VOL = &STR(&VOLSER)


                                    ENDO


                                  ENDO





        GOTVOL: +


        IF &STR(&DEVT) = &STR() THEN +


           DO


           DEVTYPE VOL(&VOL)


           SET DTRC = &LASTCC


           IF &DTRC NE 0 THEN +


                DO


                IF &LENGTH(&VOL) > 3 THEN DO


                     IF &SUBSTR(1:4,&VOL) = 3350 THEN DO


                                                SET &DEVT = 3350


                                                GOTO GOTDEVT


                                                      ENDO


                     IF &SUBSTR(1:4,&VOL) = 3380 THEN DO


                                                SET &DEVT = 3380


                                                GOTO GOTDEVT


                                                      ENDO


                                          ENDO


                IF &DTRC = 8 THEN DO


                                  SET EMSG = &STR(DEVICE TYPE NEEDED)


                                  SET CDCUR = DEVT


                                  GOTO MAINLOOP


                                  ENDO


                SET EMSG = &STR(DEVICE TYPE NEEDED - &OUTMSG)


                SET CDCUR = DEVT


                GOTO MAINLOOP


                ENDO


           SET &DEVT = &STR(&DEVTYP)


           ENDO


        GOTDEVT: +


        GOTO CATLOOP








        /*  CATALOG FUNCTION CONTROL SUBROUTINE:                             */


        /*    (GET PASSWORD AS NEEDED, CALL SPECIFIC CATALOG FUNCTION)       */





        /*                    FIRST, ANALYZE OPTION,PARMS AND PASSWORD:  */


        CATFUNC: +


        SET CC = &I


        SET &SYSDVAL = &STR(&CP&CC)


        SET &CP&CC = &STR()


        READDVAL P1 P2 P3 P4 P5 P6


        SET &PC = 1


        DO WHILE &PC < 6


        IF &PF&CC = Y OR &PF&CC = U THEN DO


             IF &CO&CC = 8 OR &CO&CC = 9 THEN GOTO NOPASS


             IF &CO&CC = 1 OR &CO&CC = 19 THEN GOTO NOPASS


             IF &PF&CC = U AND &CO&CC < 4 THEN GOTO NOPASS


             IF &REP&CC = NONE AND &P&PC = &STR() THEN +


                                   DO


                                   SET EMSG = &STR(ENTER PASSWORD)


                                   SET CDCUR = CP&CC


                                   SET PATTR = NON


                                   GOTO DISPLAY


                                   ENDO


             IF &P&PC NE &STR() AND &PC = 1 THEN +


                                   DO


                                   SET &REP&CC = &STR(&P&PC)


                                   GOTO NEXTPARM


                                   ENDO


                                         ENDO


        NOPASS: +


             IF &P&PC = &STR() THEN GOTO SELOPT


             IF &P&PC = Y THEN DO


                               SET &PF&CC = Y


                               SET ICF = Y


                               SET &NPC = &PC+1


                               IF &P&NPC NE &STR() THEN DO


                                                   SET &REP&CC = &P&NPC


                                                   SET &PC = &PC+1


                                                   ENDO


                                                   ELSE DO


                                                   SET &REP&CC = NONE


                                                   ENDO


                               GOTO NEXTPARM


                               ENDO


             IF &P&PC = &REP&CC THEN GOTO NEXTPARM


             IF &CP&CC NE &STR() THEN SET &CP&CC = &STR(&CP&CC &P&PC)


                                 ELSE SET &CP&CC = &STR(&P&PC)


        NEXTPARM: SET &PC = &PC + 1


        ENDO





        /*                    SECOND ; CALL THE FUNCTION SUBROUTINE :      */


        SELOPT: GOTO O&CO&CC                 /* CALL THE CATALOG FUNCTION  */





        /*                    THIRD  ; SAY OK AND RETURN TO CATALOG LOOP:  */


        CUP: SET EMSG = &STR(SUCCESSFUL COMPLETION FOR &CN&CC)


             GOTO CATDONE





        /***************************************************/


        /* SPECIFIC CATALOG FUNCTION SUBROUTINES FOLLOW:   */


        /***************************************************/





        /* SOME FUNCTIONS NEED TO LIST THEIR RESULTS BACK FOR LATER DISPLAY: */


        OKLC: +


          STACK DDOUT(CMDOUT&FI.M)


          LISTC ALL ENT(&NAME) CAT('&CN&CC'/&REP&CC)


          GOTO CUP





        /* SOME FUNCTIONS NEED TO WAIT UNTIL LATER TO PERFORM THEIR STUFF:   */


        WAIT: +


          SET CDF = NO


          GOTO CATDONE





        O1:    GOTO CATDONE                     /* NOP FUNCTION  */





        /*         OPTION L  */


        O2: +


            IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


            IF &CP&CC = &STR() THEN SET &CP&CC = ALL


            STACK DDOUT(CMDOUT&FI.M) LIST


            LISTC &CP&CC ENT(&NAME) CAT('&CN&CC'/&REP&CC)


            SET VF = Y


            IF &CP&CC = ALL THEN SET &CP&CC = &STR()


            GOTO CATDONE





        /*         OPTION LL */


        O3: +


            IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


            IF &CP&CC = &STR() THEN SET &CP&CC = ALL


            STACK DDOUT(CMDOUT&FI.M) LIST


            LISTC &CP&CC LVL(&NAME) CAT('&CN&CC'/&REP&CC)


            SET VF = Y


            IF &CP&CC = ALL THEN SET &CP&CC = &STR()


            GOTO CATDONE





        /*         OPTION U  */


        O4: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME NSCR &CP&CC CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO CUP





        /*         OPTION A  */


        O5: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF ALIAS(NAME(&ALIAS) REL(&NAME)) CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO OKLC





        /*         OPTION D  */


        O6: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          IF &PF&CC = U OR &PF&CC = Y THEN DO


            %CATGET &NAME '&CN&CC.'


               IF &GCRC NE 0 THEN DO


                  SET EMSG = &STR(ERROR &GCRC FROM CATGET)


                  SET CDCUR = CO&I


                  GOTO ENDLOOP


                                  ENDO


          CONTROL NOMSG


          FREE F(DANCATD)


          CONTROL MSG


          ALLOC F(DANCATD) DA(&NAME) VOL(&GCVOL) UNIT(&GCDEVT)


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME &CP&CC CAT('&CN&CC'/&REP&CC) FILE(DANCATD)


          SET &RC = &LASTCC


          CONTROL NOMSG


          FREE F(DANCATD)


          CONTROL MSG


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


                                        ENDO


                                 ELSE DO


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME &CP&CC CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


                                      ENDO


          GOTO CUP





        /*         OPTION C  */


        O7: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF NVSAM(NAME(&NAME) VOL(&VOL) DEVT(&DEVT) &CP&CC) CAT('&CN&CC'/&REP&
CC)

          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          SET DOK = YES  /* SAY OK TO DELETE SOURCE ENTRY (FOR MF=MOVE OPT) */


          GOTO OKLC





        /*         OPTION FL  */


        /*    SUBROUTINE TO BUILD LIST FROM CATALOG SPECIFIED:   */


        O8: +


          IF &PASS > 1 THEN GOTO CATDONE


          IFALC F(BILDLIST)


          IF &LASTCC NE 0 THEN ALLOC F(BILDLIST) NEW DELETE TRACKS SP(1 1)


          SET CLF = OKGO /* SAY CAN DO IT */


              OPENFILE CMDOUT&FI.M OUTPUT


              SET CMDOUT&FI.M = &STR( TRANSFER FROM CATALOG &CN&CC)


              PUTFILE CMDOUT&FI.M


              CLOSFILE CMDOUT&FI.M


              STACK DDOUT(BILDLIST)


              LISTC ALL ENT(&NAME) CAT('&CN&CC')


              IF &LASTCC NE 0 THEN SET CLF = NOGO /* SAY CANNOT DO IT */


              GOTO WAIT





        /*         OPTION FLL */


        /*    SUBROUTINE TO BUILD LIST FROM CATALOG SPECIFIED:   */


        O9: +


          IF &PASS > 1 THEN GOTO CATDONE


          IFALC F(BILDLIST)


          IF &LASTCC NE 0 THEN ALLOC F(BILDLIST) NEW DELETE TRACKS SP(1 1)


          SET CLF = OKGO /* SAY CAN DO IT */


              OPENFILE CMDOUT&FI.M OUTPUT


              SET CMDOUT&FI.M = &STR( TRANSFER FROM CATALOG &CN&CC)


              PUTFILE CMDOUT&FI.M


              CLOSFILE CMDOUT&FI.M


              STACK DDOUT(BILDLIST)


              LISTC ALL LVL(&NAME) CAT('&CN&CC')


              IF &LASTCC NE 0 THEN SET CLF = NOGO /* SAY CANNOT DO IT */


              GOTO WAIT





        /*         OPTION ML  */


        O10: +


          IF &PASS = 1 THEN GOTO O8    /* NEED TO BUILD LIST FIRST.. */


          IF &PASS = 2 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          OPENFILE CMDOUT&FI.M OUTPUT


          SET CMDOUT&FI.M = &STR( MOVE FROM CATALOG &CN&CC)


          PUTFILE CMDOUT&FI.M


          CLOSFILE CMDOUT&FI.M


          IF &CLF = NOGO THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             GOTO CATDONE


             ENDO


          IFALC F(SYSIN)


          IF &LASTCC = 0 THEN FREE F(SYSIN)


          IF &VF = E THEN DO


                         %CMDOUT DDN(SYSIN) MOD


                         SET SFN = &LASTCC


                          ENDO


                     ELSE +


          ALLOC F(SYSIN) NEW DELETE               TRACKS SP(1 1) /* */


          IF &SYSICMD = SPFCATNN THEN +


          %SPFCATCN TYPE(U) CAT('''&CN&CC''/&REP&CC') &L


                                 ELSE +


          %SPFCATCC TYPE(U) CAT('''&CN&CC''/&REP&CC') &L


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             GOTO CATDONE


             ENDO


          IFALC F(SYSPRINT)


          IF &LASTCC = 0 THEN DO


              IFALC F(SYSPRINT) DSN('&CDSN.')


              IF &LASTCC = 0 THEN GOTO SYSPOK1


              FREE F(SYSPRINT)


              ENDO


          ALLOC F(SYSPRINT) DSN('&CDSN.') MOD


           SYSPOK1: IF &VF = E THEN DO


                   WHATDSN DDN(SYSIN)


                   ISPEXEC EDIT DATASET('&DSNAME')  /*  */


                                    ENDO


          CALL 'SYS1.LINKLIB(IDCAMS)'    /*  */


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             IF &VF = E THEN %CMDOUT FREE(&SFN)


             GOTO CATDONE


             ENDO


          IF &VF = E THEN %CMDOUT FREE(&SFN)


          GOTO CUP








        /*         OPTION R   */


        O11: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME NSCR CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          RECAT: +


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF NVSAM(NAME(&NAME) VOL(&VOL) DEVT(&DEVT) &CP&CC) CAT('&CN&CC'/&REP&
CC)

          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO OKLC





        /*         OPTION MLL */


        O12: +


          IF &PASS = 1 THEN GOTO O9    /* NEED TO BUILD LIST FIRST.. */


          IF &PASS = 2 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          GOTO O10





        /*         OPTION RN  */


        O13: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          ALTER &NAME NEWNAME(&ALIAS) &CP&CC CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          STACK DDOUT(CMDOUT&FI.M) LIST


          LISTC ALL ENT(&ALIAS) CAT('&CN&CC'/&REP&CC)


          GOTO CUP





        /*         OPTION CL  */


        O14: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          OPENFILE CMDOUT&FI.M OUTPUT


          SET CMDOUT&FI.M = &STR( TRANSFER TO CATALOG &CN&CC)


          PUTFILE CMDOUT&FI.M


          CLOSFILE CMDOUT&FI.M


          IF &CLF = NOGO THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             GOTO CATDONE


             ENDO


          IFALC F(SYSIN)


          IF &LASTCC = 0 THEN FREE F(SYSIN)


          IF &VF = E THEN DO


                         %CMDOUT DDN(SYSIN) MOD


                         SET SFN = &LASTCC


                          ENDO


                     ELSE +


          ALLOC F(SYSIN) NEW DELETE               TRACKS SP(1 1) /* */


          IF &SYSICMD = SPFCATNN THEN +


          %SPFCATCN CAT('''&CN&CC''/&REP&CC') &L


                                 ELSE +


          %SPFCATCC CAT('''&CN&CC''/&REP&CC') &L


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             GOTO CATDONE


             ENDO


          IFALC F(SYSPRINT)


          IF &LASTCC = 0 THEN DO


              IFALC F(SYSPRINT) DSN('&CDSN.')


              IF &LASTCC = 0 THEN GOTO SYSPOK


              FREE F(SYSPRINT)


              ENDO


          ALLOC F(SYSPRINT) DSN('&CDSN.') MOD


           SYSPOK: IF &VF = E THEN DO


                   WHATDSN DDN(SYSIN)


                   ISPEXEC EDIT DATASET('&DSNAME')  /*  */


                                   ENDO


          CALL 'SYS1.LINKLIB(IDCAMS)'    /*  */


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             IF &VF = E THEN %CMDOUT FREE(&SFN)


             GOTO CATDONE


             ENDO


          IF &VF = E THEN %CMDOUT FREE(&SFN)


          GOTO CUP





        /*         OPTION ULL */


        O15: +


          IF &PASS = 1 THEN GOTO O9    /* NEED TO BUILD LIST FIRST.. */


          IF &PASS = 2 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          GOTO O10





        /*         OPTION G   */


        O17: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          IF &CP&CC = &STR() THEN SET &CP&CC = SCR


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF GDG(NAME(&NAME) LIM(&VOL) &CP&CC) CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &CP&CC = &STR(SCR) THEN SET &CP&CC = &STR()


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO OKLC





        /*         OPTION K   */


        O18: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          IF &PASS = 2 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          SET DSLIST = &STR(&NAME)


          SET FCAT = &STR('&CN&CC'/&REP&CC)


          ISPEXEC VPUT (DSLIST FCAT) SHARED


          %FLIST


          SET VF = N


          GOTO CATDONE





        /*         OPTION F   */


             /* IF SPECIFIED, GET VOL FROM CAT GIVEN :       */


        O19: +


           IF &PASS > 1 THEN GOTO CATDONE


           %CATGET &NAME '&CN&CC.'


           IF &GCRC NE 0 THEN DO


              SET EMSG = &STR(ERROR &GCRC FROM CATGET)


              SET CDCUR = CO&CC


              GOTO MAINLOOP


                              ENDO


           SET &VOL = &GCVOL


           SET &DEVT = &STR(&GCDEVT)


           GOTO WAIT





        /*         OPTION M(MODIFY=ALTER)  */


        O20: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          ALTER &NAME &CP&CC CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          STACK DDOUT(CMDOUT&FI.M) LIST


          LISTC ALL ENT(&NAME) CAT('&CN&CC'/&REP&CC)


          GOTO CUP





        /*         OPTION MF  */


        O23: +


          IF &PASS = 1 THEN GOTO O19


          IF &PASS = 2 THEN GOTO WAIT


          IF &DOK = YES THEN GOTO O4


           SET VF = Y


           SET EMSG = &STR(ERROR-MOVE BYPASSED FOR &CN&CC)


           GOTO CATDONE


./ ADD NAME=SPFEOPT  0107-84270-89145-1604-00014-00003-00012-LL02155
00010000PROC 1 PREPO


00011003CONTROL NOFLUSH END(ENDO)


00020001IF &PREPO EQ YES THEN +


00040000ISPEXEC SELECT PGM(NEWMWILE) PARM(1)


00050001IF &PREPO EQ NO  THEN +


00060001ISPEXEC SELECT PGM(NEWMWILE) PARM(2)


00340002ISPEXEC CONTROL SPLIT DISABLE


00350002IF &LASTCC = 8 THEN DO


00360002     SET &GPM = SPLIT SCREEN WARNING


00370002     SET &GPML = ENVIRONMENTAL CHANGES MAY BE INVALID IN SPLIT SCREEN.


00380002     ISPEXEC SETMSG MSG(GPM001)


00390002     EXIT


00400002                    ENDO


00401002ISPEXEC CONTROL SPLIT ENABLE


./ ADD NAME=SPFXL    0100-84214-84214-1136-00004-00004-00000-KK00150
00010000CONTROL NOFLUSH


00020000ISPEXEC CONTROL SPLIT DISABLE


00030000IF &LASTCC NE 8 THEN ISPEXEC SELECT PGM(WDPSCXS) PARM(LOGOFF)


00040000ISPEXEC CONTROL SPLIT ENABLE


./ ADD NAME=SPFYFND  0109-86069-87314-1126-00198-00189-00016-LL02155
00010000         CONTROL NOMSG NOFLUSH END(ENDO)


00010205


00011006         PROF MSGID


00020003


00030000         SET &FNDSERR = &STR(SPFYFND ERROR F01)


00040000         ISPEXEC VPUT FNDSERR SHARED


00050000


00051000         ISPEXEC VGET FNDSDSN SHARED


00051100         SET &RC = &LASTCC


00051200


00051300         IF &RC NE 0 THEN DO


00051400            SET &FNDSERR = &STR(SPFYFND ERROR F02)


00051500            ISPEXEC VPUT FNDSERR SHARED


00051600            GOTO ENDIT


00051700            ENDO


00051800


00051900         ISPEXEC VGET FNDSRCH SHARED


00052000         SET &RC = &LASTCC


00052100


00052200         IF &RC NE 0 THEN DO


00052300            SET &FNDSERR = &STR(SPFYFND ERROR F03)


00052400            ISPEXEC VPUT FNDSERR SHARED


00052500            GOTO ENDIT


00052600            ENDO


00052700


00052800         IF &SYSUID = &SYSPREF THEN SET &HILEVEL = &SYSPREF


00052900            ELSE SET &HILEVEL = &SYSPREF..&SYSUID


00053000


00540000/*                                                   */


00550000/*  ALLOCATE DSNAME = HILEVEL..SPFYFND.CMDIN1        */


00560000/*                                                   */


00561000


00570000         CONTROL NOMSG


00580000         FREE F(CMDIN1)


00590000         FREE ATTRLIST(AT1)


00600000         ATTR AT1 RECFM(F,B) LRECL(80) BLKSIZE(800)


00610000         ERROR DO


00620000              CONTROL MSG


00630000              ALLOC F(CMDIN1) DSN('&HILEVEL..SPFYFND.CMDIN1') NEW -


00640000              SPACE(1,1) TRACKS UNIT(SYSDA) USING(AT1)


00650000              ERROR OFF


00660000              GOTO T2


00670000              ENDO


00680000         ALLOC F(CMDIN1) DA('&HILEVEL..SPFYFND.CMDIN1') SHR


00690000         ERROR OFF


00691000


00700000/*                                                   */


00710000/*  ALLOCATE DSNAME = HILEVEL..SPFYFND.CMDOUT1 */


00720000/*                                                   */


00721000


00730000T2:      CONTROL NOMSG


00740000         FREE F(CMDOUT1)


00750000         FREE ATTRLIST(AT2)


00760000         ATTR AT2 RECFM(F,B) LRECL(80) BLKSIZE(6160)


00770000         ERROR DO


00780000              CONTROL MSG


00790000              ALLOC F(CMDOUT1) DSN('&HILEVEL..SPFYFND.CMDOUT1') NEW -


00800000              SPACE(1,1) TRACKS UNIT(SYSDA) USING(AT2)


00810000              ERROR OFF


00820000              GOTO T3


00830000              ENDO


00840000         ALLOC F(CMDOUT1) DA('&HILEVEL..SPFYFND.CMDOUT1') SHR


00850000         ERROR OFF


01539300


01560000T3:      OPENFILE CMDIN1 OUTPUT


01570000         SET &CMDIN1 = &STR(PDS '&FNDSDSN' ATTRIB :)


01580000         PUTFILE CMDIN1


01630000         CLOSFILE CMDIN1


01631000


01640000/*                                                      */


01650000/*       I N T E R C E P T   O U T P U T   O F          */


01660000/*                                                      */


01670000/*       T H E   P D S   C O M M A N D                  */


01680000/*                                                      */


01681000


01690000STACKT1: CONTROL MAIN


01700000         STACK LIST DDIN(CMDIN1) DDOUT(CMDOUT1)


01712000


01712100         CONTROL NOMSG


01712200


01712300         SET &SPFYSRCH = &STR(&FNDSRCH)


01713000         ISPEXEC VPUT SPFYSRCH SHARED


01714000         SET &SPFYSLEN = &LENGTH(&STR(&SPFYSRCH))


01715000         SET &SPFYSLEN = &SPFYSLEN + 100


01716000         SET &SPFYSLEN = &SUBSTR(2:3,&STR(&SPFYSLEN))


01716100         ISPEXEC VPUT SPFYSLEN SHARED


01716200


01716300         FREE F(CMDIN1)


01716500         FREE F(OUTFILE)


01716600         FREE ATTRLIST(ATTR1)


01716700         ATTR ATTR1 RECFM(F,B) LRECL(80) BLKSIZE(6160)


01716800         ALLOC F(OUTFILE) NEW UNIT(SYSSQ) TRACKS SPACE(9,4) USING(ATTR1)


01716900


01717009         ISPEXEC SELECT PGM(SPFYFND5)


01718000


02120000         ISPEXEC TBCREATE SPFYFND NAMES(TYPCODE SPFSTATS) NOWRITE


02130000         SET &RC = &LASTCC


02140000


02150000         IF &RC NE 0 THEN DO


02160000              SET &FNDSERR = &STR(SPFYFND ERROR F04)


02170000              ISPEXEC VPUT FNDSERR SHARED


02180000              GOTO ENDIT


02190000              ENDO


02260000


02270000         OPENFILE OUTFILE INPUT


02280000


02290000         SET &CTR = 0


02300000


02310000LOOP:    ERROR DO


02320000              SET &RC = &LASTCC


02330000              IF &RC = 400 THEN GOTO CLOS


02340000              SET &FNDSERR = &STR(SPFYFND ERROR F05)


02350000              ISPEXEC VPUT FNDSERR SHARED


02360000              GOTO CLOS


02370000              ENDO


02380000


02390000         GETFILE OUTFILE


02400000         ERROR OFF


02410000         SET &BUFFER = &STR(&OUTFILE)


02420000


02430000         SET &TYPCODE = &STR(_)


02441000         SET &SPFSTATS = &STR(&BUFFER)


02450000


02460000         ISPEXEC TBADD SPFYFND


02470000         SET &RC = &LASTCC


02480000         IF &RC NE 0 THEN DO


02490000              SET &FNDSERR = &STR(SPFYFND ERROR F06)


02500000              ISPEXEC VPUT FNDSERR SHARED


02510000              GOTO ENDIT


02520000              ENDO


02530000


02540000         SET &CTR = &CTR + 1


02550000         GOTO LOOP


02560000


02570000CLOS:    ERROR OFF


02580000         CLOSFILE OUTFILE


02590000


02600000         IF &CTR = 0 THEN DO


02610000              SET &FNDSERR = &STR(NO HITS FOUND)


02620000              ISPEXEC VPUT FNDSERR SHARED


02630000              GOTO ENDIT


02640000              ENDO


02650000


02660000         ISPEXEC TBTOP SPFYFND


02670000         SET &MSGID = &STR(FNDS100)


02680000


02690000DSPANEL: ISPEXEC TBDISPL SPFYFND PANEL(SPFYFND2) MSG(&MSGID)


02700000         SET &RC = &LASTCC


02710000


02720000         IF &RC NE 0 THEN DO


02730000              SET &FNDSERR = &STR(NO ERROR ENCOUNTERED)


02740000              ISPEXEC VPUT FNDSERR SHARED


02750000              GOTO ENDIT


02760000              ENDO


02770000


02780000         ERROR DO


02790000              ERROR OFF


02800000              SET &MSGID = &STR(FNDS101)


02810000              GOTO DSPANEL


02820000              ENDO


02830000


02840000         IF &TYPCODE = &STR(S) OR +


02850000            &TYPCODE = &STR(E) THEN DO


02860000               SET &SERVICE = &STR(EDIT)


02870000               GOTO DOIT


02880000               ENDO


02890000


02900000         IF &TYPCODE = &STR(B) THEN DO


02910000               SET &SERVICE = &STR(BROWSE)


02920000               GOTO DOIT


02930000               ENDO


02940000


02950000         ERROR OFF


02960000


02970000         SET &MSGID = &STR(FNDS101)


02980000         GOTO DSPANEL


02990000


03000000DOIT:    ERROR OFF


03001000         SET &DAMEMBER = &STR(&SUBSTR(1:8,&STR(&SPFSTATS))


03010000         SET &THEMEMBR = &SUBSTR(1:&LENGTH(&DAMEMBER),&DAMEMBER)


03020000


03021001         IF &SERVICE = BROWSE THEN ISPEXEC CONTROL ERRORS RETURN


03030000         ISPEXEC &SERVICE DATASET('&FNDSDSN(&THEMEMBR)')


03040001         SET &SERVRC = &LASTCC


03040101         IF &SERVICE NE BROWSE THEN GOTO SETTMSG


03041101         IF &SERVRC NE 0 THEN DO


03041201               SET &MSGID = &STR(FNDS102)


03041301               ISPEXEC CONTROL ERRORS CANCEL


03041401               GOTO DSPANEL


03041501               ENDO


03041601


03042001         ISPEXEC CONTROL ERRORS CANCEL


03044001


03050001SETTMSG: SET &MSGID = &STR(FNDS100)


03060000         GOTO DSPANEL


03070000


03080000ENDIT:   ISPEXEC TBEND SPFYFND


03090000         EXIT


./ ADD NAME=STATUS   0100-87118-87118-1947-00094-00094-00000-KX00150
00000100PROC 1 JOB L SHOWIT


00001000/*                                                            */


00002000/* THIS IS THE STATUS CLIST WHICH INTERFACES SMPE TO IOF      */


00003000/* COPY THE SMPEIOF PROGRAM TO THE SMPE DIALOG LOADLIB        */


00004000/* WITH NAME STATUS TO INTERCEPT THE SMPE LINK TO TSO STATUS. */


00005000/* THE PANLEXIT ROUTINE IS ALSO HELPFUL TO SUPPRESS GIMOT004  */


00005100/*                                                            */


00006000/* ADD THE FOLLOWING TO THE VIOFPCM PANEL    */


00007000/*  OF IOF (IN THE BOTTOM OF INIT SECTION):  */


00007100/*                                           */


00008000/* IF (&PJOBN ¬= &Z)                         */


00009000/*   &PJOBN = TRUNC(&PJOBN,'(')              */


00009100/*   &PJOBI = .TRAIL                         */


00009200/*   &PJOBI = TRUNC(&PJOBI,')')              */


00009300/*   IF (&PJOBI ¬= &Z)                       */


00009400/*     .RESP = ENTER                         */


00009500/*       &XXX = END                          */


00009600/*IF (&XXX ¬= &Z)                            */


00009700/*  .RESP = &XXX                             */


00009800/*                                           */


00009900/* CHANGE THE FOLLOWING IN THE GIMSM PANEL   */


00010000/*  OF SMPE (OPTIONAL TO SUPPRESS ERR MSG):  */


00010100/*                                           */


00010200/*     1,'PGM(PANLEXIT) PARM(GIMPDV)'        */


00010400/*                                           */


00010500/* ADD THE FOLLOWING TO THE GIMPDJNF PANEL   */


00010600/*  OF SMPE (IN THE BODY AND INIT SECTIONS): */


00010700/*
            */

00010800/*%                             &K1
            */

00010900/*+&K2
            */

00011000/*+&K3
            */

00011100/*&K1 = 'OUTPUT NOT AVAILABLE'
            */

00011200/*&K2 = 'THE OUTPUT OF THE LAST JOB &GGPSJOBN(&GGPSJOBI) SUBMITTED BY TH
IS DIALOG'  */

00011300/*&K3 = 'CANNOT BE PROCESSED BECAUSE OF THE ABOVE REASON.'
            */

00011400/*IF (&KSMPREAL ¬= &Z)
            */

00011500/*   &K1 = 'INDICATE JOB RESULTS'
            */

00011600/*   &K2 = 'CHOOSE ONE OF THE OPTIONS BELOW ACCORDING TO THE RESULTS OF'
            */

00011700/*   &K3 = 'JOB &GGPSJOBN(&GGPSJOBI)'
            */

00011800/*   &GPML = ' '
            */

00011900/*   &PANLEXIT = 'SETMSG MSG(GPM002)'
            */

00012000/*
            */

00012100CONTROL END(ENDO) NOMSG


00012200IF &L = L THEN CONTROL END(ENDO) LIST MSG CONLIST


00012300IF &SHOWIT = SHOWIT THEN +


00012400  DO


00012500  SET VIOFJOBN = &JOB


00012600  ISPEXEC VPUT (VIOFJOBN) SHARED


00012700  IF &L NE L THEN +


00012800    ISPEXEC SELECT PGM(CLRSPFIO)


00012900  ISPEXEC SELECT PGM(IOFSPF) PARM(I.)


00013000  EXIT


00013100  ENDO


00013200ISPEXEC CONTROL DISPLAY LINE START(17)


00014000WRITE CHECKING INPUT QUEUE


00080000IOF &JOB CLIST I


00090000SET IRC2 = &LASTCC


00100000IF &IRC2 = 0 THEN +


00110000  DO


00111000  END


00112000  END


00120000  SET KSMPSTAT = IKJ56197I JOB &JOB WAITING FOR EXECUTION


00130000  ISPEXEC VPUT KSMPSTAT SHARED


00130100  ISPEXEC SELECT PGM(CLRSPFIO)


00131000  EXIT


00140000  ENDO


00141000WRITE CHECKING EXECUTION QUEUE


00150000IOF &JOB CLIST R


00160000SET IRC3 = &LASTCC


00170000IF &IRC3 = 0 THEN +


00180000  DO


00190000  END


00200000  END


00210000  SET KSMPSTAT = IKJ56211I JOB &JOB EXECUTING


00220000  ISPEXEC VPUT KSMPSTAT SHARED


00220100  ISPEXEC SELECT PGM(CLRSPFIO)


00221000  EXIT


00230000  ENDO


00230200WRITE CHECKING OUTPUT QUEUE


00231000SET KSMPREAL = ITSTHERE


00231100SET KSMPSTAT = IKJ56202I JOB &JOB NOT FOUND


00232000ISPEXEC VPUT (KSMPSTAT KSMPREAL) SHARED


00240000IOF &JOB CLIST


00250000SET IRC1 = &LASTCC


00260000IF &IRC1 = 1503 THEN +


00270000  DO


00271000  SET KSMPREAL =


00280000  SET KSMPSTAT = IKJ56202I JOB &JOB NOT FOUND


00290000  ISPEXEC VPUT (KSMPSTAT KSMPREAL) SHARED


00291000  ISPEXEC SELECT PGM(CLRSPFIO)


00300000  ENDO


00301000END


00302000END


00312100/* NOW CHANGE APPLID TO CALL IOF ALLOWING SPLIT SCREEN  */


00313000ISPEXEC SELECT CMD(%STATUS &JOB SHOWIT) NEWAPPL(IOF)


./ ADD NAME=STRIP    0133-86251-86266-1316-00065-00046-00000-CG00150
        PROC 0


        /*clist**************************************************


        /* STRIP will strip all leading and/or trailing blanks  *


        /* FROM A STRING.  THE PARM VARIABLE SPECIFIES THE      *


        /* END(S) OF A STRING TO BE STRIPPED OF BLANKS.  THE    *


        /* PARM variable may be L (leading), T (trailing), or B *


        /* (both).  STRING and PARM must be passed to strip by  *


        /* the statement ISPEXEC VPUT (STRING,PARM) SHARED.  A  *


        /* variable STRSIZE will be created and passed back in  *


        /* place of PARM, which will contain the length of the  *


        /* string after stripping is complete.                  *


        /********************************************************


        CONTROL NOMSG


        /*CONTROL LIST CONLIST SYMLIST





        GETMY SYSID


        IF &SYSID = H3AN THEN SET TYPSTR = &&STR


        IF &SYSID NE H3AN THEN SET TYPSTR = &&NRSTR





        ISPEXEC VGET (STRING,PARM) SHARED


        SET STRSIZE  = &LENGTH(&TYPSTR(&STRING))


  /*cg  SET STRSIZE  = &LENGTH(&STR(&STRING))


        SET FRSTCHAR = 1


        SET LASTCHAR = &STRSIZE





        IF &PARM = &STR(L) OR &PARM = &STR(B) THEN +


          DO


            /* STRIP OUT LEADING BLANKS */


            SET &CHAR = &SUBSTR(1,&TYPSTR(&STRING))


    /*cg    SET &CHAR = &SUBSTR(1,&STRING)


            SET &CHARPOS = 1


            DO WHILE &TYPSTR(&CHAR) = &STR( ) AND &CHARPOS < &STRSIZE


       /*cg DO WHILE &STR(&CHAR) = &STR( ) AND &CHARPOS < &STRSIZE


              SET CHARPOS = &CHARPOS+1


              SET &CHAR = &SUBSTR(&CHARPOS,&TYPSTR(&STRING))


      /*cg    SET &CHAR = &SUBSTR(&CHARPOS,&STRING)


            END


            SET FRSTCHAR = &CHARPOS


          END





        IF &PARM = &STR(T) OR &PARM = &STR(B) THEN +


          DO


            /* STRIP OUT TRAILING BLANKS */


            SET &CHAR = &SUBSTR(&STRSIZE,&TYPSTR(&STRING))


 /*cg       SET &CHAR = &SUBSTR(&STRSIZE,&STRING)


            SET &CHARPOS = &STRSIZE


            DO WHILE &TYPSTR(&CHAR) = &STR( ) AND &CHARPOS > 1


   /*cg     DO WHILE &STR(&CHAR) = &STR( ) AND &CHARPOS > 1


              SET CHARPOS = &CHARPOS-1


              SET &CHAR = &SUBSTR(&CHARPOS,&TYPSTR(&STRING))


   /*cg       SET &CHAR = &SUBSTR(&CHARPOS,&STRING)


            END


            SET LASTCHAR = &CHARPOS


          END





        /* EXTRACT THE STRIPPED STRING */


        IF &LENGTH(&TYPSTR(&STRING)) = 0 THEN EXIT   /*CLIFF


  /*cg  IF &LENGTH(&STR(&STRING))  = 0 THEN EXIT   /*CLIFF


        SET STRING  = &SUBSTR(&FRSTCHAR:&LASTCHAR,&TYPSTR(&STRING))


  /*cg  SET STRING  = &SUBSTR(&FRSTCHAR:&LASTCHAR,&STRING)


        SET STRSIZE = &LENGTH(&TYPSTR(&STRING))


  /*cg  SET STRSIZE = &LENGTH(&STR(&STRING))





        ISPEXEC VPUT (STRING,STRSIZE) SHARED


        EXIT


./ ADD NAME=UNCLIB   0106-81209-85137-1437-00050-00044-00000-JS02150
                PROC 1 DSN PRINT()


                CONTROL NOMSG NOFLUSH END(ENDO)





                ERROR OFF





                FILEINFO DSN(&STR(&DSN))


                SET &RC = &LASTCC





                IF &RC EQ 96 THEN DO


                    WRITE


                    WRITE ERROR ===> INVALID SYNTAX OF DSNAME


                    GOTO ENDIT


                    ENDO





                IF &RC NE 0 THEN DO


                    WRITE


                    WRITE ERROR ===> &OUTMSG


                    GOTO ENDIT


                    ENDO





                IF &DSORG NE PO THEN DO


                    WRITE


                    WRITE ERROR ===> DATASET TO BE CONCATENATED IS NOT


                    WRITE            PARTITIONED DATASET


                    GOTO ENDIT


                    ENDO





                IF &MEMCNTL EQ YES THEN DO


                    WRITE


                    WRITE ERROR ===> DO NOT PROVIDE MEMBER NAME


                    GOTO ENDIT


                    ENDO





                IF &RECFM NE V THEN DO


                    WRITE


                    WRITE ERROR ===> &FULLDSN MUST CONTAIN


                    WRITE            VARIABLE LENGTH RECORDS


                    GOTO ENDIT


                    ENDO





                CONCATEM ACTCODE(D) DDNAME(SYSPROC) DSNAME('&FULLDSN')


                SET &RC = &LASTCC





                IF &PRINT = NO THEN GOTO ENDIT





                WRITE


                WRITE &OUTMSG


                WRITE        (RETURN CODE = &RC)





         ENDIT: EXIT


./ ADD NAME=UNNUM    0104-77018-78214-0931-00014-00015-00011-KK00150
00000100PROC 1 DSN


00000200CONTROL NOMSG MAIN END(ENDO)


00000400FREE F(INOUT)


00000502CONTROL MSG


00000602ALLOC F(INOUT) DA(&DSN.)


00000702OPENFILE INOUT UPDATE


00000903ERROR DO


00001003       CLOSFILE INOUT


00001103       EXIT


00001203      ENDO


00001303LOOP: GETFILE INOUT


00001403SET INOUT = &SUBSTR(9:&LENGTH(&INOUT.),&INOUT.)


00001503PUTFILE INOUT


00001603GOTO LOOP


./ ADD NAME=VSSE     0104-85206-85280-1432-00038-00036-00004-KK00150
00010004PROC 0 SS(USER.TSO.GDDM.SYMBOLS) L NC VOL(NONE) SSN(ADMDVSS) F


00020000CONTROL NOFLUSH END(ENDO) NOMSG


00030000IF &L = L THEN CONTROL MSG LIST CONLIST


00031002IF &SYSPROC = TEST AND &SS EQ &STR(USER.TSO.GDDMR3.SYMBOLS) THEN +


00032004   SET &SS = &STR(USER.TSO.GDDM.SYMBOLS)


00040000IF &F = F THEN FREE F(ADMSYMBL)


00080000IFALC F(ADMSYMBL) DA(&SS)


00090000IF &LASTCC = 0 THEN GOTO CALLM


00091000IFALC F(ADMSYMBL) DA('&SS')


00092000IF &LASTCC = 0 THEN GOTO CALLM


00100000IFALC F(ADMSYMBL)


00101000IF &LASTCC = 0 THEN FREE F(ADMSYMBL)


00450000DATASTAT &SS


00451000IF &LASTCC NE 0 THEN DO


00452000       DATASTAT '&SS'


00452100       SET DRC = &LASTCC


00453000       IF &DRC    NE 0 THEN DO


00453100          WRITE DATASTAT RC IS &DRC


00453200          WRITE SYMBOL SET LIBRARY CANNOT BE ALLOCATED : &SS


00453300          WRITE PLEASE CHECK YOUR SS NAME.


00453400          EXIT


00454000                            ENDO


00455000       SET &SS = &STR('&SS')


00456000                     ENDO


00460000ALLOC F(ADMSYMBL) DA(&SS)


00460100       SET ARC = &LASTCC


00461000       IF &ARC    NE 0 THEN DO


00461100          WRITE ALLOC RC IS &ARC


00462000          WRITE SYMBOL SET LIBRARY CANNOT BE ALLOCATED :


00463000          WRITE PLEASE CHECK YOUR SS NAME.


00464000          EXIT


00465000                            ENDO


00630000CALLM: +


00631000  IF &NC = NC THEN EXIT


00640002  IF &SYSPROC = TEST THEN +


00650000               CALL 'WDPSC.GDDMR4.GDDMLOAD(ADMVSSE)' '&SSN'


00661000                     ELSE +


00670000               CALL 'WDPSC.GDDM.GDDMLOAD(ADMVSSE)' '&SSN'


./ ADD NAME=WATDSN   0113-80276-85113-1616-00008-00007-00000-JS02150
                PROC 1 DDNAME


                CONTROL NOFLUSH NOMSG END(ENDO)


                FREE F(SYSOUT)


                ALLOC F(SYSOUT) DSN(*)


                WRITE


                IF &LENGTH(&STR(&DDNAME)) LT 8 THEN +


                    SET &DDNAME = &STR(&DDNAME&SUBSTR(1:8-&LENGTH(&DDNAME),
    )

                CALL 'WDPSC.SHARED.LOAD(WATDSN)' '&STR(&DDNAME)'


./ ADD NAME=WHOISI   0127-81238-87071-1503-00031-00034-00031-LS02150
00010015            CONTROL NOMSG NOFLUSH END(ENDO)


00010516


00010617            ISPEXEC SELECT PGM(PASSDEST)


00010717            ISPEXEC VGET DEFDEST


00010817


00010917            WHATDSN DDNAME(STEPCAT)


00011015            SET &CAT = &DSNAME


00012015


00012420            GETMY PROG SYS ACCT TERMID


00018815


00019015            FREE F(SYSOUT)


00019115            ALLOC F(SYSOUT) UNIT(SYSSQ) NEW


00019519            CALL 'WDPSC.SHARED.LOAD(WATDSN)' 'STEPLIB '


00019615


00019815            OPENFILE SYSOUT


00019915            GETFILE SYSOUT


00020015            IF &SUBSTR(2:7,&SYSOUT) NE &STR(DDNAME)THEN DO


00020115                SET &SLIBDSN1 = &STR(********************************)


00020215                SET &SLIBDSN2 = &STR(* DDNAME STEPLIB NOT ALLOCATED *)


00020315                SET &SLIBDSN3 = &STR(********************************)


00020415                GOTO DOIT


00020515                ENDO


00020615


00020715            SET &SLIBDSN1 = &SUBSTR(28:71,&SYSOUT)


00020815            GETFILE SYSOUT


00020915            SET &SLIBDSN2 = &SUBSTR(28:71,&SYSOUT)


00021015            GETFILE SYSOUT


00021115            SET &SLIBDSN3 = &SUBSTR(28:71,&SYSOUT)


00021215            CLOSFILE SYSOUT


00022015


00030015 DOIT:      ISPEXEC DISPLAY PANEL(WHOISI)


