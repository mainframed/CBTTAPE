//XSDMNDMX JOB MSGCLASS=X,CLASS=A,NOTIFY=XSDMN
//*
//SAS     EXEC   SAS609,OPTIONS=NODATE
//DATLIB  DD DSN=SMFDUMP.D99046,DISP=SHR
//OUTLIB  DD DSN=XSDMN.SMFDUMPW,DISP=OLD
//*UTLIB  DD SYSOUT=*
//SYSIN   DD *
TITLE SMF EXTRACT;
  DATA _NULL_;
  RETAIN V SLNO 74 ;
  INFILE DATLIB JFCB=JF START=S;
    FILE OUTLIB;
  IF _N_ = 1 THEN DO;
                  INPUT @;
                  IF INDEX(JF,'SYS1.MAN') Â¬=0 THEN V=4; ELSE V=0;
                  END;
  IF V=4 THEN
      INPUT    SMFXXLEN PIB2. SMFXXSEG PIB2. @ ;
  INPUT    SMFXXFLG PIB1. SMFXXRTY PIB1.
                       @;
  IF SMFXXRTY = 212 THEN DO;
                        *PUT '212 DETECTED - SKIPPING';
                         DELETE;
                         END;
  INPUT    TIMEOUT SMFSTAMP8.
      SMFXXSID $CHAR4. @;
  IF SMFXXRTY  = SLNO;
    S=V+1;
  * IF DATEPART(TIMEOUT) > '23JAN90'D;
    PUT   _INFILE_;
RETURN;
