//E0115DMS JOB EDPCSBS1,'SASD',MSGCLASS=X,CLASS=0,NOTIFY=ED115DM
//*
//SAS     EXEC SAS,OPTIONS=NODATE
//DATLIB  DD DSN=SYS1.MAN2,DISP=SHR
//SYSIN   DD *
TITLE SMF V35;
  DATA;
  RETAIN V;
  INFILE DATLIB JFCB=JF MISSOVER;
  IF _N_ = 1 THEN DO;
                  INPUT @;
                  IF INDEX(JF,'SYS1.MAN') ¬=0 THEN V=4; ELSE V=0;
                  END;
  IF V=4 THEN
      INPUT    SMFXXLEN PIB2. SMFXXSEG PIB2. @ ;
  INPUT    SMFXXFLG PIB1. SMFXXRTY PIB1.
                       @;
  IF SMFXXRTY = 212 THEN DO;
                        *PUT '212 DETECTED - SKIPPING';
                         DELETE;
                         END;
  INPUT    TIMEOUT SMFSTAMP8.
      SMFXXSID $CHAR4. @;
  IF SMFXXRTY ¬= 35 THEN RETURN;
    PUT    SMFXXLEN +2    SMFXXSEG +2
       SMFXXFLG +2    SMFXXRTY @25   TIMEOUT DATETIME. +2
      SMFXXSID  ;
      INPUT TLGUIF $CHAR8. TLGONDT SMFSTAMP8.
      TLGUDATA $CHAR8.  TLGSTPCT PIB1.
      TLGCRTME PIB4.    TLGOUTCT PIB4.
      TLGINCT  PIB4.    TLGSTAT  PIB2.
      TLGPRI   PIB1.    TLGNQDT  SMFSTAMP8.
      TLGTRMI  PIB1.    TLGOUTCL PIB1. TLGTRANT PIB4.
      TLGRVC   PIB4.    TLGSPK   PIB1.
      TLGSRBT  PIB3.    TLGTJS   PIB4.
      TLGTTAT  PIB4.    TLGNTSN  PIB4.
      TLGPGNO  PIB2.    TLGRV2   PIB2.
      TLGVAR   PIB1.    TLGRVB   $CHAR20.
      TLGCPUTM PIB3.    TLGNBRAC PIB1.
       @;
        PUT TLGUIF +1      TLGONDT DATETIME. +1
      TLGUDATA +1       TLGSTPCT +1
      TLGCRTME +1       TLGOUTCT +1
      TLGINCT  +1       TLGSTAT  +1
      TLGPRI   +1       TLGNQDT  DATETIME. +1
      TLGTRMI  +1       TLGOUTCL +1 TLGTRANT +1
      TLGRVC   +1       TLGSPK   +1
      TLGSRBT  +1       TLGTJS   +1
      TLGTTAT  +1       TLGNTSN  +1
      TLGPGNO  +1       TLGRV2   +1
      TLGVAR   +1       TLGRVB   +1
      TLGCPUTM +1       TLGNBRAC
         ;
        NAC  = TLGNBRAC;
   IF NAC  > 0 THEN
   DO I = 0 TO (NAC -1);
      INPUT  ACFLD   PIB1.  @;
        PUT  ACFLD   +2      ;
   IF ACFLD > 0 THEN
   DO I = 0 TO (ACFLD -1);
      INPUT  ACFLDX $CHAR1. @;
        PUT  ACFLDX    @ ;
   END;
   PUT;
   END;
