PROC 1 OPT DEBUG
CONTROL NOLIST NOMSG NOFLUSH PROMPT
IF &DEBUG NE &STR() THEN +
  CONTROL LIST MSG NOFLUSH PROMPT CONLIST SYMLIST
ISPEXEC CONTROL ERRORS RETURN
SET &SRCINIT EQ &STR()
SET &PCLS EQ &STR()
SET &USRC EQ &STR()
SET &UFMT EQ &STR()
SET &UPNL EQ &STR()
SET &MODPNL EQ &STR()
SET &DSSUFX EQ &STR()
IF &OPT EQ 1 THEN +
  SET &DSSUFX EQ 5
ELSE +
  IF &OPT EQ 2 THEN +
    SET &DSSUFX EQ 6
  ELSE +
    IF &OPT EQ 3 THEN +
      SET &DSSUFX EQ 7
IF &DEBUG EQ &STR() THEN +
  CONTROL NOMSG
FREE F(BLGPNLS,BLGFMT,BLGSRC,BLGSD5,BLGSI5,BLGSL5,BLGMPNL)
IF &DEBUG EQ &STR() THEN +
  CONTROL MSG
RESTART: +
SET &ICLASS EQ &STR()
SET &ISRC EQ &STR()
ISPEXEC DISPLAY PANEL(INFOMGT1)
IF &LASTCC EQ 8 THEN +
  EXIT
GOTO NOMVS
IF &SYSUID EQ &STR(T27611) | +
   &SYSUID EQ &STR(T32809) | +
   &SYSUID EQ &STR(T40839) | +
   &SYSUID EQ &STR(T53031) | +
   &SYSUID EQ &STR(T53039) | +
   &SYSUID EQ &STR(T60403) | +
   &SYSUID EQ &STR(T53043) | +
   &SYSUID EQ &STR(T26568) | +
   &SYSUID EQ &STR(T53093) THEN +
     DO
       IF &DEBUG EQ &STR() THEN +
         CONTROL NOMSG
       FREE F(VSAM,VSAM2,VSAM3,VSAM4,VSAM5,VSAM6)
       IF &DEBUG EQ &STR() THEN +
         CONTROL MSG
       ALLOC F(VSAM) DA('SYS1.BLGOZS.VSAM') SHR
       ALLOC F(VSAM2) DA('SYS1.BLGOZS.VSAM2') SHR
       ALLOC F(VSAM3) DA('SYS1.BLGOZS.VSAM3') SHR
       ALLOC F(VSAM4) DA('SYS1.BLGOZS.VSAM4') SHR
       ALLOC F(VSAM5) DA('SYS1.BLGOZS.VSAM5') SHR
       IF &SYSUID EQ &STR(T27611) THEN +
         ALLOC F(VSAM6) DA('MVSP.SHARE.OZ') SHR
     END
NOMVS: +
IF &SYSUID EQ &STR(T27611) THEN +
  ALLOC F(VSAM6) DA('MVSP.SHARE.OZ') SHR
IF &SRCINIT NE &STR() THEN +
  DO
    SET &ISRC EQ &STR(SRC(&SRCINIT))
  END
IF &PCLS NE &STR() THEN +
  DO
    SET &ICLASS EQ &STR(CLASS(&PCLS))
  END
IF &USRC EQ &STR() THEN +
  ALLOC F(BLGSRC) DA('TSO.INFO.BLGSRC') SHR
ELSE +
  ALLOC F(BLGSRC) DA('&USRC') SHR
IF &UFMT EQ &STR() THEN +
  ALLOC F(BLGFMT) DA('TSO.INFO.BLGFMT','INFO.BLGFMT') SHR
ELSE +
  ALLOC F(BLGFMT) DA('&UFMT','TSO.INFO.BLGFMT','INFO.BLGFMT') SHR
IF &UPNL EQ &STR() THEN +
  ALLOC F(BLGPNLS) DA('TSO.INFO.BLGPNLS','INFO.BLGPNLS') SHR
ELSE +
  ALLOC F(BLGPNLS) DA('&UPNL','TSO.INFO.BLGPNLS','INFO.BLGPNLS') SHR
IF &MODPNL NE &STR() THEN +
  ALLOC F(BLGMPNL) DA('&MODPNL') SHR
ALLOC F(BLGSD5) DA('INFO.BLGDB.SDDS&DSSUFX') SHR
ALLOC F(BLGSI5) DA('INFO.BLGDB.SDIDS&DSSUFX') SHR
IF &DSSUFX NE 7 THEN +
  ALLOC F(BLGSL5) DA('INFO.BLGDB.SDLDS&DSSUFX') SHR
INFO &ICLASS &ISRC
ISPEXEC CONTROL DISPLAY REFRESH
IF &DEBUG EQ &STR() THEN +
  CONTROL NOMSG
FREE F(BLGPNLS,BLGFMT,BLGSRC,BLGSD5,BLGSI5,BLGSL5,BLGMPNL,VSAM,VSAM2)
FREE F(VSAM3,VSAM4,VSAM5,VSAM6)
IF &DEBUG EQ &STR() THEN +
  CONTROL MSG
GOTO RESTART
END
