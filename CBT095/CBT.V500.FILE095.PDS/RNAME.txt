 ISREDIT MACRO (OLDMEM,NEWMEM,NO)
 SET &RNAM =
 IF &OLDMEM = ? THEN DO
 ISPEXEC DISPLAY PANEL(RNAME)
 EXIT CODE(1)
 END
 IF &NEWMEM =  THEN DO
           SET ZEDSMSG = &STR(NO NEWNAME SPECIFIED)
             SET ZEDLMSG = &STR(PROPER SYNTAX FOR RNAME: RNAME OLDNAM+
                               E NEWNAME)
           ISPEXEC SETMSG MSG(ISRZ001)
           EXIT CODE(12)
 END
 ISREDIT (WORKDSN) = DATASET
SET  PDSDSN = &WORKDSN

/* INITIALIZE DATASET */
ISPEXEC  LMINIT DATAID(PDSID) DATASET('&PDSDSN') +
                ENQ(SHRW)                        +
                ORG(PDSORG)
SET LMRC = &LASTCC
IF &LMRC ¬= 0 THEN +
   DO
      WRITE LMINIT FAILED - RETURN CODE &LMRC
      WRITE DATA SET IS NOT ALLOCATED OR NOT PARTITIONED
      EXIT CODE(8)
   END
 IF &NO = NO THEN GOTO BYPASS
WRITE  '&WORKDSN(&OLDMEM)' SELECTED FOR RENAME
/* OPEN DATA SET */
BYPASS: +
ISPEXEC LMOPEN DATAID(&PDSID) OPTION(OUTPUT)
SET RET1 = &LASTCC
IF &RET1 ¬= 0 THEN GOTO EXIT1
 IF &NO = NO THEN GOTO BYPASS2
WRITE CONFIRM RENAME OF &OLDMEM TO &NEWMEM (Y/N)
WRITENR ==>
READ &RNAM
IF &SUBSTR(1:1,&STR(&RNAM)) ¬= Y THEN GOTO EXIT1
BYPASS2: +
ISPEXEC LMMREN DATAID(&PDSID) MEMBER(&OLDMEM) NEWNAME(&NEWMEM)
SET LMRC = &LASTCC
IF &LMRC ¬= 0 THEN GOTO EXIT1
           SET ZEDSMSG = &STR(&OLDMEM NOW &NEWMEM)
             SET ZEDLMSG = &STR(&OLDMEM RENAMED &NEWMEM)
           ISPEXEC SETMSG MSG(ISRZ001)
ISPEXEC LMCLOSE DATAID(&PDSID)
ISPEXEC LMFREE DATAID(&PDSID)
EXIT
EXIT1: +
IF &LMRC = 8 THEN +
   DO
           SET ZEDSMSG = &STR(&OLDMEM NOT FOUND)
             SET ZEDLMSG = &STR(&OLDMEM NOT FOUND IN &PDSDSN)
           ISPEXEC SETMSG MSG(ISRZ001)
           GOTO EXIT2
 END
 WRITE '&PDSDSN(&OLDMEM)' NOT RENAMED
EXIT2: +
ISPEXEC LMCLOSE DATAID(&PDSID)
ISPEXEC LMFREE DATAID(&PDSID)
EXIT
ISPEXEC LMCLOSE DATAID(&PDSID)
ISPEXEC LMFREE DATAID(&PDSID)

