 ISREDIT MACRO (HELP) NOPROCESS
 ISREDIT (WORKDSN) = DATASET
 ISREDIT (MEMBER) = MEMBER
 IF &HELP = ? THEN DO
 ISPEXEC DISPLAY PANEL(MSTATS)
 EXIT
 END
SET  PDSDSN = &WORKDSN
  ISREDIT PROCESS DEST
  SET &RC = &LASTCC
     IF &RC = 8 THEN DO
         SET ZEDSMSG = &STR(INDICATE POSITION)
  SET ZEDLMSG = &STR(MARK 'A' OR "B" ON LINE WHERE STAT LINE +
                            SHOULD BE INSERTED)
     ISPEXEC SETMSG MSG(ISRZ000)
      EXIT CODE(4)
     END
  IF &LASTCC = 0 THEN DO
  ISREDIT LOCATE .ZDEST
  SET &RC = &LASTCC
  IF &RC = 8 THEN +
     DO
           SET ZEDSMSG = &STR(EMPTY DATA SET )
        SET ZEDLMSG = &STR($STAS WORKS ONLY WHEN DATA SET HAS VALID +
                                 DATA AND LINE NUMBERS)
           ISPEXEC SETMSG MSG(ISRZ001)
         EXIT CODE(12)
   END


/* INITIALIZE DATASET */
ISPEXEC  LMINIT DATAID(PDSID) DATASET('&PDSDSN') +
                ENQ(SHRW)                        +
                ORG(PDSORG)
SET LMRC = &LASTCC
IF &LMRC Â¬= 0 THEN +
   DO
      WRITE LMINIT FAILED - RETURN CODE &LMRC
      WRITE DATA SET IS NOT ALLOCATED OR NOT PARTITIONED
      EXIT CODE(8)
   END

/* OPEN DATA SET */
ISPEXEC LMOPEN DATAID(&PDSID) OPTION(INPUT)
SET LMRC = &LASTCC

/* CALL EDIT WITH EACH MEMBER OF THE DATA SET AND SPECIFY THE */
/* INITIAL EDIT MACRO.                                        */
  /* BUILD MEMBER LIST AND RETURN NEXT MEMBER */
  ISPEXEC LMMFIND DATAID(&PDSID) -
        MEMBER(&MEMBER) -
        STATS(YES)
SET &P = &STR(.)
SET &M1 = &STR(&MEMBER)
SETIT: +
IF &LENGTH(&M1) LT 8 THEN DO
 SET &M1 = &STR(&M1&STR(_))
 GOTO SETIT
 END
SET &ST =+
&STR(&M1)&STR(          &ZLVERS&P&ZLMOD &ZLCDATE +
&ZLMDATE &ZLMTIME &ZLCNORC+
 &ZLINORC &ZLMNORC &ZLUSER)
SET &S1 = &STR( +
 NAME             VV.MM  CREATED     CHANGED     SIZE INIT   MOD   +
   ID)
       SET &TLINE = &STR(MSGLINE "&S1")
       SET &LLINE = &STR(MSGLINE "&ST")
       ISREDIT LINE_AFTER .ZDEST = &LLINE
       ISREDIT LINE_AFTER .ZDEST = &TLINE
 END
/* FREE MEMBER LIST */
ISPEXEC LMMLIST DATAID(&PDSID) OPTION(FREE)
/* CLOSE DATA SET */
ISPEXEC LMCLOSE DATAID(&PDSID)
/* FREE DATA ID */
ISPEXEC LMFREE  DATAID(&PDSID)


EXIT CODE(0)
