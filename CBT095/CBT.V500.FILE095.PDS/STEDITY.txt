ISREDIT MACRO                                                           0000000
                         /* ANOTHER FINE EDIT MACRO */
                             /* BROUGHT TO YOU */
                        /* BY YOUR TECHNICAL SUPPORT */
                                  /* STAFF */
  ISPEXEC VGET TARGETDD PROFILE
  ISREDIT EXCLUDE ALL                                                   0000000
  ISREDIT LINE_AFTER .ZLAST = '> OUTPUT FROM TSO COMMAND : &CMDNAME <'  0000000
  CONTROL ASIS
  SET &I = 1                                                            0000000
  SET &SYSOUTTRAP = 400                                                 0000000
  TSOEXEC LISTA ST                                                      0000000
  SET &BOT = &SYSOUTLINE                                                0000000
  DO WHILE &BOT >= &I                                                   0000000
     SET &TEMP = &&SYSOUTLINE&I                                         0000000
     ISREDIT LINE_AFTER .ZLAST = "&TEMP"                                0000000
     SET &I = &I + 1                                                    0000000
  END                                                                   0000000
      ISPEXEC VPUT (DSN1 DSN2 DSN3 DSN4 DSN5 +
            DSN6 DSN7 DSN8 DSN9 DSN10 DSN11 DSN12) SHARED
  SET LEN1 = &LENGTH(&TARGETDD)
  ISREDIT (I)  = LINENUM .ZF
  ISREDIT (LR)  = LINENUM .ZL
  ISREDIT (LB,RB) = BOUNDS
  ISREDIT C '           ' '' 1 ALL
  ISREDIT C '  ' '$$' 1 ALL
  DO WHILE (&I <= &LR)
    ISREDIT (RECX) = LINE &I
    IF &SUBSTR(3:&LEN1+3,&STR(&RECX)) = &STR(&TARGETDD) THEN DO
    SET I = &I - 1
    GOTO REALCODE
    END
    SET RECB = &STR(&RECX)
    SET I = &I + 1
  END
REALCODE: +
SET &INDX = 1
    ISREDIT (RECX&INDX) = LINE &I
    SET DSN1    = &STR(&RECB)
    ISPEXEC VPUT (DSN1) SHARED
SET &I = &I +2
DO WHILE (&I <   &LR)
    ISREDIT (RECX) = LINE &I
    IF &SUBSTR(1:2,&STR(&RECX)) = &STR($$) THEN DO
    GOTO PUTIT
    END

    IF &SUBSTR(1:4,&STR(&RECX)) = &STR(KEEP) THEN GOTO NOGO
    SET &INDX = &INDX + 1
    ISREDIT (RECX&INDX) = LINE &I
    SET DSN&INDX = &STR(&RECX&INDX)
    ISPEXEC VPUT (DSN&INDX) SHARED
NOGO: +
    SET &I = &I + 1
     END
PUTIT: +
    SET DSN&INDX =
    ISPEXEC VPUT (DSN&INDX) SHARED
     IF &DEBUG = DEBUG THEN DO
     GOTO PREDISPL
     END
     CONTROL CAPS NOFLUSH   MSG
PREDISPL: ISPEXEC VGET (DSN1 DSN2 DSN3 DSN4 DSN5 +
            DSN6 DSN7 DSN8 DSN9 DSN10 DSN11 DSN12) SHARED
DISPLAY: ISPEXEC DISPLAY PANEL(FMEMD02) CURSOR(&CURPOS)
      IF &LASTCC = 8 THEN GOTO FINIS
COMMANDS: +
 ISPEXEC VGET HAVECMD PROFILE
   IF &HAVECMD ¬=  THEN DO
     IF &MEM ¬= THEN DO
       SET &DOMEM =&STR((&STR(&MEM)&STR())
        END
   ISPEXEC VGET (WKDSN,WKCMD) PROFILE
      IF &SUBSTR(1:1,&WKCMD) = E THEN DO
    ISPEXEC EDIT DATASET('&WKDSN&DOMEM')
    END
      IF &SUBSTR(1:1,&WKCMD) = B THEN DO
    ISPEXEC BROWSE DATASET('&WKDSN&DOMEM')
    END
      IF &SUBSTR(1:1,&WKCMD) = P THEN DO
    PDS '&WKDSN'
    END
      IF &SUBSTR(1:1,&WKCMD) = F THEN DO
            FREE DSNAME('&WKDSN&DOMEM')  KEEP
    END
    SET &DOMEM =
    GOTO DISPLAY
    END
      SET &SYSDVAL = &STR()
      READDVAL FM1 FM2 FM3 FM4 FM5 +
          FM6 FM7 FM8 FM9 FM10 FM11 FM12
      ISPEXEC VPUT (DSN1 DSN2 DSN3 DSN4 DSN5 +
            DSN6 DSN7 DSN8 DSN9 DSN10 DSN11 DSN12) SHARED
   IF &DSN1  ¬= THEN DO
   LISTDSI '&DSN1'
   SET &BS1  = &SYSBLKSIZE
   END
   IF &DSN2  ¬= THEN DO
   LISTDSI '&DSN2'
   SET &BS2  = &SYSBLKSIZE
   END
   IF &DSN3  ¬= THEN DO
   LISTDSI '&DSN3'
   SET &BS3  = &SYSBLKSIZE
   END
   IF &DSN4  ¬= THEN DO
   LISTDSI '&DSN4'
   SET &BS4  = &SYSBLKSIZE
   END
   IF &DSN5  ¬= THEN DO
   LISTDSI '&DSN5'
   SET &BS5  = &SYSBLKSIZE
   END
   IF &DSN6  ¬= THEN DO
   LISTDSI '&DSN6'
   SET &BS6  = &SYSBLKSIZE
   END
   IF &DSN7  ¬= THEN DO
   LISTDSI '&DSN7'
   SET &BS7  = &SYSBLKSIZE
   END
   IF &DSN8  ¬= THEN DO
   LISTDSI '&DSN8'
   SET &BS8  = &SYSBLKSIZE
   END
   IF &DSN9  ¬= THEN DO
   LISTDSI '&DSN9'
   SET &BS9  = &SYSBLKSIZE
   END
   IF &DSN10 ¬= THEN DO
   LISTDSI '&DSN10'
   SET &BS10 = &SYSBLKSIZE
   END
   IF &DSN11 ¬= THEN DO
   LISTDSI '&DSN11'
   SET &BS11 = &SYSBLKSIZE
   END
   IF &DSN12 ¬= THEN DO
   LISTDSI '&DSN12'
   SET &BS12 = &SYSBLKSIZE
   END
    SET &CURPOS = MEM

      SET &FOUND = &STR(NOO)
      SET &DNUM = 0
DO WHILE &DNUM < 12
 SET &DNUM = &DNUM + 1
 SET &CURDSN = &STR(&&DSN&DNUM)
 SET &DLEN = &LENGTH(&CURDSN)
 IF &DLEN > 0 THEN DO
       SET &PDSNAME = &CURDSN

     LISTDSI '&PDSNAME' NODIRECTORY
     SET &LISTDSI_RC = &LASTCC
     IF  &LISTDSI_RC ¬= 0 THEN DO
      SET &CURPOS = &DSN&DNUM
      SET ZEDSMSG = &STR(INVALID NAME)
      SET ZEDLMSG = &STR(TSO DATA SET &PDSNAME IS NOT A +
              CATALOGED DATA SET NAME)
      ISPEXEC SETMSG MSG(ISRZ001)
      GOTO DISPLAY
      END
     IF &SYSDSORG ¬= PO THEN DO
      SET &CURPOS = &DSN&DNUM
      SET ZEDSMSG = &STR(NOT A PDS)
      SET ZEDLMSG = &STR(TSO DATA SET &PDSNAME IS NOT A +
              PARTITIONED DATA SET NAME)
      ISPEXEC SETMSG MSG(ISRZ001)
      GOTO DISPLAY
      END
     SET &DLEN =&LENGTH(&MEM)
     FREE DD(PDSFILE)
     SET &FCC = &LASTCC
     ALLOC DDNAME(PDSFILE) DA('&PDSNAME') SHR REUS
     SET &FCC = &LASTCC
     IF &FCC > 0 THEN DO
      WRITE RC &FCC FOR ALLOC OF &PDSNAME - TYPE END OR HIT ENTER
      READ ANS
     IF &ANS = &STR(END) THEN DO
      SET &CURPOS = DSN&DNUM
      SET ZEDSMSG = &STR(COULD NOT ALLOC)
      SET ZEDLMSG = &STR(DATA SET COULD NOT BE NOT +
              BE ALLOCATED)
      ISPEXEC SETMSG MSG(ISRZ001)
      GOTO DISPLAY
      END
     END
   ISPEXEC LMINIT DATAID(INP) DDNAME(PDSFILE) ENQ(SHR)
    SET LMCC = &LASTCC
    IF LMCC > 0 THEN DO
      WRITE RC &LMCC FOR LMINIT- TYPE END OR HIT ENTER
      READ ANS
     IF &ANS = &STR(END) THEN DO
      SET &CURPOS = DSN&DNUM
      SET ZEDSMSG = &STR(COULD NOT ALLOC)
      SET ZEDLMSG = &STR(DATA SET COULD NOT BE NOT +
              BE INITIALIZED)
      ISPEXEC SETMSG MSG(ISRZ001)
      GOTO GETOUT
      END
     END
   ISPEXEC LMOPEN DATAID(&INP) OPTION(INPUT)
    SET LMCC = &LASTCC
    IF LMCC > 0 THEN DO
      WRITE RC &LMCC FOR LMINIT- TYPE END OR HIT ENTER
      READ ANS
     IF &ANS = &STR(END) THEN DO
      SET &CURPOS = DSN&DNUM
      SET ZEDSMSG = &STR(COULD NOT ALLOC)
      SET ZEDLMSG = &STR(DATA SET COULD NOT BE NOT +
              BE INITIALIZED)
      ISPEXEC SETMSG MSG(ISRZ001)
      GOTO GETOUT
      END
     END
    SET &INMEMB = &MEM
    ISPEXEC LMMFIND DATAID(&INP) MEMBER(&INMEMB)
    SET LMCC = &LASTCC
   IF &LMCC = 0 THEN DO
      SET &CURPOS = DSN&DNUM
      SET &FM&DNUM = &STR(===>)
      SET &FOUND = &STR(YES)
      SET ZEDSMSG = &STR(&MEM FOUND)
      SET ZEDLMSG = &STR(MEMBER &MEM FOUND IN &PDSNAME)
      ISPEXEC SETMSG MSG(ISRZ001)
      IF &SEARCH ¬= &STR(ALL) THEN SET &DNUM = 12
      END
     ISPEXEC LMCLOSE DATAID(&INP)
     SET &LMCC = &LASTCC
     ISPEXEC LMFREE DATAID(&INP)
     SET &LMCC = &LASTCC
     FREE DDNAME(PDSFILE)
     SET &FCC = &LASTCC
   END
  END
    IF &FOUND ¬= &STR(YES) THEN DO
      SET ZEDSMSG = &STR(&MEM NOT FOUND)
      SET ZEDLMSG = &STR(MEMBER &MEM NOTFOUND IN CONCATENATION)
      ISPEXEC SETMSG MSG(ISRZ001)
      GOTO PREDISPL
    END
  ELSE DO
      SET ZEDSMSG = &STR(&MEM FOUND)
      SET ZEDLMSG = &STR(MEMBER &MEM FOUND IN &PDSNAME)
      ISPEXEC SETMSG MSG(ISRZ001)
    GOTO DISPLAY
   END
 MSG: WRITE FINDMEM COMPLETE
 ISPEXEC CONTROL DISPLAY REFRESH
  GOTO PREDISPL
 FINIS: +
     ISREDIT CANCEL
     EXIT
 GETOUT +
     ISPEXEC LMCLOSE DATAID(&INP)
     SET &LMCC = &LASTCC
     ISPEXEC LMFREE DATAID(&INP)
     SET &LMCC = &LASTCC
     FREE DDNAME(PDSFILE)
     SET &FCC = &LASTCC
  EXIT

