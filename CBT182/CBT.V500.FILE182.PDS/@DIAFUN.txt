         TITLE 'FUNCTION SWITCHING'                            SS NOV85
*                                       *                      SS AUG86
*       FUNCTIONS SWITCHING             *                      SS AUG86
*                                       *                      SS AUG86
ISPFUNSW DS    0H                       *                      SS AUG86
         USING ISPFUNSW,R4              *                      SS AUG86
         IC    R15,$TLEX(R14)      SUB FUNCTION CODE           SS AUG86
         L     R15,ISPFUNTB(R15)   GET SUB FUC ADDR            SS AUG86
         BR    R15                      *                      SS AUG86
ISPFUNTB DS    0F                       *                      SS AUG86
         DC    A(ISPFEND)     0    END CURRENT FUNCTION        SS AUG86
         DC    A(ISPFUNP)     4    FUNCTION PROMPT DISPLAY     SS AUG86
         DC    A(ISPFLOG)     8    GO TO VIEW LOG              SS AUG86
         DC    A(ISPFENDT)   12    END STACKED TABLE AND PANEL SS AUG86
         DC    A(ISPFUNSK)   16    UNSTACK SECONDARY PANEL     SS AUG86
         DC    A(ISPFUNSL)   20    SETLOG PRIMARY OPTION       SS OCT88
         DC    A(ISPFUNSM)   24    SETML PRIMARY OPTION        SS OCT88
         DC    A(ISPFUNEV)   28    SETENV PRIMARY OPTION       SS OCT88
         DC    A(ISPFUNSS)   32    SETSEL PRIMARY OPTION       SS OCT88
         DC    A(ISPFLOGC)   36    GO TO LOG WITH A COMMAND   ABL MAY88
         DC    A(ISPFUNVL)   40    SETV   PRIMARY OPTION       SS OCT88
         DC    A(ISPFUNCN)   44    CAN PENDING                 SS OCT88
         DC    A(ISPFUNEN)   48    END FUNCTION STATUS         SS OCT88
         DC    A(ISPFUNSC)   52    SETC PRIMARY OPTION         SS OCT88
         DC    A(ISPFUNST)   56    SETTRAP      OPTION         SS OCT88
ISPFEND  DS    0H                       *                      SS AUG86
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT  SS AUG86
ISPFEND1 DS    0H                       FUNCTION SWITCH PANEL ABL FEB87
         CLI   SPFFUNST+9,C'P'          CSECT   PENDING        SS OCT88
         BNE   ISPFEND6                 NO                     SS OCT88
         LTR   R1,R1                    ANY OTHERS             SS OCT88
         BNZ   ISPFENDP                 YES, PROMPT            SS OCT88
         LA    R1,18                    SET CSECT PENDING      SS OCT88
ISPFEND6 DS    0H                       *                      SS OCT88
         LA    R1,0                     ASSUME NO PENDING      SS AUG86
         CLI   SPFFUNST+1,C'P'          MEMLIST PENDING        SS AUG86
         BNE   ISPFEND2                 NO                     SS AUG86
         LA    R1,2                     SET MEMLIST PENDING    SS AUG86
ISPFEND2 DS    0H                       *                      SS AUG86
         CLI   SPFFUNST+2,C'P'          LISTA   PENDING        SS AUG86
         BNE   ISPFEND3                 NO                     SS AUG86
         LTR   R1,R1                    ANY OTHERS             SS AUG86
         BNZ   ISPFENDP                 YES, PROMPT            SS DEC87
         LA    R1,4                     SET LISTA PENDING      SS AUG86
ISPFEND3 DS    0H                       *                      SS AUG86
         CLI   SPFFUNST+5,C'P'          LISTC   PENDING        SS OCT88
         BNE   ISPFEND5                 NO                     SS OCT88
         LTR   R1,R1                    ANY OTHERS             SS OCT88
         BNZ   ISPFENDP                 YES, PROMPT            SS OCT88
         LA    R1,10                    SET LISTC PENDING      SS OCT88
ISPFEND5 DS    0H                       *                      SS OCT88
         CLI   SPFFUNST+8,C'P'          FILTER  PENDING        SS OCT88
         BNE   ISPFEND7                 NO                     SS OCT88
         LTR   R1,R1                    ANY OTHERS             SS OCT88
         BNZ   ISPFENDP                 YES, PROMPT            SS OCT88
         LA    R1,16                    SET FILTR PENDING      SS OCT88
ISPFEND7 DS    0H                       *                      SS OCT88
         CLI   SPFFUNST+3,C'P'          LISTV   PENDING        SS OCT88
         BNE   ISPFEND4                 NO                     SS OCT88
         LTR   R1,R1                    ANY OTHERS             SS OCT88
         BNZ   ISPFENDP                 YES, PROMPT            SS OCT88
         LA    R1,6                     SET LISTV PENDING      SS OCT88
ISPFEND4 DS    0H                       *                      SS OCT88
         CLI   SPFFUNST+7,C'P'          CAX     PENDING        SS OCT88
         BNE   ISPFEND8                 NO                     SS OCT88
         LTR   R1,R1                    ANY OTHERS             SS OCT88
         BNZ   ISPFENDP                 YES, PROMPT            SS OCT88
         LA    R1,14                    SET CAX   PENDING      SS OCT88
ISPFEND8 DS    0H                       *                      SS OCT88
         CLI   SPFFUNST+6,C'P'          TCT     PENDING        SS OCT88
         BNE   ISPFEND9                 NO                     SS OCT88
         LTR   R1,R1                    ANY OTHERS             SS OCT88
         BNZ   ISPFENDP                 YES, PROMPT            SS OCT88
         LA    R1,12                    SET TCT   PENDING      SS OCT88
ISPFEND9 DS    0H                       *                      SS OCT88
         LTR   R1,R1                    PENDING PROCESS?       SS AUG86
         BNZ   ISPFENDG                 YES, GO PROCESS        SS DEC87
         CLI   SPFENDX,C'Y'             END PROMPT?           ABL FEB87
         BE    ISPFUNP                  YES, BRANCH           ABL FEB87
         TM    SPFTBPF1,SPFTLIN         MEMLIST/LISTA/LISTV?  ABL FEB87
         BO    ISPFLOG                  YES, SWITCH TO LOG    ABL FEB87
         LA    R15,0                    NO,                   ABL FEB87
         BR    R3                          EXIT               ABL FEB87
ISPFENDP DS    0H                       *                      SS DEC87
         CLI   SPFENDP,C'Y'             ORDERED PENDING        SS DEC87
         BNE   ISPFUNP                  NO, THEN PROMPT        SS DEC87
ISPFENDG DS    0H                       *                      SS DEC87
         LH    R1,SPFFUNLP(R1)          GET PANEL ID           SS AUG86
         LNR   R1,R1                    SET FOR SWAP           SS AUG86
         BAS   R2,ISPSTKI               DO IT                  SS AUG86
         LA    R15,36                   GO TO ISPPEND PROCR    SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
         SPACE 3                        *                      SS AUG86
ISPFUNP  DS    0H                       *                      SS DEC87
* HIERARCHICAL SUPPORT REMOVED                                 SS OCT88
ISPFUNP3 DS    0H                       *                      SS AUG86
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT  SS AUG86
         TM    SPFTBPF2,SPFTFUNC  AT FUNCTION?                 SS OCT88
         BO    ISPFUND6           YES, GO TO DISPLAY           SS OCT88
         LA    R1,2                     PANEL 2                SS SEP88
         LNR   R1,R1                    FOR SWAP               SS OCT88
         BAS   R2,ISPSTKI               SWAP TO FUNC PANEL     SS OCT88
         B     ISPFUND6                 GO TO DISPLAY          SS OCT88
ISPFUNPP DC    CL8'&P.FN@P'             FUNCTION PANEL         SS AUG86
* CAN PENDING OPTION                    *                      SS AUG86
ISPFUNCN DS    0H                       *                      SS AUG86
         L     R15,SPFOPER           FIRST BLANK AFTER CMD    ABL JAN87
         LA    R14,30                TRY FOR 30 BYTES          SS OCT88
         LA    R1,ISPFUNPR           PARSE LIST                SS OCT88
         BAS   R2,ISPPARSI           PARSE ROUTINE             SS OCT88
         C     R15,ISPL8             RETURN CODE               SS OCT88
         BE    ISPFUN68              INVALID COMMAND           SS OCT88
         TM    SPFPRBI,X'FF'         ANY SET                   SS OCT88
         BZ    ISPFUN68              NO                        SS OCT88
         TM    SPFPRBI,X'80'         ML ?                      SS OCT88
         BO    ISPFUNCM              YES, BRANCH               SS OCT88
ISPFUNC2 TM    SPFPRBI,X'40'         LA ?                      SS OCT88
         BO    ISPFUNCA              YES, BRANCH               SS OCT88
         TM    SPFPRBI,X'20'         LV ?                      SS OCT88
         BO    ISPFUNCV              YES, BRANCH               SS OCT88
         TM    SPFPRBI,X'10'         LC ?                      SS OCT88
         BO    ISPFUNCC              YES, BRANCH               SS OCT88
         TM    SPFPRBI,X'08'         TCT?                      SS OCT88
         BO    ISPFUNCT              YES, BRANCH               SS OCT88
         TM    SPFPRBI,X'04'         CAX?                      SS OCT88
         BO    ISPFUNCX              YES, BRANCH               SS OCT88
         TM    SPFPRBI,X'02'         FL ?                      SS OCT88
         BO    ISPFUNCF              YES, BRANCH               SS OCT88
         TM    SPFPRBI,X'01'         CS ?                      SS OCT88
         BO    ISPFUNCS              YES, BRANCH               SS OCT88
         B     ISPFUNC9              DONE                      SS OCT88
ISPFUN68 DS    0H                       *                      SS OCT88
         LA    R0,ISPFUNCP              *                      SS OCT88
         LA    R15,168               INVALID                   SS OCT88
         BR    R3                    ROUTER                    SS OCT88
ISPFUNCP DC    CL8'&P.FUCN'          CANCEL PROMPT PANEL       SS OCT88
ISPFUN28 DS    0H                       *                      SS OCT88
         LA    R15,28                INVALID                   SS OCT88
         BR    R3                    ROUTER                    SS OCT88
ISPFUNPR DS    0F                                              SS JUL87
         DC    X'30',X'80',X'00',X'00',CL8'ML'                 SS OCT88
         DC    X'30',X'80',X'00',X'00',CL8'MEMLIST'            SS OCT88
         DC    X'30',X'40',X'00',X'00',CL8'A'                  SS OCT88
         DC    X'21',X'40',X'00',X'00',CL8'LA'                 SS OCT88
         DC    X'24',X'40',X'00',X'00',CL8'LISTA'              SS OCT88
         DC    X'30',X'20',X'00',X'00',CL8'V'                  SS OCT88
         DC    X'21',X'20',X'00',X'00',CL8'LV'                 SS OCT88
         DC    X'24',X'20',X'00',X'00',CL8'LISTV'              SS OCT88
         DC    X'21',X'10',X'00',X'00',CL8'LC'                 SS OCT88
         DC    X'24',X'10',X'00',X'00',CL8'LISTC'              SS OCT88
         DC    X'21',X'10',X'00',X'00',CL8'LF'                 SS OCT88
         DC    X'24',X'10',X'00',X'00',CL8'LISTFILE'           SS OCT88
         DC    X'30',X'08',X'00',X'00',CL8'TCT'                SS OCT88
         DC    X'21',X'04',X'00',X'00',CL8'CAX'                SS OCT88
         DC    X'21',X'02',X'00',X'00',CL8'FL'                 SS OCT88
         DC    X'24',X'02',X'00',X'00',CL8'FILTER'             SS OCT88
         DC    X'21',X'01',X'00',X'00',CL8'CSECT'              SS OCT88
         DC    X'21',X'FF',X'00',X'00',CL8'ALL'                SS OCT88
         DC    X'FF'                                           SS OCT88
ISPFUNCM DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'80'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+2            GET PANELID FOR MEML   SS AUG86
         LA    R15,SPFFUNST+1           POINT TO STATUS        SS AUG86
         B     ISPFUNCK                 CHECK AND PROCESS      SS AUG86
ISPFUNCA DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'40'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+4            GET PANELID FOR LA     SS AUG86
         LA    R15,SPFFUNST+2           POINT TO STATUS        SS AUG86
         B     ISPFUNCK                 CHECK AND PROCESS      SS AUG86
ISPFUNCV DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'20'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+6            GET PANELID FOR LV     SS AUG86
         LA    R15,SPFFUNST+3           POINT TO STATUS        SS AUG86
         B     ISPFUNCK                 CHECK AND PROCESS      SS AUG86
ISPFUNCC DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'10'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+10           GET PANELID FOR LC/LF  SS OCT88
         LA    R15,SPFFUNST+5           POINT TO STATUS        SS OCT88
         B     ISPFUNCK                 CHECK AND PROCESS      SS OCT88
ISPFUNCT DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'08'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+12           GET PANELID FOR TCT    SS OCT88
         LA    R15,SPFFUNST+6           POINT TO STATUS        SS OCT88
         B     ISPFUNCK                 CHECK AND PROCESS      SS OCT88
ISPFUNCX DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'04'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+14           GET PANELID FOR CAX    SS OCT88
         LA    R15,SPFFUNST+7           POINT TO STATUS        SS OCT88
         B     ISPFUNCK                 CHECK AND PROCESS      SS OCT88
ISPFUNCF DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'02'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+16           GET PANELID FOR FILTER SS OCT88
         LA    R15,SPFFUNST+8           POINT TO STATUS        SS OCT88
         B     ISPFUNCK                 CHECK AND PROCESS      SS OCT88
ISPFUNCS DS    0H                       *                      SS AUG86
         NI    SPFPRBI,255-X'01'        RESET                  SS OCT88
         LH    R1,SPFFUNLP+18           GET PANELID FOR CSECTS SS OCT88
         LA    R15,SPFFUNST+9           POINT TO STATUS        SS OCT88
         B     ISPFUNCK                 CHECK AND PROCESS      SS OCT88
ISPFUNCK DS    0H                       *                      SS AUG86
         CLI   0(R15),C'P'              PENDING                SS AUG86
         BNE   ISPFUNC2                 NO, IGNORE             SS AUG86
         LNR   R1,R1                    SET FOR SWAP           SS AUG86
         BAS   R2,ISPSTKI               DO IT                  SS AUG86
         NI    SPFTFLG1,255-SPFTZSV-SPFTRET RESET CANCEL       SS AUG86
         MVC   SPFTTOP,SPFTTOP2         DON'T SCROLL           SS JUL87
         TM    SPFTFLG1,SPFTLCD         PENDING LINE CMDS      SS AUG86
         BZ    ISPFUNC8                 NO, UPDATE STATUS      SS AUG86
         NI    SPFTFLG1,255-SPFTLCD-SPFTMUT RESET CANCEL       SS AUG86
ISPFUNC8 DS    0H                       *                      SS AUG86
         BAS   R2,ISPSETST              UPDATE STATUS          SS AUG86
         B     ISPFUNC2                 *                      SS OCT88
ISPFUNC9 DS    0H                       *                      SS OCT88
         LA    R1,2                     GET PANELID FUNCTION   SS OCT88
         LNR   R1,R1                    SET FOR SWAP           SS OCT88
         BAS   R2,ISPSTKI               DO IT                  SS OCT88
         B     ISPFUND6                 DONE                   SS OCT88
         SPACE 2                        *                      SS AUG86
ISPFUNDK DS    0H                    INVALID ENTRY             SS AUG86
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS AUG86
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS AUG86
         MVI   SPFMSGID+7,C'A'       COMMON MSG                SS AUG86
         LA    R1,SPFMSGID           POINT TO MSG              SS AUG86
         B     ISPFUND6              TRY AGAIN                 SS AUG86
ISPFUNDI DS    0H                    INVALID KEY               SS AUG86
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS AUG86
         MVI   SPFMSGID+6,C'6'       COMMON MSG                SS AUG86
         MVI   SPFMSGID+7,C'A'       COMMON MSG                SS AUG86
         LA    R1,SPFMSGID           POINT TO MSG              SS AUG86
         B     ISPFUND6              TRY AGAIN                 SS AUG86
ISPFUNDN DS    0H                    NULL ENTRY                SS AUG86
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS AUG86
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS AUG86
         MVI   SPFMSGID+7,C'E'       COMMON MSG                SS AUG86
         LA    R1,SPFMSGID           POINT TO MSG              SS AUG86
         B     ISPFUND6              TRY AGAIN                 SS AUG86
ISPFUNDM DS    0H                    MISSING OPERAND           SS AUG86
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS AUG86
         MVI   SPFMSGID+6,C'2'       COMMON MSG                SS AUG86
         MVI   SPFMSGID+7,C'A'       COMMON MSG                SS AUG86
         LA    R1,SPFMSGID           POINT TO MSG              SS AUG86
         B     ISPFUND6              TRY AGAIN                 SS AUG86
         SPACE 2                        *                      SS AUG86
* SET LOG DEFAULTS FROM TABLE PANEL                           ABL FEB87
ISPFUNSL DS    0H                       *                      SS OCT88
         LA    R15,ISPFUNSP             PANEL SETL             SS OCT88
         B     ISPFUNSX                 RETURN                 SS OCT88
ISPFUNSP DC    CL8'&P.SETL'             SETLOG   PANEL        ABL JAN87
* SET MEMLIST DEFAULTS FROM TABLE PANEL                       ABL FEB87
ISPFUNSM DS    0H                       *                      SS OCT88
         LA    R15,ISPFUNSQ             PANEL SETM            ABL FEB87
         B     ISPFUNSX                 COMMON SET PANEL DISP  SS JUL88
ISPFUNSQ DC    CL8'&P.SETM'             SETML    PANEL        ABL JAN87
* SET ENVIORMENT OPT   FROM TABLE PANEL                        SS JUL87
ISPFUNEV DS    0H                       *                      SS OCT88
         LA    R15,ISPFUNSE             PANEL SETE             SS JUL87
         B     ISPFUNSX                 COMMON SET PANEL DISP  SS JUL88
ISPFUNSE DC    CL8'&P.SETE'             SETENV   PANEL         SS JUL87
* SET SELECT COMANDS   FROM TABLE PANEL                        SS JUL87
ISPFUNSS DS    0H                       *                      SS OCT88
         LA    R15,ISPFUNSZ             PANEL SETS             SS JUL87
         B     ISPFUNSX                 COMMON SET PANEL DISP  SS JUL88
ISPFUNSZ DC    CL8'&P.SETS'             SETSEL   PANEL         SS JUL87
* SET ENVIORMENT OPT   FROM TABLE PANEL                        SS JUL88
ISPFUNVL DS    0H                       *                      SS OCT88
         LA    R15,ISPFUNSV             PANEL SETV             SS JUL88
         B     ISPFUNSX                 COMMON SET PANEL DISP  SS JUL88
ISPFUNSV DC    CL8'&P.SETV'             SETV     PANEL         SS JUL88
* SET LISTC/LISTF OPT  FROM TABLE PANEL                        SS JUL88
ISPFUNSC DS    0H                       *                      SS JUL88
         LA    R15,ISPFUNSF             PANEL SETC             SS JUL88
         B     ISPFUNSX                 COMMON SET PANEL DISP  SS JUL88
ISPFUNSF DC    CL8'&P.SETF'             SETC     PANEL         SS JUL88
* SET TRAP OPTIONS     FROM TABLE PANEL                        SS JUL88
ISPFUNST DS    0H                       *                      SS JUL88
         LA    R15,ISPFUNS6             PANEL SETTRAP          SS JUL88
         B     ISPFUNSX                 COMMON SET PANEL DISP  SS JUL88
ISPFUNS6 DC    CL8'&P.SETT'             SETT     PANEL         SS JUL88
ISPFUNSX DS    0H                       *                      SS JUL88
         MVI   SPFVZCMD,C' '            BLANK                  SS JUL88
         MVC   SPFVZCMD+1(249),SPFVZCMD      RIPPLE            SS JUL88
         LA    R1,ISPBLK8         NO MESSAGE                   SS JUL88
         BAS   R2,ISPSINGI              DISPLAY THIS PANEL     SS JUL88
         B     ISPFUND6                 *                      SS OCT88
ISPFUND6 DS    0H                       *                      SS OCT88
         LA    R15,40                   CONTINUE DISPLAY       SS JUL88
         BR    R3                       RETURN                 SS JUL88
ISPFUNEN DS    0H                       *                      SS AUG86
         LA    R15,0                    END FUNCTION           SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
         SPACE 2                        *                      SS AUG86
         SPACE 2                        *                      SS AUG86
ISPFLOGC DS    0H                       *                     ABL AUG86
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT ABL MAY88
         LTR   R1,R1                    THIS LOG ALREADY      ABL MAY88
         BZ    ISPFDISX                 YES EXIT               SS NOV88
         LH    R1,SPFFUNLP+0            GET LOG LAST PANEL    ABL MAY88
         LNR   R1,R1                    SET FOR SWAP          ABL MAY88
         BAS   R2,ISPSTKI               SWAP TO LOG PANEL     ABL MAY88
         LA    R15,104                  PROCESS OPTION        ABL MAY88
         BR    R3                       RETURN TO ROUTER      ABL MAY88
         SPACE 2                        *                     ABL MAY88
ISPFENDT DS    0H                                              SS NOV85
         BAS   R2,ISPTBEND                                     SS NOV85
         BAS   R2,ISPSETST                                     SS AUG86
ISPFUNSK DS    0H                                              SS NOV85
         LA    R1,0                POP PANEL                   SS NOV85
         BAS   R2,ISPSTKI          UNSTACK                     SS NOV85
         TM    SPFTBPF1,SPFTRET    THIS HAVE RETURN PROCESSING SS NOV85
         BO    ISPFUNK2            NO, DISPLAY THIS PANEL      SS NOV85
         TM    SPFTBPF1,SPFTLIN    THIS HAVE LINE CMDS         SS NOV85
         BZ    ISPFDISX            NO, DISPLAY THIS PANEL      SS NOV85
         TM    SPFTFLG1,SPFTLCD    LINE CMD ACTIVE             SS NOV85
         BZ    ISPFDISX            NO, DISPLAY THIS PANEL      SS NOV85
         LH    R15,SPFTBPLF        GET LINE PROC FUNC CODE     SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
ISPFUNK2 DS    0H                                              SS NOV85
         NI    SPFTBPF1,255-SPFTRET  ONLY ONCE                 SS NOV85
         SR    R15,R15                                         SS NOV85
         IC    R15,SPFTPOSI        GET POST PROC INDEX         SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
ISPFDISX DS    0H                       *                      SS AUG86
         LA    R15,100                  DISPLAY                SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
ISPFLOG  DS    0H                       *                      SS AUG86
         LA    R15,192                  VIEW FUNCTION          SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
         DROP  R4                       *                      SS NOV88
         TITLE 'VIEW FUNCTION'                                 SS NOV88
*                                       *                      SS NOV88
*       VIEW FUNCTION                   *                      SS NOV88
*                                       *                      SS NOV88
ISPVIEW  DS    0H                       *                      SS NOV88
         USING ISPVIEW,R4               *                      SS NOV88
         LTR   R0,R0                 IS THIS SUB CALL          SS NOV88
         BZ    ISPVIEW9              NO                        SS NOV88
         ST    R0,SPFPRNU            SET LOG NUMBER            SS NOV88
         MVI   SPFPRBI,X'51'         LOG NUMBER+SUB CALL+NODSP SS NOV88
         B     ISPFLOPT              PROCESS AS GIVEN          SS NOV88
ISPVIEWX DS    0H                    EXIT                      SS NOV88
         LA    R15,40                DISPLAY CONTINUE          SS NOV88
         BR    R3                    ROUTER/CALLER             SS NOV88
ISPVIEW9 DS    0H                       *                      SS NOV88
         L     R15,SPFOPER           FIRST BLANK AFTER CMD     SS NOV88
         LA    R14,30                TRY FOR 30 BYTES          SS OCT88
         LA    R1,ISPFLPRS           PARSE LIST                SS OCT88
         BAS   R2,ISPPARSI           PARSE ROUTINE             SS OCT88
         C     R15,ISPL8             RETURN CODE               SS OCT88
         BH    ISPFLOPR              INVALID COMMAND           SS OCT88
         TM    SPFPRBI,X'FF'         ANY SET                   SS OCT88
         BNZ   ISPFLOPT              YES, GO CHECK             SS OCT88
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT  SS AUG86
         LTR   R1,R1                    THIS LOG ALREADY       SS AUG86
         BZ    ISPVIEWX                 YES EXIT               SS NOV88
         LH    R1,SPFFUNLP+0            GET LOG LAST PANEL     SS AUG86
         LNR   R1,R1                    SET FOR SWAP           SS AUG86
         BAS   R2,ISPSTKI               SWAP TO LOG PANEL      SS AUG86
         B     ISPVIEWX                 NO  EXIT               SS NOV88
ISPFLPRS DS    0F                                              SS JUL87
         DC    X'51',X'40',X'00',X'00',F'1',F'9'  LOG NUMBER   SS OCT88
         DC    X'30',X'20',X'00',X'00',CL8'RESET'              SS OCT88
         DC    X'30',X'10',X'00',X'00',CL8'NODISPL'            SS OCT88
         DC    X'FF'                                           SS OCT88
ISPFLOPR DS    0H                       *                      SS OCT88
         LA    R0,ISPFLOPP              *                      SS OCT88
         LA    R15,168               INVALID                   SS OCT88
         BR    R3                    ROUTER                    SS OCT88
ISPFLOPP DC    CL8'&P.VIVI'          VIEW   PROMPT PANEL       SS OCT88
ISPFLOPT DS    0H                       *                      SS OCT88
         TM    SPFPRBI,X'40'            ANY NUMBER             SS OCT88
         BZ    ISPFLOP2                 NO, NEXT CHECK RESET   SS OCT88
         MVC   SPFTSVB,SPFPRNU+3        GET NUMBER             SS OCT88
         OI    SPFTSVB,X'F0'            MAKE DISPLAYABLE       SS OCT88
ISPFLOP2 DS    0H                       *                      SS OCT88
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT  SS AUG86
         LTR   R1,R1                    THIS LOG ALREADY       SS AUG86
         BZ    ISPFLSW2                 YES, IGNORE NODISPL    SS OCT88
         TM    SPFPRBI,X'10'            NODISPLAY              SS OCT88
         BZ    ISPFLSWP                 *                      SS OCT88
         TM    SPFPRBI,X'40'            ANY NUMBER             SS OCT88
         BZ    ISPFLREK                 NO, NEXT CHECK RESET   SS OCT88
         CLC   SPFTSVB,SPFLOGNM+7       SAME ONE               SS OCT88
         BE    ISPFLREK                 YES, IGNORE SWITCH     SS OCT88
         L     R14,SPFLOGHA             CURRENT LOG AT HOME    SS OCT88
         B     ISPFLSWH                 SWITCH LOG TABLES      SS OCT88
ISPFLSWP DS    0H                       *                      SS OCT88
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT  SS AUG86
         LTR   R1,R1                    THIS LOG ALREADY       SS AUG86
         BZ    ISPFLSW2                 YES, NO SWAP           SS AUG86
         LH    R1,SPFFUNLP+0            GET LOG LAST PANEL     SS AUG86
         LNR   R1,R1                    SET FOR SWAP           SS AUG86
         BAS   R2,ISPSTKI               SWAP TO LOG PANEL      SS AUG86
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT  SS AUG86
ISPFLSW2 DS    0H                       *                      SS OCT88
         TM    SPFPRBI,X'40'            ANY NUMBER             SS OCT88
         BZ    ISPFLREK                 NO, NEXT CHECK RESET   SS OCT88
         CLC   SPFTSVB,SPFLOGNM+7       SAME ONE               SS OCT88
         BE    ISPFLREK                 YES, IGNORE SWITCH     SS OCT88
         LA    R14,SPFTBL               CURRENT LOG ACTIVE     SS OCT88
         B     ISPFLSWH                 SWITCH LOG TABLES      SS OCT88
*       R14 = CURRENT LOG  (I.E SPFTBL OR SPFLOGHM)            SS OCT88
ISPFLSWH DS    0H                       *                      SS OCT88
         L     R1,SPFLOGHA              HOME ADDRESS           SS OCT88
* NOW DO LOG SWAP                       *                      SS OCT88
* SAVE LOG LIMITS                       *                      SS OCT88
         MVC   SPFTRES2-SPFTBL(4,R14),SPFCSIZE                 SS OCT88
         MVC   SPFTRES3-SPFTBL(4,R14),SPFCMAX                  SS OCT88
         MVC   SPFTRES4-SPFTBL(4,R14),SPFCCKPT                 SS OCT88
         MVC   SPFTSIZE-SPFTBL(4,R14),SPFLAST                  SS OCT88
         MVC   SPFTTOP-SPFTBL(4,R14),SPFSTART                  SS OCT88
* SAVE CURRENT LOG IN HOME SPOT BY NAME                        SS OCT88
         SR    R15,R15                  *                      SS OCT88
         IC    R15,SPFLOGNM+7           *                      SS OCT88
         N     R15,ISPFL0X              TURN OFF ZONE = IX     SS OCT88
         MH    R15,ISPFL160             CALC OFFSET            SS OCT88
         ALR   R15,R1                   MAKE ADDRESS           SS OCT88
         MVC   0(SPFTTLN,R15),0(R14)    SAVE OLD               SS OCT88
* COPY NEW LOG TO HOME SPOT 0           *                      SS OCT88
         L     R15,SPFPRNU              NEW LOG IX             SS OCT88
         MH    R15,ISPFL160             CALC OFFSET            SS OCT88
         ALR   R15,R1                   MAKE ADDRESS           SS OCT88
         MVC   0(SPFTTLN,R14),0(R15)    LOAD NEW               SS OCT88
* CHECK IF ACTIVE IF NOT GO TO ISPFLSTF *                      SS OCT88
         TM    SPFTFLG1-SPFTBL(R14),SPFTACT                    SS OCT88
         BZ    ISPFLSTF                 NO , MAKE ACTIVE       SS OCT88
* LOAD LOG LIMITS AND STATUS            *                      SS OCT88
         MVC   SPFCSIZE,SPFTRES2-SPFTBL(R14)                   SS OCT88
         MVC   SPFCMAX,SPFTRES3-SPFTBL(R14)                    SS OCT88
         MVC   SPFCCKPT,SPFTRES4-SPFTBL(R14)                   SS OCT88
         MVC   SPFLAST,SPFTSIZE-SPFTBL(R14)                    SS OCT88
         MVC   SPFSTART,SPFTTOP-SPFTBL(R14)                    SS OCT88
         MVC   SPFFUNLP+0(2),SPFTPANL-SPFTBL(R14)              SS OCT88
         MVC   SPFLOGNM+7(1),SPFTSVB    NEW LOG NAME           SS OCT88
         B     ISPFLREK                 DONE, CHECK FOR RESET  SS OCT88
         DS    0F                       *                      SS OCT88
ISPFL0X  DC    X'0000000F'              MASK OFF ZONE          SS OCT88
ISPFL160 DC    H'160'                   *                      SS OCT88
* CHECK FOR RESET                       *                      SS OCT88
ISPFLREK DS    0H                       *                      SS OCT88
         TM    SPFPRBI,X'20'            RESET                  SS OCT88
         BZ    ISPVIEWX                 NO  EXIT               SS NOV88
* LOG TABLE RESET (END AND RE CREATE)   *                      SS OCT88
ISPFLRES DS    0H                                              SS OCT88
         LA    R14,TBEND          END TABLE                    SS OCT88
         LA    R15,SPFLOGNM       TABLE NAME                   SS OCT88
         STM   R14,R15,PARMLIST                                SS OCT88
         OI    PARMLIST+04,X'80'                               SS OCT88
         BAS   R14,ISPSXEQ                                     SS OCT88
         LTR   R15,R15                                         SS OCT88
         BNZ   ISPERR                                          SS OCT88
         B     ISPFLOPN                 *                      SS OCT88
* SET FLAGS FOR NEW LOG TABLE                                  SS OCT88
ISPFLSTF DS    0H                       *                      SS OCT88
         LA    R0,1                   DEFAULT PANEL IX         SS OCT88
         STH   R0,SPFTPANL-SPFTBL(R14) SET                     SS OCT88
         STH   R0,SPFFUNLP+0          SET                      SS OCT88
         MVC   SPFLOGNM+7(1),SPFTSVB  NEW LOG NAME             SS OCT88
         MVC   0(8,R14),SPFLOGNM      SET LOG NAME             SS OCT88
         LA    R0,VPDSLIN             ADDRESS OF VARS          SS OCT88
         LA    R15,ISPBLK8            NO KEYS                  SS OCT88
         ST    R0,SPFTVARA-SPFTBL(R14)  ADDR OF VARS           SS OCT88
         ST    R15,SPFTKEYA-SPFTBL(R14) ADDR OF KEY            SS OCT88
         MVI   SPFTFLG1-SPFTBL(R14),0   CLEAR FLAGS            SS OCT88
         XC    SPFTFF-SPFTBL(2,R14),SPFTFF-SPFTBL(R14)         SS OCT88
         OI    SPFTFLG1-SPFTBL(R14),SPFTACT  SET ACTIVE FLAG   SS OCT88
         B     ISPFLOPN                 *                      SS OCT88
* OPEN LOG TABLE (NO CHANGE IN FLAGS    *                      SS OCT88
ISPFLOPN DS    0H                       *                      SS OCT88
         LA    R0,VPDSLIN             ADDRESS OF VARS          SS OCT88
         LA    R15,ISPBLK8            NO KEYS                  SS OCT88
         LA    R14,SPFLOGNM           NAME OF LOG              SS OCT88
         LA    R1,ISPNOWRT       NO WRITE                      SS OCT88
         STM   R14,R1,PARMLIST+4                               SS OCT88
         LA    R14,TBCREATE                                    SS OCT88
         ST    R14,PARMLIST                                    SS OCT88
         OI    PARMLIST+16,X'80'                               SS OCT88
         BAS   R14,ISPSXEQ                                     SS OCT88
         LTR   R15,R15                                         SS OCT88
         BNZ   ISPERR                                          SS OCT88
         B     ISPVIEWX                 RETURN                 SS NOV88
         DROP  R4                       *                      SS AUG86
         TITLE 'COMMON MISC FUNCTIONS'                         SS NOV85
*                                       *                      SS AUG86
*  MISC FUNCTIONS IE KLEAR TRUNC ETC    *                      SS AUG86
*                                       *                      SS AUG86
ISPMISC  DS    0H                       *                      SS AUG86
         USING ISPMISC,R4               *                      SS AUG86
         IC    R15,$TLEX(R14)      SUB FUNCTION CODE           SS AUG86
ISPMISC2 L     R15,ISPMISTB(R15)   GET SUB FUC ADDR           ABL AUG86
         BR    R15                      *                      SS AUG86
ISPMISTB DS    0F                       *                      SS AUG86
         DC    A(0)           0                                SS JUL87
         DC    A(0)           4                                SS JUL87
         DC    A(ISPMI088)    8   SUBLIST=MEML.TAG             SS NOV88
         DC    A(ISPCOLS)    12   PUT COLS LINE IN LOG         SS OCT88
         DC    A(ISPKLRLG)   16   CLEAR LOG                    SS FEB88
         DC    A(ISPKLRTB)   20   CLEAR TABLE                  SS FEB88
         DC    A(ISPLOCMM)   24   LOCATE FOR MEMLIST           SS AUG86
         DC    A(ISPLOCLV)   28   LOCATE FOR LISTV             SS AUG86
         DC    A(ISPMSHF)    32   SWAP PANEL                   SS AUG86
         DC    A(ISPMLEFT)   36   LEFT                         SS AUG86
         DC    A(ISPMRITE)   40   RIGHT                        SS AUG86
         DC    A(ISPMNORM)   44   NORMAL PANEL                 SS AUG86
         DC    A(ISPMALTR)   48   ALTERNATE PANEL              SS AUG86
         DC    A(ISPMDUAL)   52   DUAL LINE PANEL              SS AUG86
         DC    A(ISPMWIDE)   56   WIDE PANEL (FUTURE)          SS AUG86
         DC    A(ISPMIOFF)   60   ISPF MODE OFF                SS AUG86
         DC    A(ISPXLOG)    64   X ALL, ABOVE, BELOW         ABL JAN87
         DC    A(ISPXTBL)    68   X ALL, ABOVE, BELOW         ABL JAN87
         DC    A(ISPLOCLC)   72   LOCATE FOR LISTC            DRK AUG98
         DC    A(ISPLOCCX)   76   LOCATE FOR CAX              DRK AUG98
ISPMI028 DS    0H            EXIT TO ISPOPTIV (INVALID CMD)    SS AUG86
         LA    R15,28        CODE       *                     ABL JAN87
         BR    R3            RETURN TO ROUTER                  SS AUG86
ISPMI040 DS    0H            EXIT TO ISPDISP6 (NEXT CMD IN SK) SS AUG86
         LA    R15,40        CODE       *                      SS AUG86
         BR    R3            RETURN TO ROUTER                  SS AUG86
ISPMI100 DS    0H            EXIT TO ISPTBDSP (TABLE DISPLAY)  SS AUG86
         LA    R15,100       CODE       *                      SS AUG86
         BR    R3            RETURN TO ROUTER                  SS AUG86
ISPMI168 DS    0H            EXIT TO ERROR PROMPT              SS DEC87
         LA    R0,0          DEFAULT PANEL                     SS OCT88
         LA    R15,168       CODE       *                      SS DEC87
         BR    R3            RETURN TO ROUTER                  SS DEC87
*      SUBLIST=MEMLIST WITH TAG                                SS NOV88
ISPMI088 DS    0H                                              SS NOV88
         CLI   SPFTBPFI+1,1  AT MEMLIST FUNCTION               SS NOV88
         BNE   ISPMI028      NO, INVALID                       SS NOV88
         OI    SPFLAG5,SPFTAG  SET FOR TAG                     SS NOV88
         LA    R0,0          DEFAULT                           SS NOV88
         LA    R15,88        CODE       *                      SS NOV88
         BR    R3            RETURN TO ROUTER                  SS NOV88
ISPMIOFF MVC   PUTGETBF(13),ISPDSNMG DSN COMMAND INTO BUFFER   SS AUG86
         B     ISPCLN                                          SS AUG86
ISPXLOG  DS    0H          ****   EXCLUDE SUBCOMMANDS ***     ABL JAN87
         L     R15,SPFOPER           FIRST BLANK AFTER CMD    ABL JAN87
         LA    R14,30                TRY FOR 30 BYTES         ABL JAN87
         LA    R1,ISPPARXX           PARSE LIST               ABL JAN87
         BAS   R2,ISPPARSI           PARSE ROUTINE            ABL JAN87
         C     R15,ISPL8             RETURN CODE              ABL JAN87
         BE    ISPMI028              INVALID COMMAND          ABL JAN87
         TM    SPFPRBI,X'01'         NUMBER                    SS JUL87
         BO    ISPXNUM               YES                       SS JUL87
         TM    SPFPRBI,X'80'         ALL?                      SS JUL87
         BO    ISPKLRLG              YES, BRANCH               SS JUL87
         TM    SPFPRBI,X'60'         BELOW/ABOVE?              SS JUL87
         BNZ   ISPXLMAX              YES, BRANCH               SS JUL87
         B     ISPMI028              NO, ERROR                 SS JUL87
ISPXTBL  DS    0H          ****   EXCLUDE SUBCOMMANDS ***     ABL JAN87
         L     R15,SPFOPER           FIRST BLANK AFTER CMD    ABL JAN87
         LA    R14,30                TRY FOR 30 BYTES         ABL JAN87
         LA    R1,ISPPARXX           PARSE LIST               ABL JAN87
         BAS   R2,ISPPARSI           PARSE ROUTINE            ABL JAN87
         C     R15,ISPL8             RETURN CODE              ABL JAN87
         BE    ISPMI028              INVALID COMMAND          ABL JAN87
         TM    SPFPRBI,X'01'         NUMBER                    SS JUL87
         BO    ISPXTNM               YES                       SS JUL87
         TM    SPFPRBI,X'80'         ALL?                      SS JUL87
         BO    ISPKLRTB              YES, BRANCH               SS JUL87
         TM    SPFPRBI,X'60'         BELOW/ABOVE?              SS JUL87
         BNZ   ISPXTMAX              YES, BRANCH               SS JUL87
         B     ISPMI028              NO, ERROR                 SS JUL87
ISPPARXX DS    0F                                              SS JUL87
         DC    X'51',X'01',X'00',X'00',F'-9999999',F'99999999' SS JUL87
         DC    X'21',X'80',X'00',X'00',CL8'ALL'               ABL JAN87
         DC    X'30',X'40',X'00',X'00',CL8'BELOW'             ABL JAN87
         DC    X'30',X'40',X'00',X'00',CL8'DOWN'   D/DOWN     DRK NOV02
         DC    X'21',X'20',X'00',X'00',CL8'ABOVE'             ABL JAN87
         DC    X'30',X'20',X'00',X'00',CL8'UP'     U/UP       DRK NOV02
         DC    X'FF'                                          ABL JAN87
ISPKLRLG DS    0H                                              SS JUL84
         BAS   R2,ISPTBT#S         TERMINATE ISPMODE TABLE    ABL OCT84
         BAS   R2,ISPTBCRE                                     SS AUG86
         OI    SPFLAG0,SPFTABLE  GOOD TABLE CREATED            SS AUG86
         B     ISPMI040                                        SS AUG86
ISPXLMAX DS    0H                       *                      SS JUL87
         L     R14,SPFLAST         DELETE NUMBER               SS JUL87
         ST    R14,SPFPRNU              *                      SS JUL87
ISPXNUM  DS    0H                       *                      SS JUL87
         BAS   R2,ISPQUERY              *                      SS JUL87
         L     R14,SPFPRNU         GET NUMBER                  SS JUL87
         LTR   R14,R14             NEGATIVE                    SS JUL87
         BZ    ISPMI040            ZERO THEN EXIT              SS JUL87
         BM    ISPXNUM5            NEGATIVE                    SS JUL87
         TM    SPFPRBI,X'20'       ABOVE                       SS JUL87
         BO    ISPXNUM6            TREAT AS NEGATIVE           SS JUL87
         L     R15,SPFLAST         END OF TABLE                SS JUL87
         S     R15,SPFTDTOP        DISPLAY TOP                 SS JUL87
         CR    R14,R15             NUMBER TO BIG               SS JUL87
         BNH   *+6                 NO                          SS JUL87
         LR    R14,R15             SET TO MAX                  SS JUL87
         ST    R14,SPFFIXED        DELETE THIS AMOUNT          SS JUL87
         A     R14,SPFTDTOP        CALC POSITIONING            SS JUL87
         S     R14,SPFCRP          DELTA                       SS JUL87
         ST    R14,SPFFIXE2        POSITION                    SS JUL87
         BAS   R2,ISPDEL           DO IT*                      SS JUL87
         BAS   R2,ISPQUERY         GET NEW VALUES              SS JUL87
         B     ISPMI040            REDISPLAY                   SS JUL87
ISPXNUM5 DS    0H                       *                      SS JUL87
         LPR   R14,R14             SET POSITIVE                SS JUL87
ISPXNUM6 DS    0H                       *                      SS JUL87
         L     R15,SPFTDTOP        DISPLAY TOP                 SS JUL84
         LTR   R15,R15             AT TOP                      SS JUL84
         BZ    ISPCLPL2            YES NO CLIP                 SS JUL84
         BCTR  R15,0               POSITION ONE UP             SS JUL84
         LTR   R15,R15             AT TOP                      SS JUL84
         BZ    ISPCLPL2            YES NO CLIP                 SS JUL84
         CR    R14,R15             TO BIG                      SS JUL87
         BNH   *+6                 NO                          SS JUL87
         LR    R14,R15             SET TO MAX                  SS JUL87
         ST    R14,SPFFIXED        DELETE AMOUNT               SS JUL87
         S     R15,SPFCRP          DELTA                       SS JUL87
         ST    R15,SPFFIXE2        SET POSITION                SS JUL87
         L     R15,SPFTDTOP        T TOP AGAIN                 SS JUL87
         SR    R15,R14             ADJUST T TOP                SS JUL87
         ST    R15,SPFSTART        NEW                         SS JUL87
         BAS   R2,ISPDEL           DO IT                       SS JUL87
         BAS   R2,ISPQUERY         RESET STATS                 SS JUL87
         B     ISPMI040            REDISPLAY                   SS JUL87
ISPCLPL2 LA    R14,1               DISPLAY AT TOP OF TABLE     SS AUG86
         ST    R14,SPFSTART                                    SS JUL84
         B     ISPMI040            REDISPLAY                   SS AUG86
ISPXTMAX DS    0H                       *                      SS JUL87
         L     R14,SPFTSIZE        DELETE NUMBER               SS JUL87
         ST    R14,SPFPRNU              *                      SS JUL87
ISPXTNM  DS    0H                       *                      SS JUL87
         BAS   R2,ISPQUERY              *                      SS JUL87
         L     R14,SPFPRNU         GET NUMBER                  SS JUL87
         LTR   R14,R14             NEGATIVE                    SS JUL87
         BZ    ISPMI040            ZERO THEN EXIT              SS JUL87
         BM    ISPXTNM5            NEGATIVE                    SS JUL87
         TM    SPFPRBI,X'20'       ABOVE                       SS JUL87
         BO    ISPXTNM6            TREAT AS NEGATIVE           SS JUL87
         L     R15,SPFTSIZE        END OF TABLE                SS JUL87
         S     R15,SPFTTOP         DISPLAY TOP                 SS JUL87
         CR    R14,R15             NUMBER TO BIG               SS JUL87
         BNH   *+6                 NO                          SS JUL87
         LR    R14,R15             SET TO MAX                  SS JUL87
         ST    R14,SPFFIXED        DELETE THIS AMOUNT          SS JUL87
         A     R14,SPFTTOP         CALC POSITIONING            SS JUL87
         S     R14,SPFTCRP         DELTA                       SS JUL87
         ST    R14,SPFFIXE2        POSITION                    SS JUL87
         BAS   R2,ISPDEL           DO IT*                      SS JUL87
         BAS   R2,ISPQUERY         GET NEW VALUES              SS JUL87
         B     ISPMI040            REDISPLAY                   SS JUL87
ISPXTNM5 DS    0H                       *                      SS JUL87
         LPR   R14,R14             SET POSITIVE                SS JUL87
ISPXTNM6 DS    0H                       *                      SS JUL87
         L     R15,SPFTTOP         DISPLAY TOP                 SS JUL84
         LTR   R15,R15             AT TOP                      SS JUL84
         BZ    ISPCLPT2            YES NO CLIP                 SS JUL84
         BCTR  R15,0               POSITION ONE UP             SS JUL84
         LTR   R15,R15             AT TOP                      SS JUL84
         BZ    ISPCLPT2            YES NO CLIP                 SS JUL84
         CR    R14,R15             TO BIG                      SS JUL87
         BNH   *+6                 NO                          SS JUL87
         LR    R14,R15             SET TO MAX                  SS JUL87
         ST    R14,SPFFIXED        DELETE AMOUNT               SS JUL87
         S     R15,SPFTCRP         DELTA                       SS JUL87
         ST    R15,SPFFIXE2        SET POSITION                SS JUL87
         L     R15,SPFTTOP         T TOP AGAIN                 SS JUL87
         SR    R15,R14             ADJUST T TOP                SS JUL87
         ST    R15,SPFTTOP         NEW                         SS JUL87
         BAS   R2,ISPDEL           DO IT                       SS JUL87
         BAS   R2,ISPQUERY         RESET STATS                 SS JUL87
         B     ISPMI040            REDISPLAY                   SS JUL87
ISPKLRTB DS    0H                                              SS JUL84
         BAS   R2,ISPTBEND         TERMINATE TABLE             SS AUG86
         BAS   R2,ISPTBCRE                                     SS AUG86
         B     ISPMI040                                        SS AUG86
ISPCLPT2 LA    R14,1               DISPLAY AT TOP OF TABLE     SS AUG86
         ST    R14,SPFTTOP                                     SS AUG86
         B     ISPMI040            REDISPLAY                   SS AUG86
         SPACE 5                        *                      SS AUG86
*  GENERAL PERPOSE LOCATE GREATER THAN OR EQU                  SS AUG86
ISPLOCMM DS    0H                       *                      SS AUG86
         L     R15,SPFOPER           GET BLANK AFTER COMMAND   SS NOV84
         LA    R14,45                LOOK THIS FAR             SS NOV84
         BAS   R2,ISPCKBLK           FIND NON-BLANK OPERAND    SS NOV84
         MVC   MEMLNAME,0(R15)       COPY OPERAND              SS AUG86
         OC    MEMLNAME,ISPBLK8      UPPER CASE                SS AUG86
         L     R0,SPFTKEYA           LOCATE ON KEY             SS AUG86
         B     ISPLOCTB              COMPLETE SERVICE          SS AUG86
ISPLOCLV DS    0H                       *                      SS AUG86
         L     R15,SPFOPER           GET BLANK AFTER COMMAND   SS NOV84
         LA    R14,45                LOOK THIS FAR             SS NOV84
         BAS   R2,ISPCKBLK           FIND NON-BLANK OPERAND    SS NOV84
         MVC   SPFVVOL,0(R15)        COPY OPERAND              SS AUG86
         OC    SPFVVOL,ISPBLK8       UPPER CASE                SS AUG86
         L     R0,SPFTKEYA           LOCATE ON KEY             SS AUG86
         B     ISPLOCTB              COMPLETE SERVICE          SS AUG86
ISPLOCLC DS    0H                       *                     DRK AUG98
         L     R15,SPFOPER           GET BLANK AFTER COMMAND  DRK AUG98
         LA    R14,45                LOOK THIS FAR            DRK AUG98
         BAS   R2,ISPCKBLK           FIND NON-BLANK OPERAND   DRK AUG98
         MVC   SPFCDSN,0(R15)        COPY OPERAND             DRK AUG98
         OC    SPFCDSN,ISPBLK44      UPPER CASE               DRK AUG98
         L     R0,SPFTKEYA           LOCATE ON KEY            DRK AUG98
         B     ISPLOCTB              COMPLETE SERVICE         DRK AUG98
ISPLOCCX DS    0H                       *                     DRK AUG98
         L     R15,SPFOPER           GET BLANK AFTER COMMAND  DRK AUG98
         LA    R14,45                LOOK THIS FAR            DRK AUG98
         BAS   R2,ISPCKBLK           FIND NON-BLANK OPERAND   DRK AUG98
         MVC   SPFXNUM,ISPBLK8       MOVE SPACES              DRK AUG98
         CLC   1(2,R15),ISPBLK8      1 DIGIT LEFT JUSTIFIED?  DRK AUG98
         BNE   *+4+6+4               NO                       DRK AUG98
         MVC   SPFXNUM+2(1),0(R15)   YES, RIGHT JUSTIFY       DRK AUG98
         B     ISPJUSTX                                       DRK AUG98
         CLI   2(R15),C' '           2 DIGITS LEFT JUSTIFIED? DRK AUG98
         BNE   *+4+6                 NO                       DRK AUG98
         MVC   SPFXNUM+1(2),0(R15)   YES, RIGHT JUSTIFY       DRK AUG98
ISPJUSTX DS    0H                       *                     DRK AUG98
         L     R0,SPFTKEYA           LOCATE ON KEY            DRK AUG98
         B     ISPLOCTB              COMPLETE SERVICE         DRK AUG98
ISPLOCTB DS    0H                       *                      SS AUG86
         LTR   R15,R15             ANY LOC VAR?               ABL JAN87
         BZ    ISPLOCNO            NO                          SS AUG86
         TM    SPFTFLG3,SPFTSDEF   IN RIGHT ORDER              SS AUG86
         BZ    ISPLOCER            NO, SHOULD USE FIND         SS AUG86
         LA    R14,TBSCAN          VERB                        SS AUG86
         LA    R15,SPFTBL          TABLE NAME                  SS AUG86
         STM   R14,R0,PARMLIST     START PARM LIST             SS AUG86
         LA    R14,ISPBLK8         NO EXTENT VARS              SS JUL87
         LA    R15,ISPBLK8         NO ROWID                    SS JUL87
         LA    R0,ISPNEXT          NEXT                        SS JUL87
         LA    R1,ISPNORD          NOREAD PARM                 SS AUG86
         STM   R14,R1,PARMLIST+12  NEXT 4 PARMS                SS AUG86
         LA    R14,VSPFCRP         GET CRP                     SS AUG86
         LA    R15,ISPGE           GREATER THAN OR EQU         SS AUG86
         STM   R14,R15,PARMLIST+28 NEXT 2 PARMS                SS AUG86
         OI    PARMLIST+32,X'80'   SET END                     SS AUG86
         BAS   R2,ISPSXEQ8              *                      SS AUG86
         LTR   R15,R15             FIND IT                     SS AUG86
         BNZ   ISPLOCT4            NO, DISPLAY AT BOTTOM       SS DEC87
         ICM   R15,15,SPFCRP       GET CRP                     SS AUG86
         BZ    ISPLOCT2            AT TOP                      SS AUG86
         BCT   R15,ISPLOCT3        BACK UP ONE                 SS AUG86
ISPLOCT2 LA    R15,1               AT TOP, SET TO 1            SS AUG86
ISPLOCT3 ST    R15,SPFTTOP         DO DISPLAY HERE             SS AUG86
         B     ISPMI100            DISPLAY TABLE               SS AUG86
ISPLOCT4 DS    0H                       *                      SS DEC87
         L     R15,SPFTSIZE        SET TO BOTTOM               SS DEC87
         ST    R15,SPFTTOP         DO DISPLAY HERE             SS DEC87
         B     ISPMI100            DISPLAY TABLE               SS DEC87
ISPLOCNO DS    0H                       *                      SS AUG86
         B     ISPMI028                 *                      SS AUG86
ISPLOCER DS    0H                       *                      SS AUG86
         MVC   SPFMSGID,ISPPDSM    SETUP MESSAGE               SS AUG86
         MVI   SPFMSGID+7,C'L'     LOCATE TYPE MESSAGE         SS AUG86
         MVI   SPFMSGID+6,C'1'     DISABLED MSG                SS AUG86
         B     ISPMI168            ERROR PROMPT                SS DEC87
ISPNORD  DC    C'NOREAD '          TBSCAN NOREAD OPERAND       SS AUG86
ISPGE    DC    C'(GE)'             CONDLIST(GE)                SS AUG86
*                                       *                      SS AUG86
*    PANEL SHIFT                        *                      SS AUG86
*                                       *                      SS AUG86
ISPMSHF  DS    0H                       *                      SS AUG86
         LH    R1,SPFTBPIN           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPMI040                                        SS AUG86
         LNR   R1,R1                                           SS NOV85
         BAS   R2,ISPSTKI           SWAP NEW PANEL             SS NOV85
         B     ISPMI040                                        SS AUG86
*                                       *                      SS AUG86
*    PANEL LEFT                         *                      SS AUG86
*                                       *                      SS AUG86
ISPMLEFT DS    0H                       *                      SS AUG86
         CLI   SPFSWAP,C'Y'          EXTENDED LEFT             SS DEC87
         BE    ISPMBKUP              YES, BACK UP              SS OCT88
         LH    R1,SPFTBPIP           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPMI040                                        SS AUG86
         TM    SPFTBPF3,SPFTBTYL     THIS LEFT ALREADY         SS AUG86
         BO    ISPMI040                 *                      SS AUG86
         B     ISPMSWAP                                        SS NOV85
*                                       *                      SS AUG86
*    PANEL RIGHT                        *                      SS AUG86
*                                       *                      SS AUG86
ISPMRITE DS    0H                       *                      SS AUG86
         CLI   SPFSWAP,C'Y'          EXTENDED RIGHT            SS DEC87
         BE    ISPMSHF               YES, SHIFT                SS OCT88
         LH    R1,SPFTBPIP           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPMI040                                        SS AUG86
         TM    SPFTBPF3,SPFTBTYR     THIS RIGHT ALREADY        SS AUG86
         BO    ISPMI040                 *                      SS AUG86
ISPMSWAP LNR   R1,R1                                           SS NOV85
         BAS   R2,ISPSTKI           SWAP NEW PANEL             SS NOV85
         B     ISPMI040                                        SS AUG86
ISPMBKUP DS    0H                                              SS NOV85
         MVC   SPFTSVH,SPFTBPI       SAVE CURRENT PANEL IDX    SS AUG86
ISPMBKU1 DS    0H                       *                      SS DEC87
         CLC   SPFTSVH,SPFTBPIN      BEFORE SAME PANEL         SS DEC87
         BE    ISPMI040              DONE                      SS DEC87
         LH    R1,SPFTBPIN           NEXT PANEL INDEX          SS DEC87
         LTR   R1,R1                 ZERO                      SS DEC87
         BZ    ISPMI040                                        SS DEC87
         LNR   R1,R1                                           SS DEC87
         BAS   R2,ISPSTKI           SWAP NEW PANEL             SS DEC87
         B     ISPMBKU1             LOOP UNTIL DONE            SS DEC87
*                                       *                      SS AUG86
*    SWAP TO NORMAL                     *                      SS AUG86
*                                       *                      SS AUG86
ISPMNORM DS    0H                       *                      SS AUG86
         MVC   SPFTSVH,SPFTBPI       SAVE CURRENT PANEL IDX    SS AUG86
         TM    SPFTBPF3,SPFTBTYN     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
ISPMNOR2 LH    R1,SPFTBPIN           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPMI040                                        SS AUG86
         LNR   R1,R1                                           SS NOV85
         BAS   R2,ISPSTKI           SWAP NEW PANEL             SS NOV85
         BAS   R2,ISPSETST          UPDATE STATUS              SS OCT88
         TM    SPFTBPF3,SPFTBTYN     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
         CLC   SPFTSVH,SPFTBPI       LOOP BACK TO ORIGINAL     SS AUG86
         BNE   ISPMNOR2              NO, CONTINUE SEARCH       SS AUG86
         B     ISPMI040                                        SS AUG86
*                                       *                      SS AUG86
*    SWAP TO ALTERNATE                  *                      SS AUG86
*                                       *                      SS AUG86
ISPMALTR DS    0H                       *                      SS AUG86
         MVC   SPFTSVH,SPFTBPI       SAVE CURRENT PANEL IDX    SS AUG86
         TM    SPFTBPF3,SPFTBTYA     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
ISPMALT2 LH    R1,SPFTBPIN           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPMI040                                        SS AUG86
         LNR   R1,R1                                           SS NOV85
         BAS   R2,ISPSTKI           SWAP NEW PANEL             SS NOV85
         BAS   R2,ISPSETST          UPDATE STATUS              SS OCT88
         TM    SPFTBPF3,SPFTBTYA     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
         CLC   SPFTSVH,SPFTBPI       LOOP BACK TO ORIGINAL     SS AUG86
         BNE   ISPMALT2              NO, CONTINUE SEARCH       SS AUG86
         B     ISPMI040                                        SS AUG86
*                                       *                      SS AUG86
*    SWAP TO DUAL LINE PANEL            *                      SS AUG86
*                                       *                      SS AUG86
ISPMDUAL DS    0H                       *                      SS AUG86
         MVC   SPFTSVH,SPFTBPI       SAVE CURRENT PANEL IDX    SS AUG86
         TM    SPFTBPF3,SPFTBTYD     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
ISPMDUA2 LH    R1,SPFTBPIN           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPMI040                                        SS AUG86
         LNR   R1,R1                                           SS NOV85
         BAS   R2,ISPSTKI           SWAP NEW PANEL             SS NOV85
         BAS   R2,ISPSETST          UPDATE STATUS              SS OCT88
         TM    SPFTBPF3,SPFTBTYD     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
         CLC   SPFTSVH,SPFTBPI       LOOP BACK TO ORIGINAL     SS AUG86
         BNE   ISPMDUA2              NO, CONTINUE SEARCH       SS AUG86
         B     ISPMI040                                        SS AUG86
*                                       *                      SS AUG86
*    SWAP TO WIDE TERMINAL PANEL        *                      SS AUG86
*                                       *                      SS AUG86
ISPMWIDE DS    0H                       *                      SS AUG86
         MVC   SPFTSVH,SPFTBPI       SAVE CURRENT PANEL IDX    SS AUG86
         TM    SPFTBPF3,SPFTBTYW     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
ISPMWID2 LH    R1,SPFTBPIN           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPMI040                                        SS AUG86
         LNR   R1,R1                                           SS NOV85
         BAS   R2,ISPSTKI           SWAP NEW PANEL             SS NOV85
         BAS   R2,ISPSETST          UPDATE STATUS              SS OCT88
         TM    SPFTBPF3,SPFTBTYW     THIS NORMAL PANEL         SS AUG86
         BO    ISPMI040              YES, NOTHING TO DO        SS AUG86
         CLC   SPFTSVH,SPFTBPI       LOOP BACK TO ORIGINAL     SS AUG86
         BNE   ISPMWID2              NO, CONTINUE SEARCH       SS AUG86
         B     ISPMI040                                        SS AUG86
*                                       *                      SS OCT88
*    COLS SUBCOMMAND  TO ADD COLS IN VIEW LOG                  SS OCT88
*                                       *                      SS OCT88
ISPCOLS  DS    0H                       *                      SS OCT88
         BAS   R2,ISPSETST           SET/GET STATUS            SS OCT88
         LTR   R1,R1                 LOG FUNCTION              SS OCT88
         BNZ   ISPMI040              NO, NOTHING TO DO         SS OCT88
         BAS   R2,ISPQUERY           GET CURRENT LOC           SS OCT88
         L     R15,SPFSTART          TOP OF DISPLAY            SS OCT88
         S     R15,SPFCRP            CURRENT LOC               SS OCT88
         BAS   R2,ISPSKIP            POSITION                  SS OCT88
         L     R15,SPFOPER           FIRST BLANK AFTER CMD    DRK DEC04
         MVC   FULLWORD(1),1(R15)                             DRK APR06
         OI    FULLWORD,X'40'        UPPER CASE               DRK APR06
         CLI   FULLWORD,C'I'         ISPF STYLE?              DRK APR06
         BE    ISPCOLSI              YES                      DRK APR06
         CLI   FULLWORD,C'S'         SEARCH-FOR STYLE?        DRK APR06
         BE    ISPCOLSS              YES                      DRK APR06
         CLI   FULLWORD,C'G'         CONTROL GLOBAL?          DRK MAR07
         BE    ISPCOLSG              YES                      DRK MAR07
         MVC   SPFLINE(100),ISPCOLS1 COLUMN                    SS OCT88
         MVC   SPFLINE+100(58),ISPCOLS1 COLUMN 101-158         SS OCT88
         B     ISPCOLSX                                       DRK DEC04
ISPCOLSI DS    0H                       *                     DRK DEC04
         MVC   SPFLINE(100),ISPCOLS2 COLUMN                   DRK DEC04
         MVC   SPFLINE+100(58),ISPCOLS2 COLUMN 101-158        DRK DEC04
         B     ISPCOLSX                                       DRK APR06
ISPCOLSS DS    0H                       *                     DRK APR06
         MVC   SPFLINE(109),ISPCOLS3 COLUMN 1-100             DRK APR06
         MVC   SPFLINE+109(49),ISPCOLS3+9  COL 101-149        DRK APR06
         B     ISPCOLSX                                       DRK MAR07
ISPCOLSG DS    0H                       *                     DRK MAR07
         MVC   SPFLINE(100),ISPCOLS4 COLUMN 1-100             DRK MAR07
         MVI   SPFLINE+100,C' '         BLANKS                DRK MAR07
         MVC   SPFLINE+101(57),SPFLINE+100 MORE BLANKS        DRK MAR07
         B     ISPCOLSX                                       DRK MAR07
ISPCOLSX DS    0H                       *                     DRK DEC04
         BAS   R2,ISPADDCO           ADD TO TABLE              SS OCT88
         B     ISPMI040              DONE                      SS OCT88
ISPCOLS1 DC    C'....+....1....+....2....+....3....+....4'     SS OCT88
         DC    C'....+....5....+....6....+....7....+....8'     SS OCT88
         DC    C'....+....9....+....0'                         SS OCT88
* ISPF STYLE                                                  DRK DEC04
ISPCOLS2 DC    C'----+----1----+----2----+----3----+----4'    DRK DEC04
         DC    C'----+----5----+----6----+----7----+----8'    DRK DEC04
         DC    C'----+----9----+----0'                        DRK DEC04
* SRCHFOR COLUMNS                                             DRK APR06
ISPCOLS3 DC    C'SRCHFOR  ' SRCHFOR PREFIX AREA               DRK APR06
         DC    C'----+----1----+----2----+----3----+----4'    DRK APR06
         DC    C'----+----5----+----6----+----7----+----8'    DRK APR06
         DC    C'----+----9----+----0'                        DRK APR06
* CONTROL GLOBAL HEADER                                       DRK MAR07
ISPCOLS4 DC    C'--------  ASSEMBLY  DEFAULT   ----------'    DRK MAR07
         DC    C'------------------------------          '    DRK MAR07
         DC    C'                    '                        DRK MAR07
         DROP  R4                       *                      SS AUG86
         TITLE 'CHANGE/COMPRESS/FIXPDS'                        SS NOV85
*                                       *                      SS AUG86
*  PROCESS CHANGE COMPRESS FIXPDS       *                      SS AUG86
*                                       *                      SS AUG86
ISPCCF   DS    0H                       *                      SS AUG86
         USING ISPCCF,R4                *                      SS AUG86
         IC    R15,$TLEX(R14)      SUB FUNCTION CODE           SS AUG86
         L     R15,ISPCCFTB(R15)   GET SUB FUC ADDR            SS AUG86
         BR    R15                      *                      SS AUG86
ISPCCFTB DS    0F                       *                      SS AUG86
         DC    A(ISPCCHG)     0   CHANGE                       SS AUG86
         DC    A(ISPCCMP)     4   COMPRESS                     SS AUG86
         DC    A(ISPCCFX)     8   FIXPDS                       SS AUG86
         SPACE 2                        *                      SS AUG86
ISPCCHG  DS    0H                       *                      SS AUG86
         L     R15,SPFOPER              BLANK AFTER CMD        SS AUG86
         LA    R14,30                   SCAN FOR OPERAND       SS AUG86
         BAS   R2,ISPCKBLK                                     SS AUG86
         LTR   R15,R15                  ANY                    SS AUG86
         BZ    ISPCCHGZ                 NO , NEED PROMPT       SS AUG86
         CLI   SPFFUNST+1,C'I'          MEMLIST ACTIVE         SS AUG86
         BZ    ISPCCHGP                 NO, CONTINUE           SS AUG86
         BAS   R2,ISPUSTKM              CLEANUP MEMLIST        SS AUG86
ISPCCHGP DS    0H                       *                      SS AUG86
         CLI   SPFMEMP,C'Y'         DEFAULT TO PROMPT TO MEML  SS AUG86
         BNE   ISPCCHGN             NO, CONTINUE NORMALLY      SS AUG86
         MVI   SPFPOST1,52          MEMLIST PROMPT PROCESS     SS AUG86
         OI    SPFLAG4,SPFCPOST     DO IT POST CHANGE          SS AUG86
ISPCCHGN DS    0H                       *                      SS AUG86
         L     R15,SPFOPER              BLANK AFTER CMD        SS DEC87
         L     R1,SPFSEC4A         GET  BASE                   SS MAY88
         LA    R1,SPFCHSV-SPFSEC4K(,R1)  POINT TO SPFCHSV      SS MAY88
         MVC   0(128,R1),0(R15)         SAVE OPERANDS          SS MAY88
         LA    R15,20                   CONTINUE PROCESS CMD   SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
ISPCCHGZ DS    0H                       *                      SS AUG86
         L     R14,ISP$RCHA             RCHANGE                SS AUG86
         ST    R14,SPFVTPT              *                      SS AUG86
         LA    R15,48                   PANEL PROCESS          SS AUG86
         BR    R3                       *                      SS AUG86
ISPCCFX  DS    0H                       *                      SS AUG86
*  FIXPDS WILL PROCESS THE SAME AS COMPRESS FOR NOW            SS AUG86
*  WOULD LIKE A FLAG TO TELL WHAT REALLY HAPPENED IN FIXPDS    SS AUG86
*    (I.E. CLEAR MEMBERS, EXPAND DIR, OR CHANGE ATTR)          SS AUG86
*    THEN A POST PROCESS CAN REBUILD MEMLIST IF STILL THE SAME SS AUG86
ISPCCMP  DS    0H                       *                      SS AUG86
* HIERARCHICAL SUPPORT REMOVED                                 SS OCT88
         CLI   SPFFUNST+1,C'I'          MEMLIST ACTIVE         SS AUG86
         BZ    ISPCCMPP                 NO, CONTINUE           SS AUG86
         LH    R1,SPFFUNLP+2            GET MEMLIST PANEL      SS AUG86
         LNR   R1,R1                    FOR SWAP               SS AUG86
         BAS   R2,ISPSTKI               SERVICE ROUTINE        SS AUG86
         L     R0,ISPSUBA               FIRST SUBLIST ON TABLE SS AUG86
         BAS   R2,ISPSUBI               INTERFACE TO SUBLIST   SS AUG86
         BAS   R2,ISPUSTKM              CLEANUP MEMLIST        SS AUG86
ISPCCMPP DS    0H                       *                      SS AUG86
         LH    R1,SPFFUNLP              GET CURRENT LOG PANEL  SS AUG86
         LNR   R1,R1                    FOR SWAP               SS AUG86
         BAS   R2,ISPSTKI               SERVICE ROUTINE        SS AUG86
         LA    R15,20                   CONTINUE PROCESS CMD   SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
         DROP  R4                       *                      SS AUG86
         TITLE 'ISPF - RECALL FUNCTION          '              SS NOV85
         SPACE 3                                               SS NOV84
* RECALL SUPPORT                                               SS MAY85
ISPRCAL  DS    0H          ****   RECALL SUBCOMMAND  ****      SS NOV84
         USING ISPRCAL,R4                                      SS NOV85
         IC    R15,$TLEX(R14)      SUB FUNCTION CODE           SS AUG86
         L     R15,ISPRCALT(R15)   GET SUB FUC ADDR            SS AUG86
         BR    R15                      *                      SS AUG86
ISPRCALT DS    0F                       *                      SS AUG86
         DC    A(ISPRCAL0)    0   NORMAL RECALL                SS AUG86
         DC    A(ISPRCALY)    4   RECALL ALTERNATE ENTER       SS AUG86
         DC    A(ISPRCALU)    8   RECALL SETALT                SS AUG86
         SPACE 2                        *                      SS AUG86
ISPRCALY DS    0H                       *                      SS JUL87
         MVI   SPFPRBI,X'90'      SET OPTIONS                  SS JUL87
         B     ISPRCALS           RECALL ALT                   SS JUL87
ISPRCALU DS    0H                       *                      SS JUL87
         MVI   SPFPRBI,X'80'      RECALL ALTERNATE             SS JUL87
         MVI   SPFPRBI2,X'80'     SETALT                       SS JUL87
         B     ISPRCALS           RECALL ALT                   SS JUL87
ISPRCAL0 DS    0H                       *                      SS JUL87
         L     R15,SPFOPER           FIRST BLANK AFTER CMD    ABL DEC84
         MVC   SPFRCOPT,0(R15)       COPY OPERANDS             SS DEC87
         LA    R14,30                TRY FOR 30 BYTES         ABL DEC84
         LA    R1,ISPPARRE           PARSE LIST                SS MAY85
         BAS   R2,ISPPARSI           PARSE ROUTINE             SS NOV85
         C     R15,ISPL8             RETURN CODE               SS MAY85
         BE    ISPRCAL3                                        SS MAY85
         BH    ISPRCALX                                        SS MAY85
         TM    SPFPRBI,X'01'         FROM LOG                  SS MAY85
         BO    ISPRCAL8                                        SS MAY85
         TM    SPFPRBI,X'20'         CHANGE OPERAND            SS MAY85
         BO    ISPRCAL6                                        SS MAY85
         TM    SPFPRBI,X'10'         ENTER                     SS MAY85
         BO    ISPRCAL5                                        SS MAY85
         TM    SPFPRBI,X'80'         ALTERNATE                 SS JUL87
         BO    ISPRCALS              YES                       SS JUL87
         B     ISPRCAL3                                        SS MAY85
ISPRCAL5 LH    R15,SPFZSAV           LENGTH                    SS MAR85
         BCTR  R15,0                 MACHINE LENGTH           ABL DEC84
         MVC   PUTGETBF(*-*),SPFZSAV <<EXECUTED>>             ABL DEC84
         EX    R15,*-6               MOVE IN THE SUBCOMMAND   ABL DEC84
         LA    R15,104               ROUTE TO ISPOPTT          SS NOV85
         BR    R3                    RETURN TO ROUTER          SS NOV85
ISPRCAL3 DS    0H                                              SS MAR85
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         LH    R15,SPFZSAV        GET LENG                     SS NOV84
         SH    R15,ISPH5          LESS 5 MVC                   SS NOV84
ISPRCAL2 MVC   SPFVZCMD(0),SPFZSAV+4                           SS NOV84
         EX    R15,ISPRCAL2       SAVE CMD FOR RECALL          SS NOV84
         B     ISPRCALP                                        SS NOV85
ISPRCAL6 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'90'      SHOULD NOT BE ENTER KEY      SS JUL87
         BO    ISPRCAL9           CONFLICT                     SS MAY85
         MVI   SPFVZCMD,C' '                                  ABL APR85
         MVC   SPFVZCMD+1(249),SPFVZCMD                       ABL APR85
         LA    R15,FIRST4K                                     SS NOV85
         MVC   SPFVZCMD(128),RECALLDS+4-FIRST4K(R15)     MSG   SS NOV85
         TM    SPFTBPF2,SPFTREP      REPLY PANEL?             ABL FEB87
         BNO   ISPRCALP              NO, BRANCH               ABL FEB87
         MVC   SPFVZCMD(8),ISPBLK8   CLEAR THE COMMAND NAME   ABL FEB87
         B     ISPRCALP                                        SS NOV85
ISPRCAL8 DS    0H                                              SS MAY85
         TM    SPFTBPF1,SPFTLOG   LOG                          SS NOV88
         BO    *+8                YES ,SKIP                    SS NOV88
         BAS   R2,ISPSTKLG        GO TO LOG                    SS NOV88
         TM    SPFPRBI,X'90'      TEST ENTER AND ALT KEY       SS MAY88
*    CHANGE OPTION WORKS WITH LOG OPTION                       SS MAY88
         BNZ   ISPRCAL9           CONFLICT                     SS MAY85
*   NEED INTERFACE TO RLOG                                     SS NOV85
         L     R4,ISPRLOGA                                     SS MAY85
         BASR  R3,R4                                           SS MAY85
         LA    R3,ISPROUT         RELOAD ROUTER ADDRESS       ABL MAR86
         L     R4,ISPRCALA        RELOAD BASE REGISTER        ABL MAR86
         LTR   R15,R15                                         SS MAY85
         BZ    ISPRCALP                                        SS NOV85
         B     ISPRCALX                                        SS NOV85
ISPRCALS DS    0H                       *                      SS JUL87
* CHECK FOR ENTER                       *                      SS JUL87
         L     R1,SPFSEC4A         GET  BASE                   SS MAY88
         LA    R1,SPFZSV2-SPFSEC4K(,R1) POINT TO SPFZSV2       SS MAY88
         LH    R15,0(R1)             LENGTH                    SS MAY88
         LTR   R15,R15               ANY LENGTH                SS JUL87
         BNZ   ISPRCALK              YES, OK                   SS JUL87
         OI    SPFPRBI2,X'80'        FORCE SETALT              SS JUL87
         B     ISPRCAL3              SKIP IT, NORMAL RECALL    SS JUL87
ISPRCALK DS    0H                       *                      SS JUL87
         TM    SPFPRBI,X'10'         ENTER                     SS JUL87
         BZ    ISPRCALN              NO                        SS JUL87
         BCTR  R15,0                 MACHINE LENGTH            SS JUL87
         MVC   PUTGETBF(*-*),0(R1)   <<EXECUTED>>              SS MAY88
         EX    R15,*-6               MOVE IN THE SUBCOMMAND    SS JUL87
         B     ISPRCALG              GO EXECUTE                SS JUL87
ISPRCALN DS    0H                                              SS JUL87
         MVI   SPFVZCMD,C' '                                   SS JUL87
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS JUL87
         LH    R15,0(R1)          GET LENG FROM SPFZSV2        SS MAY88
         SH    R15,ISPH5          LESS 5 MVC                   SS JUL87
ISPRCALL MVC   SPFVZCMD(0),4(R1)     <<EXECUTED>>              SS MAY88
         EX    R15,ISPRCALL       SAVE CMD FOR RECALL          SS JUL87
         B     ISPRCALP                                        SS JUL87
* SET UP RCAL FROM ALTERNATE SAVE       *                      SS JUL87
         B     ISPRCALP                 *                      SS JUL87
ISPRCAL9 DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                 SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'7'    CONFLICT MESSAGE             SS MAY85
ISPRCALX DS    0H                                              SS NOV85
         OI    SPFPRBI2,X'01'     RETRY RECALL PROMPT          SS DEC87
         NI    SPFPRBI2,255-X'80' NO SET ALT ALLOWED           SS DEC87
         B     ISPRCALP           DISPLAY WITH PROMPT          SS DEC87
ISPRCALP DS    0H                 SET UP TO PANEL PROCESSOR    SS NOV85
         BAS   R2,ISPSETVI                                     SS JUL87
         LA    R1,ISPBLK8          NO MESSAGE                  SS JUL87
         MVC   SPFSETA,ISPNO      DEFAULT NO SETALT            SS DEC87
         MVC   SPFENTER,ISPYES    DEFAULT ENTER YES            SS DEC87
         TM    SPFPRBI2,X'40'     NO ENTER                     SS DEC87
         BZ    *+10               NO    *                      SS DEC87
         MVC   SPFENTER,ISPNO     YES   *                      SS DEC87
         TM    SPFPRBI2,X'80'     SET ALT                      SS DEC87
         BZ    *+10               NO    *                      SS DEC87
         MVC   SPFSETA,ISPYES     YES   *                      SS DEC87
         TM    SPFPRBI2,X'01'     RETRY RECALL                 SS DEC87
         BZ    ISPRCALJ           NO JUMP OVER                 SS DEC87
         MVC   SPFENTER,ISPRTY          *                      SS DEC87
         LA    R1,SPFMSGID        SET FOR MSG                  SS DEC87
ISPRCALJ DS    0H                       *                      SS DEC87
         L     R14,SPFVTPT                                     SS JUL87
         SR    R15,R15                                         SS JUL87
         LA    R15,ISPRCALZ        ADDRESS OF PANEL            SS OCT88
         BAS   R2,ISPSINGI         DISPLAY THIS PANEL          SS JUL87
         LTR   R15,R15             NO END KEY                  SS JUL87
         BNZ   ISPRCALR            END KEY.. NO EXECUTE        SS DEC87
         MVC   SPFINPUT(250),SPFZSEL                           SS JUL87
         MVC   PUTGETBF(4),ISPLEN2                             SS JUL87
* CHECK FOR SET ALT                     *                      SS JUL87
         CLI   SPFSETA,C'Y'         SET ALTERNATE              SS DEC87
         BNE   ISPRCALC             SKIP IT                    SS DEC87
         L     R1,SPFSEC4A         GET  BASE                   SS MAY88
         LA    R1,SPFZSV2-SPFSEC4K(,R1) POINT TO SPFZSV2       SS MAY88
         MVC   0(254,R1),PUTGETBF                              SS MAY88
ISPRCALC DS    0H                       *                      SS JUL87
         CLI   SPFENTER,C'N'        NO ENTER                   SS DEC87
         BNE   ISPRCALG             NO, PROCESS IT             SS DEC87
ISPRCALR DS    0H                       *                      SS DEC87
         LA    R15,40               NORMAL DISPLAY             SS DEC87
         BR    R3                   TO ROUTER                  SS DEC87
ISPRCALG DS    0H                   GO PROCESS IT              SS JUL87
         LA    R15,104              ISPOPTT                    SS JUL87
         BR    R3                   RETURN TO ROUTER           SS JUL87
         DROP  R4                                              SS JUL87
ISPRTY   DC    C'R  '                   *                      SS DEC87
ISPRCALZ DC    CL8'&P.VREC'             *                      SS OCT88
         DS    0F                                              SS AUG86
ISPPARRE DC    X'51',X'41',X'00',X'00',F'-1000',F'1000'        SS JUN85
         DC    X'30',X'20',X'00',X'00',CL8'CHANGE'            ABL APR86
         DC    X'30',X'10',X'00',X'00',CL8'ENTER'             ABL APR86
         DC    X'30',X'80',X'00',X'00',CL8'ALTERNAT'           SS JUL87
         DC    X'30',X'00',X'40',X'00',CL8'NOENTER'            SS JUL87
         DC    X'34',X'09',X'00',X'00',CL8'FIRST' KEYWORDS     SS MAR85
         DC    X'30',X'01',X'00',X'00',CL8'LOG'               ABL APR86
         DC    X'23',X'05',X'00',X'00',CL8'PREVIOUS'           SS JUN85
         DC    X'23',X'07',X'00',X'00',CL8'LAST'               SS JUN85
         DC    X'23',X'00',X'80',X'00',CL8'SETALT'             SS JUL87
         DC    X'FF'                                           SS MAR85
         SPACE 1                                               SS MAY85
         TITLE 'ISPF - RECALL LEVEL 1 SUBROUTINE'              SS NOV85
*  RECALL FROM LOG                                             SS MAY85
ISPRLOG  DS    0H                                              SS MAY85
         USING ISPRLOG,R4                                      SS MAY85
ISPRLG10 DS    0H                  PROCESS RECALL FROM LOG     SS MAY85
         TM    SPFPRBI,X'40'       NUMBER SUPPLIED             SS MAY85
         BZ    ISPRLG12            NO                          SS JUN85
         L     R15,SPFPRNU         GET NUMBER                  SS JUN85
         LTR   R15,R15             CHECK VALUE                 SS JUN85
         BZ    ISPRLG12            ZERO, SET DEFAULT           SS JUN85
         BP    ISPRLG15            POSITIVE, OK                SS JUN85
         LPR   R15,R15             MAKE POSITIVE               SS JUN85
         OI    SPFPRBI,X'05'       PREVIOUS CODE               SS JUN85
         ST    R15,SPFPRNU         SAVE                        SS JUN85
         B     ISPRLG15                                        SS JUN85
ISPRLG12 DS    0H                                              SS JUN85
         LA    R15,1               DEFAULT TO 1                SS MAY85
         ST    R15,SPFPRNU                                     SS MAY85
ISPRLG15 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'08'       FIRST KEY WORD              SS MAY85
         BZ    ISPRLG30            NO, THEN USE CURRENT        SS MAY85
         TM    SPFPRBI,X'06'       LAST/PREV/-N KEYWORD?       SS JUN85
         BNZ   ISPRLGEC            YES, CONFLICT WITH FIRST    SS JUN85
         BAS   R2,ISPTOP           YES, START AT TOP           SS MAY85
         B     ISPRLG45                                        SS MAY85
ISPRLG30 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'02'       LAST KEYWORD?               SS JUN85
         BZ    ISPRLG35            NO, THEN USE CURRENT        SS JUN85
         BAS   R2,ISPBOTM          YES, START AT BOTTOM        SS JUN85
         B     ISPRLG45                                        SS JUN85
ISPRLG35 DS    0H                                              SS JUN85
         BAS   R2,ISPQUERY                                     SS NOV85
         L     R15,SPFSTART        START SEARCH HERE           SS MAY85
         S     R15,SPFCRP          RELATIVE POSITION           SS MAY85
         BAS   R2,ISPSKIP          POSITION SUBR               SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS?                   SS JUN85
         BO    ISPRLG47            BACK UP ONE                 SS JUN85
         B     ISPRLG45            START SEARCH                SS MAY85
ISPRLG40 DS    0H                                              SS MAY85
         ST    R15,SPFPRNU         SAVE NUMBER FOR NEXT TIME   SS MAY85
         B     ISPRLG47                                        SS MAY85
ISPRLG45 DS    0H                                              SS MAY85
         CLI   SPFLINE,C'>'        COMMAND FLAG                SS MAY85
         BNE   ISPRLG47            NOT A COMMAND               SS MAY88
         TM    SPFPRBI,X'20'       LOOKING FOR CHANGE COMMAND  SS MAY88
         BZ    ISPRLG50            GOT ANY COMMAND             SS MAY88
         MVC   SPFTSVH,SPFLINE+1   MAKE COPY OF COMMAND        SS MAY88
         OC    SPFTSVH,ISPBLK8     FORCE UPPER CASE            SS MAY88
         CLC   SPFTSVH,ISPRLG46    CHANGE COMMAND              SS MAY88
         BE    ISPRLG50            YES                         SS MAY88
         CLC   SPFTSVH,ISPRLG46+2  CHANGE COMMAND              SS MAY88
         BE    ISPRLG50            YES                         SS MAY88
         B     ISPRLG47            NO, SKIP                    SS MAY85
ISPRLG46 DC    C'C '               ONE CHAR CHANGE             SS MAY88
         DC    CL8'&NCHA'          FULL CHANGE COMMAND         SS MAY88
ISPRLG47 DS    0H                                              SS MAY85
         LA    R15,1               SKIP ONE                    SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS KEYWORD?           SS JUN85
         BZ    ISPRLG48                                        SS JUN85
         LNR   R15,R15             YES, SKIP -1                SS JUN85
ISPRLG48 DS    0H                                              SS JUN85
         BAS   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPRLGEN            RAN OFF END                 SS JUN85
         B     ISPRLG45                                        SS MAY85
ISPRLG50 DS    0H                                              SS MAY85
         L     R15,SPFPRNU         COUNT THEM                  SS MAY85
         BCT   R15,ISPRLG40        NOT THIS ONE                SS MAY85
         BAS   R2,ISPQUERY                                     SS NOV85
         MVC   SPFSTART,SPFCRP     DISPLAY HERE IF NO ACTION   SS APR88
         MVI   SPFVZCMD,C' '       BLANK ZCMD                  SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD  RIPPLE                SS MAY85
         LA    R1,SPFVZCMD         START OF BUFFER TEXT        SS MAY85
         ST    R1,SPFPRNU          SAVE FOR NEXT               SS MAY85
ISPRLG60 DS    0H                                              SS MAY85
         MVC   0(78,R1),SPFLINE+1  MOVE COMMAND TEXT           SS MAY85
         LA    R15,1               CHECK NEXT LINE             SS MAY85
         BAS   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPRLG90            NOT MORE IN TABLE           SS MAY85
         CLI   SPFLINE,C'-'        COMMAND CONTINUATION        SS MAY85
         BNE   ISPRLG90            NO, DONE                    SS MAY85
         L     R1,SPFPRNU          LAST TEXT POSITION          SS MAY85
         LA    R1,78(,R1)          POSITION TEXT 78 CHAR       SS MAY85
         ST    R1,SPFPRNU          LAST TEXT POSITION         ABL JUN85
         B     ISPRLG60            PROCESS IT                  SS MAY85
ISPRLGEC DS    0H                                              SS JUN85
         BAS   R2,ISPBOTM          RESET RECORD POINTER        SS JUN85
         MVC   SPFMSGID,ISPPDSM    INIT                        SS JUN85
         MVI   SPFMSGID+7,C'A'      CONFLICT                   SS JUN85
         MVI   SPFMSGID+6,C'7'             MESSAGE             SS JUN85
         B     ISPRLGE2                                        SS JUN85
ISPRLGEN DS    0H                                              SS MAY85
         BAS   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT                        SS MAY85
         MVI   SPFMSGID+7,C'F'      BOTTOM                     SS MAY85
         MVI   SPFMSGID+6,C'2'             MESSAGE             SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS?                   SS JUN85
         BZ    ISPRLGE2                                        SS JUN85
         MVI   SPFMSGID+6,C'3'     TOP                         SS JUN85
ISPRLGE2 DS    0H                                              SS JUN85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPRLG90 DS    0H                                              SS MAY85
         BAS   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         SR    R15,R15             GOOD COMMAND                SS MAY85
         BR    R3                                              SS MAY85
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS MAY85
