         TITLE 'MEMLIST COMMAND   '                            SS AUG86
*                                       *                      SS AUG86
*       PROCESS MEMLIST TO UPDATE STATS *                      SS AUG86
*                                       *                      SS AUG86
         SPACE 1
ISPMEMG  DS    0H                                             ABL JUN85
         USING ISPMEMG,R4               *                      SS AUG86
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS MAR85
         MVI   PUTGETBF+1,13         MODIFY LENGTH FOR INSERT ABL APR85
         CLC   ##SUBCOM+1(7),$ATT+1  ATTRIBUTE SUBCOMMAND?    ABL APR85
         BNE   ISPMEMG2              NO, BRANCH               ABL APR85
         TM    #OPTOPT,X'F0'         ANY CHANGES IN ATTRS?    ABL APR85
         BNO   ISPMEMG4              NO, BRANCH                SS MAY88
         B     ISPMEMG3              DO MEMLIST ON MEMBER(S)   SS JAN86
ISPMEMG2 DS    0H                                             ABL APR85
* MEMLIST FOR EDIT                                             SS JAN86
* FUTURE OPTION .. DO MEMLIST ALL TODAY WITH TIME              SS JUL87
         CLI   SPFEDUP,C'Y'          FULL UPDATE REQUESTED     SS JUL87
         BE    ISPMGRTY              YES                       SS JUL87
         ICM   R14,15,SPFZDATA       GET RC FROM ISPLINK CALL  SS JAN86
         BNZ   ISPMEMG4              NO ZERO, NO SAVE DONE     SS MAY88
ISPMEMG3 DS    0H                                              SS JAN86
         LH    R14,SPFZSAV           GET LENGTH                SS MAR85
         SL    R14,ISPL4             LESS 4 FOR PREFIX         SS MAR85
         LA    R15,SPFZSAV+4         ADDR OF OPERATED          SS MAR85
         BAS   R2,ISPCKBLK           FIND FIRST COMMAND        SS MAR85
         LTR   R15,R15               WE OK                     SS MAR85
         BZ    ISPMEMG4              NO                        SS MAY88
         LA    R1,C' '               SCAN FOR BLANK            SS MAR85
         BAS   R2,ISPCLI                                       SS MAR85
         LTR   R15,R15               SHORT BUFFER              SS MAR85
         BZ    ISPMEMG4                                        SS MAY88
         LA    R1,ISPPARST           GET STRING PARSE          SS MAR85
         BAS   R2,ISPPARSI           PARSE ROUTINE             SS NOV85
         MVC   SPFMSGID(8),ISPBLK8   CLEAR ANY MESSAGE        ABL JUN85
         LTR   R15,R15               GOOD                      SS MAR85
         BNZ   ISPMGRP               NO, TRY LAST MEMBER GRP  ABL JUN85
         LH    R1,SPFPRLN            GET STRING LENGTH         SS MAR85
         L     R15,SPFPRSR           GET STRING ADDR           SS MAR85
         EX    R1,ISPMEMG0           COPY IT                   SS MAR85
         AH    R1,PUTGETBF           CALCULATE LENGTH OF DATA  SS MAR85
         STH   R1,PUTGETBF           STORE NEW LENGTH          SS MAR85
         OI    SPFLAG2,SPFUPDA       MUST BE REFRESHED         SS MAR84
         B     ISPEXIT                                         SS MAR85
ISPMEMG4 DS    0H                       *                      SS MAY88
         LA    R15,40                BACK THROUGH ISPDISP6     SS MAY88
         BR    R3                       *                      SS MAY88
ISPMEMG0 MVC   PUTGETBF+12(0),0(R15) COPY MEMBER OR  GROUP     SS MAR85
         SPACE 2
ISPMGRP  DS    0H                                             ABL JUN85
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS MAR85
         MVI   PUTGETBF+13,C'*'      CONVERT TO LAST GROUP     SS MAR85
         B     ISPEXIT                                         SS MAR85
* MEMLIST ALL TODAY WITH TIME           *                      SS JUL87
ISPMGRTY DS    0H                       *                      SS JUL87
         OI    MEMFLAG2,MEMLTMCK+MEMLTMED SET TIME CHECK       SS JUL87
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS JUL87
         MVC   PUTGETBF+23(8),ISPBLK8   *                      SS JUL87
         MVC   PUTGETBF+15(8),ISPMGRTD                         SS JUL87
         MVC   PUTGETBF(2),ISPCMD30     *                      SS JUL87
         B     ISPEXIT                                         SS JUL87
ISPMGRTD DC    CL8'TODAY'               *                      SS JUL87
         DROP  R4                                             DRK NOV98
         TITLE 'MEMLIST COMMAND   '                            SS NOV85
*                                       *                      SS AUG86
*       PROCESS MEMLIST COMMAND         *                      SS AUG86
*                                       *                      SS AUG86
ISPMML   DS    0H                       *                      SS AUG86
         USING ISPMML,R4                *                      SS AUG86
* HIERARCHICAL SUPPORT REMOVED                                 SS OCT88
         CLI   SPFFUNST+1,C'P'          MEMLIST PENDING PROC   SS AUG86
         BE    ISPMMLC4                 YES, LET TBDSP REPROC  SS AUG86
         OI    SPFLAG3,SPFCONV          CONVERT ERROR--> VIEW ABL JAN87
         OI    SPFLAG0,SPFCKER          LOOK FOR PDS ERROR MSGABL JAN87
         NI    SPFLAG0,255-SPFMSGER     NO ERROR YET          ABL JAN87
         IC    R15,$TLEX(R14)      SUB FUNCTION CODE           SS AUG86
         L     R15,ISPMMLTB(R15)   GET SUB FUC ADDR            SS AUG86
         BR    R15                      *                      SS AUG86
ISPMMLTB DS    0F                       *                      SS AUG86
         DC    A(ISPMMLP)     0    MEMLIST PROMPT (AFTER CHG)  SS AUG86
         DC    A(ISPMMLC)     4    MEMLIST COMMAND             SS AUG86
         DC    A(ISPMMLA)     8    MEMLIST ALL                 SS AUG86
         DC    A(ISPMMLG)    12    MEMLIST GROUP               SS AUG86
         DC    A(ISPMMLT)    16    MEMLIST TODAY               SS AUG86
         DC    A(ISPMMLK)    20    MEMLIST ALL WITH CHECK      SS AUG86
         DC    A(ISPMMLT)    24    MEMLIST CURRENT             SS NOV86
         DC    A(ISPMMLT)    28    MEMLIST OLD                 SS NOV86
         DC    A(ISPMMLT)    32    MEMLIST YEAR                SS NOV86
ISPMMLP  DS    0H                       *                      SS AUG86
         MVI   SPFVZCMD,C' '            BLANK                  SS AUG86
         MVC   SPFVZCMD+1(249),SPFVZCMD      RIPPLE            SS AUG86
         TM    DSORG,DS1DSGPO     PARTITIONED?                ABL JAN87
         BNO   ISPMMLP2           NO, NO PROMPTING            ABL JAN87
         LA    R15,96             MEML  PROMPT PANEL (SOURCE)  SS AUG86
         TM    FLAGSCC,RECFMU     LOAD MODULE?                ABL JAN87
         BNO   *+8                NO, BRANCH                  ABL JAN87
         LA    R15,160            MEML  PROMPT PANEL (LOAD)   ABL JAN87
ISPMMLP3 DS    0H                                              SS FEB87
         AL    R15,ISP$PNA        ADDRESS OF PANEL TABLE       SS AUG86
         LA    R1,ISPBLK8         NO MESSAGE                  ABL JAN87
         BAS   R2,ISPSINGI        DISPLAY PANEL                SS AUG86
         C     R15,ISPL8          END KEY                      SS AUG86
         BE    ISPMMLP2           RETURN TO ORIGINAL PANEL     SS AUG86
         CLI   SPFZSEL,C'?'       OPERAND PROMPT?              SS FEB87
         BNE   ISPMMLP4           NO, BRANCH                   SS FEB87
         LA    R0,0               DEFAULT PANEL                SS OCT88
         LA    R15,168            OPERAND PROMPT PANEL         SS FEB87
         TM    FLAGSCC,RECFMU     LOAD MODULE?                ABL FEB87
         BNO   ISPMMLP3           NO, BRANCH                  ABL FEB87
         LA    R15,176            LOAD MODULE                 ABL FEB87
         B     ISPMMLP3           PROCESS IT                   SS FEB87
ISPMMLP4 DS    0H                                              SS FEB87
         MVC   SPFINPUT(250),SPFZSEL    COPY                   SS AUG86
         MVC   PUTGETBF(4),ISPLEN2      SET LENGTH 254         SS AUG86
         LA    R15,104                  CMD OPT PROCESSOR      SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
ISPMMLP2 DS    0H                       *                      SS AUG86
         TM    SPFLAG4,SPFFFUN          FROM FUNCTION PROC     SS AUG86
         BZ    ISPMMLE                  NO, RTN TO ORG PANEL   SS AUG86
         L     R14,ISP$FUNA             POINT TO FUNCTION      SS AUG86
         ST    R14,SPFVTPT              *                      SS AUG86
         LA    R15,16                   FUNCTION PROCESS       SS AUG86
         TM    DSORG,DS1DSGPO           PARTITIONED?          ABL JAN87
         BOR   R3                       YES, BRANCH           ABL JAN87
         MVC   SPFMSGID,ISPPDSM         GENERIC MESSAGE       ABL JAN87
         MVI   SPFMSGID+6,C'1'          PDSM..1P MESSAGE      ABL JAN87
         MVI   SPFMSGID+7,C'P'          NOT PARTITIONED MSG   ABL JAN87
         LA    R15,56                   ERROR ROUTINE, PART 2 ABL JAN87
         BR    R3                       *                      SS AUG86
ISPMMLC  DS    0H                       MEML CHECK             SS AUG86
         CLC   0(8,R14),ISPMMLCX        ABBREVIATION           SS AUG86
         BNE   ISPMMLC1                 MAY NEED PROMPT        SS AUG86
         L     R15,SPFOPER              *                      SS AUG86
         MVC   SPFZSEL(242),0(R15)      SAVE DATA              SS AUG86
         MVC   SPFINPUT(8),$MML         MEMLIST CMD            SS AUG86
         MVC   SPFINPUT+8(242),SPFZSEL  PUT IT BACK TOGETHER   SS AUG86
         LA    R15,SPFINPUT+8           *                      SS AUG86
         ST    R15,SPFOPER              SET IT                 SS AUG86
ISPMMLC1 DS    0H                       *                      SS AUG86
         L     R15,SPFOPER              BLANK AFTER CMD        SS AUG86
         LA    R14,30                   SCAN FOR OPERAND       SS AUG86
         BAS   R2,ISPCKBLK                                     SS AUG86
         LTR   R15,R15                  ANY                    SS AUG86
         BZ    ISPMMLC2                 NO , MAY NEED PROMPT   SS AUG86
         CLC   0(2,R15),ISPMMLCC        SINGLE COLON?          SS AUG86
         BNE   ISPMMLCD                 NO, SET UP COMMAND    ABL JAN87
         LA    R15,2(,R15)              GO TO AFTER COLON     ABL JAN87
         LA    R14,20                   SCAN FOR OPERAND      ABL JAN87
         BAS   R2,ISPCKBLK                                    ABL JAN87
         LTR   R15,R15                  ANY OPERAND?          ABL JAN87
         BZ    ISPMMLA2                 NO, DO MEMLIST ALL    ABL JAN87
         B     ISPMMLCD                 YES, SET UP COMMAND   ABL JAN87
ISPMMLCC DC    C': '                    ALL MEMBERS            SS AUG86
ISPMMLCX DC    CL8'&IMLX'               MEMLIST ABBREVIATION   SS AUG86
ISPMMLC2 DS    0H                       *                      SS AUG86
         TM    DSORG,DS1DSGPO           PARTITIONED?          ABL JAN87
         BO    ISPMMLCP                 YES, BRANCH           ABL JAN87
         MVC   SPFMSGID,ISPPDSM         GENERIC MESSAGE       ABL JAN87
         MVI   SPFMSGID+6,C'1'          PDSM..1P MESSAGE      ABL JAN87
         MVI   SPFMSGID+7,C'P'          NOT PARTITIONED MSG   ABL JAN87
ISPMMLCP DS    0H                                             ABL JAN87
         CLI   SPFTBPFI+1,1             THIS MEMLIST           SS AUG86
         BNE   ISPMMLC3                 NO, CHECK ACTIVE       SS AUG86
         TM    SPFLAG4,SPFFFUN          FROM FUNCTION          SS AUG86
         BZ    ISPMMLP                  NO,  NEED PROMPT       SS AUG86
ISPMMLC3 DS    0H                       *                      SS AUG86
         CLI   SPFFUNST+1,C'I'          IN MEMLIST INACTIVE    SS AUG86
         BE    ISPMMLP                  YES, NEED PROMPT       SS AUG86
         BAS   R2,ISPSETST              SAVE CURRENT TBL STAT  SS FEB89
         LH    R1,SPFFUNLP+2            GET MEMLIST PANEL ID   SS FEB89
         LNR   R1,R1                    SET FOR SWAP           SS FEB89
         BAS   R2,ISPSTKI               DO SWAP                SS FEB89
         B     ISPMMLE                  DISPLAY                SS FEB89
ISPMMLC4 DS    0H                       *                      SS FEB89
         CLI   $TLEX(R14),4             WHICH COMMAND          SS FEB89
         BH    ISPMML1B                 CANNOT PROCESS, BUSY   SS FEB89
         L     R15,SPFOPER              BLANK AFTER CMD        SS FEB89
         LA    R14,30                   SCAN FOR OPERAND       SS FEB89
         BAS   R2,ISPCKBLK                                     SS FEB89
         LTR   R15,R15                  ANY                    SS FEB89
         BNZ   ISPMML1B                 YES, CANNOT PROCESS    SS FEB89
         BAS   R2,ISPSETST              SAVE CURRENT TBL STAT  SS FEB89
         LH    R1,SPFFUNLP+2            GET MEMLIST PANEL ID   SS FEB89
         LNR   R1,R1                    SET FOR SWAP           SS FEB89
         BAS   R2,ISPSTKI               DO SWAP                SS FEB89
         LA    R15,36                   PENDING ACTION PROC    SS FEB89
         BR    R3                       RETURN TO ROUTER       SS FEB89
ISPMML1B DS    0H                       *                      SS AUG86
         MVC   SPFMSGID,ISPPDSM         GENERIC MESSAGE        SS FEB89
         MVI   SPFMSGID+6,C'1'          PDSM..1B MESSAGE       SS FEB89
         MVI   SPFMSGID+7,C'B'          BUSY MSG               SS FEB89
         B     ISPMMLE                  DISPLAY                SS FEB89
ISPMMLE  DS    0H                                              SS AUG86
         LA    R15,100                  TO DISPLAY             SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
ISPMMLK  DS    0H                       *                      SS AUG86
         OI    MEMFLAG2,MEMLNALL        NEW MEMLIST ALL        SS AUG86
         OI    SPFLAG4,SPFCPOST         POST PROCESSING        SS AUG86
         MVI   SPFPOST1,80              ALIAS CHECK ROUTINE    SS AUG86
         B     ISPMMLA                  GO MEMLIST ALL         SS AUG86
ISPMMLA  MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS AUG86
ISPMMLA2 DS    0H                       *                      SS AUG86
         CLI   SPFFUNST+1,C'I'          IN MEMLIST INACTIVE    SS AUG86
         BE    ISPMMLCD                 NO, JUST DO IT         SS JUL87
         BAS   R2,ISPUSTKM              CLEAR TABLE            SS AUG86
         OI    MEMFLAG2,MEMLNALL        NEW MEMLIST ALL        SS AUG86
         B     ISPMMLCD                 NOW DO IT              SS AUG86
* MEMLIST GROUP                         *                      SS AUG86
ISPMMLG  DS    0H                       *                      SS AUG86
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS AUG86
         MVI   PUTGETBF+13,C'*'      CONVERT TO LAST GROUP     SS AUG86
         B     ISPMMLCD                                        SS AUG86
* MEMLIST ALL WITH OPTION (IE TODAY)    *                      SS JUL87
ISPMMLT  DS    0H                       *                      SS JUL87
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS JUL87
         MVC   PUTGETBF+23(8),ISPBLK8   *                      SS JUL87
         L     R14,SPFVTPT              RELOAD CMD TBL ENTRY   SS JUL87
         MVC   PUTGETBF+15(8),$TLCM(R14) TYPE                  SS JUL87
         MVC   PUTGETBF(2),ISPCMD30     *                      SS JUL87
         B     ISPMMLCD                 *                      SS JUL87
* INVALID MESSAGE                       *                      SS AUG86
ISPMMLIV DS    0H                       *                      SS AUG86
         LA    R15,28                   *                      SS AUG86
         BR    R3                       RETURN TO ROUTER       SS AUG86
* COMMON COMMAND SETUP                  *                      SS AUG86
ISPMMLCD DS    0H                       *                      SS AUG86
         LH    R15,PUTGETBF       GET LENG                     SS AUG86
         BCTR  R15,0              LESS 1 MVC                   SS AUG86
ISPMMLCM MVC   SPFZSAV(0),PUTGETBF                             SS AUG86
         EX    R15,ISPMMLCM       SAVE CMD FOR RECALL          SS AUG86
         OI    SPFLAG3,SPFLOGM    LOG THE COMMAND              SS AUG86
         LA    R15,112              ROUTE TO ISPCMDC           SS AUG86
         BR    R3                                              SS AUG86
         SPACE 2                        *                      SS AUG86
         DROP  R4                                              SS MAR85
         TITLE 'ISPF - MEMLIST  FUNCTION'                      SS NOV85
*****************************************************          SS NOV85
*                                                              SS NOV85
*        MEMLLIST SUPPORT FUNCTION                             SS NOV85
*                                                              SS NOV85
*****************************************************          SS NOV85
         SPACE 1
MEMLFUNC DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
* AT THIS POINT ALTERNATE MEMBER PROCESSING CAN BE INSERTED    SS NOV85
         LA    R1,MEMLVINI        VDEFINE ALL VARS             SS AUG86
         BAS   R2,ISPVDEFX        SERVICE ROUTINE              SS AUG86
ISPMEMOK DS    0H                                              SS SEP84
         LA    R1,0               POP PANEL 3 CKT              SS NOV85
         LA    R2,3               IS THIS                      SS AUG86
         CH    R2,SPFTBPI               CKT PANEL 3            SS AUG86
         BNE   *+8                NO, NO UNSTACK               SS AUG86
         BAS   R2,ISPSTKI         USTACK ROUTINE               SS NOV85
* HIERARCHICAL SUPPORT REMOVED                                 SS OCT88
         TM    SPFLAG3,SPFCHN     HAS CHANGE DSN BEEN DONE    ABL OCT84
         BZ    ISPMEMK1           NO, SKIP                    ABL OCT84
         NI    SPFLAG3,255-SPFCHN-SPF300A CLEAR               ABL OCT84
         BAS   R2,ISPUSTKM        UNSTACK AND KILL OLD TABLE   SS NOV85
         B     ISPMEMK3           SET UP NEW TABLE             SS AUG86
ISPMEMK1 DS    0H                                             ABL OCT84
         CLI   SPFTBPFI+1,1       MEMLIST FUNCTION             SS AUG86
         BE    ISPMEMK5           YES                          SS AUG86
         BAS   R2,ISPSETST        FIRST SAVE STATUS            SS AUG86
         CLI   SPFFUNST+1,C'I'    IS MEMLIST INACTIVE          SS AUG86
         BE    ISPMEMK3           YES, SETUP NEW TABLE         SS AUG86
         LH    R1,SPFFUNLP+2      LAST PANEL                   SS AUG86
         LNR   R1,R1              SET FOR SWAP                 SS AUG86
         BAS   R2,ISPSTKI         DO SWAP                      SS AUG86
         B     ISPMEMK5                 *                      SS AUG86
ISPMEMK3 DS    0H                       *                      SS AUG86
         LA    R1,5               ASSUME SOURCE PANEL          SS NOV85
         TM    FLAGSCC,RECFMU     LOAD LIB                     SS NOV85
         BZ    ISPMEMK4           NO                           SS NOV85
         LA    R1,7               LOAD LIB PANEL INDEX         SS NOV85
ISPMEMK4 CH    R1,SPFTBPI         SAME PANEL                   SS NOV85
         BE    ISPMEMK5           YES, SKIP STACK              SS NOV85
         LNR   R1,R1              SET FOR SWAP                 SS AUG86
         BAS   R2,ISPSTKI         STACK NEW PANEL              SS NOV85
ISPMEMK5 DS    0H                                              SS NOV85
         TM    SPFTFLG1,SPFTACT   TABLE CREATED?               SS AUG86
         BO    ISPMEMK2           YES, BRANCH                  SS SEP84
         LA    R15,ISPMEMSO       SORT KEYS                    SS AUG86
         ST    R15,SPFTSORA       SAVE FOR TABLE               SS AUG86
         MVC   SPFTBL,SPFCSUF     GET BASE NAME                SS AUG86
         MVI   SPFTBL+2,C'M'      MAKE NAME "PDM"              SS AUG86
         LA    R0,MEMTNAMS              *                      SS AUG86
         TM    FLAGSCC,RECFMU     LOAD LIB                     SS AUG86
         BZ    ISPMEMS2                 *                      SS AUG86
         MVI   SPFTBL+2,C'U'      MAKE NAME "PDU"              SS AUG86
         LA    R0,MEMTNAMU              *                      SS AUG86
ISPMEMS2 DS    0H                       *                      SS AUG86
         XC    SPFTFLG1(4),SPFTFLG1                            SS NOV85
         XC    SPFTFF(2),SPFTFF                                SS NOV85
         LA    R15,MEMLTKEY        TABLE KEY                   SS AUG86
         BAS   R2,ISPTBOPN         DO OPEN AND SORT            SS AUG86
         LH    R0,SPFTBPSR         GET SORT INDEX              SS OCT88
         BAS   R2,ISPSORTI         GO TO SORT                  SS OCT88
         OI    MEMFLAG2,MEMLNTBL   FLAG NEW TABLE             ABL JAN87
         LA    R2,1                SET DISPLAY                 SS AUG86
         ST    R2,SPFTTOP                     TO FIRST LINE    SS AUG86
         ST    R2,SPFTTOP2                    TO FIRST LINE    SS JUL87
         BAS   R2,ISPSETST         ALSO INIT STATUS FLAG       SS AUG86
         L     R1,SPFTHOME         GET TABLE ADDRESS PTR       SS MAY89
         ST    R1,SPFMEMTA         SET MEML TBL PTR            SS MAY89
         MVC   0(8,R1),SPFTBL      SET NAME                    SS MAY89
         SPACE 2                                               SS JUL84
ISPMEMK2 DS    0H                                              SS SEP84
         NI    MEMFLAG0,255-MEMLLKDM-MEMLNKDM RESET            SS AUG86
         NI    MEMFLAG0,255-MEMLLKD1-MEMLNKD1 RESET            SS AUG86
         TM    FLAGSHH,FLKEDYES+FLKEDNO  ANY SETTING?         ABL JAN87
         BZ    ISPMEML9                  NO, BRANCH           ABL JAN87
         TM    FLAGSHH,FLKEDNO       NOLKEDDATE?              ABL JAN87
         BNO   ISPMEML5              NO, TRY LKEDDATE         ABL JAN87
         OI    MEMFLAG0,MEMLNKDM+MEMLNKD1   SET FOR NO LKED    SS AUG86
         B     ISPMEML9                 *                      SS AUG86
ISPMEML5 DS    0H                       *                      SS AUG86
         TM    FLAGSHH,FLKEDYES      LKEDDATE?                ABL JAN87
         BNO   ISPMEML9              NO, BRANCH               ABL JAN87
         OI    MEMFLAG0,MEMLLKDM+MEMLLKD1   SET FOR LKED       SS AUG86
ISPMEML9 DS    0H                       *                      SS AUG86
         TM    MEMFLAG2,MEMLALED        ALIAS EDIT CHECK       SS NOV88
         BZ    ISPMEML6                 NO, SKIP               SS NOV88
         CLC   SPFEDTTR,DIRTTR          SAME TTR               SS NOV88
         BNE   ISPMEML6                 NO, SKIP               SS NOV88
         MVC   DIRTTR,SPFE2TTR          SET NEW TTR            SS NOV88
         ST    R6,SPFSAV6               SAVE R6                SS NOV88
         BAS   R2,OPENSTOW              *                      SS NOV88
         B     ISPMEMLD                 OPEN ERROR             SS NOV88
         L     R6,SPFSAV6               GET  R6                SS NOV88
         MVC   DCBRELAD-IHADCB+STOWDCB(3),DIRTTR               SS NOV88
         STOW  STOWDCB,DIRNAME,R        REPLACE                SS NOV88
         B     ISPMEML7                 PROCESS IT             SS NOV88
ISPMEMLD DS    0H                       *                      SS NOV88
         L     R6,SPFSAV6               GET  R6                SS NOV88
ISPMEML6 DS    0H                       *                      SS NOV88
         TM    MEMFLAG2,MEMLTMCK        TIME CHECK             SS AUG86
         BZ    ISPMEML7                 NO, SKIP               SS NOV88
         TM    FLAGSCC,RECFMU           LOAD                   SS AUG86
         BO    ISPMEML7                 YES, SKIP              SS AUG86
         TM    MEMFLAG2,MEMLTMPR        PREVIOUS DATE          SS AUG86
         BO    ISPMEML8                 YES                    SS AUG86
         CLC   DIRSPFCD(6),SPFDAY       COMPARE DATE AND TIME  SS AUG86
         BLR   R3                       LOW, DO NOT ADD        SS AUG86
         B     ISPMEML7                 OK, CONTINUE           SS AUG86
ISPMEML8 DS    0H                       *                      SS AUG86
         CLC   DIRSPFCD(6),SPFDAY       COMPARE DATE AND TIME  SS AUG86
         BNLR  R3                       NOT LOW, DO NOT ADD    SS AUG86
ISPMEML7 DS    0H                       *                      SS AUG86
         NI    MEMFLAG2,255-MEMLTMNO    RESET BEFORE CALL      SS NOV86
         BAS   R2,MEMLISTI        GET MEMLIST SUB              SS NOV85
         TM    MEMFLAG2,MEMLTMNO        REQUEST BYPASS THIS 1  SS NOV86
         BZ    ISPMEMLA                 NO                     SS NOV86
         NI    MEMFLAG2,255-MEMLTMNO    RESET                  SS NOV86
         BR    R3                       RETURN, DO NOT PROCESS SS NOV86
ISPMEMLA DS    0H                       *                      SS NOV86
*  USING SORTED FILES WITH ORDER, NOLONGER NEED SEQ LOAD       SS AUG86
         BAS   R2,ISPGET          FIND ENTRY TO REPLACE        SS SEP84
         LTR   R15,R15            WE FIND IT                   SS SEP84
         BZ    ISPMEML2           YES                          SS SEP84
ISPMEML4 DS    0H                 ADD NEW ENTRY HERE           SS SEP84
         MVC   MEMLDATA,ISPBLK8                                SS SEP84
         TM    MEMFLAG2,MEMLTMED  EDIT UPDATE                  SS JUL87
         BZ    *+10                     *                      SS JUL87
         NOPR  R0                                             DRK SEP17
         NOPR  R0                                             DRK SEP17
         NOPR  R0                                             DRK SEP17
*        MVC   MEMLDATA,ISPEDIT         *                      SS JUL87
         BAS   R2,MEMLSET         SET VARS                     SS AUG86
         BAS   R2,ISPTBADD        ADD IN ORDER                 SS AUG86
         BR    R3                 RETURN                       SS SEP84
ISPMEML2 DS    0H                                              SS SEP84
         TM    MEMFLAG2,MEMLTMED  EDIT UPDATE                  SS JUL87
         BZ    ISPMEMLB                 *                      SS JUL87
*        MVC   MEMLDATA,ISPEDIT         *                      SS JUL87
         MVC   MEMLOPT,MEM2OPT          SAVE OPT CODE IF ANY   SS JUL87
         B     ISPMEML3                 *                      SS JUL87
ISPMEMLB DS    0H                       *                      SS JUL87
         TM    SPFLAG2,SPFUPDA    REFRESH ENTRIES              SS SEP84
         BO    ISPMEML3           YES                          SS SEP84
         MVC   MEMLDATA,ISPBLK8   NO, CLEAR MSGS               SS SEP84
ISPMEML3 DS    0H                                              SS SEP84
         BAS   R2,MEMLSET         SET VARS                     SS AUG86
         BAS   R2,ISPTBMOD         MOD IN ORDER                SS AUG86
         BR    R3                  RETURN                      SS SEP84
         DROP  R4                                              SS NOV85
         SPACE 3                        *                      SS AUG86
ISPMEMSO DC    C'(MEMLNAME,C,A)'   SORT LIST                   SS AUG86
* MEMLIST SOURCE
MEMTNAMS DC    C'( '               MEM TBL                     SS AUG86
MEMLVR2  DC    C'MEMLDATA '        USER ENTERED DATA           SS AUG86
MEMLVR1  DC    C'MEMLOPT '                                     SS AUG86
MEMLVR5  DC    C'MEMLALIS '                                    SS AUG86
MEMLVR3  DC    C'MEMLTTR '         MEM TBL ALIAS SCAN ARG LIST SS AUG86
MEMLVR4  DC    C'MEMLXTTR '        HEX TTR                     SS AUG86
MEMLVR6  DC    C'MEMLSTAT '        DELETE/RENAME STATUS        SS AUG86
         DC    C'MEMLVMOD MEMLCDAT MEMLMDAT '
         DC    C'MEMLMTIM MEMLMID MEMLISIZ MEMLCSIZ '          SS NOV84
         DC    C'MEMLCCEN MEMLMCEN '                          Y2K AUG97
         DC    C'MEMLCDAX MEMLMDAX '                          Y2K SEP98
         DC    C'MEMLCSIS '        EXTENDED STATS SCALE (0-2) DRK AUG09
         DC    C'MEMLXSTA '        EXTENDED STATS INDIC       DRK SEP09
         DC    C')'                                            SS AUG86
* MEMLIST LOAD
MEMTNAMU DC    C'( '               MEM TBL                     SS AUG86
         DC    C'MEMLDATA '        USER ENTERED DATA           SS AUG86
         DC    C'MEMLOPT '                                     SS AUG86
         DC    C'MEMLALIS '                                    SS AUG86
         DC    C'MEMLTTR '         MEM TBL ALIAS SCAN ARG LIST SS AUG86
         DC    C'MEMLXTTR '        HEX TTR                     SS AUG86
         DC    C'MEMLSTAT '        DELETE/RENAME STATUS        SS AUG86
         DC    C'MEMLMNAM MEMLMTTR '                           SS NOV84
         DC    C'MEMLLENG MEMLENTY MEMLATT1 MEMLATT2 MEMLDC MEMLTEST '
         DC    C'MEMLAPF MEMLMODE MEMLSSI MEMLLDAT '           SS MAR85
         DC    C'MEMLLCEN '                                   Y2K AUG97
         DC    C'MEMLXLEN '        HEX LENGTH                 DRK OCT99
         DC    C'MEMLLDAX MEMLAPFX '                          DRK MAR00
         DC    C')'                                            SS AUG86
*        SPLIT SOURCE AND LOAD TABLE VARS                      SS AUG86
         SPACE 2                        *                      SS AUG86
*        VARIABLES TO BE DEFINED        *                      SS AUG86
         DS    0F                       *                      SS AUG86
MEMLVINI DC    H'0',X'20',X'00'         *                      SS AUG86
         DC    A(MEMLTKEY),AL2(MEMLNAME-SPWRKC),H'8'           SS AUG86
         DC    A(MEMLVR1),AL2(MEM2OPT-SPWRKC),H'4'             SS AUG86
         DC    A(MEMLVR2),AL2(MEMLDATA-SPWRKC),H'8'            SS AUG86
         DC    A(MEMLVR3),AL2(MEM2TTR-SPWRKC),H'8'             SS AUG86
         DC    A(MEMLVR4),AL2(MEM2XTTR-SPWRKC),H'3'            SS AUG86
         DC    A(MEMLVR5),AL2(MEM2ALIS-SPWRKC),H'8'            SS AUG86
         DC    A(MEMLVR6),AL2(MEM2STAT-SPWRKC),H'2'            SS AUG86
         DC    A(MEMLVR7),AL2(MEM2VMOD-SPWRKC),H'8'            SS AUG86
         DC    A(MEMLVR8),AL2(MEM2MNAM-SPWRKC),H'8'            SS AUG86
         DC    A(MEMLVR9),AL2(MEM2ATT1-SPWRKC),H'5'            SS AUG86
         DC    A(MEMLVR0),AL2(MEM2SSI-SPWRKC),H'8'             SS AUG86
         DC    A(MEMLVRA),AL2(MEM2CCEN-SPWRKC),H'1'           Y2K AUG97
         DC    A(MEMLVRB),AL2(MEM2LCEN-SPWRKC),H'1'           Y2K AUG97
         DC    A(MEMLVRC),AL2(MEM2CDAX-SPWRKC),H'10'          Y2K SEP98
         DC    A(MEMLVRD),AL2(MEM2XLEN-SPWRKC),H'3'           DRK OCT99
         DC    A(MEMLVRE),AL2(MEM2LDAX-SPWRKC),H'10'          DRK MAR00
         DC    A(MEMLVRF),AL2(MEM2APFX-SPWRKC),H'1'           DRK MAR00
         DC    A(MEMLVRG),AL2(MEM2CSIS-SPWRKC),H'1'           DRK AUG09
         DC    A(MEMLVRH),AL2(MEM2XSTA-SPWRKC),H'1'           DRK SEP09
         DC    X'FF'                    *                      SS AUG86
MEMLVR7  DC    C'('                     *                      SS AUG86
         DC    C'MEMLVMOD MEMLCDAT MEMLMDAT '
         DC    C'MEMLMTIM MEMLMID MEMLISIZ MEMLCSIZ '          SS NOV84
         DC    C')'                                            SS AUG86
MEMLVR8  DC    C'('                     *                      SS AUG86
         DC    C'MEMLMNAM MEMLMTTR '                           SS NOV84
         DC    C'MEMLLENG MEMLENTY'                            SS AUG86
         DC    C')'                                            SS AUG86
MEMLVR9  DC    C'('                     *                      SS AUG86
         DC    C'MEMLATT1 MEMLATT2 MEMLDC MEMLTEST '           SS AUG86
         DC    C'MEMLAPF MEMLMODE'                             SS AUG86
         DC    C')'                                            SS AUG86
MEMLVR0  DC    C'('                     *                      SS AUG86
         DC    C'MEMLSSI MEMLLDAT '                            SS AUG86
         DC    C')'                                            SS AUG86
MEMLVRA  DC    C'('                     *                     Y2K AUG97
         DC    C'MEMLCCEN MEMLMCEN '                          Y2K AUG97
         DC    C')'                                           Y2K AUG97
MEMLVRB  DC    C'('                     *                     Y2K AUG97
         DC    C'MEMLLCEN '                                   Y2K AUG97
         DC    C')'                                           Y2K AUG97
MEMLVRC  DC    C'('                     *                     Y2K SEP98
         DC    C'MEMLCDAX MEMLMDAX '                          Y2K SEP98
         DC    C')'                                           Y2K SEP98
MEMLVRD  DC    C'('                     *                     DRK OCT99
         DC    C'MEMLXLEN '                                   DRK OCT99
         DC    C')'                                           DRK OCT99
MEMLVRE  DC    C'('                     *                     DRK MAR00
         DC    C'MEMLLDAX '                                   DRK MAR00
         DC    C')'                                           DRK MAR00
MEMLVRF  DC    C'('                     *                     DRK MAR00
         DC    C'MEMLAPFX '                                   DRK MAR00
         DC    C')'                                           DRK MAR00
MEMLVRG  DC    C'('                     *                     DRK AUG09
         DC    C'MEMLCSIS '                                   DRK AUG09
         DC    C')'                                           DRK AUG09
MEMLVRH  DC    C'('                     *                     DRK SEP09
         DC    C'MEMLXSTA '                                   DRK SEP09
         DC    C')'                                           DRK SEP09
         SPACE 5                                               SS NOV85
         TITLE 'ISPF - MEMLIST LV 1 SUBROUTINE'                SS NOV85
*                                                              SS NOV85
*                                                              SS NOV85
*                                                              SS NOV85
       SPACE 3
*************************************************************  SS SEP84
*                                                              SS SEP84
*        ADDED SUPPORT OF DIALOG MEMLIST MODE USING            SS SEP84
*        A DIALOG TABLE TO DISPLAY PDS MEMBER LIST             SS SEP84
*                                                              SS SEP84
*************************************************************  SS SEP84
*
*      MEMLNAME     MEMBER NAME (*MUST* BE ONLY 'KEY' VARIABLE IN TBL)
*      MEMLACT      USER'S ACTION REQUEST
*      MEMLALIS     MAIN NAME IF ALIAS
*      MEMLTTR      MEMBER TTR (REQUIRED TO DETERMINE ALIAS MAIN NAME)
*   THE FOLLOWING ARE UPDATED FOR SPF FILES                    SS MAY84
*      MEMLVMOD     SPF STATS VERSION MOD
*      MEMLCDAT     SPF STATS CREATION DATE
*      MEMLMDAT     SPF STATS LAST MOD DATE
*      MEMLMTIM     SPF STATS LAST MOD TIME
*      MEMLMID      SPF STATS LAST MOD ID
*      MEMLISIZ     SPF STATS INITIAL SIZE                     SS NOV84
*      MEMLCSIZ     SPF STATS CURRENT SIZE
*      MEMLCSIS     SPF STATS CURRENT SIZE SORT SCALE         DRK AUG09
*      MEMLXSTA     SPF STATS EXTENDED INDICATOR              DRK SEP09
*      MEMLCCEN     SPF STATS CREATION DATE CENTURY           Y2K AUG97
*      MEMLMCEN     SPF STATS LAST MOD DATE CENTURY           Y2K AUG97
*      MEMLCDAX     SPF STATS CREATION DATE YYYYMMDD EXTENDED Y2K SEP98
*      MEMLMDAX     SPF STATS LAST MOD DATE YYYYMMDD EXTENDED Y2K SEP98
*                                                              SS NOV84
*   THE FOLLOWING ARE UPDATED FOR LOAD LIBRARIES
*      MEMLMNAM     ALIAS MAIN NAME
*      MEMLXTTR     LOAD TTR IN HEX
*      MEMLLENG     LOAD PROGRAM LENGTH      (PRINTABLE)
*      MEMLXLEN     LOAD PROGRAM LENGTH IN HEX                DRK OCT99
*      MEMLENTY     LOAD PROGRAM ENTRY POINT (PRINTABLE)
*      MEMLATT1     LOAD ATTRIBUTE - FIRST
*      MEMLATT2     LOAD ATTRIBUTE - SECONDARY
*      MEMLDC       LOAD ATTRIBUTE OF DC
*      MEMLTEST     LOAD ATTRIBUTE OF TEST
*      MEMLAPF      LOAD APF ATTRIBUTE
*      MEMLMODE     LOAD AMODE/RMODE ATTRIBUTE
*      MEMLSSI      SSI INFORMATION                            SS NOV84
*      MEMLLDAT     LINKAGE EDIT DATE IN YY/MM/DD FORMAT      ABL OCT85
*      MEMLLCEN     LINKAGE EDIT DATE CENTURY                 Y2K AUG97
*      MEMLLDAX     LINKAGE EDIT DATE YYYYMMDD EXTENDED       DRK MAR00
*      MEMLAPFX     LOAD APF ATTRIBUTE 1=APF AUTHORIZED       DRK MAR00
*
***********************************************************************
         SPACE 2
MEMLIST  DS    0H                                              SS SEP84
         USING *,R4                                            SS JUL84
         TM    MEMFLAG0,MEMLRIDR        READ IDR ONLY          SS AUG86
         BO    READIDR                  YES, SKIP ALL ELSE     SS AUG86
         MVI   MEMLMV1,C' '        BLANK                       SS AUG86
         MVC   MEMLMV1+1(MEMLLN1),MEMLMV1   RIPPLE             SS AUG86
         MVI   MEMLMV2,C' '        BLANK                       SS AUG86
         MVC   MEMLMV2+1(MEMLLN2),MEMLMV2   RIPPLE             SS AUG86
         SPACE 1
*        CLEAR VARS HERE
         MVC   MEMLNAME,DIRNAME    MEMBER NAME FROM DIR TO VAR
         UNPK  MEMLWK(7),DIRTTR(4) UNPACK HEX
         TR    MEMLWK(6),TRHEX     TRANSLATE TO HEX
         MVC   MEMLTTR(6),MEMLWK
         MVI   MEMLSTAT,C'S'       ASSUME SOURCE               SS AUG86
         MVC   MEMLXTTR(3),DIRTTR   SAVE TTR                   SS AUG86
         TM    DIRFLAG,DIRALIAS    IS THIS AN ALIAS NAME       SS AUG86
         BNO   MMLSTATS            NO: ALIAS LOGIC
         MVC   MEMLALIS,MMLALI          NAME AS AN ALIAS
* DETERMINE IF WE HAVE SPF STATISTICS
MMLSTATS DS    0H                                              SS NOV84
         LA    R0,DIRCUDHW         CLEAR IC REG
         LA    R15,0               CLEAR IC REG
         IC    R15,DIRFLAG         FETCH COUNT FIELD MASK
         NR    R15,R0              ZERO OUT NON-COUNT BITS
         SLL   R15,1               TIMES 2                     SS SEP84
         TM    FLAGSCC,RECFMU      LOAD MODULE LIBRARY?        SS NOV84
         BO    MEMLLOAD            YES, BRANCH                 SS NOV84
         STC   R15,MEMLMNAM        SAVE LENGTH                 SS SEP84
*        MVC   MEMLMNAM+1(0),DIRUSER  SAVE DIR                 SS NOV85
*        EX    R15,*-6                                         SS NOV85
         CLC   MEMLALIS,MMLALI     ALIAS
         BE    MMLSALI             YES, NO STATS
         SPACE 1
         TM    DIRFLAG,X'14'       ISPF EXTENDED STATS?       DRK OCT09
         BO    SKIPCK              YES                        DRK OCT09
         TM    DIRFLAG,X'11'       STOW DATE ZAP 1980+?       DRK MAR19
         BO    SKIPCK              YES                        DRK MAR19
         TM    DIRFLAG,DIRSPFOF    CK FOR BITS THAT SHOULD BE OFF
         BNZ   MEMLADD             THEY'RE NOT: NO SPF STATS
         TM    DIRFLAG,DIRSPFON    CK FOR BITS THAT SHOULD BE ON
         BNO   MEMLADD             THEY'RE NOT: NO SPF STATS
SKIPCK   DS    0H
         TM    DIRSPFCR,X'FE'      0C OF 0CYYDDDF ZEROS?      Y2K AUG97
         BNZ   MEMLADD             NO, BRANCH                 Y2K AUG97
         TM    DIRSPFCD,X'FE'      0C OF OTHER 0CYYDDDF ZERO? Y2K AUG97
         BNZ   MEMLADD             NO, BRANCH                 Y2K AUG97
         SPACE 1
* ALL TESTS PASSED: ASSUME WE HAVE SPF STATS
         SPACE
         TM    DIRSPFFL,DIRSPFXS     EXTENDED STATS?          DRK SEP17
         BNO   *+4+4+4               NO                       DRK SEP17
         TM    DIRSPFFL,255-DIRSPFXS-DIRSPFSC  MUST BE ZEROS  DRK OCT16
         BNZ   MEMLADD                         NO, SKIP       DRK OCT16
         SR    R1,R1
         IC    R1,DIRSPFR          REVISION NUMBER FIRST
         CVD   R1,DOUBLE
         MVC   MEMLVMOD+1(4),=X'40212020'                     ABL OCT85
         ED    MEMLVMOD+1(4),DOUBLE+6                         ABL OCT85
         MVI   MEMLVMOD+2,C'.'                                ABL OCT85
         IC    R1,DIRSPFV          VERSION NUMBER
         CVD   R1,DOUBLE
         MVC   DOUBLE(4),=X'40212020'                         ABL OCT85
         ED    DOUBLE(4),DOUBLE+6                             ABL OCT85
         MVC   MEMLVMOD(2),DOUBLE+2                           ABL OCT85
         LA    R1,DIRSPFCR+1           POINT TO YYDDDF
         LA    R15,FULLWORD+1
         L     R2,MEMLCVTD                                     SS JUL85
         BASR  R14,R2                                          SS JUL85
         MVC   FULLWORD(1),FULLWORD+3  CONVERT TO YYMMDD
         MVC   MEMLCDAT(L'DATEMASK),DATEMASK
         ED    MEMLCDAT(L'DATEMASK),FULLWORD
         OI    MEMLCDAT+1,X'F0'        SHOW YY                Y2K AUG97
         MVC   MEMLCDAT(8),MEMLCDAT+1                          SS SEP84
         MVC   MEMLCCEN(1),DIRSPFCR    CENTURY BYTE           Y2K AUG97
         OI    MEMLCCEN,X'F0'          FOR CHARACTER SORT     Y2K AUG97
         SPACE 1                                              Y2K SEP98
         CLI   MEMLCCEN,X'F0'          19XX?                  Y2K SEP98
         BNE   *+4+6+4                 NO, THEN 20XX          Y2K SEP98
         MVC   MEMLCDAX(2),=C'19'      YES                    Y2K SEP98
         B     *+4+6                                          Y2K SEP98
         MVC   MEMLCDAX(2),=C'20'                             Y2K SEP98
         MVC   MEMLCDAX+2(8),MEMLCDAT  YYYY/MM/DD             Y2K SEP98
         SPACE 1                                              Y2K SEP98
         LA    R1,DIRSPFCD+1           POINT TO YYDDDF
         LA    R15,FULLWORD+1
         L     R2,MEMLCVTD                                     SS JUL85
         BASR  R14,R2                                          SS JUL85
         MVC   FULLWORD(1),FULLWORD+3  CONVERT TO YYMMDD
         MVC   MEMLMDAT(L'DATEMASK),DATEMASK
         ED    MEMLMDAT(L'DATEMASK),FULLWORD
         OI    MEMLMDAT+1,X'F0'        SHOW YY                Y2K AUG97
         MVC   MEMLMDAT(8),MEMLMDAT+1                          SS SEP84
         MVC   MEMLMCEN(1),DIRSPFCD    CENTURY BYTE           Y2K AUG97
         OI    MEMLMCEN,X'F0'          FOR CHARACTER SORT     Y2K AUG97
         SPACE 1                                              Y2K SEP98
         CLI   MEMLMCEN,X'F0'          19XX?                  Y2K SEP98
         BNE   *+4+6+4                 NO, THEN 20XX          Y2K SEP98
         MVC   MEMLMDAX(2),=C'19'      YES                    Y2K SEP98
         B     *+4+6                                          Y2K SEP98
         MVC   MEMLMDAX(2),=C'20'                             Y2K SEP98
         MVC   MEMLMDAX+2(8),MEMLMDAT  YYYY/MM/DD             Y2K SEP98
         SPACE 1                                              Y2K SEP98
         MVC   MEMLMTIM(6),MEML0021                           ABL APR85
         ED    MEMLMTIM(6),DIRSPFCT    TIME OF LAST CHANGE
         MVC   MEMLMTIM(5),MEMLMTIM+1                          SS SEP84
*        MVI   MEMLMTIM+5,X'40'        FOLLOWING BLANK        ABL OCT84
         CLI   DIRSPFZ+1,X'60'         SS VALIDITY CHECK      DRK MAR01
         BL    *+4+6+4                 GOOD                   DRK MAR01
         MVC   MEMLMTIM+6(2),=C'00'    BAD, SET TO ZERO       DRK MAR01
         B     *+4+6+6                                        DRK MAR01
         MVC   MEMLMTIM+5(3),=X'F02020' PATTERN               DRK MAR01
         ED    MEMLMTIM+5(3),DIRSPFZ+1  SECONDS               DRK MAR01
         MVI   MEMLMTIM+5,C':'         INSERT COLON HERE      DRK MAR01
         SPACE 1
SPFSTATS DS    0H                      Z/XDC PROBE
         MVI   MEMLXSTA,C' '           ASSUME REG STATS       DRK SEP09
         TM    DIRSPFFL,DIRSPFXS       EXTENDED STATS?        DRK AUG09
         BNO   REGSTATS                NO                     DRK AUG09
         SGR   R1,R1                   CLEAR ALL 64 BITS      DRK MAY16
         L     R1,DIRSPXIN             CONVERT INITIAL SIZE   DRK AUG09
         BAS   R2,EXTSTATS                                    DRK AUG09
         MVC   MEMLISIZ(6),XSIZE                              DRK AUG09
         SGR   R1,R1                   CLEAR ALL 64 BITS      DRK MAY16
         L     R1,DIRSPXSI             CONVERT CURRENT SIZE   DRK AUG09
         BAS   R2,EXTSTATS                                    DRK AUG09
         MVC   MEMLCSIZ(6),XSIZE                              DRK AUG09
         MVC   MEMLCSIS(1),XSORTKEY                           DRK AUG09
         MVI   MEMLXSTA,C'Y'           MARK EXTENDED          DRK SEP09
         B     MMLSTATX                                       DRK AUG09
REGSTATS DS    0H
         SPACE 1
         SR    R1,R1                    *                      SS MAY89
         ICM   R1,B'0011',DIRSPFIN      *                      SS MAY89
         CVD   R1,DOUBLE
         MVC   MEMLISIZ(6),MEML0020                           ABL APR85
         ED    MEMLISIZ(6),DOUBLE+5                            SS NOV84
         MVC   MEMLISIZ(5),MEMLISIZ+1                          SS NOV84
         MVI   MEMLISIZ+5,X'40'        FOLLOWING BLANK         SS NOV84
         SR    R1,R1                    *                      SS MAY89
         ICM   R1,B'0011',DIRSPFSI      *                      SS MAY89
         CVD   R1,DOUBLE
         MVC   MEMLCSIZ(6),MEML0020                           ABL APR85
         ED    MEMLCSIZ(6),DOUBLE+5
         MVC   MEMLCSIZ(5),MEMLCSIZ+1                          SS SEP84
         MVI   MEMLCSIZ+5,X'40'        FOLLOWING BLANK        ABL OCT84
         MVI   MEMLCSIS,C'0'           EXT STATS SORT SCALE   DRK AUG09
         SPACE 1
MMLSTATX DS    0H
         MVC   MEMLMID,DIRSPFID
         B     MEMLADD
*
* CONVERT EXTENDED SPF STATISTICS
*
EXTSTATS DS    0H                                             DRK AUG09
         CVDG  R1,DOUBLE-8             4294M MAX, X'FFFFFFFF' DRK AUG09
         SPACE 1
         CP    DOUBLE,=PL4'0100000'    100K                   DRK AUG09
         BL    BYTES                                          DRK AUG09
         CP    DOUBLE,=PL4'1000000'    1M                     DRK AUG09
         BL    KBYTES                                         DRK AUG09
         B     MBYTES                                         DRK AUG09
BYTES    DS    0H                                             DRK AUG09
         MVC   XSIZE(6),MEML0020                              DRK AUG09
         ED    XSIZE(6),DOUBLE+5       0-99999                DRK AUG09
         MVC   XSIZE(5),XSIZE+1                               DRK AUG09
         MVI   XSIZE+5,X'40'                                  DRK AUG09
         MVI   XSORTKEY,C'0'           EXT STATS SORT SCALE   DRK AUG09
         BR    R2                                             DRK AUG09
KBYTES   DS    0H                                             DRK AUG09
         DP    DOUBLE,=PL4'0001000'    1K                     DRK AUG09
         MVC   XSIZE(6),MEML0020                              DRK AUG09
         ED    XSIZE(6),DOUBLE+1                              DRK AUG09
         MVC   XSIZE(4),XSIZE+2                               DRK AUG09
         MVI   XSIZE+4,C'K'            THOUSANDS              DRK AUG09
         MVI   XSIZE+5,X'40'                                  DRK AUG09
         MVI   XSORTKEY,C'1'           EXT STATS SORT SCALE   DRK AUG09
         BR    R2                                             DRK AUG09
MBYTES   DS    0H                                             DRK AUG09
         DP    DOUBLE,=PL4'1000000'    1M                     DRK AUG09
         MVC   XSIZE(6),MEML0020                              DRK AUG09
         ED    XSIZE(6),DOUBLE+1                              DRK AUG09
         MVC   XSIZE(4),XSIZE+2                               DRK AUG09
         MVI   XSIZE+4,C'M'            MILLIONS               DRK AUG09
         MVI   XSIZE+5,X'40'                                  DRK AUG09
         MVI   XSORTKEY,C'2'           EXT STATS SORT SCALE   DRK AUG09
         BR    R2                                             DRK AUG09
         SPACE 1
* PROCESS SOURCE ALIAS                                         SS NOV84
MMLSALI  DS    0H                                              SS NOV84
         MVC   MEMLVMOD(5),MMLALI+1                            SS NOV84
         B     MEMLADD                                         SS NOV84
* PROCESS DIR AS LOAD MODULE
MEMLLOAD DS    0H
* SAVE ATTR BYTES
         MVI   MEMLSTAT,C'L'       MARK A LOAD                 SS AUG86
         STC   R15,MEMLVMOD        SAVE LENGTH                 SS SEP84
         MVC   MEMLVMOD+1(0),DIRUSER  SAVE DIR                 SS SEP84
         EX    R15,*-6                                         SS SEP84
         TM    DIRFLAG,X'60'       ANY TTR BITS ON?           ABL APR86
         BNZ   MMLLNSOR            YES, NOT SOURCE            ABL APR86
         CLI   MEMLVMOD,0          CHECK FOR SOURCE IN LOAD    SS NOV84
         BE    MMLNONL             SOURCE                      SS NOV84
         CLI   MEMLVMOD,30         COMPARE FOR SPF STATS       SS NOV84
         BE    MMLNONL             SOURCE                      SS NOV84
         CLI   MEMLVMOD,40         COMPARE FOR EXT SPF STATS  DRK OCT09
         BE    MMLNONL             SOURCE                     DRK OCT09
MMLLNSOR DS    0H                                             ABL APR86
         CLC   MEMLALIS,MMLALI     IS IT ALIAS
         BNE   MMLALIAS
***      CLI   MEMLVMOD,34         COMPARE FOR ALIAS AREA     ABL JAN87
***      BNE   MMLALIAS            GOOD                       ABL JAN87
         MVC   MEMLMNAM,DIRREAL    SAVE CLAIMED MAIN NAME
         TM    DIRATTR,ATTRSCTR    SCATTER LOADED?            ABL JAN87
         BNO   MMLALIAS            NO, BRANCH                 ABL JAN87
         MVC   MEMLMNAM,DIRREALS     ACTUAL MAIN NAME         ABL JAN87
MMLALIAS DS    0H
* PROCESS PROGRAM LENGTH
         UNPK  MEMLWK(7),DIRSTORE(4)
         TR    MEMLWK(6),TRHEX
         MVC   MEMLLENG(6),MEMLWK
         MVC   MEMLXLEN(3),DIRSTORE  LENGTH IN HEX FOR SORT   DRK OCT99
* PROCESS PROGRAM ENTRY
         UNPK  MEMLWK(7),DIREPA(4)
         TR    MEMLWK(6),TRHEX
         MVC   MEMLENTY(6),MEMLWK
* PROCESS LINKAGE EDIT DATE
         MVC   MEMLLDAT(8),MEMLLENG  INITIALIZE DATE/SIZE FLD ABL APR85
         MVC   MEMLLDAX(10),ISPBLK44 CLEAR FIELD              DRK MAR00
         MVC   MEMLLDAX(8),MEMLLENG  INITIALIZE DATE/SIZE FLD DRK MAR00
         MVI   LKEDDATE,X'FF'        INVALID DATE             ABL APR85
         TM    MEMFLAG2,MEMLTMLK     GET LKED FOR TIME CHECK   SS NOV86
         BO    READIDR               YES                       SS NOV86
         TM    MEMFLAG0,MEMLLKD1     THIS TIME GET LKED        SS AUG86
         BO    READIDR               YES                       SS AUG86
         TM    MEMFLAG0,MEMLNKD1     THIS TIME NOLKED          SS AUG86
         BO    MMLNOLKD              YES                       SS AUG86
         CLI   SPFLKDT,C'Y'          DEFAULT   GET LKED        SS AUG86
         BNE   MMLNOLKD              NO                        SS AUG86
*
*        IDR SCAN SUBROUTINE
*
         SPACE 3
READIDR  DS    0H
         AIF   ('&MVSLEV' LT 'MVS510').NOBAPI5                 GP SEP05
         TM    DS1SMSFG,DS1PDSE         PDSE DATASET?         DRK AUG05
         BNO   NOTAPDSE                 NO, MUST BE A PDS      GP SEP05
         L     R15,CVTPTR(,R0)                                 GP SEP05
         CLI   CVTDCB-CVT(R15),X'9B'                           GP SEP05
         BNE   LASTIDR                  OS IS TOO OLD FOR THIS GP SEP05
         LA    R15,PDSEBAPI             POINT TO ROUTINE       GP SEP05
         LA    R0,1                                            GP SEP05
         SLL   R0,31                                           GP SEP05
         OR    R15,R0                   SET AMODE=31 BIT       GP SEP05
         BASSM R14,R15                  INVOKE ROUTINE         GP SEP05
         LTR   R15,R15                  GOT A LKED DATE?       GP SEP85
         BNZ   LASTIDR                  NO, BAD LUCK           GP SEP05
         LA    R15,SPFSAVEK+5-15        YES, POINT TO YYDDDF   GP SEP05
         B     LKEDIDR                  GO PROCESS IT          GP SEP05
NOTAPDSE EQU   *                        LOOK FOR IDR BLOCKS    GP SEP05
.NOBAPI5 ANOP  ,                                               GP SEP05
         CLC   MEMLXTTR(3),DS1LSTAR     CHECK EXTENT           SS AUG86
         BL    READIDR2                 OK                     SS AUG86
*    FOLLOWING ARE FOR TEST             *                      SS AUG86
         BAS   R2,CLOSEIT               NEED ..                SS AUG86
         BAS   R2,ISPREST2                   REOPEN            SS AUG86
READIDR2 DS    0H
         MVC   STARTTR(3),MEMLXTTR FIRST TTR                   SS AUG86
         SPACE 2
IDREXCP  L     R15,VEXCP
**                                                            ABL JAN87
**       CALLER'S REGISTERS FOR ISPDSPY ARE SAVED AROUND      ABL JAN87
**       THE FOLLOWING CALL IN CASE AN ERROR MESSAGE IS       ABL JAN87
**       GENERATED IN EXCP; RESULT IS ENDLESS LOOP IN EXCP.   ABL JAN87
**                                                            ABL JAN87
         MVC   SPFSAVEK(9*4),SPFSAV14   SETUP FOR AN OUTPUT   ABL JAN87
         BASR  R14,R15
         MVC   SPFSAV14(9*4),SPFSAVEK   RESTORE REGISTERS     ABL JAN87
         B     *+4(R15)            PROCESS RETURN CODE
         B     IDREXCP1              00 - GOOD READ
         B     LASTIDR               04 - END OF MEMBER
         B     LASTIDR               08 - END OF DATA SET
         B     LASTIDR               12 - I/O ERROR
VEXCP    DC    V(EXCP)                                         SS JUL85
         SPACE 1
IDREXCP1 LR    R15,R0              START OF RECORD
         TM    0(R15),X'50'        TEST SYM OR SCATTER RECORD?
         BM    IDREXCP             YES, SKIP IT
         SPACE 1
         CLI   0(R15),X'20'        CESD RECORD?
         BE    IDREXCP             YES, SKIP
         SPACE 1
         CLI   0(R15),X'80'        IDR RECORD?
         BNE   LASTIDR             NO, BRANCH
         SPACE 1
         TM    2(R15),X'02'        LINKAGE EDITOR IDR RECORD?
         BO    LKEDIDR             YES, BRANCH
         B     IDREXCP             CONTINUED RECORD
         SPACE 2
LASTIDR  DS    0H
         MVI   LKEDDATE,X'FF'      NO DATE                     SS JUL85
         B     MMLNOLKD                                       ABL NOV85
ATTRSCTR EQU   X'04'               SCATTER-LOADED MODULE      ABL JAN87
         EJECT
         SPACE 3
*  LINKAGE EDITOR IDR RECORDS:
* --  --  --  --  -- ---+ --  -- ---+ --  --  --  --  --  --  --  -- -*
*  0 - 9                |  10 - 11  |  12 - 14                        *
*  LINKAGE EDITOR NAME  |  VVMM     |  LINKAGE EDIT DATE              *
* --  --  --  --  -- ---+ --  -- ---+ --  --  --  --  --  --  --  -- -*
         SPACE 1
LKEDIDR  OI    FLAGSCC,FIDR
         TM    MEMFLAG2,MEMLTMLK        CHECK DATE             SS NOV86
         BZ    MMLNOCK                  NO CHECK               SS NOV86
         TM    MEMFLAG2,MEMLTMPR        CHECK PREVIOUS         SS NOV86
         BO    MEMLCKPR                 YES                    SS NOV86
         CLC   SPFDAY+1(3),15(R15)      CHECK DATE             SS NOV86
         BNH   MMLNOCK                  OK, CONTINUE           SS NOV86
         OI    MEMFLAG2,MEMLTMNO        NO PROCESSING THIS ONE SS NOV86
         BR    R3                       RETURN                 SS NOV86
MEMLCKPR DS    0H                       *                      SS NOV86
         CLC   SPFDAY+1(3),15(R15)      CHECK DATE             SS NOV86
         BH    MMLNOCK                  OK, CONTINUE           SS NOV86
         OI    MEMFLAG2,MEMLTMNO        NO PROCESSING THIS ONE SS NOV86
         BR    R3                       RETURN                 SS NOV86
MMLNOCK  DS    0H                       *                      SS NOV86
         LA    R1,15(R15)          ADDRESS OF DATE
         LA    R15,LKEDDATE
         L     R2,MEMLCVTD                                     SS JUL85
         BASR  R14,R2                                          SS JUL85
         SPACE 2
         MVC   MEMLWK(9),DATEMASK    EDIT MASK                ABL APR85
         ED    MEMLWK(9),LKEDDATE    DATE AS " MM/DD/YY"      ABL APR85
         MVC   MEMLLDAT(2),MEMLWK+7  YY                       ABL APR85
         MVC   MEMLLDAT+3(5),MEMLWK+1 MM/DD                   ABL APR85
         MVI   MEMLLDAT+2,C'/'       NOW IN YY/MM/DD FORMAT   ABL APR85
         CLI   MEMLLDAT+3,C' '       SUPPRESSED LEADING BLANK?ABL APR85
         BNE   *+4+4                 NO, BRANCH               ABL APR85
         MVI   MEMLLDAT+3,C'0'       YES, REPLACE THE BLANK   ABL APR85
         MVI   MEMLLCEN,C'0'         ASSUME 19XX              Y2K AUG97
         CLC   MEMLLDAT(2),=C'&WIN19XX'  BELOW 19XX WINDOW?   Y2K AUG97
         BNL   *+8                       NO, THEN 19XX        Y2K AUG97
         MVI   MEMLLCEN,C'1'             YES, THEN 20XX       Y2K AUG97
         SPACE 1                                              DRK MAR00
         CLI   MEMLLCEN,X'F0'          19XX?                  DRK MAR00
         BNE   *+4+6+4                 NO, THEN 20XX          DRK MAR00
         MVC   MEMLLDAX(2),=C'19'      YES                    DRK MAR00
         B     *+4+6                                          DRK MAR00
         MVC   MEMLLDAX(2),=C'20'                             DRK MAR00
         MVC   MEMLLDAX+2(8),MEMLLDAT  YYYY/MM/DD             DRK MAR00
         SPACE 1                                              DRK MAR00
MMLNOLKD DS    0H                                             ABL APR85
         TM    MEMFLAG0,MEMLRIDR     WAS THIS READ IDR ONLY    SS AUG86
         BZ    MMLRCONT              NO, CONTINUE              SS AUG86
         NI    MEMFLAG0,255-MEMLRIDR RESET FLAGE               SS AUG86
         B     MEMLEMOD              DONE                      SS AUG86
MMLRCONT DS    0H                       *                      SS AUG86
         NI    MEMFLAG0,255-MEMLLKD1-MEMLNKD1 RESET 1 TIME FLG SS AUG86
* PROCESS APF CODE
         TM    DIRATTR2,DIRVS      IS IT VS
         BO    MMLAPF
         MVC   MEMLAPF(4),MMLCNOVS
***      B     MMLDC                                          ABL JUL88
MMLAPF   TM    DIRATTR2,DIRAPFF    IS APF THERE
***      BZ    MMLDC                                          ABL JUL88
         LA    R2,DIRAPF                                       SS NOV85
         TM    DIRATTR,DIRSCTR     SCATTER FORMAT              SS NOV85
         BNO   *+8                                             SS NOV85
         LA    R2,8(,R2)                                       SS NOV85
         TM    DIRFLAG,X'80'       ALIAS                       SS NOV85
         BO    MEMLAPF3            YES                         SS NOV85
         TM    5(R2),X'0F'         PDSMAN DATE?               ABL JAN87
         BO    MEMLAPF2            YES, BRANCH                ABL JAN87
         TM    6(R2),X'0F'         PDSMAN DATE?               ABL JAN87
         BO    MEMLAPF2            YES, BRANCH                ABL JAN87
         TM    4+5(R2),X'0F'       PDSMAN DATE AND SSI?       ABL JAN87
         BO    MEMLAPF2            YES, BRANCH                ABL JAN87
         TM    4+6(R2),X'0F'       PDSMAN DATE AND SSI?       ABL JAN87
         BO    MEMLAPF2            YES, BRANCH                ABL JAN87
         CLI   8(R2),0             CONVERTED ALIAS             SS NOV85
*        BE    *+8                 NO, SKIP                    SS NOV85
         B     *+8                 SKIP                       DRK JAN98
MEMLAPF3 LA    R2,11(,R2)                                      SS NOV85
MEMLAPF2 DS    0H                                             ABL JAN87
         TM    DIRATTR2,DIRVS      IS IT VS?                  ABL JUL88
         BO    MEMLAPF6            YES, BRANCH                ABL JUL88
         LA    R2,1(,R2)           ROUND                      ABL JUL88
         N     R2,=F'-2'           OFF LAST BIT (MAKE EVEN)   ABL JUL88
         CLC   =F'0',0(R2)         ZERO SSI                   ABL JUL88
         BE    MMLDC               NO SSI                     ABL JUL88
         CLC   =F'-1',0(R2)        ALL FFFFFFFF?              ABL JUL88
         BE    MMLDC               NO SSI                     ABL JUL88
         UNPK  MEMLWK(9),0(5,R2)   UNPACK HEX                 ABL JUL88
         TR    MEMLWK(8),TRHEX     TRANSLATE TO HEX           ABL JUL88
         MVC   MEMLSSI(8),MEMLWK                              ABL JUL88
         B     MMLDC               CONTINUE WITH DC CHECK     ABL JUL88
MEMLAPF6 DS    0H                                             ABL JUL88
         TM    DIRATTR2,DIR2SSI    SSI PRESENT                 SS NOV85
         BNO   MEMLAPF4            NO                          SS NOV85
         LA    R2,1(,R2)           ROUND                       SS NOV85
         N     R2,=F'-2'           OFF LAST BIT (MAKE EVEN)    SS NOV85
*        CLC   =F'0',0(R2)         ZERO SSI                   DRK JAN98
*        BE    MEMLAPF4            NO SSI                     DRK JAN98
*        CLC   =F'-1',0(R2)        ALL FFFFFFFF?              DRK JAN98
*        BE    MEMLAPF4                                       DRK JAN98
         LA    R2,4(,R2)           ADD FOR SSI                 SS NOV85
MEMLAPF4 DS    0H                                              SS NOV85
         LA    R15,1(,R2)          APF DATA                    SS NOV85
         CLI   0(R2),1             GOOD SSI                    SS NOV85
         BE    MMLAPF2             YES                         SS NOV85
         MVC    MEMLAPF(4),MMLCERR                             SS NOV85
         B     MMLDC                                           SS NOV85
MMLAPF2  CLI   0(R15),0            TEST AC(0)
         BE    MMLDC
         MVC   MEMLAPF+3(1),0(R15)                            ABL OCT85
         OI    MEMLAPF+3,X'F0'     MAKE PRINTABLE             ABL OCT85
         MVC   MEMLAPF(3),MMLCAC   FILL IN                    ABL OCT85
         MVC   MEMLAPFX(1),MEMLAPF+3 FOR USE W/ YYYYMMDD DATE DRK MAR00
MMLDC    TM    DIRATTR+1,DIRNODC   IS IT DC
         BO    MMLSSI              NO                          SS NOV84
         MVC   MEMLDC(2),MMLCDC    SET DC
MMLSSI   TM    DIRATTR2,DIRSSIF    DO WE HAVE SSI INFO         SS NOV84
         BZ    MMLTEST             NO                          SS NOV84
         SH    R15,MMLH5           BACK UP TO SSI INFO         SS NOV84
         UNPK  MEMLWK(9),0(5,R15)  UNPACK HEX                  SS NOV84
         TR    MEMLWK(8),TRHEX     TRANSLATE TO HEX            SS NOV84
         MVC   MEMLSSI(8),MEMLWK                               SS NOV84
MMLTEST  TM    DIRATTR,DIRTEST     IS IT TEST
         BZ    MMLATTR1
         TM    DIRATTR+1,DIRNOED   IS IT EDITABLE
         BZ    MEMLOK              NO, INCOMPATIBLE WITH TEST
         MVC   MEMLATT1(4),MMLCNOED
         MVC   MEMLTEST(3),MMLCERR
         B     MMLLEV2
MEMLOK   MVC   MEMLTEST(4),MMLCTEST
MMLATTR1 TM    DIRATTR+1,DIRNOED   IS IT EDITABLE
         BZ    MMLEXEC             NO, INCOMPATIBLE WITH TEST
         MVC   MEMLATT1(4),MMLCNOED
         B     MMLLEV2
MMLEXEC  TM    DIRATTR,DIREXEC     IS IT EXECUTABLE
         BO    MMLLOAD             YES CONTINUE
         MVC   MEMLATT1(4),MMLCNOEX
         B     MMLLEV2A
MMLLOAD  TM    DIRATTR,DIRLOAD     IS IT LOAD ONLY
         BZ    MMLOVLY             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCLOAD
***TEST  B     MMLREFR2                                       ABL JAN87
         B     MMLLEV2B   MMLREFR2 ***TEST                     SS JUN86
MMLOVLY  TM    DIRATTR,DIROVLY     IS IT OVERLAY
         BZ    MMLSCTR             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCOVLY
         B     MMLLEV2C
MMLSCTR  TM    DIRATTR,DIRSCTR     IS IT SCATTER LOAD
         BZ    MMLREFR             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCSCTR
         B     MMLLEV2D
MMLREFR  TM    DIRATTR+1,DIRREFR   IS IT REFRESHABLE
         BZ    MMLRENT             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCREFR
         B     MMLLEV2E
MMLRENT  TM    DIRATTR,DIRRENT     IS IT REENTRANT
         BZ    MMLREUS             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCRENT
         TM    DIRATTR,DIRREUS     MUST ALSO BE REUS
         BZ    REUSERR
         MVC   MEMLATT2(4),MMLCREUS
         B     MMLMODE
REUSERR  MVC   MEMLATT2(4),MMLCERR1
         B     MMLMODE
MMLREUS  TM    DIRATTR,DIRREUS     IS IT REUSABLE
         BZ    MMLMODE             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCREUS
         B     MMLMODE
MMLLEV2  DS    0H
         TM    DIRATTR,DIREXEC     IS IT EXECUTABLE
         BO    MMLLOAD2            YES CONTINUE
         MVC   MEMLATT2(4),MMLCNOEX
         B     MMLMODE
MMLLEV2A DS    0H
MMLLOAD2 TM    DIRATTR,DIRLOAD     IS IT LOAD ONLY
         BZ    MMLOVLY2            NO  CONTINUE               ABL OCT85
         MVC   MEMLATT2(4),MMLCLOAD
         B     MMLLEV2B
MMLOVLY2 TM    DIRATTR,DIROVLY     IS IT OVERLAY
         BZ    MMLSCTR2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCOVLY
         B     MMLLEV2C
MMLSCTR2 TM    DIRATTR,DIRSCTR     IS IT SCATTER LOAD
         BZ    MMLREFR2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCSCTR
         B     MMLLEV2D
MMLREFR2 TM    DIRATTR+1,DIRREFR   IS IT REFRESHABLE
         BZ    MMLRENT2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCREFR
         B     MMLMODE
MMLLEV2E DS    0H
MMLRENT2 TM    DIRATTR,DIRRENT     IS IT REENTRANT
         BZ    MMLREUS2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCRENT
         TM    DIRATTR,DIRREUS     MUST ALSO BE REUS
         BO    MMLMODE
         MVC   MEMLATT2(4),MMLCERR1
         B     MMLMODE
MMLREUS2 TM    DIRATTR,DIRREUS     IS IT REUSABLE
         BZ    MMLMODE             NO  CONTINUE
         MVC   MEMLATT2(4),MMLCREUS
         B     MMLMODE
MMLLEV2B TM    DIRATTR,DIRBADL
         BZ    MMLMODE                                        ABL OCT85
         MVC   MEMLATT2(4),MMLCERRL
         B     MMLMODE
MMLLEV2C TM    DIRATTR,DIRBADO
         BZ    MMLMODE
         MVC   MEMLATT2(4),MMLCERRO
         B     MMLMODE
MMLLEV2D TM    DIRATTR,DIRBADS
         BZ    MMLREUS2
         MVC   MEMLATT2(4),MMLCERRS
         B     MMLMODE
MMLMODE  DS    0H
         CLI   DIRATTR3,0
         BE    MEMLEMOD
         CLC   MEMLALIS,MMLALI    IS IT ALIAS
         BE    MMLMODEA
         SPACE 1
*RMODE64
         TM    DIRATTR3,DIRRANY+X'20' RMODE 64?               DRK APR18
         BNO   MMLMODE1            NO                         DRK APR18
         TM    DIRATTR3,DIRAMOD2   YES                        DRK APR18
         BO    MMLERRR             RMODE64, AMODEANY (ERROR)  DRK APR18
         TM    DIRATTR3,DIRAERR2*2                            DRK APR18
         BO    MMLERRR             RMODE64, AMODE31  (ERROR)  DRK APR18
         TM    DIRATTR3,DIRAERR2                              DRK APR18
         BO    MMLR664             RMODE64, AMODE64  (VALID)  DRK APR18
         B     MMLERRR             RMODE64, AMODE24  (ERROR)  DRK APR18
         SPACE 1
*RMODEANY
MMLMODE1 DS    0H                                             DRK APR18
         TM    DIRATTR3,DIRRANY    RMODE ANY?
         BZ    MMLMODE2            NO
         TM    DIRATTR3,DIRAMOD2   YES, CHECK AMODE ANY
         BO    MMLERRR             RMODEANY, AMODEANY         ABL OCT85
         TM    DIRATTR3,DIRAERR2*2                            ABL OCT85
         BO    MMLRANY             RMODEANY, AMODE31 (VALID)  DRK NOV02
         TM    DIRATTR3,DIRAERR2                              DRK OCT02
         BO    MMLRA64             RMODEANY, AMODE64 (VALID)  DRK NOV02
         B     MMLERRR
MMLMODE2 TM    DIRATTR3,DIRAMOD2
         BO    MMLAANY
         TM    DIRATTR3,DIRAERR2*2                            ABL OCT85
         BO    MMLA31                                         DRK FEB02
         TM    DIRATTR3,DIRAERR2                              DRK FEB02
         BO    MMLA64                                         DRK FEB02
         B     MEMLEMOD                                       DRK FEB02
*RMODE64 CODE FOR ALIASES GOES HERE
MMLMODEA TM    DIRATTR3,DIRRANY    RMODE ANY?
         BZ    MMLMODE3            NO
         TM    DIRATTR3,DIRAMOD1   YES, CHECK AMODE ANY
         BO    MMLERRR             RMODEANY, AMODEANY         ABL OCT85
         TM    DIRATTR3,DIRAERR1*2                            ABL OCT85
         BO    MMLRANY             RMODEANY, AMODE31 (VALID)  DRK NOV02
         TM    DIRATTR3,DIRAERR1                              DRK OCT02
         BO    MMLRA64             RMODEANY, AMODE64 (VALID)  DRK NOV02
         B     MMLERRR
MMLMODE3 TM    DIRATTR3,DIRAMOD1
         BO    MMLAANY
         TM    DIRATTR3,DIRAERR1*2                            ABL OCT85
         BO    MMLA31                                         DRK FEB02
         TM    DIRATTR3,DIRAERR1                              DRK FEB02
         BO    MMLA64                                         DRK FEB02
         B     MEMLEMOD                                       DRK FEB02
MMLERRR  MVC   MEMLMODE(4),MMLCERRR
         B     MEMLEMOD
MMLRANY  MVC   MEMLMODE(4),MMLCRANY                           ABL OCT85
         B     MEMLEMOD
MMLRA64  MVC   MEMLMODE(4),MMLCRA64                           DRK NOV02
         B     MEMLEMOD                                       DRK NOV02
MMLR664  MVC   MEMLMODE(4),MMLCR664                           DRK APR18
         B     MEMLEMOD                                       DRK APR18
MMLAANY  MVC   MEMLMODE(4),MMLCAANY
         B     MEMLEMOD
MMLA31   MVC   MEMLMODE(3),MMLCA31
         B     MEMLEMOD
MMLA64   MVC   MEMLMODE(3),MMLCA64                            DRK FEB02
         B     MEMLEMOD                                       ABL OCT85
MMLNONL  DS    0H                                              SS NOV84
         MVC   MEMLATT1,MMLSORCE                               SS NOV84
         B     MEMLADD                                         SS NOV84
MEMLEMOD DS    0H
MEMLADD  DS    0H
         BR    R3            RETURN                            SS JUL85
         DROP  R4                                              SS JUL85
*
*  MEML CONSTANT AREA
*
*
MEMLCVTD DC    V(CONVDATE)                                     SS JUL85
MMLH5    DC    H'5'                                            SS NOV84
MMLH34   DC    H'34'                                           SS NOV84
MMLALI   DC    CL8'*ALIAS'
MMLCNOVS DC    CL4'NOVS'
MMLCAC   DC    CL4'AC= '                                      ABL OCT85
MMLCDC   DC    CL4'DC  '
MMLCNOED DC    CL4'NOED'
MMLCERR  DC    CL4'ERR '
MMLCTEST DC    CL4'TEST'
MMLCNOEX DC    CL4'NOEX'
MMLCLOAD DC    CL4'LOAD'
MMLCOVLY DC    CL4'OVLY'
MMLCSCTR DC    CL4'SCTR'
MMLCREFR DC    CL4'REFR'
MMLCRENT DC    CL4'RENT'
MMLCREUS DC    CL4'REUS'
MMLCERR1 DC    CL4'ERR1'
MMLCERRL DC    CL4'ERRL'
MMLCERRO DC    CL4'ERRO'
MMLCERRS DC    CL4'ERRS'
MMLCERRR DC    CL4'ERRR'
MMLCRANY DC    CL4'RANY'                                      ABL OCT85
MMLCA64  DC    CL4'A64 '                                      DRK FEB02
MMLCA31  DC    CL4'A31 '
MMLCRA64 DC    CL4'A64+'  RMODEANY, AMODE64                   DRK NOV02
MMLCR664 DC    CL4'A64*'  RMODE64,  AMODE64                   DRK APR18
MMLCAANY DC    CL4'AANY'
MMLSORCE DC    CL4'SORC'                                       SS NOV84
         SPACE 2
DATEMASK DC    X'402120612020612020'                           SS JUL85
TRHEX1   DC    C'0123456789ABCDEF'   TRANSLATE TO HEX
TRHEX    EQU   *-256
         LTORG ,                                               SS NOV85
         EJECT
DIRCALIS EQU   B'10000000'         ALIAS FLAG
DIRCTTRN EQU   B'01100000'         TTR COUNT
DIRCUDHW EQU   B'00011111'         HALFWD COUNT
DIRSPFOF EQU   B'01110000'         BITS ARE OFF IN SPF STATS
* SOME BITS ON FOR LOAD MODULES
DIRSPFON EQU   B'00001111'         BITS ARE ON IN SPF STATS
DIRRENT  EQU   B'10000000'           RENT
DIRREUS  EQU   B'01000000'           REUS
DIROVLY  EQU   B'00100000'           OVLY
DIRBADO  EQU   B'11001100'           OVLY      CONFLICTS
DIRTEST  EQU   B'00010000'           TEST
DIRLOAD  EQU   B'00001000'           LOAD ONLY
DIRBADL  EQU   B'00000100'           LOAD ONLY CONFLICTS
DIRSCTR  EQU   B'00000100'           SCTR LOAD
DIRBADS  EQU   B'10101000'           SCTR LOAD CONFLICTS
DIREXEC  EQU   B'00000010'           EXECUTABLE
DIRF1    EQU   B'00000001'
* ATTR 1 BYTE 1
DIRNODC  EQU   B'10000000'           NOT DC
DIRF2    EQU   B'01000000'
DIRF3    EQU   B'00100000'
DIRF4    EQU   B'00010000'
DIRNOED  EQU   B'00001000'           NOT EDITABLE
DIRF5    EQU   B'00000100'
DIRLKEDF EQU   B'00000010'           F LEVEL LINK EDITOR
DIRREFR  EQU   B'00000001'           REFR
* ATTR 2
DIRVS    EQU   B'10000000'           VS LEVEL LINK EDITOR
DIRRES1  EQU   B'01000000'
DIRPG    EQU   B'00100000'           PAGE ALIGNMENT
DIRSSIF  EQU   B'00010000'           SSI PRESENT
DIRAPFF  EQU   B'00001000'           APF PRESENT
* AMODE/RMODE FLAGS
DIRRANY  EQU   B'00010000'           RMODE ANY FLAG
DIRAMOD1 EQU   B'00001100'           AMODE FOR ALIAS
DIRAERR1 EQU   B'00000100'           AMODE INVALID BIT COMB    SS NOV84
DIRAMOD2 EQU   B'00000011'           AMODE FOR MAIN ENTRY
DIRAERR2 EQU   B'00000001'           AMODE INVALID BIT COMB    SS NOV84
MEML0021 DC    X'4021207A2020'                                DRK DEC98
MEML0020 DC    X'402020202120'                                DRK DEC98
         SPACE 2
         AIF   ('&MVSLEV' LT 'MVS510').NOBAPI6                 GP SEP05
         USING PDSEBAPI,R4                                     GP SEP05
PDSEBAPI BAKR  R14,0                 SAVE STATUS               GP SEP05
         LR    R4,R15                SET BASE REGISTER         GP SEP05
         SPACE 1                                               GP JUL10
         STD   R4,DOUBLE             RETRIEVE DESERV STATUS    GP JUL10
PORETRY1 ICM   R2,15,DOUBLE          POINT TO THE FIRST DESB   GP JUL10
         BNP   POBJGETM              NO DESB IN CORE           GP JUL10
         USING DESB,R2                                         GP JUL10
MLDESBLP ICM   R5,15,DESB_COUNT      GET THE SMDE COUNT        GP JUL10
         BZ    MLDESBNX              NONE IN THIS DESB         GP JUL10
         LA    R3,DESB_DATA          POINT TO THE FIRST SMDE   GP JUL10
         USING SMDE,R3                                         GP JUL10
MLSMDELP SR    R1,R1                                           GP JUL10
         ICM   R1,3,SMDE_NAME_OFF    GET NAME SECTION OFFSET   GP JUL10
         AR    R1,R3                 POINT TO NAME SECTION     GP JUL10
         USING SMDE_NAME,R1                                    GP JUL10
         CLI   SMDE_NAME_LEN+1,8     LONG NAME?                GP JUL10
         BH    MLSMDENX              YES, CAN'T BE A MATCH     GP JUL10
         LA    R1,SMDE_NAME_VAL      POINT TO THE NAME         GP JUL10
         DROP  R1                    SMDE_NAME                 GP JUL10
         CLC   DIRNAME,0(R1)         FOUND THE MEMBER?         GP JUL10
         BNE   MLSMDENX              NO, TRY NEXT ONE          GP JUL10
         SR    R15,R15               CLEAR FOR INSERT          GP JUL10
         ICM   R15,3,SMDE_PMAR_OFF   GET OFFSET TO PMAR        GP JUL10
         ALR   R15,R3                POINT TO PMAR SECTION     GP JUL10
         USING PMAR,R15                                        GP JUL10
         CLI   PMAR_LVL,PMAR_PM2_VAL PROGRAM OBJECT LEVEL 1?   GP JUL10
         BL    POBJGETM              YES, DATE NOT AVAILABLE   GP JUL10
         USING PMARL,PMAR_END                                  GP JUL10
         XC    SPFSAVEK(5),SPFSAVEK  COPY BIND DATE            GP JUL10
         MVC   SPFSAVEK+5(3),PMARL_DATE+1                      GP JUL10
         DROP  R15                   PMAR, PMARL               GP JUL10
         SR    R15,R15               ZERO RETURN CODE          GP JUL10
         PR    ,                     RETURN TO CALLER          GP JUL10
MLSMDENX ICM   R0,15,SMDE_LEN        GET LENGTH OF WHOLE SMDE  GP JUL10
         ALR   R3,R0                 POINT TO NEXT SMDE        GP JUL10
         BCT   R5,MLSMDELP           GO LOOK AT IT             GP JUL10
         DROP  R3                    SMDE                      GP JUL10
MLDESBNX ICM   R2,15,DESB_NEXT       POINT TO THE NEXT DESB    GP JUL10
         BNZ   MLDESBLP              GO PROCESS IT             GP JUL10
         DROP  R2                    DESB                      GP JUL10
         SPACE 1                                               GP JUL10
POBJGETM DS    0H                    ACQUIRE WORKING STORAGE   GP JUL10
         LA    R0,IDRAPIWL                                     GP SEP05
         GETMAIN RU,LV=(0),LOC=(31,64),SP=21                   GP SEP05
         LR    R13,R1                                          GP SEP05
         LR    R0,R1                                           GP SEP05
         LA    R1,IDRAPIWL                                     GP SEP05
         SR    R15,R15                                         GP SEP05
         MVCL  R0,R14                ZERO NEW STORAGE          GP SEP05
         USING IDRAPIWK,R13                                    GP SEP05
         MVC   4(4,R13),=CL4'F1SA'   FLAG LINKAGE STACK USAGE  GP SEP05
         SPACE 1                                               GP SEP05
         MVI   BNDRETCD+3,8          NO IDR DATA YET           GP SEP05
         TM    FLAGSHH,FHPGMOBJ      ALREADY KNOW IT IS PGMS?  GP SEP05
         BO    POBJITIS              YES, SAVE A MACRO CALL    GP SEP05
         MVC   BNDDATA(ISITMGDL),ISITMGDS                      GP SEP05
         USING ISM,BNDDATA                                     GP SEP05
         ISITMGD DCB=INDCB,DATATYPE=YES,MF=(E,BNDDATA)         GP SEP05
         TM    ISMOFLG3,ISMDTPGM     PROGRAM OBJECT LIBRARY?   GP SEP05
         BNO   IDRBAPIX              NO, SKIP BINDER API CALL  GP SEP05
         OI    FLAGSHH,FHPGMOBJ      YES, FLAG IT FOR A WHILE  GP SEP05
POBJITIS DS    0H                                              GP SEP05
         SPACE 1                                               GP JUL10
         ICM   R15,15,DOUBLE         FIRST TIME?               GP JUL10
         BNZ   POBJGADN              NO, GET_ALL ALREADY TRIED GP JUL10
         MVI   DOUBLE,X'FF'          YES, PREPARE FOR FAILURE  GP JUL10
         LD    R4,DOUBLE             REMEMBER ACROSS CALLS     GP JUL10
         MVC   BNDDATA(DESRVGL),DESRVGS                        GP JUL10
         DESERV FUNC=GET_ALL,        GET ALL DIRECTORY ENTRIES GP JUL10+
               AREAPTR=BNDCURSR,     RETURNED POINTER AREA     GP JUL10+
               CONN_INTENT=NONE,     HOLD NO CONNECTIONS       GP JUL10+
               DCB=INDCB,            SUPPLY OPEN BPAM DCB      GP JUL10+
               RETCODE=BNDRETCD,     SUPPLY RETURN CODE AREA   GP JUL10+
               RSNCODE=BNDRSNCD,     SUPPLY REASON CODE AREA   GP JUL10+
               SUBPOOL=18,           SUPPLY SUBPOOL ID         GP JUL10+
               MF=(E,BNDDATA,COMPLETE)                         GP JUL10
         ICM   R15,15,BNDRETCD       SUCCESS?                  GP JUL10
         BNZ   POBJGADN              NO, DO IT THE SLOW WAY    GP JUL10
         MVC   DOUBLE(4),BNDCURSR    YES, COPY 1ST DESB ADDR   GP JUL10
         LD    R4,DOUBLE             REMEMBER ACROSS CALLS     GP JUL10
         LR    R1,R13                POINT TO WORKING STORAGE  GP JUL10
         LA    R0,IDRAPIWL           GET ITS SIZE AND FREE IT  GP JUL10
         FREEMAIN RU,LV=(0),A=(1),SP=21                        GP JUL10
         B     PORETRY1              RETRY AFTER GET_ALL SETUP GP JUL10
POBJGADN DS    0H                                              GP JUL10
         SPACE 1                                               GP JUL10
         MVI   IDRBLDL+1,1           NEED BLDL FORMAT,         GP SEP05
         MVI   IDRBLDL+3,76           NOT STOW FORMAT FOR      GP SEP05
         MVC   IDRBLDL+4(8),DIRNAME   BINDER API AND DESERV    GP SEP05
         BLDL  INDCB,IDRBLDL                                   GP SEP05
         LTR   R15,R15               ALL AS IT SHOULD BE?      GP SEP05
         BNZ   IDRBAPIX              NO, THAT'S STRANGE        GP SEP05
         SPACE 1                                               GP SEP05
         MVC   BNDDATA(DESRVGL),DESRVGS                        GP SEP05
         DESERV FUNC=GET,            GET A DIRECTORY ENTRY     GP JAN08+
               AREAPTR=BNDCURSR,     RETURNED POINTER AREA     GP JAN08+
               BYPASS_LLA=YES,       GET LATEST FROM DISK      GP JAN08+
               CONN_ID=MODDEPTR,     SAVE FOR RELEASE          GP JAN08+
               CONN_INTENT=HOLD,     COMPULSORY                GP JAN08+
               DCB=INDCB,            SUPPLY OPEN BPAM DCB      GP JAN08+
               PDSDE=IDRBLDL+4,      POINT TO BLDL RESULTS     GP JAN08+
               RETCODE=BNDRETCD,     SUPPLY RETURN CODE AREA   GP JAN08+
               RSNCODE=BNDRSNCD,     SUPPLY REASON CODE AREA   GP JAN08+
               SUBPOOL=21,           SUPPLY SUBPOOL ID         GP JAN08+
               MF=(E,BNDDATA,COMPLETE)                         GP JAN08
         ICM   R15,15,BNDRETCD       SUCCESS?                  GP JAN08
         BNZ   IDRBAPIX              NO, NO DATA TO LOOK AT    GP JAN08
         DESERV FUNC=RELEASE,        RELEASE THE CONNECTION    GP JAN08+
               CONN_ID=MODDEPTR,       THAT WAS JUST ACQUIRED  GP JAN08+
               DCB=INDCB,            SUPPLY OPEN BPAM DCB      GP JAN08+
               MF=(E,BNDDATA,COMPLETE)                         GP JAN08
         L     R2,BNDCURSR           YES, POINT TO DESB        GP JAN08
         USING DESB,R2                                         GP JAN08
         LA    R3,DESB_DATA          POINT TO THE ACTUAL ENTRY GP JAN08
         USING SMDE,R3                                         GP JAN08
         SR    R15,R15               CLEAR FOR INSERT          GP JAN08
         ICM   R15,3,SMDE_PMAR_OFF   GET OFFSET TO PMAR        GP JAN08
         ALR   R15,R3                POINT TO PMAR SECTION     GP JAN08
         USING PMAR,R15                                        GP JAN08
         MVI   BNDRETCD+3,8          FLAG NO IDR DATE FOUND    GP JAN08
         CLI   PMAR_LVL,PMAR_PM2_VAL PROGRAM OBJECT LEVEL 1?   GP JAN08
         BL    IDRDSRVX              YES, DATE NOT AVAILABLE   GP JAN08
         USING PMARL,PMAR_END                                  GP JAN08
         XC    SPFSAVEK(5),SPFSAVEK  COPY BIND DATE            GP JAN08
         MVC   SPFSAVEK+5(3),PMARL_DATE+1                      GP JAN08
         XC    BNDRETCD,BNDRETCD     IDR DATA EXISTS           GP JAN08
IDRDSRVX DS    0H                    CLEAN UP DESERV STORAGE   GP JAN08
         L     R0,DESB_LEN           RETURNED BUFFER LENGTH    GP JAN08
         LR    R1,R2                 RETURNED BUFFER ADDRESS   GP JAN08
         FREEMAIN RU,LV=(0),A=(1),SP=21                        GP JAN08
         TM    IDRBLDL+27,DIRNOED    NOT EDITABLE?             GP JUL10
         BO    IDRBAPIX              YES, SO DONE ALL WE CAN   GP JUL10
         CLI   BNDRETCD+3,0          NOT NE, BUT GOT DATE?     GP JUL10
         BE    IDRBAPIX              YES, SO SKIP BINDER API   GP JUL10
         DROP  R2,R3,R15             DESB, SMDE, PMAR+PMARL    GP JAN08
         SPACE 1                                               GP JAN08
IDRBAPIE DS    0H                    ENTRY TO BINDER API USAGE GP SEP05
         AGO   .NOFDA1               READ THESE COMMENTS:      GP APR18
*  SKIP BINDER FDA API CALL WHICH I THINK NEVER WORKED ANYWAY  GP APR18
*  - FOR A START VERSION=1 IS PROBABLY NEEDED (FOR PO1 WITH    GP APR18
*    THE FDA API) BUT A TEST OF THIS DID NOT WORK EITHER.      GP APR18
*  - THE FDA API INFRASTRUCTURE ELSEWHERE IN PDS USED BY       GP APR18
*    THIS CODE HAS BEEN REMOVED - BECAUSE THE OTHER ROUTINES   GP APR18
*    HAVE BEEN UPDATED TO USE THE FULL DIALOG API.             GP APR18
*  - IN THEORY CODE IN @MAP COULD BE COPIED HERE TO PROCURE    GP APR18
*    THE BIND DATE, BUT THERE ARE SO FEW PO1 PROGRAMS AROUND   GP APR18
*    THESE DAYS THAT I DON'T THINK THE BLOAT IS WORTH IT.      GP APR18
*                                                              GP APR18
         XC    BNDCURSR(256),BNDCURSR                          GP JUL10
         ICM   R0,15,IEWBFDAT        LOAD ISSUED?              GP JUN10
         BNZ   FDALOAD               YES                      DRK JAN09
         LOAD  EPLOC=IDRBFDAT        GET IEWBFDAT EPA          GP SEP05
         ST    R0,IEWBFDAT           SAVE IEWFDAT EPA         DRK JAN09
FDALOAD  DS    0H                                             DRK JAN09
         ST    R0,FDAENTPT           SAVE IT IN LOCAL PARM     GP SEP05
         LA    R0,FDAENTPT           INITIALIZE PLIST          GP SEP05
         ST    R0,FDAEPTAD                                     GP SEP05
         XC    MODTOKEN,MODTOKEN                               GP SEP05
         LA    R0,MODTOKEN                                     GP SEP05
         ST    R0,FDATKNAD                                     GP SEP05
         LA    R0,BNDRETCD                                     GP SEP05
         ST    R0,FDARETAD                                     GP SEP05
         LA    R0,BNDRSNCD                                     GP SEP05
         ST    R0,FDARSNAD                                     GP SEP05
         LA    R0,INDCB                                        GP SEP05
         ST    R0,MODDCBPT                                     GP SEP05
         LA    R0,MODDCBPT                                     GP SEP05
         ST    R0,FDADCBAD                                     GP SEP05
         LA    R0,IDRBLDL+4                                    GP SEP05
         ST    R0,MODDEPTR                                     GP SEP05
         LA    R0,MODDEPTR                                     GP SEP05
         ST    R0,FDADEADR                                     GP SEP05
         LA    R0,BNDDATA                                      GP SEP05
         ST    R0,FDABFRAD                                     GP SEP05
         LA    R0,BNDCURSR                                     GP SEP05
         ST    R0,FDACSRAD                                     GP SEP05
         LA    R0,BNDCOUNT                                     GP SEP05
         ST    R0,FDACNTAD                                     GP SEP05
         LA    R0,FDAHOLD                                      GP SEP05
         ST    R0,FDAHLDAD                                     GP SEP05
         OI    FDAHLDAD,X'80'      FLAG LAST PARAMETER         GP SEP05
         LA    R0,FDADEL                                       GP SEP05
         ST    R0,FDADELAD                                     GP SEP05
         MVI   FDADEL,C'N'                                     GP SEP05
         MVI   FDAHOLD,C'N'        ONLY DOING ONE CALL PER PGM GP SEP05
         USING IEWBIDB,BNDDATA                                 GP SEP05
         LA    R0,CLS_IDRB                                     GP SEP05
         ST    R0,FDACLSAD                                     GP SEP05
         MVC   IEWBIDB(IDBH_LENG),IDBI_INIT_VALUES             GP SEP05
         LA    R1,BNDPARMS         POINT TO PARAMETER LIST     GP SEP05
         L     R15,FDAENTPT                                    GP SEP05
         BASSM R14,R15             CALL BINDER API             GP SEP05
         CLC   BNDRETCD,=F'4'      ANY DATA RETURNED?          GP SEP05
         BH    IDRBDONE            NO                          GP SEP05
         USING IDB_ENTRY,IDBH_END                              GP SEP05
         ICM   R5,15,BNDCOUNT      GET RETURNED RECORD COUNT   GP SEP05
         BNP   IDRBDONE            NO ENTRIES WERE RETURNED    GP SEP05
         PACK  SPFSAVEK(8),IDB_DATE_BOUND                      GP SEP05
         XC    BNDRETCD,BNDRETCD   IDR DATA EXISTS             GP SEP05
IDRBDONE DS    0H                                              GP SEP05
*        DELETE EPLOC=IDRBFDAT     DISCARD IEWBFDAT            GP SEP05
.NOFDA1  ANOP  ,                                               GP APR18
         SPACE 1                                               GP SEP05
IDRBAPIX LR    R1,R13                                          GP SEP05
         LA    R0,IDRAPIWL                                     GP SEP05
         L     R3,BNDRETCD         GET RETURN CODE             GP SEP05
         FREEMAIN RU,LV=(0),A=(1),SP=21                        GP SEP05
         LR    R15,R3              SET RETURN CODE             GP SEP05
         PR    ,                   BACK TO THE 370 WORLD       GP SEP05
         SPACE 2                                               GP SEP05
         DROP  R13                 IDRAPIWK                    GP SEP05
         DROP  R4                  PDSEBAPI                    GP JAN08
         SPACE 2                                               GP SEP05
         AGO   .NOFDA2             SEE .NOFDA1 COMMENTS ABOVE  GP APR18
IDRBFDAT DC    CL8'IEWBFDAT'                                   GP SEP05
CLS_IDRB DC    H'6',CL6'B_IDRB'                                GP SEP05
.NOFDA2  ANOP  ,                                               GP APR18
         SPACE 1                                               GP SEP05
ISITMGDS ISITMGD DCB=0,DATATYPE=YES,MF=L                       GP SEP05
ISITMGDL EQU   *-ISITMGDS                                      GP SEP05
DESRVGS  DESERV FUNC=GET,MF=L                                  GP JAN08
DESRVGL  EQU   *-DESRVGS                                       GP JAN08
         SPACE 1                                               GP SEP05
         AGO   .NOFDA3             SEE .NOFDA1 COMMENTS ABOVE  GP APR18
         IEWBUFF FUNC=MAPBUF,BYTES=2048,TYPE=IDRB,VERSION=3    GP SEP05
.NOFDA3  ANOP  ,                                               GP APR18
         SPACE 2                                               GP SEP05
         LTORG ,                                               GP SEP05
         DC    0D'0'                                           GP SEP05
         SPACE 2                                               GP SEP05
IDRAPIWK DSECT ,                                               GP SEP05
         DS    0D                                              GP SEP05
         DS    18F                 REGISTER SAVE AREA          GP SEP05
IDRBLDL  DS    XL80                BLDL RESULTS AREA           GP SEP05
MODTOKEN DS    D                   MODULE TOKEN                GP SEP05
FDAENTPT DS    A                   IEWBFDAT EPA                GP SEP05
BNDRETCD DS    F                   RETURN CODE                 GP SEP05
BNDRSNCD DS    F                   REASON CODE                 GP SEP05
MODDCBPT DS    A                   POINTER TO THE OPEN DCB     GP SEP05
MODDEPTR DS    A                   POINTER TO BLDL DATA        GP SEP05
BNDCURSR DS    A                   CURSOR                      GP SEP05
BNDCOUNT DS    A                   ENTRY COUNT                 GP SEP05
         SPACE 1                                               GP SEP05
BNDPARMS DS    0F                  IEWBFDAT PARAMETER LIST     GP SEP05
FDAEPTAD DS    A                   POINTER TO MODULE EPA       GP SEP05
FDATKNAD DS    A                   POINTER TO MODULE TOKEN     GP SEP05
FDARETAD DS    A                   POINTER TO RETURN CODE      GP SEP05
FDARSNAD DS    A                   POINTER TO REASON CODE      GP SEP05
FDAETKAD DS    A                   POINTER TO EPTOKEN          GP SEP05
FDADDNAD DS    A                   POINTER TO DD NAME          GP SEP05
FDAMEMAD DS    A                   POINTER TO MEMBER NAME      GP SEP05
FDADCBAD DS    A                   POINTER TO DCB POINTER      GP SEP05
FDADEADR DS    A                   POINTER TO BLDL DATA PTR    GP SEP05
FDACLSAD DS    A                   POINTER TO CLASS NAME       GP SEP05
FDASECAD DS    A                   POINTER TO SECTION NAME     GP SEP05
FDABFRAD DS    A                   POINTER TO DATA BUFFER      GP SEP05
FDACSRAD DS    A                   POINTER TO STARTING POSITIONGP SEP05
FDACNTAD DS    A                   POINTER TO DATA COUNT       GP SEP05
FDAHLDAD DS    A                   POINTER TO HOLD FLAG        GP SEP05
FDADELAD DS    A                   POINTER TO DELETE FLAG      GP SEP05
         SPACE 1                                               GP SEP05
FDAHOLD  DS    C                   HOLD BINDER RESOURCES FLAG  GP SEP05
FDADEL   DS    C                   DELETE BINDER API MODULE FLAGP SEP05
         SPACE 1                                               GP SEP05
BNDDATA  DS    0D,XL2048           RETURNED API DATA AREA      GP SEP05
IDRAPIWL EQU   *-IDRAPIWK                                      GP SEP05
         SPACE 1                                               GP SEP05
         IGWCISM DSECT=YES         ISITMGD PLIST               GP SEP05
ISPDSPY  CSECT ,                   BACK TO FETCHABLE CODE      GP SEP05
.NOBAPI6 ANOP  ,                                               GP SEP05
         TITLE 'MEMLIST LINE CMD FUNCTION'                     SS NOV85
*                                                              SS SEP84
*  MEMLIST LINE CMD PROCESSOR                                  SS SEP84
*                                                              SS SEP84
ISPLNC2  DS    0H                                              SS SEP84
         USING *,R4                                            SS NOV85
         TM    SPFTFLG1,SPFTLPOS  POST PROCESSING REQUIRED     SS NOV85
         BO    ISPPOST              YES                        SS NOV85
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         OC    MEMLDATA,ISPBLK8     MAKE UPPER CASE            SS SEP84
ISPLNC00 DS    0H                       *                      SS JUL87
         BAS   R2,ISPTBNT           NOTE LINE ROW ID           SS MAY89
         MVC   SPFTNOTE,SPFFIXED    SAVE ROW ID                SS MAY89
         OC    MEM2OPT,ISPBLK8 FORCE UPPER CASE                SS NOV85
         MVC   SPFTEMPD(8),ISPBLK8  SEARCH STRING (8 BYTES)   ABL JAN87
         MVC   SPFTEMPD(4),MEM2OPT  FIRST FOUR BYTES          ABL JAN87
         LA    R1,SPFTEMPD          START OF SEARCH           ABL JAN87
         LA    R15,4          LIMIT OF SCAN OF LINE ENTRY      SS NOV85
         L     R14,SPFTBPLC  TABLE FOR SEARCH                  SS NOV85
         BAS   R2,ISPVER1           CHECK CMD VERB             SS NOV85
         MVC   SPFTTPT,SPFVTPT      COPY POINTER               SS NOV85
         TM    $TLF2(R14),#H        FROM LINE O CMD ONLY       SS NOV85
         BO    ISPLNB3                                         SS NOV85
         TM    $TLF2(R14),#D        NOT FOR REPEAT CMDS        SS DEC87
         BO    ISPLNC4              YES, SKIP                  SS DEC87
         TM    $TLF1(R14),#E        POSSIBLE CLIST             SS DEC87
         BO    ISPLNC4              YES, PROCESSED LATER       SS DEC87
         MVC   SPFBLKCM,$TLCM(R14)  SAVE COMMAND FOR REPEAT    SS DEC87
ISPLNC4  DS    0H                                              SS SEP84
         MVI   SPFTPOSI,0           DEFAULT POST PROCESSOR     SS SEP84
         OI    SPFTFLG1,SPFTLPOS    POST PROCESSING TO GO      SS NOV85
ISPLNC5  DS    0H                                              SS SEP84
         SR    R15,R15                                         SS SEP84
         IC    R15,$TLFU(R14)       GET PROCESSOR INDEX        SS JUL85
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLNBAD          0  INVALID                    SS SEP84
         B     ISPMMLNL          4  BLANK ENTRY                SS SEP84
         B     ISPDELL           8  DEL MEML ENTRY             SS NOV84
         B     ISPLALI          12  ALIAS                      SS SEP84
         B     ISPGEN           16  GENERAL PROCESSOR          SS SEP84
         B     ISPLDEL          20  DELETE                     SS SEP84
         B     ISPLREN          24  RENAME                     SS SEP84
         B     ISPLNBAD         28  UNDO                       SS SEP84
         B     ISPLPND          32  SELECT PANEL SUPPORT       SS NOV84
         B     ISPSTAT1         36  STATUS COMMAND             SS SEP84
         B     ISPUTL1          40  UTILITY COMMANDS           SS SEP84
         B     ISPLKED          44  UPDATE LINK DATE           SS AUG86
         B     ISPLMENU         48  NOT USED                   SS DEC87
         B     ISPMLOG          52  LOG MEMLIST LINE           SS NOV86
         B     ISPLNCSL         56  SELECT COMMAND             SS JUL87
         B     ISPLNCXX         60  EXTENDED XCTL              SS JUL87
         B     ISPLCOM          64  COMPARE                   ABL SEP88
         B     ISPLREP          68  REPRO                     ABL SEP88
         B     ISPMMTAG         72  TAG LINE                   SS NOV88
         B     ISPLNBAD         76  PAD                        SS NOV88
         SPACE 3                                               SS SEP84
ISPLERR  DS    0H                                              SS SEP84
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         MVC   MEMLDATA,ISPERMSG                               SS SEP84
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                ABL JUN85
         MVI   SPFMSGID+7,C'A'                                ABL JUN85
         MVI   SPFMSGID+6,C'1'    GENERAL ERROR MESSAGE       ABL JUN85
         B     ISPLNB2          CONTINUE                       SS SEP84
ISPLNBAD DS    0H                                              SS SEP84
ISPLNB3  DS    0H                                              SS SEP84
         MVC   MEMLDATA,ISPINVLD    INVALID MESSAGE            SS SEP84
ISPLNB2  DS    0H                                              SS NOV85
         OI    SPFLAG2,SPFNPOS      POSITIONING NOT ALLOWED   ABL APR86
         BAS   R2,ISPTBMOD          UPDATE TABLE LINE          SS SEP84
         BAS   R2,ISPQUERY                                     SS MAR85
         MVC   SPFTCCRP,SPFTCRP     SAVE CUR CPR FOR CURSOR    SS AUG86
         NI    SPFTFLG1,255-SPFTLPOS  RESET POST PROC FLAG     SS AUG86
         OI    SPFTFLG2,SPFLKILL   SET FOR ERROR               SS AUG86
         MVC   SPFBLKCM(4),ISPBLK8  BLANK INVALID CMD          SS DEC87
         CLC   SPFTCCRP,SPFTTOP2    CURSOR WITHIN RANGE        SS MAR89
         BNL   ISPLN100             YES                        SS MAR89
         MVC   SPFTTOP2,SPFTTOP     TRY IT WITH SCROLL         SS MAR89
         CLC   SPFTCCRP,SPFTTOP2    CURSOR WITHIN RANGE        SS MAR89
         BNL   ISPLN100             YES                        SS MAR89
         MVC   SPFTTOP2,SPFTCCRP    SET SCROLL TO CURSOR       SS MAR89
ISPLN100 LA    R15,100             TBDISPL SUPPORT             SS MAR89
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 2                                               SS NOV85
ISPCMDL  DS    0H                                              SS NOV85
         OI    SPFLAG2,SPFLNCD    SET FOR RENAME/ALIAS         SS NOV85
         LA    R15,112            ISPCMDC                      SS NOV85
         MVC   SPFSAVM2,MEMLNAME  SAVE THE ACTUAL MEMBER NAME ABL JAN87
         BR    R3                 RETURN TO ROUTER             SS NOV85
         SPACE 2                                               SS SEP84
ISPLNCXX DS    0H                                              SS NOV85
         SR    R0,R0                    ZERO FOR IC            SS JUL87
         IC    R0,$TLEX(R14)            EX CODE                SS JUL87
         LA    R15,156                  EXTENSION FUNCTION     SS JUL87
         BR    R3                       RETURN TO ROUTER       SS JUL87
         SPACE 2                                               SS NOV85
ISPPOST  DS    0H                                              SS SEP84
         L     R15,SPFTNOTE        GET SAVED ROW ID            SS MAY89
         BAS   R2,ISPTBRD          PREPOSITION TO ROW          SS MAY89
         L     R14,SPFTTPT         GET MY TABLE ENTRY          SS NOV85
         NI    SPFLAG2,255-SPFLNCD    FOR RENAME/ALIAS         SS NOV85
         SR    R15,R15                                         SS SEP84
         IC    R15,SPFTPOSI         GET POST PROCESSOR INDEX   SS SEP84
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLNX            0  CLEAN UP                   SS SEP84
         B     ISPLNV            4  RETURN AFTER STATS REFRESH SS SEP84
         B     ISPDELP           8  DEL MEML ENTRY             SS SEP84
         B     ISPLALIP         12  ALIAS                      SS SEP84
         B     ISPGENP          16  GENERAL PROCESSOR          SS SEP84
         B     ISPLDELP         20  DELETE                     SS NOV84
         B     ISPLRENP         24  RENAME                     SS SEP84
         B     ISPLNX           28  RESET                      SS SEP84
         B     ISPLPNDP         32  SELECT PANEL SUPPORT       SS NOV84
         B     ISPSTAP2         36  STATUS PART 2              SS SEP84
         B     ISPSTAP3         40  STATUS PART 3              SS SEP84
         B     ISPSTAP4         44  STATUS PART 4              SS SEP84
         B     ISPEDITP         48  EDIT POST PROCESSING       SS JUL87
         B     ISPLSTU8         52  RETURN STATUS ALL TODAY    SS JUL87
         B     ISPLNB2          56  RETURN WITH ERROR          SS NOV88
         SPACE 3                                               SS SEP84
ISPLNV   DS    0H                                              SS SEP84
         L     R14,SPFTTPT         GET MY TABLE ENTRY          SS NOV85
         TM    $TLF1(R14),#V       VIEW MODE TO FOLLOW         SS SEP84
         BZ    ISPLNX              NO                          SS NOV85
         MVI   SPFTPOSI,28         COME BACK TO ISPLNX         SS NOV85
* HIERARCHICAL SUPPORT REMOVED                                 SS OCT88
         BAS   R2,ISPSETST              SET AND RETRIEVE STAT  SS OCT88
         LA    R15,100                  DISPLAY PANEL          SS OCT88
         LTR   R1,R1                    THIS LOG ALREADY       SS OCT88
         BZR   R3                       YES EXIT               SS OCT88
         LH    R1,SPFFUNLP+0            GET LOG LAST PANEL     SS OCT88
         LNR   R1,R1                    SET FOR SWAP           SS OCT88
         BAS   R2,ISPSTKI               SWAP TO LOG PANEL      SS OCT88
         LA    R15,100                  DISPLAY PANEL          SS OCT88
         BR    R3                       RETURN TO ROUTER       SS OCT88
ISPMMLNL DS    0H                                              SS MAR85
         MVC   MEM2OPT,ISPBLK8  CLEAR X41                      SS JUL87
         CLI   MEMLDATA,C'*'    IS IT A MSG                    SS MAR85
         BNE   ISPMMLNK         NO,  CLEAR                     SS MAR85
         CLC   MEMLDATA,ISPINVLD  INVALID MSG                  SS MAR85
         BNE   ISPMMLN2         NO, DON'T CLEAR               ABL JUN85
ISPMMLNK DS    0H                                              SS MAR85
         MVC   MEMLDATA,ISPBLK8    BLANK OUT DATA              SS MAR85
ISPMMLN2 DS    0H                                             ABL JUN85
         BAS   R2,ISPTBMOD      UPDATE TABLE                   SS MAR85
         B     ISPLNX2                                         SS MAR85
ISPLNX   DS    0H                                              SS NOV85
         BAS   R2,ISPQUERY      GET CUR CRP FOR CURSOR         SS MAR85
         MVC   SPFTCCRP,SPFTCRP SAVE CUR CRP                   SS AUG86
ISPLNX2  DS    0H                                              SS MAR85
         NI    SPFTFLG1,255-SPFTLPOS                           SS JUL87
         TM    SPFTFLG2,SPFRETOP        DO WE NEED TBTOP       SS MAR89
         BZ    *+12                     NO                     SS MAR89
         BAS   R2,ISPTOP                START AT TOP           SS MAR89
         NI    SPFTFLG2,255-SPFRETOP    NOW RESET FLAG         SS MAR89
         BAS   R2,ISPNXLN       NEXT LINE COMMAND              SS JUL87
         LTR   R15,R15                  *                      SS JUL87
         BZ    ISPLNC2          PROCESS IT                     SS JUL87
*  AT THIS POINT ANY DEFERED LINE COMMAND CAN NOW BE PROCESSED SS JUL87
ISPLNX3  DS    0H                                              SS AUG89
         BAS   R2,ISPBOTM       RESET TO BOTTOM                SS JUL87
         LA    R15,100          TABLE PANEL DISPLAY SUPPORT    SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 2                                               SS SEP84
ISPMMTAG DS    0H                       *                      SS NOV88
         BAS   R2,ISPLMSGS         SET DATA FIELD              SS NOV88
         MVC   MEM2OPT,ISPBLK8     CLEAR OPT                   SS NOV88
         BAS   R2,ISPTBMOD      UPDATE TABLE                   SS AUG89
         BAS   R2,ISPSKIP1      POSITION TO NEXT LINE          SS AUG89
         LTR   R15,R15          ANY MORE LINES                 SS AUG89
         BNE   ISPLNX3          NO, DONE                       SS AUG89
         CLC   MEM2OPT,ISPBLK8  ANY OPT                        SS AUG89
         BE    ISPLNX           NO, SET THIS POSITION          SS AUG89
         B     ISPLNC2          YES, PROCESS IT                SS AUG89
ISPLDELP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR                                         SS SEP84
         MVI   MEM2STAT+1,C'D'     MARK NO LONGER ACTIVE       SS AUG86
         CLI   SPFTDEL,C'N'        REMOVE DELETED ENTRIES      SS JUL87
         BE    ISPGENP             NO, SAME POST PROCESSING    SS JUL87
         BAS   R2,ISPDEL1          REMOVE FROM TABLE           SS NOV84
         B     ISPLNX              CONTINUE WITH NEXT ENTRY    SS NOV84
ISPLRENP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR             SAME POST PROCESSING        SS SEP84
         BAS   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         MVI   MEM2STAT+1,C'R'     NO LONGER ACTIVE            SS AUG86
         BAS   R2,ISPTBMOD         UPDATE TABLE                SS SEP84
         BAS   R2,MEMLSAVE         SAVE MEML VARS              SS AUG86
         CLI   SPFSAVM2,C' '       RENAME PASS A NAME          SS AUG85
         BNH   ISPLREN3            NO                          SS NOV85
         MVC   MEMLNMSV,SPFSAVM2   YES USE                     SS NOV85
ISPLREN3 DS    0H                                              SS NOV85
         XC    MEMLNAME,MEMLNMSV   EXCHANGE NAMES              SS JUL87
         XC    MEMLNMSV,MEMLNAME        *                      SS JUL87
         XC    MEMLNAME,MEMLNMSV   ADD ENTRY FOR NEWNAME       SS JUL87
         BAS   R2,ISPGET          GET IF ANY                   SS AUG86
         BAS   R2,MEMLSET         SET VARS                     SS AUG86
         MVI   MEM2STAT+1,C' '     MAKE SURE IT IS ACTIVE      SS AUG86
         MVC   MEMLDATA,ISPNEWNM   PUT MSG IN MEMLIST TABLE    SS SEP84
         LTR   R15,R15             OVERLAY ONE                 SS SEP84
         BZ    ISPLREN5            YES                         SS SEP84
         BAS   R2,ISPTBADD         UPDATE TABLE                SS AUG86
         B     ISPLREN6                                        SS JUL87
ISPLREN5 DS    0H                                              SS SEP84
         BAS   R2,ISPTBMOD         UPDATE TABLE                SS AUG86
ISPLREN6 DS    0H                                              SS JUL87
         MVC   MEMLNAME,MEMLNMSV   GET BACK TO ORIGINAL NAME   SS JUL87
         BAS   R2,ISPGET           POSITION                    SS JUL87
         CLI   SPFTOLD,C'N'        REMOVE OLD ENTRIES          SS JUL87
         BE    ISPLNV              NO                          SS JUL87
         BAS   R2,ISPDEL1          REMOVE FROM TABLE           SS JUL87
         B     ISPLNV                                          SS JUL87
ISPLALIP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR             SAME POST PROCESSING        SS SEP84
         BAS   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         BAS   R2,ISPTBMOD         UPDATE TABLE                SS SEP84
         BAS   R2,MEMLSAVE         SAVE MEML VAR               SS AUG86
         CLI   SPFSAVM2,C' '       RENAME PASS A NAME          SS AUG85
         BNH   ISPLALI3            NO                          SS NOV85
         MVC   MEMLNMSV,SPFSAVM2   YES USE                     SS NOV85
         CLC   MEMLNAME,MEMLNMSV   SAME NAME?                 ABL JAN87
         BE    ISPLSTAT            YES, QUIT                  ABL JAN87
ISPLALI3 DS    0H                                              SS NOV85
         XC    MEMLNAME,MEMLNMSV   EXCHANGE NAMES              SS JUL87
         XC    MEMLNMSV,MEMLNAME        *                      SS JUL87
         XC    MEMLNAME,MEMLNMSV   ADD ENTRY FOR NEWNAME       SS JUL87
         BAS   R2,ISPGET           ANY THE SAVE                SS AUG86
         BAS   R2,MEMLSET         SET VARS                     SS AUG86
         MVI   MEM2STAT+1,C' '     MAKE SURE IT IS ACTIVE      SS AUG86
         MVC   MEMLDATA,ISPNEWNM   PUT MSG IN MEMLIST TABLE    SS SEP84
         LTR   R15,R15             OVERLAY ONE                 SS SEP84
         BE    ISPLALI5                                        SS SEP84
         BAS   R2,ISPTBADD         UPDATE TABLE                SS AUG86
         B     ISPLSTAT            RESET STATS                 SS SEP84
ISPLALI5 DS    0H                                              SS SEP84
         BAS   R2,ISPTBMOD         UPDATE TABLE                SS SEP84
         B     ISPLSTAT            RESET STATS                 SS SEP84
         SPACE 2                                               SS SEP84
ISPLREN  DS    0H  RENAME  REQUIRES A NAME IN THE DATA FIELD   SS JUL87
ISPLALI  DS    0H  ALIAS   REQUIRES A NAME IN THE DATA FIELD   SS JUL87
ISPLCOM  DS    0H  COMPARE REQUIRES A NAME IN THE DATA FIELD  ABL SEP88
ISPLREP  DS    0H  REPRO   REQUIRES A NAME IN THE DATA FIELD  ABL SEP88
         CLI   MEM2STAT+1,C' '     IS THIS A GOOD MEMBER       SS JUL87
         BH    ISPLNBAD            CANNOT PROCESS              SS JUL87
         CLI   MEMLDATA,C' '       ANY NEW NAME                SS JUL87
         BE    ISPLNONW            NO, NO NEW NAME             SS JUL87
         CLI   MEMLDATA,C'*'       STATUS MESSAGE?             SS JUL87
         BE    ISPLNONW            NO, NO NEW NAME             SS JUL87
         B     ISPGEN              PROCESS LIKE THE REST       SS JUL87
ISPLNONW DS    0H                       *                      SS JUL87
         MVC   SPFMLIN1,ISPBLK8         *                      SS JUL87
         MVI   SPFMLIN2,C' '            BLANK                  SS JUL87
         MVC   SPFMLIN2+1(78),SPFMLIN2  AND REPEL              SS JUL87
         MVC   SPFMLIN2(L'ISPLNWMG),ISPLNWMG    LEV 2 MSG      SS JUL87
         B     ISPLERR                  SET UP ERROR MSG       SS JUL87
ISPLNWMG DC    C'A NAME MUST BE SPECIFIED IN THE DATA FIELD'  ABL SEP88
ISPLDEL  DS    0H                                              SS SEP84
* FUTURE .. SAVE DIR DATA IN MEMORY FOR UNDO COMMAND           SS JUL87
ISPGEN   DS    0H                                              SS SEP84
         CLI   MEM2STAT+1,C' '     IS THIS A GOOD MEMBER       SS AUG86
         BH    ISPLNBAD            CANNOT PROCESS              SS NOV84
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         TM    $TLF2(R14),#R       REAL CMD OFFSET*2           SS JUL87
         BZ    ISPGEN4                                         SS JUL87
         SR    R15,R15                                         SS JUL87
         IC    R15,$TLEX(R14)                                  SS JUL87
         LA    R15,ISPREAL(R15)                                SS JUL87
         MVC   MEM2OPT,0(R15)      SET OPT TO REAL CMD         SS JUL87
         B     ISPLNC00            REPROCESS                   SS JUL87
ISPGEN4  DS    0H                                              SS JUL87
         MVC   SPFTPOSI(1),$TLFU(R14)  POST PROCESSING INDEX   SS JUL85
         TM    $TLF2(R14),#P       DIFFERENT POST PROC         SS NOV84
         BZ    ISPGEN2              NO SKIP                    SS NOV84
         MVC   SPFTPOSI(1),$TLEX(R14) USE IT                   SS NOV84
ISPGEN2  DS    0H                                              SS SEP84
         MVC   PUTGETBF(4),ISPCMD34                           ABL JAN87
         MVC   SPFINPUT(8),$TLCM(R14)  COPY COMMAND NAME       SS JUL87
         MVI   SPFINPUT+8,C' '                                 SS SEP84
         MVC   SPFINPUT+9(8),MEMLNAME                          SS SEP84
         MVI   SPFINPUT+17,C' '                               ABL OCT84
         MVC   SPFINPUT+18(12),SPFINPUT+17                    ABL JAN87
         CLI   MEMLDATA,X'00'      NULLS                       SS NOV84
         BE    ISPGEN5             YES, CONVERT TO BLANKS      SS NOV84
         CLI   MEMLDATA,C'*'       STATUS MESSAGE?            ABL OCT84
         BNE   ISPGEN3             NO, BRANCH                 ABL JAN87
         CLI   MEMLDATA+1,X'40'    "* " FORM?                 ABL JAN87
         BE    ISPGEN3             YES, BRANCH                ABL JAN87
ISPGEN5  DS    0H                                              SS NOV84
         MVC   MEMLDATA(8),ISPBLK8 BLANK IT OUT               ABL OCT84
ISPGEN3  DS    0H                                             ABL JAN87
         MVC   SPFINPUT+18(8),MEMLDATA                        ABL OCT84
         MVC   MEMLNMSV,MEMLDATA                               SS NOV84
         TM    $TLF1(R14),#O       ADD T( ?                   ABL JAN87
         BNO   ISPGEN7             NO, BRANCH                 ABL JAN87
         CLI   MEMLDATA,X'40'      ANY MEMBER NAME?           ABL JAN87
         BE    ISPGEN7             NO, BRANCH                 ABL JAN87
*                                  TO(...) FOR BETTER PROMPT  DRK SEP10
         MVI   SPFINPUT+18,C'T'    ADD T                      DRK SEP10
         MVI   SPFINPUT+19,C'O'    ADD O                      DRK SEP10
         MVI   SPFINPUT+20,C'('    ADD (                      DRK SEP10
         MVC   SPFINPUT+21(8),MEMLDATA  ADD MEMBER NAME       DRK SEP10
         MVI   SPFINPUT+29,C')'    ADD )                      DRK SEP10
*        MVI   SPFINPUT+18,C'T'    ADD T                      ABL JAN87
*        MVI   SPFINPUT+19,C'('    ADD (                      ABL JAN87
*        MVC   SPFINPUT+20(8),MEMLDATA  ADD MEMBER NAME       ABL JAN87
*        MVI   SPFINPUT+28,C')'    ADD )                      ABL JAN87
ISPGEN7  DS    0H                                             ABL JAN87
         TM    $TLF1(R14),#V       VIEW MODE OUTPUT?           SS DEC84
         BZ    ISPGEN6             NO, BRANCH                  SS DEC84
         OI    SPFLAG3,SPFLOGM     YES, MARK FOR LOGGING       SS DEC84
ISPGEN6  DS    0H                                              SS NOV84
         TM    $TLF2(R14),#M       UPDATE STATS                SS NOV88
         BZ    ISPCMDL             NO, SKIP UPDATE FOR EDIT    SS NOV88
         CLI   SPFALUP,C'Y'        ALIAS UPDATE FOR EDIT       SS JUL87
         BNE   ISPGEN8             YES                         SS NOV88
         XC    SPFEDTTR,SPFEDTTR   ZERO TTR                    SS NOV88
         MVC   DIRNAME(8),MEMLNAME MEMBER NAME                ABL FEB86
         BAS   R2,ISPBLDL          DO BLDL                     SS AUG86
         LTR   R15,R15             GOOD BLDL                   SS NOV88
         BNZ   ISPGEN8             NO                          SS NOV88
         MVC   SPFEDTTR,DIRTTR     SAVE TTR                    SS NOV88
         B     ISPGEN9                  *                      SS NOV88
ISPGEN8  DS    0H                                              SS NOV88
         CLI   SPFEDUP,C'Y'        FULL UPDATE FOR EDIT        SS JUL87
         BNE   ISPCMDL             NO                          SS JUL87
ISPGEN9  DS    0H                                              SS NOV88
         TIME  DEC                 YES, MARK TIME              SS JUL87
         ST    R1,SPFDAY                STORE TODAYS DATE      SS JUL87
         ST    R0,SPFTIME               STORE TIME OF DAY      SS JUL87
         B     ISPCMDL                                        ABL OCT84
ISPGENP  DS    0H                                              SS SEP84
* #V: ATTRIB, COMPARE, DIR, FIND, HISTORY, LIST, MAP & VERIFY ABL DEC84
         TM    $TLF1(R14),#V       VIEW MODE EXPECTED?        ABL DEC84
         BO    ISPGENP2            YES, IGNORE ERROR MSG FLG  ABL DEC84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS?                 SS SEP84
         BO    ISPLERR             YES, TERMINATE LIST CMDS.   SS SEP84
ISPGENP2 DS    0H                                             ABL SEP84
         BAS   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         BAS   R2,ISPTBMOD         UPDATE TABLE                SS SEP84
         TM    ##ADRPA#,$F         SOFT ATTN SIGNALLED?       ABL APR85
         BNO   ISPLSTU0            NO, BRANCH                 ABL APR85
         NI    ##ADRPA#,255-$F     YES, TURN OFF FLAG         ABL APR85
         MVC   MEMLDATA,ISPATTN    SPECIAL *ATTN* FLAG        ABL APR85
         B     ISPLNB2             TERMINATE LINE COMMANDS    ABL APR85
ISPLSTU0 DS    0H                                             ABL APR85
         L     R14,SPFTTPT         RESTORE R14 WITH TABLE ENT  SS NOV85
         TM    $TLF2(R14),#M       UPDATE STATS                SS NOV84
         BZ    ISPLNV              NO CONTINUE                 SS NOV84
         MVC   MEMLNMSV,MEMLNAME   MAKE SAME                   SS JUL87
ISPLSTAT DS    0H                                              SS NOV84
         OI    SPFTFLG2,SPFRETOP        DO CMD SCAN FROM TOP   SS MAR89
         OI    SPFLAG2,SPFUPDA                                 SS NOV84
         MVC   DIRNAME(8),MEMLNAME MEMBER NAME                ABL FEB86
         BAS   R2,ISPBLDL          DO BLDL                     SS AUG86
         LTR   R15,R15             GOOD BLDL                   SS NOV88
         BNZ   ISPLSTU2            NO, SKIP                    SS NOV88
         BAS   R2,MEMLISTI         UPDATE STATS                SS AUG86
         BAS   R2,MEMLSET          SET VARS                    SS AUG86
         BAS   R2,ISPTBMOD         MOD OR ADD                  SS AUG86
ISPLSTU2 DS    0H                                              SS NOV88
         CLC   MEMLNAME,MEMLNMSV   SAME NAME                   SS JUL87
         BE    ISPLNV              YES, CONTINUE               SS JUL87
         MVC   MEMLNAME,MEMLNMSV   GET BACK TO ORIGINAL NAME   SS JUL87
         BAS   R2,ISPGET           POSITION                    SS JUL87
         B     ISPLNV                   *                      SS AUG86
ISPEDITP DS    0H                       *                      SS JUL87
         MVC   MEMLNMSV,MEMLNAME   SAVE NAME                   SS MAR89
         CLI   SPFALUP,C'Y'        ALIAS UPDATE                SS NOV88
         BNE   ISPEDITX            NO, NORMAL POST PROCESSING  SS NOV88
         CLI   SPFEDTTR+2,0        ANY R                       SS NOV88
         BE    ISPEDITX            NO, SKIP                    SS NOV88
         MVC   DIRNAME(8),MEMLNAME MEMBER NAME                 SS NOV88
         BAS   R2,ISPBLDL          DO BLDL                     SS AUG86
         LTR   R15,R15             GOOD BLDL                   SS NOV88
         BNZ   ISPEDITX            NO, SKIP                    SS NOV88
         MVC   SPFE2TTR,DIRTTR     NEW, TTR                    SS NOV88
         CLC   SPFE2TTR,SPFEDTTR   SAME *                      SS NOV88
         BE    ISPEDITX            YES, SKIP                   SS NOV88
         MVC   PUTGETBF(16),ISPMALL MEMLIST ALL                SS NOV88
         MVI   SPFTPOSI,52              *                      SS NOV88
         OI    MEMFLAG2,MEMLTMCK+MEMLTMED SET TIME CHECK       SS NOV88
         OI    MEMFLAG2,MEMLALED    REPLACE CHANGED ALIAS      SS NOV88
         B     ISPEXIT                                         SS NOV88
ISPEDITX DS    0H                       *                      SS NOV88
         CLI   SPFEDUP,C'Y'        FULL UPDATE                 SS JUL87
         BNE   ISPGENP             NO, NORMAL POST PROCESSING  SS JUL87
         MVI   SPFTPOSI,52              *                      SS JUL87
         OI    MEMFLAG2,MEMLTMCK+MEMLTMED SET TIME CHECK       SS JUL87
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS JUL87
         MVC   PUTGETBF+23(8),ISPBLK8   *                      SS JUL87
         MVC   PUTGETBF+15(8),ISPLSTU7                         SS JUL87
         MVC   PUTGETBF(2),ISPCMD30     *                      SS JUL87
         B     ISPEXIT                                         SS JUL87
ISPLSTU7 DC    CL8'TODAY'               *                      SS JUL87
ISPLSTU8 DS    0H                       *                      SS JUL87
         BAS   R2,ISPTOP                RESET TO TOP           SS JUL87
ISPLSTU9 BAS   R2,ISPNXLN               *                      SS MAR89
         LTR   R15,R15                  DID WE FIND ONE        SS MAR89
         BNZ   ISPLNX2                  NOTHING TO DO          SS MAR89
         CLC   MEMLNMSV,MEMLNAME   SAME NAME                   SS MAR89
         BNE   ISPLSTU9            NO, TRY NEXT                SS MAR89
         OI    SPFTFLG2,SPFRETOP   DO CMD SCAN FROM TOP        SS MAR89
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS JUL87
         BAS   R2,ISPTBMOD         UPDATE TABLE                SS JUL87
         B     ISPLNV                   *                      SS JUL87
         SPACE 1                                              ABL FEB86
ISPDELP  DS    0H                 DELETE THIS LINE             SS NOV84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS NOV84
         BO    ISPLERR                                         SS NOV84
ISPDELL  DS    0H                 DELETE THIS LINE             SS NOV84
         CLI   MEMLDATA,C'*'            MSG                    SS JUL87
         BE    ISPDELL1                 YES, NORMAL DELETE 1   SS JUL87
         CLC   MEMLDATA,ISPBLK8         BLANK                  SS JUL87
         BE    ISPDELL1                 YES, NORMAL DELETE 1   SS JUL87
         LA    R0,4                     EXCLUDE AMOUNT CODE    SS JUL87
         LA    R15,156                  EXTENSION FUNCTION     SS JUL87
         BR    R3                       RETURN TO ROUTER       SS JUL87
ISPDELL1 BAS   R2,ISPDEL1                                      SS NOV84
         BAS   R2,ISPQUERY                                     SS MAR89
         MVC   SPFTCCRP,SPFTCRP     SAVE CUR CPR FOR CURSOR    SS MAR89
         CLC   SPFTCCRP,SPFTTOP     CURSOR WITHIN RANGE        SS MAR89
         BNL   ISPLNX2              YES                        SS MAR89
         MVC   SPFTTOP,SPFTTOP2     USE NON SCROLL VALUE       SS MAR89
         CLC   SPFTCCRP,SPFTTOP     CURSOR WITHIN RANGE        SS MAR89
         BNL   ISPLNX2              YES                        SS MAR89
         MVC   SPFTTOP,SPFTCCRP     SET SCROLL TO CURSOR       SS MAR89
         B     ISPLNX2                                         SS MAR89
*                                       *                      SS JUL87
*   SELECT COMMAND                      *                      SS JUL87
*                                       *                      SS JUL87
ISPLNCSL DS    0H                       *                      SS JUL87
         SR    R15,R15                  ZERO FOR IC            SS JUL87
         IC    R15,$TLEX(R14)           EX CODE                SS JUL87
         LA    R15,SPFSELFU(R15)        ADDR, IX SELECT TBL    SS JUL87
         MVC   MEM2OPT,0(R15)           COPY LINE COMMAND      SS JUL87
         B     ISPLNC00                 PROCESS FROM TOP       SS JUL87
*                                       *                      SS JUL87
* LKED LINE CMD                         *                      SS AUG86
*                                       *                      SS JUL87
ISPLKED  DS    0H                       *                      SS AUG86
         CLI   MEM2STAT+1,C' '     IS THIS A GOOD MEMBER       SS AUG86
         BH    ISPLNBAD            CANNOT PROCESS              SS NOV84
         OI    MEMFLAG0,MEMLRIDR   SET FOR READ IDR ONLY       SS AUG86
         MVC   MEMLXTTR,MEM2XTTR   SET TTR OF LOAD MOD         SS AUG86
         BAS   R2,MEMLISTI         UPDATE DATE                 SS AUG86
         MVC   MEM2LDAT,MEMLLDAT   COPY DATE                   SS AUG86
         MVC   MEM2LCEN,MEMLLCEN   COPY DATE CENTURY          Y2K AUG97
         MVC   MEM2LDAX,MEMLLDAX   COPY DATE EXTENDED         DRK MAR00
         MVC   MEM2OPT,ISPBLK8     CLEAR OPT                   SS AUG86
         BAS   R2,ISPLMSGS         UPDATE DATA LINE            SS AUG86
         BAS   R2,ISPTBMOD         MOD OR ADD                  SS AUG86
         B     ISPLNV                   *                      SS AUG86
*                                                              SS NOV84
*  LINE CMD MENU PANEL FOR MORE COMMANDS                       SS NOV84
*                                                              SS NOV84
ISPLMENU DS    0H                                              SS DEC87
*                                                              SS NOV84
*  LINE CMD SELECT PANEL DISPLAY SUPPORT (O LINE COMMAND)      SS NOV84
*                                                              SS NOV84
ISPLPND  DS    0H                                              SS NOV84
         CLI   MEM2STAT+1,C' '     IS THIS A GOOD MEMBER       SS AUG86
         BH    ISPLNBAD            CANNOT PROCESS              SS NOV84
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         CLI   MEMLDATA,X'00'      NULLS                       SS NOV84
         BE    ISPLPND3            YES, CONVERT TO BLANKS      SS NOV84
         CLI   MEMLDATA,C'*'       STATUS MESSAGE?             SS NOV84
         BNE   *+10                NO, BRANCH                  SS NOV84
ISPLPND3 DS    0H                                              SS NOV84
         MVC   MEMLDATA(8),ISPBLK8 YES, BLANK IT OUT           SS NOV84
         MVC   MEMLNMSV,MEMLDATA   SAVE FOR PANEL              SS NOV84
         MVC   SPFMEMB,MEMLNAME    SAVE FOR PANEL              SS NOV84
         MVI   SPFVZCMD,C' '             BLANK FIRST           SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         TM    $TLF1(R14),#E       IS THIS FOR CMD SEARCH      SS AUG86
         BZ    ISPLPND6            NO, CONTINUE                SS AUG86
         MVC   SPFBLKCM(4),MEM2OPT SAVE COMMAND                SS DEC87
         MVC   SPFVZCMD(4),MEM2OPT GET CMD NAME                SS AUG86
         OI    SPFLAG4,SPFNOIV     DO NOT DISPLAY INVALID      SS AUG86
         B     ISPLPND2            FORCE NONDISPL              SS AUG86
ISPLPND6 DS    0H                       *                      SS AUG86
         TM    $TLF2(R14),#Z       NONDISPL                    SS NOV84
         BO    ISPLPND2            YES                         SS NOV84
         MVC   SPFVZCMD(4),MEM2OPT ANY .MORE                   SS NOV84
         BAS   R2,ISPSHCMD         SET IT UP                   SS NOV84
         CLI   SPFVZCMD,C' '       ANY .MORE                   SS NOV84
         BE    ISPLPND4            NO                          SS NOV84
ISPLPND2 DS    0H                                              SS NOV84
         OI    SPFLAG4,SPFNOND     INVOKE PANEL NON-DISPLAY    SS NOV84
ISPLPND4 DS    0H                                              SS NOV84
         BAS   R2,ISPSETVI                                     SS NOV85
         L     R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC          SET CURRENT TO NEW          SS NOV84
         L     R14,SPFTTPT         RESTORE R14                 SS NOV85
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)      GET                         SS NOV84
         SLL   R15,3                 TIME 8 : INDEX TO OFFSET  SS OCT88
         AL    R15,ISP$PNA             PANEL                   SS MAR85
         MVC   SPFPSTK(8),0(R15)            NAME               SS NOV84
ISPLPND5 DS    0H                                              SS NOV84
         BAS   R2,ISPPANDI                                     SS NOV85
         NI    SPFLAG4,255-SPFNOIV RESET, IF USED              SS AUG86
         CLC   SPFZSEL(4),ISPCEND     END KEY?                 SS NOV84
         BNE   ISPLPND7               NO, CONTINUE             SS JUL87
         MVC   MEM2OPT,ISPBLK8        CLEAR OPT                SS JUL87
         BAS   R2,ISPTBMOD            PUT INTO TABLE           SS JUL87
         B     ISPLNX                 YES, DONE                SS JUL87
ISPLPND7 DS    0H                                              SS JUL87
         CLI   SPFZSEL,C'?'           INVALID                  SS AUG86
         BE    ISPLNBAD               YES                      SS AUG86
         CLC   SPFZSEL(3),ISPPGM      SELECT PGM               SS AUG86
         BE    ISPLNSEL               LINE SELECT SUPPORT      SS AUG86
         CLC   SPFZSEL(3),ISPCCMD     SELECT CMD               SS AUG86
         BE    ISPLNSEL               LINE SELECT SUPPORT      SS AUG86
         CLC   SPFZSEL(3),ISPTRAP     TRAP   CMD               SS NOV88
         BE    ISPMMTP                TRAP SUPPORT             SS NOV88
         MVC   SPFINPUT(250),SPFZSEL                           SS NOV84
         MVC   PUTGETBF(4),ISPLEN2                             SS NOV84
         L     R14,SPFTTPT          RESTORE R14                SS NOV85
         MVI   SPFTPOSI,16          USE GENERAL PURPOSE POST   SS NOV84
         OI    SPFTFLG1,SPFTLPOS                               SS NOV85
         TM    $TLF2(R14),#A        RESCAN.. MULTY FUNC PANEL? SS NOV84
         BZ    ISPCMDL              NO, NO CHANGE              SS NOV84
*  RESCAN LINE CMD FROM PANEL                                  SS NOV84
         LA    R1,SPFINPUT                                     SS NOV85
         L     R14,SPFTBPLC  TABLE FOR SEARCH                  SS NOV85
         BAS   R2,ISPVERG           CHECK CMD VERB             SS NOV85
         MVC   SPFTTPT,SPFVTPT      COPY POINTER               SS NOV85
         C     R15,ISPL8            VALID VERB?                SS NOV84
         BH    ISPLNB3              NO, ERROR                  SS NOV84
         TM    $TLF1(R14),#V        VIEW MODE OUTPUT?         ABL DEC84
         BZ    *+8                  NO, BRANCH                ABL DEC84
         OI    SPFLAG3,SPFLOGM      YES, MARK FOR LOGGING     ABL DEC84
ISPLPN2  DS    0H                                              SS NOV84
         TM    $TLF1(R14),#S        COMMAND FOR SOURCE ONLY?   SS NOV84
         BZ    ISPLPN3              NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BO    ISPLNB3              YES, ERROR                 SS NOV84
         B     ISPLPN4                                         SS NOV84
ISPLPN3  DS    0H                                              SS NOV84
         TM    $TLF1(R14),#U        COMMAND FOR LOAD ONLY?     SS NOV84
         BZ    ISPLPN4              NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BZ    ISPLNB3              NO, ERROR                  SS NOV84
ISPLPN4  DS    0H                                              SS NOV84
         TM    $TLF2(R14),#T        INTERNAL CMD OK FROM O     SS NOV85
         BO    ISPLNC5              PROCESS INTERNALLY         SS NOV85
         TM    $TLF1(R14),#V        REVIEW MODE REQUIRED?      SS NOV84
         BO    ISPLPN5              YES, USE GENERAL PURPOSE   SS NOV84
         MVI   SPFTPOSI,32          COME BACK TO PANEL POST PR SS NOV84
ISPLPN5  DS    0H                                              SS NOV84
         TM    $TLF2(R14),#P        DIFFERENT POST PROCESSOR?  SS NOV84
         BZ    ISPCMDL              NO, BRANCH                 SS NOV84
         MVC   SPFTPOSI(1),$TLEX(R14) USE IT                   SS NOV84
         B     ISPCMDL                                         SS NOV84
         SPACE 2                        *                      SS AUG86
*                                       *                      SS NOV88
*  SYSOUT TRAP CMD                      *                      SS NOV88
*                                       *                      SS NOV88
ISPMMTP  DS    0H                       *                      SS NOV88
         CLC   SPFZENVI(8),ISPMMEV   CHECK FOR 2.3             SS NOV88
         BL    ISPMMTPE                 NO ENV                 SS NOV88
         CLI   SPFTPSET,C'Y'            IS TRAP SET            SS NOV88
         BNE   ISPMMTPE                 NO, NO                 SS NOV88
         BAS   R2,ISPTRAPI              CALL TRAP PROCESSOR    SS NOV88
         CLI   SPFTCNT,C'0'             ANY OUTPUT             SS NOV88
         BE    ISPLNSER                 PROCESS RETURN CODE    SS NOV88
         LH    R1,SPFTBPDA              DATA OFFSET            SS NOV88
         LA    R1,SPWRKC(R1)            ADDRESS                SS NOV88
         LTR   R15,R15                  ZERO RC                SS NOV88
         BZ    ISPMMTPZ                 PROCESS RETURN CODE    SS NOV88
         MVC   0(8,R1),SPFMLIN1         GET FORMATTED MSG      SS NOV88
         BAS   R2,ISPTBPUT              AND UPDATE             SS NOV88
         MVI   SPFTPOSI,56         COME BACK TO ISPLNB2        SS NOV88
         B     ISPMMTPL                 GOTO LOG               SS NOV88
ISPMMTPZ DS    0H                       PROCESS RETURN CODE    SS NOV88
         MVC   0(8,R1),ISPBLK8          FIRST BLANK            SS NOV88
         MVI   0(R1),C'*'               MSG TAG                SS NOV88
         MVC   1(4,R1),SPFBLKCM         COPY NAME              SS NOV88
         MVC   5(3,R1),ISPBLK8          BLANK REST             SS NOV88
         LH    R1,SPFTBPOT         OPT                         SS NOV88
         LA    R1,SPWRKC(R1)                                   SS NOV88
         MVC   0(4,R1),ISPBLK8     CLEAR OPTION                SS NOV88
         BAS   R2,ISPTBPUT              AND UPDATE             SS NOV88
         MVI   SPFTPOSI,0          COME BACK TO ISPLNX         SS NOV88
ISPMMTPL DS    0H                       DISPLAY OUTPUT IN LOG  SS NOV88
         OI    SPFTFLG1,SPFTLPOS                               SS NOV88
         BAS   R2,ISPSETST         SET AND RETREIVE STATUS     SS NOV88
         LH    R1,SPFFUNLP+0       GET LOG LAST PANEL          SS NOV88
         LNR   R1,R1               SET FOR SWAP                SS NOV88
         BAS   R2,ISPSTKI          SWAP TO LOG PANEL           SS NOV88
         LA    R15,100             CODE.. PROCESS COMMAND      SS NOV88
         BR    R3                  RETURN TO ROUTER            SS NOV88
ISPMMTPE DS    0H                       *                      SS NOV88
         MVC   SPFZSEL(3),ISPCCMD    CHANGE TO A COMMAND       SS NOV88
         B     ISPLNSEL                 *                      SS NOV88
ISPMMEV  DC    C'ISPF 2.3'           VERSION REQUIRES TSO/E    SS NOV88
         SPACE 2                        *                      SS AUG86
ISPLNSEL DS    0H                       *                      SS AUG86
         BAS   R2,ISPSLCTI              SELECT PROCESSOR       SS AUG86
ISPLNSER DS    0H                       *                      SS NOV88
         LTR   R15,R15                  ZERO RC                SS AUG86
         BZ    ISPLNSE2                 YES                    SS AUG86
         MVC   MEMLDATA,SPFMLIN1        GET FORMATTED MSG      SS AUG86
         B     ISPLNSE3                                        SS AUG86
ISPLNSE2 DS    0H                       *                      SS AUG86
         MVC   MEMLDATA,ISPBLK8         FIRST BLANK            SS AUG86
         MVI   MEMLDATA,C'*'            MSG TAG                SS AUG86
         MVC   MEMLDATA+1(4),SPFBLKCM   COPY NAME              SS DEC87
         MVC   MEMLDATA+5(3),ISPBLK8    BLANK REST             SS DEC87
ISPLNSE3 DS    0H                       *                      SS AUG86
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS AUG86
         BAS   R2,ISPTBMOD         UPDATE TABLE                SS AUG86
         B     ISPLNX              REENTER MEMLIST DISPLAY     SS DEC87
         SPACE 2                        *                      SS AUG86
ISPLPNDP DS    0H                                              SS NOV84
         B     ISPGENP             USE GENERAL PURPOSE ONE     SS DEC87
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   STATUS LINE COMMAND                                        SS MAR85
*                                                              SS MAR85
ISPSTAT1 DS    0H                                              SS MAR85
         CLI   MEM2STAT+1,C' '     IS THIS A GOOD MEMBER       SS AUG86
         BH    ISPLNBAD            CANNOT PROCESS              SS MAR85
         MVI   SPFTPOSI,36         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$ATT   COPY CMD NAME                SS MAR85
ISPSTAT2 DS    0H                                              SS MAR85
         MVI   SPFINPUT+8,C' '                                 SS MAR85
         MVC   SPFINPUT+9(8),MEMLNAME                          SS MAR85
         MVI   SPFINPUT+17,C' '                                SS MAR85
         CLI   MEMLDATA,C'*'       MSG                         SS MAR85
         BNE   *+10                                           ABL JUN85
         MVC   MEMLDATA(8),ISPBLK8      BLANK IT OUT           SS MAR85
         MVC   SPFINPUT+18(8),MEMLDATA                         SS MAR85
         MVC   MEMLNMSV,MEMLDATA                               SS MAR85
         OI    SPFLAG3,SPFLOGM                                 SS MAR85
         B     ISPCMDL                                         SS MAR85
ISPSTAP2 DS    0H                                              SS MAR85
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS MAR85
         BO    ISPLERR                                         SS MAR85
         MVC   SPFTCCRP,SPFSTART   SAVE LOG POSITION           SS AUG86
         MVI   SPFTPOSI,40         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$HIS   COPY CMD NAME                SS MAR85
         B     ISPSTAT2                                        SS MAR85
ISPSTAP3 DS    0H                                              SS MAR85
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS MAR85
         BO    ISPLERR                                         SS MAR85
         MVI   SPFTPOSI,44         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$MAP   COPY CMD NAME                SS MAR85
         B     ISPSTAT2                                        SS MAR85
ISPSTAP4 DS    0H                                              SS NOV85
         MVC   SPFSTART,SPFTCCRP                               SS NOV85
         B     ISPGENP            PROCESS AS NORMAL            SS NOV85
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   FORMAT UT2 LINE COMMAND                                    SS MAR85
*                                                              SS MAR85
ISPUTL1  DS    0H                                              SS MAR85
         CLI   MEM2STAT+1,C' '     IS THIS A GOOD MEMBER       SS AUG86
         BH    ISPLNBAD            CANNOT PROCESS              SS MAR85
         MVI   SPFTPOSI,16         SET POST PROCESSING INDEX   SS MAR85
         MVC   PUTGETBF(4),ISPUT25  HEADER/LENGTH              SS AUG86
         MVC   SPFINPUT(8),$UT2   COPY CMD NAME                SS MAR85
         MVI   SPFINPUT+8,C' '                                 SS MAR85
         MVC   SPFINPUT+9(8),MEMLNAME  GET MEMBER NAME         SS MAR85
**       MVC   SPFINPUT+17(5),ISPUTDOT INSERT LITERAL UT.     ABL FEB86
         MVI   SPFINPUT+17,X'40'   SEPARATOR CHARACTER        ABL APR86
         TM    $TLF2(R14),#R       IS REAL COMMAND HERE        SS MAR85
         BO    ISPUTL4             YES, USE AFTER UT.          SS MAR85
         LA    R15,$TLCM(R14)      COMMAND NAME                SS JUL85
         B     ISPUTL5             USE IT                      SS MAR85
ISPUTL4  DS    0H                                              SS MAR85
         SR    R15,R15             CLEAR FOR INSERT            SS MAR85
         IC    R15,$TLEX(R14)      GET OFFSET OF REAL CMD      SS MAR85
         LA    R15,ISPREAL(R15)    GET ADDRESS                 SS JUL85
ISPUTL5  DS    0H                                              SS MAR85
         MVC   SPFINPUT+18(4),0(R15) INSERT 4 CHAR OF CMD     ABL APR86
         MVI   SPFINPUT+22,C' '      BLANK AFTER CMD           SS MAY86
ISPUTL7  DS    0H                                              SS MAR85
         CLI   MEMLDATA,C'*'       MSG                         SS MAR85
         BE    *+10                                            SS MAR85
         MVC   MEMLDATA(8),ISPBLK8      BLANK IT OUT           SS MAR85
         MVC   MEMLNMSV,MEMLDATA   SAVE FOR PANEL USE          SS MAR85
         B     ISPCMDL                                         SS MAR85
ISPUT25  DC    AL2(25),AL2(0)           BUFFER LENGTH          SS AUG86
         SPACE 2                                               SS NOV86
*                                       *                      SS NOV86
*   COPY  MEMLIST LINE TO LOG           *                      SS NOV86
*                                       *                      SS NOV86
ISPMLOG  DS    0H                       *                      SS NOV86
         BAS   R2,ISPLOGBT              SET LOG TO BOTTOM      SS NOV86
         BAS   R2,ISPMVTBL              GET FORMAT INFO        SS NOV86
         SR    R14,R14                  ZERO FOR IC            SS NOV86
         IC    R14,9(R1)                GET FORMAT LENGTH      SS NOV86
         BCTR  R14,0                    ONE LESS FOR MVC       SS NOV86
         STH   R14,SPFTSVH              SAVE FOR LATER         SS NOV86
         LA    R15,4(,R15)              ALTERNATE ROUT ENTRY   SS NOV86
ISPMLOGL DS    0H                       *                      SS NOV86
         LA    R1,WORKTBL               TEMP WORK AREA         SS NOV86
         MVI   0(R1),C' '               BLANK                  SS NOV86
         MVC   1(79,1),0(R1)               RIPPLE              SS NOV86
         BASR  R2,R15                   FORMAT ROUTINE         SS NOV86
         ST    R15,SPFTSV1              SAVE NEXT STEP ROUTINE SS NOV86
         LH    R14,SPFTSVH              GET LENGTH             SS NOV86
*              R1 STILL POINTING TO FORMATTED DATA             SS NOV86
         BAS   R2,ISPADD79              ADD TO LOG             SS NOV86
         ICM   R15,15,SPFTSV1           GET ROUTINE ADDRESS    SS NOV86
         BNZ   ISPMLOGL                 CONTINUE FORMAT        SS NOV86
         B     ISPGENP2                 DONE, CLEANUP          SS NOV86
         SPACE 2                                               SS NOV86
         DROP  R4                                              SS NOV85
         TITLE  'ISPF - ALIAS CHECK ROUTINES  '                SS AUG86
*                                       *                      SS AUG86
* ALIAS CHECK FUNCTION ENTRY 1          *                      SS AUG86
*                                       *                      SS AUG86
ISPCKALI DS    0H                                              SS SEP84
         USING ISPCKALI,R4              *                      SS AUG86
         TM    MEMFLAG2,255-MEMLNALL  ALL MEMBERS              SS AUG86
         BO    ISPCKALA             YES                        SS AUG86
         NI    MEMFLAG2,255-MEMLNTBL-MEMLNALL  RESET NEW MEML  SS AUG86
         L     R0,ISPSUBA           SUBLIST ROUTINE ADDRESS    SS AUG86
         BAS   R2,ISPSUBI           SUBROUTINE INTERFACE SUPP  SS AUG86
         OI    SPFLAG4,SPFCPOST     COMMAND POST PROCESS       SS AUG86
         MVI   SPFPOST1,84          ISPCKAL2 INDEX             SS AUG86
         MVC   PUTGETBF(21),ISPSUBL USE SUBLIST * ALIAS        SS AUG86
         B     ISPEXIT              DO COMMAND                 SS AUG86
ISPCKALA DS    0H                       *                      SS AUG86
         NI    MEMFLAG2,255-MEMLNTBL-MEMLNALL  RESET NEW MEML  SS AUG86
         L     R0,ISPALICA          ALIAS CK ROUTINE ADDR      SS AUG86
         BAS   R2,ISPSUBI           SUBROUTINE INTERFACE SUPP  SS AUG86
         LA    R15,40               ISPDISP                    SS AUG86
         BR    R3                   RETURN TO ROUTER           SS AUG86
         DROP  R4                       *                      SS AUG86
*                                       *                      SS AUG86
* ALIAS CHECK FUNCTION ENTRY 2          *                      SS AUG86
*                                       *                      SS AUG86
*  UPDATE MEMLIST FROM SUBLIST          *                      SS AUG86
*                                       *                      SS AUG86
ISPCKAL2 DS    0H                                              SS SEP84
         USING ISPCKAL2,R4              *                      SS AUG86
         L     R15,PMEMMIN          GET FIRST ENTRY            SS AUG86
ISPCKALL ST    R15,SPFTSV1          SAVE ENTRY ADDR            SS AUG86
         TM    0(R15),X'80'         ACTIVE ENTRY               SS AUG86
         BZ    ISPCKALN             NO, NEXT ENTRY             SS AUG86
         MVC   MEMLNAME,4+2(R15)    GET MEMBER NAME            SS AUG86
         BAS   R2,ISPGET            GET THIS MEMBER            SS AUG86
         LTR   R15,R15              FOUND ONE                  SS AUG86
         BZ    ISPCKALN             YES, TRY NEXT              SS AUG86
         MVC   DIRNAME(8),MEMLNAME  SET NAME                   SS AUG86
         BAS   R2,ISPBLDL           DO BLDL                    SS AUG86
         BAS   R2,MEMLISTI          GET STATS                  SS AUG86
         BAS   R2,MEMLSET           SET STATS                  SS AUG86
         BAS   R2,ISPTBADD          UPDATE STATS               SS AUG86
ISPCKALN DS    0H                   NEXT ENTRY                 SS AUG86
         L     R15,SPFTSV1          GET ENTRY                  SS AUG86
         LA    R15,0(R15)           CLEAR FLAG FOR TEST        SS AUG86
         C     R15,PMEMMAX          LAST ENTRY                 SS AUG86
         BE    ISPCKALD             YES, DONE                  SS AUG86
         ICM   R15,15,0(R15)        NEXT ENTRY                 SS AUG86
         BZ    ISPCKALD             RAN TO END OF LIST         SS AUG86
         B     ISPCKALL             LOOP FOR MORE              SS AUG86
ISPCKALD DS    0H                       *                      SS AUG86
         L     R0,ISPALICA          ALIAS CK ROUTINE ADDR      SS AUG86
         BAS   R2,ISPSUBI           SUBROUTINE INTERFACE SUPP  SS AUG86
         LA    R15,40               ISPDISP6                   SS AUG86
         BR    R3                   RETURN TO ROUTER           SS AUG86
         DROP  R4                       *                      SS AUG86
         SPACE 2                                               SS SEP84
*                                                              SS SEP84
*  ALIAS CHECKER  SUBROUTINE                                   SS SEP84
*  R3 IS RETURN REGISTER                                       SS SEP84
*                                                              SS SEP84
ISPALICK DS    0H                                              SS SEP84
         USING *,R4                                            SS MAR85
         BAS   R2,ISPTOP             START WITH TOP            SS SEP84
ISPALI2  DS    0H                                              SS SEP84
         MVC   MEM2ALIS,ISPALIS      SET CODE FOR ALIAS INDIC  SS SEP84
         LA    R0,MMLALIS            SCAN VARIABLE             SS SEP84
         BAS   R2,ISPMEMSC           DO SCAN                   SS SEP84
         C     R15,ISPL8             NONE FOUND                SS SEP84
         BER   R3                    DONE                      SS SEP84
         MVC   MEMLNMSV,MEMLNAME     SAVE NAME                 SS SEP84
         MVC   MEMLTTSV,MEM2TTR      SAVE TTR                  SS SEP84
         TM    FLAGSCC,RECFMU        IS IT A LOAD MODE         SS SEP84
         BO    ISPALI50              YES                       SS SEP84
ISPALI3  DS    0H                                              SS SEP84
         BAS   R2,ISPTOP             START AT TOP              SS SEP84
ISPALI4  DS    0H                                              SS SEP84
         MVC   MEM2TTR,MEMLTTSV      TTR FOR SCAN              SS SEP84
         LA    R0,MMLTTR             SCAN FOR                  SS SEP84
         BAS   R2,ISPMEMSC                   MATCH TTR         SS SEP84
         C     R15,ISPL8             FOUND ANY                 SS SEP84
         BE    ISPALI10              NO                        SS SEP84
         CLC   MEM2ALIS,ISPBLK8      ANOTHER ALIAS             SS SEP84
         BNE   ISPALI4               YES KEEP TRYING           SS SEP84
* GOT A MATCH                                                  SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAS   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,MEMLNMSV     ALIAS OF NAME             SS SEP84
         BAS   R2,ISPTBMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI10 DS    0H                    NO MATCH                  SS SEP84
         MVC   MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAS   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,ISPUNKN      MARK UNKNOWN              SS SEP84
         BAS   R2,ISPTBMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI50 DS    0H                                              SS SEP84
         CLC   MEM2MNAM,ISPBLK8      IS THERE A MAIN NAME      SS SEP84
         BE    ISPALI3                                         SS SEP84
         NI    MEMFLAG2,X'FF'-MEMLGMNM-MEMLGTTR  NULLIFY      ABL JAN87
         MVC   MEMLNAME,MEM2MNAM     GET THIS ON IF THERE      SS SEP84
         BAS   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         C     R15,ISPL8             IS THERE ONE              SS SEP84
         BE    ISPALI55              NO, TRY BY TTR            SS SEP84
         OI    MEMFLAG2,MEMLGMNM     FOUND MAIN NAME           SS SEP84
         CLC   MEMLTTSV,MEM2TTR      SAME TTR                  SS SEP84
         BNE   ISPALI55              NO                        SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAS   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,MEMLNMSV     ALIAS OF NAME             SS SEP84
         MVC   MEM2MTTR,MEMLNMSV     ALIAS OF NAME             SS SEP84
         BAS   R2,ISPTBMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI55 DS    0H                                              SS SEP84
         MVC   MEM2TTR,MEMLTTSV      TRY  TTR                  SS SEP84
         BAS   R2,ISPTOP             START AT TOP              SS SEP84
ISPALI56 DS    0H                                              SS SEP84
         LA    R0,MMLTTR             SCAN FOR                  SS SEP84
         BAS   R2,ISPMEMSC                   MATCH TTR         SS SEP84
         C     R15,ISPL8             FOUND ANY                 SS SEP84
         BE    ISPALI57              UNKNOWN                   SS SEP84
         CLC   MEM2ALIS,ISPBLK8      ANOTHER ALIAS             SS SEP84
         BNE   ISPALI56              YES KEEP TRYING           SS SEP84
* GOT A MATCH                                                  SS SEP84
         OI    MEMFLAG2,MEMLGTTR     FOUND TTR MATCH           SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAS   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2MTTR,MEMLNMSV     ALIAS OF NAME             SS SEP84
         B     ISPALI58                                        SS SEP84
ISPALI57 DS    0H                                              SS SEP84
         MVC   MEMLNAME,MEMLNMSV     ORIGINAL MEMBER NAME      SS SEP84
         BAS   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
ISPALI58 DS    0H                                              SS SEP84
         MVC   MEM2ALIS,ISPORP       ORPHAN                    SS SEP84
         TM    MEMFLAG2,MEMLGTTR     TTR MATCH?               ABL JAN87
         BNO   *+10                  NO, BRANCH               ABL JAN87
         MVC   MEM2ALIS,ISPBYTTR     YES, MARK =BYTTR         ABL JAN87
         TM    MEMFLAG2,MEMLGMNM     NAME MATCH?              ABL JAN87
         BNO   *+10                  NO, BRANCH               ABL JAN87
         MVC   MEM2ALIS,ISPBYNAM     YES, MARK =BYNAME        ABL JAN87
*        SR    R15,R15               CLEAR                     SS SEP84
*        IC    R15,MEMFLAG2          GET STATUS                SS SEP84
*        LA    R15,X'F1'(,R15)       ADD 1 AND MAKE PRINTABLE  SS SEP84
*        STC   R15,MEM2ALIS+7        TYPE ORPHAN               SS SEP84
         BAS   R2,ISPTBMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPBYTTR DC    CL8'=BYTTR'   TTR MATCHES ANOTHER MEMBER       ABL JAN87
ISPBYNAM DC    CL8'=BYNAME'  CLAIMED NAME MATCHES ANOTHER MEM ABL JAN87
         DROP  R4                                              SS MAR85
         TITLE 'ISPF - SUBLIST FUNCTION'                       SS AUG86
***  RESET THE SUBLIST TO THE MEMBER TABLE                    ABL APR86
ISPSUB   DS    0H                                             ABL APR86
         USING *,R4                                           ABL APR86
         LA    R15,40                   RETURN HERE IF INACT   SS MAY89
         CLI   SPFFUNST+1,C'I'          INACTIVE               SS MAY89
         BER   R3                       RETURN IF YES          SS MAY89
         LA    R14,TBTOP                    TBTOP
         L     R15,SPFMEMTA                 TABLE ADDRESS      SS MAY89
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BASR  R14,R15
         SPACE 2
ISPSU010 LA    R14,TBSKIP                   TBSKIP
         L     R15,SPFMEMTA                 TABLE ADDRESS      SS MAY89
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BASR  R14,R15
         LTR   R15,R15                      END OF DATA?
         BNZ   ISPSU900                     NO, BRANCH
         CLI   MEM2STAT+1,C' '            GOOD MEMBER          SS FEB88
         BNE   ISPSU010                   NO, SKIP             SS FEB88
         TM    SPFLAG5,SPFTAG           ONLY TAGGED MEMBERS    SS NOV88
         BZ    ISPSU020                 NO, ANY MEMBER         SS NOV88
         CLC   MEMLDATA,ISPSU090        THIS ONE TAGGED        SS NOV88
         BNE   ISPSU010                 NO, SKIP IT            SS NOV88
ISPSU020 DS    0H                       *                      SS NOV88
         SPACE 1
         TM    FLAGSEE,FMEMGRP            MEMBER GROUP DEFINE START?
         BO    ISPSU100                   YES, BRANCH
         SPACE 1
         OI    FLAGSEE,FMEMGRP            FIRST SUBLIST ELEMENT
         MVC   MMEMMAX(4),MMEMMIN         POINT TO THE FIRST ELEMENT
         XC    MMEMBERD(1+2+8+8+2),MMEMBERD  CLEAR THE MEMBER NAME
         MVC   MMEMBERD+1+2(8),MEMLNAME      MEMBER NAME
         MVC   DIRNAME(8),MEMLNAME           SAVE FOR LATER
         MVC   MMEMBERD+1+2+8+8+2(3),MEM2XTTR   TTR FIRST MEM  SS AUG86
         LA    R1,MEMLNAME+7              END OF MEMBER NAME
         LA    R0,7                       MACHINE LENGTH
ISPSU050 CLI   0(R1),X'40'                BLANK?
         BNE   ISPSU060                   NO, BRANCH
         BCTR  R1,0                       PREVIOUS CHARACTER
         BCT   R0,ISPSU050                CHECK ALL BYTES
ISPSU060 STCM  R0,B'1100',MMEMBERD+1      SAVE THE MACHINE LENGTH
         MVI   MMEMBERD,FMEMBER1          A SINGLE MEMBER NAME
         NI    MMEMMIN,FF-X'80'           MEMBER LIST IS INACTIVE
         SPACE 1
         ICM   R1,B'0111',MMEMMIN+1       FIRST ELEMENT POINTER?
         BZ    ISPSU010                   NO, DONE
         MVI   0(R1),0                    YES, INACTIVE ELEMENT
         B     ISPSU010
ISPSU090 DC    CL8'*TAG*'               *                      SS NOV88
         SPACE 2
ISPSU100 L     R1,MMEMMAX                 CURRENT END POINTER
         CLC   1(3,R1),=F'0'              ANY SLOT ENTRIES LEFT?
         BNE   ISPSU180                   YES, BRANCH
         LA    R0,36*28                   36 MEMBERS, 28 WIDE EACH
         ICM   R0,B'1000',=AL1(24)        ASSUME SPF IS INITIALIZED
         STCM  R0,B'1000',SUBLIST2        MARK FOR LATER RELEASE
         GETMAIN R,LV=(0)                 GET MORE ELEMENT STORAGE
         LR    R15,R1                     START OF TABLE
         L     R1,MMEMMAX                 CURRENT ELEMENT
         LA    R0,36-1                    NUMBER OF ELEMENTS -1
ISPSU136 LA    R15,28(,R15)               NEXT ELEMENT POINTER
         ST    R15,0(,R1)                 POINT TO THE NEXT ELEMENT
         LR    R1,R15                     NEXT ELEMENT
         BCT   R0,ISPSU136                DO 36 ELEMENTS
         XC    0(4,R1),0(R1)              CLEAR THE LAST POINTER
         SPACE 2
ISPSU180 LA    R1,MMEMMIN                 ANCHOR FOR MEMBER LIST
         CLC   MEMLNAME(8),MMEMBERD+1+2   ALREADY IN LIST?
         BE    ISPSU010                   YES, DO NOT ADD AGAIN
         SPACE 2
ISPSU190 L     R1,0(,R1)                  NEXT ELEMENT
         TM    0(R1),X'80'                ACTIVE ELEMENT?
         BNO   ISPSU200                   NO, NOT FOUND
         CLC   MEMLNAME(8),4+2(R1)        ALREADY IN LIST?
         BE    ISPSU010                   YES, DO NOT ADD AGAIN
         B     ISPSU190                   SEARCH THE ENTIRE LIST
         SPACE 2
ISPSU200 L     R1,MMEMMAX                 CURRENT ADDED ELEMENT
         L     R15,0(,R1)                 NEXT POINTER
         MVI   0(R15),0                   INACTIVE THE NEXT ELEMENT
         ST    R15,MMEMMAX                NEXT ELEMENT TO ADD
         OI    0(R1),X'80'                ACTIVE ELEMENT
         OI    MMEMMIN,X'80'              MEMBER LIST IS ACTIVE
         XC    4(2+8+8+2,R1),4(R1)        CLEAR THE MEMBER NAME
         MVC   4+2(8,R1),MEMLNAME         MEMBER NAME
         MVC   4+2+8+8+2(3,R1),MEM2TTR    ADD THIS TTR
         LA    R15,MEMLNAME+7             END OF MEMBER NAME
         LA    R0,7                       MACHINE LENGTH
ISPSU250 CLI   0(R15),X'40'               BLANK?
         BNE   ISPSU260                   NO, BRANCH
         BCTR  R15,0                      PREVIOUS CHARACTER
         BCT   R0,ISPSU250                CHECK ALL BYTES
ISPSU260 STC   R0,5(R1)                   SAVE THE MACHINE LENGTH
         MVI   4(R1),FMEMBER1             A SINGLE MEMBER NAME
         B     ISPSU010
         SPACE 3
ISPSU900 DS    0H
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET           ABL APR86
         NI    SPFLAG5,255-SPFTAG             RESET            SS NOV88
         MVC   PMEMCURR(4),PMEMMIN     RESET THE CURRENT POINTER
         MVC   LMEMBER1(2+8+8+2),MMEMBERD+1  RESET THE MEMBER NAME
         MVC   FLAGSAA(1),MMEMBERD     RESET THE MEMBER FLAG  ABL JAN87
         XC    MMEMMIN(12),PMEMMIN     INTERCHANGE
         XC    PMEMMIN(12),MMEMMIN                THE
         XC    MMEMMIN(12),PMEMMIN                   MEMBER LISTS
         MVC   MEMBERD(1+2+8+8+2),MMEMBERD    RESET THE DEFAULT NAME
         BAS   R14,DEFGROUP            ADD DEFAULT GROUP
         XI    FLAGSEE,FMEMGRP         MEMGRP USED NOW
         MVI   FLAGSAA,00              RESET THE MEMBER FLAG  ABL JAN89
         LA    R15,40                  RETURN TO ISPDISP6
         BR    R3
         DROP  R4                                             ABL APR86
