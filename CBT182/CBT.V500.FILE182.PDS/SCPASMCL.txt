  PROC 2 MEMN DSNN  DEBUG
  IF &DEBUG=DEBUG THEN CONTROL LIST CONLIST SYMLIST
  SET TITLE=ASSEMBLER PROMPTER
  SET CLR=D
  SET NONDPLY='N'
    ISPEXEC  CONTROL NONDISPL
    ISPEXEC  DISPLAY  PANEL(SCPDSN) MSG(SCPM010I)
    IF &LASTCC ¬= 0 THEN  DO          /* RETURN CODES               */
      EXIT
      END                             /* 12 - PANEL, MESSAGE, OR    */
  SET SOPT=
  SET MOPT=NOSOURCE
  REPET2: -
  SET MSG01=ENTER OBJ DSN
  SET MSG02=ENTER OBJECT DSNAME
  IF &SUBSTR(6:8,&DSNN)=PCF THEN DO
     SET &DSN1='&SUBSTR(1:13,&DSNN)OBJ'
     SET MOPT=
  END
  IF &SUBSTR(6:8,&DSNN)=RAC THEN DO
     SET MOPT=
  END
  IF &SUBSTR(6:8,&DSNN)=PAC THEN DO
     SET &DSN1='&SUBSTR(1:10,&DSNN)OBJ'
     SET MOPT=&NOPT
  END
  REPET: -
  SET TYPE=OBJ
  SET REQ1=   ENTER OUTPUT OBJ DSN
  SET REQ2=NULL,LKED
  SET ENT2=&SOPT
  SET REQ3=MAC:XA,MRC,NOSOURCE
  SET ENT3=&MOPT
  SET REQ4=
  SET ENT4=
  SET REQ5=
  SET ENT5=
  SET REQ6=
  SET ENT6=
    ISPEXEC  DISPLAY  PANEL(SCPDSN) MSG(SCPM010I)
    IF &LASTCC ¬= 0 THEN  DO          /* RETURN CODES               */
      EXIT
      END                             /* 12 - PANEL, MESSAGE, OR    */
  SET SOPT=&ENT2
  SET MOPT=&ENT3
  IF &MOPT=XA THEN SET NOPT=XA
  ELSE SET NOPT=
  SKMUST: -
  IF &MEM1 = THEN SET &MEM1=&MEMN
  SET &OBJ=&ENT1(&MEM1)
  SET SDSN=&DSNN
  IF &SOPT=LKED THEN GOTO DOLKED
  IF &MOPT=NOSOURCE THEN SET MAC3=
  ELSE SET MAC3=&DSNN
  IF &MOPT=MRC THEN SET MAC3=SYS6.MRC.MACLIB
  SET &SRC=&DSNN(&MEMN)
  SET CLR=R
    ISPEXEC  CONTROL NONDISPL
    ISPEXEC  DISPLAY  PANEL(SCPENT1)
    IF &LASTCC>0 THEN EXIT           /* RETURN CODES               */
  SET REQ1=ASMF OR ASMH
  SET ENT1=ASMH
  SET REQ2=MACLIB 1
  SET ENT2='SYS6.MAX.BLKSIZE'
  SET REQ3=MACLIB 2
  IF &MAC3= THEN SET ENT3=
  ELSE SET ENT3='&MAC3'
  IF &MOPT=XA THEN DO
     SET ENT4='SYS1.XA.AMACLIB'
     SET ENT5='SYS1.XA.AMODGEN'
  END
  ELSE DO
       SET ENT4='SYS1.AMACLIB'
       SET ENT5='SYS1.AMODGEN'
  END
  SET REQ4=MACLIB 3
  SET REQ5=MACLIB 4
  SET ENT6='SYS6.JES134.HASPSRC'
  SET REQ6=MACLIB 5
  SET ENT7='SYS1.MACLIB'
  SET REQ7=MACLIB 6
  SET ENT8='SYS2.MACLIB'
  SET REQ8=MACLIB 7
  SET ENT9='SYS6.MACLIB'
  SET REQ9=MACLIB 8
  SET REQ10=MACLIB 9
  SET REQ11=ASM OPTIONS
  SET ENT11=&STR(NOTEST NORENT)
  SET REQ12=MORE ASM OPTIONS
  SET ENT13=
  SET REQ13=&STR(PROCESS P)
  REPET22: -
    ISPEXEC  DISPLAY  PANEL(SCPENT1)
    SET &RETCC=&LASTCC
    IF &RETCC >8 THEN EXIT           /* RETURN CODES               */
    IF &RETCC =8 THEN GOTO REPET2    /* RETURN CODES               */
  REPET3: -
  IF &ENT13=P THEN SET &PRT=Y
  ELSE SET &PRT=N
  IF &ENT1=TEST THEN GOTO REPET2
  IF &ENT1=ASMH OR &ENT1=ASMP OR &ENT1=ASMF THEN
  ELSE DO
     SET MSG01=&ENT1 INVALID
     SET MSG02=ENTER CORRECT PROMPTER NAME
    ISPEXEC  DISPLAY  PANEL(SCPENT1) MSG(SCPM010E)
    IF &LASTCC ¬= 0 THEN  DO          /* RETURN CODES               */
      EXIT
      END                             /* 12 - PANEL, MESSAGE, OR    */
    GOTO REPET3
  END
  DASTAT DA(ASM.LIST) CAT
  IF &LASTCC=4 THEN DO
  ALLOC F(XQ) DA(ASM.LIST) SP(10 9) TRA -
                           RECFM(F B A) BLKSIZE(3146) LRECL(121)
  FREE F(XQ)
  END
  WRITE STARTING &ENT1
  &ENT1 '&SRC' LOAD('&OBJ') &ENT11 &ENT12 PRINT(ASM.LIST) -
               LIB(&ENT2 &ENT3 &ENT4 &ENT5 &ENT6 -
                   &ENT7 &ENT8 &ENT9 &ENT10 )  NOMACLIB
  IF &PRT=Y THEN ISPEXEC SELECT CMD(%SCPASML &SDSN &OBJ &MEM1)
  ELSE -
  IF &LASTCC<8 THEN ISPEXEC SELECT CMD(%SCPASML &SDSN &OBJ &MEM1)
  ELSE GOTO REPET2
  SET &RETCC=&LASTCC
  IF &RETCC>4 THEN EXIT
  IF &RETCC=4 THEN GOTO REPET22
  GOTO REPET2
  DOLKED: -
    ISPEXEC SELECT CMD(%SCPASML &SDSN &OBJ &MEM1)
  IF &LASTCC>4 THEN EXIT
  GOTO REPET2
