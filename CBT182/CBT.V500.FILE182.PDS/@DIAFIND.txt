         TITLE 'ISPF - FIND  FUNCTION'                         SS NOV85
* FIND SUPPORT                                                 SS MAY85
ISPFIND  DS    0H          ****    FIND  SUBCOMMAND  ****      SS MAY85
         USING *,R4                                            SS NOV85
         L     R15,SPFOPER           FIRST BLANK AFTER CMD     SS MAY85
         CLI   $TLEX(14),4           EX BYTE SET FOR RFIND     SS AUG86
         BNE   ISPFIND4              NO, CONTINUE              SS AUG86
         LA    R14,46                SCAN COUNT                SS AUG86
         BAS   R2,ISPCKBLK           FIND NON BLANK            SS AUG86
         LTR   R15,R15               ANY OPERANDS              SS AUG86
         BZ    ISPFLG03              NO STRING                 SS AUG86
         CLI   0(R15),C'F'           RFIND AND F TOGETHER      SS AUG86
         BE    ISPFIND5              YES, CHECK BLANK          SS AUG86
         CLI   0(R15),X'86'          LOW CASE F                SS AUG86
         BNE   ISPFIND4              NO, CONTINUE              SS AUG86
ISPFIND5 DS    0H                       *                      SS AUG86
         CLI   1(R15),C' '           F-BLANK                   SS AUG86
         BNE   ISPFIND4              NO, CONTINUE              SS AUG86
         LA    R15,1(R15)            SKIP F                    SS AUG86
ISPFIND4 DS    0H                                              SS AUG86
         LA    R14,46                TRY FOR 46 BYTES          SS MAY85
         LH    R1,SPFTBPFD         FIND INDEX CODE             SS NOV85
         L     R1,ISPFDPR(R1)      GET PARSE TABLE             SS NOV85
         BAS   R2,ISPPARSI           PARSE ROUTINE             SS NOV85
         C     R15,ISPL8             RETURN CODE               SS MAY85
         BH    ISPFLGX9                                        SS OCT88
         CLI   SPFPRRC,8           NO STRING                   SS MAY85
         BE    ISPFLG03                                        SS MAY85
         TM    SPFPRBI,X'03'       PREFIX OR SUFFIX            SS MAY85
         BO    ISPFLGX2            BOTH.. ERROR                SS MAY85
         TM    SPFPRBI,X'05'       WORD OR SUFFIX              SS MAY85
         BO    ISPFLGX2            BOTH.. ERROR                SS MAY85
         TM    SPFPRBI,X'06'       WORD OR PREFIX              SS MAY85
         BO    ISPFLGX2            BOTH.. ERROR                SS MAY85
         MVC   SPFTFF,SPFPRBI                                  SS NOV85
         NI    SPFTFF2,255-X'02'   CLEAR AT TOP/BOTTOM         SS NOV85
         NI    SPFTFF2,255-X'18'   CLEAR REPEAT FIND/SEC NUM   SS JAN86
         OI    SPFTFF2,X'01'       HAVE STRING                 SS NOV85
         TM    SPFPRBI2,X'80'      HAVE SECONDED NUMBER        SS NOV85
         BZ    *+8                                             SS NOV85
         OI    SPFTFF2,X'10'                                   SS NOV85
         NI    SPFPRBI2,255-X'80'  CLEAR                       SS NOV85
* SPFTFST IS SET TO START OF FIELD FOR SEARCH                  SS NOV85
* SPFTFED IS SET TO LENGTH OF FIELD                            SS NOV85
         LH    R1,SPFTBPFD         FIND INDEX CODE             SS NOV85
         LTR   R1,R1               INDEX 0                     SS NOV85
         BZ    ISPFINDS            YES, FOR SESSION LOG        SS NOV85
         L     R1,ISPFDCK(R1)      GET CHECK TABLE             SS NOV85
ISPFINDL CLI   0(R1),X'FF'         END OF TABLE                SS NOV85
         BE    ISPFLGX2            MUST BE KEY CONFLICT        SS NOV85
         CLC   0(2,R1),SPFPRBI2    COMPARE BYTES 2 AND 3       SS NOV85
         BE    ISPFINDF            GOT A MATCH                 SS NOV85
         LA    R1,06(,R1)          NEXT ENTRY                  SS NOV85
         B     ISPFINDL            LOOP                        SS NOV85
* THE FOLLOWING ARE FOR SESSION LOG                            SS NOV85
* OTHERS COULD BE SET FOR OTHER TABLES                         SS NOV85
ISPFINDS LA    R1,SPFLINE                                      SS NOV85
         ST    R1,SPFTFST          STARTING LOCATION           SS NOV85
         LA    R1,158                                          SS OCT88
         STH   R1,SPFTFED          SET LENGTH                  SS NOV85
         B     ISPFIND3                                        SS NOV85
* THIS IS END OF PARAMETERS FOR LOG FIND                       SS NOV85
ISPFINDF DS    0H                  GOOD ONE                    SS NOV85
         LH    R14,2(R1)           GET FIELD OFFSET            SS NOV85
         LA    R14,SPWRKC(R14)     CALC ADDRESS                SS NOV85
         ST    R14,SPFTFST         STARTING LOCATION           SS NOV85
         LH    R14,4(R1)           LENGTH                      SS NOV85
         STH   R14,SPFTFED         SET LENGTH                  SS NOV85
         B     ISPFIND3                                        SS NOV85
ISPFIND3 DS    0H                                              SS NOV85
         TM    SPFTFF,X'40'        OFFSET FLAG                 SS NOV85
         BZ    ISPFLG01            NO                          SS NOV85
         LH    R1,SPFTFED          LENGTH                      SS JAN86
         LA    R1,1(,R1)           BASE 1                      SS JAN86
         C     R1,SPFPRNU          CHECK RANGE                 SS JAN86
         BL    ISPFLGX1            RANGE ERROR                 SS JAN86
         TM    SPFTFF2,X'10'       ENDING RANGE ALSO           SS JAN86
         BZ    ISPFLGD1            SKIP SECOND RANGE CHECK     SS JAN86
         C     R1,SPFPRNU2         CHECK RANGE                 SS JAN86
         BL    ISPFLGX1            RANGE ERROR                 SS JAN86
         CLC   SPFPRNU,SPFPRNU2    SECOND MUST FOLLOW FIRST    SS JAN86
         BH    ISPFLGX1            RANGE ERROR                 SS JAN86
ISPFLGD1 DS    0H                                              SS JAN86
         BCTR  R1,0                BASE 0                      SS JAN86
         SH    R1,SPFPRLN          LAST POSSIBLE POSITION      SS JAN86
         BM    ISPFLGX3            LENGTH ERROR                SS JAN86
         L     R14,SPFPRNU         OFFSET                      SS JAN86
         BCTR  R14,0               REF TO ZERO                 SS JAN86
         CR    R14,R1              AFTER LAST POSSIBLE POSITIONSS JAN86
         BH    ISPFLGX3            YES, LENGTH ERROR           SS JAN86
         L     R15,SPFTFST         STARTING LOCATION           SS JAN86
         AR    R15,R14             ADD POSITION                SS JAN86
         ST    R15,SPFTFST         NEW STARTING LOCATION       SS JAN86
         TM    SPFTFF2,X'10'       ENDING RANGE                SS JAN86
         BZ    ISPFLGA1            NO                          SS JAN86
         L     R15,SPFPRNU2        GET IT                      SS JAN86
         BCTR  R15,0               REF TO ZERO                 SS JAN86
         CR    R15,R1              AFTER LAST POSSIBLE POSITIONSS JAN86
         BH    *+6                 YES                         SS JAN86
         LR    R1,R15              NO, USE THIS POSITION       SS JAN86
         SR    R1,R14              LAST MINUS FIRST            SS JAN86
         BZ    ISPFLGA1            NO LENGTH, USE ONLY FIRST   SS JAN86
         LA    R1,1(,R1)           PLUS 1                      SS JAN86
         STH   R1,SPFTFED          SET LENGTH OF SEARCH        SS JAN86
         NI    SPFTFF,255-X'40'    TURN OFF POSITION           SS NOV85
         B     ISPFLGA1                                        SS NOV85
ISPFLG01 DS    0H                                              SS NOV85
         LH    R1,SPFTFED                                      SS NOV85
         SH    R1,SPFPRLN          ALLOW FOR LENG OF STRING    SS NOV85
         BM    ISPFLGX3            TO LONG                     SS NOV85
         BZ    ISPFLGC1                                        SS NOV85
         LA    R1,1(,R1)                                       SS NOV85
         STH   R1,SPFTFED          SET LENGTH                  SS NOV85
         B     ISPFLGA1                                        SS NOV85
ISPFLGC1 DS    0H                                              SS NOV85
         OI    SPFTFF,X'40'        USE POSITION                SS NOV85
         B     ISPFLGA1                                        SS NOV85
ISPFLGX1 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         MVI   SPFMSGID+6,C'5'     RANGE ERROR                 SS NOV85
         B     ISPFLGX9            RETURN WITH ERROR           SS DEC87
ISPFLGX2 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         MVI   SPFMSGID+6,C'7'     CONFLICT ERROR              SS NOV85
         B     ISPFLGX9            RETURN WITH ERROR           SS DEC87
ISPFLGX3 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         MVI   SPFMSGID+6,C'3'     OPERAND LENGTH ERROR        SS NOV85
         B     ISPFLGX9            RETURN WITH ERROR           SS DEC87
ISPFLGX9 DS    0H                       *                      SS DEC87
         LH    R15,SPFTBPFD        FIND INDEX                  SS OCT88
         SLL   R15,1               TIMES 1 FOR OFFSET          SS OCT88
         LA    R0,ISPFLGXX(R15)         *                      SS OCT88
         LA    R15,168             ERROR PROMPT PANEL          SS DEC87
         BR    R3                  RETURN TO ROUTER            SS DEC87
ISPFLGA1 DS    0H                                              SS NOV85
         LH    R2,SPFPRLN          LENGTH OF STRING            SS NOV85
         CH    R2,ISPFLGLM         CHECK FOR LIMIT             SS OCT88
         BH    ISPFLGX3            TOO LONG                    SS OCT88
         CH    R2,ISPFZERO         CHECK FOR ZERO             DRK DEC09
         BE    ISPFLGX3            TOO SHORT, TAKE LONG ROAD  DRK DEC09
         STH   R2,SPFTFDL                                      SS NOV85
         LA    R1,SPFFDSAV                                     SS NOV85
         ST    R1,SPFTFDS          SAVE COMPARE STG ADDR       SS NOV85
         LH    R1,SPFPRLN                                      SS MAY85
         L     R15,SPFPRSR                                     SS MAY85
         MVI   SPFFDSAV,C' '       BLANK FIND VARIABLE        DRK DEC02
         MVC   SPFFDSAV+1(31),SPFFDSAV  RIPPLE                DRK DEC02
         EX    R1,ISPFLGMV         EXECUTE MVC CHAR            SS MAY85
         TM    SPFPRBI,X'80'       ASIS                        SS MAY85
         BO    ISPFLG04            DO NOT FORCE UPPER CASE     SS MAY90
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(79),SPFINPUT  RIPPLE                ABL APR86
         LH    R1,SPFTFDL          FIND STRING LENGTH          SS NOV85
         EX    R1,ISPFLGOC         EXECUTE OR CHAR             SS MAY85
         B     ISPFLG04                                        SS NOV85
ISPFLGOC OC    SPFFDSAV,SPFINPUT   FORCE UPPER CASE            SS MAY85
ISPFLGMV MVC   SPFFDSAV(0),0(R15)  SAVE COMPARE STRING         SS NOV85
ISPFLG03 DS    0H                                              SS NOV85
         OI    SPFTFF2,X'08'       REPEAT FIND                 SS NOV85
ISPFLG04 BAS   R2,ISPFNDI                                      SS NOV85
ISPFIND2 DS    0H                                              SS NOV85
         LA    R15,100              ROUTE TO TBDISPLAY         SS NOV85
         B     ISPROUT              RETURN TO ROUTER           SS NOV85
ISPFLGLM DC    H'31'                MAX STRING LENGTH          SS OCT88
ISPFZERO DC    H'-1'                ZERO STRING LENGTH        DRK DEC09
         DROP  R4                                              SS NOV85
         SPACE 2
ISPFDPR  DS    0F                                              SS NOV85
         DC    A(ISPPARFD)     0   PARSE LIST ADDRESS          SS NOV85
         DC    A(ISPPARF2)     4   MEMLIST SOURCE              SS NOV85
         DC    A(ISPPARF3)     8   MEMLIST LOAD MOD            SS NOV85
         DC    A(ISPPARF4)    12   LISTA                       SS NOV85
         DC    A(ISPPARF5)    16   LISTV                       SS NOV85
         DC    A(ISPPARF6)    20   LISTC/LISTF                 SS OCT88
         DC    A(ISPPARF7)    24   TCT                         SS OCT88
         DC    A(ISPPARF8)    28   CAX                         SS OCT88
         DC    A(ISPPARF9)    32   FILTER                      SS OCT88
         DC    A(ISPPARFA)    36   CSECT                       SS OCT88
ISPFDCK  DS    0F                                              SS NOV85
         DC    A(0)                TABLE ADDRESSES             SS NOV85
         DC    A(ISPFDCK2)                                     SS NOV85
         DC    A(ISPFDCK3)                                     SS NOV85
         DC    A(ISPFDCK4)                                     SS NOV85
         DC    A(ISPFDCK5)                                     SS NOV85
         DC    A(ISPFDCK6)                                     SS OCT88
         DC    A(ISPFDCK7)                                     SS OCT88
         DC    A(ISPFDCK8)                                     SS OCT88
         DC    A(ISPFDCK9)                                     SS OCT88
         DC    A(ISPFDCKA)                                     SS OCT88
ISPFLGXX DS    0H                PROMPT PANEL                  SS OCT88
         DC    CL8'&P.OPFTS'   0   LOG FIND PROMPT             SS OCT88
         DC    CL8'&P.MNFTM'   4   MEMLIST SOURCE              SS OCT88
         DC    CL8'&P.MNFTU'   8   MEMLIST LOAD MOD            SS OCT88
         DC    CL8'&P.LAFTA'  12   LISTA                       SS OCT88
         DC    CL8'&P.LVFTV'  16   LISTV                       SS OCT88
         DC    CL8'&P.LCFTC'  20   LISTC/LISTF                 SS OCT88
         DC    CL8'&P.TTFTT'  24   TCT                         SS OCT88
         DC    CL8'&P.CXFTX'  28   CAX                         SS OCT88
         DC    CL8'&P.FLFTF'  32   FILTER                      SS OCT88
         DC    CL8'&P.CSFTS'  36   CSECT                       SS OCT88
* PARSE PARM LIST FOR FIND                                     SS MAR85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARFD DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'158' NUMERIC     SS OCT88
         DC    X'51',X'00',X'80',X'00',F'2',F'158' NUMERIC2    SS OCT88
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'FF'                                           SS MAY85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF2 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'33',X'00',X'40',X'00',CL8'USERID'   U/USER    SS NOV85
         DC    X'21',X'00',X'40',X'00',CL8'ID'       ID        SS NOV85
         DC    X'34',X'00',X'20',X'00',CL8'CDATE'    C/CDATE   SS NOV85
         DC    X'34',X'00',X'20',X'00',CL8'CREATED'  C/CREAT  ABL APR86
         DC    X'34',X'00',X'10',X'00',CL8'MDATE'    M/MDATE   SS NOV85
         DC    X'33',X'00',X'10',X'00',CL8'MODIFIED' M/MODI   ABL APR86
         DC    X'22',X'00',X'00',X'04',CL8'MOD'      MOD      ABL APR86
         DC    X'22',X'00',X'08',X'00',CL8'SIZE'     SIZ       SS NOV85
         DC    X'22',X'00',X'04',X'00',CL8'VERSION'  VER       SS NOV85
*REDUND. DC    X'22',X'00',X'04',X'00',CL8'VERMOD'   VER       SS NOV85
         DC    X'23',X'00',X'00',X'02',CL8'INIT'     INIT     ABL APR86
         DC    X'22',X'00',X'02',X'00',CL8'TTR'      TTR       SS NOV85
         DC    X'24',X'00',X'01',X'00',CL8'ALIASOF'  ALIAS     SS NOV85
         DC    X'22',X'00',X'00',X'01',CL8'MEMBER'  REDUNDANT  SS NOV85
         DC    X'33',X'00',X'00',X'01',CL8'NAME'    REDUNDANT  SS MAY88
         DC    X'FF'                                           SS MAY88
         DS    0H                                              SS NOV85
ISPFDCK2 DC    X'0000',AL2(MEM2VMOD-SPWRKC),AL2(MEM2TTR+8-MEM2VMOD)
         DC    X'0010',AL2(MEM2VMOD-SPWRKC),AL2(MEM2TTR+8-MEM2VMOD)
*SPFDCK2 DC    X'0000',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
         DC    X'0001',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
         DC    X'4000',AL2(MEM2MID-SPWRKC),H'07'               SS NOV85
         DC    X'2000',AL2(MEM2CDAT-SPWRKC),H'07'              SS NOV85
         DC    X'1000',AL2(MEM2MDAT-SPWRKC),H'07'              SS NOV85
         DC    X'0800',AL2(MEM2CSIZ-SPWRKC),H'05'              SS NOV85
         DC    X'0400',AL2(MEM2VMOD-SPWRKC),H'07'              SS NOV85
         DC    X'0004',AL2(MEM2VMOD-SPWRKC+3),H'02'           ABL APR86
         DC    X'0002',AL2(MEM2ISIZ-SPWRKC),H'05'             ABL APR86
         DC    X'0200',AL2(MEM2TTR-SPWRKC),H'05'               SS NOV85
         DC    X'0100',AL2(MEM2ALIS-SPWRKC),H'07'              SS NOV85
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF3 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
******   DC    X'23',X'00',X'40',X'00',CL8'ATTR'     ATTR      SS NOV85
         DC    X'33',X'00',X'20',X'00',CL8'DATE'     D/DATE    SS NOV85
         DC    X'23',X'00',X'20',X'00',CL8'LENLKED'  LENL     ABL JAN87
         DC    X'21',X'00',X'20',X'00',CL8'LKED'     LK       ABL JAN89
         DC    X'23',X'00',X'10',X'00',CL8'LENGTH'   LENG      SS NOV85
         DC    X'23',X'00',X'10',X'00',CL8'SIZE'     SIZE      SS NOV85
         DC    X'24',X'00',X'08',X'00',CL8'ENTRY'    ENTRY     SS NOV85
         DC    X'23',X'00',X'00',X'80',CL8'MAIN'     MAIN      SS NOV85
         DC    X'24',X'00',X'00',X'40',CL8'MATCH'    MATCH     SS NOV85
         DC    X'22',X'00',X'00',X'20',CL8'SSI'      SSI       SS NOV85
         DC    X'22',X'00',X'02',X'00',CL8'TTR'      TTR       SS NOV85
         DC    X'24',X'00',X'01',X'00',CL8'ALIASOF'  ALIAS     SS NOV85
         DC    X'22',X'00',X'00',X'01',CL8'MEMBER'  REDUNDANT  SS NOV85
         DC    X'33',X'00',X'00',X'01',CL8'NAME'    REDUNDANT  SS MAY88
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
*                                                             DRK JUN00
*        INCLUDE YYYY/MM/DD DATE VARIABLE --------.           DRK JUN00
*                                                 |           DRK JUN00
*                                                 V           DRK JUN00
ISPFDCK3 DC    X'0000',AL2(MEMLNAME-SPWRKC),AL2(MEM2LDAX+10-MEMLNAME)
         DC    X'0010',AL2(MEMLNAME-SPWRKC),AL2(MEM2LDAX+10-MEMLNAME)
*SPFDCK3 DC    X'0000',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
         DC    X'0001',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
*        DC    X'4000',AL2(MEM2ATT1-SPWRKC),H'27'              SS NOV85
         DC    X'2000',AL2(MEM2LDAT-SPWRKC),H'07'              SS NOV85
         DC    X'1000',AL2(MEM2LENG-SPWRKC),H'05'              SS NOV85
         DC    X'0800',AL2(MEM2ENTY-SPWRKC),H'05'              SS NOV85
         DC    X'0080',AL2(MEM2MNAM-SPWRKC),H'07'              SS NOV85
         DC    X'0040',AL2(MEM2MTTR-SPWRKC),H'07'              SS NOV85
         DC    X'0020',AL2(MEM2SSI-SPWRKC),H'07'               SS NOV85
         DC    X'0200',AL2(MEM2TTR-SPWRKC),H'05'               SS NOV85
         DC    X'0100',AL2(MEM2ALIS-SPWRKC),H'07'              SS NOV85
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF4 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'44' NUMERIC     ABL APR86
         DC    X'51',X'00',X'80',X'00',F'2',F'44' NUMERIC2    ABL APR86
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'21',X'00',X'00',X'01',CL8'DDNAME'   DD        SS NOV85
         DC    X'22',X'00',X'08',X'00',CL8'DSNAME'   DSN      ABL APR86
         DC    X'22',X'00',X'40',X'00',CL8'VOLUME'   VOL       SS NOV85
         DC    X'22',X'00',X'20',X'00',CL8'MEMBER'   MEM       SS NOV85
         DC    X'21',X'00',X'10',X'00',CL8'ALLOC'    AL        SS NOV85
*REDUND. DC    X'21',X'00',X'10',X'00',CL8'ALOC'     AL        SS NOV85
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPFDCK4 DC    X'0000',AL2(SPFADDNM-SPWRKC),AL2(SPFAFLAG+8-SPFADDNM)
         DC    X'0010',AL2(SPFADDNM-SPWRKC),AL2(SPFAFLAG+8-SPFADDNM)
*SPFDCK4 DC    X'0000',AL2(SPFADDNM-SPWRKC),H'07'              SS NOV85
         DC    X'0001',AL2(SPFADDNM-SPWRKC),H'07'              SS NOV85
         DC    X'0800',AL2(SPFADSN-SPWRKC),H'43'              ABL APR86
         DC    X'4000',AL2(SPFAVOL-SPWRKC),H'05'               SS NOV85
         DC    X'2000',AL2(SPFAMEM-SPWRKC),H'07'               SS NOV85
         DC    X'1000',AL2(SPFAALLC-SPWRKC),H'03'              SS NOV85
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF5 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'31',X'00',X'00',X'01',CL8'VOLUME'   V/VO      SS NOV85
         DC    X'31',X'00',X'08',X'00',CL8'INDC'     I/IN     ABL APR86
         DC    X'22',X'00',X'40',X'00',CL8'ADDRESS'  ADD       SS NOV85
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
*                                                             DRK JUN00
*        INCLUDE NEW LISTV VARIABLES -------------.           DRK JUN00
*                                                 |           DRK JUN00
*                                                 V           DRK JUN00
ISPFDCK5 DC    X'0000',AL2(SPFVVOL-SPWRKC),AL2(SPFVVIRS+5-SPFVVOL)
         DC    X'0010',AL2(SPFVVOL-SPWRKC),AL2(SPFVVIRS+5-SPFVVOL)
         DC    X'0001',AL2(SPFVVOL-SPWRKC),H'05'               SS NOV85
         DC    X'0800',AL2(SPFVINDC-SPWRKC),H'07'             ABL APR86
         DC    X'4000',AL2(SPFVADDR-SPWRKC),H'03'             DRK MAY98
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF6 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'21',X'00',X'40',X'00',CL8'DSNAME'   DS        SS OCT88
         DC    X'31',X'00',X'20',X'00',CL8'VOLUME'   V/VO      SS OCT88
         DC    X'21',X'00',X'10',X'00',CL8'DSORG'    DS        SS OCT88
         DC    X'21',X'00',X'08',X'00',CL8'RECFM'    RE        SS OCT88
         DC    X'34',X'00',X'04',X'00',CL8'CDATE'    C/CDATE   SS OCT88
         DC    X'34',X'00',X'04',X'00',CL8'CREATED'  C/CREAT   SS OCT88
         DC    X'34',X'00',X'02',X'00',CL8'RDATE'    R/RDATE   SS OCT88
         DC    X'34',X'00',X'02',X'00',CL8'REFER'    R/REFER   SS OCT88
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS NOV85
ISPFDCK6 DC    X'0000',AL2(SPFCCAT-SPWRKC),AL2(SPFCFREE+6-SPFCCAT)
         DC    X'0010',AL2(SPFCCAT-SPWRKC),AL2(SPFCFREE+6-SPFCCAT)
         DC    X'4000',AL2(SPFCDSN-SPWRKC),H'43'               SS OCT88
         DC    X'2000',AL2(SPFCVOL-SPWRKC),H'05'               SS OCT88
         DC    X'1000',AL2(SPFCDSOR-SPWRKC),H'02'             DRK NOV08
         DC    X'0800',AL2(SPFCRF-SPWRKC),H'04'                SS OCT88
         DC    X'0400',AL2(SPFCCDAT-SPWRKC),H'09'             DRK SEP11
         DC    X'0200',AL2(SPFCRDAT-SPWRKC),H'09'             DRK SEP11
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF7 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'22',X'00',X'40',X'00',CL8'COMMAND'  COM      ABL APR86
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS NOV85
ISPFDCK7 DC    X'0000',AL2(SPFTCMDD-SPWRKC),H'249'             SS MAY90
         DC    X'0010',AL2(SPFTCMDD-SPWRKC),H'249'             SS MAY90
         DC    X'4000',AL2(SPFTCMDD-SPWRKC),H'249'             SS MAY90
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF8 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'31',X'00',X'20',X'00',CL8'DSNAME'   D/DS      SS OCT88
         DC    X'31',X'00',X'10',X'00',CL8'VOLUME'   V/VO      SS OCT88
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS NOV85
ISPFDCK8 DC    X'0000',AL2(SPFXDATA-SPWRKC),AL2(SPFXDSN+43-SPFXDATA)
         DC    X'0010',AL2(SPFXDATA-SPWRKC),AL2(SPFXDSN+43-SPFXDATA)
         DC    X'2000',AL2(SPFXDSN-SPWRKC),H'43'               SS OCT88
         DC    X'1000',AL2(SPFXVOL-SPWRKC),H'05'               SS OCT88
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARF9 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'22',X'00',X'40',X'00',CL8'PREFIX'   PRE       SS OCT88
         DC    X'23',X'00',X'20',X'00',CL8'PATTERNS' PATT      SS OCT88
         DC    X'23',X'00',X'10',X'00',CL8'PAT1'     PAT1      SS OCT88
         DC    X'23',X'00',X'08',X'00',CL8'PAT2'     PAT2      SS OCT88
         DC    X'23',X'00',X'04',X'00',CL8'PAT3'     PAT3      SS OCT88
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS NOV85
ISPFDCK9 DC    X'0000',AL2(SPFFPRFX-SPWRKC),AL2(SPFFPAT3+8-SPFFPRFX)
         DC    X'0010',AL2(SPFFPRFX-SPWRKC),AL2(SPFFPAT3+8-SPFFPRFX)
         DC    X'4000',AL2(SPFFPRFX-SPWRKC),H'17'              SS OCT88
         DC    X'2000',AL2(SPFFPAT1-SPWRKC),H'26'              SS OCT88
         DC    X'1000',AL2(SPFFPAT1-SPWRKC),H'08'              SS OCT88
         DC    X'0800',AL2(SPFFPAT2-SPWRKC),H'08'              SS OCT88
         DC    X'0400',AL2(SPFFPAT3-SPWRKC),H'08'              SS OCT88
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                    MATCHES   SS MAR85
***                                                  ========= SS MAR85
ISPPARFA DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'31',X'80',X'00',X'00',CL8'ASIS'     A/AS     DRK DEC02
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'    F/FIRST   SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS' PREV      SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'     L/LAST    SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'     W/WORD    SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'   PREF      SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'   SUFF      SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'      ANY      ABL APR86
         DC    X'21',X'00',X'40',X'00',CL8'ADDRESS'  AD        SS OCT88
         DC    X'31',X'00',X'20',X'00',CL8'NAME'     N/NA      SS OCT88
         DC    X'31',X'00',X'10',X'00',CL8'CSECT'    C/CS      SS OCT88
         DC    X'31',X'00',X'08',X'00',CL8'ENTRY'    E/EN      SS OCT88
         DC    X'22',X'00',X'04',X'00',CL8'SEGMENT'  SEG       SS OCT88
         DC    X'31',X'00',X'04',X'00',CL8'MODE'     M/MO      SS OCT88
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS NOV85
ISPFDCKA DC    X'0000',AL2(SPFSNAME-SPWRKC),AL2(SPFSSEG+4-SPFSNAME)
         DC    X'0010',AL2(SPFSNAME-SPWRKC),AL2(SPFSSEG+4-SPFSNAME)
         DC    X'4000',AL2(SPFSHADR-SPWRKC),H'05'              SS OCT88
         DC    X'2000',AL2(SPFSNAME-SPWRKC),H'07'              SS OCT88
         DC    X'1000',AL2(SPFSCSEC-SPWRKC),H'07'              SS OCT88
         DC    X'0800',AL2(SPFSENTR-SPWRKC),H'07'              SS OCT88
         DC    X'0400',AL2(SPFSSEG-SPWRKC),H'02'               SS OCT88
         DC    X'FFFF'              END OF TABLE               SS NOV85
         TITLE 'ISPF - FIND   LEVEL 1 SUBROUTINE'              SS NOV85
*  FIND STRING IN TABLE                                        SS MAY85
ISPFND   DS    0H                                              SS NOV85
         USING ISPFND,R4                                       SS MAY85
         BAS   R2,ISPQUERY                                     SS NOV85
         TM    SPFTBPF1,SPFTLOG    THIS LOG                    SS NOV85
         BZ    ISPFLG02                                        SS NOV85
         MVC   SPFTTOP,SPFSTART    SAVE START /TOP             SS MAY85
         MVC   SPFTTOP2,SPFTTOP    SAVE HERE ALSO              SS JUL87
         MVC   SPFTSIZE,SPFLAST    SAVE BOTTOM/SIZE            SS NOV85
         MVC   SPFTCRP,SPFCRP      SAVE CURRENT                SS NOV85
ISPFLG02 DS    0H                                              SS MAY85
         TM    SPFTFF2,X'08'       REPEAT FIND                 SS NOV85
         BO    ISPFLG05                                        SS NOV85
         MVC   SPFTCCRP,SPFTCRP    INIT TO CURRENT             SS NOV85
         MVC   SPFTFTOP,SPFTTOP    INIT CURRENT PLACE          SS APR86
         TM    SPFTFF,X'10'        BACKWARD SEARCH             SS MAY85
         BO    ISPFLG60                                        SS MAY85
         CLC   SPFTFTOP,ISPL1      AT TOP                      SS MAY85
         BNE   ISPFLG10                                        SS MAY85
         OI    SPFTFF2,X'02'       FROM TOP                    SS MAY85
         B     ISPFLG10                                        SS MAY85
ISPFLG05 DS    0H                                              SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(157),SPFINPUT RIPPLE                 SS OCT88
         L     R2,SPFTFDS          STING ADDRESS               SS NOV85
         CLI   0(R2),0             ANY STRING                  SS NOV85
         BE    ISPFLGEM            CANNOT DO REPEAT FIND       SS MAY85
         TM    SPFTFF2,X'01'       HAVE STRING                 SS MAY85
         BZ    ISPFLGEM            NO, NO REPEAT FIND          SS MAY85
         TM    SPFTFF,X'10'        BACKWARD SEARCH             SS MAY85
         BO    ISPFLG50            START HERE                  SS MAY85
         CLC   SPFTFTOP,SPFTTOP    STILL SAME PLACE            SS MAY85
         BNE   ISPFLG07                                        SS MAY85
         TM    SPFTFF,X'20'        FIRST KEY WORD              SS MAY85
         BO    ISPFLG15            NO, THEN USE CURRENT        SS MAY85
         TM    SPFTBPF1,SPFTLOG    THIS LOG                    SS OCT88
         BO    ISPFLG28            YES, THEN RESTART AT HERE   SS OCT88
         L     R15,SPFTTOP         SET NEW PLACE               SS MAY85
         LA    R15,1(,R15)                                     SS MAY85
         C     R15,SPFTSIZE        BOTTOM                      SS MAY85
         BH    ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         ST    R15,SPFTTOP                                     SS MAY85
         ST    R15,SPFTTOP2        SAVE HERE ALSO              SS JUL87
         B     ISPFLG30                                        SS MAY85
ISPFLG07 DS    0H                                              SS MAY85
         MVC   SPFTFTOP,SPFTTOP    INIT CURRENT PLACE          SS APR86
         NI    SPFTFF,255-X'20'    RESET FIRST                 SS MAY85
ISPFLG10 DS    0H                  PROCESS FIND                SS MAY85
         TM    SPFTFF,X'20'        FIRST KEY WORD              SS MAY85
         BZ    ISPFLG30            NO, THEN USE CURRENT        SS MAY85
ISPFLG15 DS    0H                  GO TO TOP                   SS MAY85
         NI    SPFTFF,255-X'20'    RESET FIRST                 SS MAY85
         OI    SPFTFF2,X'02'       FROM TOP                    SS MAY85
         BAS   R2,ISPTOP           START AT TOP                SS MAY85
         LA    R15,1                                           SS MAY85
         ST    R15,SPFTCRP         NOW AT TOP                  SS MAY85
         BAS   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         B     ISPFLG40                                        SS MAY85
ISPFLG28 DS    0H                                              SS OCT88
         L     R15,SPFTTOP         START SEARCH HERE           SS OCT88
         S     R15,SPFTCRP         RELATIVE POSITION           SS OCT88
         BAS   R2,ISPSKIP          POSITION SUBR               SS OCT88
         MVC   SPFTCRP,SPFTTOP     UPDATE                      SS OCT88
         L     R15,SPFTFRST        RESTART HERE                SS OCT88
         L     R14,SPFTFRSK        WITH THIS COUNT             SS OCT88
         B     ISPFLG48            JUMP RIGHT  IN              SS OCT88
ISPFLG30 DS    0H                                              SS MAY85
         L     R15,SPFTTOP         START SEARCH HERE           SS MAY85
         S     R15,SPFTCRP         RELATIVE POSITION           SS MAY85
         BAS   R2,ISPSKIP          POSITION SUBR               SS MAY85
         MVC   SPFTCRP,SPFTTOP     UPDATE                      SS NOV85
ISPFLG40 DS    0H                                              SS MAY85
         TM    SPFTFF,X'80'        ASIS                        SS MAY85
         BO    ISPFLG42            DO NOT FORCE UPPER CASE     SS MAY85
         L     R2,SPFTFST          STRING LOCATION             SS NOV85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         LH    R14,SPFTFDL         LENGTH OF STRING            SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS NOV85
         BO    *+8                 YES, SKIP SEARCH LEN        SS NOV85
         AH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
         EX    R14,ISPFLG41        EXEC OC                     SS NOV85
         B     ISPFLG42                                        SS NOV85
ISPFLG41 OC    0(0,R15),SPFINPUT   FORCE ALL UPPER CASE        SS NOV85
ISPFLG42 DS    0H                                              SS MAY85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG47            DO COMPARE HERE             SS MAY85
ISPFLG45 DS    0H                                              SS MAY85
         LH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
ISPFLG46 DS    0H                                              SS MAY85
         SR    R1,R1               FOR IC                      SS MAY85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         IC    R1,0(R2)            FIRST CHAR                  SS NOV85
         BAS   R2,ISPCLI           FIND MATCH                  SS MAY85
         LTR   R15,R15             ANY                         SS MAY85
         BZ    ISPFLG49                                        SS MAY85
ISPFLG47 DS    0H                                              SS MAY85
         LH    R1,SPFTFDL          LENGTH OF COMPARE STRING    SS NOV85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         EX    R1,ISPFLGCL                                     SS MAY85
         BE    ISPFLG80                                        SS MAY85
ISPFLG48 DS    0H                                              SS MAY85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG49            YES TRY NEXT LINE           SS MAY85
         LA    R15,1(,R15)         CONTINUE NEXT CHAR          SS MAY85
         BCT   R14,ISPFLG46        IF MORE CHAR                SS MAY85
ISPFLG49 DS    0H                                              SS MAY85
         LA    R15,1               SKIP ONE                    SS MAY85
         BAS   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         L     R15,SPFTCRP         KEEP                        SS MAY85
         LA    R15,1(,R15)              POINTER                SS MAY85
         ST    R15,SPFTCRP                      UP TO DATE     SS MAY85
         B     ISPFLG40                                        SS MAY85
ISPFLGEN DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'F'                                 SS MAY85
         TM    SPFTFF2,X'02'       WE START AT TOP             SS MAY85
         BZ    ISPFLGE2                                        SS MAY85
         MVI   SPFTFF2,0           FORCE NEW FIND              SS MAY85
         MVI   SPFMSGID+6,C'1'                                 SS MAY85
         B     ISPFLGE4                                        SS MAY85
ISPFLGE2 DS    0H                                              SS MAY85
         MVI   SPFMSGID+6,C'2'                                 SS MAY85
         OI    SPFTFF,X'20'        FORCE FIRST NEXT TIME       SS MAY85
ISPFLGE4 DS    0H                                              SS MAY85
         MVI   SPFVZCMD,C' '       BLANK                       SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS MAY85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGCL CLC   0(0,R15),0(R2)      COMPARE TEXT                SS NOV85
*SPFLGCL CLC   0(0,R15),SPFFDSAV   COMPARE TEXT                SS MAY85
ISPFLG50 DS    0H                  REPEAT FIND PREV            SS MAY85
         CLC   SPFTTOP,SPFTFTOP    STILL SAME PLACE            SS NOV85
         BNE   ISPFLG57                                        SS MAY85
         TM    SPFTFF,X'08'        LAST  KEY WORD              SS MAY85
         BO    ISPFLG65            YES, SET                    SS MAY85
         TM    SPFTBPF1,SPFTLOG    THIS LOG                    SS OCT88
         BO    ISPFLG68            YES, THEN RESTART AT HERE   SS OCT88
         B     ISPFLG69                                        SS MAY85
ISPFLG57 DS    0H                                              SS MAY85
         MVC   SPFTFTOP,SPFTTOP    INIT CURRENT PLACE          SS APR86
         NI    SPFTFF,255-X'08'    RESET LAST                  SS MAY85
         B     ISPFLG69                                        SS MAY85
ISPFLG60 DS    0H                  PROCESS FIND PREV/LAST      SS MAY85
         TM    SPFTFF,X'20'        FIRST KEYWORD               SS MAY85
         BO    ISPFLGEC            CONFLICT WITH PREV/LAST     SS MAY85
         TM    SPFTFF,X'08'        LAST  KEY WORD              SS MAY85
         BZ    ISPFLG69            NO, THEN USE CURRENT        SS MAY85
ISPFLG65 DS    0H                  GO TO TOP                   SS MAY85
         NI    SPFTFF,255-X'08'    RESET LAST                  SS MAY85
         OI    SPFTFF2,X'02'       FROM BOTTOM                 SS MAY85
         BAS   R2,ISPBOTM          START AT BOTTOM             SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGET            RAN OFF BOTTOM              SS MAY85
         L     R15,SPFTSIZE                                    SS MAY85
         ST    R15,SPFTCRP         NOW AT BOTTOM               SS MAY85
         B     ISPFLG70                                        SS MAY85
ISPFLG68 DS    0H                                              SS OCT88
         L     R15,SPFTTOP         START SEARCH HERE           SS OCT88
         S     R15,SPFTCRP         RELATIVE POSITION           SS OCT88
         BAS   R2,ISPSKIP          POSITION SUBR               SS OCT88
         MVC   SPFTCRP,SPFTTOP     UPDATE                      SS OCT88
         L     R15,SPFTFRST        RESTART HERE                SS OCT88
         L     R14,SPFTFRSK        WITH THIS COUNT             SS OCT88
         B     ISPFLG78            JUMP RIGHT  IN              SS OCT88
ISPFLG69 DS    0H                                              SS MAY85
         L     R15,SPFTTOP         START SEARCH HERE           SS MAY85
         S     R15,SPFTCRP         RELATIVE POSITION           SS MAY85
         BAS   R2,ISPSKIP          POSITION SUBR               SS MAY85
         MVC   SPFTCRP,SPFTTOP     UPDATE                      SS NOV85
         B     ISPFLG79            BACK UP ONE                 SS MAY85
ISPFLG70 DS    0H                                              SS MAY85
         L     R2,SPFTFST          STRING LOCATION             SS NOV85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         TM    SPFTFF,X'80'        ASIS                        SS MAY85
         BO    ISPFLG72            DO NOT FORCE UPPER CASE     SS MAY85
         LH    R14,SPFTFDL         LENGTH OF STRING            SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS NOV85
         BO    *+8                 YES, SKIP SEARCH LEN        SS NOV85
         AH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
         EX    R14,ISPFLG41        EXEC OC                     SS NOV85
ISPFLG72 DS    0H                                              SS MAY85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG77            DO COMPARE HERE             SS MAY85
ISPFLG75 DS    0H                                              SS MAY85
         LH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
         ALR   R15,R14             POSITION TO END OF STRING   SS MAY85
         BCTR  R15,0               ADJUST START POSITION       SS DEC85
ISPFLG76 DS    0H                                              SS MAY85
         SR    R1,R1               FOR IC                      SS MAY85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         IC    R1,0(R2)            FIRST CHAR                  SS NOV85
         BAS   R2,ISPCLIB          FIND MATCH                  SS MAY85
         LTR   R15,R15             ANY                         SS MAY85
         BZ    ISPFLG79                                        SS MAY85
ISPFLG77 DS    0H                                              SS MAY85
         LH    R1,SPFTFDL          LENGTH OF COMPARE STRING    SS NOV85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         EX    R1,ISPFLGCL                                     SS MAY85
         BE    ISPFLG80                                        SS MAY85
ISPFLG78 DS    0H                                              SS MAY85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG79            YES TRY NEXT LINE           SS MAY85
         BCTR  R15,0               CONTINUE NEXT CHAR          SS MAY85
         BCT   R14,ISPFLG76        IF MORE CHAR                SS MAY85
ISPFLG79 DS    0H                                              SS MAY85
         LA    R15,1               SKIP                        SS MAY85
         LNR   R15,R15                  -1                     SS MAY85
         BAS   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGET            RAN OFF TOP                 SS MAY85
         L     R15,SPFTCRP         KEEP                        SS NOV85
         BCTR  R15,0                    POINTER                SS MAY85
         ST    R15,SPFTCRP                      UP TO DATE     SS NOV85
         B     ISPFLG70                                        SS MAY85
ISPFLGET DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'F'                                 SS MAY85
         TM    SPFTFF2,X'02'       WE START AT BOTTOM          SS MAY85
         BZ    ISPFLGE6                                        SS MAY85
         NI    SPFTFF2,255-X'03'   FORCE NEW FIND              SS MAY85
         MVI   SPFMSGID+6,C'1'                                 SS MAY85
         B     ISPFLGE8                                        SS MAY85
ISPFLGE6 DS    0H                                              SS MAY85
         MVI   SPFMSGID+6,C'3'                                 SS MAY85
         OI    SPFTFF,X'08'        FORCE LAST NEXT TIME        SS MAY85
ISPFLGE8 DS    0H                                              SS MAY85
*        BAS   R2,ISPBOTM          RESET RECORD POINTER        SS NOV85
         MVC   SPFTTOP,SPFTFTOP    RESET START                 SS NOV85
         MVI   SPFVZCMD,C' '       BLANK                       SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS MAY85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGEM DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'2'                                 SS MAY85
         LA    R15,8                                           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGEC DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'7'                                 SS MAY85
         LA    R15,8                                           SS MAY85
         BR    R3                                              SS MAY85
ISPFLG80 DS    0H                                              SS MAY85
         TM    SPFTFF,X'07'   4+2+1 WORD, PREFIX, SUFFIX       SS MAY85
         BZ    ISPFLG89             NONE, THIS IS A MATCH      SS MAY85
         LR    R2,R15               BACK                       SS MAY85
         BCTR  R2,0                      UP ONE                SS MAY85
         CLI   0(R2),C'$'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),C'@'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),C'#'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),X'81'          LOWER CASE A               SS MAY85
         BNL   ISPFLG82             NORMAL CHAR                SS MAY85
*  MUST BE SPECIAL CHAR                                        SS MAY85
         TM    SPFTFF,X'06'         WORD OR PREFIX             SS MAY85
         BZ    ISPFLG88             SUFFIX,  NO MATCH          SS MAY85
         B     ISPFLG84             NEXT TEST                  SS MAY85
ISPFLG82 DS    0H                                              SS MAY85
         TM    SPFTFF,X'06'         WORD OR PREFIX             SS MAY85
         BNZ   ISPFLG88             NO MATCH                   SS MAY85
ISPFLG84 DS    0H                   NO MATCH                   SS MAY85
         LA    R2,1(,R15)           SKIP                       SS MAY85
         AH    R2,SPFTFDL                OVER STRING           SS MAY85
         CLI   0(R2),C'$'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),C'@'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),C'#'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),X'81'          LOWER CASE A               SS MAY85
         BNL   ISPFLG85             NORMAL CHAR                SS MAY85
*  MUST BE SPECIAL CHAR                                        SS MAY85
         TM    SPFTFF,X'05'         WORD OR SUFFIX             SS MAY85
         BZ    ISPFLG88             PREFIX,  NO MATCH          SS MAY85
         B     ISPFLG89             GOOD MATCH                 SS MAY85
ISPFLG85 DS    0H                                              SS MAY85
         TM    SPFTFF,X'05'         WORD OR SUFFIX             SS MAY85
         BZ    ISPFLG89             PREFIX, GOOD MATCH         SS MAY85
ISPFLG88 DS    0H                   NO MATCH                   SS MAY85
         TM    SPFTFF,X'10'         BACKWARD SEARCH            SS MAY85
         BO    ISPFLG78             CONTINUE HERE              SS MAY85
         B     ISPFLG48             ELSE CONTINUE HERE         SS MAY85
ISPFLG89 DS    0H                                              SS MAY85
         NI    SPFTFF2,255-X'02'   NO LONGER AT TOP/BOTTOM     SS MAY85
         ST    R15,SPFTFRST        FIND RESTART ADDR IF NEEDED SS OCT88
         ST    R14,SPFTFRSK        WITH THIS COUNT             SS OCT88
ISPFLG90 DS    0H                                              SS MAY85
         MVC   SPFTFTOP,SPFTCRP    SAVE FOUND LOCATION         SS NOV85
         MVC   SPFTTOP,SPFTCRP     DISPLAY FROM NEW LOCATION   SS NOV85
         TM    SPFTBPF1,SPFTLOG    THIS LOG                    SS NOV85
         BZ    ISPFLG99            NO, SKIP CURSOR POSITIONING SS OCT88
         MVC   SPFSTART,SPFTCRP    UPDATE START                SS NOV85
         MVC   SPFCRP,SPFTCRP      UPDATE                      SS NOV85
         MVC   SPFTCCRP,SPFTCRP    SET FOR CURSOR POSITIONING  SS NOV88
         LA    R14,SPFLIN2         IS IT                       SS OCT88
         CR    R15,R14                  IN SECOND PART         SS OCT88
         BNL   ISPFLG95            YES  *                      SS OCT88
         TM    SPFTBPF3,SPFTBTYL+SPFTBTYD  CAN WE USE THIS PAN SS OCT88
         BNZ   ISPFLG91                 YES                    SS OCT88
         LH    R1,SPFTBPIP              NO, SWAP PANELS LEFT   SS OCT88
         LNR   R1,R1                    FOR SWAP CODE          SS OCT88
         BAS   R2,ISPSTKI               DO IT                  SS OCT88
         BAS   R2,ISPSETST              UPDATE STATUS          SS OCT88
         L     R15,SPFTFRST             GET RESTART ADDRESS    SS OCT88
ISPFLG91 DS    0H                       *                      SS OCT88
         LA    R14,SPFLIN1-1       1-79                        SS OCT88
         SR    R15,R14             CALC POSITION               SS OCT88
         ST    R15,SPFCUOFF             AND SET                SS OCT88
         OI    SPFTFLG1,SPFTYOFF        *                      SS OCT88
         CLI   SPFPANEL+6,C'W'     WIDE PANEL?                DRK JUL04
         BE    *+4+6+4             YES                        DRK JUL04
         MVC   SPFCURSR,VPDSLN1    NO, NAME FOR CURSOR         SS OCT88
         B     ISPFLG99                                       DRK JUL04
         MVC   SPFCURSR,VPDSLN1W   NAME FOR CURSOR (WIDE)     DRK JUL04
         B     ISPFLG99            DONE                        SS OCT88
ISPFLG95 DS    0H                       *                      SS OCT88
         TM    SPFTBPF3,SPFTBTYR+SPFTBTYD  CAN WE USE THIS PAN SS OCT88
         BNZ   ISPFLG96                 YES                    SS OCT88
         LH    R1,SPFTBPIP              NO, SWAP PANELS LEFT   SS OCT88
         LNR   R1,R1                    FOR SWAP CODE          SS OCT88
         BAS   R2,ISPSTKI               DO IT                  SS OCT88
         BAS   R2,ISPSETST              UPDATE STATUS          SS OCT88
         L     R15,SPFTFRST             GET RESTART ADDRESS    SS OCT88
ISPFLG96 DS    0H                       *                      SS OCT88
         LA    R14,SPFLIN2-1       80-158                      SS OCT88
         SR    R15,R14             CALC OFFSET                 SS OCT88
         CLI   SPFPANEL+6,C'W'     WIDE PANEL?                DRK JUL04
         BNE   *+4+4               NO                         DRK JUL04
         LA    R15,79(R15)         YES, ADJUST OFFSET         DRK JUL04
         ST    R15,SPFCUOFF        SET OFFSET                  SS OCT88
         OI    SPFTFLG1,SPFTYOFF        *                      SS OCT88
         CLI   SPFPANEL+6,C'W'     WIDE PANEL?                DRK JUL04
         BE    *+4+6+4             YES                        DRK JUL04
         MVC   SPFCURSR,VPDSLN2    NO, NAME FOR CURSOR         SS OCT88
         B     ISPFLG99                                       DRK JUL04
         MVC   SPFCURSR,VPDSLN1W   NAME FOR CURSOR (WIDE)     DRK JUL04
ISPFLG99 DS    0H                                              SS OCT88
         SR    R15,R15             GOOD COMMAND                SS MAY85
         BR    R3                                              SS MAY85
         DROP  R4                                             DRK NOV98
         SPACE 2                                              ABL JUN85
         TITLE 'ISPF - SORT  FUNCTION'                         SS NOV85
* SORT SUPPORT                                                 SS MAY85
ISPSORT  DS    0H          ****    SORT  SUBCOMMAND  ****      SS MAY85
         USING *,R4                                            SS NOV85
         LTR   R0,R0               FUNCTION ENTRY              SS OCT88
         BNZ   ISPSORTN            NEW SORT                    SS OCT88
         TM    SPFTFLG3,SPFTSORT   SORTED TABLE                SS AUG86
         BZ    ISPSORIV            NO, INVALID MSG             SS AUG86
         L     R15,SPFOPER           FIRST BLANK AFTER CMD     SS MAY85
         LA    R14,46                TRY FOR 46 BYTES          SS MAY85
         LH    R1,SPFTBPFD         SORT INDEX CODE             SS NOV85
         L     R1,ISPSRPR(R1)      GET PARSE TABLE             SS NOV85
         LTR   R1,R1               SORT VALID FOR THIS TABLE   SS AUG86
         BZ    ISPSORIV            NO   *                      SS AUG86
         BAS   R2,ISPPARSI           PARSE ROUTINE             SS NOV85
         C     R15,ISPL8             RETURN CODE               SS MAY85
         BH    ISPSORX3            ERROR                       SS DEC87
* SPFTFST IS SET TO START OF FIELD FOR SEARCH                  SS NOV85
* SPFTFED IS SET TO LENGTH OF FIELD                            SS NOV85
         LH    R1,SPFTBPFD         SORT INDEX CODE             SS NOV85
         L     R1,ISPSRCK(R1)      GET CHECK TABLE             SS NOV85
         LTR   R1,R1               GOOD ADDR                   SS AUG86
         BZ    ISPSORIV            NO, INVALID MSG             SS AUG86
ISPSORTL CLI   0(R1),X'FF'         END OF TABLE                SS NOV85
         BE    ISPSORX2            MUST BE KEY CONFLICT        SS NOV85
         CLC   0(2,R1),SPFPRBI2    COMPARE BYTES 2 AND 3       SS NOV85
         BE    ISPSORTF            GOT A MATCH                 SS NOV85
         LA    R1,06(,R1)          NEXT ENTRY                  SS NOV85
         B     ISPSORTL            LOOP                        SS NOV85
ISPSORTF DS    0H                  GOOD ONE                    SS NOV85
         LH    R14,2(R1)           GET LIST  OFFSET            SS NOV85
         LA    R14,ISPSORT(R14)    CALC ADDRESS OF LIST        SS NOV85
         ST    R14,SPFTSORA        SAVE ADDRESS OF SORT LIST   SS AUG86
         NI    SPFTFLG3,255-SPFTSDEF  ASSUME NOT DEFAULT       SS AUG86
         CLI   5(R1),0             DEFAULT SORT                SS OCT88
         BE    *+8                 NO, DO SORT NOW             SS OCT88
         OI    SPFTFLG3,SPFTSDEF   YES, FLAG AS DEFAULT        SS AUG86
         BAS   R2,ISPTSORT         DO SORT                     SS AUG86
         B     ISPSREX2            DONE                        SS AUG86
ISPSORX2 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         MVI   SPFMSGID+6,C'7'     CONFLICT ERROR              SS NOV85
ISPSORX3 DS    0H                  RETURN WITH ERROR           SS DEC87
         LH    R15,SPFTBPFD        FIND INDEX                  SS OCT88
         SLL   R15,1               TIMES 1 FOR OFFSET          SS OCT88
         LA    R0,ISPSORXX(R15)         *                      SS OCT88
         LA    R15,168                  *                      SS DEC87
         B     ISPROUT                  *                      SS DEC87
ISPSREX2 DS    0H                                              SS NOV85
         LA    R15,100              ROUTE TO TBDISPLAY         SS NOV85
         B     ISPROUT              RETURN TO ROUTER           SS NOV85
ISPSORIV DS    0H                                              SS NOV85
         LA    R15,28               ROUTE TO ISPINVAL          SS NOV85
         B     ISPROUT              RETURN TO ROUTER           SS NOV85
* SET SORT DEFAULT FOR NEW SORT         *                      SS OCT88
ISPSORTN DS    0H                  NEW SORT                    SS OCT88
         XC    SPFPRBI2(2),SPFPRBI2 ZERO FOR DEFAULT           SS OCT88
         LR    R1,R0               GET INDEX                   SS OCT88
         LA    R1,SPFSRTDF(R1)     GET ADDRESS IF ENTRY        SS OCT88
         CLI   0(R1),C'*'          IS IT SET                   SS OCT88
         BNE   *+10                     *                      SS OCT88
         MVC   SPFPRBI2(2),1(R1)   COPY IT                     SS OCT88
* SPFTFST IS SET TO START OF FIELD FOR SEARCH                  SS OCT88
* SPFTFED IS SET TO LENGTH OF FIELD                            SS OCT88
         LH    R1,SPFTBPFD         SORT INDEX CODE             SS OCT88
         L     R1,ISPSRCK(R1)      GET CHECK TABLE             SS OCT88
         LTR   R1,R1               GOOD ADDR                   SS OCT88
         BZ    ISPSORT8            NO, INVALID MSG             SS OCT88
ISPSORT3 CLI   0(R1),X'FF'         END OF TABLE                SS OCT88
         BE    ISPSORT8            MUST BE KEY CONFLICT        SS OCT88
         CLC   0(2,R1),SPFPRBI2    COMPARE BYTES 2 AND 3       SS OCT88
         BE    ISPSORT4            GOT A MATCH                 SS OCT88
         LA    R1,06(,R1)          NEXT ENTRY                  SS OCT88
         B     ISPSORT3            LOOP                        SS OCT88
ISPSORT4 DS    0H                  GOOD ONE                    SS OCT88
         LH    R14,2(R1)           GET LIST  OFFSET            SS OCT88
         LA    R14,ISPSORT(R14)    CALC ADDRESS OF LIST        SS OCT88
         ST    R14,SPFTSORA        SAVE ADDRESS OF SORT LIST   SS OCT88
         NI    SPFTFLG3,255-SPFTSDEF  ASSUME NOT DEFAULT       SS OCT88
         CLI   5(R1),0             DEFAULT SORT                SS OCT88
         BE    *+8                 NO, DO SORT NOW             SS OCT88
         OI    SPFTFLG3,SPFTSDEF   YES, FLAG AS DEFAULT        SS OCT88
         BAS   R2,ISPTSORT         DO SORT                     SS OCT88
         OI    SPFTFLG3,SPFTSORT   NOW A SORTED TABLE          SS OCT88
ISPSORT0 DS    0H                       *                      SS OCT88
         SR    R15,R15                  *                      SS OCT88
         BR    R3                       *                      SS OCT88
ISPSORT8 DS    0H                       *                      SS OCT88
         LA    R15,8                    *                      SS OCT88
         BR    R3                       *                      SS OCT88
         DROP  R4                                              SS NOV85
         SPACE 2
ISPSORTV DC    A(VPDFSRT) LIST OF DEFAULT VARIABLES            SS OCT88
ISPSRPR  DS    0F                                              SS NOV85
         DC    A(0)            0   PARSE LIST ADDRESS          SS NOV85
         DC    A(ISPPARS2)     4   MEMLIST SOURCE              SS NOV85
         DC    A(ISPPARS3)     8   MEMLIST LOAD MOD            SS NOV85
         DC    A(0)           12   LISTA                       SS NOV85
         DC    A(ISPPARS5)    16   LISTV                       SS NOV85
         DC    A(ISPPARS6)    20   LISTC/LISTF                 SS NOV85
         DC    A(0)           24   TCT                         SS NOV85
         DC    A(ISPPARS7)    28   CAX                         SS NOV85
         DC    A(0)           32   FILTER                      SS NOV85
         DC    A(ISPPARS8)    38   CSECTS                      SS NOV85
ISPSRCK  DS    0F                                              SS NOV85
         DC    A(0)                TABLE ADDRESSES             SS NOV85
         DC    A(ISPSRCK2)                                     SS NOV85
         DC    A(ISPSRCK3)                                     SS NOV85
         DC    A(0)                                            SS NOV85
         DC    A(ISPSRCK5)                                     SS NOV85
         DC    A(ISPSRCK6)    20   LISTC/LISTF                 SS NOV85
         DC    A(0)           24   TCT                         SS NOV85
         DC    A(ISPSRCK7)    28   CAX                         SS NOV85
         DC    A(0)           32   FILTER                      SS NOV85
         DC    A(ISPSRCK8)    38   CSECTS                      SS NOV85
ISPSORXX DS    0H                PROMPT PANEL                  SS OCT88
         DC    CL8' '          0                               SS OCT88
         DC    CL8'&P.MNSOM'   4   MEMLIST SOURCE PROMPT       SS OCT88
         DC    CL8'&P.MNSOU'   8   MEMLIST LOAD MOD            SS OCT88
         DC    CL8' '         12                               SS OCT88
         DC    CL8'&P.LVSOV'  16   LISTV                       SS OCT88
         DC    CL8'&P.LCSOC'  20   LISTC/LISTF                 SS OCT88
         DC    CL8' '         24                               SS OCT88
         DC    CL8'&P.CXSOX'  28   CAX                         SS OCT88
         DC    CL8' '         32                               SS OCT88
         DC    CL8'&P.CSSOS'  36   CSECT                       SS OCT88
* TABLE OF LOCATE INFORMATION AS RELATE TO SORT OPTIONS        SS OCT88
ISPSORTZ DC    XL8'00'          NULL ENTRY                  0  SS OCT88
         DC    AL2(MEMLNAME-SPWRKC),AL1(7),AL1(0)           1  SS OCT88
         DC    AL2(SPFVVOL-SPWRKC),AL1(5),AL1(0)            2  SS OCT88
* PARSE PARM LIST FOR SORT                                     SS MAR85
         DS    0F                                    MATCHES   SS MAR85
***   MEMLIST SOURCE                                 ========= SS MAR85
ISPPARS2 DC    X'31',X'00',X'80',X'00',CL8'ASCEND'   A/AS     DRK NOV02
*SPPARS2 DC    X'21',X'00',X'80',X'00',CL8'ASCEND'   AS        SS AUG86
         DC    X'31',X'00',X'00',X'01',CL8'DESCEND'  D/DE     DRK NOV02
*        DC    X'21',X'00',X'00',X'01',CL8'DESCEND'  DE        SS AUG86
         DC    X'31',X'00',X'40',X'00',CL8'ID'       I/ID     ABL JAN87
         DC    X'34',X'00',X'20',X'00',CL8'CDATE'    C/CDATE   SS NOV85
         DC    X'34',X'00',X'20',X'00',CL8'CREATED'  C/CREAT  ABL APR86
         DC    X'34',X'00',X'10',X'00',CL8'MDATE'    M/MDATE   SS NOV85
         DC    X'32',X'00',X'10',X'00',CL8'MODIFIED' M/MOD    ABL APR86
         DC    X'22',X'00',X'10',X'00',CL8'CHANGED'  CHA      DRK MAR02
         DC    X'32',X'00',X'10',X'00',CL8'LAST'     L/LAS     SS MAY88
         DC    X'32',X'00',X'08',X'00',CL8'SIZE'     S/SIZ    ABL JAN87
         DC    X'32',X'00',X'04',X'00',CL8'VERMOD'   V/VER    ABL JAN87
*REDUND. DC    X'32',X'00',X'04',X'00',CL8'VERSION'  V/VER    ABL JAN87
         DC    X'32',X'00',X'02',X'00',CL8'TTR'      T/TTR    ABL JAN87
         DC    X'22',X'00',X'00',X'00',CL8'MEMBER'  REDUNDANT  SS NOV85
         DC    X'33',X'00',X'00',X'00',CL8'NAME'               SS MAY88
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPSRCK2 DC    X'0000',AL2(ISPSRL01-ISPSORT),H'1'  MEM         SS AUG86
         DC    X'8000',AL2(ISPSRL01-ISPSORT),H'1'  MEM         SS AUG86
         DC    X'0001',AL2(ISPSRL02-ISPSORT),H'0'  MEM DES     SS AUG86
         DC    X'8200',AL2(ISPSRL03-ISPSORT),H'0'  TTR         SS AUG86
         DC    X'0200',AL2(ISPSRL03-ISPSORT),H'0'  TTR         SS AUG86
         DC    X'0201',AL2(ISPSRL04-ISPSORT),H'0'  TTR DES     SS AUG86
         DC    X'C000',AL2(ISPSRL05-ISPSORT),H'0'  ID          SS AUG86
         DC    X'4000',AL2(ISPSRL05-ISPSORT),H'0'  ID          SS AUG86
         DC    X'4001',AL2(ISPSRL06-ISPSORT),H'0'  ID  DES     SS AUG86
         DC    X'D000',AL2(ISPSRL07-ISPSORT),H'0'  ID MDATE A  SS DEC87
         DC    X'5000',AL2(ISPSRL08-ISPSORT),H'0'  ID MDATE    SS DEC87
         DC    X'5001',AL2(ISPSRL08-ISPSORT),H'0'  ID MDATE D  SS AUG86
         DC    X'9000',AL2(ISPSRL09-ISPSORT),H'0'  MDATE AS    SS DEC87
         DC    X'1000',AL2(ISPSRL10-ISPSORT),H'0'  MDATE       SS DEC87
         DC    X'1001',AL2(ISPSRL10-ISPSORT),H'0'  MDATE DES   SS AUG86
         DC    X'C800',AL2(ISPSRL11-ISPSORT),H'0'  ID SIZE A   SS DEC87
         DC    X'4800',AL2(ISPSRL12-ISPSORT),H'0'  ID SIZE     SS DEC87
         DC    X'4801',AL2(ISPSRL12-ISPSORT),H'0'  ID SIZE D   SS AUG86
         DC    X'E000',AL2(ISPSRL15-ISPSORT),H'0'  ID CDATE A  SS DEC87
         DC    X'6000',AL2(ISPSRL16-ISPSORT),H'0'  ID CDATE    SS DEC87
         DC    X'6001',AL2(ISPSRL16-ISPSORT),H'0'  ID CDATE D  SS AUG86
         DC    X'C400',AL2(ISPSRL19-ISPSORT),H'0'  ID VRMD A   SS DEC87
         DC    X'4400',AL2(ISPSRL20-ISPSORT),H'0'  ID VERMOD   SS DEC87
         DC    X'4401',AL2(ISPSRL20-ISPSORT),H'0'  ID VRMD D   SS AUG86
         DC    X'8400',AL2(ISPSRL21-ISPSORT),H'0'  VERMOD AS   SS DEC87
         DC    X'0400',AL2(ISPSRL22-ISPSORT),H'0'  VERMOD      SS DEC87
         DC    X'0401',AL2(ISPSRL22-ISPSORT),H'0'  VERMOD DES  SS AUG86
         DC    X'8800',AL2(ISPSRL23-ISPSORT),H'0'  SIZE AS     SS DEC87
         DC    X'0800',AL2(ISPSRL24-ISPSORT),H'0'  SIZE        SS DEC87
         DC    X'0801',AL2(ISPSRL24-ISPSORT),H'0'  SIZE DES    SS AUG86
         DC    X'A000',AL2(ISPSRL25-ISPSORT),H'0'  CDATE AS    SS DEC87
         DC    X'2000',AL2(ISPSRL26-ISPSORT),H'0'  CDATE       SS DEC87
         DC    X'2001',AL2(ISPSRL26-ISPSORT),H'0'  CDATE DES   SS AUG86
         DC    X'FFFF'              END OF TABLE               SS NOV85
ISPSORTM DS    0C                       *                      SS AUG86
ISPSRL01 DC    C'(MEMLNAME,C,A)'                               SS AUG86
ISPSRL02 DC    C'(MEMLNAME,C,D)'                               SS AUG86
ISPSORTT DS    0C                       *                      SS AUG86
ISPSRL03 DC    C'(MEMLXTTR,C,A,MEMLALIS,C,A,MEMLNAME,C,A)'     SS AUG86
ISPSRL04 DC    C'(MEMLXTTR,C,D,MEMLALIS,C,A,MEMLNAME,C,A)'     SS AUG86
ISPSRL05 DC    C'(MEMLMID,C,A,MEMLNAME,C,A)'                   SS AUG86
ISPSRL06 DC    C'(MEMLMID,C,D,MEMLNAME,C,A)'                   SS AUG86
ISPSRL07 DC    C'(MEMLMID,C,A,MEMLMCEN,C,A,MEMLMDAT,C,A,'     Y2K AUG97
         DC    C'MEMLMTIM,C,A,MEMLNAME,C,A)'                  Y2K AUG97
ISPSRL08 DC    C'(MEMLMID,C,A,MEMLMCEN,C,D,MEMLMDAT,C,D,'     Y2K AUG97
         DC    C'MEMLMTIM,C,D,MEMLNAME,C,A)'                  Y2K AUG97
ISPSRL09 DC    C'(MEMLMCEN,C,A,MEMLMDAT,C,A,'                 Y2K AUG97
         DC    C'MEMLMTIM,C,A,MEMLNAME,C,A)'                  Y2K AUG97
ISPSRL10 DC    C'(MEMLMCEN,C,D,MEMLMDAT,C,D,'                 Y2K AUG97
         DC    C'MEMLMTIM,C,D,MEMLNAME,C,A)'                  Y2K AUG97
ISPSRL11 DC    C'(MEMLMID,C,A,MEMLCSIS,C,A,MEMLCSIZ,C,A,'     DRK AUG09
         DC    C'MEMLNAME,C,A)'
ISPSRL12 DC    C'(MEMLMID,C,A,MEMLCSIS,C,D,MEMLCSIZ,C,D,'     DRK AUG09
         DC    C'MEMLNAME,C,A)'
ISPSRL15 DC    C'(MEMLMID,C,A,MEMLCCEN,C,A,MEMLCDAT,C,A,'     Y2K AUG97
         DC    C'MEMLNAME,C,A)'                               Y2K AUG97
ISPSRL16 DC    C'(MEMLMID,C,A,MEMLCCEN,C,D,MEMLCDAT,C,D,'     Y2K AUG97
         DC    C'MEMLNAME,C,A)'                               Y2K AUG97
ISPSRL19 DC    C'(MEMLMID,C,A,MEMLVMOD,C,A,MEMLNAME,C,A)'
ISPSRL20 DC    C'(MEMLMID,C,A,MEMLVMOD,C,D,MEMLNAME,C,A)'
ISPSRL21 DC    C'(MEMLVMOD,C,A,MEMLNAME,C,A)'
ISPSRL22 DC    C'(MEMLVMOD,C,D,MEMLNAME,C,A)'
ISPSRL23 DC    C'(MEMLCSIS,C,A,MEMLCSIZ,C,A,MEMLNAME,C,A)'    DRK AUG09
ISPSRL24 DC    C'(MEMLCSIS,C,D,MEMLCSIZ,C,D,MEMLNAME,C,A)'    DRK AUG09
ISPSRL25 DC    C'(MEMLCCEN,C,A,MEMLCDAT,C,A,MEMLNAME,C,A)'    Y2K AUG97
ISPSRL26 DC    C'(MEMLCCEN,C,D,MEMLCDAT,C,D,MEMLNAME,C,A)'    Y2K AUG97
         DS    0F                                    MATCHES   SS MAR85
***   MEMLIST LOAD MOD                               ========= SS MAR85
ISPPARS3 DC    X'31',X'00',X'80',X'00',CL8'ASCEND'   A/AS     DRK DEC06
*SPPARS3 DC    X'21',X'00',X'80',X'00',CL8'ASCEND'   AS        SS AUG86
         DC    X'31',X'00',X'00',X'01',CL8'DESCEND'  D/DE     DRK DEC06
*        DC    X'21',X'00',X'00',X'01',CL8'DESCEND'  DE        SS AUG86
         DC    X'23',X'00',X'40',X'00',CL8'MAIN'     MAIN     DRK JUL07
         DC    X'22',X'00',X'20',X'00',CL8'DATE'     DAT      DRK DEC06
*        DC    X'32',X'00',X'20',X'00',CL8'DATE'     D/DAT     SS NOV85
         DC    X'23',X'00',X'20',X'00',CL8'LENLKED'  LENL     ABL JAN87
         DC    X'21',X'00',X'20',X'00',CL8'LKED'     LK       ABL JAN89
         DC    X'23',X'00',X'10',X'00',CL8'LENGTH'   LENG      SS NOV85
         DC    X'32',X'00',X'10',X'00',CL8'SIZE'     S/SIZ    ABL JAN87
         DC    X'23',X'00',X'08',X'00',CL8'MODE'     MODE     DRK JUL07
         DC    X'23',X'00',X'04',X'00',CL8'ATTR'     ATTR     DRK JUL07
         DC    X'32',X'00',X'02',X'00',CL8'TTR'      T/TTR    ABL JAN87
         DC    X'23',X'00',X'01',X'00',CL8'AUTH'     AUTH     DRK JUL07
         DC    X'21',X'00',X'01',X'00',CL8'ACODE'    AC/ACODE DRK JUL07
         DC    X'32',X'00',X'00',X'00',CL8'MEMBER'  REDUNDANT  SS NOV85
         DC    X'33',X'00',X'00',X'00',CL8'NAME'    REDUNDANT  SS MAY88
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPSRCK3 DC    X'0000',AL2(ISPSRL01-ISPSORT),H'1'  MEM         SS AUG86
         DC    X'8000',AL2(ISPSRL01-ISPSORT),H'1'  MEM         SS AUG86
         DC    X'0001',AL2(ISPSRL02-ISPSORT),H'0'  MEM    DESC SS AUG86
         DC    X'8200',AL2(ISPSRL03-ISPSORT),H'0'  TTR         SS AUG86
         DC    X'0200',AL2(ISPSRL03-ISPSORT),H'0'  TTR         SS AUG86
         DC    X'0201',AL2(ISPSRL04-ISPSORT),H'0'  TTR    DESC SS AUG86
         DC    X'9000',AL2(ISPSRL35-ISPSORT),H'0'  LENG   AS   SS DEC87
         DC    X'1000',AL2(ISPSRL36-ISPSORT),H'0'  LENG        SS DEC87
         DC    X'1001',AL2(ISPSRL36-ISPSORT),H'0'  LENG   DESC SS AUG86
         DC    X'A000',AL2(ISPSRL37-ISPSORT),H'0'  LKEDDATE AS SS DEC87
         DC    X'2000',AL2(ISPSRL38-ISPSORT),H'0'  LKEDDATE    SS DEC87
         DC    X'2001',AL2(ISPSRL38-ISPSORT),H'0'  LK     DESC SS AUG86
         DC    X'B000',AL2(ISPSRL39-ISPSORT),H'0'  LK LEN AS   SS DEC87
         DC    X'3000',AL2(ISPSRL40-ISPSORT),H'0'  LK LEN      SS DEC87
         DC    X'3001',AL2(ISPSRL40-ISPSORT),H'0'  LK LEN DESC SS AUG86
         DC    X'C000',AL2(ISPSRL41-ISPSORT),H'0'  MAIN       DRK JUL07
         DC    X'4000',AL2(ISPSRL41-ISPSORT),H'0'  MAIN       DRK JUL07
         DC    X'4001',AL2(ISPSRL42-ISPSORT),H'0'  MAIN DESC  DRK JUL07
         DC    X'8800',AL2(ISPSRL43-ISPSORT),H'0'  MODE       DRK JUL07
         DC    X'0800',AL2(ISPSRL43-ISPSORT),H'0'  MODE       DRK JUL07
         DC    X'0801',AL2(ISPSRL44-ISPSORT),H'0'  MODE DESC  DRK JUL07
         DC    X'8400',AL2(ISPSRL45-ISPSORT),H'0'  ATTR       DRK JUL07
         DC    X'0400',AL2(ISPSRL45-ISPSORT),H'0'  ATTR       DRK JUL07
         DC    X'0401',AL2(ISPSRL46-ISPSORT),H'0'  ATTR DESC  DRK JUL07
         DC    X'8100',AL2(ISPSRL47-ISPSORT),H'0'  AUTH       DRK JUL07
         DC    X'0100',AL2(ISPSRL47-ISPSORT),H'0'  AUTH       DRK JUL07
         DC    X'0101',AL2(ISPSRL48-ISPSORT),H'0'  AUTH DESC  DRK JUL07
         DC    X'FFFF'              END OF TABLE               SS NOV85
ISPSRL35 DC    C'(MEMLXLEN,C,A,MEMLNAME,C,A)'                 DRK OCT99
ISPSRL36 DC    C'(MEMLXLEN,C,D,MEMLNAME,C,A)'                 DRK OCT99
ISPSRL37 DC    C'(MEMLLCEN,C,A,MEMLLDAT,C,A,MEMLNAME,C,A)'    Y2K AUG97
ISPSRL38 DC    C'(MEMLLCEN,C,D,MEMLLDAT,C,D,MEMLNAME,C,A)'    Y2K AUG97
ISPSRL39 DC    C'(MEMLLCEN,C,A,MEMLLDAT,C,A,MEMLXLEN,C,A,'    Y2K AUG97
         DC    C'MEMLNAME,C,A)'                               Y2K AUG97
ISPSRL40 DC    C'(MEMLLCEN,C,D,MEMLLDAT,C,D,MEMLXLEN,C,D,'    Y2K AUG97
         DC    C'MEMLNAME,C,A)'                               Y2K AUG97
ISPSRL41 DC    C'(MEMLMNAM,C,A,MEMLNAME,C,A)'                 DRK JUL07
ISPSRL42 DC    C'(MEMLMNAM,C,D,MEMLNAME,C,A)'                 DRK JUL07
ISPSRL43 DC    C'(MEMLMODE,C,A,MEMLNAME,C,A)'                 DRK JUL07
ISPSRL44 DC    C'(MEMLMODE,C,D,MEMLNAME,C,A)'                 DRK JUL07
ISPSRL45 DC    C'(MEMLATT1,C,A,MEMLATT2,C,A,MEMLDC,C,A,'      DRK JUL07
         DC    C'MEMLTEST,C,A,MEMLNAME,C,A)'                  DRK JUL07
ISPSRL46 DC    C'(MEMLATT1,C,D,MEMLATT2,C,D,MEMLDC,C,D,'      DRK JUL07
         DC    C'MEMLTEST,C,D,MEMLNAME,C,A)'                  DRK JUL07
ISPSRL47 DC    C'(MEMLAPF,C,A,MEMLNAME,C,A)'                  DRK JUL07
ISPSRL48 DC    C'(MEMLAPF,C,D,MEMLNAME,C,A)'                  DRK JUL07
         DS    0F                                    MATCHES   SS MAR85
***   LISTV                                          ========= SS MAR85
ISPPARS5 DC    X'31',X'00',X'80',X'00',CL8'ASCEND'   A/AS     DRK DEC06
*SPPARS5 DC    X'21',X'00',X'80',X'00',CL8'ASCEND'   AS        SS AUG86
         DC    X'22',X'00',X'10',X'00',CL8'DEVTYPE'  DEV      DRK DEC06
*        DC    X'32',X'00',X'10',X'00',CL8'DEVTYPE'  D/DEV    ABL JAN87
         DC    X'31',X'00',X'00',X'01',CL8'DESCEND'  D/DE     DRK DEC06
*        DC    X'21',X'00',X'00',X'01',CL8'DESCEND'  DE        SS AUG86
         DC    X'22',X'00',X'10',X'00',CL8'TYPE'     TYP       SS NOV85
         DC    X'31',X'00',X'40',X'00',CL8'VOLUME'   V/VO      SS NOV85
         DC    X'22',X'00',X'20',X'00',CL8'ADDRESS'  ADD      DRK DEC06
*        DC    X'32',X'00',X'20',X'00',CL8'ADDRESS'  A/ADD    ABL JAN87
         DC    X'31',X'00',X'08',X'00',CL8'SPACE'    S/SP      SS NOV85
         DC    X'31',X'00',X'08',X'00',CL8'FREE'     F/FR      SS MAY88
         DC    X'22',X'00',X'08',X'00',CL8'TOTAL'    TOT      ABL JAN87
         DC    X'33',X'00',X'04',X'00',CL8'LARGEST'  L/LARG    SS NOV85
         DC    X'31',X'00',X'02',X'00',CL8'COUNT'    C/CO     DRK JUL98
         DC    X'31',X'00',X'01',X'00',CL8'USED'     U/US     DRK AUG98
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPSRCK5 DC    X'0000',AL2(ISPSRL50-ISPSORT),H'1'  VOL         SS AUG86
         DC    X'C000',AL2(ISPSRL50-ISPSORT),H'1'  VOL         SS AUG86
         DC    X'8000',AL2(ISPSRL50-ISPSORT),H'1'  VOL         SS AUG86
         DC    X'4000',AL2(ISPSRL50-ISPSORT),H'1'  VOL         SS AUG86
         DC    X'4001',AL2(ISPSRL51-ISPSORT),H'0'  VOL DES     SS AUG86
         DC    X'0001',AL2(ISPSRL51-ISPSORT),H'0'  VOL DES     SS AUG86
         DC    X'A000',AL2(ISPSRL52-ISPSORT),H'0'  ADDR        SS AUG86
         DC    X'2000',AL2(ISPSRL52-ISPSORT),H'0'  ADDR        SS AUG86
         DC    X'2001',AL2(ISPSRL53-ISPSORT),H'0'  ADDR DES    SS AUG86
         DC    X'9000',AL2(ISPSRL54-ISPSORT),H'0'  TYPE VOL    SS AUG86
         DC    X'1000',AL2(ISPSRL54-ISPSORT),H'0'  TYPE VOL    SS AUG86
         DC    X'1001',AL2(ISPSRL55-ISPSORT),H'0'  TYPE DES    SS AUG86
         DC    X'D000',AL2(ISPSRL54-ISPSORT),H'0'  TYPE VOL    SS AUG86
         DC    X'5000',AL2(ISPSRL54-ISPSORT),H'0'  TYPE VOL    SS AUG86
         DC    X'5001',AL2(ISPSRL55-ISPSORT),H'0'  TYPE DES    SS AUG86
         DC    X'8800',AL2(ISPSRL56-ISPSORT),H'0'  TOTAL       SS AUG86
         DC    X'0800',AL2(ISPSRL56-ISPSORT),H'0'  TOTAL       SS AUG86
         DC    X'0801',AL2(ISPSRL57-ISPSORT),H'0'  TOTAL DES   SS AUG86
         DC    X'8400',AL2(ISPSRL58-ISPSORT),H'0'  LARG        SS AUG86
         DC    X'0400',AL2(ISPSRL58-ISPSORT),H'0'  LARG        SS AUG86
         DC    X'0401',AL2(ISPSRL59-ISPSORT),H'0'  LARG DES    SS AUG86
         DC    X'9800',AL2(ISPSRL60-ISPSORT),H'0'  TYPE TOTAL  SS AUG86
         DC    X'1800',AL2(ISPSRL60-ISPSORT),H'0'  TYPE TOTAL  SS AUG86
         DC    X'1801',AL2(ISPSRL61-ISPSORT),H'0'  TYPE TOT D  SS AUG86
         DC    X'9400',AL2(ISPSRL62-ISPSORT),H'0'  TYPE LARG   SS AUG86
         DC    X'1400',AL2(ISPSRL62-ISPSORT),H'0'  TYPE LARG   SS AUG86
         DC    X'1401',AL2(ISPSRL63-ISPSORT),H'0'  TYPE LARG D SS AUG86
         DC    X'8200',AL2(ISPSRL64-ISPSORT),H'0'  COUNT      DRK JUL98
         DC    X'0200',AL2(ISPSRL64-ISPSORT),H'0'  COUNT      DRK JUL98
         DC    X'0201',AL2(ISPSRL65-ISPSORT),H'0'  COUNT DES  DRK JUL98
         DC    X'9200',AL2(ISPSRL66-ISPSORT),H'0'  TYPE COUNT DRK JUL98
         DC    X'1200',AL2(ISPSRL66-ISPSORT),H'0'  TYPE COUNT DRK JUL98
         DC    X'1201',AL2(ISPSRL67-ISPSORT),H'0'  TYPE CNT D DRK JUL98
         DC    X'8100',AL2(ISPSRL68-ISPSORT),H'0'  USED       DRK AUG98
         DC    X'0100',AL2(ISPSRL68-ISPSORT),H'0'  USED       DRK AUG98
         DC    X'0101',AL2(ISPSRL69-ISPSORT),H'0'  USED DES   DRK AUG98
         DC    X'9100',AL2(ISPSRL6A-ISPSORT),H'0'  TYPE USED  DRK AUG98
         DC    X'1100',AL2(ISPSRL6A-ISPSORT),H'0'  TYPE USED  DRK AUG98
         DC    X'1101',AL2(ISPSRL6B-ISPSORT),H'0'  TYPE USE D DRK AUG98
         DC    X'FFFF'              END OF TABLE               SS NOV85
ISPSRL50 DC    C'(PDSVVOL,C,A)'                                SS AUG86
ISPSRL51 DC    C'(PDSVVOL,C,D)'                                SS AUG86
ISPSRL52 DC    C'(PDSVXADD,C,A)'                               SS AUG86
ISPSRL53 DC    C'(PDSVXADD,C,D)'                               SS AUG86
ISPSRL54 DC    C'(PDSVTYPE,C,A,PDSVVOL,C,A)'                   SS AUG86
ISPSRL55 DC    C'(PDSVTYPE,C,D,PDSVVOL,C,A)'                   SS AUG86
ISPSRL56 DC    C'(PDSVTCYL,C,A,PDSVTTRK,C,A,PDSVVOL,C,A)'      SS AUG86
ISPSRL57 DC    C'(PDSVTCYL,C,D,PDSVTTRK,C,D,PDSVVOL,C,A)'      SS AUG86
ISPSRL58 DC    C'(PDSVLCYL,C,A,PDSVLTRK,C,A,PDSVVOL,C,A)'      SS AUG86
ISPSRL59 DC    C'(PDSVLCYL,C,D,PDSVLTRK,C,D,PDSVVOL,C,A)'      SS AUG86
ISPSRL60 DC    C'(PDSVTYPE,C,A,PDSVTCYL,C,A,PDSVTTRK,C,A,PDSVVOL,C,A)'
ISPSRL61 DC    C'(PDSVTYPE,C,A,PDSVTCYL,C,D,PDSVTTRK,C,D,PDSVVOL,C,A)'
ISPSRL62 DC    C'(PDSVTYPE,C,A,PDSVLCYL,C,A,PDSVLTRK,C,A,PDSVVOL,C,A)'
ISPSRL63 DC    C'(PDSVTYPE,C,A,PDSVLCYL,C,D,PDSVLTRK,C,D,PDSVVOL,C,A)'
ISPSRL64 DC    C'(PDSVCNTK,C,A,PDSVCNT,C,A,PDSVVOL,C,A)'      DRK JUL98
ISPSRL65 DC    C'(PDSVCNTK,C,D,PDSVCNT,C,D,PDSVVOL,C,A)'      DRK JUL98
ISPSRL66 DC    C'(PDSVTYPE,C,A,PDSVCNTK,C,A,PDSVCNT,C,A,'     DRK JUL98
         DC    C'PDSVVOL,C,A)'                                DRK JUL98
ISPSRL67 DC    C'(PDSVTYPE,C,A,PDSVCNTK,C,D,PDSVCNT,C,D,'     DRK JUL98
         DC    C'PDSVVOL,C,A)'                                DRK JUL98
ISPSRL68 DC    C'(PDSVSPCU,C,A,PDSVVOL,C,A)'                  DRK AUG98
ISPSRL69 DC    C'(PDSVSPCU,C,D,PDSVVOL,C,A)'                  DRK AUG98
ISPSRL6A DC    C'(PDSVTYPE,C,A,PDSVSPCU,C,A,PDSVVOL,C,A)'     DRK AUG98
ISPSRL6B DC    C'(PDSVTYPE,C,A,PDSVSPCU,C,D,PDSVVOL,C,A)'     DRK AUG98
         DS    0F                                    MATCHES   SS MAR85
***   LISTC/LISTF                                    ========= SS MAR85
ISPPARS6 DC    X'31',X'00',X'80',X'00',CL8'ASCEND'   A/AS     DRK DEC06
*SPPARS6 DC    X'21',X'00',X'80',X'00',CL8'ASCEND'   AS        SS OCT88
         DC    X'31',X'00',X'00',X'01',CL8'DESCEND'  D/DE     DRK DEC06
*        DC    X'21',X'00',X'00',X'01',CL8'DESCEND'  DE        SS OCT88
         DC    X'21',X'00',X'40',X'00',CL8'DSNAME'   DS        SS OCT88
         DC    X'31',X'00',X'20',X'00',CL8'VOLUME'   V/VO      SS OCT88
         DC    X'25',X'00',X'10',X'00',CL8'LEVEL2'   LEVEL2    SS OCT88
         DC    X'21',X'00',X'10',X'00',CL8'L2'       L2        SS OCT88
         DC    X'32',X'00',X'08',X'00',CL8'SUFFIX'   S/SUF     SS OCT88
         DC    X'34',X'00',X'04',X'00',CL8'CDATE'    C/CDATE   SS OCT88
         DC    X'34',X'00',X'04',X'00',CL8'CREATED'  C/CREAT   SS OCT88
         DC    X'34',X'00',X'02',X'00',CL8'RDATE'    R/RDATE   SS OCT88
         DC    X'34',X'00',X'02',X'00',CL8'REFER'    R/REFER   SS OCT88
         DC    X'21',X'00',X'01',X'00',CL8'SIZE'     SI        SS OCT88
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS OCT88
ISPSRCK6 DC    X'0000',AL2(ISPSRL70-ISPSORT),H'1'  DSN+VOL     SS OCT88
         DC    X'4000',AL2(ISPSRL70-ISPSORT),H'1'  DSN+VOL     SS OCT88
         DC    X'C000',AL2(ISPSRL70-ISPSORT),H'1'  DSN+VOL ASC SS OCT88
         DC    X'4001',AL2(ISPSRL71-ISPSORT),H'0'  DSN DES     SS OCT88
         DC    X'0001',AL2(ISPSRL71-ISPSORT),H'0'  DSN DES     SS OCT88
         DC    X'2000',AL2(ISPSRL72-ISPSORT),H'0'  VOL         SS OCT88
         DC    X'6000',AL2(ISPSRL72-ISPSORT),H'0'  VOL+DSN     SS OCT88
         DC    X'A000',AL2(ISPSRL72-ISPSORT),H'0'  VOL  ASC    SS OCT88
         DC    X'E000',AL2(ISPSRL72-ISPSORT),H'0'  VOL+DSN ASC SS OCT88
         DC    X'2001',AL2(ISPSRL73-ISPSORT),H'0'  VOL DES     SS OCT88
         DC    X'6001',AL2(ISPSRL74-ISPSORT),H'0'  VOL+DSN DES SS OCT88
         DC    X'2400',AL2(ISPSRL7E-ISPSORT),H'0'  VOL+CDAT    SS OCT88
         DC    X'A400',AL2(ISPSRL7E-ISPSORT),H'0'  VOL+CDA ASC SS OCT88
         DC    X'2401',AL2(ISPSRL7F-ISPSORT),H'0'  VOL+CDA DES SS OCT88
         DC    X'6400',AL2(ISPSRL7E-ISPSORT),H'0'  VOL+CDAT    SS OCT88
         DC    X'E400',AL2(ISPSRL7E-ISPSORT),H'0'  VOL+CDA ASC SS OCT88
         DC    X'6401',AL2(ISPSRL7F-ISPSORT),H'0'  VOL+CDA DES SS OCT88
         DC    X'2200',AL2(ISPSRL7G-ISPSORT),H'0'  VOL+RDAT    SS OCT88
         DC    X'A200',AL2(ISPSRL7G-ISPSORT),H'0'  VOL+RDA ASC SS OCT88
         DC    X'2201',AL2(ISPSRL7H-ISPSORT),H'0'  VOL+RDA DES SS OCT88
         DC    X'6200',AL2(ISPSRL7G-ISPSORT),H'0'  VOL+RDAT    SS OCT88
         DC    X'E200',AL2(ISPSRL7G-ISPSORT),H'0'  VOL+RDA ASC SS OCT88
         DC    X'6201',AL2(ISPSRL7H-ISPSORT),H'0'  VOL+RDA DES SS OCT88
         DC    X'2100',AL2(ISPSRL7I-ISPSORT),H'0'  VOL+SIZE    SS OCT88
         DC    X'A100',AL2(ISPSRL7I-ISPSORT),H'0'  VOL+SIZE AS SS OCT88
         DC    X'2101',AL2(ISPSRL7J-ISPSORT),H'0'  VOL+SIZ DES SS OCT88
         DC    X'6100',AL2(ISPSRL7I-ISPSORT),H'0'  VOL+SIZE    SS OCT88
         DC    X'E100',AL2(ISPSRL7I-ISPSORT),H'0'  VOL+SIZE AS SS OCT88
         DC    X'6101',AL2(ISPSRL7J-ISPSORT),H'0'  VOL+SIZ DES SS OCT88
         DC    X'0400',AL2(ISPSRL79-ISPSORT),H'0'  CDAT        SS OCT88
         DC    X'0401',AL2(ISPSRL79-ISPSORT),H'0'  CDAT        SS OCT88
         DC    X'8400',AL2(ISPSRL80-ISPSORT),H'0'  CDAT ASC    SS OCT88
         DC    X'4400',AL2(ISPSRL79-ISPSORT),H'0'  CDAT+DSN    SS OCT88
         DC    X'4401',AL2(ISPSRL79-ISPSORT),H'0'  CDAT+DSN    SS OCT88
         DC    X'C400',AL2(ISPSRL80-ISPSORT),H'0'  CDAT ASC    SS OCT88
         DC    X'0200',AL2(ISPSRL81-ISPSORT),H'0'  RDAT        SS OCT88
         DC    X'0201',AL2(ISPSRL81-ISPSORT),H'0'  RDAT        SS OCT88
         DC    X'8200',AL2(ISPSRL82-ISPSORT),H'0'  RDAT ASC    SS OCT88
         DC    X'4200',AL2(ISPSRL81-ISPSORT),H'0'  RDAT+DSN    SS OCT88
         DC    X'4201',AL2(ISPSRL81-ISPSORT),H'0'  RDAT+DSN    SS OCT88
         DC    X'C200',AL2(ISPSRL82-ISPSORT),H'0'  RDAT ASC    SS OCT88
         DC    X'0100',AL2(ISPSRL84-ISPSORT),H'0'  SIZE        SS OCT88
         DC    X'0101',AL2(ISPSRL84-ISPSORT),H'0'  SIZE        SS OCT88
         DC    X'8100',AL2(ISPSRL83-ISPSORT),H'0'  SIZE ASC    SS OCT88
         DC    X'4100',AL2(ISPSRL84-ISPSORT),H'0'  SIZE+DSN    SS OCT88
         DC    X'4101',AL2(ISPSRL84-ISPSORT),H'0'  SIZE+DSN    SS OCT88
         DC    X'C100',AL2(ISPSRL83-ISPSORT),H'0'  SIZE ASC    SS OCT88
         DC    X'FFFF'              END OF TABLE               SS OCT88
ISPSRL70 DC    C'(PDSCDSN,C,A,PDSCVOL,C,A)'                    SS OCT88
ISPSRL71 DC    C'(PDSCDSN,C,D,PDSCVOL,C,A)'                    SS OCT88
ISPSRL72 DC    C'(PDSCVOL,C,A,PDSCDSN,C,A)'                    SS OCT88
ISPSRL73 DC    C'(PDSCVOL,C,D,PDSCDSN,C,A)'                    SS OCT88
ISPSRL74 DC    C'(PDSCVOL,C,D,PDSCDSN,C,D)'                    SS OCT88
ISPSRL7A DC    C'(PDSCVOL,C,A,PDSCDSN2,C,A,PDSCDSN,C,A)'       SS OCT88
ISPSRL7B DC    C'(PDSCVOL,C,D,PDSCDSN2,C,A,PDSCDSN,C,A)'       SS OCT88
ISPSRL7C DC    C'(PDSCVOL,C,A,PDSCDSNL,C,A,PDSCDSN,C,A)'       SS OCT88
ISPSRL7D DC    C'(PDSCVOL,C,D,PDSCDSNS,C,A,PDSCDSN,C,A)'       SS OCT88
ISPSRL7E DC    C'(PDSCVOL,C,A,PDSCCCEN,C,D,PDSCCDAT,C,D,'     Y2K AUG97
         DC    C'PDSCDSN,C,A)'                                Y2K AUG97
ISPSRL7F DC    C'(PDSCVOL,C,D,PDSCCCEN,C,D,PDSCCDAT,C,D,'     Y2K AUG97
         DC    C'PDSCDSN,C,A)'                                Y2K AUG97
ISPSRL7G DC    C'(PDSCVOL,C,A,PDSCRCEN,C,D,PDSCRDAT,C,D,'     Y2K AUG97
         DC    C'PDSCDSN,C,A)'                                Y2K AUG97
ISPSRL7H DC    C'(PDSCVOL,C,D,PDSCRCEN,C,D,PDSCRDAT,C,D,'     Y2K AUG97
         DC    C'PDSCDSN,C,A)'                                Y2K AUG97
ISPSRL7I DC    C'(PDSCVOL,C,A,PDSCTRKS,C,D,PDSCDSN,C,A)'       SS OCT88
ISPSRL7J DC    C'(PDSCVOL,C,D,PDSCTRKS,C,D,PDSCDSN,C,A)'       SS OCT88
ISPSRL75 DC    C'(PDSCDSN2,C,A,PDSCDSN,C,A,PDSCVOL,C,A)'       SS OCT88
ISPSRL76 DC    C'(PDSCDSN2,C,D,PDSCDSN,C,A,PDSCVOL,C,A)'       SS OCT88
ISPSRL77 DC    C'(PDSCDSNL,C,A,PDSCDSN,C,A,PDSCVOL,C,A)'       SS OCT88
ISPSRL78 DC    C'(PDSCDSNL,C,D,PDSCDSN,C,A,PDSCVOL,C,A)'       SS OCT88
ISPSRL79 DC    C'(PDSCCCEN,C,D,PDSCCDAT,C,D,PDSCDSN,C,A,'     Y2K AUG97
         DC    C'PDSCVOL,C,A)'                                Y2K AUG97
ISPSRL80 DC    C'(PDSCCCEN,C,A,PDSCCDAT,C,A,PDSCDSN,C,A,'     Y2K AUG97
         DC    C'PDSCVOL,C,A)'                                Y2K AUG97
ISPSRL81 DC    C'(PDSCRCEN,C,D,PDSCRDAT,C,D,PDSCDSN,C,A,'     Y2K AUG97
         DC    C'PDSCVOL,C,A)'                                Y2K AUG97
ISPSRL82 DC    C'(PDSCRCEN,C,A,PDSCRDAT,C,A,PDSCDSN,C,A,'     Y2K AUG97
         DC    C'PDSCVOL,C,A)'                                Y2K AUG97
ISPSRL83 DC    C'(PDSCTRKS,C,A,PDSCDSN,C,A,PDSCVOL,C,A)'       SS OCT88
ISPSRL84 DC    C'(PDSCTRKS,C,D,PDSCDSN,C,A,PDSCVOL,C,A)'       SS OCT88
*SPSRL88 DC
         DS    0F                                    MATCHES   SS MAR85
***   CAX                                            ========= SS OCT88
ISPPARS7 DC    X'31',X'00',X'80',X'00',CL8'ASCEND'   A/AS     DRK DEC06
*SPPARS7 DC    X'21',X'00',X'80',X'00',CL8'ASCEND'   AS        SS OCT88
         DC    X'31',X'00',X'00',X'01',CL8'DESCEND'  D/DE     DRK DEC06
*        DC    X'21',X'00',X'00',X'01',CL8'DESCEND'  DE        SS OCT88
         DC    X'21',X'00',X'40',X'00',CL8'NUMBER'   NU        SS OCT88
         DC    X'21',X'00',X'20',X'00',CL8'DSNAME'   DS       DRK DEC06
*        DC    X'31',X'00',X'20',X'00',CL8'DSNAME'   D/DS      SS OCT88
         DC    X'31',X'00',X'10',X'00',CL8'VOLUME'   V/VO      SS OCT88
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS OCT88
ISPSRCK7 DC    X'0000',AL2(ISPSRL90-ISPSORT),H'1'  NUMBER      SS OCT88
         DC    X'4000',AL2(ISPSRL90-ISPSORT),H'1'  NUMBER      SS OCT88
         DC    X'C000',AL2(ISPSRL90-ISPSORT),H'1'  NUMBER      SS OCT88
         DC    X'0001',AL2(ISPSRL91-ISPSORT),H'0'  NUMBER DE   SS OCT88
         DC    X'4001',AL2(ISPSRL91-ISPSORT),H'0'  NUMBER      SS OCT88
         DC    X'2000',AL2(ISPSRL92-ISPSORT),H'0'  DSN         SS OCT88
         DC    X'A000',AL2(ISPSRL92-ISPSORT),H'0'  DSN ASC    DRK OCT98
         DC    X'2001',AL2(ISPSRL93-ISPSORT),H'0'  DSN DES     SS OCT88
         DC    X'1000',AL2(ISPSRL94-ISPSORT),H'0'  VOL         SS OCT88
         DC    X'9000',AL2(ISPSRL94-ISPSORT),H'0'  VOL ASC    DRK OCT98
         DC    X'3000',AL2(ISPSRL94-ISPSORT),H'0'  VOL DSN     SS OCT88
         DC    X'B000',AL2(ISPSRL94-ISPSORT),H'0'  VOL DSN ASCDRK OCT98
         DC    X'1001',AL2(ISPSRL95-ISPSORT),H'0'  VOL DES     SS OCT88
         DC    X'3001',AL2(ISPSRL89-ISPSORT),H'0'  VOL DSN DES SS OCT88
         DC    X'FFFF'              END OF TABLE               SS OCT88
ISPSRL90 DC    C'(PDSXNUM,C,A)'                                SS OCT88
ISPSRL91 DC    C'(PDSXNUM,C,D)'                                SS OCT88
ISPSRL92 DC    C'(PDSXDSN,C,A,PDSXVOL,C,A)'                    SS OCT88
ISPSRL93 DC    C'(PDSXDSN,C,D,PDSXVOL,C,A)'                    SS OCT88
ISPSRL94 DC    C'(PDSXVOL,C,A,PDSXDSN,C,A)'                    SS OCT88
ISPSRL95 DC    C'(PDSXVOL,C,D,PDSXDSN,C,A)'                    SS OCT88
ISPSRL89 DC    C'(PDSXVOL,C,D,PDSXDSN,C,D)'                    SS OCT88
         DS    0F                                    MATCHES   SS MAR85
***   CSECTS                                         ========= SS OCT88
ISPPARS8 DC    X'21',X'00',X'80',X'00',CL8'ASCEND'   AS        SS OCT88
         DC    X'21',X'00',X'00',X'01',CL8'DESCEND'  DE        SS OCT88
         DC    X'21',X'00',X'40',X'00',CL8'ADDRESS'  AD        SS OCT88
         DC    X'31',X'00',X'20',X'00',CL8'NAME'     N/NA      SS OCT88
         DC    X'FF'                                           SS OCT88
         DS    0H                                              SS OCT88
ISPSRCK8 DC    X'0000',AL2(ISPSRL96-ISPSORT),H'1'  ADDRESS     SS OCT88
         DC    X'4000',AL2(ISPSRL96-ISPSORT),H'1'  ADDRESS     SS OCT88
         DC    X'C000',AL2(ISPSRL96-ISPSORT),H'1'  ADDRESS     SS OCT88
         DC    X'0001',AL2(ISPSRL97-ISPSORT),H'0'  ADDR DES    SS OCT88
         DC    X'4001',AL2(ISPSRL97-ISPSORT),H'0'  ADDR DES    SS OCT88
         DC    X'2000',AL2(ISPSRL98-ISPSORT),H'0'  NAME        SS OCT88
         DC    X'2001',AL2(ISPSRL99-ISPSORT),H'0'  NAME DES    SS OCT88
         DC    X'FFFF'              END OF TABLE               SS OCT88
ISPSRL96 DC    C'(PDSSADDR,C,A)'                               SS OCT88
ISPSRL97 DC    C'(PDSSADDR,C,D)'                               SS OCT88
ISPSRL98 DC    C'(PDSSNAME,C,A)'                               SS OCT88
ISPSRL99 DC    C'(PDSSNAME,C,D)'                               SS OCT88
