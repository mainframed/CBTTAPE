PROC 0
CONTROL NOFLUSH NOMSG
SET &DATASET =
DISPLAY: -
ISPEXEC DISPLAY PANEL(FPDSP1)
SET &SAVECC = &LASTCC
CHKPF3: -
IF &SAVECC = 8 THEN DO
     FREE FI(FPDS0000 FPDS0001)
     EXIT
END
ALLOC: -
FREE FI(FPDS0000 FPDS0001)
DELETE FPDS0001.CNTL
ALLOC FI(FPDS0000) DA(&DATASET.) SHR
SET &ALLOCCC = &LASTCC
IF &ALLOCCC ¬= 0 THEN DO
     ISPEXEC DISPLAY PANEL(FPDSP1) MSG(FPDS003I)
     SET &SAVECC = &LASTCC
     GOTO CHKPF3
END
ALLOC FI(FPDS0001) DA(FPDS0001.CNTL) SP(2 2) CYL
SET &ALLOCCC = &LASTCC
IF &ALLOCCC ¬= 0 THEN DO
     ISPEXEC DISPLAY PANEL(FPDSP1) MSG(FPDS004I)
     SET &SAVECC = &LASTCC
     GOTO CHKPF3
END
ISPEXEC SELECT PGM(SPFPDS)
SET &SAVECC = &LASTCC
IF &SAVECC = 4 THEN GOTO DISPLAY
IF &SAVECC = 8 THEN DO
    ISPEXEC DISPLAY PANEL(FPDSP1) MSG(FPDS001I)
    SET &SAVECC = &LASTCC
    GOTO CHKPF3
END
SET &DATASET =
ISPEXEC DISPLAY PANEL(FPDSP1) MSG(FPDS000I)
SET &SAVECC = &LASTCC
GOTO CHKPF3
