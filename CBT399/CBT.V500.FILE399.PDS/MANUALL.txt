./       ADD   NAME=$INDEX
  AUTOCMDS - RE-ESTABLISH JES2 AUTOMATIC COMMANDS
  CHKFILES - FIND OUT IF DATASETS NEEDED BY ONLINE SYSTEMS ARE MISSING
  CJ       - CANCEL, HOLD AND REQUEUE A JOB
  CLEANUP  - INITIATE DFHSM CLEANUP OF SCRATCH PACKS.
  DATE     - CONVERT JULIAN DATE TO NICE FORMAT.
  DCIDMS   - REPLIES TO WTOR TO BRING DOWN A VERSION OF IDMS
  ECHO     - WRITE OUTPUT OF OSCMD TO OPER CONSOLE
  HKPRT    - START PRINTERS IN HONG KONG.
  HOTSTART - SHUT DOWN AND HOTSTART JES2.
  IEC701D  - REPLY U TO A DATE PROTECTION MESSAGE
  IEF238D  - REPLY WAIT FOR ALLOCATION RECOVERY
  IEF433D  - REPLY NOHOLD FOR ALLOCTION RECOVERY
  INITD    - SET INITIATORS TO DAYTIME CONFIGURATION
  IPLBASIC - START THINGS UP AFTER AN IPL.
  JESCMDS  - RE-ESTABLISH JES2 AUTOMATIC COMMANDS
  J328XPRT - RESTART JES328X SUPPORTED REMOTES
  OMEGAON  - START OMEGAMON SESSIONS
  OMEGATAP - SETUP OMEGAMON FOR THE TAPE OPERATORS
  ONLINES  - BRING UP ONLINE SYSTEMS WHEN NO IPL THIS AM.
  PCIDMS   - REPLIES TO WTOR TO BRING DOWN A VERSION OF IDMS
  RMTMSG   - SEND A MESSAGE WHEN A REMOTE JOB STARTS PRINTING
  RMTSET   - HANDLE THE $HASP190 MESSAGE FOR JES328X REMOTES
  RMTSTART - RESTART A PRINTER WHEN JES328X HAS A PROBLEM
  SHUTCICS - SHUTDOWN A CICS SYSTEM.
  SHUTDOWN - SHUTDOWN EVERYTHING.
  SMFDUMP  - DUMP ANY FULL SMF DATASETS.
  SPLCLEAN - CLEAN UP THE JUNK WHEN SPOOL % > 80.
  STRTAUTO - START AUTOA AFTER TSSO COMES UP.
  STRT328X - START JES328X AFTER AN IPL.
  TOOLONG  - REFLECT THE $HASP308 MESSAGE BACK TO THE SUBMITTOR
  UNAV     - WARN OPER THAT A JOB HAS UNAVAILABLE VOLUMES.
  USTRIDMS - SHUT DOWN AN IDMS SYSTEM.
./       ADD   NAME=AOFTABLE
AOFV4R2  TABSTART ID=AOFV4R2
*
***********************************************************************
* REPLY 'U' TO EXPIRY DATE PROTECTION. LET ACF2 HANDLE IT.
***********************************************************************
*
         TABENTRY MSG=IEC507D,ACTION=REPLY,TEXT='U'
*
***********************************************************************
* HILIGHT CERTAIN IO ERROR MESSAGES
***********************************************************************
*
         TABENTRY MSG=IEC512I,ACTION=HILIGHT
         TABENTRY MSG=IOS000I,ACTION=HILIGHT,                          X
               TEST=((S,009,02,'FA'))
         TABENTRY MSG=IOS000I,ACTION=HILIGHT,                          X
               TEST=((S,009,02,'BC'))
*
***********************************************************************
* SUPPRESS CERTAIN MESSAGES WHICH CANNOT BE SUPPRESSED WITH MPF
***********************************************************************
*
         TABENTRY MSG=$HASP317,ACTION=SUPPRESS
         TABENTRY MSG=$HASP632,ACTION=SUPPRESS
*        TABENTRY MSG=ACTL13I,ACTION=LOWLIGHT
         TABENTRY MSG=ARC0120I,ACTION=SUPPRESS
         TABENTRY MSG=IEA989I,ACTION=SUPPRESS
         TABENTRY MSG=IEE600I,ACTION=SUPPRESS
         TABENTRY MSG=IEE704I,ACTION=SUPPRESS
         TABENTRY MSG=IEE727I,ACTION=SUPPRESS
         TABENTRY MSG=IEF196I,ACTION=SUPPRESS
         TABENTRY MSG=IKJ56644,ACTION=SUPPRESS
         TABENTRY MSG=IST197I,ACTION=SUPPRESS
*        TABENTRY MSG=IST440I,ACTION=SUPPRESS
         TABENTRY MSG=IST462I,ACTION=SUPPRESS
*
***********************************************************************
* EXECUTE STRTAUTO CLIST AS SOON AS TSSO IS UP. THIS WILL STRAT AUTOA *
* WHICH WILL START ALL ONLINES ETC                                    *
***********************************************************************
*
         TABENTRY MSG=TSST060I,ACTION=OSCMD,                           X
               TEXT='#STRTAUTO'
*
***********************************************************************
* HILIGHT MESSAGE ABOUT JOB HELD FOR UNAVAILABLE VOLUMES.
***********************************************************************
*
         TABENTRY MSG=DTM1462I,ACTION=OSCMD,                           X
               TEXT='#UNAV \W    03\'
*
***********************************************************************
* CLIST TO AUTOMATICALLY START CERTAIN JES2 REMOTES.
***********************************************************************
*
         TABENTRY MSG=$HASP190,ACTION=OSCMD,                           X
               TEST=((W,5,8,'R176.PR1',' ')),                          X
               TEXT='#RMTSET \W    05\'
         TABENTRY MSG=$HASP190,ACTION=OSCMD,                           X
               TEST=((W,5,8,'R143.PR1',' ')),                          X
               TEXT='#RMTSET \W    05\'
         TABENTRY MSG=$HASP190,ACTION=OSCMD,                           X
               TEST=((W,5,8,'R190.PR1',' ')),                          X
               TEXT='#RMTSET \W    05\'
         TABENTRY MSG=$HASP190,ACTION=OSCMD,                           X
               TEST=((W,5,8,'R193.PR1',' ')),                          X
               TEXT='#RMTSET \W    05\'
         TABENTRY MSG=$HASP190,ACTION=OSCMD,                           X
               TEST=((W,5,8,'R194.PR1',' ')),                          X
               TEXT='#RMTSET \W    05\'
*
         TABENTRY MSG=IEC701D,ACTION=OSCMD,                            X
               TEST=((S,011,02,'FA')),                                 X
               TEXT='#IEC701D'
*
***********************************************************************
* REPLY 'WAIT' TO 'DEVICE NAME, WAIT OR CANCEL'
***********************************************************************
*
         TABENTRY MSG=IEF238D,ACTION=OSCMD,TEXT='#IEF238D',            X
               TEST=((W,4,4,'WAIT',''''))
         TABENTRY MSG=IEF238D,ACTION=OSCMD,TEXT='#IEF238D',            X
               TEST=((W,5,4,'WAIT',''''))
         TABENTRY MSG=IEF238D,ACTION=OSCMD,TEXT='#IEF238D',            X
               TEST=((W,6,4,'WAIT',''''))
         TABENTRY MSG=IEF238D,ACTION=OSCMD,TEXT='#IEF238D',            X
               TEST=((W,7,4,'WAIT',''''))
*
***********************************************************************
* REPLY 'NOHOLD' TO 'HOLD OR NOHOLD'
***********************************************************************
*
         TABENTRY MSG=IEF433D,ACTION=OSCMD,TEXT='#IEF433D'
*
* SUPPRESS BOGUS I/O ERROR MSGS FROM BSC RJE LINES.
*
         TABENTRY MSG=$HASP094,ACTION=SUPPRESS,                        X
               TEST=((W,5,5,'LINE3',' '))
         TABENTRY MSG=$HASP094,ACTION=SUPPRESS,                        X
               TEST=((W,5,5,'LINE4',' '))
         TABENTRY MSG=$HASP094,ACTION=SUPPRESS,                        X
               TEST=((W,5,5,'LINE8',' '))
*
* SUPPRESS HASP MESSAGES RELATED TO REMOTES
*
         TABENTRY MSG=$HASP200,ACTION=SUPPRESS,                        X
               TEST=((W,2,3,'RMT',' '))
         TABENTRY MSG=$HASP150,ACTION=SUPPRESS,                        X
               TEST=((W,5,1,'R',' '))
*
*
* SUPPRESS SOME TSSO GENERATED MESSAGES.
*
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((S,001,05,'# OK '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((S,001,06,'READY '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((S,001,04,'END '))
*
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((S,001,01,'+'),(S,018,11,' ) PRINTING'))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((S,001,01,'+'),(S,018,14,' ) WAITING FOR'))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((S,001,01,'+'),(S,036,14,' INTERVENTION '))
*
* SUPPRESS SOME IDMS MESSAGES
*
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC001003',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC021003',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC081001',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC081017',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC171032',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC200036',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC201006',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC203005',' '))
         TABENTRY MSG=*,ACTION=SUPPRESS,                               X
               TEST=((W,001,05,'+IDMS',' '),(W,2,8,'DC204002',' '))
*
         TABENTRY MSG=*,ACTION=OSCMD,                                  X
               TEST=((S,001,01,'+'),(S,036,14,' RU LENGTH ERR')),      X
               TEXT='#RMTSTART RMT(''\P014,03\'')'
*
***********************************************************************
* SUBMIT SYSJOB TO DUMP DFHSM LOG AFTER LOG SWITCHED
***********************************************************************
*
         TABENTRY MSG=ARC0027I,ACTION=OSCMD,                           X
               TEXT='S SYSJOB,JOB=HSMLDUMP'
*
***********************************************************************
* START DFHSM CDS BACKUP WHEN CONTROL DATASETS FULL THRESHOLD REACHED
***********************************************************************
*
         TABENTRY MSG=ARC0909I,ACTION=OSCMD,                           X
               TEXT='F DFHSM,BACKVOL CDS'
*
         TABEND
./       ADD   NAME=AUTOCMDS
PROC 0
/******************************************************************/
/*  THIS CLIST ISSUES JES2 AUTOMATIC COMMANDS WHICH ARE ISSUED    */
/*  BASED ON TIME INTERVAL. ALL OTHER AUTOMATIC COMMANDS CAN BE   */
/*  ISSUED USING AUTOA                                            */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* SHOULD TAKE LESS THAN 5 SEC FOR OS CMDS                        */
SET CMDWAIT   = 5
SET MAXCMDOUT = 0
OSCMD $CA,ALL
OSPAUSE 10
OSCMD $TA,I=0180,'$VS,''D T'''
OSCMD $TA,I=1800,'$RALL,R=R24,D=N5R1'
OSCMD $TA,I=0300,'$DQ,R=R0'
OSCMD $TA,I=0900,'$OT1-9999,Q=A,CANCEL'
OSCMD $TA,I=0900,'$DBUFDEF'
OSCMD $TA,I=0900,'$DCONDEF'
OSCMD $TA,I=0900,'$DJOBDEF'
OSCMD $TA,I=0900,'$DOUTDEF'
OSCMD $TA,I=0900,'$DSMFDEF'
OSCMD $TA,I=0900,'$DSPOOLDEF'
OSCMD $TA,I=0900,'$DTPDEF'
OSCMD $TA,I=3600,'$VS,''S SYSJOB,JOB=SVCDUMP'''
./       ADD   NAME=CHKFILES
PROC 0 JOB('PCICS')
IF .&JOB = . THEN GOTO -TELL
IF &JOB = PCICS THEN DO
                     SET DSNAME = &STR(PTS.CICS.PROD.CNTL(PRODCICS))
                     GOTO ALLOC
                     END
IF &JOB = HAWAII THEN DO
                     SET DSNAME = &STR(PTS.CICS.PROD.CNTL(HAWAII))
                     GOTO ALLOC
                     END
IF &JOB = DCICS THEN DO
                     SET DSNAME = &STR(TTS.CICS.DVLP.CNTL(DVLPCICS))
                     GOTO ALLOC
                     END
IF &JOB = USCICS THEN DO
                     SET DSNAME = &STR(TTS.CICS.ULVL.CNTL(USCICS))
                     GOTO ALLOC
                     END
IF &JOB = DCANCICS THEN DO
                     SET DSNAME = &STR(TTS.CICS.DCAN.CNTL(DCANCICS))
                     GOTO ALLOC
                     END
IF &JOB = UKCICS THEN DO
                     SET DSNAME = &STR(PTS.CICS.PROD.CNTL(UKCICS))
                     GOTO ALLOC
                     END
IF &JOB = PIDMS THEN DO
                     SET DSNAME = &STR(IDMS.CNTL(IDMSCV1))
                     GOTO ALLOC
                     END
IF &JOB = DIDMS THEN DO
                     SET DSNAME = &STR(IDMS.CNTL(IDMSCV3))
                     GOTO ALLOC
                     END
IF &JOB = USIDMS THEN DO
                     SET DSNAME = &STR(IDMS.CNTL(IDMSCV4))
                     GOTO ALLOC
                     END
IF &JOB = DCIDMS THEN DO
                     SET DSNAME = &STR(TCS.IDMS.CNTL(DCIDMS))
                     GOTO ALLOC
                     END
IF &JOB = PCIDMS THEN DO
                     SET DSNAME = &STR(TCS.IDMS.CNTL(PCIDMS))
                     GOTO ALLOC
                     END
OSWTO *** INVALID JOB NAME SPECIFED ****
EXIT CODE (4)
ALLOC: +
FREE FI(JCLIN)
ALLOC F(JCLIN) DA('&DSNAME')
OPENFILE JCLIN INPUT
SET RC = 0
ERROR DO
        GOTO EOJ
      END
LOOP1:+
  GETFILE  JCLIN
  IF &SUBSTR(3:3,&JCLIN) = &STR(*) THEN GOTO LOOP1
  SET LEN = &LENGTH(&STR(&JCLIN))
  SET I = 4
/* CONTROL LIST SYMLIST CONLIST */
  DO WHILE (&I < &LEN - 3)
  IF &SUBSTR(&I:&I+4,&JCLIN) = &STR(DUMMY) THEN GOTO LOOP1
  IF &SUBSTR(&I:&I+3,&JCLIN) = &STR(DSN=) AND  +
     &SUBSTR(&I+4:&I+4,&JCLIN) ¬= &STR(&&) THEN +
     DO
        SET J = &I + 4
        SET K = &I + 4
        DO WHILE (&K < &LEN)
IF &SUBSTR(&K:&K,&JCLIN) =  &STR(+) THEN GOTO LOOP1
IF &SUBSTR(&K:&K+1,&JCLIN) = &STR((0) THEN GOTO LOOP1
IF &SUBSTR(&K:&K,&JCLIN) = &STR(&&) THEN GOTO LOOP1
IF &SUBSTR(&K:&K,&JCLIN) =  | &SUBSTR(&K:&K,&JCLIN) = &STR(,) THEN +
           DO
             SET DSN = &SUBSTR(&J:&K-1,&JCLIN)
/*           WRITE *** &JOB ***    &DSN       */
             STATE &DSN
             IF &LASTCC ¬= 0 THEN +
                             DO
                             OSWTOH *** &JOB FILE NOT FOUND  &DSN ***
                             SET RC = 4
                             END
             GOTO LOOP1
           END
        SET K = &K + 1
     END
     END
  SET I = &I + 1
  END
GOTO LOOP1
EOJ: +
CLOSFILE JCLIN
FREE FI(JCLIN)
IF &RC = 0 THEN +
     DO
     OSWTOH *** CHKFILES CLIST SUCCESSFULLY COMPLETED FOR &JOB ***
     EXIT CODE (0)
     END
OSWTOH *** SOME FILES NOT FOUND FOR &JOB ***
OSWTOH *** PLEASE CHECK PREVIOUS MESSAGES FOR FILE NAMES ***
EXIT CODE (4)
TELL: +
OSWTO NO DSNAME SPECIFIED
OSWTO CORRECT FORMAT IS *** CHKFILES JOB(NAME) ***
EXIT CODE (4)
./       ADD   NAME=CJ
PROC 1 JOB
WRITE *COM1 $HJ&JOB
WRITE *COM1 $EJ&JOB
WRITE *COM1 $CJ&JOB
END
./       ADD   NAME=CLEANUP
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED BY OPERATORS INCASE TSSO OR THE SYSTEM */
/*  IS DOWN WHEN SCRATCH PACKS ARE NORMALLY CLEANED UP AT 4:30 PM */
/*                                                                */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* SHOULD TAKE LESS THAN 5 SEC FOR OS CMDS                        */
SET CMDWAIT   = 5
SET MAXCMDOUT = 0
OSCMD F DFHSM,MIGRATE VOL(SCRCHA DELETEBYAGE(0)) UNIT(3380)
OSCMD F DFHSM,MIGRATE VOL(SCRCHB DELETEBYAGE(0)) UNIT(3380)
OSCMD F DFHSM,MIGRATE VOL(SCRCHC DELETEBYAGE(0)) UNIT(3380)
OSCMD F DFHSM,MIGRATE VOL(SCRCHD DELETEBYAGE(0)) UNIT(3380)
./       ADD   NAME=DATE
PROC 0
/******************************************************************/
/*  THIS CLIST ISSUES D T COMMAND AND CONVERTS CYCLIC DATE TO     */
/*  A MORE READABLE FORMAT.                                       */
/******************************************************************/
/* SET TO MAX TO GET ALL OUTSTANDING REPLIES                      */
SET MAXCMDOUT = 200
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
OSCMD D T
/* IGNORE FIRST LINE                                              */
SET TIME = &CMDOUT2W3
SET DATE = &CMDOUT2W6
SET YEAR = &SUBSTR(1:2,&DATE)
SET Y1 = &YEAR/4
SET LEAP = &YEAR - &Y1*4
IF &LEAP > 0 THEN SET LEAP = 0
             ELSE SET LEAP = 1
SET JAN = 31
SET FEB = &JAN + 28 + &LEAP
SET MAR = &FEB + 31
SET APR = &MAR + 30
SET MAY = &APR + 31
SET JUN = &MAY + 30
SET JUL = &JUN + 31
SET AUG = &JUL + 31
SET SEP = &AUG + 30
SET OCT = &SEP + 31
SET NOV = &OCT + 30
SET DEC = &NOV + 31
SET DAYS = &SUBSTR(4:6,&DATE)
IF &DAYS <= &JAN THEN DO
           SET DATE = &DAYS
           SET NEWDATE = &STR(&DATE) &STR(JAN) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &FEB THEN DO
           SET DATE = &DAYS - &JAN
           SET NEWDATE = &STR(&DATE) &STR(FEB) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &MAR THEN DO
           SET DATE = &DAYS - &FEB
           SET NEWDATE = &STR(&DATE) &STR(MAR) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &APR THEN DO
           SET DATE = &DAYS - &MAR
           SET NEWDATE = &STR(&DATE) &STR(APR) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &MAY THEN DO
           SET DATE = &DAYS - &APR
           SET NEWDATE = &STR(&DATE) &STR(MAY) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &JUN THEN DO
           SET DATE = &DAYS - &MAY
           SET NEWDATE = &STR(&DATE) &STR(JUN) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &JUL THEN DO
           SET DATE = &DAYS - &JUN
           SET NEWDATE = &STR(&DATE) &STR(JUL) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &AUG THEN DO
           SET DATE = &DAYS - &JUL
           SET NEWDATE = &STR(&DATE) &STR(AUG) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &SEP THEN DO
           SET DATE = &DAYS - &AUG
           SET NEWDATE = &STR(&DATE) &STR(SEP) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &OCT THEN DO
           SET DATE = &DAYS - &SEP
           SET NEWDATE = &STR(&DATE) &STR(OCT) &STR(&YEAR)
           GOTO WTRMSG
           END
IF &DAYS <= &NOV THEN DO
           SET DATE = &DAYS - &OCT
           SET NEWDATE = &STR(&DATE) &STR(NOV) &STR(&YEAR)
           GOTO WTRMSG
           END
SET DATE = &DAYS - &NOV
SET NEWDATE = &STR(&DATE) &STR(DEC) &STR(&YEAR)
WTRMSG: +
OSASK PLEASE VERIFY THE DATE ** &NEWDATE ** AND REPLY 'GO',     IF +
  THE DATE IS WRONG, PLEASE RE-IPL THE SYSTEM
IF &SUBSTR(1:2,&REPLY) = GO THEN GOTO EXIT0
GOTO WTRMSG
EXIT0: +
EXIT CODE(0)
./       ADD   NAME=DCIDMS
PROC 0
/******************************************************************/
/*  THIS CLIST AUTOMATICALLY REPLIES TO THE OUTSTANDING REPLY     */
/*  FOR DCIDMS. NORMALLY THIS WILL BE EXECUTED BY AUTO AT         */
/*  PREDEFINED TIME (19:00). THE PROCESSING INVOLVES ISSUEING     */
/*  'D R,L' COMMAND AND SCANNING THE OUTPUT FOR THE DCIDMS        */
/*  VERSION ID V12. IT THEN REPLIES 'SHUTDOWN' FOR THAT REPLY     */
/*  ID.                                                           */
/*  MAINTENANCE LOG                                               */
/*  ===============                                               */
/*  WHO      WHEN                     WHAT                        */
/*  ---      ----                     ----                        */
/*                                                                */
/*  MIKEW    JAN 12/86   ADD TRIGGER FOR UCC7                     */
/******************************************************************/
/* SET TO MAX TO GET ALL OUTSTANDING REPLIES                      */
SET MAXCMDOUT = 200
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
OSCMD D R,L
/* IGNORE FIRST 4 LINES FROM D R,L                                */
SET I = 5
/* SCAN THRU REST OF RESPONSE LINES                               */
DO WHILE (&I <= &CMDOUT)
/* GET NUMBER OF WORDS IN THE REPLY                               */
SET WORDS =  &&CMDOUT&I.W
/* TEST FOR DCIDMS ONLY IF >= 9 WORDS                             */
IF &WORDS >= 9  THEN +
  DO
/* GET VERSION NUMBER                                             */
  SET VERSION = &&CMDOUT&I.W9
  SET PGM     = &&CMDOUT&I.W8
/* IS IT DCIDMS ??                                                */
  IF &STR(&VERSION) = &STR(V12) AND &STR(&PGM) = &STR(IDMS) THEN +
      DO
      SET REPLYID = &&CMDOUT&I.W1
      SET MAXCMDOUT = 0
      OSCMD R &REPLYID,SHUTDOWN
      OSPAUSE 60
      OSCMD S DCIDMSTR
      OSPAUSE 10
      OSWTO UCC7 TRIGGER JOB DCIDMSTR HAS BEEN STARTED
      EXIT CODE(0)
      END
  END
SET I = &I + 1
END
OSWTOH DCIDMS IS NOT ACTIVE
EXIT CODE(0)
./       ADD   NAME=ECHO
PROC 0 CMD()
CONTROL LIST CONLIST SYMLIST
SET MAXCMDOUT = 5
SET CMDWAIT   = 1
OSCMD &CMD
SET I = 1
DO WHILE (&I <= &CMDOUT)
   SET O = &&CMDOUT&I
   OSWTO &O
   SET I = &I + 1
END
EXIT CODE(0)
./       ADD   NAME=EXASK
         PROC 0
         /****************************************************/
         /* THIS CLIST WILL PROVIDE AN EXAMPLE OF THE OSASK  */
         /* FACILITY OF TSSO.                                */
         /****************************************************/

         /* FIRST, FIND OUT IF THE OPERATOR IS READY TO PROCEED */
         /* SET A TIME LIMIT OF 30 SECONDS...                   */
         SET REPLYWAIT = 30

         STARTAGN: +
         OSASK ARE YOU READY TO PROCEED

         IF &REPLY = NOREPLY THEN GOTO TIMEDOUT
         IF &REPLY = NO THEN GOTO ENDPROG
         IF &REPLY ¬= YES THEN GOTO CONFUSED

         OSASK GREAT ! WHAT TASK(S) ARE YOU TRYING TO PERFORM ?

         /* UP TO 6 ITEMS MAY BE ENTERED ON THE RESPONSE LINE. THE */
         /* OSASK COMMAND PARSES THE OPERATOR RESPONSE INTO CLIST  */
         /* VARIABLES. WE WILL LOOP THROUGH, SUPPLYING THE OPERATOR*/
         /* WITH THE NEEDED ANSWERS.                               */

         IF &REPLY = NOREPLY THEN GOTO TIMEDOUT
         SET COUNT = &REPLYW

         SET I = 1
         DO WHILE (&I <= &COUNT)

           SET VAR = &&REPLYW&I       /* GET THE I'TH WORD */

           IF &VAR = IPL THEN LIST 'SYS1.HELPOPER(IPL)'
           ELSE IF &VAR = SHUTDOWN THEN LIST 'SYS1.HELPOPER(SHUTDOWN)'
           ELSE IF &VAR = STARTNET THEN LIST 'SYS1.HELPOPER(STARTNET)'
           /* MANY OTHER ENTRIES MAY BE PLACED HERE ...    */
           ELSE OSWTO   THERE IS NOT HELP FOR "&VAR"

           SET I = &I + 1
         END
         GOTO  ENDPROG

         CONFUSED: +
           OSWTOH ANSWER YES OR NO...
           GOTO STARTAGN

         TIMEDOUT: +
           OSWTO HELP FACILITY TIMING OUT - REINVOKE WHEN YOU HAVE MORE
           OSWTO TIME.
           GOTO  ENDPROG

         ENDPROG: +
           OSWTO GOODBYE.
           EXIT
./       ADD   NAME=EXCHKSPL
        PROC 0
        /***********************************************************/
        /* THIS CLIST WILL ISSUE A JES2 COMMAND TO DISPLAY TO      */
        /* SPOOL UTILIZATION. IF THE SPOOL UTILIZATION IS          */
        /* ABOVE 80%, THE CLIST WILL ISSUE A HILIGHTED MESSAGE     */
        /* TO THE OPERATOR. OTHERWISE, IT WILL ISSUE AN ORDINARY   */
        /* MESSAGE INDICATING HOW BUSY THE SPOOL IS. IT UTILIZES   */
        /* THE COMMAND TRAPPING FACILITIES IN TSSO 4.2             */
        /*                                                         */
        /***********************************************************/

        /*************************************************************/
        /* THE FIRST STEP IS THE SETTING OF MAXCMDOUT. SINCE THE     */
        /* EXPECTED COMMAND RESPONSE IS 3 LINES, WE SET MAXCMDOUT = 3*/
        /*************************************************************/
        SET MAXCMDOUT = 3


        /*************************************************************/
        /* NEXT, WE DECIDE HOW LONG THE CLIST SHOULD WAIT FOR THE    */
        /* COMMAND. 1 SECOND IS PLENTY FOR THIS JES COMMAND.         */
        /*************************************************************/
        SET CMDWAIT = 1


        /*************************************************************/
        /* NOW THAT THE TWO INPUT VARIABLES ARE SET UP, WE WILL      */
        /* ISSUE THE OSCMD COMMAND. THE RESPONSE WILL BE PLACED IN   */
        /* CLIST VARIABLES.                                          */
        /*************************************************************/
           OSCMD $DSPOOL

        /*************************************************************/
        /* THE EXPECTED COMMAND RESPONSE LOOKS LIKE THIS.            */
        /* $DSPOOL                                                   */
        /* $HASP646 XX PERCENT SPOOL UTILIZATION.
        /*                                                           */
        /* NOTE THAT LINE1 IS ALWAYS AN ECHO OF THE ORIGINAL COMMAND */
        /*************************************************************/

        /*************************************************************/
        /* IF WE DO NOT GET BACK AT LEAST 2 LINES OF RESPONSE, THEN  */
        /* AN ERROR HAS OCCURRED. WRITE A MESSAGE TO THE OPERATOR    */
        /* AND TERMINATE.                                            */
        /*************************************************************/
           IF &CMDOUT < 2 THEN +
           DO
             OSWTOH PROBLEM WITH THE CHKSPL COMMAND - CONTACT SUPPORT
             EXIT CODE(12)
           END

        /*************************************************************/
        /* ASSUMING EVERYTHING WENT OK WITH THE COMMAND, THE RESPONSE*/
        /* IS RETURNED IN THE SECOND WORD OF THE SECOND LINE OF THE  */
        /* MESSAGE. TSSO HAS ALREADY PARSED THE MESSAGE. WE PICK UP  */
        /* THE UTILIZATION.                                          */
        /*                                                           */
        /*************************************************************/
           SET UTIL = &CMDOUT2W2


        /*************************************************************/
        /* NOW, WE LOOK AT THE SPOOL UTILIZATION, AND DETERMINE IF   */
        /* IT IS GREATER THE 80%. IF SO, SEND A HILIGHTED MESSAGE.   */
        /*                                                           */
        /*************************************************************/
           IF &UTIL > 80 THEN +
           DO
              OSWTOH SPOOL UTILIZATION IS &UTIL - CONTACT JES2 SUPPORT
           END
           ELSE +
           DO
              OSWTO  SPOOL UTILIZATION IS &UTIL PERCENT.
           END
./       ADD   NAME=EXJOBS
         PROC 1 JNAME
        /*************************************************************/
        /* THIS CLIST WILL DISPLAY ALL JOBS THAT START WITH A GIVEN  */
        /* CHARACTER STRING. THE STRING IS PASSED TO THE CLIST AS A  */
        /* PARAMETER. THE CLIST WILL ISSUE A OSCMD $DN, AND SCAN THE */
        /* OUTPUT FOR JOBS THAT START WITH THE GIVEN STRING.         */
        /*************************************************************/

        SET MAXCMDOUT = 200
        /*************************************************************/
        /* WE WISH TO TRAP AS MANY LINES OF OUTPUT AS JES WOULD CARE */
        /* TO PROVIDE, THEREFORE, SET MAXCMDOUT TO THE MAX - 200     */
        /*************************************************************/

        SET CMDWAIT = 1
        /*************************************************************/
        /* THE JES COMMAND SHOULD ONLY TAKE 1 SECOND OR LESS, SO     */
        /* SET THE CMDWAIT VARIABLE TO 1.                            */
        /*************************************************************/

        OSCMD $DN,Q=XEQ
        /*************************************************************/
        /* ISSUE THE $DN JES COMMAND. THIS WILL POPULATE CLIST VARS  */
        /* WITH THE OUTPUT FROM THIS COMMAND.                        */
        /*************************************************************/

        /*************************************************************/
        /* SINCE THE OSCMD COMMAND ALWAYS RETURNS AN ECHO OF THE     */
        /* COMMAND AS THE FIRST LINE, START WITH THE SECOND LINE.    */
        /*************************************************************/
        SET I = 2
        SET COUNT = 0

        /*************************************************************/
        /* WE NEED TO LOOP BETWEEN THE SECOND LINE, AND THE "LAST"   */
        /* LINE, CONVIENTLY STORED IN &CMDOUT VARIABLE.              */
        /*************************************************************/
        DO WHILE (&I <= &CMDOUT - 1)
        /*************************************************************/
        /* NOTE THAT THE $DN RESPONSE INCLUDES THE SPOOL UTILIZATION */
        /* AS THE LAST LINE. WE WILL IGNORE IT.                      */
        /*************************************************************/

        SET LJNAME = &LENGTH(&JNAME)

        /*************************************************************/
        /* THE JOBNAME IS RETURNED IN THE SECOND WORD OF EACH LINE.  */
        /*************************************************************/
        SET JESJOB = &&CMDOUT&I.W2
        SET LJ = &LENGTH(&JESJOB)


        IF &LJ > &LJNAME THEN +
        DO
         IF &SUBSTR(1:&LJNAME,&JESJOB) = &JNAME THEN +
         DO
         /*************************************************************/
         /* WE HAVE FOUND A JOBNAME THAT STARTS WITH THE JOB. WE WILL */
         /* DISPLAY THE ENTIRE LINE.                                  */
         /*************************************************************/
            SET OUT = &STR(&&CMDOUT&I)
            WRITE &STR(&OUT)
            SET COUNT = &COUNT + 1
         END
        END

        SET I = &I + 1
        END

        WRITE &COUNT JOBS FOUND.
        EXIT CODE(0)
./       ADD   NAME=EXSTVTAM
            PROC 0
        /*************************************************************/
        /* THIS CLIST WILL START THE ADDRESS SPACES RELATING TO      */
        /* VTAM. THESE INCLUDE NCCF, VPS AND OMEGAMON. THIS CLIST    */
        /* IS NORMALLY KICKED OFF AT IPL TIME BY AN AOF TABLE ENTRY  */
        /* SUCH AS THE FOLLOWING                                     */
        /*                                                           */
        /*  TABENTRY MSG=IST020I,ACTION=OSCMD,TEXT=#STRTVTAM         */
        /*                                                           */
        /* THE IST020I MESSAGE IS FOR VTAM INITIALIZATION COMPLETED. */
        /*                                                           */
        /*                                                           */
        /*************************************************************/
        /*************************************************************/
        /* NOTE THAT WE ARE NOT INTERESTED IN GETTING THE RESPONSE   */
        /* BACK TO ANY OF THESE MVS COMMANDS. THEREFORE, WE DO NOT   */
        /* SET THE MAXCMDOUT OR CMDWAIT VARIABLES.                   */
        /*************************************************************/
            OSCMD $SLOGON1       /* START JES/VTAM CONNECT */

            OSCMD START TSO      /* START TSO              */

            OSCMD START NCCF     /* START NCCF             */

            OSCMD S OMVTAM,PREFIX='OMEGA.V652',APPL=OMR4


            OSCMD START GDDMPRT     /* START ADMPRT ADDRESS SPC */

            OSCMD START VPS         /* AND START VPS AS WELL    */
            OSPAUSE 5                     /* DELAY 5 SECONDS          */
            OSCMD VARY NET,ACT,ID=VPS     /* AND VARY IN TO VTAM      */
            OSWTOH IPL0004I NETWORKING ADDRESS SPACES HAVE BEEN
            OSWTOH IPL0004I (CONT) STARTED.
./       ADD   NAME=HKPRT
PROC 0
/******************************************************************/
/*  THIS CLIST IS USED EVERY EVENING (19:00) TO START HK PRINTERS */
/*  NORMALLY IT WILL BE EXCUTED BY AUOTA                          */
/******************************************************************/
/*  CONTROL LIST CONLIST SYMLIST     ***/
SET MAXCMDOUT = 10
SET CMDWAIT   = 1
REPLY MSG(JES328X) TEXT('S GEBP')
OSPAUSE 10
REPLY MSG(JES328X) TEXT('S ACAP')
OSPAUSE 10
REPLY MSG(JES328X) TEXT('S ACAQ')
OSPAUSE 10
REPLY MSG(JES328X) TEXT('S HLAP')
OSPAUSE 10
REPLY MSG(JES328X) TEXT('S UCAP')
OSPAUSE 10
REPLY MSG(JES328X) TEXT('S PCAP')
EXIT
./       ADD   NAME=HOTSTART
PROC 0
/******************************************************************/
/*  THIS CLIST IS USED EVERY MORNING TO HOT START JES2            */
/*                                                                */
/*  IT DOES FOLLOWING THINGS                                      */
/*  RUNS SHUTDOWN JOB                                             */
/*  SHUT DOWN JES328X/US328X                                      */
/*  BRINGS DOWN JES2                                              */
/*  RESTART JES2                                                  */
/*  RESTART SYSLOG                                                */
/*  START LINES (JESLNES)                                         */
/*  START JES328X/US328X                                          */
/******************************************************************/
/*  CONTROL LIST CONLIST SYMLIST     ***/
SET MAXCMDOUT = 10
SET CMDWAIT   = 1
OSCMD S SYSJOB,JOB=SHUTDOWN
REPLY MSG(JES328X) REPLY('P')
REPLY MSG(US328X) REPLY('P')
/* WAIT FOR JES328X AND US328X TO GO DOWN         */
SET I = 1
DO WHILE (&I <= 180)
  OSCMD D J,JES328X
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CHKUS8X
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH JES328X DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR HOT START
EXIT CODE (4)
CHKUS8X: +
SET I = 1
DO WHILE (&I <= 180)
  OSCMD D J,US328X
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO ENDJES2
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH US328X DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR HOT START
EXIT CODE (4)
ENDJES2: +
   SET MAXCMDOUT = 0
   OSCMD $PJES2,ABEND
   OSPAUSE 5
   REPLY MSG($HASP098) TEXT('EXIT')
   SET I = 1
   DO WHILE (&I <= 25)
      SET MAXCMDOUT = 5
      OSCMD D J,JES2
      SET STATUS1 = &CMDOUT5W2
      SET STATUS2 = &CMDOUT5W3
      IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO STARTJES
      OSPAUSE 5
      SET I = &I + 1
   END
OSWTOH JES2 DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR HOT START
EXIT CODE (4)
STARTJES: +
  SET MAXCMDOUT = 0
  OSCMD S JES2
  OSPAUSE 10
  REPLY MSG($HASP469) TEXT('END')
  OSPAUSE 25
  OSCMD W START
  OSPAUSE 5
  OSCMD S SYSJOB,JOB=JESLNES
  OSPAUSE 5
  OSCMD S JES328X
  OSPAUSE 5
  OSCMD S US328X
  OSPAUSE 50
  OSCMD #AUTOCMDS
  OSWTOH *** HOTSTART CLIST SUCCESSFULLY COMPLETED ***
EXIT CODE (0)
./       ADD   NAME=IEC701D
PROC 0
OSPAUSE 15
WRITE *COM #REPLY MESSAGE(IEC701D) TEXT('M')
END
./       ADD   NAME=IEF238D
PROC 0
WRITE *COM3 #REPLY MESSAGE(IEF238D) TEXT('WAIT')
END
./       ADD   NAME=IEF433D
PROC 0
WRITE *COM3 #REPLY MESSAGE(IEF433D) TEXT('NOHOLD')
END
./       ADD   NAME=IPLBASIC
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED BY AUTOA RIGHT AFTER AN IPL            */
/*                                                                */
/*  IT FIRST CHECKS IF NET IS ACTIVE. IF SO ASKS THE OPERATOR IF  */
/*  HE WANTS TO CONTINUE THE CLIST (SINCE NET BEING UP MAY MEAN   */
/*  SOMEBODY STARTED THIS CLIST ACCIDENTLY).                      */
/*  IT THEN PROMPTS THE OPERATOR TO START ANY SUBSYSTEMS REQUIRING*/
/*  SPECIAL STARTUP PROCEDURE E.G. NET, PCICS ETC. AND THE REPLY  */
/*  'GO'. ONCE OPERATOR REPLIES, THE CLIST STARTS REST OF THE     */
/*  SUBSYSTEMS IF THEY ARE NOT ALREADY STARTED.                   */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST  */
/* MAXIMUM OF 10 LINES EXPECTED FROM D J,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
/******************************************************************/
/*                                                                */
/* SEE IF NET IS ACTIVE. IF SO ASK OPERATOR IF HE WANTS TO PROCEED*/
/* BECAUSE THIS MAY MEAN ITS BEING STARTED BY MISTAKE.            */
/*                                                                */
/******************************************************************/
  OSCMD D J,NET
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CONTINUE
  ASK: +
  OSASK NET IS ALREADY UP...DO YOU WANT TO CONTINUE AUTOMATIC +
        STARTUP ? REPLY 'GO' TO CONTINUE 'CANCEL' TO STOP.
  IF &REPLY = GO THEN GOTO CONT2
  IF &REPLY = NOREPLY THEN GOTO ASK
  IF &REPLY ¬= CANCEL THEN GOTO ASK
  EXIT CODE(4)
/******************************************************************/
/*                                                                */
/* NOW ASK THE OPERATOR TO START NET IF IT NEEDS SPECIAL STARTUP  */
/*                                                                */
/******************************************************************/
CONTINUE: +
OSASK REPLY 'GO' IF NO SPECIAL STARTUP PROCEDURES FOR NET ELSE FIRST +
START NET AND THEN REPLY 'GO'
  IF &REPLY = GO THEN GOTO CONT1
  IF &REPLY = NOREPLY THEN GOTO CONTINUE
  IF &REPLY ¬= CANCEL THEN GOTO CONTINUE
  EXIT CODE(4)
/******************************************************************/
/*                                                                */
/* SEE IF OPERATOR STARTED NET. IF NOT START IT.                  */
/*                                                                */
/******************************************************************/
CONT1: +
  OSCMD D J,NET
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO STARTNET
  GOTO CONT2
/******************************************************************/
/*                                                                */
/* START NET                                                      */
/*                                                                */
/******************************************************************/
STARTNET: +
OSCMD S NET
/******************************************************************/
/*                                                                */
/* NOW START REST OF THE SUBSYSTEMS IT NOT ALREADY STARTED        */
/* FIRST WAIT FOR NET TO BE INITIALIZED                           */
/*                                                                */
/******************************************************************/
CONT2: +
OSPAUSE 60
OSCMD D J,DFHSM
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DFHSM
OSCMD S DFHSM
/******************************************************************/
DFHSM: +
OSPAUSE 60
OSCMD D J,UCOM
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO UCOM
OSCMD S UCOM
/******************************************************************/
UCOM: +
OSPAUSE 60
OSCMD D J,TSO
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO TSO
OSCMD S TSO
/******************************************************************/
TSO: +
OSCMD D J,NPA
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO NPA
OSCMD S NPA
/******************************************************************/
NPA: +
OSCMD D J,UCC7
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO UCC7
OSCMD S UCC7
/******************************************************************/
UCC7: +
OSCMD D J,NCCF
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO NCCF
OSCMD S NCCF
/******************************************************************/
NCCF: +
OSCMD D J,SIM3278
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO SIM3278
OSCMD S SIM3278
/******************************************************************/
SIM3278: +
OSCMD D J,SIMCAN
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO SIMCAN
OSCMD S SIMCAN
/******************************************************************/
SIMCAN: +
OSCMD D J,TPX
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO TPX
OSCMD S TPX
/******************************************************************/
TPX: +
OSCMD D J,PHOENIX
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PHOENIX
OSCMD S PHOENIX
/******************************************************************/
PHOENIX: +
OSCMD D J,OMEGAMON
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO OMEGAMON
OSCMD S OMEGAMON
OMEGAMON: +
OSWTOH *** IPLBASIC CLIST SUCCESSFULLY COMPLETED ***
EXIT CODE(0)
./       ADD   NAME=JESCMDS
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED BY DIFFERENT CLISTS E.G. STARTUP,      */
/*  AND ONLINES                                                   */
/*                                                                */
/*  IT ISSUES JES2 AUTOMATIC COMMANDS WHICH ARE ISSUED BASED      */
/*  ON TIME INTERVAL. ALL OTHER AUTOMATIC COMMANDS CAN BE ISSUED  */
/*  USING AUTOA                                                   */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* SHOULD TAKE LESS THAN 5 SEC FOR OS CMDS                        */
SET CMDWAIT   = 5
SET MAXCMDOUT = 0
/* WAIT FOR PANEXEC TO INITIALIZE                                 */
OSPAUSE 60
OSCMD $CA,ALL
OSCMD S VARYCONS
OSCMD S SYSJOB,JOB=INITD
OSPAUSE 10
/* OSCMD S SYSJOB,JOB=JESLNES  */
/* OSPAUSE 20                  */
OSCMD V C01,OFFLINE
OSCMD $TNUM,BASE=1
OSCMD $OQ,CANCEL,Q=T,A=0
OSCMD $OQ,CANCEL,Q=R,A=0
OSCMD $TA,I=0180,'$VS,''D T'''
OSCMD $TA,I=1800,'$RALL,R=R24,D=N5R1'
OSCMD $TA,I=0300,'$DQ,R=R0'
OSCMD $TA,I=0900,'$OT1-9999,Q=A,CANCEL'
OSCMD $TA,I=0900,'$DBUFDEF'
OSCMD $TA,I=0900,'$DCONDEF'
OSCMD $TA,I=0900,'$DJOBDEF'
OSCMD $TA,I=0900,'$DOUTDEF'
OSCMD $TA,I=0900,'$DSMFDEF'
OSCMD $TA,I=0900,'$DSPOOLDEF'
OSCMD $TA,I=0900,'$DTPDEF'
OSCMD $TA,I=3600,'$VS,''S SYSJOB,JOB=SVCDUMP'''
OSCMD V C01,ONLINE
./       ADD   NAME=J328XPRT
PROC 0 RMT('DUMMY')
/******************************************************************/
/*  THIS CLIST STARTS THE REMOTE SPECIFIED BY REPLYING TO         */
/*  JES328X AND US328X OUTSTANDING REPLIES                        */
/*                                                                */
/*  IT IS CALLED BY NCCF CLIST IST486I FOR REMOTES IN CONNECTIBLE */
/*  STATUS .                                                      */
/*                                                                */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
IF .&RMT = . THEN GOTO -TELL
     REPLY MSGID(JES328X) TEXT('S &RMT')
     REPLY MSGID(US328X) TEXT('S &RMT')
     OSPAUSE 7
EXIT CODE (0)
TELL: +
OSWTO THE CORRECT FORMAT OF THE COMMAND IS J328XPRT RMT(XXXX)
EXIT CODE(4)
./       ADD   NAME=NONLINES
PROC 0
/******************************************************************/
/*  SLIMMED DOWN VERSION OF ONLINES JUST TO TEST OUT ACF2 REPLY   */
/*  TO CICS STARTUP.                                              */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 10 LINES EXPECTED FROM D J,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
/******************************************************************/
/*                                                                */
/* ASK THE OPERATOR FOR PERMISSION TO PROCEED. HE MAY NOT BE      */
/* READY TO BRING UP ONLINES.                                     */
/*                                                                */
/******************************************************************/
ASK: +
OSASK REPLY 'GO' TO START ONLINES NOW ELSE REPLY 'CANCEL' ,YOU CAN +
START ANY ONLINES WITH SPECIAL STARTUP BEFORE REPLYING.
  IF &REPLY = GO THEN GOTO CONTINUE
  IF &REPLY = NOREPLY THEN GOTO ASK
  IF &REPLY ¬= CANCEL THEN GOTO ASK
  EXIT CODE(4)
/******************************************************************/
/*                                                                */
/* NOW START REST OF THE SUBSYSTEMS IT NOT ALREADY STARTED        */
/*                                                                */
/******************************************************************/
CONTINUE: +
/******************************************************************/
OSCMD D J,PCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO FINISH
OSCMD S PRODCICS
OSPAUSE 10
/* REPLY TO THE PASSWORD PROMPT                                   */
REPLY MSG(ACFAE098) TEXT('GO')
FINISH: +
OSPAUSE 5
/******************************************************************/
OSWTOH *** ONLINES CLIST SUCCESSFULLY COMPLETED ***
EXIT CODE(0)
./       ADD   NAME=OMEGAON
PROC 0
WRITE *COM5 S OMEGAMON
WRITE *COM1 F OMEGAMON,S CN,LROWS=96,UNIT=81D
WRITE *COM5 V NET,INACT,ID=H01N806
WRITE *COM5 V 806,OFFLINE
WRITE *COM5 S DEALLOC
WRITE *COM5 V 806,ONLINE
WRITE *COM5 F OMEGAMON,S CN,LROWS=96,UNIT=806
END
./       ADD   NAME=OMEGATAP
PROC 0
WRITE *COM9 V NET,INACT,ID=H01N806
WRITE *COM9 V 806,OFFLINE
WRITE *COM9 S DEALLOC
WRITE *COM9 F OMEGAMON,S CN,LROWS=96,UNIT=806
END
./       ADD   NAME=ONLINES
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED BY AUTOA ON WEEK DAYS AT 06:30 AND     */
/*  AFTER AN IPL                                                  */
/*                                                                */
/*  FIRST IT ASKS THE OPERATOR PERMISSION TO PROCEED.             */
/*  THEN IT STARTS THE IDMS'S AND CICS'S                          */
/******************************************************************/
/*  MAR 16, 19876 -->  AUTOSTART DPVCICS                          */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 10 LINES EXPECTED FROM D J,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
/******************************************************************/
/*                                                                */
/* ASK THE OPERATOR FOR PERMISSION TO PROCEED. HE MAY NOT BE      */
/* READY TO BRING UP ONLINES.                                     */
/*                                                                */
/******************************************************************/
ASK: +
OSASK REPLY 'GO' TO START ONLINES NOW ELSE REPLY 'CANCEL' ,YOU CAN +
START ANY ONLINES WITH SPECIAL STARTUP BEFORE REPLYING.
  IF &REPLY = GO THEN GOTO CONTINUE
  IF &REPLY = NOREPLY THEN GOTO ASK
  IF &REPLY ¬= CANCEL THEN GOTO ASK
  EXIT CODE(4)
/******************************************************************/
/*                                                                */
/* NOW START REST OF THE SUBSYSTEMS IT NOT ALREADY STARTED        */
/*                                                                */
/******************************************************************/
CONTINUE: +
OSCMD D J,PIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PIDMS
OSCMD S IDMS
PIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO USIDMS
OSCMD S STUSIDMS
USIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USTRIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO USTRIDMS
OSCMD S USTRIDMS
USTRIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,DIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DIDMS
OSCMD S DVLPIDMS
DIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,DCIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DCIDMS
OSCMD S DCIDMS
DCIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PCIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PCIDMS
OSCMD S PCIDMS
PCIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PPIFMISA
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO ISA
OSCMD S ISA
ISA: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO ULVLCICS
OSCMD S ULVLCICS
ULVLCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USTRCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO USTRCICS
OSCMD S USTRCICS
USTRCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,DCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DVLPCICS
OSCMD S DVLPCICS
DVLPCICS: +
OSPAUSE 30
/******************************************************************/
OSCMD D J,DCANCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DCACICS
OSCMD S DCACICS
DCACICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PCANCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PCACICS
OSCMD S PCACICS
PCACICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PRODCICS
OSCMD S PRODCICS
PRODCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,TPVCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO TPVCICS
OSCMD S TPVCICS
TPVCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,DPVCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DPVCICS
OSCMD S DPVCICS
DPVCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,NCCF
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO NCCF
OSCMD S NCCF
NCCF: +
OSWTOH *** ONLINES CLIST SUCCESSFULLY COMPLETED ***
EXIT CODE(0)
./       ADD   NAME=ONLINESX
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED BY AUTOA ON WEEK DAYS AT 06:30 AND     */
/*  AFTER AN IPL                                                  */
/*                                                                */
/*  FIRST IT ASKS THE OPERATOR PERMISSION TO PROCEED.             */
/*  THEN IT STARTS THE IDMS'S AND CICS'S                          */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 10 LINES EXPECTED FROM D J,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
/******************************************************************/
/*                                                                */
/* ASK THE OPERATOR FOR PERMISSION TO PROCEED. HE MAY NOT BE      */
/* READY TO BRING UP ONLINES.                                     */
/*                                                                */
/******************************************************************/
ASK: +
OSASK REPLY 'GO' TO START ONLINES NOW ELSE REPLY 'CANCEL' ,YOU CAN +
START ANY ONLINES WITH SPECIAL STARTUP BEFORE REPLYING.
  IF &REPLY = GO THEN GOTO CONTINUE
  IF &REPLY = NOREPLY THEN GOTO ASK
  IF &REPLY ¬= CANCEL THEN GOTO ASK
  EXIT CODE(4)
/******************************************************************/
/*                                                                */
/* NOW START REST OF THE SUBSYSTEMS IT NOT ALREADY STARTED        */
/*                                                                */
/******************************************************************/
CONTINUE: +
OSCMD D J,PIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PIDMS
OSCMD S IDMS
PIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO USIDMS
OSCMD S STUSIDMS
USIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USTRIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO USTRIDMS
OSCMD S USTRIDMS
USTRIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,DIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DIDMS
OSCMD S DVLPIDMS
DIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,DCIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DCIDMS
OSCMD S DCIDMS
DCIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PCIDMS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PCIDMS
OSCMD S PCIDMS
PCIDMS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PPIFMISA
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO ISA
OSCMD S ISA
ISA: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO ULVLCICS
OSCMD S ULVLCICS
ULVLCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,USTRCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO USTRCICS
OSCMD S USTRCICS
USTRCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,DCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DVLPCICS
OSCMD S DVLPCICS
DVLPCICS: +
OSPAUSE 30
/******************************************************************/
OSCMD D J,DCANCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO DCACICS
OSCMD S DCACICS
DCACICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PCANCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PCACICS
OSCMD S PCACICS
PCACICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,PCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO PRODCICS
OSCMD S PRODCICS
PRODCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,TPVCICS
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO TPVCICS
OSCMD S TPVCICS
TPVCICS: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,NCCF
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO NCCF
OSCMD S NCCF
NCCF: +
OSWTOH *** ONLINES CLIST SUCCESSFULLY COMPLETED ***
EXIT CODE(0)
./       ADD   NAME=PCIDMS
PROC 0
/******************************************************************/
/*  THIS CLIST AUTOMATICALLY REPLIES TO THE OUTSTANDING REPLY     */
/*  FOR PCIDMS. NORMALLY THIS WILL BE EXECUTED BY AUTO AT         */
/*  PREDEFINED TIME (18:30). THE PROCESSING INVOLVES ISSUEING     */
/*  'D R,L' COMMAND AND SCANNING THE OUTPUT FOR THE PCIDMS        */
/*  VERSION ID V11. IT THEN REPLIES 'SHUTDOWN' FOR THAT REPLY ID. */
/*                                                                */
/*  MAINTENANCE LOG                                               */
/*  ===============                                               */
/*  WHO      WHEN                     WHAT                        */
/*  ---      ----                     ----                        */
/*                                                                */
/*  MIKEW    JAN 12/86   ADD PROMPT TO CHECK FOR EXTENDED HOURS   */
/*                       AND TRIGGER FOR UCC7                     */
/******************************************************************/
/* SET TO MAX TO GET ALL OUTSTANDING REPLIES                      */
SET MAXCMDOUT = 200
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
OSCMD D R,L
/* IGNORE FIRST 4 LINES FROM D R,L                                */
SET I = 5
/* SCAN THRU REST OF RESPONSE LINES                               */
DO WHILE (&I <= &CMDOUT)
/* GET NUMBER OF WORDS IN THE REPLY                               */
SET WORDS =  &&CMDOUT&I.W
/* TEST FOR PCIDMS ONLY IF >= 9 WORDS                             */
IF &WORDS >= 9  THEN +
  DO
/* GET VERSION NUMBER                                             */
  SET VERSION = &&CMDOUT&I.W9
  SET PGM     = &&CMDOUT&I.W8
/* IS IT PCIDMS ??                                                */
  IF &STR(&VERSION) = &STR(V11) AND &STR(&PGM) = &STR(IDMS) THEN +
      DO
      SET REPLYID = &&CMDOUT&I.W1
      SET MAXCMDOUT = 0
ASK: +
      OSASK ARE THERE EXTENDED HOURS FOR PCIDMS TODAY? +
        REPLY 'YES' TO KEEP UP OR 'NO' TO SHUTDOWN.
      IF &REPLY = YES THEN +
         DO
         OSWTO PCIDMS IS BEING LEFT UP
         EXIT CODE (0)
         END
      IF &REPLY = NOREPLY THEN GOTO ASK
      OSCMD R &REPLYID,SHUTDOWN
      OSPAUSE 60
      OSCMD S PCIDMSTR
      OSPAUSE 10
      OSWTO UCC7 TRIGGER JOB PCIDMSTR HAS BEEN STARTED
      EXIT CODE(0)
      END
  END
SET I = &I + 1
END
OSWTOH PCIDMS IS NOT ACTIVE
EXIT CODE(0)
./       ADD   NAME=RMTMSG
PROC 2 JOBN DEVICE
SET &D = &STR(&SYSDATE)
SET &T = &STR(&SYSTIME)
WRITE *COM SEND '&JOBN ON &DEVICE. &D AT &T',USER=(JIMLANE),LOGON
IF &DEVICE = &STR(R176.PR1) THEN WRITE *COM $SR176.PR1
IF &DEVICE = &STR(R143.PR1) THEN WRITE *COM $SR143.PR1
END
./       ADD   NAME=RMTSET
PROC 1 DEVICE
IF &DEVICE = &STR(R176.PR1) THEN DO
 WRITE *COM $SR176.PR1
END
IF &DEVICE = &STR(R143.PR1) THEN DO
 WRITE *COM $SR143.PR1
END
IF &DEVICE = &STR(R190.PR1) THEN DO
 WRITE *COM $SR190.PR1
END
IF &DEVICE = &STR(R193.PR1) THEN DO
 WRITE *COM $SR193.PR1
END
IF &DEVICE = &STR(R194.PR1) THEN DO
 WRITE *COM $SR194.PR1
END
END
./       ADD   NAME=RMTSTART
PROC 0 RMT()
OSPAUSE 2
IF &RMT = &STR(176) THEN DO
 WRITE *COM #REPLY MSG(JES328X) TEXT('SRMT176')
END
IF &RMT = &STR(143) THEN DO
 WRITE *COM #REPLY MSG(JES328X) TEXT('SRMT143')
END
IF &RMT = &STR(190) THEN DO
 WRITE *COM #REPLY MSG(JES328X) TEXT('SRMT190')
END
IF &RMT = &STR(193) THEN DO
 WRITE *COM #REPLY MSG(JES328X) TEXT('SRMT193')
END
IF &RMT = &STR(194) THEN DO
 WRITE *COM #REPLY MSG(JES328X) TEXT('SRMT194')
END
END
./       ADD   NAME=SHUTCICS
PROC 0 VERSION('DCANCICS')
/******************************************************************/
/*  THIS CLIST AUTOMATICALLY SHUTS DOWN THE VERSION OF CICS       */
/*  SPECIFIED AS PARAMETER.                                       */
/*                                                                */
/*  IT IS AUTOMATICALLY EXECUTED BY AUTOA AT 21:00 DAILY FOR      */
/*  PCANCICS AND AT 22:00 FOR DCANCICS                            */
/*                                                                */
/*  1. CHECKS IF SPECIFIED CICS IS ACTIVE                         */
/*  2. IF ACTIVE LOGON ON TO IT AND SHUT IT DOWN                  */
/*                                                                */
/*  MAINTENANCE LOG                                               */
/*  ===============                                               */
/*  WHO      WHEN                     WHAT                        */
/*  ---      ----                     ----                        */
/*                                                                */
/*  MIKEW    JAN 12/86   ADD TRIGGER FOR UCC7                     */
/*                                                                */
/*  MIKEW    FEB 17/87   CHANGE LOGONID AND PASSWORD TO CICSOPER  */
/*                                                                */
/*  PK       APR 01/87   DECREASE WAIT TIME TO AVOID TIEING UP    */
/*                       TSSO ADDRESS SPACE.                      */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 10 LINES EXPECTED FROM D J,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
IF .&VERSION = . THEN GOTO TELL
SET OPERID  = CICSOPER
SET PWD     = CICSOPER
IF &VERSION = DCICS THEN DO
                     SET TRIGGER = DCICSTR
                     GOTO SHUT
                     END
SHUT: +
OSCMD D J,&VERSION
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO NOTUP
   DO
      SET MAXCMDOUT = 0
      OSCMD F &VERSION,CSSF BYE
      OSPAUSE 5
      OSCMD F &VERSION,CSSN &OPERID
      OSPAUSE 7
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('&PWD')
      OSPAUSE 7
      OSCMD F &VERSION,CEMT PER SHUT IMM
      OSPAUSE 5
      OSWTO &VERSION HAS BEEN SHUT DOWN
IF .&TRIGGER = . THEN GOTO ENDJOB
/* DONT START TRIGGER JOB IF TRIGGER HAS NOT BEEN SET             */
      OSCMD S &TRIGGER
      OSPAUSE 5
      OSWTO UCC7 TRIGGER JOB &TRIGGER FOR &VERSION HAS BEEN STARTED
      EXIT CODE(0)
   END
NOTUP: +
OSWTO &VERSION IS ALREADY DOWN
EXIT CODE(0)
TELL: +
OSWTO THE CORRECT FORMAT OF THE COMMAND IS SHUTCICS VERSION(XXXX)
EXIT CODE(4)
ENDJOB: +
EXIT CODE(0)
./       ADD   NAME=SHUTCICX
PROC 0 VERSION('DCANCICS')
/******************************************************************/
/*  THIS CLIST AUTOMATICALLY SHUTS DOWN THE VERSION OF CICS       */
/*  SPECIFIED AS PARAMETER.                                       */
/*                                                                */
/*  IT IS AUTOMATICALLY EXECUTED BY AUTOA AT 21:00 DAILY FOR      */
/*  PCANCICS AND AT 22:00 FOR DCANCICS                            */
/*                                                                */
/*  1. CHECKS IF SPECIFIED CICS IS ACTIVE                         */
/*  2. IF ACTIVE LOGON ON TO IT AND SHUT IT DOWN                  */
/*                                                                */
/*  MAINTENANCE LOG                                               */
/*  ===============                                               */
/*  WHO      WHEN                     WHAT                        */
/*  ---      ----                     ----                        */
/*                                                                */
/*  MIKEW    JAN 12/86   ADD TRIGGER FOR UCC7                     */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 10 LINES EXPECTED FROM D J,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
IF .&VERSION = . THEN GOTO TELL
IF &VERSION = PCANCICS THEN DO
                     SET OPERID = PCANOP
                     SET PWD    = PCANOP
                     GOTO SHUT
                     END
IF &VERSION = DCANCICS THEN DO
                     SET OPERID = DCANOP
                     SET PWD    = DCANOP
                     GOTO SHUT
                     END
IF &VERSION = PCICS THEN DO
                     SET OPERID  = PCICS
                     SET PWD     = PCICS
                     SET TRIGGER = PCICSTR
                     GOTO SHUT
                     END
IF &VERSION = DCICS THEN DO
                     SET OPERID  = DCICS
                     SET PWD     = DCICS
                     SET TRIGGER = DCICSTR
                     GOTO SHUT
                     END
IF &VERSION = USCICS THEN DO
                     SET OPERID  = USCICS
                     SET PWD     = USCICS
                     GOTO SHUT
                     END
IF &VERSION = TPVCICS THEN DO
                     SET OPERID  = CICSOPER
                     SET PWD     = CICSOPER
                     GOTO SHUT
                     END
SHUT: +
OSCMD D J,&VERSION
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO NOTUP
   DO
      SET MAXCMDOUT = 0
      OSCMD F &VERSION,CSSF BYE
      OSPAUSE 5
      OSCMD F &VERSION,CSSN &OPERID
      OSPAUSE 10
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('&PWD')
      OSPAUSE 10
      OSCMD F &VERSION,CEMT PER SHUT IMM
      OSPAUSE 60
      OSWTO &VERSION HAS BEEN SHUT DOWN
      OSCMD S &TRIGGER
      OSPAUSE 10
      OSWTO UCC7 TRIGGER JOB &TRIGGER FOR &VERSION HAS BEEN STARTED
      EXIT CODE(0)
   END
NOTUP: +
OSWTO &VERSION IS ALREADY DOWN
EXIT CODE(0)
TELL: +
OSWTO THE CORRECT FORMAT OF THE COMMAND IS SHUTCICS VERSION(XXXX)
EXIT CODE(4)
./       ADD   NAME=SHUTDOWN
PROC 0
/******************************************************************/
/*  THIS CLIST AUTOMATICALLY SHUTS DOWN MOST OF THE ACTIVE TASKS  */
/*  IN THE SYSTEM. FOLLOWING TASKS ARE SHUT DOWN.                 */
/*                                                                */
/*  1. SEND SHUTDOWN MESSAGE TO TSO USERS                         */
/*  2. STOP JES328X, US328X                                       */
/*  3. CHECK IF ISA IS STILL UP, IF SO ASK OPERATOR TO SHUT IT    */
/*  4. CHECK IF UCC7 IS STILL UP, IF SO ASK OPERATOR TO SHUT IT   */
/*  5. SEND SHUTDOWN MESSAGE TO TSO USERS                         */
/*  6. IF DCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN         */
/*  7. IF PCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN         */
/*  8. IF USCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN        */
/*  9. IF DCANCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN      */
/*  9. IF PCANCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN      */
/* 10. SHUTDOWN SIM3278, SIMCAN, PHOENIX, TSO, NPA                */
/* 11. GOES THRU OUTSTANDING REPLIES TO SHUTDOWN FOLLOWING        */
/*     REPLY U TO DCICS BACKUP MESSAGE                            */
/*     SHUT DOWN ALL VERSIONS OF IDMS                             */
/*     SHUTDOWN NCCF                                              */
/*     SHUTDOWN UCOM                                              */
/* 12. S SYSJOB SHUTDOWN TO DRAIN LINES                           */
/* 13. STOP PHOENIX AGAIN                                         */
/* 14. CHECK IF DCICS DOWN. IF NOT WAIT FOR 8 MINUTES AND ABORT   */
/* 15. STOP TLMSII                                                */
/* 16. REPLY TO ANY OUTSTANDING TSO MESSAGE                       */
/* 17. WAIT FOR 10 SEC AND REPLY TO TLMSII SHUTDOWN MESSAGE       */
/* 18. REPLY TO ANY OUTSTANDING TSO MESSAGE                       */
/* 19. WAIT FOR UPTP 30 MINUTES FOR JES328X AND US328X TO GO DOWN */
/*     OTHERWISE EXIT THE CLIST WITH A MESSAGE                    */
/* 20. SHUTDOWN NET, TM, RMF, AUTOA, OMEGAMON                     */
/* 21. WAIT FOR UPTO 30 MINUTES FOR NET TO COME DOWN, ELSE ABORT  */
/* 22. SHUTDOWN LLA, ACF2, AND TSSO IF THERE ARE NO JOBS RUNNING  */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 50 LINES EXPECTED FROM D R,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET MAXCMDOUT = 50
SET CMDWAIT   = 1
/* FIRST SEND MESSAGE TO TSO USERS SAYING SYSTEM IS DOWN....      */
OSCMD SEND '*** SYSTEM GOING DOWN.. PLEASE LOGOFF IMMEDIATELY ***'
/* FIRST SHUT DOWN JES328X AND US328X                             */
OSWTO SHUTTING DOWN JES328X AND US328X
REPLY MSG(JES328X) TEXT('P')
REPLY MSG(US328X) TEXT('P')
/* TEST IF ISA IS UP. IF IT IS, ASK OPERATOR TO SHUT IT DOWN      */
OSWTO CHECKING ISA
SET MAXCMDOUT = 10
OSCMD D J,PPIFMISA
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &CMDOUT5W3
IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CHKUCC7
   DO
   ASK: +
   OSASK  PLEASE BRING DOWN ISA AND REPLY 'GO' TO CONTINUE SHUTDOWN +
          OR REPLY 'CANCEL' TO CANCEL SHUTDOWN
      IF &REPLY = GO THEN GOTO CHKUCC7
      IF &REPLY = NOREPLY THEN GOTO ASK
      IF &REPLY ¬= CANCEL THEN GOTO ASK
      EXIT CODE (4)
   END
/* NOW CHECK IF UCC7 IS UP. IF IT IS ASK OPERATOR TO SHUT IT DOWN */
CHKUCC7: +
OSWTO CHECKING UCC7
OSCMD D J,UCC7
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &CMDOUT5W3
IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CHKDCICS
   DO
   ASK1: +
   OSASK  PLEASE BRING DOWN UCC7 AND REPLY 'GO' TO CONTINUE SHUTDOWN +
          OR REPLY 'CANCEL' TO CANCEL SHUTDOWN
      IF &REPLY = GO THEN GOTO CHKDCICS
      IF &REPLY = NOREPLY THEN GOTO ASK1
      IF &REPLY ¬= CANCEL THEN GOTO ASK1
      EXIT CODE (4)
   END
/* SEND MESSAGE TO TSO USERS SAYING SYSTEM IS DOWN....            */
OSCMD SEND '*** SYSTEM GOING DOWN.. PLEASE LOGOFF IMMEDIATELY ***'
/* NOW CHECK IF DCICS IS UP. IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKDCICS: +
OSWTO CHECKING DCICS
SET MAXCMDOUT = 10
OSCMD D J,DCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKPCICS
   DO
      SET MAXCMDOUT = 0
      OSCMD F DCICS,CSSN DCICS
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('DCICS')
      OSPAUSE 5
      OSCMD F DCICS,CEMT PER SHUT IMM
      OSPAUSE 35
   END
/* NOW CHECK IF PCICS IS UP. IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKPCICS: +
OSWTO CHECKING PCICS
OSCMD D J,PCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKUCICS
   DO
      SET MAXCMDOUT = 0
      OSCMD F PCICS,CSSN PCICS
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('PCICS')
      OSPAUSE 10
      OSCMD F PCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF USCICS IS UP. IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKUCICS: +
OSWTO CHECKING USCICS
SET MAXCMDOUT = 10
OSCMD D J,USCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKTCICS
   DO
      SET MAXCMDOUT = 0
      OSCMD F USCICS,CSSN USCICS
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('USCICS')
      OSPAUSE 10
      OSCMD F USCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF USTRCICS IS UP. IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKTCICS: +
OSWTO CHECKING USTRCICS
SET MAXCMDOUT = 10
OSCMD D J,USTRCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKDCAN
   DO
      SET MAXCMDOUT = 0
      OSCMD F USTRCICS,CSSN CICSOPER
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('CICSOPER')
      OSPAUSE 10
      OSCMD F USTRCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF DCCACICS IS UP.IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKDCAN: +
OSWTO CHECKING DCANCICS
SET MAXCMDOUT = 10
OSCMD D J,DCANCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKTPV
   DO
      SET MAXCMDOUT = 0
      OSCMD F DCANCICS,CSSN DCANOP
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('DCANOP')
      OSPAUSE 10
      OSCMD F DCANCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF TPVCICS IS UP.IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKTPV: +
OSWTO CHECKING TPVCICS
SET MAXCMDOUT = 10
OSCMD D J,TPVCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKPCAN
   DO
      SET MAXCMDOUT = 0
      OSCMD F TPVCICS,CSSN CICSOPER
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('CICSOPER')
      OSPAUSE 10
      OSCMD F TPVCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF PCANCICS IS UP.IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKPCAN: +
OSWTO CHECKING PCANCICS
SET MAXCMDOUT = 10
OSCMD D J,PCANCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO SHUTSIM
   DO
      SET MAXCMDOUT = 0
      OSCMD F PCANCICS,CSSN PCANOP
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('PCANOP')
      OSPAUSE 10
      OSCMD F PCANCICS,CEMT PER SHUT IMM
   END
/* NOW SHUTDOWN SIM3278 AND SIMCAN                                */
SHUTSIM: +
OSWTO SHUTTING SIM3278 AND SIMCAN
OSCMD F SIM3278,HALT,IMMED
OSCMD F SIMCAN,HALT,IMMED
/* NOW SHUTDOWN TSO AND NPDA AND PHOENIX                          */
OSCMD P PHOENIX
OSCMD P DFHSM
OSCMD P TSO
OSCMD P NPA
OSPAUSE 10
/* NOW GO THRU OUTSTANDING REPLIES TO SHUTDOWN                    */
/* IDMS, NCCF, UCOM, AND DCICS                                    */
OSWTO REPLYING TO IDMS, NCCF, UCOM DCICS
SET MAXCMDOUT = 50
OSCMD D R,L
SET I = 5
DO WHILE (&I <= &CMDOUT)
SET WORDS =  &&CMDOUT&I.W
IF &WORDS >= 4  THEN +
   DO
/* GET APPLICATION NAME                                           */
     SET APPL  = &&CMDOUT&I.W4
/* IS IT DCICS BACKUP MESSAGE ?                                   */
     IF &STR(&APPL) = &STR(DCICS) THEN +
        DO
           SET REPLYID = &&CMDOUT&I.W1
           SET MAXCMDOUT = 0
           OSCMD R &REPLYID,Y
        END
/* IS IT IDMS ??                                                  */
     IF &STR(&APPL) = &STR(REPLY) THEN +
        DO
           SET REPLYID = &&CMDOUT&I.W1
           SET MAXCMDOUT = 0
           OSCMD R &REPLYID,SHUTDOWN
        END
/* IS IT NCCF  ??                                                 */
     IF &STR(&APPL) = &STR(DSI802A) THEN +
        DO
          SET REPLYID = &&CMDOUT&I.W1
          SET MAXCMDOUT = 0
          OSCMD R &REPLYID,CLOSE
        END
/* IS IT UCOM  ??                                                 */
     IF &STR(&APPL) = &STR(UCC7.574) THEN +
        DO
          SET REPLYID = &&CMDOUT&I.W1
          SET MAXCMDOUT = 0
          OSCMD R &REPLYID,STOP
        END
  END
SET I = &I + 1
END
/* SUBMIT JES2 COMMANDS DRAIN LINES AND PRINTERS                  */
OSWTO RUNNING SHUTDOWN JOB
OSCMD S SYSJOB,JOB=SHUTDOWN
OSPAUSE 5
OSCMD P PHOENIX
OSCMD C JMXWTR
/* NOW CHECK IF DCICS IS DOWN                                     */
SET I = 1
DO WHILE (&I <= 100)
  SET MAXCMDOUT = 10
  OSCMD D J,DCICS
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &STR(&CMDOUT5W3)
  IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO STOPTLMS
  OSPAUSE 5
  SET I = &I + 1
END
OSWTOH DCICS DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
/* NOW O M S MESSAGES, IF ANY                                     */
STOPTLMS: +
REPLY MSG(CADO011D) TEXT('P TLMSII')
REPLY MSG(IKT010D) TEXT('FSTOP')
OSPAUSE 10
REPLY MSG(CADO017D) TEXT('X')
/* NOW REPLY TO TSO MESSAGE                                       */
REPLY MSG(IKT012D) TEXT('U')
/* NOW SHUTDOWN NET IF JES328X AND US328X IS DOWN                 */
SET I = 1
DO WHILE (&I <= 180)
  SET MAXCMDOUT = 10
  OSCMD D J,JES328X
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CHKUS8X
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH JES328X DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
CHKUS8X: +
SET I = 1
DO WHILE (&I <= 180)
  OSCMD D J,US328X
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO STOPNET
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH US328X DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
STOPNET: +
OSWTO SHUTTING DOWN NET
OSCMD Z NET
/* NOW SHUTDOWN TM, RMF, AUTOA, OMEGAMON                          */
OSWTO SHUTTING DOWN TM ETC
OSCMD P TM
OSCMD P RMF.RMF
OSCMD P AUTOA.A
OSCMD P OMEGAMON
/* NOW SHUTDOWN LLA AND ACF2 IF NET IS DOWN                       */
SET I = 1
DO WHILE (&I <= 120)
  SET MAXCMDOUT = 10
  OSCMD D J,NET
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO STOPACF2
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH NET DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
/* NOW SHUTDOWN  LLA, ACF2 AND TSSO IF THERE ARE NO ACTIVE JOBS  */
STOPACF2: +
    OSCMD D J,L
    SET NUMOFJOB = &CMDOUT4W1
    IF &NUMOFJOB ¬= 0 THEN +
    DO
       OSWTOH SOME JOBS ARE STILL RUNNING
       OSWTOH PLEASE STOP ACF2 AND LLA AFTER ALL JOBS ARE FINISHED
       EXIT CODE (4)
    END
OSWTO SHUTTTING DOWN LLA AND ACF2
OSCMD P LLA
OSCMD P ACF2
OSWTOH *** SHUTDOWN SUCCESSFULLY COMPLETED ***
OSPAUSE 5
OSCMD #.P
EXIT CODE(0)
./       ADD   NAME=SHUTDOWX
PROC 0
/******************************************************************/
/*  THIS CLIST AUTOMATICALLY SHUTS DOWN MOST OF THE ACTIVE TASKS  */
/*  IN THE SYSTEM. FOLLOWING TASKS ARE SHUT DOWN.                 */
/*                                                                */
/*  1. SEND SHUTDOWN MESSAGE TO TSO USERS                         */
/*  2. STOP JES328X, US328X                                       */
/*  3. CHECK IF ISA IS STILL UP, IF SO ASK OPERATOR TO SHUT IT    */
/*  4. CHECK IF UCC7 IS STILL UP, IF SO ASK OPERATOR TO SHUT IT   */
/*  5. SEND SHUTDOWN MESSAGE TO TSO USERS                         */
/*  6. IF DCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN         */
/*  7. IF PCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN         */
/*  8. IF USCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN        */
/*  9. IF DCANCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN      */
/*  9. IF PCANCICS IS ACTIVE LOGON ON TO IT AND SHUT IT DOWN      */
/* 10. SHUTDOWN SIM3278, SIMCAN, PHOENIX, TSO, NPA                */
/* 11. GOES THRU OUTSTANDING REPLIES TO SHUTDOWN FOLLOWING        */
/*     REPLY U TO DCICS BACKUP MESSAGE                            */
/*     SHUT DOWN ALL VERSIONS OF IDMS                             */
/*     SHUTDOWN NCCF                                              */
/*     SHUTDOWN UCOM                                              */
/* 12. S SYSJOB SHUTDOWN TO DRAIN LINES                           */
/* 13. STOP PHOENIX AGAIN                                         */
/* 14. CHECK IF DCICS DOWN. IF NOT WAIT FOR 8 MINUTES AND ABORT   */
/* 15. STOP TLMSII                                                */
/* 16. REPLY TO ANY OUTSTANDING TSO MESSAGE                       */
/* 17. WAIT FOR 10 SEC AND REPLY TO TLMSII SHUTDOWN MESSAGE       */
/* 18. REPLY TO ANY OUTSTANDING TSO MESSAGE                       */
/* 19. WAIT FOR UPTP 30 MINUTES FOR JES328X AND US328X TO GO DOWN */
/*     OTHERWISE EXIT THE CLIST WITH A MESSAGE                    */
/* 20. SHUTDOWN NET, TM, RMF, AUTOA, OMEGAMON                     */
/* 21. WAIT FOR UPTO 30 MINUTES FOR NET TO COME DOWN, ELSE ABORT  */
/* 22. SHUTDOWN LLA, ACF2, AND TSSO IF THERE ARE NO JOBS RUNNING  */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 50 LINES EXPECTED FROM D R,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET MAXCMDOUT = 50
SET CMDWAIT   = 1
/* FIRST SEND MESSAGE TO TSO USERS SAYING SYSTEM IS DOWN....      */
OSCMD SEND '*** SYSTEM GOING DOWN.. PLEASE LOGOFF IMMEDIATELY ***'
/* FIRST SHUT DOWN JES328X AND US328X                             */
OSWTO SHUTTING DOWN JES328X AND US328X
REPLY MSG(JES328X) TEXT('P')
REPLY MSG(US328X) TEXT('P')
/* TEST IF ISA IS UP. IF IT IS, ASK OPERATOR TO SHUT IT DOWN      */
OSWTO CHECKING ISA
SET MAXCMDOUT = 10
OSCMD D J,PPIFMISA
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &CMDOUT5W3
IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CHKUCC7
   DO
   ASK: +
   OSASK  PLEASE BRING DOWN ISA AND REPLY 'GO' TO CONTINUE SHUTDOWN +
          OR REPLY 'CANCEL' TO CANCEL SHUTDOWN
      IF &REPLY = GO THEN GOTO CHKUCC7
      IF &REPLY = NOREPLY THEN GOTO ASK
      IF &REPLY ¬= CANCEL THEN GOTO ASK
      EXIT CODE (4)
   END
/* NOW CHECK IF UCC7 IS UP. IF IT IS ASK OPERATOR TO SHUT IT DOWN */
CHKUCC7: +
OSWTO CHECKING UCC7
OSCMD D J,UCC7
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &CMDOUT5W3
IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CHKDCICS
   DO
   ASK1: +
   OSASK  PLEASE BRING DOWN UCC7 AND REPLY 'GO' TO CONTINUE SHUTDOWN +
          OR REPLY 'CANCEL' TO CANCEL SHUTDOWN
      IF &REPLY = GO THEN GOTO CHKDCICS
      IF &REPLY = NOREPLY THEN GOTO ASK1
      IF &REPLY ¬= CANCEL THEN GOTO ASK1
      EXIT CODE (4)
   END
/* SEND MESSAGE TO TSO USERS SAYING SYSTEM IS DOWN....            */
OSCMD SEND '*** SYSTEM GOING DOWN.. PLEASE LOGOFF IMMEDIATELY ***'
/* NOW CHECK IF DCICS IS UP. IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKDCICS: +
OSWTO CHECKING DCICS
SET MAXCMDOUT = 10
OSCMD D J,DCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKPCICS
   DO
      SET MAXCMDOUT = 0
      OSCMD F DCICS,CSSN DCICS
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('DCICS')
      OSPAUSE 5
      OSCMD F DCICS,CEMT PER SHUT IMM
      OSPAUSE 35
   END
/* NOW CHECK IF PCICS IS UP. IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKPCICS: +
OSWTO CHECKING PCICS
OSCMD D J,PCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKUCICS
   DO
      SET MAXCMDOUT = 0
      OSCMD F PCICS,CSSN PCICS
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('PCICS')
      OSPAUSE 10
      OSCMD F PCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF USCICS IS UP. IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKUCICS: +
OSWTO CHECKING USCICS
SET MAXCMDOUT = 10
OSCMD D J,USCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKDCAN
   DO
      SET MAXCMDOUT = 0
      OSCMD F USCICS,CSSN USCICS
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('USCICS')
      OSPAUSE 10
      OSCMD F USCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF DCCACICS IS UP.IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKDCAN: +
OSWTO CHECKING DCANCICS
SET MAXCMDOUT = 10
OSCMD D J,DCANCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKTPV
   DO
      SET MAXCMDOUT = 0
      OSCMD F DCANCICS,CSSN DCANOP
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('DCANOP')
      OSPAUSE 10
      OSCMD F DCANCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF TPVCICS IS UP.IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKTPV: +
OSWTO CHECKING TPVCICS
SET MAXCMDOUT = 10
OSCMD D J,TPVCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO CHKPCAN
   DO
      SET MAXCMDOUT = 0
      OSCMD F TPVCICS,CSSN CICSOPER
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('CICSOPER')
      OSPAUSE 10
      OSCMD F TPVCICS,CEMT PER SHUT IMM
   END
/* NOW CHECK IF PCANCICS IS UP.IF SO SIGN ON TO IT AND SHUT IT DOWN */
CHKPCAN: +
OSWTO CHECKING PCANCICS
SET MAXCMDOUT = 10
OSCMD D J,PCANCICS
SET STATUS1 = &CMDOUT5W2
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO SHUTSIM
   DO
      SET MAXCMDOUT = 0
      OSCMD F PCANCICS,CSSN PCANOP
      OSPAUSE 5
/* REPLY TO THE PASSWORD PROMPT                                   */
      REPLY MSG(ACFAE138) TEXT('PCANOP')
      OSPAUSE 10
      OSCMD F PCANCICS,CEMT PER SHUT IMM
   END
/* NOW SHUTDOWN SIM3278 AND SIMCAN                                */
SHUTSIM: +
OSWTO SHUTTING SIM3278 AND SIMCAN
OSCMD F SIM3278,HALT,IMMED
OSCMD F SIMCAN,HALT,IMMED
/* NOW SHUTDOWN TSO AND NPDA AND PHOENIX                          */
OSCMD P PHOENIX
OSCMD P DFHSM
OSCMD P TSO
OSCMD P NPA
OSPAUSE 10
/* NOW GO THRU OUTSTANDING REPLIES TO SHUTDOWN                    */
/* IDMS, NCCF, UCOM, AND DCICS                                    */
OSWTO REPLYING TO IDMS, NCCF, UCOM DCICS
SET MAXCMDOUT = 50
OSCMD D R,L
SET I = 5
DO WHILE (&I <= &CMDOUT)
SET WORDS =  &&CMDOUT&I.W
IF &WORDS >= 4  THEN +
   DO
/* GET APPLICATION NAME                                           */
     SET APPL  = &&CMDOUT&I.W4
/* IS IT DCICS BACKUP MESSAGE ?                                   */
     IF &STR(&APPL) = &STR(DCICS) THEN +
        DO
           SET REPLYID = &&CMDOUT&I.W1
           SET MAXCMDOUT = 0
           OSCMD R &REPLYID,Y
        END
/* IS IT IDMS ??                                                  */
     IF &STR(&APPL) = &STR(REPLY) THEN +
        DO
           SET REPLYID = &&CMDOUT&I.W1
           SET MAXCMDOUT = 0
           OSCMD R &REPLYID,SHUTDOWN
        END
/* IS IT NCCF  ??                                                 */
     IF &STR(&APPL) = &STR(DSI802A) THEN +
        DO
          SET REPLYID = &&CMDOUT&I.W1
          SET MAXCMDOUT = 0
          OSCMD R &REPLYID,CLOSE
        END
/* IS IT UCOM  ??                                                 */
     IF &STR(&APPL) = &STR(UCC7.574) THEN +
        DO
          SET REPLYID = &&CMDOUT&I.W1
          SET MAXCMDOUT = 0
          OSCMD R &REPLYID,STOP
        END
  END
SET I = &I + 1
END
/* SUBMIT JES2 COMMANDS DRAIN LINES AND PRINTERS                  */
OSWTO RUNNING SHUTDOWN JOB
OSCMD S SYSJOB,JOB=SHUTDOWN
OSPAUSE 5
OSCMD P PHOENIX
OSCMD C JMXWTR
/* NOW CHECK IF DCICS IS DOWN                                     */
SET I = 1
DO WHILE (&I <= 100)
  SET MAXCMDOUT = 10
  OSCMD D J,DCICS
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &STR(&CMDOUT5W3)
  IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO STOPTLMS
  OSPAUSE 5
  SET I = &I + 1
END
OSWTOH DCICS DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
/* NOW O M S MESSAGES, IF ANY                                     */
STOPTLMS: +
REPLY MSG(CADO011D) TEXT('P TLMSII')
REPLY MSG(IKT010D) TEXT('FSTOP')
OSPAUSE 10
REPLY MSG(CADO017D) TEXT('X')
/* NOW REPLY TO TSO MESSAGE                                       */
REPLY MSG(IKT012D) TEXT('U')
/* NOW SHUTDOWN NET IF JES328X AND US328X IS DOWN                 */
SET I = 1
DO WHILE (&I <= 180)
  SET MAXCMDOUT = 10
  OSCMD D J,JES328X
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO CHKUS8X
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH JES328X DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
CHKUS8X: +
SET I = 1
DO WHILE (&I <= 180)
  OSCMD D J,US328X
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO STOPNET
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH US328X DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
STOPNET: +
OSWTO SHUTTING DOWN NET
OSCMD Z NET
/* NOW SHUTDOWN TM, RMF, AUTOA, OMEGAMON                          */
OSWTO SHUTTING DOWN TM ETC
OSCMD P TM
OSCMD P RMF.RMF
OSCMD P AUTOA.A
OSCMD P OMEGAMON
/* NOW SHUTDOWN LLA AND ACF2 IF NET IS DOWN                       */
SET I = 1
DO WHILE (&I <= 120)
  SET MAXCMDOUT = 10
  OSCMD D J,NET
  SET STATUS1 = &CMDOUT5W2
  SET STATUS2 = &CMDOUT5W3
  IF &STATUS1 = NOT AND &STATUS2 = FOUND THEN GOTO STOPACF2
  OSPAUSE 10
  SET I = &I + 1
END
OSWTOH NET DID NOT COME DOWN IN EXPECTED TIME
OSWTOH FOLLOW MANUAL PROCEDURE FOR REST OF THE SHUTDOWN
EXIT CODE (4)
/* NOW SHUTDOWN  LLA, ACF2 AND TSSO IF THERE ARE NO ACTIVE JOBS  */
STOPACF2: +
    OSCMD D J,L
    SET NUMOFJOB = &CMDOUT4W1
    IF &NUMOFJOB ¬= 0 THEN +
    DO
       OSWTOH SOME JOBS ARE STILL RUNNING
       OSWTOH PLEASE STOP ACF2 AND LLA AFTER ALL JOBS ARE FINISHED
       EXIT CODE (4)
    END
OSWTO SHUTTTING DOWN LLA AND ACF2
OSCMD P LLA
OSCMD P ACF2
OSWTOH *** SHUTDOWN SUCCESSFULLY COMPLETED ***
OSPAUSE 5
OSCMD #.P
EXIT CODE(0)
./       ADD   NAME=SMFDUMP
PROC 0
/******************************************************************/
/*  THIS CLIST IS USED DUMP SMF                                   */
/*                                                                */
/*  IT DOES FOLLOWING THINGS                                      */
/*  1. $OQ,CANCEL,Q=R,A=0  (PURGE STC OUTPUT)                     */
/*  2. D SMF                                                      */
/*  3. IF MAN1 IS ACTIVE AND MAN2 IS ALTERNATE                    */
/*         SWITCH SMF AND WAIT FOR UPTO 20 MINUTES, START SMFDUMP */
/*     IF MAN1 IS ACTIVE AND MAN2 IS DUMP REQUIRED                */
/*         START SMFDUMP2 (WHICH DUMPS MAN2 FIRST, ASKS THE       */
/*         OPERATOR TO SWITCH, DUMPS MAN1, ASKS FOR SWITCH, DUMPS */
/*         MAN2 AGAIN)                                            */
/*     IF MAN1 IS NOT ACTIVE                                      */
/*         START SMFDUMP TO DUMP MAN1 AND THEN MAN2               */
/******************************************************************/
/* SET TO MAX TO GET ALL OUTSTANDING REPLIES                      */
/*  CONTROL LIST CONLIST SYMLIST     ***/
SET MAXCMDOUT = 0
SET CMDWAIT   = 1
/*  OSCMD F ACF2,BACKUP */
OSCMD $OQ,CANCEL,Q=R,A=0
OSPAUSE 20
SET MAXCMDOUT = 10
OSCMD D SMF
SET MAN1 = &&CMDOUT4W5
SET MAN2 = &&CMDOUT5W5
IF &MAN1 = ACTIVE  AND &MAN2 = ALTERNATE THEN +
   DO
      SET MAXCMDOUT = 0
      OSCMD I SMF
      OSPAUSE 30
      SET MAXCMDOUT = 10
      SET I = 1
      DO WHILE (&I < 80)
         OSCMD D SMF
         SET MAN11 = &&CMDOUT4W5
         SET MAN12 = &&CMDOUT4W6
         IF &MAN11 = DUMP  AND &MAN12 = REQUIRED THEN +
         DO
           OSCMD S SMFDUMP
           EXIT CODE (0)
         END
         OSPAUSE 30
         SET I = &I + 1
      END
      OSWTOH SWITCH SMF TOOK LONGER THAN EXPECTED
      OSWTOH CLIST ABORTED, FOLLOW MANUAL PROCEDURE
      EXIT CODE (4)
   END
IF &MAN1 = ACTIVE  AND &MAN2 ¬= ALTERNATE THEN +
   DO
      OSWTOH MAN2 IS NOT EMPTY. STARTING SMFDUMP2 TO DUMP MAN2 FIRST
      OSCMD S SMFDUMP2
      EXIT CODE (0)
   END
IF &MAN1 ¬= ACTIVE  THEN +
   DO
      SET MAXCMDOUT = 0
      OSCMD S SMFDUMP
      EXIT CODE (0)
   END
./       ADD   NAME=SPLCLEAN
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED WHEN THE SPOOL REACHES 80%. IT         */
/*  DELETES CLASS A , T AND R OUTPUT.                             */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* SHOULD TAKE LESS THAN 5 SEC FOR OS CMDS                        */
SET CMDWAIT   = 5
SET MAXCMDOUT = 0
OSCMD $OQ,CANCEL,Q=T,A=0
OSCMD $OQ,CANCEL,Q=R,A=0
OSCMD $OT1-9999,Q=A,CANCEL
./       ADD   NAME=STRTAUTO
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED WHEN TSSO HAS BEEN INITIALIZED         */
/*  (TRIGGERED BY MSG TSST060I)                                   */
/*                                                                */
/*  IT STARTS AUTOA IF IT IS NOT ALREADY ACTIVE USING             */
/*  PARM=STARTUP.                                                 */
/*                                                                */
/*  AUTOA WILL IN TURN EXECUTE TSSO CLIST STARTUP ON WEEK DAYS    */
/*  TO START ALL ONLINES ETC.                                     */
/*                                                                */
/*  THIS CLIST WILL ALSO EXECUTE DATE CLIST TO DISPLAY IPL DATE   */
/******************************************************************/
/* SET TO MAX TO GET ALL OUTSTANDING REPLIES                      */
/*  CONTROL LIST CONLIST SYMLIST     ***/
SET MAXCMDOUT = 50
SET CMDWAIT   = 1
OSCMD #DATE
OSCMD D J,AUTOA
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 = NOT AND &STR(&STATUS2) = FOUND THEN GOTO START
      OSWTO ** AUTOA IS ALREADY ACTIVE ***
      EXIT CODE(0)
   END
START: +
OSCMD S AUTOA.A,PARM=STARTUP
EXIT CODE(0)
./       ADD   NAME=STRT328X
PROC 0
/******************************************************************/
/*  THIS CLIST IS EXECUTED BY AUTOA RIGHT AFTER AN IPL            */
/*                                                                */
/*  IT STARTS JES328X AND US328X                                  */
/******************************************************************/
/* CONTROL LIST CONLIST SYMLIST                                   */
/* MAXIMUM OF 10 LINES EXPECTED FROM D J,L                        */
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
SET MAXCMDOUT = 10
OSCMD S SYSJOB,JOB=JESLNES
OSPAUSE 180
/******************************************************************/
OSCMD D J,JES328X
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO JES328X
OSCMD S JES328X
JES328X: +
OSPAUSE 5
/******************************************************************/
OSCMD D J,US328X
SET STATUS1 = &STR(&CMDOUT5W2)
SET STATUS2 = &STR(&CMDOUT5W3)
IF &STATUS1 ¬= NOT AND &STR(&STATUS2) ¬= FOUND THEN GOTO US328X
OSCMD S US328X
US328X: +
EXIT CODE(0)
./       ADD   NAME=TEMP
PROC 0
SET MAXCMDOUT = 200
SET CMDWAIT   = 1
OSWTO TESTING....
EXIT CODE(0)
./       ADD   NAME=TOOLONG
PROC 0 MSG()

  /****************************************************************/
  /*  THIS CLIST IS EXECUTED IN RESPONSE TO MESSAGE $HASP308      */
  /* WHICH IS TO THE EFFECT THAT A JOB IS EXCEEDING ITS RUNTIME   */
  /* ESTIMATE. THE CLIST WRITES A THREATENING MESSAGE INTO THE    */
  /* OFFENDERS JOBLOG AND REFLECTS THE ORIGINAL MESSAGE TO THE    */
  /* TSO SESSION OF THE SUBMITTOR, IF HE SHE OR IT CAN BE         */
  /* IDENTIFIED.                                                  */
  /****************************************************************/

SET JOBN = &SUBSTR(10:17,&STR(&MSG))
SET LEN = &LENGTH(&JOBN)
IF &SUBSTR(1:1,&JOBN) = &STR(P) THEN DO
 IF &LEN = 8 THEN GOTO EXIT
END
SET MAXCMDOUT = 10
SET CMDWAIT = 1
OSCMD $D'&JOBN',L=Z
IF &CMDOUT > 2 THEN DO
   SET &I = 3
   DO WHILE (&I <= &CMDOUT)
      SET &E = &&CMDOUT&I.W4
      IF &STR(&E) = &STR(EXECUTING) THEN DO
         SET &JN = &&CMDOUT&I.W2
         OSCMD $DMJ&JN,' '
         OSCMD $DMJ&JN,' ===> PLEASE USE A LONGER TIME ESTIMATE'
         OSCMD $DMJ&JN,' '
         SET &I = &&CMDOUT
      END
      SET &I = &I + 1
   END
END
SET UID = &SUBSTR(1:&LEN-1,&JOBN)
SET MAXCMDOUT = 5
SET CMDWAIT = 1
OSCMD D TS,&UID
SET NF = &STR(&CMDOUT5W2 &CMDOUT5W3)
IF &STR(&NF) = &STR(NOT FOUND) THEN GOTO EXIT
OSCMD SEND '&MSG',USER=(&UID),LOGON
GOTO EXIT
EXIT:+
END
./       ADD   NAME=UNAV
PROC 1 JOB

  /****************************************************************/
  /*  THIS CLIST IS EXECUTED IN RESPONSE TO MESSAGE DTM1462I      */
  /* WHICH IS TO THE EFFECT THAT A JOB WOULD REQUEST VOLUMES THAT */
  /* ARE NOT AVAILABLE. A NO-ROLL MESSAGE IS WRITTEN TO THE       */
  /* CONSOLE WITH THE JOBNAME.                                    */
  /*  THIS CLIST IS USED IN CONNECTION WITH THE CROWNTEK PRODUCT  */
  /* THRUPUT MANAGER.                                             */
  /****************************************************************/

 WRITE *HI &JOB HELD DUE TO UNAVAILABLE VOLUMES.
 WRITE *HI USE COMMAND "F TM,D JNNNN UNAV" TO IDENTIFY THE VOLUME.
END
./       ADD   NAME=USTRIDMS
PROC 0
/******************************************************************/
/*  THIS CLIST AUTOMATICALLY REPLIES TO THE OUTSTANDING REPLY     */
/*  FOR USTRIDMS. NORMALLY THIS WILL BE EXECUTED BY AUTO AT       */
/*  PREDEFINED TIME (21:00). THE PROCESSING INVOLVES ISSUEING     */
/*  'D R,L' COMMAND AND SCANNING THE OUTPUT FOR THE DCIDMS        */
/*  VERSION ID CV2. IT THEN REPLIES 'SHUTDOWN' FOR THAT REPLY     */
/*  ID.                                                           */
/*  MAINTENANCE LOG                                               */
/*  ===============                                               */
/*  WHO      WHEN                     WHAT                        */
/*  ---      ----                     ----                        */
/*                                                                */
/******************************************************************/
/* SET TO MAX TO GET ALL OUTSTANDING REPLIES                      */
SET MAXCMDOUT = 200
/* SHOULD TAKE LESS THAN 1 SEC FOR OS CMDS                        */
SET CMDWAIT   = 1
OSCMD D R,L
/* IGNORE FIRST 4 LINES FROM D R,L                                */
SET I = 5
/* SCAN THRU REST OF RESPONSE LINES                               */
DO WHILE (&I <= &CMDOUT)
/* GET NUMBER OF WORDS IN THE REPLY                               */
SET WORDS =  &&CMDOUT&I.W
/* TEST FOR DCIDMS ONLY IF >= 9 WORDS                             */
IF &WORDS >= 9  THEN +
  DO
/* GET VERSION NUMBER                                             */
  SET VERSION = &&CMDOUT&I.W9
  SET PGM     = &&CMDOUT&I.W8
/* IS IT DCIDMS ??                                                */
  IF &STR(&VERSION) = &STR(V2) AND &STR(&PGM) = &STR(IDMS) THEN +
      DO
      SET REPLYID = &&CMDOUT&I.W1
      SET MAXCMDOUT = 0
      OSCMD R &REPLYID,SHUTDOWN
      OSPAUSE 10
      OSWTO USTRIDMS HAS BEEN SHUTDOWN
      EXIT CODE(0)
      END
  END
SET I = &I + 1
END
OSWTOH USTRIDMS IS NOT ACTIVE
EXIT CODE(0)
