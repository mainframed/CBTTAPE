         TITLE '   C H A N G E X   -   I K J E B E Z 4   '      PRC.CHX
************************************************************
*                                                          *
*        'CHANGEX' SUBCOMMAND OF EDIT                      *
*                                                          *
************************************************************
         SPACE
*        WRITTEN BY. BILL GODFREY, PLANNING RESEARCH CORPORATION.
*                    (MODIFIED IBM'S 'CHANGE' SUBCOMMAND).
*        INSTALLATION. PRC COMPUTER CENTER INC, MCLEAN VA.
*        DATE WRITTEN. AUGUST 28 1975.
*        DATE UPDATED. MAY 10 1979.
*        ATTRIBUTES. RE-ENTRANT.
*        COMMENTS.
*            THIS EDIT SUBCOMMAND WORKS JUST LIKE THE 'CHANGE'
*            SUBCOMMAND, BUT THE STRINGS ARE INTERPRETED AS
*            HEXADECIMAL REPRESENTATIONS OF THE STRING VALUES.
*
*            NOTE THAT SOME SURPRISING UNWANTED RESULTS CAN
*            SOMETIMES BE PRODUCED.  AFTER EACH LINE IS CHANGED,
*            MODULE IKJEBELE SCANS THE LINE AND TREATS ANY HEX
*            '05' AS A TAB CHARACTER, SO YOU CANT CHANGE SOMETHING
*            TO HEX '05' AND EXPECT IT TO REMAIN A HEX '05'.
*            IKJEBELE ALSO TRANSLATES LOWER CASE TO CAPS, UNLESS
*            YOU ARE EDITING 'ASIS', SO CHANGING SOMETHING TO
*            A LOWER CASE LETTER WILL RESULT IN A CAPITAL LETTER.
*
*            PRINT HAS BEEN SET OFF ACROSS A LARGE UNMODIFIED
*               SECTION OF CODE, SIMPLY TO SAVE PAPER.
*            ILLEGAL HEX STRINGS WILL CAUSE THE FOLLOWING MESSAGE:
*               IKJ52559I MISSING COUNT OR STRING
*
*            THIS MODULE CONTAINS AN EXTERNAL REFERENCE TO
*            'IKJEBESE'. IT WILL BE NEEDED WHEN LINK-EDITING.
*            PULL A COPY FROM IKJEBECH (THE CHANGE SUBCOMMAND)
*            WITH THESE LINK-EDIT STATEMENTS:
*             REPLACE IKJEBECH,IKJEBCH1,IKJEBCH2,IKJEBCH3,IKJEBCH4
*             INCLUDE CMDLIB(IKJEBECH)
*
         SPACE 2
IKJEBECH CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
*        DC    C'IKJEBECH  75.237'                                 0001
         DC    C'CHANGEX   75.237'                              PRC.CHX
         DC    CL16' &SYSDATE &SYSTIME '                        PRC.CHX
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @06,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@06                                    0001
*                                                                  0084
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATE ENTRY LINKAGE AND PROGRAM ADDRESSABILITY             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0085
*   COMMREG=PARMREG1;               /* GET ADDR OF IKJEBECA          */
         LR    COMMREG,PARMREG1                                    0085
*   RESPECIFY                                                      0086
*    (GPR13P,                                                      0086
*     GPR15P) RSTD;                                                0086
*   GPR15P=CANXTSVA;                /* SAVE AREA FOR THIS MODULE     */
         L     GPR15P,CANXTSVA(,COMMREG)                           0087
*   EVAL(GPR15P+4)->CASAVPTR=GPR13P;/* SET THIS SAVEAREA BKWD PTR    */
         LA    @14,4                                               0088
         ALR   @14,GPR15P                                          0088
         ST    GPR13P,CASAVPTR(,@14)                               0088
*   EVAL(GPR13P+8)->CASAVPTR=GPR15P;/* SET CALLER FWD PTR            */
         LA    @14,8                                               0089
         ALR   @14,GPR13P                                          0089
         ST    GPR15P,CASAVPTR(,@14)                               0089
*   GPR13P=GPR15P;                  /* NEW SAVEAREA ADDR             */
         LR    GPR13P,GPR15P                                       0090
*   CANXTSVA=GPR13P+72;             /* UPDATE NEX-SAVE-AREA PTR      */
         LA    @14,72                                              0091
         ALR   @14,GPR13P                                          0091
         ST    @14,CANXTSVA(,COMMREG)                              0091
*   RESPECIFY                                                      0092
*    (GPR13P,                                                      0092
*     GPR15P) UNRSTD;                                              0092
*   DATAREG=ADDR(CASCWKA);          /* SET BASE REG FOR WORK AREA    */
         LA    DATAREG,CASCWKA(,COMMREG)                           0093
*   GEN( USING @DATD,DATAREG);      /* SET ADDRESSABILITY TO CASCWKA */
          USING @DATD,DATAREG
*   RFY                                                            0095
*    (GPR02P,                                                      0095
*     GPR03P,                                                      0095
*     GPR04P,                                                      0095
*     GPR05P) RSTD;                 /*                       @ZA06238*/
*   GPR02P=DATAREG;                 /* INIT SUBCMD WORK      @ZA06238*/
         LR    GPR02P,DATAREG                                      0096
*   GPR03P=CASCWKAL;                /* AREA TO ZERO'S        @ZA06238*/
         LA    GPR03P,672                                          0097
*   GPR04P=DATAREG;                 /* BY ISSUEING MVCL      @ZA06238*/
         LR    GPR04P,DATAREG                                      0098
*   GPR05P=''B;                     /* INSN WITH SOURCE      @ZA06238*/
         SLR   GPR05P,GPR05P                                       0099
*   MVCL(GPR02P,GPR04P);            /* LENGTH+FILL ='00'X    @ZA06238*/
         MVCL  GPR02P,GPR04P                                       0100
*   RFY                                                            0101
*    (GPR02P,                                                      0101
*     GPR03P,                                                      0101
*     GPR04P,                                                      0101
*     GPR05P) UNRSTD;               /*                       @ZA06238*/
*   CHRETCD=0;                      /* INIT SUBCOMMAND RETURN CODE   */
         SLR   @08,@08                                             0102
         ST    @08,CHRETCD                                         0102
*   PROMPTSW='0'B;                  /* INITIALIZE PROMPTSW OFF       */
         NI    PROMPTSW,B'01111111'                                0103
*   DCBPTR=CAPTCDCB;                /* INIT IKJEBEUT PTR TO DCB      */
         MVC   DCBPTR(3),CAPTCDCB+1(COMMREG)                       0104
*   UTCODE='04'X;                   /* SET CODE TO READ 1ST LINE     */
         MVI   UTCODE,X'04'                                        0105
*   KEYPTR=0;                       /* SET PTR TO KEY TO ZERO        */
         ST    @08,KEYPTR                                          0106
*   AREAPTR=ADDR(KEYFLD);           /* AREA TO READ INTO             */
         LA    @08,KEYFLD(,COMMREG)                                0107
         ST    @08,AREAPTR                                         0107
*   PLISTEND='1'B;                  /* SET END OF LIST MARKER        */
         OI    PLISTEND,B'10000000'                                0108
*   CALL RDWRTRTN;                  /* READ RECORD                   */
*                                                                  0109
         BAL   @14,RDWRTRTN                                        0109
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF IKJEBEUT OPERATION SUCCESSFUL                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0110
*   IF RETCODE¬=0&RETCODE¬=4 THEN   /* TERMINATE                     */
         LTR   RETCODE,RETCODE                                     0110
         BZ    @RF00110                                            0110
         CH    RETCODE,@CH00599                                    0110
         BNE   @RT00110                                            0110
*     GO TO CHGEXIT2;               /* BEGIN END PROCESSING          */
*                                                                  0111
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF RECORD EXISTS - IS DATA SET EMPTY                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0112
*   IF RETCODE=4 THEN               /* IF NO, NOTIFY USER -EMPTY DS  */
@RF00110 CH    RETCODE,@CH00599                                    0112
         BNE   @RF00112                                            0112
*     DO;                           /* SEND DATA SET EMPTY MSG       */
*       RELMSG1=1287;               /* MSG IKJ52501I                 */
         MVC   RELMSG1(2),@CH01303                                 0114
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERT           */
         SLR   LEV2INS,LEV2INS                                     0115
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERT           */
         SLR   LEV1INS,LEV1INS                                     0116
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             0117
         STH   @12,RELMSG2                                         0117
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0118
*       GO TO CHNGEXIT;             /* RETURN TO CALLER              */
         B     CHNGEXIT                                            0119
*     END;                                                         0120
*   PPLPTR=ADDR(CATMPLST);          /* INIT IKJPARS PTR TO PARMLST   */
*                                                                  0121
@RF00112 LA    @12,CATMPLST(,COMMREG)                              0121
         ST    @12,PPLPTR                                          0121
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ANY OPERANDS SPECIFIED                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0122
*   IF CAOPERND='1'B THEN           /* IF YES, NO PROMPT YET         */
         TM    CAOPERND(COMMREG),B'10000000'                       0122
         BO    @RT00122                                            0122
*     GO TO CHKOPRND;               /* GO TO PARSE OPERANDS          */
*                                                                  0124
*   /*****************************************************************/
*   /*                                                               */
*   /* ------------------------------------------------------- THIS  */
*   /* SECTION ASSURES THAT ENOUGH INFORMATION IS OBTAINED TO PROCESS*/
*   /* A CHANGE REQUEST AND ROUTES THE LOGIC THROUGH EITHER THE CODE */
*   /* HANDLING SPECIFIC KEY REQUESTS OR THAT HANDLING DIRECT OR     */
*   /* DEFAULTED REFERENCES TO '*' -- PROCESSING IS TERMINATED IF    */
*   /* REQUIRED OPERANDS ARE MISSING AND THE USER IS IN NOPROMPT MODE*/
*   /* -------------------------------------------------------       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0124
*PROMPT:                                                           0124
*   UPTPTR=CAPTUPT;                 /* PTR TO USER PROFILE TABLE     */
*                                                                  0124
PROMPT   L     UPTPTR,CAPTUPT(,COMMREG)                            0124
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NO PROMPT USER                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0125
*   IF UPTNPRM='1'B|CAINPROC='1'B THEN/* IF YES, NOTIFY USER THAT  0125
*                                      REQUIRED OPERAND MISSING      */
         TM    UPTNPRM(UPTPTR),B'01000000'                         0125
         BO    @RT00125                                            0125
         TM    CAINPROC(COMMREG),B'00000100'                       0125
         BNO   @RF00125                                            0125
@RT00125 DS    0H                                                  0126
HEXINV   DS    0H                                               PRC.CHX
*     DO;                           /* SEND OPERANDS MISSING MSG     */
*       RELMSG1=1033;               /* MSG IKJ52559I                 */
         MVC   RELMSG1(2),@CH01308                                 0127
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0128
*       LEV1INS=0;                  /* PTR TO INSERTION              */
         SLR   LEV1INS,LEV1INS                                     0129
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             0130
         STH   @12,RELMSG2                                         0130
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0131
*       CHRETCD=8;                  /* INDICATE FLUSH NECESSARY      */
         MVC   CHRETCD(4),@CF00058                                 0132
*       GO TO CHNGEXIT;             /* RETURN TO CALLER              */
         B     CHNGEXIT                                            0133
*     END;                                                         0134
*REPROMPT:                                                         0135
*   PTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO PUTLINE PARMBLOCK */
@RF00125 DS    0H                                                  0135
REPROMPT LA    @08,PTGTLIST                                        0135
         ST    @08,PTPBPTR                                         0135
*   PRMPTNO=1;                      /* ONE MESSAGE SEGMENT           */
         MVC   PRMPTNO(4),@CF00060                                 0136
*   PRMPTPTR=ADDR(PRMPTMSG);        /* PTR TO MESSAGE TEXT           */
         LA    @07,PRMPTMSG                                        0137
         ST    @07,PRMPTPTR                                        0137
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO OUT PARMBLOCK            */
         XC    PTGTLIST(20),PTGTLIST                               0138
*   PARMREG1=IOPLPTR;               /* PTR TO IKJPUTL PARMLIST       */
         L     @07,IOPLPTR                                         0139
         LR    PARMREG1,@07                                        0139
*   IOPLIOPB=PTPBPTR;               /* PUTLINE PARM BLOCK PTR        */
*                                                                  0140
         ST    @08,IOPLIOPB(,@07)                                  0140
*   /*****************************************************************/
*   /*                                                               */
*   /* SEND 'ENTER COUNT OR STRING' MESSAGE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0141
*   GENERATE;                                                      0141
         PUTLINE ,OUTPUT=(PRMPTNO,TERM,SINGLE,INFOR),                  X
               TERMPUT=(EDIT,WAIT,NOHOLD,NOBREAK),MF=(E,(1))
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */
*                                                                  0142
         LR    RETCODE,RETCDREG                                    0142
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN FROM PUTLINE                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0143
*   IF RETCODE¬=0 THEN              /* IF NO, TERMINAL ERROR         */
         LTR   RETCODE,RETCODE                                     0143
         BNZ   @RT00143                                            0143
*     GO TO PUTERR;                 /* PROCESS ERROR                 */
*   GTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO GETLINE PARMBLOCK */
         LA    @08,PTGTLIST                                        0145
         ST    @08,GTPBPTR                                         0145
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO PARMBLOCK                */
         XC    PTGTLIST(20),PTGTLIST                               0146
*   PARMREG1=IOPLPTR;               /* IKJGETL PARMLIST PTR          */
         L     @07,IOPLPTR                                         0147
         LR    PARMREG1,@07                                        0147
*   IOPLIOPB=GTPBPTR;               /* GETLINE PARM BLOCK PTR        */
*                                                                  0148
         ST    @08,IOPLIOPB(,@07)                                  0148
*   /*****************************************************************/
*   /*                                                               */
*   /* RECOVER USER RESPONSE TO PROMPT                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0149
*   GENERATE;                                                      0149
         GETLINE ,INPUT=(TERM,LOGICAL),TERMGET=(EDIT,WAIT),            X
               MF=(E,(1))
*   RETCODE=RETCDREG;               /* SAVE IKJGETL RETURN CODE      */
*                                                                  0150
         LR    RETCODE,RETCDREG                                    0150
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN FROM GETLINE                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0151
*   IF RETCODE¬=0 THEN              /* IF NO, TERMINAL ERROR         */
         SLR   @08,@08                                             0151
         CR    RETCODE,@08                                         0151
         BNE   @RT00151                                            0151
*     GO TO GETERR;                 /* PROCESS ERROR                 */
*   PROMPTSW='1'B;                  /* INDICATE GETLINE BUFFER HELD  */
         OI    PROMPTSW,B'10000000'                                0153
*   PPLPCL=ADDR(IKJEBCH2);          /* INIT IKJPARS PARMLIST         */
         L     @12,PPLPTR                                          0154
         L     @07,@CV00510                                        0154
         ST    @07,PPLPCL(,@12)                                    0154
*   PPLANS=ADDR(TABPTR2);           /* PTR TO PDL                    */
         LA    @07,TABPTR2                                         0155
         ST    @07,PPLANS(,@12)                                    0155
*   PPLCBUF=GTPBIBUF;               /* PTR TO INPUT BUFFER           */
         L     @07,GTPBPTR                                         0156
         MVC   PPLCBUF(4,@12),GTPBIBUF(@07)                        0156
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT        */
*                                                                  0157
         ST    @08,PPLUWA(,@12)                                    0157
*   /*****************************************************************/
*   /*                                                               */
*   /* PARSE USER RESPONSE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0158
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */
*     RESPECIFY                                                    0159
*       GPR01P RSTD;                                               0159
*     GPR01P=ADDR(PPL);                                            0160
         LR    GPR01P,@12                                          0160
*     IF CVTPARS=0 THEN                                            0161
         L     @12,CVTPTR                                          0161
         C     @08,CVTPARS(,@12)                                   0161
         BNE   @RF00161                                            0161
*       GEN(LINK EP=IKJPARS);                                      0162
         LINK EP=IKJPARS
*     ELSE                                                         0163
*       CALL CVTPARS;                                              0163
         B     @RC00161                                            0163
@RF00161 L     @12,CVTPTR                                          0163
         L     @15,CVTPARS(,@12)                                   0163
         BALR  @14,@15                                             0163
*     RESPECIFY                                                    0164
*       GPR01P UNRSTD;                                             0164
@RC00161 DS    0H                                                  0165
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */
*                                                                  0166
         LR    RETCODE,RETCDREG                                    0166
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM PARSE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0167
*   IF RETCODE¬=0 THEN              /* IF YES, ERROR CONDITION       */
         LTR   RETCODE,RETCODE                                     0167
         BNZ   @RT00167                                            0167
*     GO TO PARSERR;                /* PROCESS ERROR                 */
*   TABPTR1=TABPTR2-8-8;            /* OVERLAY DSECT                 */
*                                                                  0169
         L     @12,TABPTR2                                         0169
         SH    @12,@CH00233                                        0169
         ST    @12,TABPTR1                                         0169
         SPACE 1                                                PRC.CHX
         TM    STR1F(@12),X'80'    STRING1 PRESENT?             PRC.CHX
         BZ    CHXNOT1             NO, BRANCH                   PRC.CHX
         L     @01,STR1(,@12)      POINT TO STRING              PRC.CHX
         LH    @00,STR1L(,@12)     GET LENGTH OF STRING         PRC.CHX
         BAL   @05,HEXPACK         CONVERT HEX TO REAL          PRC.CHX
         LH    @01,STR1L(,@12)     GET LENGTH OF STRING         PRC.CHX
         LA    @01,1(@01)          ADD 1 IN CASE IT'S ODD       PRC.CHX
         SRL   @01,1               HALVE THE LENGTH             PRC.CHX
         STH   @01,STR1L(,@12)     RESTORE HALVED LENGTH        PRC.CHX
CHXNOT1  EQU   *                                                PRC.CHX
         TM    STR2F(@12),X'80'    STRING2 PRESENT?             PRC.CHX
         BZ    CHXNOT2             NO, BRANCH                   PRC.CHX
         L     @01,STR2(,@12)      POINT TO STRING              PRC.CHX
         LH    @00,STR2L(,@12)     GET LENGTH OF STRING         PRC.CHX
         BAL   @05,HEXPACK         CONVERT HEX TO REAL          PRC.CHX
         LH    @01,STR2L(,@12)     GET LENGTH OF STRING         PRC.CHX
         LA    @01,1(,@01)         ADD 1 IN CASE IT'S ODD       PRC.CHX
         SRL   @01,1               HALVE THE LENGTH             PRC.CHX
         STH   @01,STR2L(,@12)     RESTORE HALVED LENGTH        PRC.CHX
CHXNOT2  EQU   *                                                PRC.CHX
         SPACE 1                                                PRC.CHX
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN FROM PARSE                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0170
*   IF LNCNTF='1'B|STR1F='1'B THEN  /* IF YES, CONTINUE PROCESSING   */
         TM    LNCNTF(@12),B'10000000'                             0170
         BO    @RT00170                                            0170
         TM    STR1F(@12),B'10000000'                              0170
         BNO   @RF00170                                            0170
@RT00170 DS    0H                                                  0171
*     DO;                           /* PREPARE TO READ CURRENT LINE  */
*       FIRSTCHG='1'B;              /* INDICATE PDL HELD             */
         OI    FIRSTCHG,B'01000000'                                0172
*       GO TO NOCOUNT;              /* BRANCH TO READ '*' LINE       */
         B     NOCOUNT                                             0173
*     END;                                                         0174
*   FREEAREA=GTPBIBUF;              /* PTR TO INPUT BUFFER           */
@RF00170 L     @12,GTPBPTR                                         0175
         L     @12,GTPBIBUF(,@12)                                  0175
         ST    @12,FREEAREA                                        0175
*   FREELEN=BFRLEN;                 /* LENGTH OF BUFFER              */
         LH    @12,BFRLEN(,@12)                                    0176
         ST    @12,FREELEN                                         0176
*   BINRYREG=ADDR(FREEAREA);        /* PTR TO AREA INFO              */
         LA    BINRYREG,FREEAREA                                   0177
*   FREELIST=FREELIST&&FREELIST;    /* ZERO OUT LIST FORM            */
         XC    FREELIST(12),FREELIST                               0178
*   PARMREG1=ADDR(FREELIST);        /* PTR TO LIST FORM              */
*                                                                  0179
         LA    PARMREG1,FREELIST                                   0179
*   /*****************************************************************/
*   /*                                                               */
*   /* FREEMAIN INPUT BUFFER                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0180
*   GENERATE REFS(BINRYREG);                                       0180
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))
*   PROMPTSW='0'B;                  /* INDICATE NO GETLINE BUFFER    */
         NI    PROMPTSW,B'01111111'                                0181
*   PARMREG1=TABPTR2;               /* IKJPARS PDL POINTER           */
         L     PARMREG1,TABPTR2                                    0182
*   GEN(IKJRLSA (1));               /* RELEASE IKJPARS PDL           */
         IKJRLSA (1)
*   GO TO REPROMPT;                 /* REPROMPT USER FOR COUNT       */
         B     REPROMPT                                            0184
*CHKOPRND:                                                         0185
*   PPLPCL=ADDR(IKJEBCH1);          /* PTR TO MAIN PCL               */
CHKOPRND L     @12,PPLPTR                                          0185
         L     @08,@CV00509                                        0185
         ST    @08,PPLPCL(,@12)                                    0185
*   PPLANS=ADDR(TABPTR1);           /* PTR TO ANSWER PLACE           */
         LA    @08,TABPTR1                                         0186
         ST    @08,PPLANS(,@12)                                    0186
*   PPLCBUF=CAPTIBFR;               /* PTR TO INPUT BUFFER           */
         MVC   PPLCBUF(4,@12),CAPTIBFR(COMMREG)                    0187
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT        */
*                                                                  0188
         SLR   @08,@08                                             0188
         ST    @08,PPLUWA(,@12)                                    0188
*   /*****************************************************************/
*   /*                                                               */
*   /* PARSE OPERANDS                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0189
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */
*     RESPECIFY                                                    0190
*       GPR01P RSTD;                                               0190
*     GPR01P=ADDR(PPL);                                            0191
         LR    GPR01P,@12                                          0191
*     IF CVTPARS=0 THEN                                            0192
         L     @12,CVTPTR                                          0192
         C     @08,CVTPARS(,@12)                                   0192
         BNE   @RF00192                                            0192
*       GEN(LINK EP=IKJPARS);                                      0193
         LINK EP=IKJPARS
*     ELSE                                                         0194
*       CALL CVTPARS;                                              0194
         B     @RC00192                                            0194
@RF00192 L     @12,CVTPTR                                          0194
         L     @15,CVTPARS(,@12)                                   0194
         BALR  @14,@15                                             0194
*     RESPECIFY                                                    0195
*       GPR01P UNRSTD;                                             0195
@RC00192 DS    0H                                                  0196
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */
*                                                                  0197
         LR    RETCODE,RETCDREG                                    0197
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN FROM IKJPARS                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0198
*   IF RETCODE¬=0 THEN              /* IF NO, TERMINAL ERROR         */
         LTR   RETCODE,RETCODE                                     0198
         BNZ   @RT00198                                            0198
*     GO TO PARSERR;                /* PROCESS ERROR                 */
*   FIRSTCHG='1'B;                  /* INDICATE PDL HELD             */
*                                                                  0200
         OI    FIRSTCHG,B'01000000'                                0200
         SPACE 1                                                PRC.CHX
         L     @12,TABPTR1                                      PRC.CHX
         TM    STR1F(@12),X'80'    STRING1 PRESENT?             PRC.CHX
         BZ    CHXNOT3             NO, BRANCH                   PRC.CHX
         L     @01,STR1(,@12)      POINT TO STRING              PRC.CHX
         LH    @00,STR1L(,@12)     GET LENGTH OF STRING         PRC.CHX
         BAL   @05,HEXPACK         CONVERT HEX TO REAL          PRC.CHX
         LH    @01,STR1L(,@12)     GET LENGTH OF STRING         PRC.CHX
         LA    @01,1(@01)          ADD 1 IN CASE IT'S ODD       PRC.CHX
         SRL   @01,1               HALVE THE LENGTH             PRC.CHX
         STH   @01,STR1L(,@12)     RESTORE HALVED LENGTH        PRC.CHX
CHXNOT3  EQU   *                                                PRC.CHX
         TM    STR2F(@12),X'80'    STRING2 PRESENT?             PRC.CHX
         BZ    CHXNOT4             NO, BRANCH                   PRC.CHX
         L     @01,STR2(,@12)      POINT TO STRING              PRC.CHX
         LH    @00,STR2L(,@12)     GET LENGTH OF STRING         PRC.CHX
         BAL   @05,HEXPACK         CONVERT HEX TO REAL          PRC.CHX
         LH    @01,STR2L(,@12)     GET LENGTH OF STRING         PRC.CHX
         LA    @01,1(,@01)         ADD 1 IN CASE IT'S ODD       PRC.CHX
         SRL   @01,1               HALVE THE LENGTH             PRC.CHX
         STH   @01,STR2L(,@12)     RESTORE HALVED LENGTH        PRC.CHX
CHXNOT4  EQU   *                                                PRC.CHX
         SPACE 1                                                PRC.CHX
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ASTERISK SPECIFIED                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0201
*   IF LNSTART->LNUM(1)='*' THEN    /* IF YES, CONTINUE CHECK        */
*                                                                  0201
         L     @12,TABPTR1                                         0201
         L     @08,LNSTART(,@12)                                   0201
         CLI   LNUM(@08),C'*'                                      0201
         BNE   @RF00201                                            0201
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF NO OTHER OPERANDS SPECIFIED                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0202
*     IF LNENDF='0'B&LNCNTF='0'B&STR1F='0'B&STR2F='0'B THEN/* IF YES,
*                                      PROMPTING REQUIRED            */
         TM    LNENDF(@12),B'10000000'                             0202
         BNZ   @RF00202                                            0202
         TM    LNCNTF(@12),B'10000000'                             0202
         BNZ   @RF00202                                            0202
         TM    STR1F(@12),B'10000000'                              0202
         BNZ   @RF00202                                            0202
         TM    STR2F(@12),B'10000000'                              0202
         BNZ   @RF00202                                            0202
*       DO;                         /* USER ENTERED ONLY ASTERISK    */
*         PARMREG1=ADDR(TABPTR1);   /* PDL                           */
         LA    PARMREG1,TABPTR1                                    0204
*         GEN(IKJRLSA (1));         /* FREE MAIN PDL                 */
         IKJRLSA (1)
*         FIRSTCHG='0'B;            /* NO PDL HELD                   */
         NI    FIRSTCHG,B'10111111'                                0206
*         GO TO PROMPT;             /* PROMPT USER                   */
         B     PROMPT                                              0207
*       END;                                                       0208
*     ELSE                          /* IF NO, PROCEED                */
*       GO TO ASTSPEC;              /* '*' SPECIFIED                 */
*                                                                  0209
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NO OTHER OPERAND SPECIFIED                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0210
*   IF LNENDF='0'B&STR1F='0'B THEN  /* IF YES, 1ST OPERAND COUNT     */
@RF00201 L     @12,TABPTR1                                         0210
         TM    LNENDF(@12),B'10000000'                             0210
         BNZ   @RF00210                                            0210
         TM    STR1F(@12),B'10000000'                              0210
         BZ    @RT00210                                            0210
*     GO TO CNTONLY;                /* DEFAULT '*' ONLY              */
*                                                                  0212
*   /*****************************************************************/
*   /*                                                               */
*   /* ------------------------------------------------------- THIS  */
*   /* SECTION DETERMINES, IN THE CASE OF A KEY REFERENCE, THE NATURE*/
*   /* AND VALUE OF THE FIRST TWO POSSIBLE OPERANDS, VALIDITY CHECKS */
*   /* THE LINE RANGE, AND PROVIDES A DEFAULT LINE RANGE OF 1 --     */
*   /* PROCESSING IS TERMINATED IF THE DATA SET IS NOT LINE-NUMBERED,*/
*   /* OR IF AN INVALID RANGE IS SPECIFIED                           */
*   /* ------------------------------------------------------- CHECK */
*   /* IF LINE NUMBERED DATA SET                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0212
*   IF CANONUM='1'B THEN            /* IF NO, NOTIFY USER            */
@RF00210 TM    CANONUM(COMMREG),B'00000001'                        0212
         BNO   @RF00212                                            0212
*     DO;                           /* SEND DATA SET NOT NUMBERED    */
*       RELMSG1=1288;               /* MSG IKJ52502I                 */
         MVC   RELMSG1(2),@CH01320                                 0214
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0215
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERTION        */
         SLR   LEV1INS,LEV1INS                                     0216
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             0217
         STH   @12,RELMSG2                                         0217
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0218
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */
         B     FLUSH                                               0219
*     END;                                                         0220
         PRINT OFF                                              PRC.CHX
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */
@RF00212 MVC   PACKAREA(8),@CC01322                                0221
*   PACKAREA(9-LNSTARTL:8)=LNSTART->LNUM;/* MOVE LINE NUMBER INTO  0222
*                                      AREA                          */
         L     @12,TABPTR1                                         0222
         LA    @08,9                                               0222
         SH    @08,LNSTARTL(,@12)                                  0222
         LA    @07,PACKAREA-1(@08)                                 0222
         LCR   @08,@08                                             0222
         AL    @08,@CF00058                                        0222
         L     @12,LNSTART(,@12)                                   0222
         EX    @08,@SM01505                                        0222
*   CALL CONVERT;                   /* CONVERT TO BINARY             */
         BAL   @14,CONVERT                                         0223
*   LNUM1=BINRYREG;                 /* SET STARTING KEY              */
*                                                                  0224
         ST    BINRYREG,LNUM1                                      0224
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF SECOND OPERAND NOT SPECIFIED                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0225
*   IF LNENDF='0'B THEN             /* IF YES, SKIP CONVERT          */
         L     @12,TABPTR1                                         0225
         TM    LNENDF(@12),B'10000000'                             0225
         BZ    @RT00225                                            0225
*     GO TO NOSPAN;                 /* DEFAULT KEY RECORD ONLY       */
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */
         MVC   PACKAREA(8),@CC01322                                0227
*   PACKAREA(9-LNENDL:8)=LNEND->LNUM;/* MOVE LINE NUMBER INTO AREA   */
         LA    @08,9                                               0228
         SH    @08,LNENDL(,@12)                                    0228
         LA    @07,PACKAREA-1(@08)                                 0228
         LCR   @08,@08                                             0228
         AL    @08,@CF00058                                        0228
         L     @12,LNEND(,@12)                                     0228
         EX    @08,@SM01505                                        0228
*   CALL CONVERT;                   /* CONVERT TO BINARY             */
*                                                                  0229
         BAL   @14,CONVERT                                         0229
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF 3RD OR 4TH OPERANDS EXIST                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0230
*   IF STR1F='1'B|LNCNTF='1'B THEN  /* 2ND OPERAND LAST KEY          */
         L     @12,TABPTR1                                         0230
         TM    STR1F(@12),B'10000000'                              0230
         BO    @RT00230                                            0230
         TM    LNCNTF(@12),B'10000000'                             0230
         BNO   @RF00230                                            0230
@RT00230 DS    0H                                                  0231
*     DO;                           /* LINE NUMBER RANGE SPECIFIED   */
*       LNUM2=BINRYREG;             /* SET LAST KEY                  */
         ST    BINRYREG,LNUM2                                      0232
*       GO TO CHKSPAN;              /* PROCESS LINE SPAN             */
         B     CHKSPAN                                             0233
*     END;                                                         0234
*   ELSE                            /* 2ND OPERAND CHARACTER COUNT   */
*     DO;                           /* NO LINE RANGE SPECIFIED       */
@RF00230 DS    0H                                                  0236
*       CHARCNT=BINRYREG;           /* SET CHARACTER COUNT           */
         ST    BINRYREG,CHARCNT                                    0236
*       GO TO NOSPAN;               /* DEFAULT KEY LINE ONLY         */
         B     NOSPAN                                              0237
*     END;                                                         0238
*CHKSPAN:                                                          0239
*   ;                               /* LINE RANGE VALIDITY CHECKING  */
*                                                                  0239
CHKSPAN  DS    0H                                                  0240
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF 2ND LINE NUMBER LESS THAN 1ST                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   IF LNUM2<LNUM1 THEN             /* IF YES, NOTIFY USER           */
         L     @12,LNUM2                                           0240
         C     @12,LNUM1                                           0240
         BNL   @RF00240                                            0240
*     DO;                           /* SEND INVALID RANGE MSG        */
*       RELMSG1=1289;               /* IKJ52503I                     */
         MVC   RELMSG1(2),@CH01327                                 0242
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0243
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERTION        */
         SLR   LEV1INS,LEV1INS                                     0244
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             0245
         STH   @12,RELMSG2                                         0245
*       CALL SENDMSG;               /* SEND MESSAGE                  */
         BAL   @14,SENDMSG                                         0246
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */
         B     FLUSH                                               0247
*     END;                                                         0248
*   ELSE                            /* IF NO, CONTINUE PROCESSING    */
*     GO TO READKEY;                /* READ KEY SPECIFIED            */
*NOSPAN:                                                           0250
*   LNUM2=LNUM1;                    /* NO RANGE SPECIFIED            */
NOSPAN   MVC   LNUM2(4),LNUM1                                      0250
*   LNCOUNT=1;                      /* DEFAULT LINE COUNT TO 1       */
         MVC   LNCOUNT(4),@CF00060                                 0251
*READKEY:                                                          0252
*   SELNRNGE=ADDR(LNUM1);           /* INIT LINE RANGE FOR IKJEBESE  */
READKEY  LA    @12,LNUM1                                           0252
         ST    @12,SELNRNGE                                        0252
*   KEYPTR=ADDR(LNUM1);             /* KEY REFERENCE                 */
         ST    @12,KEYPTR                                          0253
*   GO TO READ;                     /* READ 'FIRST' RECORD           */
         B     READ                                                0254
*                                                                  0255
*   /*****************************************************************/
*   /*                                                               */
*   /* ------------------------------------------------------- THIS  */
*   /* SECTION DETERMINES, IN THE CASE OF A '*' REFERENCE, THE NATURE*/
*   /* AND VALUE OF THE FIRST TWO POSSIBLE OPERANDS, AND PROVIDES A  */
*   /* DEFAULT LINE COUNT OF 1 --IF AN INVALID LINE COUNT IS         */
*   /* SPECIFIED, THE USER IS PROMPTED UNTIL HE ENTERS A LINE COUNT  */
*   /* GREATER THAN 0                                                */
*   /* -------------------------------------------------------       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0255
*ASTSPEC:                                                          0255
*   ;                               /* ASTERISK SPECIFIED OR DEFLTD  */
*                                                                  0255
ASTSPEC  DS    0H                                                  0256
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF SECOND OPERAND SPECIFIED                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0256
*   IF LNENDF='0'B THEN             /* IF NO, SKIP PROCESSING        */
         L     @12,TABPTR1                                         0256
         TM    LNENDF(@12),B'10000000'                             0256
         BZ    @RT00256                                            0256
*     GO TO NOCOUNT;                /* '*' DEFAULTED                 */
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */
         MVC   PACKAREA(8),@CC01322                                0258
*   PACKAREA(9-LNENDL:8)=LNEND->LNUM;/* MOVE NUMBER INTO AREA        */
         LA    @08,9                                               0259
         SH    @08,LNENDL(,@12)                                    0259
         LA    @07,PACKAREA-1(@08)                                 0259
         LCR   @08,@08                                             0259
         AL    @08,@CF00058                                        0259
         L     @12,LNEND(,@12)                                     0259
         EX    @08,@SM01505                                        0259
*   CALL CONVERT;                   /* CONVERT TO BINARY             */
*                                                                  0260
         BAL   @14,CONVERT                                         0260
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF 3RD OR 4TH OPERANDS EXIST                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0261
*   IF STR1F='1'B|LNCNTF='1'B THEN  /* 2ND OPERAND LINE COUNT        */
         L     @12,TABPTR1                                         0261
         TM    STR1F(@12),B'10000000'                              0261
         BO    @RT00261                                            0261
         TM    LNCNTF(@12),B'10000000'                             0261
         BNO   @RF00261                                            0261
@RT00261 DS    0H                                                  0262
*     DO;                           /* LINE COUNT SPECIFIED          */
*       LNCOUNT=BINRYREG;           /* SET LINE COUNT                */
         ST    BINRYREG,LNCOUNT                                    0263
*       GO TO CHKLNCNT;             /* PROCESS COUNT                 */
         B     CHKLNCNT                                            0264
*     END;                                                         0265
*   ELSE                            /* 2ND OPERAND CHARACTER COUNT   */
*     DO;                           /* NO LINE COUNT SPECIFIED       */
@RF00261 DS    0H                                                  0267
*       CHARCNT=BINRYREG;           /* SET CHARACTER COUNT           */
         ST    BINRYREG,CHARCNT                                    0267
*       GO TO NOCOUNT;              /* DEFAULT '*' LINE ONLY         */
         B     NOCOUNT                                             0268
*     END;                                                         0269
*CHKLNCNT:                                                         0270
*   ;                               /* LINE COUNT VALIDITY CHECKING  */
*                                                                  0270
CHKLNCNT DS    0H                                                  0271
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LINE COUNT IS GREATER THAN 0                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*   IF LNCOUNT>0 THEN               /* IF YES, DO NOT PROMPT         */
         SLR   @12,@12                                             0271
         C     @12,LNCOUNT                                         0271
         BL    @RT00271                                            0271
*     GO TO READCUR;                /* READ CURRENT LINE             */
*   PPLPCL=ADDR(IKJEBCH4);          /* INIT IKJPARS PARMLIST         */
         L     @08,PPLPTR                                          0273
         L     @07,@CV00512                                        0273
         ST    @07,PPLPCL(,@08)                                    0273
*   PPLANS=ADDR(TABPTR3);           /* PTR TO PDL                    */
         LA    @07,TABPTR3                                         0274
         ST    @07,PPLANS(,@08)                                    0274
*   PPLCBUF=ADDR(BLANKBFR);         /* PTR TO BLANK BUFFER           */
         LA    @07,BLANKBFR(,COMMREG)                              0275
         ST    @07,PPLCBUF(,@08)                                   0275
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT USED   */
         ST    @12,PPLUWA(,@08)                                    0276
*   BLANKOFF=0;                     /* OFFSET FOR SCANNING           */
         STH   @12,BLANKOFF(,COMMREG)                              0277
*   BLANKTXT='';                    /* BLANK PROMPT BUFFER           */
         MVI   BLANKTXT(COMMREG),C' '                              0278
         MVC   BLANKTXT+1(5,COMMREG),BLANKTXT(COMMREG)             0278
*   BLANKLEN=LENGTH(BLANKBFR);      /* LENGTH OF BUFFER              */
*                                                                  0279
         MVC   BLANKLEN(2,COMMREG),@CH00538                        0279
*   /*****************************************************************/
*   /*                                                               */
*   /* PROMPT AND PARSE FOR VALID LINECOUNT                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */
*     RESPECIFY                                                    0281
*       GPR01P RSTD;                                               0281
*     GPR01P=ADDR(PPL);                                            0282
         LR    GPR01P,@08                                          0282
*     IF CVTPARS=0 THEN                                            0283
         L     @08,CVTPTR                                          0283
         C     @12,CVTPARS(,@08)                                   0283
         BNE   @RF00283                                            0283
*       GEN(LINK EP=IKJPARS);                                      0284
         LINK EP=IKJPARS
*     ELSE                                                         0285
*       CALL CVTPARS;                                              0285
         B     @RC00283                                            0285
@RF00283 L     @12,CVTPTR                                          0285
         L     @15,CVTPARS(,@12)                                   0285
         BALR  @14,@15                                             0285
*     RESPECIFY                                                    0286
*       GPR01P UNRSTD;                                             0286
@RC00283 DS    0H                                                  0287
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */
*                                                                  0288
         LR    RETCODE,RETCDREG                                    0288
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM IKJPARS                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*   IF RETCODE¬=0 THEN              /* IF NO, ERROR CONDITION        */
         LTR   RETCODE,RETCODE                                     0289
         BNZ   @RT00289                                            0289
*     GO TO PARSERR;                /* PROCESS ERROR                 */
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */
         MVC   PACKAREA(8),@CC01322                                0291
*   PACKAREA(9-LNSTARTL:8)=LICNT->LNUM;/* MOVE COUNT INTO WORK AREA  */
         LA    @12,9                                               0292
         L     @08,TABPTR1                                         0292
         SH    @12,LNSTARTL(,@08)                                  0292
         LA    @08,PACKAREA-1(@12)                                 0292
         LCR   @12,@12                                             0292
         AL    @12,@CF00058                                        0292
         L     @07,TABPTR3                                         0292
         L     @07,LICNT(,@07)                                     0292
         EX    @12,@SM01507                                        0292
*   CALL CONVERT;                   /* CONVERT TO BINARY             */
         BAL   @14,CONVERT                                         0293
*   LNCOUNT=BINRYREG;               /* SAVE LINECOUNT                */
         ST    BINRYREG,LNCOUNT                                    0294
*   PARMREG1=ADDR(TABPTR3);         /* PTR TO PROMPT PDL             */
         LA    PARMREG1,TABPTR3                                    0295
*   GEN(IKJRLSA (1));               /* RELEASE PDL CORE              */
         IKJRLSA (1)
*   GO TO CHKLNCNT;                 /* CHECK LINECOUNT VALIDITY      */
         B     CHKLNCNT                                            0297
*CNTONLY:                                                          0298
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */
CNTONLY  MVC   PACKAREA(8),@CC01322                                0298
*   PACKAREA(9-LNSTARTL:8)=LNSTART->LNUM;/* MOVE NUMBER INTO AREA    */
         L     @12,TABPTR1                                         0299
         LA    @08,9                                               0299
         SH    @08,LNSTARTL(,@12)                                  0299
         LA    @07,PACKAREA-1(@08)                                 0299
         LCR   @08,@08                                             0299
         AL    @08,@CF00058                                        0299
         L     @12,LNSTART(,@12)                                   0299
         EX    @08,@SM01505                                        0299
*   CALL CONVERT;                   /* CONVERT TO BINARY             */
         BAL   @14,CONVERT                                         0300
*   CHARCNT=BINRYREG;               /* SET CHARACTER COUNT           */
         ST    BINRYREG,CHARCNT                                    0301
*NOCOUNT:                                                          0302
*   LNCOUNT=1;                      /* SET LINE COUNT TO 1           */
NOCOUNT  MVC   LNCOUNT(4),@CF00060                                 0302
*READCUR:                                                          0303
*   CURLN=-1;                       /* SET IKJEBESE CODE FOR '*'     */
READCUR  SLR   @12,@12                                             0303
         BCTR  @12,0                                               0303
         ST    @12,CURLN                                           0303
*   SELNRNGE=ADDR(CURLN);           /* IKJEBESE PTR TO LINE RANGE    */
         LA    @08,CURLN                                           0304
         ST    @08,SELNRNGE                                        0304
*   LNUM2=-1;                       /* LINECOUNT MEANINGFUL ONLY     */
         ST    @12,LNUM2                                           0305
*   KEYPTR=ADDR(CACURNUM);          /* PTR TO CURRENT LINE KEY       */
         LA    @12,CACURNUM(,COMMREG)                              0306
         ST    @12,KEYPTR                                          0306
*                                                                  0307
*   /*****************************************************************/
*   /*                                                               */
*   /* ------------------------------------------------------- THIS  */
*   /* SECTION SECURES THE FIRST RECORD TO BE PROCESSED -- PROCESSING*/
*   /* IS TERMINATED IF THERE ARE NO RECORDS WITHIN THE RANGE        */
*   /* SPECIFIED OR DEFAULTED                                        */
*   /* -------------------------------------------------------       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0307
*READ:                                                             0307
*   UTCODE='00'X;                   /* READ CURRENT LINE BY KEY      */
READ     MVI   UTCODE,X'00'                                        0307
*   CALL RDWRTRTN;                  /* READ 'FIRST' LINE             */
*                                                                  0308
         BAL   @14,RDWRTRTN                                        0308
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF IKJEBEUT OPERATION SUCCESSFUL                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   IF RETCODE¬=0&RETCODE¬=4 THEN   /* TERMINATE                     */
         LTR   RETCODE,RETCODE                                     0309
         BZ    @RF00309                                            0309
         CH    RETCODE,@CH00599                                    0309
         BNE   @RT00309                                            0309
*     GO TO CHGEXIT2;               /* BEGIN END PROCESSING          */
*                                                                  0310
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF RECORD EXISTS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0311
*   IF RETCODE=0 THEN               /* IF YES, BEGIN PROCESSING      */
@RF00309 SLR   @08,@08                                             0311
         CR    RETCODE,@08                                         0311
         BE    @RT00311                                            0311
*     GO TO PROCESS;                /* BEGIN CHANGE OPERATION RECORD
*                                      SPECIFIED NOT FOUND           */
*                                                                  0312
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MORE LINES TO CHANGE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0313
*   IF LNUM1=LNUM2|LNCOUNT=1&CACURNUM¬=0 THEN/* IF NO, NOTIFY USER   */
         CLC   LNUM1(4),LNUM2                                      0313
         BE    @RT00313                                            0313
         CLC   LNCOUNT(4),@CF00060                                 0313
         BNE   @RF00313                                            0313
         C     @08,CACURNUM(,COMMREG)                              0313
         BE    @RF00313                                            0313
@RT00313 DS    0H                                                  0314
*     DO;                           /* SEND LINE NOT FOUND MSG       */
*NOLNMSG:                                                          0315
*       MSGPTR=0;                   /* NO 2ND 1ST LEVEL INSERTION    */
*                                                                  0315
NOLNMSG  SLR   @12,@12                                             0315
         ST    @12,MSGPTR(,COMMREG)                                0315
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF ASTERISK DEFAULTED OR SPECIFIED                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0316
*       IF LNUM2=-1 THEN            /* IF YES, TEXT = '*'            */
         CLC   LNUM2(4),@CF01340                                   0316
         BNE   @RF00316                                            0316
*         DO;                       /* ASTERISK SPECIFIED OR DEFLTD  */
*           MSGTEXT(1)='*';         /* INSERTION                     */
         MVI   MSGTEXT(COMMREG),C'*'                               0318
*           MSGLEN=4--1;            /* LENGTH                        */
         MVC   MSGLEN(2,COMMREG),@CH00130                          0319
*         END;                                                     0320
*       ELSE                        /* IF NO, TEXT = KEY VALUE       */
*         DO;                       /* LINE NUMBER SPECIFIED         */
         B     @RC00316                                            0321
@RF00316 DS    0H                                                  0322
*           MSGTEXT(1:LNSTARTL)=LNSTART->LNUM;/* INSERTION           */
         L     @12,TABPTR1                                         0322
         LH    @08,LNSTARTL(,@12)                                  0322
         LR    @07,@08                                             0322
         BCTR  @07,0                                               0322
         L     @12,LNSTART(,@12)                                   0322
         EX    @07,@SM01509                                        0322
*           MSGLEN=LNSTARTL+4;      /* LENGTH                        */
         AH    @08,@CH00599                                        0323
         STH   @08,MSGLEN(,COMMREG)                                0323
*         END;                                                     0324
*       MSGOFF=22;                  /* OFFSET FOR INSERTION          */
@RC00316 MVC   MSGOFF(2,COMMREG),@CH01346                          0325
*       RELMSG1=1290;               /* MSG IKJ52504I                 */
         MVC   RELMSG1(2),@CH01347                                 0326
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0327
*       LEV1INS=ADDR(MSGAREA);      /* PTR TO INSERTION              */
         LA    LEV1INS,MSGAREA(,COMMREG)                           0328
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             0329
         STH   @12,RELMSG2                                         0329
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0330
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */
         B     FLUSH                                               0331
*     END;                                                         0332
*   UTCODE='02'X;                   /* SET CODE TO READ NEXT LINE    */
@RF00313 MVI   UTCODE,X'02'                                        0333
*   CALL RDWRTRTN;                  /* READ NEXT LINE                */
*                                                                  0334
         BAL   @14,RDWRTRTN                                        0334
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF IKJEBEUT OPERATION SUCCESSFUL                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   IF RETCODE¬=0&RETCODE¬=4 THEN   /* TERMINATE                     */
         LTR   RETCODE,RETCODE                                     0335
         BZ    @RF00335                                            0335
         CH    RETCODE,@CH00599                                    0335
         BNE   @RT00335                                            0335
*     GO TO CHGEXIT2;               /* BEGIN END PROCESSING          */
*                                                                  0336
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF RECORD EXISTS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   IF RETCODE=4 THEN               /* IF NO, END OF DATA REACHED    */
@RF00335 LA    @08,4                                               0337
         CR    RETCODE,@08                                         0337
         BNE   @RF00337                                            0337
*     DO;                           /* SEND EOD OR LINE NOT FOUND    */
*       MSGPTR=0;                   /* NO 2ND 1ST LEVEL INSERTION    */
         SLR   @12,@12                                             0339
         ST    @12,MSGPTR(,COMMREG)                                0339
*       MSGLEN=LNSTARTL+4;          /* LENGTH OF INSERTION           */
         L     @07,TABPTR1                                         0340
         LH    @05,LNSTARTL(,@07)                                  0340
         ALR   @08,@05                                             0340
         STH   @08,MSGLEN(,COMMREG)                                0340
*       MSGOFF=22;                  /* OFFSET FOR INSERTION          */
         MVC   MSGOFF(2,COMMREG),@CH01346                          0341
*       MSGTEXT(1:LNSTARTL)=LNSTART->LNUM;/* INSERTION TEXT          */
         BCTR  @05,0                                               0342
         L     @08,LNSTART(,@07)                                   0342
         EX    @05,@SM01511                                        0342
*       RELMSG1=1290;               /* MSG IKJ52504I                 */
         MVC   RELMSG1(2),@CH01347                                 0343
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0344
*       LEV1INS=ADDR(MSGAREA);      /* PTR TO INSERTION              */
         LA    LEV1INS,MSGAREA(,COMMREG)                           0345
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         STH   @12,RELMSG2                                         0346
*       CHRETCD=8;                  /* INDICATE FLUSH IS NECESSARY   */
         MVC   CHRETCD(4),@CF00058                                 0347
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0348
*       RELMSG1=1286;               /* MSG IKJ52500I                 */
         MVC   RELMSG1(2),@CH01348                                 0349
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERTION        */
         SLR   LEV1INS,LEV1INS                                     0350
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             0351
         STH   @12,RELMSG2                                         0351
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0352
*       CALL SENDMSG;               /* SEND EOD MESSAGE TO USER      */
         BAL   @14,SENDMSG                                         0353
*       GO TO CHGEXIT2;             /* RETURN TO CALLER              */
         B     CHGEXIT2                                            0354
*     END;                                                         0355
*                                                                  0355
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LINE WITHIN RANGE SPECIFIED                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0356
*   IF KEYFLD>LNUM2&LNUM2¬=-1 THEN  /* IF NO, END PROCESSING         */
@RF00337 L     @12,LNUM2                                           0356
         C     @12,KEYFLD(,COMMREG)                                0356
         BNL   @RF00356                                            0356
         CH    @12,@CH01340                                        0356
         BNE   @RT00356                                            0356
*     GO TO NOLNMSG;                /* NOTIFY USER                   */
*                                                                  0358
*   /*****************************************************************/
*   /*                                                               */
*   /* ------------------------------------------------------- THIS  */
*   /* SECTION COLLECTS INFORMATION ABOUT THE REMAINING OPERANDS AND */
*   /* MAKES ANY NECESSARY CONVERSIONS, AND SEPARATES THE LOGIC FLOW */
*   /* INTO STRING CASES AND CHARACTER COUNT CASES, DEFAULTING TO    */
*   /* CHARACTER COUNT IF BOTH ARE SPECIFIED, AND CALLS THE          */
*   /* APPROPRIATE SUBROUTINE -- IN THE CASE OF A CHARACTER COUNT    */
*   /* OPERATION, VALIDITY CHECKING IS PERFORMED ON THE CHARACTER    */
*   /* COUNT, AND ANY FREEABLE CORE IS RELEASED -- IF THE CHARACTER  */
*   /* COUNT IS LARGER THAN THE DATA LINE LENGTH, THE USER IS        */
*   /* PROMPTED UNTIL HE ENTERS A VALID CHARACTER COUNT              */
*   /* -------------------------------------------------------       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0358
*PROCESS:                                                          0358
*   ;                               /* INIT VALUES FOR STRING CHG    */
*                                                                  0358
@RF00356 DS    0H                                                  0358
PROCESS  DS    0H                                                  0359
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THIRD OPERAND EXISTS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*   IF LNCNTF='1'B THEN             /* IF YES, RETRIEVE COUNT        */
         L     @12,TABPTR1                                         0359
         TM    LNCNTF(@12),B'10000000'                             0359
         BNO   @RF00359                                            0359
*     DO;                           /* CHARACTER COUNT SPECIFIED     */
*       PACKAREA='00000000';        /* SET TO ZONED ZEROES           */
         MVC   PACKAREA(8),@CC01322                                0361
*       PACKAREA(9-LNCNTL:8)=LNCNT->LNUM;/* MOVE NUMBER INTO AREA    */
         LA    @08,9                                               0362
         SH    @08,LNCNTL(,@12)                                    0362
         LA    @07,PACKAREA-1(@08)                                 0362
         LCR   @08,@08                                             0362
         AL    @08,@CF00058                                        0362
         L     @12,LNCNT(,@12)                                     0362
         EX    @08,@SM01505                                        0362
*       CALL CONVERT;               /* CONVERT TO BINARY             */
         BAL   @14,CONVERT                                         0363
*       CHARCNT=BINRYREG;           /* SET CHARACTER COUNT           */
         ST    BINRYREG,CHARCNT                                    0364
*       GO TO CNTCHK;               /* DEFAULT COUNT OPERATION       */
         B     CNTCHK                                              0365
*     END;                                                         0366
*                                                                  0366
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TEXT CHANGE SPECIFIED                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0367
*   IF STR1F='0'B THEN              /* IF YES, COUNT OPERATION       */
@RF00359 L     @12,TABPTR1                                         0367
         TM    STR1F(@12),B'10000000'                              0367
         BZ    @RT00367                                            0367
*     GO TO CNTCHK;                 /* VALIDITY CHECK COUNT          */
*   STR1PTR=STR1;                   /* PTR TO 1ST STRING             */
*                                                                  0369
         MVC   STR1PTR(4),STR1(@12)                                0369
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF FIRST STRING LENGTH TOO LARGE TO HANDLE              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0370
*   IF STR1L>256 THEN               /* IF YES, DEFAULT TO LARGEST    */
         LA    @08,256                                             0370
         CH    @08,STR1L(,@12)                                     0370
         BNL   @RF00370                                            0370
*     STR1L=256;                    /* LENGTH SET TO 256             */
*                                                                  0371
         STH   @08,STR1L(,@12)                                     0371
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF SECOND STRING LENGTH TOO LARGE TO HANDLE             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0372
*   IF STR2L>256 THEN               /* IF YES, DEFAULT TO LARGEST    */
@RF00370 LA    @12,256                                             0372
         L     @08,TABPTR1                                         0372
         CH    @12,STR2L(,@08)                                     0372
         BNL   @RF00372                                            0372
*     STR2L=256;                    /* LENGTH SET TO 256             */
         STH   @12,STR2L(,@08)                                     0373
*   STR2PTR=STR2;                   /* PTR TO 2ND STRING             */
@RF00372 L     @12,TABPTR1                                         0374
         MVC   STR2PTR(4),STR2(@12)                                0374
*   SEDCBPTR=CAPTCDCB;              /* INIT DCB PTR IN IKJEBESE PLT  */
         MVC   SEDCBPTR(4),CAPTCDCB(COMMREG)                       0375
*   SEBFRPTR=ADDR(CABFRPL);         /* INIT IKJEBESE PTR TO LIST     */
         LA    @12,CABFRPL(,COMMREG)                               0376
         ST    @12,SEBFRPTR                                        0376
*   SEOFFS=0;                       /* INITIALIZE OFFSET TO ZERO     */
         SLR   @12,@12                                             0377
         STH   @12,SEOFFS                                          0377
*   LECOMPTR=COMMREG;               /* INIT IKJEBELE COMMREG PTR     */
         ST    COMMREG,LECOMPTR                                    0378
*   CALL STRNGRTN;                  /* CONTINUE CHANGE               */
         BAL   @14,STRNGRTN                                        0379
*   GO TO CHNGEXIT;                 /* RETURN TO CALLER              */
         B     CHNGEXIT                                            0380
*CNTCHK:                                                           0381
*   ;                               /* CHARACTER COUNT VALIDITY CHK  */
*                                                                  0381
CNTCHK   DS    0H                                                  0382
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0382
*   IF CANONUM='0'B THEN            /* IF YES, ADJUST FOR SEQ.FLD    */
*                                                                  0382
         TM    CANONUM(COMMREG),B'00000001'                        0382
         BNZ   @RF00382                                            0382
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF SEQUENCE FIELD STARTS IN COLUMN ONE                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0383
*     IF CALINE='01'X THEN          /* IF YES, TEST BY FLD LENGTH    */
*                                                                  0383
         CLI   CALINE(COMMREG),X'01'                               0383
         BNE   @RF00383                                            0383
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF COUNT EXCEEDS LINE SIZE                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0384
*       IF CHARCNT<=CALRECL-CALENGTH-4 THEN/* IF NO, CONTINUE        */
         LH    @12,CALRECL(,COMMREG)                               0384
         SLR   @08,@08                                             0384
         IC    @08,CALENGTH(,COMMREG)                              0384
         SLR   @12,@08                                             0384
         SH    @12,@CH00599                                        0384
         C     @12,CHARCNT                                         0384
         BNL   @RT00384                                            0384
*         GO TO CNTPRCS;            /* SKIP PROMPT                   */
*       ELSE                                                       0386
*         ;                         /* IF YES, FALL THRU TO PROMPT   */
*     ELSE                          /* IF NO, TEST BY FLD START COL  */
*                                                                  0387
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF COUNT EXCEEDS LINE SIZE                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0387
*       IF CHARCNT<CALINE THEN      /* IF NO, CONTINUE               */
         B     @RC00383                                            0387
@RF00383 L     @12,CHARCNT                                         0387
         SLR   @08,@08                                             0387
         IC    @08,CALINE(,COMMREG)                                0387
         CR    @12,@08                                             0387
         BL    @RT00387                                            0387
*         GO TO CNTPRCS;            /* SKIP PROMPT                   */
*       ELSE                                                       0389
*         ;                         /* IF YES, FALL THRU TO PROMPT   */
*                                                                  0389
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF COUNT EXCEEDS LINE SIZE, NONUM DS                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0390
*   IF CANONUM='1'B&CHARCNT<=CALRECL-4 THEN/* IF YES, CONTINUE       */
@RC00383 DS    0H                                                  0390
@RF00382 TM    CANONUM(COMMREG),B'00000001'                        0390
         BNO   @RF00390                                            0390
         LH    @12,CALRECL(,COMMREG)                               0390
         SH    @12,@CH00599                                        0390
         C     @12,CHARCNT                                         0390
         BNL   @RT00390                                            0390
*     GO TO CNTPRCS;                /* SKIP PROMPT                   */
*   PPLPCL=ADDR(IKJEBCH3);          /* INIT IKJPARS PARMLIST         */
@RF00390 L     @12,PPLPTR                                          0392
         L     @08,@CV00511                                        0392
         ST    @08,PPLPCL(,@12)                                    0392
*   PPLANS=ADDR(TABPTR3);           /* PTR TO PDL                    */
         LA    @08,TABPTR3                                         0393
         ST    @08,PPLANS(,@12)                                    0393
*   PPLCBUF=ADDR(BLANKBFR);         /* PTR TO BLANK BUFFER           */
         LA    @08,BLANKBFR(,COMMREG)                              0394
         ST    @08,PPLCBUF(,@12)                                   0394
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT USED   */
         SLR   @08,@08                                             0395
         ST    @08,PPLUWA(,@12)                                    0395
*   BLANKOFF=0;                     /* OFFSET FOR SCANNING           */
         STH   @08,BLANKOFF(,COMMREG)                              0396
*   BLANKTXT='';                    /* BLANK OUT BUFFER              */
         MVI   BLANKTXT(COMMREG),C' '                              0397
         MVC   BLANKTXT+1(5,COMMREG),BLANKTXT(COMMREG)             0397
*   BLANKLEN=LENGTH(BLANKBFR);      /* LENGTH OF BUFFER              */
*                                                                  0398
         MVC   BLANKLEN(2,COMMREG),@CH00538                        0398
*   /*****************************************************************/
*   /*                                                               */
*   /* PROMPT AND PARSE FOR VALID CHARACTER COUNT                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */
*     RESPECIFY                                                    0400
*       GPR01P RSTD;                                               0400
*     GPR01P=ADDR(PPL);                                            0401
         LR    GPR01P,@12                                          0401
*     IF CVTPARS=0 THEN                                            0402
         L     @12,CVTPTR                                          0402
         C     @08,CVTPARS(,@12)                                   0402
         BNE   @RF00402                                            0402
*       GEN(LINK EP=IKJPARS);                                      0403
         LINK EP=IKJPARS
*     ELSE                                                         0404
*       CALL CVTPARS;                                              0404
         B     @RC00402                                            0404
@RF00402 L     @12,CVTPTR                                          0404
         L     @15,CVTPARS(,@12)                                   0404
         BALR  @14,@15                                             0404
*     RESPECIFY                                                    0405
*       GPR01P UNRSTD;                                             0405
@RC00402 DS    0H                                                  0406
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */
*                                                                  0407
         LR    RETCODE,RETCDREG                                    0407
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM IKJPARS                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*   IF RETCODE¬=0 THEN              /* IF NO, TERMINAL ERROR         */
         LTR   RETCODE,RETCODE                                     0408
         BNZ   @RT00408                                            0408
*     GO TO PARSERR;                /* PROCESS ERROR                 */
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */
         MVC   PACKAREA(8),@CC01322                                0410
*   PACKAREA(9-CHCNTL:8)=CHCNT->LNUM;/* MOVE COUNT INTO WORK AREA    */
         L     @12,TABPTR3                                         0411
         LA    @08,9                                               0411
         SH    @08,CHCNTL(,@12)                                    0411
         LA    @07,PACKAREA-1(@08)                                 0411
         LCR   @08,@08                                             0411
         AL    @08,@CF00058                                        0411
         L     @12,CHCNT(,@12)                                     0411
         EX    @08,@SM01505                                        0411
*   CALL CONVERT;                   /* CONVERT TO BINARY             */
         BAL   @14,CONVERT                                         0412
*   CHARCNT=BINRYREG;               /* SAVE CHARACTER COUNT          */
         ST    BINRYREG,CHARCNT                                    0413
*   PARMREG1=ADDR(TABPTR3);         /* PTR TO PROMPT PDL             */
         LA    PARMREG1,TABPTR3                                    0414
*   GEN(IKJRLSA (1));               /* RELEASE PDL CORE              */
         IKJRLSA (1)
*   GO TO CNTCHK;                   /* CONTINUE PROCESSING           */
         B     CNTCHK                                              0416
*CNTPRCS:                                                          0417
*   CNTSW='1'B;                     /* INDICATE COUNT OPERATION      */
CNTPRCS  OI    CNTSW,B'00100000'                                   0417
*   LECOMPTR=COMMREG;               /* INIT IKJEBELE COMMREG PTR     */
         ST    COMMREG,LECOMPTR                                    0418
*   CHARCNT=BINRYREG;               /* SAVE CHARACTER COUNT          */
         ST    BINRYREG,CHARCNT                                    0419
*   CALL CHARRTN;                   /* CONTINUE CHANGE               */
         BAL   @14,CHARRTN                                         0420
*   GO TO CHNGEXIT;                 /* RETURN TO CALLER              */
         B     CHNGEXIT                                            0421
*                                                                  0422
*   /*****************************************************************/
*   /*                                                               */
*   /* ------------------------------------------------------- THIS  */
*   /* SECTION PROCESSES SYSTEM ORIENTED ERRORS AND CONTAINS THE     */
*   /* GENERAL EXIT CODE (FREEMAIN OF INPUT BUFFER AND RELEASE OF PDL*/
*   /* CORE IF REQUIRED) FOR UNSUCCESSFUL CHANGE OPERATIONS          */
*   /* -------------------------------------------------------       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*PUTERR:                                                           0422
*   ;                               /* PROCESS IKJPUTL ERROR RETURN  */
*                                                                  0422
PUTERR   DS    0H                                                  0423
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NO CORE AVAILABLE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*   IF RETCODE=16 THEN              /* IF YES, NOTIFY USER           */
         CH    RETCODE,@CH00233                                    0423
         BNE   @RF00423                                            0423
*     DO;                           /* SEND NOT ENOUGH CORE MSG      */
*NOCORMSG:                                                         0425
*       RELMSG1=270;                /* MSG IKJ52312I                 */
NOCORMSG MVC   RELMSG1(2),@CH01356                                 0425
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0426
*       MSGPTR=0;                   /* ONLY ONE INSERTION            */
         SLR   @12,@12                                             0427
         ST    @12,MSGPTR(,COMMREG)                                0427
*       MSGLEN=CASCMDLN+4;          /* SET LENGTH                    */
         LA    @08,4                                               0428
         AH    @08,CASCMDLN(,COMMREG)                              0428
         STH   @08,MSGLEN(,COMMREG)                                0428
*       MSGOFF=45;                  /* OFFSET FOR INSERT             */
         MVC   MSGOFF(2,COMMREG),@CH01358                          0429
*       MSGTEXT=CAPTSCMD->LNUM;     /* MOVE INSERT INTO BFR          */
         MVI   MSGTEXT+8(COMMREG),C' '                             0430
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0430
         L     @08,CAPTSCMD(,COMMREG)                              0430
         MVC   MSGTEXT(8,COMMREG),LNUM(@08)                        0430
*       LEV1INS=ADDR(MSGPTR);       /* PTR TO INSERT                 */
         LA    LEV1INS,MSGPTR(,COMMREG)                            0431
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */
         STH   @12,RELMSG2                                         0432
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0433
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */
         B     FLUSH                                               0434
*     END;                                                         0435
*                                                                  0435
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTENTION ISSUED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0436
*   IF RETCODE=4 THEN               /* IF YES, ERROR TERMINAL        */
@RF00423 CH    RETCODE,@CH00599                                    0436
         BE    @RT00436                                            0436
*     GO TO CHNGEXIT;               /* RETURN TO CALLER              */
*   MSGTEXT='PUTLINE';              /* 'PUTLINE' INSERTION           */
         MVI   MSGTEXT+7(COMMREG),C' '                             0438
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0438
         MVC   MSGTEXT(7,COMMREG),@CC01359                         0438
*   MSGLEN=LENGTH('PUTLINE')+4;     /* SET LENGTH OF INSERT          */
         MVC   MSGLEN(2,COMMREG),@CH00033                          0439
*   GO TO SYSERR;                   /* PROCESS SYSTEM ERROR          */
         B     SYSERR                                              0440
*GETERR:                                                           0441
*   ;                               /* PROCESS IKJGETL ERROR RETURN  */
*                                                                  0441
GETERR   DS    0H                                                  0442
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NO CORE AVAILABLE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0442
*   IF RETCODE=24 THEN              /* IF YES, ERROR TERMINAL        */
         CH    RETCODE,@CH00236                                    0442
         BE    @RT00442                                            0442
*     GO TO NOCORMSG;               /* NOTIFY USER                   */
*                                                                  0443
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTENTION ISSUED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0444
*   IF RETCODE=8 THEN               /* IF YES, ERROR TERMINAL        */
         CH    RETCODE,@CH00058                                    0444
         BE    @RT00444                                            0444
*     GO TO CHNGEXIT;               /* RETURN TO CALLER              */
*   MSGTEXT='GETLINE';              /* 'GETLINE' INSERTION           */
         MVI   MSGTEXT+7(COMMREG),C' '                             0446
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0446
         MVC   MSGTEXT(7,COMMREG),@CC01362                         0446
*   MSGLEN=LENGTH('GETLINE')+4;     /* SET LENGTH OF INSERT          */
         MVC   MSGLEN(2,COMMREG),@CH00033                          0447
*   GO TO SYSERR;                   /* PROCESS SYSTEM ERROR          */
         B     SYSERR                                              0448
*PARSERR:                                                          0449
*   ;                               /* PROCESS IKJPARS ERROR RETURN  */
*                                                                  0449
PARSERR  DS    0H                                                  0450
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NO CORE AVAILABLE FOR IKJPARS PDL                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*   IF RETCODE=16 THEN              /* IF YES, ERROR TERMINAL        */
         CH    RETCODE,@CH00233                                    0450
         BE    @RT00450                                            0450
*     GO TO NOCORMSG;               /* NOTIFY USER                   */
*                                                                  0451
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF SYSTEM ERROR ENCOUNTERED                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0452
*   IF RETCODE=4 THEN               /* IF YES,FLUSH NECESSARY        */
         CH    RETCODE,@CH00599                                    0452
         BE    @RT00452                                            0452
*     GO TO FLUSH;                  /* BRANCH TO INDICATE FLUSH      */
*   IF RETCODE=8 THEN               /* IF NO, NO MESSAGE             */
         CH    RETCODE,@CH00058                                    0454
         BE    @RT00454                                            0454
*     GO TO CHGEXIT2;               /* RETURN TO CALLER              */
*   MSGTEXT='PARSE';                /* 'PARSE' INSERTION             */
         MVI   MSGTEXT+5(COMMREG),C' '                             0456
         MVC   MSGTEXT+6(66,COMMREG),MSGTEXT+5(COMMREG)            0456
         MVC   MSGTEXT(5,COMMREG),@CC01364                         0456
*   MSGLEN=LENGTH('PARSE')+4;       /* SET INSERT LENGTH             */
         MVC   MSGLEN(2,COMMREG),@CH01323                          0457
*SYSERR:                                                           0458
*   ;                               /* SEND CMD SYSTEM ERROR MSG     */
*                                                                  0458
SYSERR   DS    0H                                                  0459
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT RETURN CODE FROM REGISTER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0459
*   RETCDREG=RETCODE;               /* RECOVER RETURN CODE           */
         LR    RETCDREG,RETCODE                                    0459
*   GENERATE REFS(RETCDREG,COMMREG,PACKAREA);                      0460
         CVD   RETCDREG,PACKAREA                CONVERT TO DECIMAL
         UNPK MSGTEXT2(3,COMMREG),PACKAREA+6(2)
         MVN   MSGTEXT2(2,COMMREG),MSGTEXT2+1(COMMREG) MOVE
*   RELMSG1=271;                    /* MSG IKJ52313I                 */
         MVC   RELMSG1(2),@CH01366                                 0461
*   LEV1INS=0;                      /* NO 1ST LEVEL INSERTION        */
         SLR   LEV1INS,LEV1INS                                     0462
*   RELMSG2=1;                      /* 2ND LEVEL MESSAGE             */
         MVC   RELMSG2(2),@CH00060                                 0463
*   MSGLEN2=2+4;                    /* SET LENGTH OF 2ND INSERT      */
         MVC   MSGLEN2(2,COMMREG),@CH00507                         0464
*   MSGOFF=10;                      /* OFFSET FOR INSERT             */
         MVC   MSGOFF(2,COMMREG),@CH00538                          0465
*   MSGPTR2=0;                      /* INDICATE LAST INSERTION       */
         SLR   @12,@12                                             0466
         ST    @12,MSGPTR2(,COMMREG)                               0466
*   MSGPTR=ADDR(MSGPTR2);           /* CHAIN MESSAGES                */
         LA    @12,MSGPTR2(,COMMREG)                               0467
         ST    @12,MSGPTR(,COMMREG)                                0467
*   MSGOFF2=22;                     /* OFFSET FOR INSERT             */
         MVC   MSGOFF2(2,COMMREG),@CH01346                         0468
*   LEV2INS=ADDR(MSGPTR);           /* PTR TO INSERT                 */
         LA    LEV2INS,MSGPTR(,COMMREG)                            0469
*   CALL SENDMSG;                   /* PRODUCE MESSAGE               */
         BAL   @14,SENDMSG                                         0470
*FLUSH:                                                            0471
*   CHRETCD=8;                      /* INDICATE FLUSH IS NECESSARY   */
FLUSH    MVC   CHRETCD(4),@CF00058                                 0471
*CHGEXIT2:                                                         0472
*   ;                               /* BEGIN EXIT PROCESSING         */
*                                                                  0472
CHGEXIT2 DS    0H                                                  0473
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PROMPTING PERFORMED                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*   IF PROMPTSW='1'B THEN           /* IF YES, FREE BUFFER & PDL     */
         TM    PROMPTSW,B'10000000'                                0473
         BNO   @RF00473                                            0473
*     DO;                           /* PREPARE TO FREE CORE          */
*       FREEAREA=GTPBIBUF;          /* PTR TO INPUT PROMPT LINE      */
         L     @12,GTPBPTR                                         0475
         L     @12,GTPBIBUF(,@12)                                  0475
         ST    @12,FREEAREA                                        0475
*       FREELEN=BFRLEN;             /* LENGTH OF BUFFER              */
         LH    @12,BFRLEN(,@12)                                    0476
         ST    @12,FREELEN                                         0476
*       BINRYREG=ADDR(FREEAREA);    /* PTR TO AREA INFO              */
         LA    BINRYREG,FREEAREA                                   0477
*       FREELIST=FREELIST&&FREELIST;/* ZERO LIST                     */
         XC    FREELIST(12),FREELIST                               0478
*       PARMREG1=ADDR(FREELIST);    /* PTR TO LIST FORM              */
*                                                                  0479
         LA    PARMREG1,FREELIST                                   0479
*       /*************************************************************/
*       /*                                                           */
*       /* FREEMAIN INPUT BUFFER                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0480
*       GENERATE REFS(BINRYREG);                                   0480
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))
*       PARMREG1=ADDR(TABPTR2);     /* PTR TO PROMPT PDL             */
         LA    PARMREG1,TABPTR2                                    0481
*     END;                                                         0482
*   ELSE                            /* FREE MAIN PDL                 */
*     PARMREG1=ADDR(TABPTR1);       /* PTR TO MAIN PDL               */
*                                                                  0483
         B     @RC00473                                            0483
@RF00473 LA    PARMREG1,TABPTR1                                    0483
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF IKJPARS CALLED                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   IF FIRSTCHG='1'B THEN           /* IF YES, PDL TO FREE           */
@RC00473 TM    FIRSTCHG,B'01000000'                                0484
         BNO   @RF00484                                            0484
*     GEN(IKJRLSA (1));             /* RELEASE PDL CORE              */
         IKJRLSA (1)
*CHNGEXIT:                                                         0486
*   ;                               /* ERROR EXIT                    */
@RF00484 DS    0H                                                  0486
CHNGEXIT DS    0H                                                  0487
*   RETCDREG=CHRETCD;               /* SET RETURN CODE REGISTER      */
         L     RETCDREG,CHRETCD                                    0487
*   RESPECIFY                                                      0488
*    (GPR12P,                                                      0488
*     GPR13P) RSTD;                                                0488
*   CANXTSVA=GPR13P;                /* UPDATE NEXT-SAVE-AREA PTR     */
         ST    GPR13P,CANXTSVA(,COMMREG)                           0489
*   GPR12P=GPR13P;                  /* SAVE PRESENT SAVE-AREA ADDR   */
         LR    GPR12P,GPR13P                                       0490
*   GPR13P=(GPR13P+4)->CASAVPTR;    /* GET BACKWARD SAVE-AREA PTR    */
         L     @08,CASAVPTR+4(,GPR13P)                             0491
         LR    GPR13P,@08                                          0491
*   RESPECIFY                                                      0492
*     CASAVE BASED(GPR12P);         /* CHANGE BASE FOR SAVE-AREA     */
*   CASAVE=CASAVE&&CASAVE;          /* ZERO OUT THIS SAVE-AREA       */
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0493
*   RESPECIFY                                                      0494
*     CASAVE BASED;                                                0494
*   RETURN CODE(RETCDREG);          /* RETURN WITH RETURN CODE       */
         L     @14,12(,@13)                                        0495
         LM    @00,@12,20(@13)                                     0495
         BR    @14                                                 0495
*   RESPECIFY                                                      0496
*    (GPR12P,                                                      0496
*     GPR13P) UNRSTD;               /* RETURN TO CALLER              */
*                                                                  0497
*   /*****************************************************************/
*   /*                                                               */
*   /* PROMPT PCL LIST                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0497
*   GENERATE DATA DEFS(CHPCE);                                     0497
*                                                                  0498
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE CONVERTS THE LINE NUMBER OR COUNT OPERANDS    */
*   /* FROM ZONED DECIMAL TO BINARY. THE BINARY VALUE IS RETURNED TO */
*   /* THE CALLER IN REGISTER 4.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0498
*CONVERT:                                                          0498
*   PROC OPTIONS(NOSAVEAREA,SAVE(14));/* SUBRTN ENTRY POINT          */
*                                                                  0498
@EL00001 DS    0H                                                  0498
@EF00001 DS    0H                                                  0498
@ER00001 LM    @14,@12,12(@13)                                     0498
         BR    @14                                                 0498
CONVERT  ST    @14,12(,@13)                                        0498
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATE CONVERSION                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*   GENERATE REFS(BINRYREG,PACKAREA);                              0499
         PACK  PACKAREA(8),PACKAREA(8)
         CVB   BINRYREG,PACKAREA                CONVERT TO BINARY
*   RETURN;                         /* RETURN TO CALLER              */
@EL00002 DS    0H                                                  0500
@EF00002 DS    0H                                                  0500
@ER00002 L     @14,12(,@13)                                        0500
         BR    @14                                                 0500
*   END CONVERT;                    /* END OF SUBROUTINE             */
*                                                                  0502
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PERFORMS ALL THE READ OPERATIONS FROM THE EDIT*/
*   /* DATA SET. THE IKJEBESH MACRO IS USED TO CALL IKJEBEUT(EDIT    */
*   /* ACCESS METHOD INTERFACE) VIA THE SERVICE ROUTINE HANDLER. THE */
*   /* PARAMETER LIST PASSED TO IKJEBEUT IS INITIATIZED BY THE CALLER*/
*   /* AND THE RETURN CODE FROM IKJEBEUT IS SAVED IN AREA RETCODE.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0502
*RDWRTRTN:                                                         0502
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY POINT            */
*                                                                  0502
RDWRTRTN DS    0H                                                  0503
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTRICT USE OF REGISTERS USED BY PROGRAM                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0503
*   RESPECIFY                                                      0503
*    (PARMREG1,                                                    0503
*     BINRYREG,                                                    0503
*     COMMREG,                                                     0503
*     BASEREG,                                                     0503
*     DATAREG) RSTD;                                               0503
*   RESPECIFY                                                      0504
*    (BASEREG2) RSTD;                                              0504
*   READPTR=RETREG;                 /* SAVE RETURN POINT ADDRESS     */
*                                                                  0505
         LR    READPTR,RETREG                                      0505
*   /*****************************************************************/
*   /*                                                               */
*   /* READ RECORD                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0506
*   GENERATE REFS(COMMREG,UTPLIST);                                0506
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        X
               MF=(E,SRPLIST)
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */
         LR    RETCODE,RETCDREG                                    0507
*   RCDPTR=PARMREG1;                /* SAVE PTR TO RECORD IN REG1    */
*                                                                  0508
         ST    PARMREG1,RCDPTR                                     0508
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF I/O ERROR OCCURRED IN EDIT DATA SET                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0509
*   IF RETCODE=8 THEN               /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00058                                    0509
         BNE   @RF00509                                            0509
*     CHRETCD=12;                   /* SET ERROR CODE                */
         MVC   CHRETCD(4),@CF00143                                 0510
*   RETREG=READPTR;                 /* RESTORE RETURN POINT ADDRESS  */
@RF00509 LR    RETREG,READPTR                                      0511
*   RETURN;                         /* SUCCESSFUL COMPLETION         */
@EL00003 DS    0H                                                  0512
@EF00003 DS    0H                                                  0512
@ER00003 BR    @14                                                 0512
*   END RDWRTRTN;                   /* END OF SUBROUTINE             */
*                                                                  0514
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE USES THE EDIT MACRO IKJEBEML TO SEND MESSAGES */
*   /* TO THE USER.                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0514
*SENDMSG:                                                          0514
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY PT               */
*                                                                  0514
SENDMSG  DS    0H                                                  0515
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTRICT USE OF REGISTERS USED BY PROGRAM                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0515
*   RESPECIFY                                                      0515
*    (PARMREG1,                                                    0515
*     BINRYREG,                                                    0515
*     COMMREG,                                                     0515
*     BASEREG,                                                     0515
*     DATAREG,                                                     0515
*     BASEREG2,                                                    0515
*     LEV1INS,                                                     0515
*     LEV2INS) RSTD;                                               0515
*   SENDPTR=RETREG;                 /* SAVE RETURN POINT ADDRESS     */
         LR    SENDPTR,RETREG                                      0516
*   GENERATE;                                                      0517
CALLBEMS  IKJEBEML  ,,(LEV1INS),(LEV2INS),MF=(E,SRPLIST)
*   RESPECIFY                                                      0518
*    (LEV1INS,                                                     0518
*     LEV2INS) UNRSTD;                                             0518
*   RETREG=SENDPTR;                 /* RESTORE RETURN POINT ADDRESS  */
         LR    RETREG,SENDPTR                                      0519
*   RETURN;                         /* RETURN TO CALLER              */
@EL00004 DS    0H                                                  0520
@EF00004 DS    0H                                                  0520
@ER00004 BR    @14                                                 0520
*   END SENDMSG;                    /* END OF SUBROUTINE             */
*                                                                  0522
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*    THIS SUBROUTINE OF THE CHANGE SUBCOMMAND OF EDIT MODIFIES     */
*/*    LINE(S) WITHIN THE EDIT DATA SET BY PRINTING THE LINE(S) TO   */
*/*    THE TERMINAL AND ALLOWING THE USER TO COMPLETE THE LINE(S) AT */
*/*    THE TERMINAL.  THIS OPERATION IS PERFORMED WHEN THE USER      */
*/*    SPECIFIES EITHER A NUMERIC CHARACTER COUNT OR A STRING AT     */
*/*    WHICH HE WANTS TO START MODIFYING THE LINE.  AFTER THE USER   */
*/*    UPDATES THE LINE, IT IS WRITTEN BACK INTO THE DATA SET. IF THE*/
*/*    DATA SET TYPE IS BASIC OR IPLI, THE REVERSE POLISH DATA SET IS*/
*/*    UPDATED.  IF THE DATA SET TYPE IS NON-LINE NUMBERED TEXT,     */
*/*    OVERFLOW LINES, IF ANY, ARE CREATED.  THE CURRENT LINE POINTER*/
*/*    IS UPDATED TO THE LAST LINE CHANGED. CONTROL IS THEN RETURNED */
*/*    TO IKJEBEMA VIA IKJEBECH WITH A RETURN CODE IN REG. FIFTEEN.  */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0522
*CHARRTN:                                                          0522
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY PT               */
*                                                                  0522
CHARRTN  DS    0H                                                  0523
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTERS WITH SPECIAL USE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0523
*   RESPECIFY                                                      0523
*    (PARMREG1,                                                    0523
*     BINRYREG,                                                    0523
*     COMMREG,                                                     0523
*     BASEREG,                                                     0523
*     DATAREG) RSTD;                                               0523
*   RESPECIFY                                                      0524
*    (BASEREG2) RSTD;                                              0524
*   CHARPTR=RETREG;                 /* SAVE RETURN POINT             */
         ST    RETREG,CHARPTR                                      0525
*   VERCNT=0;                       /* INITIALIZE VERIFY CT TO ZERO  */
         SLR   @12,@12                                             0526
         ST    @12,VERCNT                                          0526
*   PTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO PUTLINE PARMBLK   */
         LA    @12,PTGTLIST                                        0527
         ST    @12,PTPBPTR                                         0527
*   GTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO GETLINE PARMBLK   */
         ST    @12,GTPBPTR                                         0528
*CNTPRCS2:                          /* START OF MAIN LOOP            */
*                                                                  0529
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PROMPT BUFFER TO BE FREED                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*   IF PROMPTSW='1'B THEN           /* IF YES, FREE PROMPT BUFFER    */
CNTPRCS2 TM    PROMPTSW,B'10000000'                                0529
         BNO   @RF00529                                            0529
*     DO;                           /* INIT PARMLIST AND FREEMAIN    */
*       FREEAREA=GTPBIBUF;          /* PTR TO PROMPT BFR             */
         L     @12,GTPBPTR                                         0531
         L     @12,GTPBIBUF(,@12)                                  0531
         ST    @12,FREEAREA                                        0531
*       FREELEN=BFRLEN;             /* LENGTH OF BUFFER              */
         LH    @12,BFRLEN(,@12)                                    0532
         ST    @12,FREELEN                                         0532
*       BINRYREG=ADDR(FREEAREA);    /* PTR TO AREA INFORMATION       */
         LA    BINRYREG,FREEAREA                                   0533
*       FREELIST=FREELIST&&FREELIST;/* ZERO OUT LIST FORM            */
         XC    FREELIST(12),FREELIST                               0534
*       PARMREG1=ADDR(FREELIST);    /* PTR TO LFORM                  */
*                                                                  0535
         LA    PARMREG1,FREELIST                                   0535
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE FREEMAIN MACRO TO FREE BUFFER CORE                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0536
*       GENERATE REFS(BINRYREG);                                   0536
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))
*     END;                                                         0537
*                                                                  0537
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0538
*   IF CANONUM='0'B THEN            /* IF YES, STRIP SEQUENCE FIELD  */
@RF00529 TM    CANONUM(COMMREG),B'00000001'                        0538
         BNZ   @RF00538                                            0538
*     DO;                           /* PREPARE LINE NUMBERED RCD     */
*                                                                  0539
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF SEQUENCE FIELD STARTS IN COL ONE                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0540
*       IF CALINE='01'X THEN        /* IF YES, REMOVE SEQ FIELD      */
         CLI   CALINE(COMMREG),X'01'                               0540
         BNE   @RF00540                                            0540
*         DO;                                                      0541
*                                                                  0541
*           /*********************************************************/
*           /*                                                       */
*           /* SLIDE DATA OVER SEQ FIELD                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0542
*           MVC(RECTEXT(1:RECLEN-CALENGTH-4),RECTEXT(CALENGTH+1:RECLEN-
*               4));                                               0542
*                                                                  0542
         LH    @12,RECLEN(,COMMREG)                                0542
         SLR   @08,@08                                             0542
         IC    @08,CALENGTH(,COMMREG)                              0542
         SLR   @12,@08                                             0542
         SH    @12,@CH00130                                        0542
         SLR   @08,@08                                             0542
         IC    @08,CALENGTH(,COMMREG)                              0542
         ALR   @08,COMMREG                                         0542
         EX    @12,@SM01514                                        0542
*           /*********************************************************/
*           /*                                                       */
*           /* ADJUST LL FIELD FOR VAR. LINES                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0543
*           RECLEN=RECLEN-CALENGTH;                                0543
         SLR   @12,@12                                             0543
         IC    @12,CALENGTH(,COMMREG)                              0543
         LCR   @12,@12                                             0543
         AH    @12,RECLEN(,COMMREG)                                0543
         STH   @12,RECLEN(,COMMREG)                                0543
*         END;                                                     0544
*       ELSE                        /* IF NO, ADJUST FOR FIXED LNS   */
*         RECLEN=CALINE+3;          /* ADJUST LL                     */
         B     @RC00540                                            0545
@RF00540 LA    @12,3                                               0545
         SLR   @08,@08                                             0545
         IC    @08,CALINE(,COMMREG)                                0545
         ALR   @12,@08                                             0545
         STH   @12,RECLEN(,COMMREG)                                0545
*     END;                                                         0546
@RC00540 DS    0H                                                  0547
*   RECTEXT(RECLEN-3)=' ';          /* BLANK REST OF RECORD          */
@RF00538 LH    @12,RECLEN(,COMMREG)                                0547
         ALR   @12,COMMREG                                         0547
         MVI   RECTEXT-4(@12),C' '                                 0547
*   MVC(RECTEXT(RECLEN-2:255),RECTEXT(RECLEN-3:254));              0548
         LH    @12,RECLEN(,COMMREG)                                0548
         ALR   @12,COMMREG                                         0548
         LA    @08,257                                             0548
         SH    @08,RECLEN(,COMMREG)                                0548
         LH    @07,RECLEN(,COMMREG)                                0548
         ALR   @07,COMMREG                                         0548
         EX    @08,@SM01516                                        0548
*   RECLEN=CHARCNT+4;               /* SET LENGTH FOR DATA           */
*                                                                  0549
         L     @12,CHARCNT                                         0549
         LA    @08,4                                               0549
         ALR   @08,@12                                             0549
         STH   @08,RECLEN(,COMMREG)                                0549
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF CHARACTER COUNT EQUALS ZERO                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0550
*   IF CHARCNT=0 THEN               /* IF YES, BY-PASS PUTLINE       */
         LTR   @12,@12                                             0550
         BZ    @RT00550                                            0550
*     GO TO NOPUTLN;                /* PREPARE TO ISSUE GETLINE      */
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO OUT PARM BLOCK           */
         XC    PTGTLIST(20),PTGTLIST                               0552
*   BINRYREG=ADDR(RECLEN);          /* PTR TO PART TO LINE TO PRINT  */
         LA    BINRYREG,RECLEN(,COMMREG)                           0553
*   PARMREG1=IOPLPTR;               /* PTR TO PUTLINE PARMLIST       */
         L     @12,IOPLPTR                                         0554
         LR    PARMREG1,@12                                        0554
*   IOPLIOPB=PTPBPTR;               /* PTR TO PUTLINE PARM BLOCK     */
*                                                                  0555
         MVC   IOPLIOPB(4,@12),PTPBPTR                             0555
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE PUTLINE MACRO TO CALL IKJPUTL                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0556
*   GENERATE REFS(BINRYREG);                                       0556
         PUTLINE ,OUTPUT=((BINRYREG),TERM,SINGLE,DATA),                X
               TERMPUT=(ASIS,WAIT,NOHOLD,NOBREAK),MF=(E,(1))
*   RESPECIFY                                                      0557
*    (RETCDREG) RSTD;                                              0557
*                                                                  0557
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM PUTLINE                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0558
*   IF RETCDREG=0 THEN              /* IF YES, CONTINUE PROCESSING   */
         LTR   RETCDREG,RETCDREG                                   0558
         BZ    @RT00558                                            0558
*     GO TO NOPUTLN;                /* PREPARE TO ISSUE GETLINE      */
*                                                                  0560
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NO CORE AVAILABLE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0560
*   IF RETCDREG=16 THEN             /* IF YES, NOTIFY USER           */
         CH    RETCDREG,@CH00233                                   0560
         BNE   @RF00560                                            0560
*     DO;                           /* SEND MESSAGE TO USER          */
*NOCORMS1:                                                         0562
*       RELMSG1=270;                /* MSG IKJ52312I                 */
NOCORMS1 MVC   RELMSG1(2),@CH01356                                 0562
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */
*                                                                  0563
         SLR   LEV2INS,LEV2INS                                     0563
*       /*************************************************************/
*       /*                                                           */
*       /* USE REGS TO PASS PARAMETERS                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0564
*       MSGPTR=0;                   /* ONLY ONE INSERTION            */
         SLR   @14,@14                                             0564
         ST    @14,MSGPTR(,COMMREG)                                0564
*       MSGLEN=CASCMDLN+4;          /* LENGTH                        */
         LA    @12,4                                               0565
         AH    @12,CASCMDLN(,COMMREG)                              0565
         STH   @12,MSGLEN(,COMMREG)                                0565
*       MSGOFF=45;                  /* OFFSET FOR INSERTION          */
         MVC   MSGOFF(2,COMMREG),@CH01358                          0566
*       MSGTEXT=CAPTSCMD->LNUM;     /* INSERTION TEXT                */
         MVI   MSGTEXT+8(COMMREG),C' '                             0567
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0567
         L     @12,CAPTSCMD(,COMMREG)                              0567
         MVC   MSGTEXT(8,COMMREG),LNUM(@12)                        0567
*       LEV1INS=ADDR(MSGPTR);       /* PTR TO INSERTION              */
         LA    LEV1INS,MSGPTR(,COMMREG)                            0568
*       RELMSG2=0;                  /* NO SECOND LEVEL MSG           */
         STH   @14,RELMSG2                                         0569
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0570
*       CHRETCD=8;                  /* INDICATE FLUSH                */
         MVC   CHRETCD(4),@CF00058                                 0571
*       GO TO CHGEXIT3;             /* RETURN TO CALLER              */
         B     CHGEXIT3                                            0572
*     END;                                                         0573
*                                                                  0573
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTENTION ISSUED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0574
*   IF RETCDREG=4 THEN              /* IF YES, RETURN TO CALLER      */
@RF00560 CH    RETCDREG,@CH00599                                   0574
         BE    @RT00574                                            0574
*     GO TO NOTEXT;                 /* BEGIN EXIT PROCESSING         */
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */
         LR    RETCODE,RETCDREG                                    0576
*   RESPECIFY                                                      0577
*    (RETCDREG) UNRSTD;                                            0577
*   MSGTEXT='PUTLINE';              /* INSERTION TEXT                */
         MVI   MSGTEXT+7(COMMREG),C' '                             0578
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0578
         MVC   MSGTEXT(7,COMMREG),@CC01359                         0578
*   MSGLEN=LENGTH('PUTLINE')+4;     /* LENGTH OF INSERTION           */
         MVC   MSGLEN(2,COMMREG),@CH00033                          0579
*SYSERR1:                                                          0580
*   ;                               /* FINISH INSERTION & ISSUE MSG  */
*                                                                  0580
SYSERR1  DS    0H                                                  0581
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT RETURN CODE TO PRINTABLE CHARACTER                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*   RETCDREG=RETCODE;               /* RESTORE RET CODE TO REG 15    */
         LR    RETCDREG,RETCODE                                    0581
*   GENERATE REFS(RETCDREG,COMMREG,PACKAREA);                      0582
         CVD   RETCDREG,PACKAREA                CONVERT TO DECIMAL
         UNPK  MSGTEXT2(3,COMMREG),PACKAREA+6(2)   UNPK NUM
         MVN   MSGTEXT2(2,COMMREG),MSGTEXT2+1(COMMREG) SET SIGN
*   RELMSG1=271;                    /* RELATIVE MSG NUMBER           */
         MVC   RELMSG1(2),@CH01366                                 0583
*   LEV1INS=0;                      /* NO FIRST LEVEL INSERTION      */
         SLR   LEV1INS,LEV1INS                                     0584
*   RELMSG2=1;                      /* SECOND LEVEL MSG              */
         MVC   RELMSG2(2),@CH00060                                 0585
*   MSGOFF=10;                      /* OFFSET FOR INSERTION TEXT     */
         MVC   MSGOFF(2,COMMREG),@CH00538                          0586
*   MSGPTR=ADDR(MSGPTR2);           /* CHAIN MESSAGES                */
         LA    @12,MSGPTR2(,COMMREG)                               0587
         ST    @12,MSGPTR(,COMMREG)                                0587
*   MSGPTR2=0;                      /* INDICATE LAST INSERTION       */
         SLR   @12,@12                                             0588
         ST    @12,MSGPTR2(,COMMREG)                               0588
*   MSGLEN2=6;                      /* LENGTH OF INSERTION           */
         MVC   MSGLEN2(2,COMMREG),@CH00507                         0589
*   MSGOFF2=22;                     /* OFFSET FOR INSERTION          */
         MVC   MSGOFF2(2,COMMREG),@CH01346                         0590
*   LEV2INS=ADDR(MSGPTR);           /* PTR TO INSERTION              */
         LA    LEV2INS,MSGPTR(,COMMREG)                            0591
*   CALL SENDMSG;                   /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0592
*   CHRETCD=8;                      /* INDICATE FLUSH                */
         MVC   CHRETCD(4),@CF00058                                 0593
*   GO TO CHGEXIT3;                 /* RETURN TO CALLER              */
*                                                                  0594
         B     CHGEXIT3                                            0594
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE GETLINE SERVICE ROUTINE TO OBTAIN REPLACEMENT STRING   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0595
*NOPUTLN:                                                          0595
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO OUT PARM BLOCK           */
NOPUTLN  XC    PTGTLIST(20),PTGTLIST                               0595
*   PARMREG1=IOPLPTR;               /* PTR TO GETLINE PARMLIST       */
         L     @12,IOPLPTR                                         0596
         LR    PARMREG1,@12                                        0596
*   IOPLIOPB=GTPBPTR;               /* PTR TO GETLINE PARM BLOCK     */
*                                                                  0597
         MVC   IOPLIOPB(4,@12),GTPBPTR                             0597
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE GETLINE MACRO TO CALL IKJGETL                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0598
*   GENERATE;                                                      0598
         GETLINE ,INPUT=(TERM,LOGICAL),                                X
               TERMGET=(EDIT,WAIT),MF=(E,(1))
*   RESPECIFY                                                      0599
*    (RETCDREG) RSTD;                                              0599
*                                                                  0599
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFUL RETURN FROM GETLINE                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0600
*   IF RETCDREG=0 THEN              /* IF YES, CONTINUE PROCESSING   */
         LTR   RETCDREG,RETCDREG                                   0600
         BZ    @RT00600                                            0600
*     GO TO SUCCGET;                /* PREPARE TO FORM CHANGED LINE  */
*                                                                  0602
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NO CORE AVAILABLE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0602
*   IF RETCDREG=24 THEN             /* IF YES, NOTIFY USER           */
         CH    RETCDREG,@CH00236                                   0602
         BE    @RT00602                                            0602
*     GO TO NOCORMS1;               /* SEND MESSAGE TO USER          */
*                                                                  0603
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTENTION ISSUED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0604
*   IF RETCDREG=8 THEN              /* IF YES, EXIT-NO MSG           */
         CH    RETCDREG,@CH00058                                   0604
         BE    @RT00604                                            0604
*     GO TO NOTEXT;                 /* BEGIN EXIT PROCESSING         */
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */
         LR    RETCODE,RETCDREG                                    0606
*   RESPECIFY                                                      0607
*    (RETCDREG) UNRSTD;                                            0607
*   MSGTEXT='GETLINE';              /* INSERTION TEXT                */
         MVI   MSGTEXT+7(COMMREG),C' '                             0608
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0608
         MVC   MSGTEXT(7,COMMREG),@CC01362                         0608
*   MSGLEN=LENGTH('GETLINE')+4;     /* LENGTH OF MSG INSERT          */
         MVC   MSGLEN(2,COMMREG),@CH00033                          0609
*   GO TO SYSERR1;                  /* BRANCH TO NOTIFY USER         */
*                                                                  0610
         B     SYSERR1                                             0610
*   /*****************************************************************/
*   /*                                                               */
*   /* GETLINE SUCCESSFUL -- OVERLAY ORIGINAL TEXT WITH TERMINAL     */
*   /* INPUT AND UPDATE CONTROL PORTION OF RECORD                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0611
*SUCCGET:                                                          0611
*   RECTEXT(RECLEN-3:RECLEN+BFRLEN-2*4)=BFRTXT;/* ADD CHANGED TO   0611
*                                      ORIGINAL TXT                  */
SUCCGET  LH    @08,RECLEN(,COMMREG)                                0611
         ALR   @08,COMMREG                                         0611
         L     @07,GTPBPTR                                         0611
         L     @07,GTPBIBUF(,@07)                                  0611
         LH    @05,BFRLEN(,@07)                                    0611
         LR    @15,@05                                             0611
         SH    @15,@CH00130                                        0611
         EX    @15,@SM01518                                        0611
*   RECLEN=BFRLEN+RECLEN-4;         /* NEW LENGTH OF DATA            */
         LH    @08,RECLEN(,COMMREG)                                0612
         ALR   @08,@05                                             0612
         SH    @08,@CH00599                                        0612
         STH   @08,RECLEN(,COMMREG)                                0612
*   FREEAREA=GTPBIBUF;              /* PTR TO BUFFER                 */
         ST    @07,FREEAREA                                        0613
*   FREELEN=BFRLEN;                 /* LENGTH OF BUFFER              */
         ST    @05,FREELEN                                         0614
*   BINRYREG=ADDR(FREEAREA);        /* PTR TO AREA INFO              */
         LA    BINRYREG,FREEAREA                                   0615
*   FREELIST=FREELIST&&FREELIST;    /* ZERO OUT LIST FORM            */
         XC    FREELIST(12),FREELIST                               0616
*   PARMREG1=ADDR(FREELIST);        /* PTR TO LIST FORM              */
*                                                                  0617
         LA    PARMREG1,FREELIST                                   0617
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE FREEMAIN MACRO TO FREE INPUT BUFFER AREA                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0618
*   GENERATE REFS(BINRYREG);                                       0618
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))
*   LETXTPTR=ADDR(RECLEN);          /* PTR TO TEXT                   */
         LA    @08,RECLEN(,COMMREG)                                0619
         ST    @08,LETXTPTR                                        0619
*   LECODE='00'X;                   /* NOT DELIMITED STRING CODE     */
         MVI   LECODE,X'00'                                        0620
*   CALL LINEEDIT;                  /* LINE EDIT TEXT                */
         BAL   @14,LINEEDIT                                        0621
*                                   /* PREPARE TO UPDATE DATA SET    */
*                                                                  0622
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ALL CHANGES COMPLETED ON PREVIOUS LINES AND THEIR    */
*   /* ASSOCIATED OVERFLOW LINES                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0622
*   IF KEYFLD>VERKEY+VERCNT THEN    /* IF YES, RESET OVERFLOW CNTR   */
         L     @08,VERKEY                                          0622
         AL    @08,VERCNT                                          0622
         C     @08,KEYFLD(,COMMREG)                                0622
         BNL   @RF00622                                            0622
*     VERCNT=0;                     /* SET COUNTER TO ZERO           */
*                                                                  0623
         SLR   @08,@08                                             0623
         ST    @08,VERCNT                                          0623
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0624
*   IF RETCODE=4 THEN               /* IF YES, PROCESS CONDITION     */
@RF00622 CH    RETCODE,@CH00599                                    0624
         BNE   @RF00624                                            0624
*     DO;                           /* PROCESS LINE OVERFLOW         */
*                                                                  0625
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF NON-LINE NUMBERED TEXT DATA SET TYPE             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0626
*       IF CANONUM='1'B&CADSCODE=CATEXT THEN/* IF YES, BRANCH TO   0626
*                                      PROCESS                       */
         TM    CANONUM(COMMREG),B'00000001'                        0626
         BNO   @RF00626                                            0626
         CLI   CADSCODE(COMMREG),X'05'                             0626
         BNE   @RF00626                                            0626
*         DO;                       /* CREATE OVERFLOW LINE          */
*           J=KEYFLD;               /* SAVE KEY OF CHANGED RECORD    */
         L     J,KEYFLD(,COMMREG)                                  0628
*           GO TO LNOVRFL;          /* PROCESS OVERFLOW LINES        */
         B     LNOVRFL                                             0629
*         END;                                                     0630
*       RELMSG1=1293;               /* MSG IKJ52507I                 */
@RF00626 MVC   RELMSG1(2),@CH01404                                 0631
*       BINRYREG=CALRECL-4;         /* DATA SET LINE SIZE            */
*                                                                  0632
         LH    BINRYREG,CALRECL(,COMMREG)                          0632
         SH    BINRYREG,@CH00599                                   0632
*       /*************************************************************/
*       /*                                                           */
*       /* ----------------------------------------- CONVERT TO      */
*       /* DECIMAL, UNPACK AND SET ZONE SIGN FOR EBCDIC CHARATERS    */
*       /* ----------------------------------------- CONVERT NUMBER  */
*       /* TO DECIMAL AND UNPACK DECIMAL RESULT                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0633
*       GENERATE REFS(BINRYREG,PACKAREA);                          0633
*                                                                  0633
         CVD   BINRYREG,PACKAREA
         UNPK  PACKAREA(3),PACKAREA+6(2)
*       /*************************************************************/
*       /*                                                           */
*       /* SET SIGN ZONE                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0634
*       PACKAREA(3)=PACKAREA(3)|'F0'X;                             0634
         OI    PACKAREA+2,X'F0'                                    0634
*       MSGPTR2=0;                  /* NO 2ND INSERTION              */
         SLR   @12,@12                                             0635
         ST    @12,MSGPTR2(,COMMREG)                               0635
*       MSGOFF2=25;                 /* OFFSET FOR INSERTION          */
*                                                                  0636
         MVC   MSGOFF2(2,COMMREG),@CH01406                         0636
*       /*************************************************************/
*       /*                                                           */
*       /* REMOVE ALL LEADING ZEROES FROM MSG INSERT                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0637
*       DO I=1 TO 3;                                               0637
*                                                                  0637
         LA    I,1                                                 0637
@DL00637 DS    0H                                                  0638
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF NON-ZERO CHARACTER FOUND                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0638
*         IF PACKAREA(I)¬='0' THEN  /* IF YES, BRANCH OJT            */
         LA    @12,PACKAREA-1(I)                                   0638
         CLI   0(@12),C'0'                                         0638
         BNE   @RT00638                                            0638
*           GO TO OUT;              /* FIRST NON-ZERO DIGIT          */
*       END;                        /* END OF DO LOOP. NO FALL     0640
*                                      THROUGH, SINCE ALWAYS HAVE  0640
*                                      VALID NONZERO VALUE.          */
         AL    I,@CF00060                                          0640
         CH    I,@CH00101                                          0640
         BNH   @DL00637                                            0640
*OUT:                                                              0641
*       MSGTEXT2=PACKAREA(I:3);     /* MOVE TEXT                     */
OUT      MVI   MSGTEXT2+1(COMMREG),C' '                            0641
         MVC   MSGTEXT2+2(70,COMMREG),MSGTEXT2+1(COMMREG)          0641
         LA    @12,3                                               0641
         SLR   @12,I                                               0641
         LA    @08,PACKAREA-1(I)                                   0641
         EX    @12,@SM01520                                        0641
*       MSGLEN2=8-I;                /* LENGTH OF INSERTION           */
         LA    @12,8                                               0642
         SLR   @12,I                                               0642
         STH   @12,MSGLEN2(,COMMREG)                               0642
*       RELMSG2=1;                  /* RELATIVE SECOND MESSAGE       */
*                                                                  0643
         MVC   RELMSG2(2),@CH00060                                 0643
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF DATA SET IS LINE NUMBERED                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0644
*       IF CANONUM='1'B THEN        /* IF NO, NO LINE NUMBER REFER   */
         TM    CANONUM(COMMREG),B'00000001'                        0644
         BNO   @RF00644                                            0644
*         LEV1INS=0;                /* NO INSERTION TEXT             */
         SLR   LEV1INS,LEV1INS                                     0645
*       ELSE                        /* IF YES, INSERT NUMBER IN MSG  */
*         DO;                       /* PREPARE TRUNCATION MESSAGE    */
         B     @RC00644                                            0646
@RF00644 DS    0H                                                  0647
*           BINRYREG=KEYFLD;        /* BINARY LNUMBR                 */
*                                                                  0647
         L     BINRYREG,KEYFLD(,COMMREG)                           0647
*           /*********************************************************/
*           /*                                                       */
*           /* ------------------------------- CONVERT TO DECIMAL,   */
*           /* UNPACK AND SET ZONE SIGN FOR EBCDIC                   */
*           /* -------------------------------                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0648
*           GENERATE REFS(BINRYREG);                               0648
         CVD   BINRYREG,PACKTEMP               CONVERT TO DECIMAL
         UNPK  PACKAREA(8),PACKTEMP(8)  UNPK NUM
*           PACKAREA(8)=PACKAREA(8)|'F0'X;                         0649
*                                                                  0649
         OI    PACKAREA+7,X'F0'                                    0649
*           /*********************************************************/
*           /*                                                       */
*           /* REMOVE ALL LEADING ZEROES                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0650
*           DO I=1 TO 7;                                           0650
*                                                                  0650
         LA    I,1                                                 0650
@DL00650 DS    0H                                                  0651
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF FIRST SIGNIFICANT DIGIT FOUND              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0651
*             IF PACKAREA(I)¬='0' THEN/* IF YES, BRANCH OUT          */
         LA    @12,PACKAREA-1(I)                                   0651
         CLI   0(@12),C'0'                                         0651
         BNE   @RT00651                                            0651
*               GO TO FOUND;        /* DGT FOUND                     */
*           END;                    /* END OF DO LOOP. FALL THROUGH
*                                      ONLY IF VALUE IS ZERO. MINIMUM
*                                      OF ONE CHARACTER MUST BE SENT
*                                      AS LINE NUMBER.               */
         AL    I,@CF00060                                          0653
         CH    I,@CH00124                                          0653
         BNH   @DL00650                                            0653
*           I=8;                    /* SET TO SIGNIF. POSITION       */
         LA    I,8                                                 0654
*FOUND:                                                            0655
*           MSGTEXT=PACKAREA(I:8);  /* MOVE TEXT                     */
FOUND    MVI   MSGTEXT+1(COMMREG),C' '                             0655
         MVC   MSGTEXT+2(70,COMMREG),MSGTEXT+1(COMMREG)            0655
         LA    @12,8                                               0655
         SLR   @12,I                                               0655
         LA    @08,PACKAREA-1(I)                                   0655
         EX    @12,@SM01522                                        0655
*           MSGOFF=15;              /* OFFSET FOR INS                */
         MVC   MSGOFF(2,COMMREG),@CH00065                          0656
*           MSGLEN=13-I;            /* LENGTH OF TXT                 */
         LA    @12,13                                              0657
         SLR   @12,I                                               0657
         STH   @12,MSGLEN(,COMMREG)                                0657
*           MSGPTR=0;               /* NO 2ND INSERTION              */
         SLR   @12,@12                                             0658
         ST    @12,MSGPTR(,COMMREG)                                0658
*           LEV1INS=ADDR(MSGAREA);  /* PTR TO INSERT                 */
         LA    LEV1INS,MSGAREA(,COMMREG)                           0659
*         END;                                                     0660
*       LEV2INS=ADDR(MSGPTR2);      /* PTR TO MSG INSERT             */
@RC00644 LA    LEV2INS,MSGPTR2(,COMMREG)                           0661
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0662
*     END;                                                         0663
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */
@RF00624 MVI   UTCODE,X'20'                                        0664
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO RECORD TO BE WRITTEN   */
         LA    @08,KEYFLD(,COMMREG)                                0665
         ST    @08,KEYPTR                                          0665
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                0666
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */
         SLR   @08,@08                                             0667
         ST    @08,AREAPTR                                         0667
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */
*                                                                  0668
         BAL   @14,RDWRTRTN                                        0668
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0669
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    0669
         BE    @RT00669                                            0669
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */
*   VERKEY=KEYFLD;                  /* SET * VALUE                   */
         MVC   VERKEY(4),KEYFLD(COMMREG)                           0671
*                                                                  0672
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA SET TYPE BASIC OR IPLI                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0672
*   IF CADSCODE=CABASIC|CADSCODE=CAIPLI THEN/* IF YES, UPDATE REVERSE
*                                      POLISH DATA SET               */
         CLI   CADSCODE(COMMREG),X'20'                             0672
         BE    @RT00672                                            0672
         CLI   CADSCODE(COMMREG),X'21'                             0672
         BNE   @RF00672                                            0672
@RT00672 DS    0H                                                  0673
*     DO;                           /* PREPARE PARAMETER LIST AND  0673
*                                      CALL PROCESSOR IF AVAILABLE   */
*       I=KEYFLD;                   /* SAVE KEY FIELD                */
         L     I,KEYFLD(,COMMREG)                                  0674
*       J=RECLEN;                   /* USE REG TO SAVE LL FIELD      */
*                                                                  0675
         LH    J,RECLEN(,COMMREG)                                  0675
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF FIXED RECORD FORMAT                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0676
*       IF CARECFM='1'B THEN        /* IF YES, REMOVE CONTROL WORD   */
         TM    CARECFM(COMMREG),B'01000000'                        0676
         BNO   @RF00676                                            0676
*         DO;                       /* INIT BUFFER PASSED            */
*           SCPTR2=0;               /* NO CHAINED BFRS               */
         SLR   @12,@12                                             0678
         ST    @12,SCPTR2(,COMMREG)                                0678
*           SCCNT2=1;               /* ONE RECORD SENT               */
         MVI   SCCNT2(COMMREG),X'01'                               0679
*           CASYNBFR=ADDR(SCPTR2);  /* BFR PTR                       */
         LA    @12,SCPTR2(,COMMREG)                                0680
         ST    @12,CASYNBFR(,COMMREG)                              0680
*         END;                                                     0681
*       ELSE                        /* IF NO, VARIABLE FORMAT        */
*         DO;                       /* INIT BUFFER PASSED            */
         B     @RC00676                                            0682
@RF00676 DS    0H                                                  0683
*           SCPTR1=0;               /* NO CHAINED BFRS               */
         SLR   @12,@12                                             0683
         ST    @12,SCPTR1(,COMMREG)                                0683
*           SCCNT1=1;               /* ONE RECORD SENT               */
         MVI   SCCNT1(COMMREG),X'01'                               0684
*           CASYNBFR=ADDR(SCPTR1);  /* BFR PTR                       */
         LA    @12,SCPTR1(,COMMREG)                                0685
         ST    @12,CASYNBFR(,COMMREG)                              0685
*         END;                                                     0686
*                                                                  0686
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF SYNTAX CHECKER AVAILABLE                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0687
*       IF CAPTCHK¬=0 THEN          /* IF YES, PASS LINE TO CHECKER  */
@RC00676 L     @12,CAPTCHK(,COMMREG)                               0687
         LTR   @12,@12                                             0687
         BZ    @RF00687                                            0687
*         DO;                       /* CALL PROCESSOR                */
*           ENTRYCD='10000'B;       /* ENTRY CODE FOR ITF            */
         MVI   ENTRYCD(COMMREG),B'10000000'                        0689
*           PARMREG1=ADDR(CASYNLST);/* PTR TO PARMLIST               */
         LA    PARMREG1,CASYNLST(,COMMREG)                         0690
*           CALL CHECKER;           /* UPDATE ITF DATA SET           */
         LR    @15,@12                                             0691
         BALR  @14,@15                                             0691
*           RESPECIFY                                              0692
*            (RETCDREG) RSTD;                                      0692
*           KEYFLD=I;               /* RESTORE KEY FIELD             */
         ST    I,KEYFLD(,COMMREG)                                  0693
*           RECLEN=J;               /* RESTORE LL FIELD              */
*                                                                  0694
         STH   J,RECLEN(,COMMREG)                                  0694
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR PROCESSOR ERROR MESSAGE                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0695
*           IF RETCDREG=4 THEN      /* YES, CHECK IF SCAN ON         */
*                                                                  0695
         CH    RETCDREG,@CH00599                                   0695
         BNE   @RF00695                                            0695
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF SCAN IS ON                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0696
*             IF CASCANSW='1'B THEN /* YES,INDICATE FLUSH            */
         TM    CASCANSW(COMMREG),B'00010000'                       0696
         BNO   @RF00696                                            0696
*               DO;                                                0697
*                 CHRETCD=8;        /* INDICATE FLUSH                */
         MVC   CHRETCD(4),@CF00058                                 0698
*                 GO TO CHGEXIT3;   /* GO TO EXIT                    */
         B     CHGEXIT3                                            0699
*               END;                                               0700
*             ELSE                  /* NO SCAN THEN CHECK ATTENTION  */
*               GO TO CHKATTN;                                     0701
*           ELSE                                                   0702
*             ;                                                    0702
*                                                                  0702
@RF00695 DS    0H                                                  0703
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR SUCCESSFUL RETURN                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0703
*           IF RETCDREG=0 THEN      /* IF YES, CONTINUE PROCESSING   */
         LTR   RETCDREG,RETCDREG                                   0703
         BZ    @RT00703                                            0703
*             GO TO CHKATTN;        /* BEGIN EXIT PRCSS              */
*                                                                  0704
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF NOT ENOUGH CORE AVAILABLE                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0705
*           IF RETCDREG=16 THEN     /* IF YES, NOTIFY USER           */
         LA    @14,16                                              0705
         CR    RETCDREG,@14                                        0705
         BE    @RT00705                                            0705
*             GO TO NOCORMS1;       /* NOTIFY USER                   */
*                                                                  0706
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF PROCESSOR FAILED                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0707
*           IF RETCDREG=20 THEN     /* IF YES, TERMINATE             */
         CH    RETCDREG,@CH00134                                   0707
         BNE   @RF00707                                            0707
*             DO;                   /* NOTIFY IKJEBEMA AND EXIT      */
*               CHRETCD=16;         /* SET RETURN CD                 */
         ST    @14,CHRETCD                                         0709
*               GO TO NOTEXT;       /* BEGIN EXIT PROCESS            */
         B     NOTEXT                                              0710
*             END;                                                 0711
*           RETCODE=RETCDREG;       /* SAVE RETURN CODE              */
@RF00707 LR    RETCODE,RETCDREG                                    0712
*           RESPECIFY                                              0713
*            (RETCDREG) UNRSTD;                                    0713
*           MSGTEXT(1:8)=CASYNAME;  /* INSERTION                     */
*                                                                  0714
         MVC   MSGTEXT(8,COMMREG),CASYNAME(COMMREG)                0714
*           /*********************************************************/
*           /*                                                       */
*           /* REMOVE ALL TRAILING BLANKS                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0715
*           DO I=8 TO 1 BY-1;                                      0715
*                                                                  0715
         LA    I,8                                                 0715
@DL00715 DS    0H                                                  0716
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF LAST NON-BLANK FOUND                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0716
*             IF MSGTEXT(I)¬=' ' THEN/* IF YES, END OF INSERT FOUND  */
         LR    @08,COMMREG                                         0716
         ALR   @08,I                                               0716
         CLI   MSGTEXT-1(@08),C' '                                 0716
         BNE   @RT00716                                            0716
*               GO TO LPOUT;        /* EXIT FROM LOOP                */
*           END;                    /* END OF DO LOOP. NO FALL     0718
*                                      THROUGH, SINCE ALWAYS HAVE  0718
*                                      VALID MODULE NAME.            */
         BCTR  I,0                                                 0718
         LTR   I,I                                                 0718
         BP    @DL00715                                            0718
*LPOUT:                                                            0719
*           MSGLEN=I+4;             /* LENGTH OF INSERTION           */
LPOUT    LA    @08,4                                               0719
         ALR   @08,I                                               0719
         STH   @08,MSGLEN(,COMMREG)                                0719
*           GO TO SYSERR1;          /* BRANCH TO NOTIFY USER         */
         B     SYSERR1                                             0720
*         END;                                                     0721
*       KEYFLD=I;                   /* RESTORE KEY FIELD             */
@RF00687 ST    I,KEYFLD(,COMMREG)                                  0722
*       RECLEN=J;                   /* RESTORE LL FIELD              */
         STH   J,RECLEN(,COMMREG)                                  0723
*     END;                                                         0724
*   GO TO CHKATTN;                  /* BRANCH TO ATTENTION CHECK     */
         B     CHKATTN                                             0725
*LNOVRFL:                                                          0726
*   START=RECLEN-4;                 /* START BLANK SCAN AT LINE END  */
*                                                                  0726
LNOVRFL  LH    START,RECLEN(,COMMREG)                              0726
         SH    START,@CH00599                                      0726
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND LOGICAL BREAKPOINT IN LINE(I.E. LAST BLANK IN RECORD     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0727
*   DO I=START TO 1 BY-1;                                          0727
*                                                                  0727
         LR    I,START                                             0727
         B     @DE00727                                            0727
@DL00727 DS    0H                                                  0728
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF LAST BLANK FOUND                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0728
*     IF RECTEXT(I)=' ' THEN        /* IF YES, BREAK POINT IN LINE   */
         LR    @12,COMMREG                                         0728
         ALR   @12,I                                               0728
         CLI   RECTEXT-1(@12),C' '                                 0728
         BE    @RT00728                                            0728
*       GO TO BREAKLN;              /* BUILD OVERFLOW LINE           */
*   END;                            /* END OF DO LOOP. FALL THROUGH
*                                      ONLY IF NO BLANK IN LINE.     */
         BCTR  I,0                                                 0730
@DE00727 LTR   I,I                                                 0730
         BP    @DL00727                                            0730
*   I=START;                        /* SET BREAKPOINT MARKER AT END
*                                      OF RECORD                     */
         LR    I,START                                             0731
*BREAKLN:                           /*                               */
*                                                                  0732
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF BLANK NOT LAST CHARACTER IN LINE                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0732
*   IF I<START THEN                 /* IF YES, BREAK LINE AT BLANK   */
BREAKLN  CR    I,START                                             0732
         BNL   @RF00732                                            0732
*     DO;                           /* FORM FROM MAIN LINE AND     0733
*                                      OVERFLOW DATA                 */
*                                                                  0733
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE DATA BEYOND BREAKPOINT INTO 2ND BFR                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0734
*       RECTEXT2=RECTEXT(I+1:START);                               0734
*                                                                  0734
         MVI   RECTEXT2+1(COMMREG),C' '                            0734
         MVC   RECTEXT2+2(253,COMMREG),RECTEXT2+1(COMMREG)         0734
         LR    @12,START                                           0734
         SLR   @12,I                                               0734
         LR    @08,@12                                             0734
         BCTR  @08,0                                               0734
         LR    @07,COMMREG                                         0734
         ALR   @07,I                                               0734
         EX    @08,@SM01524                                        0734
*       /*************************************************************/
*       /*                                                           */
*       /* ADD ON LINE OVERFLOW TO EXTRA DATA IN MAIN LINE           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0735
*       RECTEXT2(START-I+1:START-I+EXTRALEN-4)=EXTRALN;            0735
*                                                                  0735
         ST    @12,@TF00001                                        0735
         ALR   @12,COMMREG                                         0735
         L     @08,LETXTPTR                                        0735
         LH    @07,EXTRALEN(,@08)                                  0735
         LR    @15,@07                                             0735
         SH    @15,@CH00130                                        0735
         EX    @15,@SM01526                                        0735
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE LENGTH OF NEW LINE                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0736
*       RECLEN2=START-I+EXTRALEN;                                  0736
*                                                                  0736
         AL    @07,@TF00001                                        0736
         STH   @07,RECLEN2(,COMMREG)                               0736
*       /*************************************************************/
*       /*                                                           */
*       /* PROPAGATE BLANKS IN CHANGED LINE                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0737
*       MVC(RECTEXT(I+1:START),RECTEXT(I:START-1));                0737
         LR    @12,COMMREG                                         0737
         ALR   @12,I                                               0737
         LR    @08,START                                           0737
         SLR   @08,I                                               0737
         BCTR  @08,0                                               0737
         LR    @07,COMMREG                                         0737
         ALR   @07,I                                               0737
         EX    @08,@SM01528                                        0737
*     END;                                                         0738
*   ELSE                            /* IF NO, DO NOT CHANGE LINE     */
*     DO;                           /* FORM ONLY FROM OVERFLOW DATA  */
         B     @RC00732                                            0739
@RF00732 DS    0H                                                  0740
*       RECTEXT2=EXTRALN;           /* MOVE DATA PROTION             */
         MVI   RECTEXT2+251(COMMREG),C' '                          0740
         MVC   RECTEXT2+252(3,COMMREG),RECTEXT2+251(COMMREG)       0740
         L     @12,LETXTPTR                                        0740
         MVC   RECTEXT2(251,COMMREG),EXTRALN(@12)                  0740
*       RECLEN2=EXTRALEN;           /* LENGTH OF NEW LINE            */
         MVC   RECLEN2(2,COMMREG),EXTRALEN(@12)                    0741
*     END;                                                         0742
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */
@RC00732 MVI   UTCODE,X'20'                                        0743
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO LINE TO BE WRITTEN     */
         LA    @08,KEYFLD(,COMMREG)                                0744
         ST    @08,KEYPTR                                          0744
*   AREAPTR=0;                      /* NO READ AREA NECESSARY        */
         SLR   @08,@08                                             0745
         ST    @08,AREAPTR                                         0745
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                0746
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */
*                                                                  0747
         BAL   @14,RDWRTRTN                                        0747
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0748
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    0748
         BE    @RT00748                                            0748
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */
*   VERCNT=VERCNT+1;                /* UPDATE OVERFLOW CNT BY ONE    */
         LA    @12,1                                               0750
         AL    @12,VERCNT                                          0750
         ST    @12,VERCNT                                          0750
*   RELMSG1=1032;                   /* MSG IKJ52558I                 */
         MVC   RELMSG1(2),@CH01419                                 0751
*   LEV1INS=0;                      /* NO 1ST LEVEL INSERTION        */
         SLR   LEV1INS,LEV1INS                                     0752
*   RELMSG2=0;                      /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             0753
         STH   @12,RELMSG2                                         0753
*   LEV2INS=0;                      /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     0754
*   CALL SENDMSG;                   /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         0755
*   KEYFLD2=KEYFLD+1;               /* KEY FOR OVERFLOW LINE         */
         LA    @08,1                                               0756
         AL    @08,KEYFLD(,COMMREG)                                0756
         ST    @08,KEYFLD2(,COMMREG)                               0756
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT      */
         MVI   UTCODE,X'00'                                        0757
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO READ    */
         LA    @08,KEYFLD2(,COMMREG)                               0758
         ST    @08,KEYPTR                                          0758
*   AREAPTR=ADDR(KEYFLD3);          /* PTR TO READ BUFFER            */
         LA    @08,KEYFLD3(,COMMREG)                               0759
         ST    @08,AREAPTR                                         0759
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                0760
*   CALL RDWRTRTN;                  /* READ RECORD FROM DATA SET     */
*                                                                  0761
         BAL   @14,RDWRTRTN                                        0761
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0762
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    0762
         BE    @RT00762                                            0762
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */
*                                                                  0763
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THERE IS ROOM FOR OVERFLOW LINE IN DATA SET          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0764
*   IF RETCODE¬=4 THEN              /* IF NO, RIPPLE RECORDS         */
         CH    RETCODE,@CH00599                                    0764
         BE    @RF00764                                            0764
*     CALL RIPPLELN;                /* MAKE SLOT FOR OVERFLOW LINE   */
         BAL   @14,RIPPLELN                                        0765
*   LETXTPTR=ADDR(RECLEN2);         /* PTR TO TEXT                   */
@RF00764 LA    @08,RECLEN2(,COMMREG)                               0766
         ST    @08,LETXTPTR                                        0766
*   LECODE='00'X;                   /* NOT DELINITED STRING CODE     */
         MVI   LECODE,X'00'                                        0767
*   CALL LINEEDIT;                  /* LINE EDIT RECORD              */
         BAL   @14,LINEEDIT                                        0768
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */
         MVI   UTCODE,X'20'                                        0769
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO WRITE   */
         LA    @08,KEYFLD2(,COMMREG)                               0770
         ST    @08,KEYPTR                                          0770
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */
         SLR   @08,@08                                             0771
         ST    @08,AREAPTR                                         0771
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                0772
*   CALL RDWRTRTN;                  /* WRITE RECORD                  */
*                                                                  0773
         BAL   @14,RDWRTRTN                                        0773
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0774
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    0774
         BE    @RT00774                                            0774
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */
*                                                                  0775
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0776
*   IF RETCODE=4 THEN               /* IF YES, FIT NEW OVERFLOW LINE
*                                      INTO DATA SET                 */
         CH    RETCODE,@CH00599                                    0776
         BNE   @RF00776                                            0776
*     DO;                           /* REPEAT PROCESS, TREATING OLD
*                                      OVERFLOW LINE AS MAIN LINE    */
*       KEYFLD=KEYFLD2;             /* MOVE KEY INTO MAIN BFR        */
         MVC   KEYFLD(4,COMMREG),KEYFLD2(COMMREG)                  0778
*       RECLEN=RECLEN2;             /* MOVE LL FIELD                 */
         MVC   RECLEN(2,COMMREG),RECLEN2(COMMREG)                  0779
*       RECTEXT=RECTEXT2;           /* MOVE DATA INTO BFR            */
         MVC   RECTEXT(255,COMMREG),RECTEXT2(COMMREG)              0780
*       GO TO LNOVRFL;              /* PROCESS NEXT LINE             */
         B     LNOVRFL                                             0781
*     END;                                                         0782
*   KEYFLD2=J;                      /* RESTORE KEY OF CHANGED LINE   */
@RF00776 ST    J,KEYFLD2(,COMMREG)                                 0783
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT LN   */
         MVI   UTCODE,X'00'                                        0784
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF CHANGED LINE    */
         LA    @08,KEYFLD2(,COMMREG)                               0785
         ST    @08,KEYPTR                                          0785
*   AREAPTR=ADDR(KEYFLD);           /* AREA TO READ INTO             */
         LA    @08,KEYFLD(,COMMREG)                                0786
         ST    @08,AREAPTR                                         0786
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARK      */
         OI    PLISTEND,B'10000000'                                0787
*   CALL RDWRTRTN;                  /* READ CHANGED LINE             */
*                                                                  0788
         BAL   @14,RDWRTRTN                                        0788
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0789
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    0789
         BE    @RT00789                                            0789
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */
*   VERKEY=KEYFLD;                  /* SAVE ASTERISK VALUE           */
         MVC   VERKEY(4),KEYFLD(COMMREG)                           0791
*CHKATTN:                                                          0792
*   FIRSTCHG='0'B;                  /* SET SWITCH TO INDICATE LINE 0792
*                                      CHANGE ALREADY PERFORMED      */
*                                                                  0792
CHKATTN  NI    FIRSTCHG,B'10111111'                                0792
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTENTION ISSUED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0793
*   IF CAATTNIS='1'B THEN           /* IF YES, RETURN TO CALLER      */
         TM    CAATTNIS(COMMREG),B'01000000'                       0793
         BO    @RT00793                                            0793
*     GO TO NOTEXT;                 /* BEGIN END PROCESSING          */
*                                                                  0794
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MORE LINES TO CHANGE AND NOT STRING OPERATION        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0795
*   IF KEYFLD<LNUM2|LNCOUNT>1 THEN  /* IF YES, ONLY COUNT CASE VALID
*                                      FOR CONTINUING                */
         L     @12,KEYFLD(,COMMREG)                                0795
         C     @12,LNUM2                                           0795
         BL    @RT00795                                            0795
         L     @12,LNCOUNT                                         0795
         CH    @12,@CH00060                                        0795
         BNH   @RF00795                                            0795
@RT00795 DS    0H                                                  0796
*     DO;                           /* READ NEXT LINE IF COUNT CASE  */
*                                                                  0796
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF NUMERIC CHARACTER COUNT SPECIFIED                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0797
*       IF CNTSW='1'B THEN          /* IF YES, READ LINE             */
         TM    CNTSW,B'00100000'                                   0797
         BNO   @RF00797                                            0797
*         DO;                       /* PREPARE PARMLIST FOR READ     */
*           UTCODE='02'X;           /* SET CODE TO READ NEXT LINE    */
         MVI   UTCODE,X'02'                                        0799
*           KEYFLD=VERKEY+VERCNT;   /* SET KEY TO NEWLN              */
         L     @08,VERKEY                                          0800
         AL    @08,VERCNT                                          0800
         ST    @08,KEYFLD(,COMMREG)                                0800
*           KEYPTR=ADDR(KEYFLD);    /* PTR TO READ KEY               */
         LA    @08,KEYFLD(,COMMREG)                                0801
         ST    @08,KEYPTR                                          0801
*           AREAPTR=ADDR(KEYFLD);   /* PTR TO READ BUFFER            */
         ST    @08,AREAPTR                                         0802
*           PLISTEND='1'B;          /* SET END OF PLIST MARK         */
         OI    PLISTEND,B'10000000'                                0803
*           CALL RDWRTRTN;          /* READ NEXT RECORD              */
*                                                                  0804
         BAL   @14,RDWRTRTN                                        0804
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE         */
*           /* OPERATION                                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0805
*           IF RETCODE=12 THEN      /* IF YES,TERMINAT               */
         CH    RETCODE,@CH00143                                    0805
         BE    @RT00805                                            0805
*             GO TO CHGEXIT3;       /* ENG PROCESSING                */
*                                                                  0806
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF RECORD EXISTS                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0807
*           IF RETCODE=4 THEN       /* IF NO, NOTIFY USER            */
         CH    RETCODE,@CH00599                                    0807
         BNE   @RF00807                                            0807
*             DO;                   /* SEND EOD MESSAGE TO USER      */
*               RELMSG1=1286;       /* MSG IKJ52500I                 */
         MVC   RELMSG1(2),@CH01348                                 0809
*               LEV1INS=0;          /* NO FIRST-LEVEL INSERTIONS     */
         SLR   LEV1INS,LEV1INS                                     0810
*               RELMSG2=0;          /* NO SECOND-LEVEL MESSAGE       */
         SLR   @12,@12                                             0811
         STH   @12,RELMSG2                                         0811
*               LEV2INS=0;          /* (OR INSERTIONS)               */
         SLR   LEV2INS,LEV2INS                                     0812
*               CALL SENDMSG;       /* SEND EOD MESSAGE              */
         BAL   @14,SENDMSG                                         0813
*               GO TO NOTEXT;       /* CONTINUE TO EXIT              */
         B     NOTEXT                                              0814
*             END;                                                 0815
*           ELSE                    /* IF YES, CONTINUE PROCESSING   */
*             DO;                   /* NEXT LINE EXISTS              */
*                                                                  0816
@RF00807 DS    0H                                                  0817
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK IF LINE WITHIN RANGE SPECIFIED              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0817
*               IF KEYFLD<=LNUM2|LNCOUNT>1 THEN/* IF YES, CONTINUE 0817
*                                      PROCESSING                    */
         L     @12,KEYFLD(,COMMREG)                                0817
         C     @12,LNUM2                                           0817
         BNH   @RT00817                                            0817
         L     @12,LNCOUNT                                         0817
         CH    @12,@CH00060                                        0817
         BNH   @RF00817                                            0817
@RT00817 DS    0H                                                  0818
*                 DO;               /* PREPARE TO CONTINUE CHANGING  */
*                   LNCOUNT=LNCOUNT-1;/* DECREMENT LINE COUNT BY ONE */
         L     @12,LNCOUNT                                         0819
         BCTR  @12,0                                               0819
         ST    @12,LNCOUNT                                         0819
*                   GO TO CNTPRCS2; /* REPEAT MAIN PROCSS            */
         B     CNTPRCS2                                            0820
*                 END;                                             0821
*             END;                                                 0822
@RF00817 DS    0H                                                  0823
*         END;                                                     0823
*     END;                                                         0824
@RF00797 DS    0H                                                  0825
*NOTEXT:                            /*                               */
*                                                                  0825
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ANY LINE CHANGES PERFORMED                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0825
*   IF FIRSTCHG='0'B THEN           /* IF YES, SET * VALUE           */
@RF00795 DS    0H                                                  0825
NOTEXT   TM    FIRSTCHG,B'01000000'                                0825
         BNZ   @RF00825                                            0825
*     CACURNUM=VERKEY+VERCNT;       /* SET * VALUE                   */
         L     @12,VERKEY                                          0826
         AL    @12,VERCNT                                          0826
         ST    @12,CACURNUM(,COMMREG)                              0826
*CHGEXIT3:                          /*                               */
*                                                                  0827
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PROMPTING PERFORMED                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*   IF PROMPTSW='1'B THEN                                          0827
@RF00825 DS    0H                                                  0827
CHGEXIT3 TM    PROMPTSW,B'10000000'                                0827
         BNO   @RF00827                                            0827
*     DO;                           /* IF YES, FREEPROMPT PDL        */
*       PARMREG1=ADDR(TABPTR2);     /* PTR TO PPMT PDL               */
         LA    PARMREG1,TABPTR2                                    0829
*       PROMPTSW='0'B;              /* INDIC. PDL FREED              */
         NI    PROMPTSW,B'01111111'                                0830
*     END;                                                         0831
*   ELSE                            /* IF NO, FREE MAIN PDL          */
*     PARMREG1=ADDR(TABPTR1);       /* PTR TO MAIN PDL               */
         B     @RC00827                                            0832
@RF00827 LA    PARMREG1,TABPTR1                                    0832
*   GEN(IKJRLSA (1));               /* RELEASE CORE FROM IKJPARS     */
@RC00827 DS    0H                                                  0833
         IKJRLSA (1)
*   RETCDREG=CHRETCD;               /* SET RETURN CODE IN REG 15     */
         L     RETCDREG,CHRETCD                                    0834
*   RETREG=CHARPTR;                 /* RESTORE RETURN POINT          */
         L     RETREG,CHARPTR                                      0835
*   RETURN;                         /* RETURN TO CALLER              */
@EL00005 DS    0H                                                  0836
@EF00005 DS    0H                                                  0836
@ER00005 BR    @14                                                 0836
*   END CHARRTN;                    /* END OF IKJEBECN SUBROUTINE    */
*                                                                  0838
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE RIPPLES RECORDS IN THE EDIT DATA SET TO MAKE A*/
*   /* SLOT AVAILABLE FOR THE TEXT OVERFLOW LINE. THE LINE THAT MUST */
*   /* BE MOVED DOWN IN THE DATA SET IS IN THE FIRST BUFFER OF THE   */
*   /* BFRAREA2 FIELD.                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0838
*RIPPLELN:                                                         0838
*   PROC OPTIONS(NOSAVEAREA,SAVE(14));/* SUBRTN ENTRY PT             */
RIPPLELN ST    @14,12(,@13)                                        0838
*/*           REGISTERS WITH SPECIAL USE                             */
*                                                                  0839
*   RESPECIFY                                                      0839
*    (PARMREG1,                                                    0839
*     BINRYREG,                                                    0839
*     COMMREG,                                                     0839
*     BASEREG,                                                     0839
*     DATAREG) RSTD;                                               0839
*   RESPECIFY                                                      0840
*    (BASEREG2) RSTD;                                              0840
*                                                                  0840
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF RIPPLE KEY EXCEEDS ACCESS METHOD LIMITS              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*CONTRPPL:                                                         0841
*   IF KEYFLD3='7FFFFFFF'X THEN     /* IF YES, STOP RIPPLING LINES   */
CONTRPPL L     @12,KEYFLD3(,COMMREG)                               0841
         C     @12,@CF01427                                        0841
         BE    @RT00841                                            0841
*     GO TO RPPLEXIT;               /* RETURN TO CALLER              */
*   KEYFLD3=KEYFLD3+1;              /* INCREMENT KEY VALUE BY ONE    */
         L     @08,KEYFLD3(,COMMREG)                               0843
         AL    @08,@CF00060                                        0843
         ST    @08,KEYFLD3(,COMMREG)                               0843
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT      */
         MVI   UTCODE,X'00'                                        0844
*   KEYPTR=ADDR(KEYFLD3);           /* PTR TO KEY OF RECORD          */
         LA    @08,KEYFLD3(,COMMREG)                               0845
         ST    @08,KEYPTR                                          0845
*   AREAPTR=ADDR(KEYFLD4);          /* PTR TO READ BUFFER AREA       */
         LA    @08,KEYFLD4(,COMMREG)                               0846
         ST    @08,AREAPTR                                         0846
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                0847
*   CALL RDWRTRTN;                  /* READ KEY FOR NEXT SLOT        */
*                                                                  0848
         BAL   @14,RDWRTRTN                                        0848
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF RECORD EXITS ALREADY IN THIS NEXT SLOT               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0849
*   IF RETCODE¬=4 THEN              /* IF YES, CONTINUE TO RIPPLE    */
         CH    RETCODE,@CH00599                                    0849
         BE    @RF00849                                            0849
*     DO;                           /* WRITE LINE WITH KEY 1 HIBHER  */
*       UTCODE='20'X;               /* SET CODE TO WRITE RECORD      */
         MVI   UTCODE,X'20'                                        0851
*       AREAPTR=0;                  /* NO READ BFR NECESSARY         */
         SLR   @08,@08                                             0852
         ST    @08,AREAPTR                                         0852
*       PLISTEND='1'B;              /* SET END OF PARMLIST MARK      */
         OI    PLISTEND,B'10000000'                                0853
*       CALL RDWRTRTN;              /* WRITE LINE INTO NEXT SLOT     */
         BAL   @14,RDWRTRTN                                        0854
*       KEYFLD3=KEYFLD4;            /* MOVE KEY VALUE                */
         MVC   KEYFLD3(4,COMMREG),KEYFLD4(COMMREG)                 0855
*       RECLEN3=RECLEN4;            /* MOVE LL FIELD                 */
         MVC   RECLEN3(2,COMMREG),RECLEN4(COMMREG)                 0856
*       RECTEXT3=RECTEXT4;          /* MOVE DATA INTO WRITE BUFFER 0857
*                                      FOR NEXT RIPPL                */
         MVC   RECTEXT3(255,COMMREG),RECTEXT4(COMMREG)             0857
*       GO TO CONTRPPL;             /* CONTINUE TO RIPPLE LINES      */
         B     CONTRPPL                                            0858
*     END;                                                         0859
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */
@RF00849 MVI   UTCODE,X'20'                                        0860
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */
         SLR   @08,@08                                             0861
         ST    @08,AREAPTR                                         0861
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                0862
*   CALL RDWRTRTN;                  /* WRITE LAST RECORD INTO SLOT   */
         BAL   @14,RDWRTRTN                                        0863
*RPPLEXIT:                                                         0864
*   ;                               /* SUBROUTINE EXIT               */
*   RETURN;                         /* RETURN TO CALLER              */
@EL00006 DS    0H                                                  0865
@EF00006 DS    0H                                                  0865
@ER00006 L     @14,12(,@13)                                        0865
         BR    @14                                                 0865
*   END RIPPLELN;                   /* END OF SUBROUTINE             */
         B     @EL00006                                            0866
*                                                                  0867
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PERFORMS ALL CALLS TO THE IKJEBELE SERVICE    */
*   /* ROUTINE TO LINE EDIT ALL CHANGED RECORDS AND AND DELIMITED    */
*   /* STRINGS. THE RETURN CODE FROM IKJEBELE IS SAVED BEFORE        */
*   /* RETURNING TO THE MAIN LINE ROUTINE.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0867
*LINEEDIT:                                                         0867
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY PT               */
*                                                                  0867
LINEEDIT DS    0H                                                  0868
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTERS WITH SPECIAL USE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0868
*   RESPECIFY                                                      0868
*    (PARMREG1,                                                    0868
*     BINRYREG,                                                    0868
*     COMMREG,                                                     0868
*     BASEREG,                                                     0868
*     DATAREG) RSTD;                                               0868
*   RESPECIFY                                                      0869
*    (BASEREG2) RSTD;                                              0869
*   LINEPTR=RETREG;                 /* SAVE RETURN POINT ADDRESS     */
         LR    LINEPTR,RETREG                                      0870
*   GENERATE REFS(COMMREG,LEPLIST);                                0871
         IKJEBESH (COMMREG),IKJEBELE,PARAM=((COMMREG),LEPLIST),        X
               MF=(E,SRPLIST)
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */
         LR    RETCODE,RETCDREG                                    0872
*   RETREG=LINEPTR;                 /* RESTORE RETURN POINT ADDRESS  */
         LR    RETREG,LINEPTR                                      0873
*   RETURN;                         /* EXIT LINKAGE                  */
@EL00007 DS    0H                                                  0874
@EF00007 DS    0H                                                  0874
@ER00007 BR    @14                                                 0874
*   END LINEEDIT;                   /* END OF SUBROUTINE             */
*                                                                  0876
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*    THIS SUBROUTINE OF THE CHANGE SUBCOMMAND OF EDIT MODIFIES ANY */
*/*    CHARACTER STRING WITHIN THE LINE(S) OF DATA SPECIFIED.  THIS  */
*/*    OPERATION INCLUDES EITHER REPLACEMENT, DELETION, OR INSERTION */
*/*    OF A CHARACTER STRING.  IF THE ALL KEYWORD IS SPECIFIED ON THE*/
*/*    SUBCOMMAND, THIS OPERATION MODIFIES ALL REFERENCES TO THE     */
*/*    STRING IN THE LINE RANGE SPECIFIED.  THE STRING(S) IS LINE    */
*/*    EDITED AND THE OFFSET IN THE RECORD FOUND.  IF THE OPERATION  */
*/*    IS OF THE FORM DELIMITER STRING, THIS MODULE CALLS CHARRTN    */
*/*    WHICH PERFORMS THE CHARACTER COUNT OPERATIONS.  AFTER THE     */
*/*    UPDATE TO THE RECORD IS MADE, IT IS WRITTEN BACK INTO THE DATA*/
*/*    SET.  IF THE DATA SET TYPE IS BASIC OR IPLI, THE REVERSE      */
*/*    POLISH DATA SET IS UPDATED.  IF THE DATA SET TYPE IS NON-     */
*/*    LINE NUMBERED TEXT, OVERFLOW LINES, IF ANY, ARE CREATED.  THE */
*/*    CURRENT LINE POINTER IS UPDATED TO THE LAST LINE CHANGED,     */
*/*    AND LINE VERIFICATION OF THE CHANGED LINES IS PERFORMED, IF   */
*/*    NECESSARY.  CONTROL IS THEN RETURNED TO IKJEBEMA VIA IKJEBECH */
*/*    WITH A RETURN CODE IN REGISTER FIFTEEN.                       */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0876
*STRNGRTN:                                                         0876
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0876
*                                                                  0876
STRNGRTN DS    0H                                                  0877
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTERS WITH SPECIAL USE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0877
*   RESPECIFY                                                      0877
*    (PARMREG1,                                                    0877
*     BINRYREG,                                                    0877
*     COMMREG,                                                     0877
*     BASEREG,                                                     0877
*     DATAREG) RSTD;                                               0877
*   RESPECIFY                                                      0878
*    (BASEREG2) RSTD;                                              0878
*   STRNGPTR=RETREG;                /* SAVE RETURN POINT             */
         ST    RETREG,STRNGPTR                                     0879
*   VERCNT=0;                       /* INITIALIZE VERIFY CT TO ZERO  */
         SLR   @12,@12                                             0880
         ST    @12,VERCNT                                          0880
*   TRUNCKEY=-1;                    /* INIT LAST LINE TRUNCATED KEY  */
*                                                                  0881
         MVC   TRUNCKEY(4),@CF01340                                0881
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TEXT2 PRESENT AND NOT NULL                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0882
*   IF STR2L>0 THEN                 /* IF YES, LINE EDIT STRING      */
         L     @08,TABPTR1                                         0882
         LH    @08,STR2L(,@08)                                     0882
         CR    @08,@12                                             0882
         BNH   @RF00882                                            0882
*     DO;                           /* MOVE TEXT2 INTO WORK BUFFER   */
*       RECLEN2=STR2L+4;            /* SET LL FIELD                  */
         LA    @07,4                                               0884
         ALR   @07,@08                                             0884
         STH   @07,RECLEN2(,COMMREG)                               0884
*       RECOFF2=0;                  /* SET OFFSET FIELD TO ZERO      */
         SLR   @07,@07                                             0885
         STH   @07,RECOFF2(,COMMREG)                               0885
*       RECTEXT2(1:STR2L)=STR2PTR->STRING;/* MOVE TEXT INTO BFR      */
         BCTR  @08,0                                               0886
         L     @07,STR2PTR                                         0886
         EX    @08,@SM01530                                        0886
*       LETXTPTR=ADDR(RECLEN2);     /* PTR TO STRING                 */
         LA    @08,RECLEN2(,COMMREG)                               0887
         ST    @08,LETXTPTR                                        0887
*       LECODE='80'X;               /* ENTRY CODE FOR IKJEBELE       */
         MVI   LECODE,X'80'                                        0888
*       CALL LINEEDIT;              /* LINE EDIT STRING              */
         BAL   @14,LINEEDIT                                        0889
*       STR2PTR->STRING(1:STR2L)=RECTEXT2;/* RETURN STRING TO ORIG.
*                                      BFR                           */
         L     @12,STR2PTR                                         0890
         L     @08,TABPTR1                                         0890
         LH    @08,STR2L(,@08)                                     0890
         BCTR  @08,0                                               0890
         EX    @08,@SM01532                                        0890
*     END;                                                         0891
*                                                                  0891
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TEXT1 PRESENT AND NOT NULL                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0892
*   IF STR1L>0 THEN                 /* IF YES, LINE EDIT STRING AND
*                                      SCAN RECORD FOR STRING        */
@RF00882 SLR   @12,@12                                             0892
         L     @08,TABPTR1                                         0892
         LH    @08,STR1L(,@08)                                     0892
         CR    @08,@12                                             0892
         BNH   @RF00892                                            0892
*     DO;                           /* MOVE TEXT1 INTO WORK BUFFER   */
*       RECLEN2=STR1L+4;            /* SET LL FIELD                  */
         LA    @07,4                                               0894
         ALR   @07,@08                                             0894
         STH   @07,RECLEN2(,COMMREG)                               0894
*       RECOFF2=0;                  /* SET OFFSET FIELD TO ZERO      */
         SLR   @07,@07                                             0895
         STH   @07,RECOFF2(,COMMREG)                               0895
*       RECTEXT2(1:STR1L)=STR1PTR->STRING;/* MOVE TEXT INTO BFR      */
         BCTR  @08,0                                               0896
         L     @07,STR1PTR                                         0896
         EX    @08,@SM01530                                        0896
*       LETXTPTR=ADDR(RECLEN2);     /* PTR TO STRING                 */
         LA    @08,RECLEN2(,COMMREG)                               0897
         ST    @08,LETXTPTR                                        0897
*       LECODE='80'X;               /* ENTRY CODE FOR IKJEBELE       */
         MVI   LECODE,X'80'                                        0898
*       CALL LINEEDIT;              /* LINE EDIT STRING              */
         BAL   @14,LINEEDIT                                        0899
*       STR1PTR->STRING(1:STR1L)=RECTEXT2;/* RETURN STRING TO ORIG.
*                                      BFR                           */
         L     @12,STR1PTR                                         0900
         L     @08,TABPTR1                                         0900
         LH    @08,STR1L(,@08)                                     0900
         LR    @07,@08                                             0900
         BCTR  @07,0                                               0900
         EX    @07,@SM01532                                        0900
*       SECHARCT=                   /* MAX NUMBER OF A45363          */
*           RECLEN-4;               /* CHAR TO SCAN A45363           */
         LH    @12,RECLEN(,COMMREG)                                0901
         SH    @12,@CH00599                                        0901
         STH   @12,SECHARCT                                        0901
*       STR1LENS=STR1L;             /* SAVE LENGTH OF YA01203 STRING
*                                      1 YA01203                     */
         STH   @08,STR1LENS                                        0902
*STRGCHNG:                                                         0903
*       ;                           /* BEGINNING OF MAIN LOOP        */
*                                                                  0903
STRGCHNG DS    0H                                                  0904
*       /*************************************************************/
*       /*                                                           */
*       /* ----------------------------------------- SCAN RECORD FOR */
*       /* TEXT1 TO DETERMINE THE OFFSET AT WHICH TO PERFORM THE TEXT*/
*       /* CHANGE -----------------------------------------          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0904
*       STR1L=STR1LENS;             /* RESET LENGTH OFYA01203 STRING
*                                      1 YA01203                     */
         LH    @12,STR1LENS                                        0904
         L     @08,TABPTR1                                         0904
         STH   @12,STR1L(,@08)                                     0904
*       SESTRLEN=STR1L;             /* LENGTH OF TEXT1               */
         STH   @12,SESTRLEN                                        0905
*       SETXTPTR=STR1PTR;           /* PTR TO TEXT1                  */
         MVC   SETXTPTR(4),STR1PTR                                 0906
*       PARMREG1=ADDR(SEPLIST);     /* PTR TO PARMLIST               */
         LA    PARMREG1,SEPLIST                                    0907
*       PARMREG0=COMMREG;           /* PTR TO COMM. AREA             */
         LR    PARMREG0,COMMREG                                    0908
*       CALL IKJEBESE;              /* SCAN RECORD(S)                */
         L     @15,@CV00582                                        0909
         BALR  @14,@15                                             0909
*       SERTAREA=RETCDREG;          /* SAVE RETURN CODE AND TEXT1  0910
*                                      OFFSET IN RECORD              */
*                                                                  0910
         ST    RETCDREG,SERTAREA                                   0910
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF ATTENTION ISSUED                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0911
*       IF CAATTNIS='1'B THEN       /* IF YES, TERMINATE PROCESS     */
         TM    CAATTNIS(COMMREG),B'01000000'                       0911
         BO    @RT00911                                            0911
*         GO TO NOTEXT1;            /* RETURN TO CALLER              */
*                                                                  0912
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF I/O ERROR OCCURRED                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0913
*       IF SERTCD='0C'X THEN        /* IF YES, SET RETURN CODE AND 0913
*                                      TERMINATE PROCESS             */
         CLI   SERTCD,X'0C'                                        0913
         BNE   @RF00913                                            0913
*         DO;                       /* PREPARE FOR ERROR EXIT        */
*IOERRMSG:                                                         0915
*           CHRETCD=12;             /* SET RC FOR IKJEBEMA           */
IOERRMSG MVC   CHRETCD(4),@CF00143                                 0915
*           GO TO CHGEXIT4;         /* RETURN TO CALLER              */
         B     CHGEXIT4                                            0916
*         END;                                                     0917
*                                                                  0917
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF TEXT NOT FOUND IN RECORD                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0918
*       IF SERTCD='08'X THEN        /* IF NOT, BEGIN END PROCESSING  */
@RF00913 CLI   SERTCD,X'08'                                        0918
         BNE   @RF00918                                            0918
*         DO;                       /* DETERMINE IF MESSAGE TO SEND  */
*NOTXT:                                                            0920
*           ;                       /* SEND TEXT NOT FOUND MSG       */
*                                                                  0920
NOTXT    DS    0H                                                  0921
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF THIS IS FIRST CHANGE                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0921
*           IF FIRSTCHG='1'B THEN   /* IF YES, NOTIFY USER           */
         TM    FIRSTCHG,B'01000000'                                0921
         BNO   @RF00921                                            0921
*             DO;                   /* SEND MESSAGE RELATIVE MSG   0922
*                                      NUMBER                        */
*               RELMSG1=1292;       /* NO 2ND LEVEL MESSAGE          */
         MVC   RELMSG1(2),@CH01446                                 0923
*               RELMSG2=0;          /* NO 1ST LEVEL INSERTS          */
         SLR   @12,@12                                             0924
         STH   @12,RELMSG2                                         0924
*               LEV1INS=0;          /* NO 2ND LEVEL INSERTS          */
         SLR   LEV1INS,LEV1INS                                     0925
*               LEV2INS=0;          /* INDICATE FLUSH                */
         SLR   LEV2INS,LEV2INS                                     0926
*               CHRETCD=8;          /* SEND MSG TO USER              */
         MVC   CHRETCD(4),@CF00058                                 0927
*               CALL SENDMSG;                                      0928
         BAL   @14,SENDMSG                                         0928
*             END;                                                 0929
*           GO TO NOTEXT1;          /* RETURN TO CALLER              */
         B     NOTEXT1                                             0930
*         END;                                                     0931
*                                                                  0931
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF TEXT FOUND ACROSS RECORD BOUNDARIES              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0932
*       IF SERTCD='04'X THEN        /* IF YES, REMOVE TEXT FOUND IN
*                                      SECOND RECORD                 */
@RF00918 CLI   SERTCD,X'04'                                        0932
         BNE   @RF00932                                            0932
*         DO;                       /* CALL SUBRTN TO STRIP TEXT2    */
*           SERTCD='00'X;           /* ZERO RETURN CODE              */
         MVI   SERTCD,X'00'                                        0934
*           CALL BDYCHG;            /* REMOVE TEXT                   */
         BAL   @14,BDYCHG                                          0935
*         END;                                                     0936
*     END;                                                         0937
*   ELSE                            /* IF NO, VALIDITY CHECK STRING  */
*     DO;                           /* DETERMINE OPERATION WITH TEXT2
*                                      NULL AND PRESENT              */
*                                                                  0938
         B     @RC00892                                            0938
@RF00892 DS    0H                                                  0939
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF BOTH STRINGS NULL                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0939
*       IF STR2L=0 THEN             /* IF YES, INVALID OPERATION     */
         L     @12,TABPTR1                                         0939
         ICM   @08,3,STR2L(@12)                                    0939
         BZ    @RT00939                                            0939
*         GO TO NOTXT;              /* NOTIFY USER                   */
*       OFF1=1;                     /* SET OFFSET TO BEGINNING OF  0941
*                                      RECORD TO INSERT TEXT2        */
         MVC   OFF1(4),@CF00060                                    0941
*     END;                                                         0942
*                                                                  0942
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TEXT2 PRESENT                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0943
*   IF STR2F='0'B THEN              /* IF NO, STRING COUNT CASE      */
@RC00892 L     @12,TABPTR1                                         0943
         TM    STR2F(@12),B'10000000'                              0943
         BNZ   @RF00943                                            0943
*     DO;                           /* PREPARE TO CALL IKJEBECN      */
*       CHARCNT=OFF1-1;             /* SET COUNT TO ZERO ORG         */
*                                                                  0945
         L     @12,OFF1                                            0945
         BCTR  @12,0                                               0945
         ST    @12,CHARCNT                                         0945
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CHARATER COUNT PROCESSING RTN                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0946
*       CALL CHARRTN;                                              0946
         BAL   @14,CHARRTN                                         0946
*       GO TO CHGEXIT5;             /* RETURN TO CALLER              */
         B     CHGEXIT5                                            0947
*     END;                                                         0948
*INSTXT:                                                           0949
*   CALL RECSHIFT;                  /* PREPARE LINE FOR CHANGE       */
@RF00943 DS    0H                                                  0949
INSTXT   BAL   @14,RECSHIFT                                        0949
*   SECHARCT=SECHARCT               /* UPDATE CHAR COUNT BY A45363   */
*       -STR1L+1;                   /* NUMBR CHAR REPLACED-1 A45363  */
*                                                                  0950
         LH    @12,SECHARCT                                        0950
         L     @08,TABPTR1                                         0950
         SH    @12,STR1L(,@08)                                     0950
         AL    @12,@CF00060                                        0950
         STH   @12,SECHARCT                                        0950
*   /*****************************************************************/
*   /*                                                               */
*   /* ************************************************** A45363     */
*   /* CHECK IF STRING SEARCH CHAR COUNT IS NEGATIVE A45363          */
*   /* ************************************************** A45363     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0951
*   IF SECHARCT<0                   /* A45363                        */
*     THEN                          /* A45363                        */
         SLR   @08,@08                                             0951
         CR    @12,@08                                             0951
         BNL   @RF00951                                            0951
*     SECHARCT=0;                   /* IF YES, SET TO ZERO A45363    */
         STH   @08,SECHARCT                                        0952
*   SEOFFS=OFF1+STR2L-1;            /* UPDATE TO NEW LINE OFFSET     */
*                                                                  0953
@RF00951 L     @12,OFF1                                            0953
         L     @08,TABPTR1                                         0953
         LH    @08,STR2L(,@08)                                     0953
         ALR   @08,@12                                             0953
         BCTR  @08,0                                               0953
         STH   @08,SEOFFS                                          0953
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TEXT1 BEGINS IN COLUMN ONE                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0954
*   IF OFF1>1 THEN                  /* IF NO, MOVE DATA UPTO CHANGE  */
         CH    @12,@CH00060                                        0954
         BNH   @RF00954                                            0954
*     TEXTBFR(1:OFF1-1)=RECTEXT;    /* MOVE TO TEMP BUFFER           */
*                                                                  0955
         BCTR  @12,0                                               0955
         BCTR  @12,0                                               0955
         EX    @12,@SM01534                                        0955
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NULL TEXT2 SPECIFIED                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0956
*   IF STR2L¬=0 THEN                /* IF NO, REPLACE TEXT IN LINE   */
*                                                                  0956
@RF00954 L     @12,TABPTR1                                         0956
         LH    @12,STR2L(,@12)                                     0956
         LTR   @12,@12                                             0956
         BZ    @RF00956                                            0956
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT TEXT2 IN TEMPORARY BUFFER                            */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0957
*     TEXTBFR(OFF1:OFF1+STR2L-1)=STR2PTR->STRING;                  0957
*                                                                  0957
         LR    @08,COMMREG                                         0957
         AL    @08,OFF1                                            0957
         BCTR  @12,0                                               0957
         L     @07,STR2PTR                                         0957
         EX    @12,@SM01536                                        0957
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MORE DATA AFTER CHANGE AREA IN RECORD                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0958
*   IF RECLEN>OFF1+STR1L+3 THEN     /* IF YES, MOVE REST OF DATA     */
*                                                                  0958
@RF00956 LH    @12,RECLEN(,COMMREG)                                0958
         L     @08,OFF1                                            0958
         L     @07,TABPTR1                                         0958
         LH    @05,STR1L(,@07)                                     0958
         LR    @15,@08                                             0958
         ALR   @15,@05                                             0958
         LA    @00,3                                               0958
         ALR   @00,@15                                             0958
         CR    @12,@00                                             0958
         BNH   @RF00958                                            0958
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE DATA BEYOND TEXT CHANGE INTO TEMP BFR                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0959
*     TEXTBFR(OFF1+STR2L:RECLEN+STR2L-STR1L-4)=RECTEXT(OFF1+STR1L: 0959
*         RECLEN-4);                                               0959
*                                                                  0959
         LH    @07,STR2L(,@07)                                     0959
         ALR   @08,@07                                             0959
         ST    @08,@TF00001                                        0959
         ALR   @08,COMMREG                                         0959
         ALR   @12,@07                                             0959
         SLR   @12,@05                                             0959
         SL    @12,@TF00001                                        0959
         SH    @12,@CH00599                                        0959
         ALR   @15,COMMREG                                         0959
         EX    @12,@SM01538                                        0959
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE NEW LENGTH OF DATA                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0960
*   ENDPTR=RECLEN+STR2L-STR1L-4;                                   0960
*                                                                  0960
@RF00958 L     @12,TABPTR1                                         0960
         LH    ENDPTR,RECLEN(,COMMREG)                             0960
         AH    ENDPTR,STR2L(,@12)                                  0960
         SH    ENDPTR,STR1L(,@12)                                  0960
         SH    ENDPTR,@CH00599                                     0960
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LINE EMPTY AFTER CHANGE OPERATION                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0961
*   IF ENDPTR=0 THEN                /* IF YES, GENERATE BLANK LINE   */
         LTR   ENDPTR,ENDPTR                                       0961
         BNZ   @RF00961                                            0961
*     DO;                           /* PUT ONE BLANK IN LINE         */
*       TEXTBFR(1)=' ';             /* BLANK 1ST CHARACTER           */
         MVI   TEXTBFR(COMMREG),C' '                               0963
*       ENDPTR=1;                   /* SET NEW LENGTH TO ONE         */
         LA    ENDPTR,1                                            0964
*     END;                                                         0965
*                                                                  0965
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA PORTION OF NEW LINE EXCEEDS 256                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0966
*   IF ENDPTR>256 THEN              /* IF YES, MOVE IN TWO PARTS     */
@RF00961 CH    ENDPTR,@CH00568                                     0966
         BNH   @RF00966                                            0966
*     DO;                           /* USE DOUBLE BFR BASED ON DATA  */
*       NEWTEXT(1:256)=             /* FIRST MOVE                    */
*           TEXTBFR(1:256);                                        0968
         MVC   NEWTEXT(256,COMMREG),TEXTBFR(COMMREG)               0968
*       NEWTEXT(257:ENDPTR)=        /* SECOND MOVE                   */
*           TEXTBFR(257:ENDPTR);                                   0969
         LR    @12,ENDPTR                                          0969
         SH    @12,@CH01450                                        0969
         EX    @12,@SM01540                                        0969
*     END;                                                         0970
*   ELSE                            /* IF NO, MOVE IN ONE PART       */
*     RECTEXT(1:ENDPTR)=TEXTBFR(1:ENDPTR);                         0971
         B     @RC00966                                            0971
@RF00966 LR    @12,ENDPTR                                          0971
         BCTR  @12,0                                               0971
         EX    @12,@SM01542                                        0971
*   RECLEN=ENDPTR+4;                /* SET NEW LENGTH OF TEXT        */
@RC00966 LA    @08,4                                               0972
         ALR   @08,ENDPTR                                          0972
         STH   @08,RECLEN(,COMMREG)                                0972
*   LETXTPTR=ADDR(RECLEN);          /* PTR TO TEXT                   */
         LA    @08,RECLEN(,COMMREG)                                0973
         ST    @08,LETXTPTR                                        0973
*   LECODE='00'X;                   /* NOT DELIMITED STRING CODE     */
         MVI   LECODE,X'00'                                        0974
*   CALL LINEEDIT;                  /* LINE EDIT TEXT                */
         BAL   @14,LINEEDIT                                        0975
*CHKOVRFL:                                                         0976
*   ;                               /* OVERFLOW AND WRITE PROCESS    */
*                                                                  0976
CHKOVRFL DS    0H                                                  0977
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ALL CHANGES COMPLETED ON PREVIOUS LINES AND THEIR    */
*   /* ASSOCIATED OVERFLOW LINES AND VERIFY IS NOT IN EFFECT         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0977
*   IF KEYFLD>VERKEY+VERCNT&CAVRFYSW='0'B THEN/* IF YES, RESET     0977
*                                      OVERFLOW CNTR                 */
         L     @08,VERKEY                                          0977
         AL    @08,VERCNT                                          0977
         C     @08,KEYFLD(,COMMREG)                                0977
         BNL   @RF00977                                            0977
         TM    CAVRFYSW(COMMREG),B'01000000'                       0977
         BNZ   @RF00977                                            0977
*     VERCNT=0;                     /* SET COUNTER TO ZERO           */
*                                                                  0978
         SLR   @08,@08                                             0978
         ST    @08,VERCNT                                          0978
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0979
*   IF RETCODE=4 THEN               /* IF YES, PROCESS CONDITION     */
@RF00977 CH    RETCODE,@CH00599                                    0979
         BNE   @RF00979                                            0979
*     DO;                           /* PROCESS OVERFLOW AND SEND   0980
*                                      APPROPRIATE MESSAGE           */
*                                                                  0980
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF NON-LINE NUMBERED TEXT DATA SET TYPE             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0981
*       IF CANONUM='1'B&CADSCODE=CATEXT THEN/* IF YES, BRANCH TO   0981
*                                      PROCESS                       */
         TM    CANONUM(COMMREG),B'00000001'                        0981
         BNO   @RF00981                                            0981
         CLI   CADSCODE(COMMREG),X'05'                             0981
         BNE   @RF00981                                            0981
*         DO;                       /* SPECIAL PROCESS FOR TEXT      */
*           J=KEYFLD;               /* SAVE KEY OF CHANGED RECORD    */
         L     J,KEYFLD(,COMMREG)                                  0983
*           GO TO LNOVRFL1;         /* PROCESS OVERFLOW LINES        */
         B     LNOVRFL1                                            0984
*         END;                                                     0985
*                                                                  0985
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF FIRST TIME LINE TRUNCATED                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0986
*       IF TRUNCKEY¬=KEYFLD THEN    /* IF YES, ISSUE TRUNCATION MSG  */
@RF00981 L     @12,KEYFLD(,COMMREG)                                0986
         C     @12,TRUNCKEY                                        0986
         BE    @RF00986                                            0986
*         DO;                                                      0987
*           TRUNCKEY=KEYFLD;        /* MARK AS LAST LINE TRUNC       */
         ST    @12,TRUNCKEY                                        0988
*           RELMSG1=1293;           /* MSG IKJ52507I                 */
         MVC   RELMSG1(2),@CH01404                                 0989
*           BINRYREG=CALRECL-4;     /* DATA SET LINE SIZE            */
*                                                                  0990
         LH    BINRYREG,CALRECL(,COMMREG)                          0990
         SH    BINRYREG,@CH00599                                   0990
*           /*********************************************************/
*           /*                                                       */
*           /* ----------------------------------------- CONVERT TO  */
*           /* DECIMAL, UNPACK AND SET ZONE SIGN FOR EBCDIC          */
*           /* CHARACTERS -----------------------------------------  */
*           /* CONVERT NUMBER TO DECIMAL                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0991
*           GEN(CVD BINRYREG,PACKAREA)                             0991
*           REFS(BINRYREG,PACKAREA);                               0991
*                                                                  0991
         CVD BINRYREG,PACKAREA
*           /*********************************************************/
*           /*                                                       */
*           /* UNPACK DECIMAL RESULT                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0992
*           GENERATE REFS(PACKAREA);                               0992
*                                                                  0992
         UNPK  PACKAREA(3),PACKAREA+6(2)
*           /*********************************************************/
*           /*                                                       */
*           /* SET ZONE SIGN                                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0993
*           PACKAREA(3)=PACKAREA(3)|'F0'X;                         0993
         OI    PACKAREA+2,X'F0'                                    0993
*           MSGPTR2=0;              /* NO 2ND INSERTION              */
         SLR   @12,@12                                             0994
         ST    @12,MSGPTR2(,COMMREG)                               0994
*           MSGOFF2=25;             /* OFFSET FOR INSERTION          */
*                                                                  0995
         MVC   MSGOFF2(2,COMMREG),@CH01406                         0995
*           /*********************************************************/
*           /*                                                       */
*           /* REMOVE ALL LEADING ZEROES FROM MSG INSERT             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0996
*           DO I=1 TO 3;                                           0996
*                                                                  0996
         LA    I,1                                                 0996
@DL00996 DS    0H                                                  0997
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF NON-ZERO CHARACTER FOUND                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0997
*             IF PACKAREA(I)¬='0' THEN/* IF YES, BRANCH OJT          */
         LA    @12,PACKAREA-1(I)                                   0997
         CLI   0(@12),C'0'                                         0997
         BNE   @RT00997                                            0997
*               GO TO OUT1;         /* FIRST NON-ZERO FOUND          */
*           END;                    /* END OF DO LOOP. NO FALL     0999
*                                      THROUGH, SINCE ALWAYS HAVE  0999
*                                      VALID NONZERO VALUE.          */
         AL    I,@CF00060                                          0999
         CH    I,@CH00101                                          0999
         BNH   @DL00996                                            0999
*OUT1:                                                             1000
*           MSGTEXT2=PACKAREA(I:3); /* MOVE TEXT                     */
OUT1     MVI   MSGTEXT2+1(COMMREG),C' '                            1000
         MVC   MSGTEXT2+2(70,COMMREG),MSGTEXT2+1(COMMREG)          1000
         LA    @12,3                                               1000
         SLR   @12,I                                               1000
         LA    @08,PACKAREA-1(I)                                   1000
         EX    @12,@SM01520                                        1000
*           MSGLEN2=8-I;            /* LENGTH OF INSERTION           */
         LA    @12,8                                               1001
         SLR   @12,I                                               1001
         STH   @12,MSGLEN2(,COMMREG)                               1001
*           RELMSG2=1;              /* NO 2ND LEVEL MESSAGE          */
*                                                                  1002
         MVC   RELMSG2(2),@CH00060                                 1002
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF DATA SET IS LINE NUMBERED                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1003
*           IF CANONUM='1'B THEN    /* IF NO, NO LINE NUMBER REFER   */
         TM    CANONUM(COMMREG),B'00000001'                        1003
         BNO   @RF01003                                            1003
*             LEV1INS=0;            /* NO 1ST LEVEL INSRT            */
         SLR   LEV1INS,LEV1INS                                     1004
*           ELSE                    /* IF YES, INSERT NUMBER IN MSG  */
*             DO;                   /* DETERMINE MESSAGE INSERTION   */
         B     @RC01003                                            1005
@RF01003 DS    0H                                                  1006
*               BINRYREG=KEYFLD;    /* BINARY LNUMBR                 */
*                                                                  1006
         L     BINRYREG,KEYFLD(,COMMREG)                           1006
*               /*****************************************************/
*               /*                                                   */
*               /* ------------------------------- CONVERT TO        */
*               /* DECIMAL, UNPACK AND SET ZONE SIGN FOR EBCDIC      */
*               /* ------------------------------- CONVERT NUMBER TO */
*               /* DECIMAL AND UNPACK DECIMAL RESULT                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1007
*               GENERATE REFS(BINRYREG);                           1007
*                                                                  1007
         CVD   BINRYREG,PACKTEMP
         UNPK  PACKAREA(8),PACKTEMP(8)
*               /*****************************************************/
*               /*                                                   */
*               /* SET ZONE SIGN                                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1008
*               PACKAREA(8)=PACKAREA(8)|'F0'X;                     1008
*                                                                  1008
         OI    PACKAREA+7,X'F0'                                    1008
*               /*****************************************************/
*               /*                                                   */
*               /* REMOVE ALL LEADING ZEROES                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1009
*               DO I=1 TO 7;                                       1009
*                                                                  1009
         LA    I,1                                                 1009
@DL01009 DS    0H                                                  1010
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK IF FIRST SIGNIFICANT DIGIT FOUND          */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1010
*                 IF PACKAREA(I)¬='0' THEN/* IF YES, BRANCH OUT      */
         LA    @12,PACKAREA-1(I)                                   1010
         CLI   0(@12),C'0'                                         1010
         BNE   @RT01010                                            1010
*                   GO TO FOUND1;   /* FIRST DGT                     */
*               END;                /* END OF DO LOOP. FALL THROUGH
*                                      ONLY IF VALUE IS ZERO. MINIMUM
*                                      OF ONE CHARACTER MUST BE SENT
*                                      AS LINE NUMBER.               */
         AL    I,@CF00060                                          1012
         CH    I,@CH00124                                          1012
         BNH   @DL01009                                            1012
*               I=8;                /* SET TO SIGNIF. POSITION       */
         LA    I,8                                                 1013
*FOUND1:                                                           1014
*               MSGTEXT=PACKAREA(I:8);/* INSERT                      */
FOUND1   MVI   MSGTEXT+1(COMMREG),C' '                             1014
         MVC   MSGTEXT+2(70,COMMREG),MSGTEXT+1(COMMREG)            1014
         LA    @12,8                                               1014
         SLR   @12,I                                               1014
         LA    @08,PACKAREA-1(I)                                   1014
         EX    @12,@SM01522                                        1014
*               MSGOFF=15;          /* OFFSET FOR INS                */
         MVC   MSGOFF(2,COMMREG),@CH00065                          1015
*               MSGLEN=13-I;        /* LENGTH OF TXT                 */
         LA    @12,13                                              1016
         SLR   @12,I                                               1016
         STH   @12,MSGLEN(,COMMREG)                                1016
*               MSGPTR=0;           /* NO 2ND INSERTION              */
         SLR   @12,@12                                             1017
         ST    @12,MSGPTR(,COMMREG)                                1017
*               LEV1INS=ADDR(MSGAREA);/* PTR TO INSERT               */
         LA    LEV1INS,MSGAREA(,COMMREG)                           1018
*             END;                                                 1019
*           LEV2INS=ADDR(MSGPTR2);  /* PTR TO INSERTION              */
@RC01003 LA    LEV2INS,MSGPTR2(,COMMREG)                           1020
*           CALL SENDMSG;           /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         1021
*         END;                                                     1022
*     END;                                                         1023
@RF00986 DS    0H                                                  1024
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */
@RF00979 MVI   UTCODE,X'20'                                        1024
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO RECORD TO BE WRITTEN   */
         LA    @08,KEYFLD(,COMMREG)                                1025
         ST    @08,KEYPTR                                          1025
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                1026
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */
         SLR   @08,@08                                             1027
         ST    @08,AREAPTR                                         1027
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */
*                                                                  1028
         BAL   @14,RDWRTRTN                                        1028
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1029
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    1029
         BE    @RT01029                                            1029
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */
*                                                                  1030
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THIS IS FIRST CHANGE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1031
*   IF FIRSTCHG='1'B THEN           /* IF YES, SET FIRST KEY VALUE   */
         TM    FIRSTCHG,B'01000000'                                1031
         BNO   @RF01031                                            1031
*     VERKEY=KEYFLD;                /* FIRST LINE TO VERIFY          */
         MVC   VERKEY(4),KEYFLD(COMMREG)                           1032
*   ELSE                            /* IF NO, VERIFY PREVIOUS LINE   */
*     CALL VERFYRTN;                /* VERIFY LINE IF NECESSARY      */
         B     @RC01031                                            1033
@RF01031 BAL   @14,VERFYRTN                                        1033
*                                                                  1034
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA SET TYPE BASIC OR IPLI                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1034
*   IF CADSCODE=CABASIC|CADSCODE=CAIPLI THEN/* IF YES, UPDATE REVERSE
*                                      POLISH DATA SET               */
@RC01031 CLI   CADSCODE(COMMREG),X'20'                             1034
         BE    @RT01034                                            1034
         CLI   CADSCODE(COMMREG),X'21'                             1034
         BNE   @RF01034                                            1034
@RT01034 DS    0H                                                  1035
*     DO;                           /* PREPARE PARAMETER LIST AND  1035
*                                      CALL PROCESSOR IF AVAILABLE   */
*       I=KEYFLD;                   /* SAVE KEY FIELD                */
         L     I,KEYFLD(,COMMREG)                                  1036
*       J=RECLEN;                   /* USE REG TO SAVE LL FIELD      */
*                                                                  1037
         LH    J,RECLEN(,COMMREG)                                  1037
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF FIXED RECORD FORMAT                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1038
*       IF CARECFM='1'B THEN        /* IF YES, REMOVE CONTROL WORD   */
         TM    CARECFM(COMMREG),B'01000000'                        1038
         BNO   @RF01038                                            1038
*         DO;                       /* INIT BUFFER PASSED            */
*           SCPTR2=0;               /* NO CHAINED BFRS               */
         SLR   @12,@12                                             1040
         ST    @12,SCPTR2(,COMMREG)                                1040
*           SCCNT2=1;               /* ONE RECORD SENT               */
         MVI   SCCNT2(COMMREG),X'01'                               1041
*           CASYNBFR=ADDR(SCPTR2);  /* BFR PTR                       */
         LA    @12,SCPTR2(,COMMREG)                                1042
         ST    @12,CASYNBFR(,COMMREG)                              1042
*         END;                                                     1043
*       ELSE                        /* IF NO, VARIABLE FORMAT        */
*         DO;                       /* INIT BUFFER PASSED            */
         B     @RC01038                                            1044
@RF01038 DS    0H                                                  1045
*           SCPTR1=0;               /* NO CHAINED BFRS               */
         SLR   @12,@12                                             1045
         ST    @12,SCPTR1(,COMMREG)                                1045
*           SCCNT1=1;               /* ONE RECORD SENT               */
         MVI   SCCNT1(COMMREG),X'01'                               1046
*           CASYNBFR=ADDR(SCPTR1);  /* BFR PTR                       */
         LA    @12,SCPTR1(,COMMREG)                                1047
         ST    @12,CASYNBFR(,COMMREG)                              1047
*         END;                                                     1048
*                                                                  1048
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF SYNTAX CHECKER AVAILABLE                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1049
*       IF CAPTCHK¬=0 THEN          /* IF YES, PASS LINE TO CHECKER  */
@RC01038 L     @12,CAPTCHK(,COMMREG)                               1049
         LTR   @12,@12                                             1049
         BZ    @RF01049                                            1049
*         DO;                       /* CALL CHECKER TO UPDATE LINE   */
*           ENTRYCD='10000'B;       /* ENTRY CODE FOR ITF            */
         MVI   ENTRYCD(COMMREG),B'10000000'                        1051
*           PARMREG1=ADDR(CASYNLST);/* PTR TO PARMLIST               */
         LA    PARMREG1,CASYNLST(,COMMREG)                         1052
*           RFY                                                    1053
*             RETCDREG RSTD;                                       1053
*           CALL CHECKER;           /* UPDATE ITF DATA SET           */
         LR    @15,@12                                             1054
         BALR  @14,@15                                             1054
*           KEYFLD=I;               /* RESTORE KEY FIELD             */
         ST    I,KEYFLD(,COMMREG)                                  1055
*           RECLEN=J;               /* RESTORE LL FIELD              */
*                                                                  1056
         STH   J,RECLEN(,COMMREG)                                  1056
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR PROCCESSOR MESSAGE                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1057
*           IF RETCDREG=4 THEN      /* YES, CHECK IF SCAN ON         */
*                                                                  1057
         CH    RETCDREG,@CH00599                                   1057
         BNE   @RF01057                                            1057
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF SCAN IS ON                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1058
*             IF CASCANSW='1'B THEN /* YES,THEN FLUSH IS NEEDED      */
         TM    CASCANSW(COMMREG),B'00010000'                       1058
         BO    @RT01058                                            1058
*               GO TO FLUSH1;       /* INDICATE FLUSH                */
*             ELSE                  /* NO SCAN THEN:                 */
*               GO TO CHKATTN1;     /* GO TO NEXT STEP               */
         B     CHKATTN1                                            1060
*           ELSE                                                   1061
*             ;                                                    1061
*                                                                  1061
@RF01057 DS    0H                                                  1062
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR SUCCESSFUL RETURN                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1062
*           IF RETCDREG=0 THEN      /* IF YES, CONTINUE PROCESSING   */
         SLR   @14,@14                                             1062
         CR    RETCDREG,@14                                        1062
         BE    @RT01062                                            1062
*             GO TO CHKATTN1;       /* NEXT STEP IN PRCS             */
*                                                                  1063
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF NOT ENOUGH CORE AVAILABLE                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1064
*           IF RETCDREG=16 THEN     /* IF YES, NOTIFY USER           */
         CH    RETCDREG,@CH00233                                   1064
         BNE   @RF01064                                            1064
*             DO;                   /* SEND MESSAGE TO USER          */
*               RELMSG1=270;        /* MSG IKJ52312I                 */
         MVC   RELMSG1(2),@CH01356                                 1066
*               LEV2INS=0;          /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     1067
*               MSGPTR=0;           /* ONLY ONE INSERTION            */
         ST    @14,MSGPTR(,COMMREG)                                1068
*               MSGLEN=CASCMDLN+4;  /* LENGTH                        */
         LA    @12,4                                               1069
         AH    @12,CASCMDLN(,COMMREG)                              1069
         STH   @12,MSGLEN(,COMMREG)                                1069
*               MSGOFF=45;          /* OFFSET FOR INSERT             */
         MVC   MSGOFF(2,COMMREG),@CH01358                          1070
*               MSGTEXT=CAPTSCMD->LNUM;/* INSERTION                  */
         MVI   MSGTEXT+8(COMMREG),C' '                             1071
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            1071
         L     @12,CAPTSCMD(,COMMREG)                              1071
         MVC   MSGTEXT(8,COMMREG),LNUM(@12)                        1071
*               LEV1INS=ADDR(MSGPTR);/* PTR TO INSERT                */
         LA    LEV1INS,MSGPTR(,COMMREG)                            1072
*               RELMSG2=0;          /* NO SECOND LEVEL MSG           */
         STH   @14,RELMSG2                                         1073
*               CALL SENDMSG;       /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         1074
*               GO TO FLUSH1;       /* BRANCH TO INDICATE FL- USH    */
         B     FLUSH1                                              1075
*             END;                                                 1076
*                                                                  1076
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF PROCESSOR FAILED                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1077
*           IF RETCDREG=20 THEN     /* IF YES, TERMINATE             */
@RF01064 CH    RETCDREG,@CH00134                                   1077
         BNE   @RF01077                                            1077
*             DO;                   /* NOTIFY IKJEBEMA AND EXIT      */
*               CHRETCD=16;         /* SET RETURN CD                 */
         MVC   CHRETCD(4),@CF00233                                 1079
*               GO TO NOTEXT1;      /* BEGIN EXIT PROCESS            */
         B     NOTEXT1                                             1080
*             END;                                                 1081
*                                                                  1081
*           /*********************************************************/
*           /*                                                       */
*           /* CONVERT RETURN CODE TO PRINTABLE CHARACTER            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1082
*           GENERATE REFS(PACKAREA);                               1082
@RF01077 DS    0H                                                  1082
         CVD   RETCDREG,PACKAREA                CONVERT TO DECIMAL
         UNPK  MSGTEXT2(3,COMMREG),PACKAREA+6(2)  UNPK NUM
         MVN   MSGTEXT2(2,COMMREG),MSGTEXT2+1(COMMREG) SET SIGN
*           RFY                                                    1083
*             RETCDREG UNRSTD;                                     1083
*           MSGTEXT(1:8)=CASYNAME;  /* INSERTION                     */
*                                                                  1084
         MVC   MSGTEXT(8,COMMREG),CASYNAME(COMMREG)                1084
*           /*********************************************************/
*           /*                                                       */
*           /* REMOVE ALL TRAILING BLANKS                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1085
*           DO I=8 TO 1 BY-1;                                      1085
*                                                                  1085
         LA    I,8                                                 1085
@DL01085 DS    0H                                                  1086
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF LAST NON-BLANK FOUND                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1086
*             IF MSGTEXT(I)¬=' ' THEN/* IF YES, END OF INSERT FOUND  */
         LR    @12,COMMREG                                         1086
         ALR   @12,I                                               1086
         CLI   MSGTEXT-1(@12),C' '                                 1086
         BNE   @RT01086                                            1086
*               GO TO LPOUT1;       /* EXIT FROM LOOP                */
*           END;                    /* END OF DO LOOP. NO FALL     1088
*                                      THROUGH, SINCE ALWAYS HAVE  1088
*                                      VALID MODULE NAME.            */
         BCTR  I,0                                                 1088
         LTR   I,I                                                 1088
         BP    @DL01085                                            1088
*LPOUT1:                                                           1089
*           MSGLEN=I+4;             /* LENGTH OF INSERTION           */
LPOUT1   LA    @12,4                                               1089
         ALR   @12,I                                               1089
         STH   @12,MSGLEN(,COMMREG)                                1089
*           RELMSG1=271;            /* RELATIVE MSG NUMBER           */
         MVC   RELMSG1(2),@CH01366                                 1090
*           LEV1INS=0;              /* NO FIRST LEVEL INSERTION      */
         SLR   LEV1INS,LEV1INS                                     1091
*           RELMSG2=1;              /* SECOND LEVEL MSG              */
         MVC   RELMSG2(2),@CH00060                                 1092
*           MSGOFF=10;              /* OFFSET FOR INSERTION          */
         MVC   MSGOFF(2,COMMREG),@CH00538                          1093
*           MSGPTR=ADDR(MSGPTR2);   /* CHAIN INSERTIONS              */
         LA    @12,MSGPTR2(,COMMREG)                               1094
         ST    @12,MSGPTR(,COMMREG)                                1094
*           MSGPTR2=0;              /* INDICATE LAST INSERTION       */
         SLR   @12,@12                                             1095
         ST    @12,MSGPTR2(,COMMREG)                               1095
*           MSGLEN2=6;              /* LENGTH OF INSERTION           */
         MVC   MSGLEN2(2,COMMREG),@CH00507                         1096
*           MSGOFF2=22;             /* OFFSET FOR INSERT             */
         MVC   MSGOFF2(2,COMMREG),@CH01346                         1097
*           LEV2INS=ADDR(MSGPTR);   /* PTR TO INSERTS                */
         LA    LEV2INS,MSGPTR(,COMMREG)                            1098
*           CALL SENDMSG;           /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         1099
*FLUSH1:                                                           1100
*           CHRETCD=8;              /* INDICATE FLUSH NEEDED         */
FLUSH1   MVC   CHRETCD(4),@CF00058                                 1100
*           GO TO CHGEXIT4;         /* RETURN TO CALLER              */
         B     CHGEXIT4                                            1101
*         END;                                                     1102
*       KEYFLD=I;                   /* RESTORE KEY FIELD             */
@RF01049 ST    I,KEYFLD(,COMMREG)                                  1103
*       RECLEN=J;                   /* RESTORE LL FIELD              */
         STH   J,RECLEN(,COMMREG)                                  1104
*     END;                                                         1105
*   GO TO CHKATTN1;                 /* BRANCH TO ATTENTION CHECK     */
         B     CHKATTN1                                            1106
*LNOVRFL1:                          /*                               */
*                                                                  1107
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THIS IS FIRST LINE CHANGE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1107
*   IF FIRSTCHG='1'B THEN           /* IF YES, SET KEY VALUE         */
LNOVRFL1 TM    FIRSTCHG,B'01000000'                                1107
         BNO   @RF01107                                            1107
*     VERKEY=KEYFLD;                /* FIRST LINE TO VERIFY          */
         MVC   VERKEY(4),KEYFLD(COMMREG)                           1108
*   ELSE                            /* IF NO, VERIFY LINE            */
*     CALL VERFYRTN;                /* VERIFY LINE IF NECESSARY      */
         B     @RC01107                                            1109
@RF01107 BAL   @14,VERFYRTN                                        1109
*NEXTLINE:                                                         1110
*   START=RECLEN-4;                 /* START BLANK SCAN AT LINE END  */
*                                                                  1110
@RC01107 DS    0H                                                  1110
NEXTLINE LH    START,RECLEN(,COMMREG)                              1110
         SH    START,@CH00599                                      1110
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND LOGICAL BREAKPOINT IN LINE(I.E. LAST BLANK IN RECORD     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1111
*   DO I=START TO 1 BY-1;                                          1111
*                                                                  1111
         LR    I,START                                             1111
         B     @DE01111                                            1111
@DL01111 DS    0H                                                  1112
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF LAST BLANK FOUND                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1112
*     IF RECTEXT(I)=' ' THEN        /* IF YES, BREAK POINT IN LINE   */
         LR    @12,COMMREG                                         1112
         ALR   @12,I                                               1112
         CLI   RECTEXT-1(@12),C' '                                 1112
         BE    @RT01112                                            1112
*       GO TO BREAKLN1;             /* PREPARE TO BREAK LINE         */
*   END;                            /* END OF DO LOOP. FALL THROUGH
*                                      ONLY IF NO BLANKS IN LINE     */
         BCTR  I,0                                                 1114
@DE01111 LTR   I,I                                                 1114
         BP    @DL01111                                            1114
*   I=START;                        /* SET BREAKPOINT MARKER AT END
*                                      OF RECORD                     */
         LR    I,START                                             1115
*BREAKLN1:                          /*                               */
*                                                                  1116
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF BLANK NOT LAST CHARACTER IN LINE                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1116
*   IF I<START THEN                 /* IF YES, BREAK LINE AT BLANK   */
BREAKLN1 CR    I,START                                             1116
         BNL   @RF01116                                            1116
*     DO;                           /* FORM OVERFLOW LINE            */
*                                                                  1117
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE DATA BEYOND BREAKPOINT INTO 2ND BFR                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1118
*       RECTEXT2=RECTEXT(I+1:START);                               1118
*                                                                  1118
         MVI   RECTEXT2+1(COMMREG),C' '                            1118
         MVC   RECTEXT2+2(253,COMMREG),RECTEXT2+1(COMMREG)         1118
         LR    @12,START                                           1118
         SLR   @12,I                                               1118
         LR    @08,@12                                             1118
         BCTR  @08,0                                               1118
         LR    @07,COMMREG                                         1118
         ALR   @07,I                                               1118
         EX    @08,@SM01524                                        1118
*       /*************************************************************/
*       /*                                                           */
*       /* ADD ON LINE OVERFLOW TO EXTRA DATA IN MAIN LINE           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1119
*       RECTEXT2(START-I+1:START-I+EXTRALEN-4)=EXTRALN;            1119
*                                                                  1119
         ST    @12,@TF00001                                        1119
         ALR   @12,COMMREG                                         1119
         L     @08,LETXTPTR                                        1119
         LH    @07,EXTRALEN(,@08)                                  1119
         LR    @15,@07                                             1119
         SH    @15,@CH00130                                        1119
         EX    @15,@SM01526                                        1119
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE LENGTH OF NEW LINE                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1120
*       RECLEN2=START-I+EXTRALEN;                                  1120
*                                                                  1120
         AL    @07,@TF00001                                        1120
         STH   @07,RECLEN2(,COMMREG)                               1120
*       /*************************************************************/
*       /*                                                           */
*       /* PROPAGATE BLANKS IN CHANGED LINE                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1121
*       MVC(RECTEXT(I+1:START),RECTEXT(I:START-1));                1121
         LR    @12,COMMREG                                         1121
         ALR   @12,I                                               1121
         LR    @08,START                                           1121
         SLR   @08,I                                               1121
         BCTR  @08,0                                               1121
         LR    @07,COMMREG                                         1121
         ALR   @07,I                                               1121
         EX    @08,@SM01528                                        1121
*     END;                                                         1122
*   ELSE                            /* IF NO, DO NOT CHANGE LINE     */
*     DO;                           /* FORM OVERFLOW LINE            */
*                                                                  1123
         B     @RC01116                                            1123
@RF01116 DS    0H                                                  1124
*       /*************************************************************/
*       /*                                                           */
*       /* FORM NEW LINE ONLY FROM OVERFLOW                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1124
*       RECTEXT2=EXTRALN;                                          1124
         MVI   RECTEXT2+251(COMMREG),C' '                          1124
         MVC   RECTEXT2+252(3,COMMREG),RECTEXT2+251(COMMREG)       1124
         L     @12,LETXTPTR                                        1124
         MVC   RECTEXT2(251,COMMREG),EXTRALN(@12)                  1124
*       RECLEN2=EXTRALEN;           /* LENGTH OF NEW LINE            */
         MVC   RECLEN2(2,COMMREG),EXTRALEN(@12)                    1125
*     END;                                                         1126
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */
@RC01116 MVI   UTCODE,X'20'                                        1127
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO LINE TO BE WRITTEN     */
         LA    @08,KEYFLD(,COMMREG)                                1128
         ST    @08,KEYPTR                                          1128
*   AREAPTR=0;                      /* NO READ AREA NECESSARY        */
         SLR   @08,@08                                             1129
         ST    @08,AREAPTR                                         1129
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                1130
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */
*                                                                  1131
         BAL   @14,RDWRTRTN                                        1131
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1132
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    1132
         BE    @RT01132                                            1132
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */
*   VERCNT=VERCNT+1;                /* UPDATE OVERFLOW CNT BY ONE    */
         LA    @12,1                                               1134
         AL    @12,VERCNT                                          1134
         ST    @12,VERCNT                                          1134
*   RELMSG1=1032;                   /* MSG IKJ52558I                 */
         MVC   RELMSG1(2),@CH01419                                 1135
*   LEV1INS=0;                      /* NO 1ST LEVEL INSERTION        */
         SLR   LEV1INS,LEV1INS                                     1136
*   RELMSG2=0;                      /* NO 2ND LEVEL MESSAGE          */
         SLR   @12,@12                                             1137
         STH   @12,RELMSG2                                         1137
*   LEV2INS=0;                      /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     1138
*   CALL SENDMSG;                   /* SEND MESSAGE TO USER          */
         BAL   @14,SENDMSG                                         1139
*   KEYFLD2=KEYFLD+1;               /* KEY FOR OVERFLOW LINE         */
         LA    @08,1                                               1140
         AL    @08,KEYFLD(,COMMREG)                                1140
         ST    @08,KEYFLD2(,COMMREG)                               1140
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT      */
         MVI   UTCODE,X'00'                                        1141
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO READ    */
         LA    @08,KEYFLD2(,COMMREG)                               1142
         ST    @08,KEYPTR                                          1142
*   AREAPTR=ADDR(KEYFLD3);          /* PTR TO READ BUFFER            */
         LA    @08,KEYFLD3(,COMMREG)                               1143
         ST    @08,AREAPTR                                         1143
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                1144
*   CALL RDWRTRTN;                  /* READ RECORD FROM DATA SET     */
*                                                                  1145
         BAL   @14,RDWRTRTN                                        1145
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1146
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    1146
         BE    @RT01146                                            1146
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */
*                                                                  1147
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THERE IS ROOM FOR OVERFLOW LINE IN DATA SET          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1148
*   IF RETCODE¬=4 THEN              /* IF NO, RIPPLE RECORDS         */
         CH    RETCODE,@CH00599                                    1148
         BE    @RF01148                                            1148
*     CALL RIPPLELN;                /* FIND SLOT FOR OVERFLOW LINE   */
         BAL   @14,RIPPLELN                                        1149
*   LETXTPTR=ADDR(RECLEN2);         /* PTR TO TEXT                   */
@RF01148 LA    @08,RECLEN2(,COMMREG)                               1150
         ST    @08,LETXTPTR                                        1150
*   LECODE='00'X;                   /* NOT DELINITED STRING CODE     */
         MVI   LECODE,X'00'                                        1151
*   CALL LINEEDIT;                  /* LINE EDIT RECORD              */
         BAL   @14,LINEEDIT                                        1152
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */
         MVI   UTCODE,X'20'                                        1153
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO WRITE   */
         LA    @08,KEYFLD2(,COMMREG)                               1154
         ST    @08,KEYPTR                                          1154
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */
         SLR   @08,@08                                             1155
         ST    @08,AREAPTR                                         1155
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */
         OI    PLISTEND,B'10000000'                                1156
*   CALL RDWRTRTN;                  /* WRITE RECORD                  */
*                                                                  1157
         BAL   @14,RDWRTRTN                                        1157
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1158
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */
         CH    RETCODE,@CH00143                                    1158
         BE    @RT01158                                            1158
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */
*                                                                  1159
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1160
*   IF RETCODE=4 THEN               /* IF YES, FIT NEW OVERFLOW LINE
*                                      INTO DATA SET                 */
         CH    RETCODE,@CH00599                                    1160
         BNE   @RF01160                                            1160
*     DO;                           /* MORE THAN ONE OVERFLOW LINE   */
*       KEYFLD=KEYFLD2;             /* MOVE KEY INTO MAIN BFR        */
         MVC   KEYFLD(4,COMMREG),KEYFLD2(COMMREG)                  1162
*       RECLEN=RECLEN2;             /* MOVE LL FIELD                 */
         MVC   RECLEN(2,COMMREG),RECLEN2(COMMREG)                  1163
*       RECTEXT=RECTEXT2;           /* MOVE DATA INTO BFR            */
         MVC   RECTEXT(255,COMMREG),RECTEXT2(COMMREG)              1164
*       GO TO NEXTLINE;             /* PROCESS NEXT LINE             */
         B     NEXTLINE                                            1165
*     END;                                                         1166
*   KEYFLD2=J;                      /* RESTORE KEY OF CHANGED LINE   */
@RF01160 ST    J,KEYFLD2(,COMMREG)                                 1167
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT LN   */
         MVI   UTCODE,X'00'                                        1168
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF CHANGED LINE    */
         LA    @08,KEYFLD2(,COMMREG)                               1169
         ST    @08,KEYPTR                                          1169
*   AREAPTR=ADDR(KEYFLD);           /* AREA TO READ INTO             */
         LA    @08,KEYFLD(,COMMREG)                                1170
         ST    @08,AREAPTR                                         1170
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARK      */
         OI    PLISTEND,B'10000000'                                1171
*   CALL RDWRTRTN;                  /* READ CHANGED LINE             */
         BAL   @14,RDWRTRTN                                        1172
*CHKATTN1:                                                         1173
*   FIRSTCHG='0'B;                  /* SET SWITCH TO INDICATE LINE 1173
*                                      CHANGE ALREADY MADE           */
*                                                                  1173
CHKATTN1 NI    FIRSTCHG,B'10111111'                                1173
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTENTION ISSUED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1174
*   IF CAATTNIS='1'B THEN           /* IF YES, RETURN TO CALLER      */
         TM    CAATTNIS(COMMREG),B'01000000'                       1174
         BO    @RT01174                                            1174
*     GO TO NOTEXT1;                /* BEGIN END PROCESSING          */
*                                                                  1175
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF 'ALL' KEYWORD SPECIFIED                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1176
*   IF ALLKYWD1=1 THEN              /* IF YES, CONTINUE PROCESS      */
*                                                                  1176
         L     @12,TABPTR1                                         1176
         CLC   ALLKYWD1(2,@12),@CH00060                            1176
         BNE   @RF01176                                            1176
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF STRING INSERTION SPECIFIED                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1177
*     IF STR1L¬=0 THEN              /* IF NO, CONTINUE WITH CURRENT
*                                      LINE                          */
         ICM   @08,3,STR1L(@12)                                    1177
         BZ    @RF01177                                            1177
*       DO;                         /* A45363                        */
*         SEMODSW                   /* FLAG, LINE A45363             */
*             ='1'B;                /* MODIFIED A45363               */
         OI    SEMODSW,B'10000000'                                 1179
*         GO TO STRGCHNG;           /* REPEAT OPERATION              */
         B     STRGCHNG                                            1180
*       END;                        /* A45363                        */
*     ELSE                                                         1182
*       ;                           /* IF YES, READ NEXT RECORD      */
@RF01177 DS    0H                                                  1183
*   ELSE                            /* IF NO, END PROCESSING         */
*     GO TO NOTEXT1;                /* BEGIN END PROCESSING          */
*                                                                  1183
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MORE LINES TO CHANGE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1184
*   IF KEYFLD<LNUM2|LNCOUNT>1 THEN  /* IF YES, PROCESS NEXT RECORD   */
         L     @12,KEYFLD(,COMMREG)                                1184
         C     @12,LNUM2                                           1184
         BL    @RT01184                                            1184
         L     @12,LNCOUNT                                         1184
         CH    @12,@CH00060                                        1184
         BNH   @RF01184                                            1184
@RT01184 DS    0H                                                  1185
*     DO;                           /* PREPARE TO READ NEXT LINE     */
*       UTCODE='02'X;               /* SET CODE TO READ NEXT LINE    */
         MVI   UTCODE,X'02'                                        1186
*       KEYFLD=VERKEY+VERCNT;       /* SET KEY TO NEWLN              */
         L     @08,VERKEY                                          1187
         AL    @08,VERCNT                                          1187
         ST    @08,KEYFLD(,COMMREG)                                1187
*       KEYPTR=ADDR(KEYFLD);        /* PTR TO READ KEY               */
         LA    @08,KEYFLD(,COMMREG)                                1188
         ST    @08,KEYPTR                                          1188
*       AREAPTR=ADDR(KEYFLD);       /* PTR TO READ BUFFER            */
         ST    @08,AREAPTR                                         1189
*       PLISTEND='1'B;              /* SET END OF PLIST MARK         */
         OI    PLISTEND,B'10000000'                                1190
*       CALL RDWRTRTN;              /* READ NEXT RECORD              */
*                                                                  1191
         BAL   @14,RDWRTRTN                                        1191
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF RECORD EXISTS                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1192
*       IF RETCDREG=4 THEN          /* IF NO, NOTIFY USER            */
         CH    RETCDREG,@CH00599                                   1192
         BNE   @RF01192                                            1192
*         DO;                       /* SEND MESSAGE TO USER          */
*           RELMSG1=1286;           /* MSG IKJ52500I                 */
*                                                                  1194
         MVC   RELMSG1(2),@CH01348                                 1194
*           /*********************************************************/
*           /*                                                       */
*           /* NO LEVEL 1 INSERTIONS                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1195
*           LEV1INS=0;                                             1195
*                                                                  1195
         SLR   LEV1INS,LEV1INS                                     1195
*           /*********************************************************/
*           /*                                                       */
*           /* NO LEVEL 2 MESSAGE                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1196
*           RELMSG2=0;                                             1196
*                                                                  1196
         SLR   @12,@12                                             1196
         STH   @12,RELMSG2                                         1196
*           /*********************************************************/
*           /*                                                       */
*           /* NO LEVEL 2 INSERTIONS                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1197
*           LEV2INS=0;                                             1197
         SLR   LEV2INS,LEV2INS                                     1197
*           CALL SENDMSG;           /* SEND MESSAGE                  */
*                                                                  1198
         BAL   @14,SENDMSG                                         1198
*           /*********************************************************/
*           /*                                                       */
*           /* RELEASE REGS TO COMPILER                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1199
*           GO TO NOTEXT1;          /* RETURN TO CALLER              */
         B     NOTEXT1                                             1199
*         END;                                                     1200
*       ELSE                        /* IF YES, CONTINUE PROCESSING   */
*         DO;                       /* DETERMINE WHETHER TO CONT.    */
*                                                                  1201
@RF01192 DS    0H                                                  1202
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF LINE WITHIN RANGE SPECIFIED                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1202
*           IF KEYFLD<=LNUM2|LNCOUNT>1 THEN/* IF YES, CONTINUE     1202
*                                      PROCESSING                    */
         L     @12,KEYFLD(,COMMREG)                                1202
         C     @12,LNUM2                                           1202
         BNH   @RT01202                                            1202
         L     @12,LNCOUNT                                         1202
         CH    @12,@CH00060                                        1202
         BNH   @RF01202                                            1202
@RT01202 DS    0H                                                  1203
*             DO;                   /* REPEAT OPERATION DECREMENT  1203
*                                      LINE COUNT BY ONE             */
*               LNCOUNT=LNCOUNT-1;                                 1204
         L     @12,LNCOUNT                                         1204
         BCTR  @12,0                                               1204
         ST    @12,LNCOUNT                                         1204
*               GO TO INSTXT;       /* INSERT TEXT IN NEXT LINE      */
         B     INSTXT                                              1205
*             END;                                                 1206
*         END;                                                     1207
@RF01202 DS    0H                                                  1208
*     END;                                                         1208
*NOTEXT1:                           /*                               */
*                                                                  1209
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ANY LINE CHANGES PERFORMED                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1209
*   IF FIRSTCHG='0'B THEN           /* IF YES, SET * AND VERIFY LN   */
@RF01184 DS    0H                                                  1209
NOTEXT1  TM    FIRSTCHG,B'01000000'                                1209
         BNZ   @RF01209                                            1209
*     DO;                           /* START END PROCESSING          */
*       CACURNUM=VERKEY+VERCNT;     /* SET * VALUE                   */
         L     @12,VERKEY                                          1211
         AL    @12,VERCNT                                          1211
         ST    @12,CACURNUM(,COMMREG)                              1211
*       KEYFLD='7FFFFFFF'X;         /* SET KEY TO MAX VALUE          */
         MVC   KEYFLD(4,COMMREG),@CF01427                          1212
*       CALL VERFYRTN;              /* VERIFY LINE IF NECESSARY      */
         BAL   @14,VERFYRTN                                        1213
*     END;                                                         1214
*CHGEXIT4:                          /*                               */
*                                                                  1215
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PROMPTING PERFORMED                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1215
*   IF PROMPTSW='1'B THEN           /* IF YES, FREE PROMPT BUFFER    */
@RF01209 DS    0H                                                  1215
CHGEXIT4 TM    PROMPTSW,B'10000000'                                1215
         BNO   @RF01215                                            1215
*     DO;                           /* INIT PARMLIST AND FREEMAIN    */
*       FREEAREA=GTPBIBUF;          /* PTR TO INPUT PRMPT BFR        */
         L     @12,GTPBPTR                                         1217
         L     @12,GTPBIBUF(,@12)                                  1217
         ST    @12,FREEAREA                                        1217
*       FREELEN=BFRLEN;             /* LENGTH OF BUFFER              */
         LH    @12,BFRLEN(,@12)                                    1218
         ST    @12,FREELEN                                         1218
*       BINRYREG=ADDR(FREEAREA);    /* PTR TO AREA INFORMATION       */
         LA    BINRYREG,FREEAREA                                   1219
*       FREELIST=FREELIST&&FREELIST;/* ZERO OUT LIST FORM            */
         XC    FREELIST(12),FREELIST                               1220
*       PARMREG1=ADDR(FREELIST);    /* PTR TO LFORM                  */
*                                                                  1221
         LA    PARMREG1,FREELIST                                   1221
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE FREEMAIN MACRO TO FREE BUFFER CORE                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1222
*       GENERATE;                                                  1222
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))
*       PROMPTSW='0'B;              /* IND. PDL FREED                */
         NI    PROMPTSW,B'01111111'                                1223
*       PARMREG1=ADDR(TABPTR2);     /* PTR TO PRMT PDL               */
         LA    PARMREG1,TABPTR2                                    1224
*     END;                                                         1225
*   ELSE                            /* IF NO, NO FREEMAIN NECESSARY  */
*     PARMREG1=ADDR(TABPTR1);       /* PTR TO MAINPDL                */
         B     @RC01215                                            1226
@RF01215 LA    PARMREG1,TABPTR1                                    1226
*   GEN(IKJRLSA (1));               /* RELEASE PDL BUILT BY IKJPARS  */
@RC01215 DS    0H                                                  1227
         IKJRLSA (1)
*CHGEXIT5:                                                         1228
*   RETCDREG=CHRETCD;               /* SET RETURN CODE IN REG 15     */
CHGEXIT5 L     RETCDREG,CHRETCD                                    1228
*   RETREG=STRNGPTR;                /* RESTORE RETURN POINT          */
         L     RETREG,STRNGPTR                                     1229
*   RETURN;                         /* RETURN TO CALLER              */
@EL00008 DS    0H                                                  1230
@EF00008 DS    0H                                                  1230
@ER00008 BR    @14                                                 1230
*   END STRNGRTN;                                                  1231
*                                                                  1232
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PERFORMS ALL THE VERIFICATIONS OF LINE CHANGES*/
*   /* BY CALLING IKJEBEMS SERVICE ROUTNE DIRECTLY THE REQUIRED      */
*   /* NUMBER OF TIMES FOR EACH LINE CHANGED AND ITS ASSOCIATED      */
*   /* OVERFLOW LINES. IKJEBEMA DOES NOT CALL IKJEBEMS TO VERIFY ANY */
*   /* OF THE UPDATES DONE BY THIS PROGRAM.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1232
*VERFYRTN:                                                         1232
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               1232
*                                                                  1232
VERFYRTN DS    0H                                                  1233
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTERS WITH SPECIAL USE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1233
*   RESPECIFY                                                      1233
*    (PARMREG1,                                                    1233
*     BINRYREG,                                                    1233
*     COMMREG,                                                     1233
*     BASEREG,                                                     1233
*     DATAREG) RSTD;                                               1233
*   RESPECIFY                                                      1234
*    (BASEREG2) RSTD;                                              1234
*   VERFYPTR=RETREG;                /* SAVE RETURN POINT ADDRESS     */
*                                                                  1235
         ST    RETREG,VERFYPTR                                     1235
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTENTION ISSUED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1236
*   IF CAATTNIS='1'B THEN           /* IF YES, BEGIN EXIT PROCESS    */
         TM    CAATTNIS(COMMREG),B'01000000'                       1236
         BNO   @RF01236                                            1236
*     DO;                           /* CLEAN UP VERIFY PROCESSING    */
*VERATTN:                                                          1238
*       VERKEY=KEYFLD;              /* SAVE LAST LINE CHANGED        */
VERATTN  MVC   VERKEY(4),KEYFLD(COMMREG)                           1238
*       VERCNT=0;                   /* ZERO OVERFLOW LINE CTR        */
         SLR   @12,@12                                             1239
         ST    @12,VERCNT                                          1239
*       GO TO VEREXIT;              /* RETURN TO CALLER IMMEDIATELY  */
         B     VEREXIT                                             1240
*     END;                                                         1241
*                                                                  1241
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF VERIFY IN EFFECT AND STRING OPERATION                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1242
*   IF CAVRFYSW='1'B THEN           /* IF YES, VERIFICATION REQUIRD  */
@RF01236 TM    CAVRFYSW(COMMREG),B'01000000'                       1242
         BNO   @RF01242                                            1242
*     DO;                           /* VERIFY LINE IF COMPLETED      */
*                                                                  1243
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF OPERATION ON LINE COMPLETED                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1244
*       IF KEYFLD>VERKEY+VERCNT THEN/* IF YES, READY TO VERIFY       */
         L     @12,VERKEY                                          1244
         AL    @12,VERCNT                                          1244
         C     @12,KEYFLD(,COMMREG)                                1244
         BNL   @RF01244                                            1244
*         DO;                       /* PREPARE TO VERIFY LINE        */
*           UTCODE='00'X;           /* SET CODE TO CURRENT           */
         MVI   UTCODE,X'00'                                        1246
*           KEYPTR=ADDR(VERKEY);    /* LINE TO VERIFY                */
         LA    @12,VERKEY                                          1247
         ST    @12,KEYPTR                                          1247
*           AREAPTR=ADDR(VERLINE);  /* PTR TO BUFFER                 */
         LA    @12,VERLINE(,COMMREG)                               1248
         ST    @12,AREAPTR                                         1248
*           PLISTEND='1'B;          /* SET END OF PLIST MARK         */
         OI    PLISTEND,B'10000000'                                1249
*RDLINE:                                                           1250
*           CALL RDWRTRTN;          /* READ LINE TO VERIFY           */
RDLINE   BAL   @14,RDWRTRTN                                        1250
*           CATPUTVF='1'B;          /* SET SWITCH ON FOR EBEMS       */
         OI    CATPUTVF(COMMREG),B'00100000'                       1251
*           RELMSG1=1280;           /* USE MSG ZERO                  */
         MVC   RELMSG1(2),@CH01480                                 1252
*           LEV2INS=0;              /* NO 2ND LEVEL INSERTION        */
         SLR   LEV2INS,LEV2INS                                     1253
*           LEV1INS=ADDR(CATEMPBF); /* PTR TO READ BFR               */
         LA    LEV1INS,CATEMPBF(,COMMREG)                          1254
*           RELMSG2=1;              /* RELATIVE SECOND LEVEL         */
         MVC   RELMSG2(2),@CH00060                                 1255
*           CALL SENDMSG;           /* VERIFY LINE                   */
*                                                                  1256
         BAL   @14,SENDMSG                                         1256
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF ATTENTION ISSUED WHILE VERIFYING             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1257
*           IF CAATTNIS='1'B THEN   /* IF YES, TERMINATE PROCESS     */
         TM    CAATTNIS(COMMREG),B'01000000'                       1257
         BO    @RT01257                                            1257
*             GO TO VERATTN;        /* CLEANUP AND EXIT              */
*                                                                  1258
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF OVERFLOW LINES EXIST                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1259
*           IF VERCNT>0 THEN        /* IF YES, OVERFLOW LINES EXIST  */
         L     @12,VERCNT                                          1259
         LTR   @12,@12                                             1259
         BNP   @RF01259                                            1259
*             DO;                   /* PREPARE TO VERIFY OVERFLOW    */
*               VERCNT=VERCNT-1;    /* DECREMENT OVERFLOW CTR BY ONE */
         BCTR  @12,0                                               1261
         ST    @12,VERCNT                                          1261
*               VERKEY=VERKEY+1;    /* INCREMENT VERIFY KEY BY ONE   */
         LA    @12,1                                               1262
         AL    @12,VERKEY                                          1262
         ST    @12,VERKEY                                          1262
*               GO TO RDLINE;       /* REPEAT OPERATION              */
         B     RDLINE                                              1263
*             END;                                                 1264
*           CATPUTVF='0'B;          /* SET SWITCH OFF                */
@RF01259 NI    CATPUTVF(COMMREG),B'11011111'                       1265
*           VERKEY=KEYFLD;          /* NEXT LINE TO VERIFY           */
         MVC   VERKEY(4),KEYFLD(COMMREG)                           1266
*         END;                                                     1267
*     END;                                                         1268
*   ELSE                            /* IF NO, NO VERIFICATION        */
*     VERKEY=KEYFLD;                /* LAST LINE CHANGED             */
         B     @RC01242                                            1269
@RF01242 MVC   VERKEY(4),KEYFLD(COMMREG)                           1269
*VEREXIT:                                                          1270
*   ;                               /* SUBROUTINE EXIT               */
@RC01242 DS    0H                                                  1270
VEREXIT  DS    0H                                                  1271
*   RETREG=VERFYPTR;                /* RESTORE RETURN POINT ADDRESS  */
         L     RETREG,VERFYPTR                                     1271
*   RETURN;                         /* EXIT LINKAGE                  */
@EL00009 DS    0H                                                  1272
@EF00009 DS    0H                                                  1272
@ER00009 BR    @14                                                 1272
*   END VERFYRTN;                   /* END OF SUBROUTINE             */
*                                                                  1274
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE STRIPS TEXT1 FROM THE SECOND LINE WHEN TEXT1  */
*   /* IS FOUND ACROSS RECORD BOUNDARIES AND RE-WRITES THE SECOND    */
*   /* LINE.                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1274
*BDYCHG:                                                           1274
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               1274
*                                                                  1274
BDYCHG   DS    0H                                                  1275
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTERS WITH SPECIAL USE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1275
*   RESPECIFY                                                      1275
*    (PARMREG1,                                                    1275
*     BINRYREG,                                                    1275
*     COMMREG,                                                     1275
*     BASEREG,                                                     1275
*     DATAREG) RSTD;                                               1275
*   RESPECIFY                                                      1276
*    (BASEREG2) RSTD;                                              1276
*   BDYPTR=RETREG;                  /* SAVE RETURN POINT             */
*                                                                  1277
         LR    BDYPTR,RETREG                                       1277
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1278
*   IF CANONUM='0'B THEN            /* IF YES, ADJUST DATA PORTION   */
         TM    CANONUM(COMMREG),B'00000001'                        1278
         BNZ   @RF01278                                            1278
*     DO;                           /* STRIP SEQUENCE FIELD          */
*                                                                  1279
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF SEQUENCE FIELD STARTS IN COL. ONE                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1280
*       IF CALINE='01'X THEN        /* IF YES, REMOVE SEQ. FIELD     */
         CLI   CALINE(COMMREG),X'01'                               1280
         BNE   @RF01280                                            1280
*         DO;                                                      1281
*                                                                  1281
*           /*********************************************************/
*           /*                                                       */
*           /* SLIDE DATA OVER SEQUENCE FIELD                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1282
*           MVC(RECTEXT2(1:RECLEN2-CALENGTH-4),RECTEXT2(CALENGTH+1:
*               RECLEN2-4));                                       1282
*                                                                  1282
         LH    @12,RECLEN2(,COMMREG)                               1282
         SLR   @08,@08                                             1282
         IC    @08,CALENGTH(,COMMREG)                              1282
         SLR   @12,@08                                             1282
         SH    @12,@CH00130                                        1282
         SLR   @08,@08                                             1282
         IC    @08,CALENGTH(,COMMREG)                              1282
         ALR   @08,COMMREG                                         1282
         EX    @12,@SM01545                                        1282
*           /*********************************************************/
*           /*                                                       */
*           /* ADJUST LL FIELD FOR VARIABLE LINES                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1283
*           RECLEN2=RECLEN2-CALENGTH;                              1283
         SLR   @12,@12                                             1283
         IC    @12,CALENGTH(,COMMREG)                              1283
         LCR   @12,@12                                             1283
         AH    @12,RECLEN2(,COMMREG)                               1283
         STH   @12,RECLEN2(,COMMREG)                               1283
*         END;                                                     1284
*       ELSE                        /* IF NO, ADJUST FOR FIXED LNS   */
*         RECLEN2=CALINE+3;         /* SET LL FLD                    */
         B     @RC01280                                            1285
@RF01280 LA    @12,3                                               1285
         SLR   @08,@08                                             1285
         IC    @08,CALINE(,COMMREG)                                1285
         ALR   @12,@08                                             1285
         STH   @12,RECLEN2(,COMMREG)                               1285
*     END;                                                         1286
@RC01280 DS    0H                                                  1287
*   I=STR1L+OFF1-RECLEN+3;          /* LENGTH OF TEXT1 IN RCD2       */
*                                                                  1287
@RF01278 L     @12,TABPTR1                                         1287
         LH    I,STR1L(,@12)                                       1287
         AL    I,OFF1                                              1287
         SH    I,RECLEN(,COMMREG)                                  1287
         AH    I,@CH00101                                          1287
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA SET LINE NUMBERED                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1288
*   IF CANONUM='0'B THEN            /* IF YES, ACCOUNT FOR SEQ FLD   */
         TM    CANONUM(COMMREG),B'00000001'                        1288
         BNZ   @RF01288                                            1288
*     I=I+CALENGTH;                 /* ADD ON SEQUENCE FLD LENGTH    */
         SLR   @12,@12                                             1289
         IC    @12,CALENGTH(,COMMREG)                              1289
         ALR   I,@12                                               1289
*   STR1L=STR1L-I;                  /* LENGTH OF TEXT1 IN RECORD1    */
*                                                                  1290
@RF01288 L     @08,TABPTR1                                         1290
         LH    @07,STR1L(,@08)                                     1290
         SLR   @07,I                                               1290
         STH   @07,STR1L(,@08)                                     1290
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1291
*   MVC(RECTEXT2(1:RECLEN2-I-4),RECTEXT2(I+1:RECLEN2-4));          1291
         LH    @08,RECLEN2(,COMMREG)                               1291
         SLR   @08,I                                               1291
         SH    @08,@CH00130                                        1291
         LR    @07,COMMREG                                         1291
         ALR   @07,I                                               1291
         EX    @08,@SM01547                                        1291
*   RECLEN2=RECLEN2-I;              /* ADJUST LENGTH FIELD           */
         LH    @08,RECLEN2(,COMMREG)                               1292
         SLR   @08,I                                               1292
         STH   @08,RECLEN2(,COMMREG)                               1292
*   LETXTPTR=ADDR(RECLEN2);         /* PTR TO TEXT                   */
         LA    @08,RECLEN2(,COMMREG)                               1293
         ST    @08,LETXTPTR                                        1293
*   LECODE='00'X;                   /* NOT DELIMITED STRING CODE     */
         MVI   LECODE,X'00'                                        1294
*   CALL LINEEDIT;                  /* LINE EDIT TEXT                */
         BAL   @14,LINEEDIT                                        1295
*   UTCODE='20'X;                   /* IKJEBEUT CODE TO WRITE LINE   */
         MVI   UTCODE,X'20'                                        1296
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO RECORD TO BE WRITTEN   */
         LA    @08,KEYFLD2(,COMMREG)                               1297
         ST    @08,KEYPTR                                          1297
*   AREAPTR=0;                      /* NO BUFFER NECESSARY           */
         SLR   @08,@08                                             1298
         ST    @08,AREAPTR                                         1298
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARK      */
         OI    PLISTEND,B'10000000'                                1299
*   CALL RDWRTRTN;                  /* WRITE UPDATED LINE            */
         BAL   @14,RDWRTRTN                                        1300
*   RETREG=BDYPTR;                  /* RESTORE RETURN POINT          */
         LR    RETREG,BDYPTR                                       1301
*   RETURN;                         /* EXIT LINKAGE                  */
@EL00010 DS    0H                                                  1302
@EF00010 DS    0H                                                  1302
@ER00010 BR    @14                                                 1302
*   END BDYCHG;                     /* END OF SUBROUTINE             */
*                                                                  1304
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE WILL SHIFT RECORD WITH SEQUENCE FIELDS        */
*   /* STARTING IN COLUMN ONE TO REMOVE THEM FROM THE DATA PORTION OF*/
*   /* THE LINE. THE LL FIELD IS ADJUSTED TO ACCOUNT FOR THE REMOVAL */
*   /* OF THE SEQUENCE FIELD. IF THE SEQUENCE FIELD IS AT THE END OF */
*   /* THE RECORD, ONLY THE LATTER OPERATION IS PERFORMED.           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1304
*RECSHIFT:                                                         1304
*   PROC OPTIONS(NOSAVEAREA,SAVE(14));/* SUBROUTINE ENTRY POINT      */
*                                                                  1304
RECSHIFT ST    @14,12(,@13)                                        1304
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTERS WITH SPECIAL USE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1305
*   RESPECIFY                                                      1305
*    (PARMREG1,                                                    1305
*     BINRYREG,                                                    1305
*     COMMREG,                                                     1305
*     BASEREG,                                                     1305
*     DATAREG) RSTD;                                               1305
*   RESPECIFY                                                      1306
*    (BASEREG2) RSTD;                                              1306
*                                                                  1306
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1307
*   IF CANONUM='0'B THEN            /* IF YES, ADJUST RECORD         */
         TM    CANONUM(COMMREG),B'00000001'                        1307
         BNZ   @RF01307                                            1307
*     DO;                           /* STRIP SEQUENCE FIELD          */
*                                                                  1308
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF SEQUENCE FIELD STARTS IN COLUMN ONE              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1309
*       IF CALINE='01'X THEN        /* IF YES, MOVE DATA UP          */
         CLI   CALINE(COMMREG),X'01'                               1309
         BNE   @RF01309                                            1309
*         DO;                                                      1310
*                                                                  1310
*           /*********************************************************/
*           /*                                                       */
*           /* SLIDE DATA OVER SEQUENCE FIELD                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1311
*           MVC(RECTEXT(1:RECLEN-CALENGTH-4),RECTEXT(CALENGTH+1:RECLEN-
*               4));                                               1311
*                                                                  1311
         LH    @12,RECLEN(,COMMREG)                                1311
         SLR   @08,@08                                             1311
         IC    @08,CALENGTH(,COMMREG)                              1311
         SLR   @12,@08                                             1311
         SH    @12,@CH00130                                        1311
         SLR   @08,@08                                             1311
         IC    @08,CALENGTH(,COMMREG)                              1311
         ALR   @08,COMMREG                                         1311
         EX    @12,@SM01514                                        1311
*           /*********************************************************/
*           /*                                                       */
*           /* ADJUST LL FIELD FOR VARIABLE LINES                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1312
*           RECLEN=RECLEN-CALENGTH;                                1312
         SLR   @12,@12                                             1312
         IC    @12,CALENGTH(,COMMREG)                              1312
         LCR   @12,@12                                             1312
         AH    @12,RECLEN(,COMMREG)                                1312
         STH   @12,RECLEN(,COMMREG)                                1312
*         END;                                                     1313
*       ELSE                        /* IF NO, ADJUST FOR FIXED LINE  */
*         RECLEN=CALINE+3;          /* ADUST LL FLD                  */
         B     @RC01309                                            1314
@RF01309 LA    @12,3                                               1314
         SLR   @08,@08                                             1314
         IC    @08,CALINE(,COMMREG)                                1314
         ALR   @12,@08                                             1314
         STH   @12,RECLEN(,COMMREG)                                1314
*     END;                                                         1315
*   RETURN;                         /* RETURN TO CALLER              */
@EL00011 DS    0H                                                  1316
@EF00011 DS    0H                                                  1316
@ER00011 L     @14,12(,@13)                                        1316
         BR    @14                                                 1316
*   END RECSHIFT;                   /* END OF SUBROUTINE             */
         B     @EL00011                                            1317
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00P PTR(31) REG(0),                                       1318
*     GPR01P PTR(31) REG(1),                                       1318
*     GPR02P PTR(31) REG(2),                                       1318
*     GPR03P PTR(31) REG(3),                                       1318
*     GPR04P PTR(31) REG(4),                                       1318
*     GPR05P PTR(31) REG(5),                                       1318
*     GPR06P PTR(31) REG(6),                                       1318
*     GPR07P PTR(31) REG(7),                                       1318
*     GPR08P PTR(31) REG(8),                                       1318
*     GPR09P PTR(31) REG(9),                                       1318
*     GPR12P PTR(31) REG(12),                                      1318
*     GPR13P PTR(31) REG(13),                                      1318
*     GPR14P PTR(31) REG(14),                                      1318
*     GPR15P PTR(31) REG(15);                                      1318
*                                                                  1318
*   /*****************************************************************/
*   /*                                                               */
*   /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1319
*   DECLARE                                                        1319
*     CASAVPTR PTR(31) BASED;       /* SAVE AREA PTR FOR IKJEBESV    */
*   DECLARE                                                        1320
*     COMMREG REG(9) PTR(31) RSTD;  /* POINTER TO EDIT COMMO AREA    */
*   DECLARE                                                        1321
*     DATAREG REG(10) PTR(31) RSTD; /* BASEREG FOR EDIT SUBCOMMAND 1321
*                                      WORK AREA                     */
*   DECLARE                                                        1322
*     CASAVE CHAR(72) BASED;        /* SAVE AREA EDIT MODULE         */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1323
*     I031F FIXED(31) BASED,                                       1323
*     I031P PTR(31) BASED,                                         1323
*     I015F FIXED(15) BASED,                                       1323
*     I015P PTR(15) BASED,                                         1323
*     I008P PTR(8) BASED,                                          1323
*     I001C CHAR(1) BASED;                                         1323
*   END IKJEBECH                    /* END OF CHANGE COMMAND LOAD  1324
*                                      MODULE                        */
*                                                                  1324
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJEBECA)                                       */
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */
*/*%INCLUDE SYSLIB  (IKJPTPB )                                       */
*/*%INCLUDE SYSLIB  (IKJGTPB )                                       */
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IKJEBEMJ)                                       */
*                                                                  1324
*       ;                                                          1324
@DATA    DS    0H
@CH00101 DC    H'3'
@CH00599 DC    H'4'
@CH00130 DC    H'5'
@CH00507 DC    H'6'
@CH00124 DC    H'7'
@CH01323 DC    H'9'
@CH00538 DC    H'10'
@CH00033 DC    H'11'
@CH00065 DC    H'15'
@CH00134 DC    H'20'
@CH01346 DC    H'22'
@CH00236 DC    H'24'
@CH01406 DC    H'25'
@CH01358 DC    H'45'
@CH00568 DC    H'256'
@CH01450 DC    H'257'
@CH01356 DC    H'270'
@CH01366 DC    H'271'
@CH01419 DC    H'1032'
@CH01308 DC    H'1033'
@CH01480 DC    H'1280'
@CH01348 DC    H'1286'
@CH01303 DC    H'1287'
@CH01320 DC    H'1288'
@CH01327 DC    H'1289'
@CH01347 DC    H'1290'
@CH01446 DC    H'1292'
@CH01404 DC    H'1293'
@SM01505 MVC   0(0,@07),LNUM(@12)
@SM01507 MVC   0(0,@08),LNUM(@07)
@SM01509 MVC   MSGTEXT(0,COMMREG),LNUM(@12)
@SM01511 MVC   MSGTEXT(0,COMMREG),LNUM(@08)
@SM01514 MVC   RECTEXT(0,COMMREG),RECTEXT(@08)
@SM01516 MVC   RECTEXT-3(0,@12),RECTEXT-4(@07)
@SM01518 MVC   RECTEXT-4(0,@08),BFRTXT(@07)
@SM01520 MVC   MSGTEXT2(0,COMMREG),0(@08)
@SM01522 MVC   MSGTEXT(0,COMMREG),0(@08)
@SM01524 MVC   RECTEXT2(0,COMMREG),RECTEXT(@07)
@SM01526 MVC   RECTEXT2(0,@12),EXTRALN(@08)
@SM01528 MVC   RECTEXT(0,@12),RECTEXT-1(@07)
@SM01530 MVC   RECTEXT2(0,COMMREG),STRING(@07)
@SM01532 MVC   STRING(0,@12),RECTEXT2(COMMREG)
@SM01534 MVC   TEXTBFR(0,COMMREG),RECTEXT(COMMREG)
@SM01536 MVC   TEXTBFR-1(0,@08),STRING(@07)
@SM01538 MVC   TEXTBFR-1(0,@08),RECTEXT-1(@15)
@SM01540 MVC   NEWTEXT+256(0,COMMREG),TEXTBFR+256(COMMREG)
@SM01542 MVC   RECTEXT(0,COMMREG),TEXTBFR(COMMREG)
@SM01545 MVC   RECTEXT2(0,COMMREG),RECTEXT2(@08)
@SM01547 MVC   RECTEXT2(0,COMMREG),RECTEXT2(@07)
         PRINT ON                                               PRC.CHX
@DATD    DSECT
         DS    0F
@TF00001 DS    F
IKJEBECH CSECT
         DS    0F
@CF00060 DC    F'1'
@CH00060 EQU   @CF00060+2
@CF00058 DC    F'8'
@CH00058 EQU   @CF00058+2
@CF00143 DC    F'12'
@CH00143 EQU   @CF00143+2
@CF00233 DC    F'16'
@CH00233 EQU   @CF00233+2
@CF01340 DC    F'-1'
@CH01340 EQU   @CF01340+2
@CF01427 DC    XL4'7FFFFFFF'
@DATD    DSECT
         DS    0D
STR1PTR  DS    A
STR2PTR  DS    A
SERTAREA DS    FL4
         ORG   SERTAREA
OFF1     DS    AL4
         ORG   OFF1
SERTCD   DS    CL1
         ORG   SERTAREA+4
TABPTR1  DS    A
TABPTR2  DS    A
TABPTR3  DS    A
CHRETCD  DS    F
CURLN    DS    F
LNCOUNT  DS    F
CHARCNT  DS    F
PPLPTR   DS    A
STRNGPTR DS    A
CHARPTR  DS    A
VERFYPTR DS    A
RCDPTR   DS    A
PTPBPTR  DS    A
GTPBPTR  DS    A
LINKLIST DS    F
LKLIBPTR DS    F
STR1LENS DS    H
STR1LEN  DS    H
STR2LEN  DS    H
PTGTLIST DS    CL20
         DS    CL2
PACKAREA DS    CL8
SRPLIST  DS    CL40
         ORG   SRPLIST
RELMSG1  DS    FL2
RELMSG2  DS    FL2
SRPLST   DS    CL36
         ORG   SRPLIST+40
UTPLIST  DS    CL12
         ORG   UTPLIST
UTCODE   DS    CL1
DCBPTR   DS    AL3
KEYPTR   DS    AL4
AREAPTR  DS    AL4
         ORG   AREAPTR
PLISTEND DS    BL1
         ORG   UTPLIST+12
LEPLIST  DS    CL8
         ORG   LEPLIST
LETXTPTR DS    AL4
         ORG   LETXTPTR
LECODE   DS    CL1
         ORG   LEPLIST+4
LECOMPTR DS    AL4
         ORG   LEPLIST+8
OTSWS    DS    CL1
         ORG   OTSWS
PROMPTSW DS    BL1
FIRSTCHG EQU   OTSWS+0
CNTSW    EQU   OTSWS+0
INSSW    EQU   OTSWS+0
@NM00023 EQU   OTSWS+0
         ORG   OTSWS+1
         DS    CL3
@NM00024 DS    CL8
         ORG   @NM00024
PRMPTNO  DS    FL4
PRMPTPTR DS    FL4
         ORG   @NM00024+8
@NM00025 DS    CL20
         ORG   @NM00025
FREEAREA DS    FL4
FREELEN  DS    FL4
FREELIST DS    CL12
         ORG   @NM00025+20
@NM00026 DS    CL8
         ORG   @NM00026
LNUM1    DS    FL4
LNUM2    DS    FL4
         ORG   @NM00026+8
@NM00027 DS    CL8
         ORG   @NM00027
VERCNT   DS    FL4
VERKEY   DS    FL4
         ORG   @NM00027+8
SEPLIST  DS    CL24
         ORG   SEPLIST
SEDCBPTR DS    AL4
SEOFFS   DS    FL2
SESTRLEN DS    FL2
SETXTPTR DS    AL4
SEBFRPTR DS    AL4
SELNRNGE DS    AL4
@NM00076 DS    CL1
SEFLAGS  DS    CL1
         ORG   SEFLAGS
SEMODSW  DS    BL1
         ORG   SEPLIST+22
SECHARCT DS    FL2
         ORG   SEPLIST+24
         DS    CL4
PACKTEMP DS    CL8
IKJEBECH CSECT
         NOPR  ((@ENDDATD-@DATD)/673*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00509 DC    V(IKJEBCH1)
@CV00510 DC    V(IKJEBCH2)
@CV00511 DC    V(IKJEBCH3)
@CV00512 DC    V(IKJEBCH4)
@CV00582 DC    V(IKJEBESE)
         DS    0D
@CC01322 DC    C'00000000'
@CC01359 DC    C'PUTLINE'
@CC01362 DC    C'GETLINE'
@CC01364 DC    C'PARSE'
         DS    CL1
PRMPTMSG DS    CL37
         ORG   PRMPTMSG
@NM00072 DC    H'37'
@NM00073 DC    H'0'
@NM00074 DC    CL10'IKJ52564A '
@NM00075 DC    CL23'ENTER COUNT OR STRING -'
         ORG   PRMPTMSG+37
         DC    0D'0'
**********************************************************
*  CONVERT EXTERNAL HEX TO ITS BINARY VALUE.             *
*  INPUT AREA IS DESTROYED AND REPLACED BY OUTPUT.       *
*  REG 1 --> INPUT/OUTPUT                                *
*  REG 0  =  LENGTH (I.E., 2 FOR TWO HEX DIGITS)         *
*  REG @5 - RETURN ADDRESS  ( BAL   @5,HEXPACK)
**********************************************************
HEXPACK  LTR   14,0                LENGTH VALID?
         BNPR  @05                 NO - EXIT
         BCTR  14,0                LENGTH MINUS 1 FOR EX
*        LR    15,@02              SAVE REG 2
         EX    14,HEXTRT           ARE ALL CHARS HEX
*        LR    @02,15              RESTORE REG 2
         BNZ   HEXINV              NO, ILLEGAL STRING
         LR    15,1                REG 15 --> RECEIVING FIELD
         LR    14,0                SAVE THE LENGTH
         SRL   0,1                 HALVE THE LENGTH
         SLL   0,1                 AND DOUBLE IT BACK
         CR    0,14                IS IT THE SAME AS IT WAS
         SRL   0,1                 HALVE IT FOR GOOD
         BNE   HEXINV              ERROR, ODD NUMBER OF CHARACTERS
HEXPACKL SR    14,14               CLEAR REG 14
         IC    14,0(,1)            REG 14  =  1ST CHAR
         CLI   0(1),C'0'           NUMBER OR LETTER
         BNL   *+8                 NUMBER - BRANCH
         LA    14,57(,14)          LETTER - CONVERT TO FA-FF
         SLL   14,4                SHIFT LEFT 4 BITS
         STC   14,0(,15)           STORE LEFT HALF
         IC    14,1(,1)            REG 14  =  2ND CHAR
         CLI   1(1),C'0'           NUMBER OR LETTER
         BNL   *+8                 NUMBER - BRANCH
         LA    14,57(,14)          LETTER - CONVERT
         SLL   14,28               SHIFT LEFT HALF TO OBLIVION
         SRL   14,28               SHIFT BACK AGAIN
         STC   14,1(,15)           STORE RIGHT HALF
         OC    0(1,15),1(15)       'OR' RIGHT HALF OVER LEFT HALF
HEXPACKN LA    1,2(,1)             INCREMENT SENDING FLD
         LA    15,1(,15)           INCREMENT RECEIVING FLD
         BCT   0,HEXPACKL          LOOP USING LENGTH IN REG 0
         BR    @05                 EXIT
         SPACE
HEXTRT   TRT   0(0,1),HEXVAL       (EXECUTED)
HEXONE   DC    F'1'
HEXVAL   DC    0D'0',193X'FF',6X'00',41X'FF',10X'00',6X'FF'
*              THE ABOVE TABLE CAN BE USED TO TEST FOR
*              HEX CHARACTERS WITH A 'TRT' INSTRUCTION.
*              IF THE FIELD IS HEX, CONDITION CODE IS 0.
*              OTHERWISE, 'TRT' CHANGES THE LOW ORDER 8 BITS
*              OF REGISTER 2 AND LOW ORDER 24 BITS OF REG 1.
         SPACE
IKJEBECH CSECT
         PRINT NOGEN                                            PRC.CHX
IKJEBCH1 IKJPARM DSECT=IKJPRMD1
LNUM11   IKJIDENT 'LINE NUMBER',ASTERISK,FIRST=NUMERIC,OTHER=NUMERIC,  X
               MAXLNTH=8,DEFAULT='*'
LNUM22   IKJIDENT 'LINE RANGE/COUNT',FIRST=NUMERIC,OTHER=NUMERIC,      X
               MAXLNTH=8
COUNT1   IKJIDENT 'CHARACTER COUNT',FIRST=NUMERIC,OTHER=NUMERIC,       X
               MAXLNTH=3
DELM1    IKJPOSIT DELIMITER
*TRING1  IKJPOSIT STRING,SQSTRING,ASIS                           S21004
*TRING2  IKJPOSIT STRING,SQSTRING,ASIS                           S21004
STRING1  IKJPOSIT STRING,SQSTRING                               PRC-CHX
STRING2  IKJPOSIT STRING,SQSTRING                               PRC-CHX
KEYWD1   IKJKEYWD
         IKJNAME 'ALL'
         IKJENDP
IKJEBCH2 IKJPARM DSECT=IKJPRMD2
COUNT2   IKJIDENT 'CHARACTER COUNT',FIRST=NUMERIC,OTHER=NUMERIC,       X
               MAXLNTH=3
DELM2    IKJPOSIT DELIMITER
*TRING3  IKJPOSIT STRING,SQSTRING,ASIS                           S21004
*TRING4  IKJPOSIT STRING,SQSTRING,ASIS                           S21004
STRING3  IKJPOSIT STRING,SQSTRING                               PRC-CHX
STRING4  IKJPOSIT STRING,SQSTRING                               PRC-CHX
KEYWD2   IKJKEYWD
         IKJNAME 'ALL'
         IKJENDP
IKJEBCH3 IKJPARM  DSECT=IKJPRMD3
CHRCOUNT IKJIDENT 'CHARACTER COUNT',FIRST=NUMERIC,OTHER=NUMERIC,       X
               MAXLNTH=3,PROMPT='VALID CHARACTER COUNT',               X
               HELP=('COUNT THAT DOES NOT EXCEED DATA PORTION OF LINE')
         IKJENDP
IKJEBCH4 IKJPARM  DSECT=IKJPRMD4
LICOUNT  IKJIDENT 'LINE COUNT',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=8,  X
               PROMPT='VALID LINE COUNT',                              X
               HELP=('DECIMAL VALUE GREATER THAN 0')
         IKJENDP
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEBECH CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
J        EQU   @05
I        EQU   @02
START    EQU   @03
SENDPTR  EQU   @12
READPTR  EQU   @02
LINEPTR  EQU   @02
BDYPTR   EQU   @03
UPTPTR   EQU   @02
RETCODE  EQU   @12
ENDPTR   EQU   @02
BASEREG2 EQU   @06
PARMREG0 EQU   @00
PARMREG1 EQU   @01
LEV1INS  EQU   @02
LEV2INS  EQU   @03
BINRYREG EQU   @04
BASEREG  EQU   @11
RETREG   EQU   @14
RETCDREG EQU   @15
COMMREG  EQU   @09
DATAREG  EQU   @10
GPR13P   EQU   @13
GPR15P   EQU   @15
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
GPR01P   EQU   @01
GPR12P   EQU   @12
GPR00P   EQU   @00
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR08P   EQU   @08
GPR09P   EQU   @09
GPR14P   EQU   @14
SAVEREG  EQU   @13
CVTPTR   EQU   16
IKJEBECA EQU   0
CAPTPRSD EQU   IKJEBECA+36
CAPRSPDL EQU   CAPTPRSD
CAPTIBFR EQU   IKJEBECA+40
CAOPERND EQU   CAPTIBFR
CAPTSCMD EQU   IKJEBECA+44
CASCMDLN EQU   IKJEBECA+48
CAPTCDCB EQU   IKJEBECA+52
CAPTCHK  EQU   IKJEBECA+72
CAATTN   EQU   IKJEBECA+120
CAATTNIS EQU   CAATTN
CACFLAG  EQU   IKJEBECA+124
CACFLAG1 EQU   CACFLAG
CAVRFYSW EQU   CACFLAG1
CASCANSW EQU   CACFLAG1
CANONUM  EQU   CACFLAG1
CACFLAG2 EQU   CACFLAG+1
CARECFM  EQU   CACFLAG2
CACFLAG3 EQU   CACFLAG+2
CAIMFLG  EQU   CACFLAG3
CACFLAG4 EQU   CACFLAG+3
CATPUTVF EQU   CACFLAG4
CAINPROC EQU   CACFLAG4
CACFLAG5 EQU   CACFLAG+4
CACFLAG6 EQU   CACFLAG+5
CAPD     EQU   IKJEBECA+152
CALINE   EQU   CAPD+18
CALENGTH EQU   CAPD+19
CASYNAME EQU   CAPD+32
CADSCODE EQU   CAPD+40
CADSATTR EQU   CAPD+41
CADSATR2 EQU   CAPD+42
CAPTPDXT EQU   IKJEBECA+228
CALRECL  EQU   IKJEBECA+232
CAEDFLAG EQU   IKJEBECA+236
CAEDFLG2 EQU   IKJEBECA+237
CASAFLAG EQU   IKJEBECA+376
CASAFLG2 EQU   IKJEBECA+377
CACURNUM EQU   IKJEBECA+456
CASYNLST EQU   IKJEBECA+496
CASYNBFR EQU   CASYNLST
CASYNWA  EQU   IKJEBECA+508
CASYNOPT EQU   IKJEBECA+524
CASYNCD2 EQU   CASYNOPT+1
CASYNSW  EQU   CASYNOPT+3
CATMPLST EQU   IKJEBECA+528
CAPTUPT  EQU   CATMPLST
CAMAWKA  EQU   IKJEBECA+596
MACFLAGS EQU   CAMAWKA+28
MACFLAG2 EQU   CAMAWKA+29
CAMODEMG EQU   IKJEBECA+928
CASCWKA  EQU   IKJEBECA+1448
CABFRPL  EQU   IKJEBECA+2120
CATEMPBF EQU   IKJEBECA+2648
CANXTSVA EQU   IKJEBECA+3896
IKJEBECX EQU   0
@NM00028 EQU   0
@NM00031 EQU   @NM00028+8
LNSTART  EQU   @NM00031
LNSTARTL EQU   @NM00031+4
@NM00032 EQU   @NM00031+6
@NM00034 EQU   @NM00028+16
LNEND    EQU   @NM00034
LNENDL   EQU   @NM00034+4
@NM00035 EQU   @NM00034+6
LNENDF   EQU   @NM00035
@NM00037 EQU   @NM00028+24
LNCNT    EQU   @NM00037
LNCNTL   EQU   @NM00037+4
@NM00038 EQU   @NM00037+6
LNCNTF   EQU   @NM00038
@NM00040 EQU   @NM00028+32
STR1     EQU   @NM00040
STR1L    EQU   @NM00040+4
@NM00041 EQU   @NM00040+6
STR1F    EQU   @NM00041
@NM00043 EQU   @NM00028+40
STR2     EQU   @NM00043
STR2L    EQU   @NM00043+4
@NM00044 EQU   @NM00043+6
STR2F    EQU   @NM00044
@NM00046 EQU   @NM00028+48
ALLKYWD1 EQU   @NM00046
@NM00047 EQU   0
@NM00050 EQU   @NM00047+8
@NM00051 EQU   @NM00050+6
@NM00053 EQU   @NM00047+16
@NM00054 EQU   @NM00053+6
@NM00056 EQU   @NM00047+24
@NM00057 EQU   @NM00056+6
@NM00059 EQU   @NM00047+32
@NM00060 EQU   0
@NM00063 EQU   @NM00060+8
CHCNT    EQU   @NM00063
CHCNTL   EQU   @NM00063+4
@NM00064 EQU   @NM00063+6
@NM00066 EQU   0
@NM00069 EQU   @NM00066+8
LICNT    EQU   @NM00069
@NM00070 EQU   @NM00069+6
PPL      EQU   0
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
LNUM     EQU   0
EXTRATXT EQU   0
EXTRALEN EQU   EXTRATXT
EXTRALN  EQU   EXTRATXT+4
@NM00077 EQU   0
STRING   EQU   0
CHECKER  EQU   0
IOPL     EQU   0
IOPLIOPB EQU   IOPL+12
PTPB     EQU   0
GTPB     EQU   0
GTPBIBUF EQU   GTPB+4
GETBUFF  EQU   0
BFRLEN   EQU   GETBUFF
BFRTXT   EQU   GETBUFF+4
UPT      EQU   0
UPTSWS   EQU   UPT+12
UPTNPRM  EQU   UPTSWS
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
CASAVPTR EQU   0
CASAVE   EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
BLANKBFR EQU   CATEMPBF
BLANKLEN EQU   BLANKBFR
BLANKOFF EQU   BLANKBFR+2
BLANKTXT EQU   BLANKBFR+4
MSGAREA  EQU   CABFRPL+260
MSGPTR   EQU   MSGAREA
MSGLEN   EQU   MSGAREA+4
MSGOFF   EQU   MSGAREA+6
MSGTEXT  EQU   MSGAREA+8
MSGPTR2  EQU   MSGAREA+80
MSGLEN2  EQU   MSGAREA+84
MSGOFF2  EQU   MSGAREA+86
MSGTEXT2 EQU   MSGAREA+88
TEXTBFR  EQU   CATEMPBF
TRUNCKEY EQU   CHARCNT
VERLINE  EQU   CATEMPBF+12
BUFFAREA EQU   CABFRPL
KEYFLD   EQU   BUFFAREA
RECLEN   EQU   BUFFAREA+4
RECTEXT  EQU   BUFFAREA+8
KEYFLD2  EQU   BUFFAREA+264
RECLEN2  EQU   BUFFAREA+268
RECOFF2  EQU   BUFFAREA+270
RECTEXT2 EQU   BUFFAREA+272
NEWTEXT  EQU   RECTEXT
ENTRYCD  EQU   CASYNCD2
IOPLPTR  EQU   PPLPTR
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTPARS  EQU   CVTS01+176
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
BFAREA2  EQU   CATEMPBF
KEYFLD3  EQU   BFAREA2
RECLEN3  EQU   BFAREA2+4
RECTEXT3 EQU   BFAREA2+8
KEYFLD4  EQU   BFAREA2+264
RECLEN4  EQU   BFAREA2+268
RECTEXT4 EQU   BFAREA2+272
@NM00087 EQU   KEYFLD
SCPTR1   EQU   @NM00087
SCCNT1   EQU   SCPTR1
SCPTR2   EQU   @NM00087+4
SCCNT2   EQU   SCPTR2
*                                      START UNREFERENCED COMPONENTS
RECOFF4  EQU   BFAREA2+270
@NM00086 EQU   BFAREA2+263
RECOFF3  EQU   BFAREA2+6
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV620 EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTRV612 EQU   CVTS01+664
CVTRV611 EQU   CVTS01+660
CVTRV610 EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTRV608 EQU   CVTS01+648
CVTRV607 EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTRV519 EQU   CVTS01+92
CVTRV327 EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00085 EQU   BUFFAREA+263
RECOFF   EQU   BUFFAREA+6
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00084 EQU   CVTFIX+248
@NM00083 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRSV37 EQU   CVTDMSR
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
UPTPREFL EQU   UPT+23
UPTPREFX EQU   UPT+16
@NM00082 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
@NM00081 EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00080 EQU   UPT
BFROFF   EQU   GETBUFF+2
@NM00079 EQU   GTPB
PTPBFLN  EQU   PTPB+8
PTPBOPUT EQU   PTPB+4
@NM00078 EQU   PTPB
IOPLECB  EQU   IOPL+8
IOPLECT  EQU   IOPL+4
IOPLUPT  EQU   IOPL
INSTEXT  EQU   @NM00077+8
INSOFF   EQU   @NM00077+6
INSLEN   EQU   @NM00077+4
INSKEY   EQU   @NM00077
EXTRAOFF EQU   EXTRATXT+2
PPLECB   EQU   PPL+8
PPLECT   EQU   PPL+4
PPLUPT   EQU   PPL
@NM00071 EQU   @NM00069+7
LICNTF   EQU   @NM00070
LICNTL   EQU   @NM00069+4
@NM00068 EQU   @NM00066+4
@NM00067 EQU   @NM00066
@NM00065 EQU   @NM00063+7
CHCNTF   EQU   @NM00064
@NM00062 EQU   @NM00060+4
@NM00061 EQU   @NM00060
ALLKYWD2 EQU   @NM00059
@NM00058 EQU   @NM00056+7
STR4F    EQU   @NM00057
STR4L    EQU   @NM00056+4
STR4     EQU   @NM00056
@NM00055 EQU   @NM00053+7
STR3F    EQU   @NM00054
STR3L    EQU   @NM00053+4
STR3     EQU   @NM00053
@NM00052 EQU   @NM00050+7
PRCNTF   EQU   @NM00051
PRCNTL   EQU   @NM00050+4
PRCNT    EQU   @NM00050
@NM00049 EQU   @NM00047+4
@NM00048 EQU   @NM00047
@NM00045 EQU   @NM00043+7
@NM00042 EQU   @NM00040+7
@NM00039 EQU   @NM00037+7
@NM00036 EQU   @NM00034+7
@NM00033 EQU   @NM00031+7
LNSTARTF EQU   @NM00032
@NM00030 EQU   @NM00028+4
@NM00029 EQU   @NM00028
CXDATEXT EQU   IKJEBECX
CAPDEXT  EQU   IKJEBECA+3984
CADSNRC2 EQU   IKJEBECA+3928
CADSNOF2 EQU   IKJEBECA+3926
CADSNLN2 EQU   IKJEBECA+3924
CADSNPT2 EQU   IKJEBECA+3920
@NM00022 EQU   IKJEBECA+3900
CASVAREA EQU   IKJEBECA+3176
CAFIBFR  EQU   IKJEBECA+1188
CAAEDCB  EQU   IKJEBECA+1096
CALDROP  EQU   IKJEBECA+1064
CAATNWKA EQU   IKJEBECA+956
CAATNBUF EQU   IKJEBECA+952
CAMODETX EQU   CAMODEMG+12
CAMODEOF EQU   CAMODEMG+10
CAMODELN EQU   CAMODEMG+8
CAMODEPT EQU   CAMODEMG+4
CAMODEIS EQU   CAMODEMG
CASRWKA  EQU   IKJEBECA+728
CAMSWKA  EQU   IKJEBECA+628
@NM00021 EQU   CAMAWKA+30
@NM00020 EQU   MACFLAG2
MATABLE1 EQU   MACFLAG2
@NM00019 EQU   MACFLAGS
MAENDPRC EQU   MACFLAGS
MAABBREV EQU   MACFLAGS
MAECTMOD EQU   MACFLAGS
@NM00018 EQU   CAMAWKA
CASTAEPL EQU   IKJEBECA+576
CASTAXPL EQU   IKJEBECA+556
CASRPLST EQU   CATMPLST+12
CAPTECB  EQU   CATMPLST+8
CAPTECT  EQU   CATMPLST+4
CASYNSCN EQU   CASYNSW
CASYNML  EQU   CASYNSW
CASYNSF  EQU   CASYNSW
CASYNRFM EQU   CASYNSW
CASYNIS  EQU   CASYNSW
@NM00017 EQU   CASYNSW
CASYNLN  EQU   CASYNSW
@NM00016 EQU   CASYNSW
CASYNRCL EQU   CASYNOPT+2
CASYNCD1 EQU   CASYNOPT
CASYNTEM EQU   CASYNWA+12
CASYNMS2 EQU   CASYNWA+8
CASYNMS1 EQU   CASYNWA+4
CASYNWAP EQU   CASYNWA+1
CASYNECD EQU   CASYNWA
CASYNPTO EQU   CASYNLST+8
CASYNPWA EQU   CASYNLST+4
@NM00015 EQU   IKJEBECA+484
CARECNO  EQU   IKJEBECA+480
CAINSAVE EQU   IKJEBECA+476
@NM00014 EQU   IKJEBECA+472
CAIMLINC EQU   IKJEBECA+468
CAIMLLNO EQU   IKJEBECA+464
CAINCRE  EQU   IKJEBECA+460
CANXTREC EQU   IKJEBECA+452
CASTNUM  EQU   IKJEBECA+448
CASAPSWD EQU   IKJEBECA+440
CASADDN  EQU   IKJEBECA+432
CASAMEMB EQU   IKJEBECA+424
CASADSN  EQU   IKJEBECA+380
CASADSNL EQU   IKJEBECA+378
CASADQTY EQU   CASAFLG2
CASANCTG EQU   CASAFLG2
CASAALOC EQU   CASAFLAG
CASAUNCG EQU   CASAFLAG
CASADSOR EQU   CASAFLAG
CASAMEM  EQU   CASAFLAG
CASADISP EQU   CASAFLAG
CASAINCP EQU   CASAFLAG
CASAFNCP EQU   CASAFLAG
CASAVEDS EQU   CASAFLAG
CADSNREC EQU   IKJEBECA+320
CADSNOFF EQU   IKJEBECA+318
CADSNLEN EQU   IKJEBECA+316
CADSNPTR EQU   IKJEBECA+312
CAEDTSIZ EQU   IKJEBECA+308
CAEDPSWD EQU   IKJEBECA+300
CAEDDDN  EQU   IKJEBECA+292
CAEDMEMB EQU   IKJEBECA+284
CAEDDSN  EQU   IKJEBECA+240
CAEDDSNL EQU   IKJEBECA+238
CAEDPRTC EQU   CAEDFLG2
CAEDALOC EQU   CAEDFLAG
CAEDUNCG EQU   CAEDFLAG
CAEDDSOR EQU   CAEDFLAG
CAEDMEM  EQU   CAEDFLAG
CAEDDISP EQU   CAEDFLAG
CAEDINCP EQU   CAEDFLAG
CAEDFNCP EQU   CAEDFLAG
CAEDITDS EQU   CAEDFLAG
CABLK2   EQU   IKJEBECA+234
@NM00013 EQU   IKJEBECA+226
CAPDEND  EQU   CAPD+82
CADATEXT EQU   CAPD+74
CAEXTNAM EQU   CAPD+66
CAPRNAME EQU   CAPD+58
CACHKOPT EQU   CAPD+56
CAULRLMX EQU   CAPD+54
CAULRLDF EQU   CAPD+52
CAVLRLMX EQU   CAPD+50
CAVLRLDF EQU   CAPD+48
CAFLRLMX EQU   CAPD+46
CAFLRLDF EQU   CAPD+44
CARECFMD EQU   CAPD+43
@NM00012 EQU   CADSATR2
CAINLIST EQU   CADSATR2
CARUNDS  EQU   CADSATR2
CAOBJGEN EQU   CADSATR2
CADSNDEF EQU   CADSATR2
CALINTAB EQU   CADSATR2
@NM00011 EQU   CADSATTR
CALRECLX EQU   CADSATTR
CALNNUM  EQU   CADSATTR
CADSCONT EQU   CADSATTR
CACAPSDF EQU   CADSATTR
CACAPSRQ EQU   CADSATTR
CASCAN   EQU   CADSATTR
CARUN    EQU   CADSATTR
CATABS   EQU   CAPD+20
CABLKS   EQU   CAPD+16
CADSQUAL EQU   CAPD+8
CADSTYPE EQU   CAPD
@NM00010 EQU   CACFLAG+8
CAPLIRTM EQU   CACFLAG+7
CAPLILFM EQU   CACFLAG+6
@NM00009 EQU   CACFLAG6
CACHAR60 EQU   CACFLAG6
CACHAR48 EQU   CACFLAG6
CAFREE   EQU   CACFLAG6
@NM00008 EQU   CACFLAG5
CAEDLNDP EQU   CACFLAG5
CADSUSED EQU   CACFLAG4
CARECURS EQU   CACFLAG4
CASCRC20 EQU   CACFLAG4
CAABEND  EQU   CACFLAG4
CAPTGTBF EQU   CACFLAG4
CAFINDIS EQU   CACFLAG4
@NM00007 EQU   CAIMFLG
CAIMINPT EQU   CAIMFLG
CAIMSFPT EQU   CAIMFLG
CAIMCIN  EQU   CAIMFLG
CAIMIR   EQU   CAIMFLG
CAIMSC   EQU   CAIMFLG
CAIMINS  EQU   CAIMFLG
CAIMPT   EQU   CAIMFLG
@NM00006 EQU   CACFLAG2
CASEQCOL EQU   CACFLAG2
CAMODMSG EQU   CACFLAG2
CASCANON EQU   CACFLAG2
CADSMODS EQU   CACFLAG2
CACAPS   EQU   CACFLAG1
CAENDSC  EQU   CACFLAG1
CAINITSC EQU   CACFLAG1
CAPROMPT EQU   CACFLAG1
CALNTOVF EQU   CACFLAG1
@NM00005 EQU   CAATTN
@NM00004 EQU   IKJEBECA+118
CAMAXBLK EQU   IKJEBECA+116
@NM00003 EQU   IKJEBECA+88
CAPTICLN EQU   IKJEBECA+84
CAPTICDS EQU   IKJEBECA+80
CAPTNBFR EQU   IKJEBECA+76
CACORELN EQU   IKJEBECA+68
CAPTCORE EQU   IKJEBECA+64
CAUTILNO EQU   IKJEBECA+60
CAPTPDCB EQU   IKJEBECA+56
@NM00002 EQU   IKJEBECA+50
CAFREEDL EQU   CAPRSPDL
CAPTRTRY EQU   IKJEBECA+32
CAPTMSGM EQU   IKJEBECA+28
CAPTUT   EQU   IKJEBECA+24
CAPTMS   EQU   IKJEBECA+20
CAPTLE   EQU   IKJEBECA+16
CAPTAT   EQU   IKJEBECA+12
CAPTAE   EQU   IKJEBECA+8
@NM00001 EQU   IKJEBECA+4
CAPTTMP  EQU   IKJEBECA
*                                      END UNREFERENCED COMPONENTS
@RT00110 EQU   CHGEXIT2
@RT00122 EQU   CHKOPRND
@RT00143 EQU   PUTERR
@RT00151 EQU   GETERR
@RT00167 EQU   PARSERR
@RT00198 EQU   PARSERR
@RF00202 EQU   ASTSPEC
@RT00210 EQU   CNTONLY
@RT00225 EQU   NOSPAN
@RF00240 EQU   READKEY
@RT00256 EQU   NOCOUNT
@RT00271 EQU   READCUR
@RT00289 EQU   PARSERR
@RT00309 EQU   CHGEXIT2
@RT00311 EQU   PROCESS
@RT00335 EQU   CHGEXIT2
@RT00356 EQU   NOLNMSG
@RT00367 EQU   CNTCHK
@RT00384 EQU   CNTPRCS
@RT00387 EQU   CNTPRCS
@RT00390 EQU   CNTPRCS
@RT00408 EQU   PARSERR
@RT00436 EQU   CHNGEXIT
@RT00442 EQU   NOCORMSG
@RT00444 EQU   CHNGEXIT
@RT00450 EQU   NOCORMSG
@RT00452 EQU   FLUSH
@RT00454 EQU   CHGEXIT2
@RT00550 EQU   NOPUTLN
@RT00558 EQU   NOPUTLN
@RT00574 EQU   NOTEXT
@RT00600 EQU   SUCCGET
@RT00602 EQU   NOCORMS1
@RT00604 EQU   NOTEXT
@RT00638 EQU   OUT
@RT00651 EQU   FOUND
@RT00669 EQU   CHGEXIT3
@RF00696 EQU   CHKATTN
@RT00703 EQU   CHKATTN
@RT00705 EQU   NOCORMS1
@RT00716 EQU   LPOUT
@RF00672 EQU   CHKATTN
@RT00728 EQU   BREAKLN
@RT00748 EQU   CHGEXIT3
@RT00762 EQU   CHGEXIT3
@RT00774 EQU   CHGEXIT3
@RT00789 EQU   CHGEXIT3
@RT00793 EQU   NOTEXT
@RT00805 EQU   CHGEXIT3
RPPLEXIT EQU   @EL00006
@RT00911 EQU   NOTEXT1
@RF00921 EQU   NOTEXT1
@RF00932 EQU   @RC00892
@RT00939 EQU   NOTXT
@RT00997 EQU   OUT1
@RT01010 EQU   FOUND1
@RT01029 EQU   CHGEXIT4
@RT01058 EQU   FLUSH1
@RF01058 EQU   CHKATTN1
@RT01062 EQU   CHKATTN1
@RT01086 EQU   LPOUT1
@RF01034 EQU   CHKATTN1
@RT01112 EQU   BREAKLN1
@RT01132 EQU   CHGEXIT4
@RT01146 EQU   CHGEXIT4
@RT01158 EQU   CHGEXIT4
@RT01174 EQU   NOTEXT1
@RF01176 EQU   NOTEXT1
@RT01257 EQU   VERATTN
@RF01244 EQU   @RC01242
@RF01307 EQU   @EL00011
@RC01309 EQU   @EL00011
@PB00011 EQU   @EL00001
@RT00841 EQU   RPPLEXIT
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKJEBECH,(C'PLS1955',0701,75237)
