IKJCT44B TITLE 'TSO/E INSTALLATION-WRITTEN BUILT-IN FUNCTION EXIT'
IKJCT44B CSECT ,
IKJCT44B AMODE 31                    EXIT'S ADDRESSING MODE
IKJCT44B RMODE ANY                   EXIT'S RESIDENCY  MODE
         TITLE 'TSO/E PROLOGUE'
***********************************************************************
*                                                                     *
* MODULE NAME - IKJCT44B                                              *
*                                                                     *
* CSECT  NAME - IKJCT44B                                              *
*                                                                     *
* DESCRIPTIVE NAME - TSO/E INSTALLATION-WRITTEN BUILT-IN FUNCTION     *
*                                                                     *
* FUNCTION -                                                          *
*                                                                     *
*  THE PARTICULAR FUNCTION OF THIS ROUTINE IS TO EVALUATE THE PASSED  *
*  STANDARD PARAMETER LIST TO SEE IF THIS REQUEST IS FOR A VALID      *
*  BCS-WRITTEN BUILT-IN FUNCTION.  IF SO, RETURN THE REQUESTED        *
*  INFORMATION WITH A RETURN CODE OF 0.  OTHERWISE RETURN WITH A      *
*  RETURN CODE OF 8.                                                  *
*                                                                     *
*  *******************                                                *
*  ***             ***                                                *
*  ***    NOTE     ***                                                *
*  ***             ***                                                *
*  *******************                                                *
*                                                                     *
*      FOR A DESCRIPTION OF THE:                                      *
*                                                                     *
*      PARAMETER ENTRY                                                *
*      PARAMKEY                                                       *
*      PARAMLEN                                                       *
*      PARAMDAT                                                       *
*                                                                     *
*      PLEASE REFER TO INPUT SECTION OF THIS PROLOGUE.                *
*                                                                     *
*  *******************                                                *
*  ***             ***                                                *
*  *** END OF NOTE ***                                                *
*  ***             ***                                                *
*  *******************                                                *
*                                                                     *
* OPERATION - IKJCT44B PERFORMS THE FOLLOWING FUNCTION:               *
*                                                                     *
*    1 - ESTABLISHES SAVE AREA TO CALLING PROGRAM                     *
*    2 - SAVES PARAMETER POINTER (R1)                                 *
*    3 - DOES A GETMAIN FOR PROGRAM'S SAVE AREA                       *
*    4 - CHAINS THE CALLER'S SAVE AREA AND THIS SAVE AREA             *
*    5 - DOES A GETMAIN FOR PROGRAM'S WORK AREA                       *
*    6 - IDENTIFIES THE FUNCTION NAME POINTED TO BY ENTRY 10          *
*    7 - IF THE NAME IS IDENTIFIED, PLACES REQUESTED INFO IN          *
*        DATA AREA OF ENTRY 12                                        *
*    8 - DOES A FREEMAIN OF DYNAMIC STORAGE                           *
*    9 - DOES A FREEMAIN OF DYNAMIC SAVE AREA                         *
*   10 - LOADS REGISTER 14 WITH RETURN ADDRESS                        *
*   11 - SETS THE RETURN CODE IN REGISTER 15                          *
*   12 - LOADS REGISTERS R0 - R12 WITH CALLER'S ENTRY CONTENTS        *
*   13 - RETURNS TO CALLER                                            *
*                                                                     *
         EJECT
*                                                                     *
* RECOVERY OPERATION -                                                *
*                                                                     *
*          MUST BE ESTABLISHED BY INVOKER OF IKJCT44B                 *
*                                                                     *
* NOTES                                                               *
*                                                                     *
*                                                                     *
* DEPENDENCIES - MAY ONLY BE ASSEMBLED WITH ASSEMBLER H               *
*                                                                     *
* RESTRICTIONS - THIS TSO/E INSTALLATION EXIT IS VALID FOR THE TSO/E  *
*                RELEASE 4 AND ABOVE PRODUCTS.                        *
*                                                                     *
*                PLEASE REFER TO THE TSO/E CUSTOMIZATION MANUAL       *
*                FOR INFORMATION REGARDING THESE TSO/E INSTALLATION   *
*                EXITS.                                               *
*                                                                     *
* ERROR MESSAGES - NONE                                               *
*                                                                     *
* ABEND CODES - NONE                                                  *
*                                                                     *
* ERROR CONDITIONS - NONE                                             *
*                                                                     *
* LINKAGES: BRANCHED TO VIA BALR OR LINKED TO                         *
*                                                                     *
* MODULE(S) CALLED: NONE                                              *
*                                                                     *
* ENTRY POINT - IKJCT44B                                              *
*                                                                     *
* EXIT CONDITIONS                                                     *
*                                                                     *
*        EXIT IS ACCOMPLISHED VIA BSM                                 *
*                                                                     *
* REFERENCES                                                          *
*                                                                     *
*        ROUTINES   - NONE                                            *
*                                                                     *
*        DATA AREAS - NONE                                            *
*                                                                     *
*    CONTROL BLOCKS - NONE                                            *
*                                                                     *
*        TABLES     - NONE                                            *
*                                                                     *
* GLOBALS:                                                            *
*                                                                     *
*       NONE                                                          *
*                                                                     *
* MACRO USAGE: SAVE,                                                  *
*              GETMAIN,                                               *
*              FREEMAIN                                               *
*                                                                     *
         EJECT
*                                                                     *
* MODULE ATTRIBUTES - REENTRANT,                                      *
*                     REFRESHABLE,                                    *
*                     REUSEABLE,                                      *
*                     AMODE(ANY),                                     *
*                     RMODE(31),                                      *
*                     MAY BE LINKED AC=1                              *
*                                                                     *
* INPUT - ON ENTRY TO IKJCT44B R1 MUST POINT TO A VARIABLE LENGTH     *
*         PARAMETER LIST THAT DESCRIBES A PARAMETER ENTRY LIST.       *
*                                                                     *
*         THE HIGH ORDER BIT IN THE LAST PARAMETER                    *
*         OF THE PARAMETER LIST MUST BE ON                            *
*         X'80000000' TO INDICATE THE END OF THE LIST.                *
*                                                                     *
         EJECT
*                                                                     *
*             PARAMETER ENTRY                                         *
*                                                                     *
*             FIELD  FIELD   FIELD                                    *
*                                                                     *
*     P       P      P       P                                        *
*     A       A      A       A                                        *
*     R       R E    R E L   R E                                      *
*     A       A N K  A N E   A N D                                    *
*     M       M T E  M T N   M T A                                    *
*     E L     E R Y  E R G   E R T                                    *
*     T I     T Y    T Y T   T Y A                                    *
*     E S     E      E   H   E                                        *
*  R1 R T     R      R       R                                        *
*   |                                                                 *
*   V         +0    +4       +8                                       *
* +--------+  +-----+--------+----------+                             *
* | PARM1  |->| 000 | 000004 | 00000000 |                             *
* +--------+  +-----+--------+----------+                             *
* | PARM2  |->| 000 | 000004 | 00000000 |                             *
* +--------+  +-----+--------+----------+  +------------------------+ *
* | PARM3  |->| 002 | UPTLEN | UPT PTR  |->| UPT                    | *
* +--------+  +-----+--------+----------+  +------------------------+ *
* | PARM4  |->| 002 | ECTLEN | ECT PTR  |->| ECT                    | *
* +--------+  +-----+--------+----------+  +------------------------+ *
* | PARM5  |->| 002 | PSCBLEN| PSCB PTR |->| PSCB                   | *
* +--------+  +-----+--------+----------+  +------------------------+ *
* | PARM6  |->| 000 | 000004 | 00000000 |                             *
* +--------+  +-----+--------+----------+                             *
* | PARM7  |->| 000 | 000004 | 00000000 |                             *
* +--------+  +-----+--------+----------+                             *
* | PARM8  |->| 000 | 000004 | 00000000 |                             *
* +--------+  +-----+--------+----------+                             *
* | PARM9  |->| 000 | 000004 | 00000000 |                             *
* +--------+  +-----+--------+----------+  +------------------------+ *
* | PARM10 |->| 002 | NAMELNG| NAME PTR |->| FUNCTION NAME          | *
* +--------+  +-----+--------+----------+  +------------------------+ *
* | PARM11 |->| 002 | ARGLEN | ARG PTR  |->| ARGUMENT               | *
* +--------+  +-----+--------+----------+  +------------------------+ *
* | PARM12 |->| 002 | 000100 | RSLT PTR |->|                        | *
* +--------+  +-----+--------+----------+  +------------------------+ *
* |8PARM13 |->| 000 | 000004 | 00000000 |    ALTERNATE BUFFER         *
* +A-------+  +-----+--------+----------+                             *
*  |                                                                  *
*  8 INDICATES END OF PARAMETER LIST                                  *
*                                                                     *
         EJECT
*                                                                     *
* OUTPUT -                                                            *
*                                                                     *
*  THE OUTPUT OF THIS TSO/E BUILT-IN FUNCTION EXIT IS:                *
*                                                                     *
*  FOR SUCCESSFULLY EVALUATED FUNCTIONS, THE REQUESTED INFORMATION    *
*  RETURNED IN PARMETER ENTRY 12.                                     *
*                                                                     *
*                                                                     *
* CHANGE ACTIVITY:                                                    *
*                                                                     *
*      INTRODUCED IN TSO/E HTE1402                                    *
*                                                                     *
***********************************************************************
         TITLE 'REGISTER EQUATES'
***********************************************************************
*                                                                     *
* REGISTER EQUATES FOLLOW                                             *
*                                                                     *
***********************************************************************
*     REGISTER EQUATES AND USAGE                                      *
*                                                                     *
         SPACE 3
R0       EQU   0                     UNPREDICTABLE
R1       EQU   1                     ON ENTRY R1 POINTS TO THE
*                                    PARAMETER LIST. AT OTHER TIMES
*                                    THE VALUE OF R1 IS UNPREDICTABLE
R2       EQU   2                     UNPREDICTABLE
R3       EQU   3                     UNPREDICTABLE
R4       EQU   4                     UNPREDICTABLE
R5       EQU   5                     UNPREDICTABLE
R6       EQU   6                     UNPREDICTABLE
R7       EQU   7                     UNPREDICTABLE
R8       EQU   8                     UNPREDICTABLE
R9       EQU   9                     UNPREDICTABLE
R10      EQU   10                    OUTPUT BUFFER
R11      EQU   11                    DATA AREA BASE REGISTER
R12      EQU   12                    CODE AREA BASE REGISTER
R13      EQU   13                    SAVE AREA BASE REGISTER
R14      EQU   14                    RETURN ADDRESS
R15      EQU   15                    RETURN CODE
         TITLE 'ENTRY CODE'
***********************************************************************
* IKJCT44B ENTRY CODE                                                 *
*                                                                     *
* DESCRIPTIVE NAME - STANDARD ENTRY LINKAGE CODE ROUTINE              *
*                                                                     *
* FUNCTION - ESTABLISHES STANDARD LINKAGE BETWEEN PROGRAMS            *
*                                                                     *
* OPERATION -                                                         *
*                                                                     *
*    1).  PERFORMS STANDARD LINKAGE BETWEEN INVOKER OF EXIT AND       *
*         EXIT.                                                       *
*    2).  OBTAINS A DYNAMIC SAVE AREA FOR THE EXIT AND                *
*         ESTABLISHES THIS AS THE SAVE AREA FOR THE EXIT              *
*    3).  OBTAINS EXIT'S DYNAMIC WORK AREA STORAGE AND                *
*         ESTABLISHES THIS AS THE WORK AREA FOR THE EXIT              *
*                                                                     *
***********************************************************************
IKJCT44B CSECT
         ENTRY IKJCT44B
         SAVE  (14,12),,IKJCT44B___TSO/E_INSTALLATION-WRITTEN_BUILT-IN_X
               FUNCTION_EXIT_ROUTINE___&SYSDATE.__&SYSTIME
*
         LR    R12,R15               LOAD R12 TO CONTAIN THE
*                                    ENTRY POINT ADDRESS OF IKJCT44B
*
         USING IKJCT44B,R12          ESTABLISH R12 TO BE THE
*                                    PROGRAM'S BASE CODE REGISTER
*
         LR    R2,R1                 SAVE THE ADDRESS OF THE PARAMETER
*                                    LIST
*
         GETMAIN RU,LV=SAVAREAL,LOC=(BELOW,ANY)
*                                    OBTAIN A DYNAMIC SAVE AREA
*                                    FOR IKJCT44B AND MAKE SURE
*                                    THE SAVE AREA IS BELOW 16
*                                    MEGABYTES IN VIRTRUAL STORAGE
*
         ST    R13,4(,R1)            SAVE THE ADDRESS OF THE INVOKER'S
*                                    SAVE AREA INTO IKJCT44B'S DYNAMIC
*                                    SAVE AREA
*
         ST    R1,8(,R13)            SAVE THE ADDRESS OF IKJCT44B'S
*                                    SAVE AREA INTO THE INVOKER'S
*                                    SAVE AREA
*
         LR    R13,R1                LOAD THE ADDRESS OF IKJCT44B'S
*                                    DYNAMIC SAVE AREA INTO R13
*                                    FOR POSSIBLE NEXT CALLER'S USE
*
         USING SAVEAREA,R13          ESTABLISH ADDRESSABILITY TO
*                                    IKJCT44B'S SAVE AREA SO THAT THE
*                                    LABELS WITHIN THE SAVE AREA
*                                    CAN BE USED IF NEEDED
*
         GETMAIN RU,LV=LWORKA,LOC=(BELOW,ANY),SP=1
*                                    OBTAIN THE DYNAMIC WORK AREA
*                                    FOR IKJCT44B IN SUBPOOL 1 AND
*                                    MAKE SURE IT IS BELOW 16
*                                    MEGABYTES IN VIRTRUAL STORAGE
*
         LR    R11,R1                LOAD THE ADDRESS OF THE DYNAMIC
*                                    WORK AREA INTO R11 FOR IKJCT44B'S
*                                    USE
*
         USING WORKA,R11             AND ESTABLISH ADDRESSABILITY
         USING PSA,0
*                                    TO THE DYNAMIC WORK AREA SO THAT
*                                    THE LABELS WITHIN THE WORK AREA
*                                    CAN BE ADDRESSED
*
         ST    R1,GM_PTR             SAVE THE ADDRESS OF IKJCT44B'S
*                                    DYNAMIC SAVE AREA FOR LATER USE
*
         ST    R2,EPLISTPT           SAVE THE ADDRESS OF THE PARAMETER
*                                    LIST THAT THE INVOKER OF IKJCT44B
*                                    PASSED IN FOR LATER USE
*
         MVC   WRKAREID,WKARIDCT     PUT INTO THE FIRST 8 POSITIONS OF
*                                    THE IKJCT44B'S DYNAMIC WORK AREA
*                                    THE CHARACTERS "WORKAREA" SO THAT
*                                    IT CAN BE EASILY FOUND IN A DUMP
*
         LA    R1,8                  INITIALIZE THE RETURN CODE
*                                    TO UNSUCCESSFUL EVALUATION.
*
         ST    R1,RETCODE            INITIALIZE THE RETURN CODE.
         TITLE 'MAIN LINE CODE'
***********************************************************************
*                                                                     *
* MAIN LINE CODE                                                      *
*                                                                     *
* DESCRIPTIVE NAME - CALL PROCESS_EXIT_PARAMETERS TO PROCESS ALL OF   *
*                    THE PARAMETERS PASSED TO THIS ROUTINE IN         *
*                    REGISTER 1.                                      *
*                                                                     *
*                                                                     *
* FUNCTION - STARTS THE PARAMETER ENTRY PROCESSING PROCESS            *
*                                                                     *
* OPERATION -                                                         *
*                                                                     *
*                                                                     *
*    1).  CALL PROCESS_EXIT_PARAMETERS                                *
*    2).  WHEN CONTROL IS RETURNED CONTROL FALLS INTO THE TERMINATION *
*         SUBROUTINE                                                  *
*                                                                     *
***********************************************************************
         SPACE 3
         BAL   R14,PROCESS_EXIT_PARAMETERS
         TITLE 'TERMINATION CODE'
***********************************************************************
*                                                                     *
* TERMINATION CODE....                                                *
*                                                                     *
* DESCRIPTIVE NAME - CLEANUP AND TERMINATION CODE                     *
*                                                                     *
* FUNCTION - RELEASES DYNAMIC STORAGE TO SYSTEM AND RETURNS TO        *
*            CALLER                                                   *
*                                                                     *
* OPERATION -                                                         *
*                                                                     *
*                                                                     *
*    1).  LOADS UP REGISTER 5 WITH THE RETURN CODE                    *
*    2).  FREES THE DYNAMIC STORAGE WORK AREA                         *
*    3).  RELOADS THE ADDRESS OF THE CALLER'S SAVE AREA               *
*    4).  FREES THE DYNAMIC STORAGE SAVE AREA                         *
*    5).  RELOADS REGISTER 14 WITH THE RETURN ADDRESS                 *
*    6).  RELOADS REGISTER 15 WITH THE RETURN CODE                    *
*    7).  RELOADS REGISTERS 0 - 12 WITH ORIGINAL CONTENTS             *
*    8).  RETURNS TO CALLER VIA BSM                                   *
*                                                                     *
***********************************************************************
         SPACE 3
         L     R5,RETCODE            LOAD R5 TO CONTAIN THE RETURN
*                                    CODE THAT IKJCT44B WILL RETURN
*                                    TO THE INVOKER.
*
         L     R1,GM_PTR             LOAD R1 TO CONTAIN THE ADDRESS
*                                    OF IKJCT44B'S DYNAMIC WORK AREA
*
         FREEMAIN RU,LV=LWORKA,A=(1),SP=1
*                                    ISSUE FREEMAIN TO RELEASE
*                                    IKJCT44B'S DYNAMIC WORK AREA
*                                    STORAGE BACK TO THE SYSTEM
*
         LR    R1,R13                LOAD R1 TO CONTAIN THE ADDRESS
*                                    OF IKJCT44B'S DYNAMIC SAVE AREA
*
         L     R13,4(,R13)           LOAD R13 TO CONTAIN THE ADDRESS
*                                    OF THE INVOKER'S SAVE AREA THAT
*                                    WAS PASSED TO IKJCT44B ON ENTRY
*
         FREEMAIN RU,LV=SAVAREAL,A=(1)
*                                    ISSUE FREEMAIN TO RELEASE
*                                    IKJCT44B'S DYNAMIC SAVE AREA
*                                    STORAGE BACK TO THE SYSTEM
*
         L     R14,12(,R13)          LOAD R14 WITH THE ADDRESS OF THE
*                                    NEXT INSTRUCTION THAT THE INVOKER
*                                    WOULD HAVE EXECUTED IF IKJCT44B
*                                    HAD NOT BEEN INVOKED
*
         LR    R15,R5                LOAD R15 TO CONTAIN THE RETURN
*                                    CODE IKJCT44B WILL PRESENT BACK
*                                    TO THE INVOKER.
*
         LM    R0,R12,20(R13)        RESTORE THE INVOKER'S REGISTERS
*                                    BEFORE IKJCT44B RETURNS TO
*                                    THE INVOKER
*
         BSM   0,14                  RETURN TO THE INVOKER OF IKJCT44B
*                                    AND RESET THE CALLER'S EXECUTION
*                                    AND ADDRESSING MODE AS INVOKER
*                                    CONTROL IS RESTORED
*
         TITLE 'PROCESS_EXIT_PARAMETERS SUBROUTINE'
***********************************************************************
*                                                                     *
* PROCESS_EXIT_PARAMETERS                                             *
*                                                                     *
* DESCRIPTIVE NAME - PROCESS INSTALLATION EXIT PARAMETERS             *
*                                                                     *
* FUNCTION -  PROCESSING EXIT PARAMETER 10 TO DETERMINE IF            *
*             THIS IS A SUPPORTED BUILT-IN FUNCTION.                  *
*                                                                     *
* OPERATION -                                                         *
*                                                                     *
*    1).  SAVES ALL OF THE CALLER'S REGISTERS IN A LOCAL SAVE AREA    *
*         SO THAT ANY REGISTER CAN BE EASILY USED.                    *
*    2).  GET THE ADDRESS OF PARAMETER ENTRY 10.                      *
*    3).  CALLS PROCESS_PARAMETER_ENTRY                               *
*    4).  RELOADS THE CALLER'S REGISTERS                              *
*    5).  RETURNS TO CALLER                                           *
*                                                                     *
***********************************************************************
         SPACE 3
PROCESS_EXIT_PARAMETERS DS 0H
         STM   R0,R15,SAVAREA1       SAVE ALL REGISTERS THE CALLER
*                                    OF THIS SUBROUTINE PRESENTED
*                                    SO THAT ANY REGISTER
*                                    CAN EASILY BE USED
*
         L     R1,EPLISTPT           GET THE ADDRESS OF THE PARAMETER
*                                    LIST THAT THE INVOKER PASSED INTO
*                                    IKJCT44B
*
         LA    R2,36(,R1)            ADD THE DISPLACEMENT OF
*                                    PARAMETER 10 TO PROCESS THE
*                                    PARAMETER LIST ADDRESS
*
         L     R2,0(,R2)             LOAD R1 TO POINT DIRECTLY TO
*                                    THE NAME PARAMETER
*
         ST    R2,PARMPNT1           SAVE THE ADDRESS OF WHERE THE NAME
*                                    PARAMETER IS AT FOR LATER USE
*
         LA    R2,44(,R1)            ADD THE DISPLACEMENT OF
*                                    PARAMETER 10 TO PROCESS THE
*                                    PARAMETER LIST ADDRESS
*
         L     R2,0(,R2)             LOAD R1 TO POINT DIRECTLY TO
*                                    THE NAME PARAMETER
*
         ST    R2,PARMPNT2           SAVE THE ADDRESS OF WHERE THE NAME
*                                    PARAMETER IS AT FOR LATER USE
*
         BAL   R14,PROCESS_PARAMETER_ENTRY CALL THE SUBROUTINE
*                                    PROCESS_PARAMETER_ENTRY TO
*                                    DETERMINE IF THIS PARAMETER IS A
*                                    VALID BCS-WRITTEN CLIST VARIABLE
*
         LM    R0,R15,SAVAREA1       RESTORE ALL OF THE CALLER'S
*                                    REGISTERS TO THEIR ORIGINAL
*                                    VALUE
*
         BR    R14                   RETURN TO CALLER
         TITLE 'PROCESS_PARAMETER_ENTRY SUBROUTINE'
***********************************************************************
*                                                                     *
* PROCESS_PARAMETER_ENTRY                                             *
*                                                                     *
* DESCRIPTIVE NAME - PROCESS THE PARAMETER ENTRY THAT IS POINTED      *
*                    TO FROM THE PARAMETER LIST.                      *
*                                                                     *
* FUNCTION -  SUBROUTINE DRIVER                                       *
*                                                                     *
* OPERATION -                                                         *
*                                                                     *
*    1). SAVES ALL OF THE CALLER'S REGISTERS IN A LOCAL SAVE AREA     *
*    6). RELOADS THE CALLER'S REGISTERS                               *
*    7). RETURNS TO CALLER                                            *
*                                                                     *
***********************************************************************
         SPACE 3
PROCESS_PARAMETER_ENTRY DS 0H
         STM   R0,R15,SAVAREA2       SAVE ALL REGISTERS THE CALLER
*                                    OF THIS SUBROUTINE PRESENTED
*                                    SO THAT ANY REGISTER
*                                    CAN EASILY BE USED
*
         L     R8,PARMPNT1           LOAD R8 TO CONTAIN THE ADDRESS OF
*                                    THE PARAMETER ENTRY
*
         USING PARAMENT,R8           ESTABLISH ADDRESSABILITY TO
*                                    THE PARAMETER ENTRY DSECT SO
*                                    IKJCT44B CAN REFERENCE THE LABELS
*                                    WITHIN THE PARAMETER ENTRY DSECT
*
         L     R3,PARAMLEN           LOAD R3 TO CONTAIN THE LENGTH OF
*                                    THE VARIABLE NAME
*
         L     R4,PARAMDAT           LOAD R4 TO CONTAIN THE ADDRESS OF
*                                    THE VARIABLE NAME
*
         LA    R5,VARTABLE           LOAD R5 TO CONTAIN THE ADDRESS OF
*                                    THE VARIABLE TABLE
*
         LA    R7,VARTABEN           LOAD R7 TO CONTAIN THE ADDRESS
*                                    AFTER THE LAST TABLE ENTRY
*
         USING VARDSECT,R5           ESTABLISH ADDRESSABILITY TO
*                                    THE VARIABLE TABLE
*
LOOPIT   DS    0H                    CONTINUE CHECKING
*
         CH    R3,VARLEN             IS THE LENGTH CORRECT?
*
         BLR   R14                   NOT IN THE TABLE
         BNE   BUMPIT                TRY ANOTHER TIME
*
         LR    R6,R3                 PREPARE FOR COMPARE
*
         BCTR  R6,0                  DECREMENT LENGTH
*
         EX    R6,NAMECOMP           AND CHECK THE NAME
*
         BLR   R14                   NOT IN THE TABLE
         BNE   BUMPIT                NOT THE CORRECT NAME
*
         XC    RETCODE,RETCODE       ASSUME SUCCESSFUL EVALUATION
*
         L     R15,VARADDR           ADDRESS OF THE EVALUATOR
*
         L     R8,PARMPNT2           LOAD R8 TO CONTAIN THE ADDRESS OF
*                                    THE RESULT ENTRY
*
         BR    R15                   AND EVALUATE THE VARIABLE
*
BUMPIT   DS    0H                    CHECK FOR MORE
*
         LA    R5,VARTABLN(,R5)      BUMP THE ADDRESS
*
         CR    R5,R7                 STILL IN THE TABLE
*
         BL    LOOPIT                YES
*
         BR    R14                   RETURN TO CALLER
         TITLE 'EVALUATE SYSXLU - LU NAME'
***********************************************************************
*                                                                     *
* SYSXLU FUNCTION                                                     *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTINE WILL RETURN THE TERMINAL ID (AS DEFINED           *
*      TO RACF)                                                       *
*                                                                     *
* INPUT:                                                              *
*      ACEE                                                           *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
         PUSH  USING
SYSXLU   DS    0H
         STM   R14,R12,12(R13)
         L     R3,ASCBPTR              ASCB ADDRESS
         USING ASCB,R3                 ASCB ADDRESS
         L     R3,ASCBASXB             ASXB ADDRESS
         DROP  R3                      ASCB ADDRESS
         L     R5,PARMPNT2             THE ADDRESS FOR THE RESULT
         USING PARAMENT,R5             ESTABLISH ADDRESSABILITY TO
         L     R15,PARAMDAT            THE ADDRESS FOR THE RESULT
         MVI   RESULT(R15),C' '        BLANK
         SR    R4,R4                   ZERO
         USING ASXB,R3                 ASXB ADDRESS
         ICM   R3,15,ASXBSENV          ACEE ADDRESS
         DROP  R3                      ASXB ADDRESS
         BZ    ENDSYSLU                NONE
         USING ACEE,R3
         CLI   ACEETRID,C' '           TERMINAL ID ?
         BNH   ENDSYSLU                NONE
         MVC   RESULT(8,R15),ACEETRID  TERMINAL ID
         LA    R4,8
         LA    R3,RESULT+7             INIT
SYSLULOP CLI   0(R3),C' '              BLANK
         BNE   ENDSYSLU                NO
         BCTR  R3,0                    DECREMENT
         BCT   R4,SYSLULOP             AGAIN
         SR    R4,R4                   NOTHING
ENDSYSLU ST    R4,PARAMLEN             SET LENGTH OF COUNT
         POP   USING
         LM    R14,R12,12(R13)
         BR    R14                     RETURN TO CALLER
         TITLE 'EVALUATE SYSXMVS - INSTALLED MVS LEVEL'
***********************************************************************
*                                                                     *
* SYSXMVS FUNCTION                                                    *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTIME RETURNS THE MVS RELEASE NUMBER                    *
*                                                                     *
* INPUT:                                                              *
*      CVT                                                            *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
         SPACE 3
SYSXMVS  DS    0D
         PUSH  USING
         STM   R14,R12,12(R13)
         L     R6,FLCCVT               10
         L     R15,PARAMDAT
         USING RELEASE,R15             ESTABLISH ADDRESSABILITY TO
         MVC   RELEASE,RELEASEC
*        MVC   RELNAME,=C'OS/VS1'
         TM    CVTDCB(R6),CVT4MS1       Q. VS1
         BZ    NOTXA                    YES.
         MVI   RELNAME+5,C'2'           NO. VS2
         TM    CVTDCB(R6),CVTMVSE+CVTOSEXT Q. MVS/ESA
         BNO   NOTESA                   NO.
         MVC   RELNAME(8),=C'MVS/ESA '  YES.
         SH    R6,H256                  CVT PREFIX
         MVC   RELSYSL+1,XCVTSYSL(R6)   MOVE SYSTEM ID
         LA    R4,24
         CLI   XCVTUSRL(R6),C' '        IS USER SYS ID PRESENT
         BE    TRTIT                     NO
         LA    R4,42
         MVC   RELUSRL+1,XCVTUSRL(R6)   MOVE USER SYS ID
         B     TRTIT                     NO
NOTESA   EQU   *
         TM    CVTDCB(R6),CVTMVSE       Q. MVS/XA
         BZ    NOTXA                    NO.
         MVC   RELNAME,=C'MVS/XA'       YES.
NOTXA    EQU   *
         SH    R6,H256                 CVT PREFIX
         MVC   RELSYSL,XCVTSYSL(R6)    MOVE SYSTEM ID
         LA    R4,23
         CLI   XCVTUSRL(R6),C' '       IS USER SYS ID PRESENT
         BE    TRTIT                     NO
         LA    R4,41
         MVC   RELUSRL,XCVTUSRL(R6)    MOVE USER SYS ID
TRTIT    TR    RELUSRL(35),MNTTRTAB    REMOVE UNPRINTABLES
         POP   USING
         ST    R4,PARAMLEN             SET LENGTH OF COUNT
         LM    R14,R12,12(R13)
         BR    R14                     RETURN TO CALLER
         TITLE 'EVALUATE SYSXDFP - INSTALLED DFP LEVEL'
***********************************************************************
*                                                                     *
* SYSXDFP FUNCTION                                                    *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTIME RETURNS THE DFP RELEASE NUMBER                    *
*                                                                     *
* INPUT:                                                              *
*      CVT                                                            *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
         SPACE 3
SYSXDFP  DS    0D
         PUSH  USING
         STM   R14,R12,12(R13)
         LA    R4,0                    LENGTH OF ZERO
         L     R6,FLCCVT               10
         L     R15,PARAMDAT
         USING DFPAREA,R15             ESTABLISH ADDRESSABILITY
         L     R2,CVTABEND(,R6)        SECONDARY CVT
         CLI   132(R2),X'00'           KNOWN DFP RELEASE
         BE    NODFP                    NO
         L     R2,CVTDFA(,R6)          DFP ID TABLE ADDRESS
         MVC   DFPAREA,=X'21F02020'    MASK
         ED    DFPAREA,2(R2)           RELEASE LEVEL
         LA    R4,4                    LENGTH
         POP   USING
NODFP    ST    R4,PARAMLEN             SET LENGTH OF COUNT
         LM    R14,R12,12(R13)
         BR    R14                     RETURN TO CALLER
         TITLE 'EVALUATE SYSXRES - MVS SYSTEM RESIDENCE VOLUME'
***********************************************************************
*                                                                     *
* SYSXRES FUNCTION                                                    *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTINE WILL RETURN THE VOLUME SERIAL NUMBER              *
*      OF THE SYSRES VOLUME.                                          *
*                                                                     *
* INPUT:                                                              *
*      CVT                                                            *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
         SPACE 3
SYSXRES  DS    0D
         STM   R14,R12,12(R13)
         L     R6,FLCCVT               10
         L     R6,CVTSYSAD(,R6)        30
         L     R15,PARAMDAT
         MVC   RESULT(6,R15),UCBVOLI(R6) MOVE SYSRES VOLSER
         LA    R4,6
         ST    R4,PARAMLEN             SET LENGTH OF COUNT
         LM    R14,R12,12(R13)
         BR    R14                     RETURN TO CALLER
         TITLE 'EVALUATE SYSXSERIAL - CPU SERIAL NUMBER'
***********************************************************************
*                                                                     *
* SYSXSERIAL FUNCTION                                                 *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTINE WILL RETURN THE CPU SERIAL NUMBER.                *
*                                                                     *
* INPUT:                                                              *
*      PCCA                                                           *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
SYSXSER  DS    0H
         STM   R14,R12,12(R13)
         L     R3,PSAPCCAV
         L     R15,PARAMDAT
         MVC   RESULT(6,R15),PCCACPSE(R3) SERIAL NUMBER
         LA    R4,6
         ST    R4,PARAMLEN             SET LENGTH OF COUNT
         LM    R14,R12,12(R13)
         BR    R14                     RETURN TO CALLER
         TITLE 'EVALUATE SYSXSMFID - SMF ID'
***********************************************************************
*                                                                     *
* SYSXSMFID FUNCTION                                                  *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTINE WILL RETURN THE SMF ID OF THE SYSTEM.             *
*                                                                     *
* INPUT:                                                              *
*      SMCA                                                           *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
SYSXSMF  DS    0H
         STM   R14,R12,12(R13)
         L     R6,FLCCVT                10
         L     R1,CVTSMCA(,R6)          C4
         L     R15,PARAMDAT
         MVC   RESULT(4,R15),SMCASID(R1) MOVE SMF-ID
         LA    R4,4
         ST    R4,PARAMLEN             SET LENGTH OF COUNT
         LM    R14,R12,12(R13)
         BR    R14                     RETURN TO CALLER
         TITLE 'EVALUATE SYSXIPLAT - IPL DATE AND TIME'
***********************************************************************
*                                                                     *
* SYSXIPLAT FUNCTION                                                  *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTINE WILL RETURN THE TIME AND DATE OF THE LAST         *
*      IPL OF THE SYSTEM.                                             *
*      FORM: 19YY.DDD HH:MM:SS                                        *
*                                                                     *
* INPUT:                                                              *
*      SMCA                                                           *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
SYSXIPL  DS    0H
         STM   R14,R12,12(R13)
         L     R6,FLCCVT                10
         L     R7,CVTSMCA(,R6)          C4
         L     R15,PARAMDAT
         USING WORKARE2,R15
         MVC   TBIPL,IPLMASK
         MVC   TBIPLDTE,DATEMASK
         ED    TBIPLDTE,SMCAIDTE+1(R7)
         MVC   TBIPL(2),IPLMASK        19XX
         CLI   TBIPL+2,C'7'            YEAR '70
         BNL   *+10                     NO
         MVC   TBIPL(2),IPLMASK+2      20XX
         L     R1,SMCAITME(,R7)         IPL TIME
         SR    R0,R0
         D     R0,SECONDS
         CVD   R1,DWORK
         UNPK  TBIPLTME(2),DWORK
         OI    TBIPLTME+1,C'0'
         SRDL  R0,32
         D     R0,MINUTES
         CVD   R1,DWORK
         UNPK  TBIPLTME+3(2),DWORK
         OI    TBIPLTME+4,C'0'
         SRDL  R0,32
         D     R0,HOURS
         CVD   R1,DWORK
         UNPK  TBIPLTME+6(2),DWORK
         OI    TBIPLTME+7,C'0'
         LA    R4,L'TBIPL
         DROP  R15
         ST    R4,PARAMLEN             SET LENGTH OF DATA
         LM    R14,R12,12(R13)
         BR    R14                     RETURN TO CALLER
         TITLE 'EVALUATE SYSXACCT - ACCOUNT NUMBER'
***********************************************************************
*                                                                     *
* SYSXACCT FUNCTION                                                   *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTINE WILL RETURN THE LOGON ACCOUNT NUMBER.             *
*                                                                     *
* INPUT:                                                              *
*      JCT                                                            *
*      ACT                                                            *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
         PUSH  USING
SYSXACCT DS    0H
         STM   R14,R12,12(R13)
         L     R3,TCBPTR                R3--> CURRENT TCB
         USING TCB,R3
         L     R3,TCBJSCB               JSCB
         USING IEZJSCB,R3
         L     R3,JSCBJCT               OS JCT (NOT JES2)
         USING JCT-X'10',R3
         ICM   R3,7,JCTACTAD            ACT
         USING ACTDSKAD-X'10',R3
         SLR   R5,R5                    CLEAR
         SLR   R4,R4                    CLEAR FIELD LENGTH
         ST    R4,PARAMLEN              INIT LENGTH OF COUNT
         ICM   R5,1,ACTJNFLD            # OF ACCOUNTING FIELDS
         BZ    NOACCT                    NONE, TREAT AS ZERO LENGTH
         LA    R3,ACTJNFLD+L'ACTJNFLD   POINT TO FIRST FIELD
         DROP  R3                       DONE WITH ACT B/R
         IC    R4,0(R3)                 L' FIRST FIELD
         LA    R3,1(R3,R4)              BUMP TO SECOND FIELD
         BCT   R5,GET#2                 CHECK FOR LAST
         B     NOACCT                   LAST, TREAT AS ZERO LENGTH
GET#2    ICM   R4,1,0(R3)               GET LENGTH
         BZ    NOACCT                   ZERO, BAIL OUT
         LA    R3,1(,R3)                BUMP PAST LENGTH BYTE
*
MOVEACCT L     R1,PARAMDAT              TARGET
         ST    R4,PARAMLEN              SET LENGTH OF COUNT
         BCTR  R4,0                     ADJUST COUNT
         EX    R4,RSM0ACCT              AND MOVE ACCT NO
NOACCT   LM    R14,R12,12(R13)
         BR    R14                      RETURN TO CALLER
RSM0ACCT MVC   RESULT(0,R1),0(R3)
         POP   USING
         TITLE 'EVALUATE SYSXCPUH - CPU TIME IN HUNDRETHS'
***********************************************************************
*                                                                     *
* SYSXCPUH BUILT IN FUNCTION                                          *
*                                                                     *
* FUNCTION:                                                           *
*       THIS ROUTINE WILL RETURN THE AMOUNT OF CPU TIME USED          *
*       DURING THE TSO SESSION:                                       *
*         SYSXCPUH RETURNS SSSTH                                      *
*                                                                     *
* INPUT:                                                              *
*      ASCB - ASCBEJST                                                *
*                                                                     *
* OUTPUT:                                                             *
*      INSRTDA SET                                                    *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
SYSXCPUH DS    0H
         STM   R14,R12,12(R13)                                     0159
*   LM(R2,R3,ASCBEJST);             /* GET CPU TIME FROM ASCB         *
         L     R7,ASCBPTR                                          0162
         USING ASCB,R7                 ASCB ADDRESS
         LM    R2,R3,ASCBEJST                                      0162
         DROP  R7                      ASCB ADDRESS
*   SRDL(R2,22);                    /* SHIFT TO GET MICRO SEC         *
         SRDL  R2,22                                               0163
*   R6 = R3;                        /* SAVE RESULT                    *
         LR    R6,R3                                               0164
*   RESPECIFY                                                      0165
*    (R2,                                                          0165
*     R3) UNRSTD;                   /*                                *
*   R6 = R6 / F10;                  /* ADJUST TO .00 SEC              *
         LR    R2,R6                                               0166
         SRDA  R2,32                                               0166
         LA    R7,10                                               0166
         DR    R2,R7                                               0166
         LR    R6,R3                                               0166
*   CVD(R6,WORKAREA);               /* CONVERT RESULT                 *
         CVD   R6,WORKAREA                                         0167
*   CPUAREA = CPUMASK;              /* MOVE IN EDIT MSK XXXXX         *
         L     R15,PARAMDAT
         USING WORKARE2,R15
         MVC   CPUAREA(8),CPUHMASK
*   R1 = ADDR(CPUPREC);             /* SET UP REG FOR PRECISION       *
         LA    R1,CPUPREC
         LR    R2,R1
*   EDMK(CPUAREA,WORK2);            /* EDIT CPU TIME                  *
         EDMK  CPUAREA(8),WORK2
*   /*                                                                *
*   /* LENGTH MUST BE SET FIRST BECAUSE THE LENGTH CALCULATION        *
*   /* REQUIRES THE ORIGINAL 'RESULT' ADDRESS                         *
*   /*                                                                *
*   VARLEN = ADDR(CPUAREA(LENGTH(CPUAREA))) - R1 + F1; /* LENGTH IS
*                                      THE LAST BYTE OF THE RESULT
*                                      MINUS THE ADDR OF THE DATA
*                                      PLUS 1                         *
         DROP  R15
         SLR   R2,R1                                               0172
         LA    R2,1(,R2)                                           0172
         ST    R2,PARAMLEN                                         0172
         EX    R2,RESUTALN                                         0172
         LM    R14,R12,12(R13)                                     0175
         BR    R14                   RETURN TO CALLER
         TITLE 'EVALUATE SYSXCPUTYPE - CPU TYPE'
***********************************************************************
*                                                                     *
* SYSXCPUTYPE FUNCTION                                                *
*                                                                     *
* FUNCTION:                                                           *
*      THIS ROUTINE WILL RETURN THE CPU TYPE.                         *
*                                                                     *
* INPUT:                                                              *
*      PCCA                                                           *
*                                                                     *
* OUTPUT:                                                             *
*      RESULT SET                                                     *
*      VARLEN SET TO LENGTH                                           *
*                                                                     *
***********************************************************************
SYSXCPUT STM   R14,R12,12(R13)
         L     R3,PSAPCCAV
         L     R15,PARAMDAT
         MVC   RESULT(4,R15),PCCACPTY(R3) CPU TYPE
         LA    R4,4
         ST    R4,PARAMLEN              SET LENGTH OF COUNT
         LM    R14,R12,12(R13)
         BR    R14                   RETURN TO CALLER
         TITLE 'EXECUTED INSTRUCTIONS'
***********************************************************************
*                                                                     *
* EXECUTED INSTRUCTIONS.                                              *
*                                                                     *
***********************************************************************
         SPACE 3
NAMECOMP CLC   0(0,R4),VARNAME       IS THIS THE NAME
RESUTALN MVC   0(0,R15),0(R1)        ALIGN THE RESULT
*
         DROP  R8                    NO LONGER USE PARAMETER ENTRY
*                                    DSECT DESCRIPTION
*
         DROP  R5                    NO LONGER USE VARIABLE TABLE
*                                    DSECT DESCRIPTION
         TITLE 'STATIC VARIABLES'
***********************************************************************
*                                                                     *
* DECLARES OF ALL CONSTANTS USED BY THIS MODULE FOLLOW                *
*                                                                     *
***********************************************************************
         SPACE 3
SECONDS  DC    A(60*60*100)
MINUTES  DC    A(60*100)
HOURS    DC    A(100)
H256     DC    H'256'
WKARIDCT DC    C'WORKAREA'
CPUHMASK DC    X'4020202020202120'
DATEMASK DC    X'F020204B202020'
IPLMASK  DC    C'1920.DDD HH:MM:SS'
RELEASEC DC    CL41'OS/VS1 '
         DS    0D
MNTTRTAB DC    256C' '
         ORG   MNTTRTAB+C''
         DC    7AL1(*-MNTTRTAB)        .<(+|&
         ORG   MNTTRTAB+C'!'
         DC    8AL1(*-MNTTRTAB)        !$*);-/
         ORG   MNTTRTAB+C'|'
         DC    5AL1(*-MNTTRTAB)        ,%_>?
         ORG   MNTTRTAB+C':'
         DC    6AL1(*-MNTTRTAB)        :#@'="
         ORG   MNTTRTAB+C'a'
         DC    9AL1(*-MNTTRTAB)        abcdefghi
         ORG   MNTTRTAB+C'j'
         DC    9AL1(*-MNTTRTAB)        jklmnopqr
         ORG   MNTTRTAB+C's'
         DC    8AL1(*-MNTTRTAB)        stuvwxyz
         ORG   MNTTRTAB+C'A'
         DC    9AL1(*-MNTTRTAB)        ABCDEFGHI
         ORG   MNTTRTAB+C'J'
         DC    9AL1(*-MNTTRTAB)        JKLMNOPQR
         ORG   MNTTRTAB+C'S'
         DC    8AL1(*-MNTTRTAB)        STUVWXYZ
         ORG   MNTTRTAB+C'0'
         DC    10AL1(*-MNTTRTAB)       0123456789
         TITLE 'FUNCTION VARIABLES'
***********************************************************************
*                                                                     *
* TABLE OF THE SUPPORTED VARIABLES                                    *
*                                                                     *
* THIS TABLE IS ARRANGED IN LENGTH ORDER AND SORTED ALPHABETICALLY    *
* WITHIN THE SAME LENGTH.                                             *
*                                                                     *
***********************************************************************
         SPACE 3
         DS    0D                    DOUBLE WORD ALIGNMENT
         SPACE 1
VARTABLE DC    Y(L'NLU)
NLU      DC    C'SYSXLU'
         ORG   NLU+14
         DC    A(SYSXLU)
         SPACE 1
         DC    Y(L'NDFP)
NDFP     DC    C'SYSXDFP'
         ORG   NDFP+14
         DC    A(SYSXDFP)
         SPACE 1
         DC    Y(L'NMVS)
NMVS     DC    C'SYSXMVS'
         ORG   NMVS+14
         DC    A(SYSXMVS)
         SPACE 1
         DC    Y(L'NRES)
NRES     DC    C'SYSXRES'
         ORG   NRES+14
         DC    A(SYSXRES)
         SPACE 1
         DC    Y(L'NACCT)
NACCT    DC    C'SYSXACCT'
         ORG   NACCT+14
         DC    A(SYSXACCT)
         SPACE 1
         DC    Y(L'NCPUH)
NCPUH    DC    C'SYSXCPUH'
         ORG   NCPUH+14
         DC    A(SYSXCPUH)
         SPACE 1
         DC    Y(L'SIPL)
SIPL     DC    C'SYSXIPLAT'
         ORG   SIPL+14
         DC    A(SYSXIPL)
         SPACE 1
         DC    Y(L'NSMF)
NSMF     DC    C'SYSXSMFID'
         ORG   NSMF+14
         DC    A(SYSXSMF)
         SPACE 1
         DC    Y(L'NSER)
NSER     DC    C'SYSXSERIAL'
         ORG   NSER+14
         DC    A(SYSXSER)
         SPACE 1
         DC    Y(L'NCPUTY)
NCPUTY   DC    C'SYSXCPUTYPE'
         ORG   NCPUTY+14
         DC    A(SYSXCPUT)
         SPACE 1
VARTABEN EQU   *
         SPACE 2
VARDSECT DSECT
VARLEN   DS    Y
VARNAME  DS    CL14
         ORG   VARNAME+14
VARADDR  DS    A
VARTABLN EQU   *-VARLEN
IKJCT44B CSECT ,
         TITLE 'DYNAMIC SAVE AREA'
***********************************************************************
*
* IKJCT44B'S DYNAMIC SAVE AREA                                        *
*
***********************************************************************
*
         SPACE 3
SAVEAREA DSECT
SAVAREA0 DS    0CL72                 STANDARD SAVE AREA
         DS    F                     UNUSED
B_PTR    DS    F                     BACKWARD SAVE AREA POINTER
F_PTR    DS    F                     FORWARD SAVE AREA POINTER
REG14    DS    F                     CONTENTS OF REGISTER 14
REG15    DS    F                     CONTENTS OF REGISTER 15
REG0     DS    F                     CONTENTS OF REGISTER 0
REG1     DS    F                     CONTENTS OF REGISTER 1
REG2     DS    F                     CONTENTS OF REGISTER 2
REG3     DS    F                     CONTENTS OF REGISTER 3
REG4     DS    F                     CONTENTS OF REGISTER 4
REG5     DS    F                     CONTENTS OF REGISTER 5
REG6     DS    F                     CONTENTS OF REGISTER 6
REG7     DS    F                     CONTENTS OF REGISTER 7
REG8     DS    F                     CONTENTS OF REGISTER 8
REG9     DS    F                     CONTENTS OF REGISTER 9
REG10    DS    F                     CONTENTS OF REGISTER 10
REG11    DS    F                     CONTENTS OF REGISTER 11
REG12    DS    F                     CONTENTS OF REGISTER 12
SAVAREAL EQU   *-SAVEAREA
         TITLE 'DYNAMIC WORK AREA'
***********************************************************************
* DECLARES OF ALL DYNAMIC VARIABLES USED BY THIS MODULE FOLLOW        *
***********************************************************************
*
         SPACE 3
WORKA    DSECT
WRKAREID DS    CL8                   WORKAREA ID
SAVAREA1 DS    18F                   SAVE AREA 1
SAVAREA2 DS    18F                   SAVE AREA 2
         SPACE 1
GM_PTR   DS    F                     ADDRESS OF GETMAIN
PARMPNT1 DS    F                     ADDRESS OF THE PARAMETER ENTRY
PARMPNT2 DS    F                     ADDRESS OF THE PARAMETER ENTRY
EPLISTPT DS    F                     ADDRESS OF THE PARAMETER LIST
*                                    THAT WAS PASSED INTO IKJCT44B
         SPACE 1
RETCODE  DS    F                     THE RETURN CODE HOLDER
         DS    0D
DWORK    DS    0D
WORKAREA DS    CL16                  WORK AREA FOR HEXCONV
         ORG   WORKAREA
WORK1    DS    CL4
WORK2    DS    CL4
         ORG   ,
         DS    0D                    ALIGN ON A DOUBLE WORD
LWORKA   EQU   *-WORKA               LENGTH OF THIS WORK AREA
         TITLE 'PARAMETER ENTRY DSECT MAPPING'
PARAMENT DSECT                       DESCRIBE THE PARAMETER ENTRY
         DS    0F                    ALIGN ON A FULL WORD
PARAMKEY DS    F                      THE KEY FIELD
PARAMLEN DS    F                      THE LENGTH OF THE DATA
PARAMDAT DS    A                      THE PTR TO DATA
WORKARE2 DSECT
RESULT   EQU   0,256,C'C'
         SPACE 1
         ORG   WORKARE2
CPUAREA  DS    CL8
         ORG   CPUAREA+7
CPUPREC  DS    C
         SPACE 1
         ORG   WORKARE2
DFPAREA  DS    CL4
         SPACE 1
         ORG   WORKARE2
RELEASE  DS    0CL41
RELNAME  DC    C'OS/VS1'
         DC    C' '
RELSYSL  DC    CL16' '
         DC    C'  '
RELUSRL  DC    CL16' '
         DC    C'  '
         SPACE 1
         ORG   WORKARE2
TBIPL    DS    0C'19YY.DDD,HH:MM:SS',C
TBIPLDTE DS    C' YY.DDD',C','
TBIPLTME DS    C'HH:MM:SS',C
         SPACE 1
         ORG   ,
         TITLE 'VARIOUS DSECTS'
IKJCT44B CSECT
         LTORG
         PRINT NOGEN
         IHAACEE ,
         IHAASCB ,
         IHAASXB ,
         IEZJSCB ,
         IHAPSA ,
ASCBPTR  EQU   PSAAOLD,4,C'A'
TCBPTR   EQU   PSATNEW,4,C'A'
SMCA     EQU   0,352,C'C'
SMCASID  EQU   SMCA+16,4,C'A'          SYSTEM IDENTIFICATION
SMCAITME EQU   SMCA+336,4,C'A'         IPL TIME (BINARY)
SMCAIDTE EQU   SMCA+340,4,C'A'         IPL DATE (YYDDDF)
CVTFIX   EQU   0,256,C'C'
CVTMAP   EQU   0,1264,C'C'
CVTSYSAD EQU   CVTMAP+48,4,C'A'
CVTDCB   EQU   CVTMAP+116,1,C'B'
CVTMVSE  EQU   B'10000000'             S/370/XA
CVT4MS1  EQU   B'00010000'             MVT OS/VS2
CVTOSEXT EQU   B'00001000'             CVTOSLVL IS PRESENT
CVT6DAT  EQU   B'00000010'             DAT OS/VS1 OS/VS2
CVT8AOS2 EQU   B'00010010'             MVS OS/VS2
CVTTVT   EQU   CVTMAP+156,4,C'A'
CVTSMCA  EQU   CVTMAP+196,4,C'C'
CVTABEND EQU   CVTMAP+200,4,C'A'       ADDR OF SCVT FOR ABEND
XCVTSYSL EQU   CVTFIX+216,16,C'C'
XCVTUSRL EQU   CVTFIX+232,16,C'C'
CVTHSM   EQU   CVTMAP+988,4,C'A'
CVTRAC   EQU   CVTMAP+992,4,C'A'
CVTDFA   EQU   CVTMAP+1216,4,C'A'      DFP ID TABLE ADDR
UCBOB    EQU   0,32,C'C'
UCBVOLI  EQU   UCBOB+28,6,C'C'
PCCA     EQU   0,584,C'C'
PCCACPID EQU   PCCA+4,12,C'C'           CPU ID
PCCACPSE EQU   PCCA+6,6,C'C'            CPU SERIAL
PCCACPTY EQU   PCCA+12,4,C'C'           CPU TYPE
JCT      DSECT
         IEFAJCTB ,                 MVS JOB CONTROL TABLE
         IKJTCB ,
IKJCT44B CSECT
         DS    0D
         END   IKJCT44B
