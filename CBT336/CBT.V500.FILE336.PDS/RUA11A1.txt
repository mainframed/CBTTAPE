++USERMOD (RUA11A1) /* SMF TYPE 32 RECORD IMPROVEMENTS */.
++VER (Z038) FMID(JBB1126) REQ(RUA11B1,RUA11C1) /*
  THIS USER MOD IMPLEMENTS SEVERAL IMPROVEMENTS IN TSO
  FUNCTIONAL ACCOUNTING.  IT ALLOWS ALL COMMANDS AND
  SUBCOMMANDS TO BE RECORDED WITHOUT HAVING TO BE INCLUDED IN
  THE IEEMB846 LIST, AND RECORDS (IN PLACE OF SRB TIME, TPUTS
  AND TGETS) THE TOTAL ELAPSED TIME, AS WELL AS THE NUMBER OF
  COMMANDS WHICH ISSUED NO TGETS, PLUS THE ELAPSED TIME
  FOR THESE. THIS PROVIDES MORE ACCURATE RESPONSE-TIME
  STATISTICS THAN AVAILABLE FROM OTHER SOURCES IN THE
  SYSTEM (E.G., CMF). */.
++ZAP (IGX00025).
 NAME IGX00025
*                            ORG   SRBTIME       COMPUTE ELAPSED TIME INSTEAD
VER 0100 D207,80EC,20C8      MVC   SRBT(8,8),X'C8'(2)
*                            ORG   SRBDONE       END OF SRB CALCULATION
VER 014E 4110,8100           LA    1,X'100'(,8)
*                            ORG   FIRSTEST      CHECK FOR FIRST CALL
VER 0226 9120,700A           TM    NOTFIRST(7),B'00100000'
VER 022A 4770,9230           BNZ   @RF00146
*                            ORG   TPUTACCM      TPUT/TGET ACCUMULATION
VER 040A 5810,5018           L     1,SMF32TPT(,5)
VER 040E 5E10,2010           AL    1,SIGTPUT(,2)
VER 0412 5010,5018           ST    1,SMF32TPT(,5)
VER 0416 5840,5014           L     4,SMF32TGT(,5)
VER 041A 5E40,2014           AL    4,SIGTGET(,2)
VER 041E 5040,5014           ST    4,SMF32TGT(,5)
*                   ENDTPUT  EQU   *
*                            ORG   NOTFOUND
*
VER 04EA 4770,94CA           BNE   @RF00241      IF CMD NAME NOT MATCHED
VER 04EE 4130,0001           LA    3,1           SET FOUND FLAG
*                            ORG   PATCH
VER 0570 0000,0000,0000,0000 DC    (X'38')X'00'
VER 0578 0000,0000,0000,0000
VER 0580 0000,0000,0000,0000
VER 0588 0000,0000,0000,0000
VER 0590 0000,0000,0000,0000
VER 0598 0000,0000,0000,0000
VER 05A0 0000,0000,0000,0000
*                            ORG   SRBTIME       REPLACE SRB WITH TOD
REP 0100 B205,80EC           STCK  SRBT(8)       STORE THE TOD
REP 0104 D203,80EC,80ED      MVC   SRBT(4,8),SRBT+1(8) STORE IN 4.096 SEC/1000S
REP 010A D203,80F0,80EC      MVC   SRBT+4(4,8),SRBT(8) IN SRB TIME SLOT
REP 0110 47F0,9124           B     SRBDONE
*                            ORG   FIRSTEST+4
REP 022A 4700,9230           NOP   @RF00146
*                            ORG   TPUTACCM
REP 040A 47F0,9558           B     PACHACCM
*                            ORG   NOTFOUND
REP 04EA 47F0,9546           B     STEAL
*                            ORG   PATCH
*                   STEAL    EQU   *
REP 0570 95F0,2000           CLI   0(2),C'0'     IS THIS TABLE ENTRY A DUMMY?
*                            (COMMAND NAME STARTING '0')
REP 0574 4770,94CA           BNE   @RF00241      NO, CONTINUE SEARCH
REP 0578 D207,2000,7000      MVC   0(8,2),0(7)   YES, STEAL FOR THIS COMMAND
REP 057E 47F0,94C4           B     NOTFOUND+4
*                   PACHACCM EQU   *
REP 0582 D603,2014,2014      OC    SIGTGET(4,2),SIGTGET(2) DID THIS CMD TGET?
REP 0588 4770,93F8           BNZ   ENDTPUT       YES, SKIP NO-TGET CODE
REP 058C 4110,0001           LA    1,1           NO, ADD 1 TO NO-TGET
REP 0590 5E10,5018           AL    1,SMF32TPT(,5) CMD COUNT
REP 0594 5010,5018           ST    1,SMF32TPT(,5)
REP 0598 5840,5014           L     4,SMF32TGT(,5) ADD ELAPSED TIME TO
REP 059C 5E40,200C           AL    4,SIGSRB(,2)  NO-TGET ELAPSED TOTAL
REP 05A0 5040,5014           ST    4,SMF32TGT(,5)
REP 05A4 47F0,93F8           B     ENDTPUT
* DECK PRODUCED BY THE ASMTOZAP UTILITY 82/06/16 145736
