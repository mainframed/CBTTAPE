00010016PROC 1 CMPROPT
00020004  ISPEXEC VGET (SLSS DEBUG CHGFLG)
00030017  IF &DEBUG = DEBUG THEN DO
00040004      CONTROL MSG LIST CONLIST SYMLIST
00050004  END DO
00060004  ELSE DO
00070004      CONTROL NOMSG
00080004  END DO
00090012BEGIN: +
00100016  IF &CMPROPT = &STR(STOP) THEN GOTO STOP
00110016  IF &CHGFLG = &STR(Y) THEN DO
00120015    SET SLSSERR1 = UPDATE(S) HAVE BEEN MADE TO THE SLSS TABLE FILE.
00130015    SET SLSSERR2 = THIS UTILITY REQUIRES THAT THE SLSS TABLE FILE IS NOT
00140015    SET SLSSERR3 = UPDATED DURING THE CURRENT SESSION. BACK OUT OF SLSS
00150015    SET SLSSERR4 = TO SAVE CHAGES, BEFORE ATTEMPTING COMPRESS.
00160015    SET SLSSERR5 =
00170015    SET SLSSERRX = PRESS ENTER TO CONTINUE.
00180015    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00190015    EXIT
00200015  END DO
00210015  SET SLSSWRN1 = THIS UTILITY REQUIRES THAT THE SLSS TABLE FILE
00220015  SET SLSSWRN2 = IS NOT CURRENTLY BEING UPDATED.
00230015  SET SLSSWRN3 = THIS DIALOG WILL TERMINATE SO THAT A COMPRESS
00240015  SET SLSSWRN4 = OF THE SLSS TABLE FILE MAY BE PERFORMED.
00250015  SET SLSSWRN5 =
00260015  SET SLSSWRNX = PRESS ENTER TO CONTINUE, END KEY TO TERMINATE.
00270015  ISPEXEC DISPLAY PANEL(SLSS@WRN)
00280004  SET RC = &LASTCC
00290004  IF &RC ¬= 0 THEN EXIT
00300013  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
00310012  SET RC = &LASTCC
00320012  IF &RC ¬= 0 THEN DO
00330012    SET SLSSERR1 = UNABLE TO OPEN SLSS CONTROL FILE, SLSSCNTL.
00340012    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
00350012    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00360012    SET SLSSERR4 = REGARDING THIS ERROR.
00370012    SET SLSSERR5 =
00380012    SET SLSSERRX = PRESS ENTER TO CONTINUE
00390013    ISPEXEC TBEND SLSSCNTL
00400012    EXIT
00410012  END DO
00420004LOOP: +
00430013  ISPEXEC TBVCLEAR SLSSCNTL
00440013  ISPEXEC TBSKIP SLSSCNTL NUMBER(+1)
00450004  SET RC = &LASTCC
00460004  IF &RC = 8 THEN GOTO DONE
00470004  IF &RC ¬= 0 THEN DO
00480004    SET SLSSWRN1 = UNABLE TO OBTAIN CONTROL FILE INFORMATION
00490004    SET SLSSWRN2 = FOR ONE OF THE LIBRARIES. PROCESSING WILL
00500004    SET SLSSWRN3 = CONTINUE FOR REMAINING LIBRARIES.
00510004    SET SLSSWRN4 = RETURN CODE FOR 'ISPEXEC TBSKIP' WAS &RC.
00520004    SET SLSSWRN5 =
00530004    SET SLSSWRNX = PRESS ENTER TO CONTINUE.
00540004    ISPEXEC DISPLAY PANEL(SLSS@WRN)
00550004    GOTO LOOP
00560004  END DO
00570013  SET SLSS = &STR(&CIBN)
00580004  ISPEXEC VPUT (SLSS DEBUG) SHARED
00590004  %SLSSENQ ENQTEST
00600004  SET RC = &LASTCC
00610004  IF &RC = 0 THEN GOTO LOOP
00620004  ELSE DO
00630004    SET SLSSERR1 = LIBRARY '&SLSS' IS CURRENTLY BEING UPDATED.
00640004    SET SLSSERR2 = COMPRESS MAY NOT CONTINUE AT THIS TIME.
00650004    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00660004    SET SLSSERR4 = REGARDING THIS ERROR.
00670004    SET SLSSERR5 =
00680004    SET SLSSERRX = PRESS ENTER TO CONTINUE.
00690004    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00700013    ISPEXEC TBEND SLSSCNTL
00710004    EXIT
00720004  END DO
00730004DONE: +
00740013  ISPEXEC TBEND SLSSCNTL
00750014  SET SLSS = &STR(MAIN)
00760013  ISPEXEC VPUT (SLSS DEBUG) SHARED
00770013  %SLSSENQ ENQALL
00780013  IF &LASTCC ¬= 0 THEN EXIT
00790004  SET CHGFLG = &STR(C)
00800006  ISPEXEC VPUT (CHGFLG) SHARED
00810006  ISPEXEC TBEND  SLSSPROF
00820007  ISPEXEC TBOPEN SLSSPROF
00830006  SET RC = &LASTCC
00840006  IF &RC = 8 THEN DO
00850006    %SLSSPROF &SYSUID &DEBUG
00860006    SET PROFRC = &LASTCC
00870006    IF &PROFRC ¬= 0 THEN DO
00880012      SET SLSSWRN1 = UNABLE TO CREATE YOUR SLSS PROFILE.
00890012      SET SLSSWRN2 = BE SURE JOB CARDS ARE CORRECT BEFORE SUBMITTING JOBS.
00900012      SET SLSSWRN3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00910012      SET SLSSWRN4 = REGARDING THIS ERROR.
00920012      SET SLSSWRN5 =
00930012      SET SLSSWRNX = PRESS ENTER TO CONTINUE
00940012      ISPEXEC DISPLAY PANEL(SLSS@WRN)
00950006      GOTO SUBMIT
00960006    END DO
00970006    SET RC = 0
00980006  END DO
00990006  IF &RC ¬= 0 THEN DO
01000012    SET SLSSWRN1 = UNABLE TO OPEN YOUR SLSS PROFILE.
01010012    SET SLSSWRN2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
01020012    SET SLSSWRN3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01030012    SET SLSSWRN4 = REGARDING THIS ERROR.
01040012    SET SLSSWRN5 =
01050012    SET SLSSWRNX = PRESS ENTER TO CONTINUE
01060012    ISPEXEC DISPLAY PANEL(SLSS@WRN)
01070006    GOTO SUBMIT
01080006  END DO
01090006  ISPEXEC TBTOP SLSSPROF
01100006  ISPEXEC TBVCLEAR SLSSPROF
01110006  SET SLSSUSR = &STR(&SYSUID)
01120006  ISPEXEC TBSKIP SLSSPROF
01130006  SET SKIPRC = &LASTCC
01140006  IF &SKIPRC ¬= 0 THEN DO
01150012    SET SLSSWRN1 = UNABLE TO OBTAIN INFORMATION FROM YOUR SLSS PROFILE.
01160012    SET SLSSWRN2 = RETURN CODE FOR 'ISPEXEC TBSKIP' WAS &SKIPRC..
01170012    SET SLSSWRN3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01180012    SET SLSSWRN4 = REGARDING THIS ERROR.
01190012    SET SLSSWRN5 =
01200012    SET SLSSWRNX = PRESS ENTER TO CONTINUE
01210012    ISPEXEC DISPLAY PANEL(SLSS@WRN)
01220006  END DO
01230006  GOTO SUBMIT
01240006SUBMIT: +
01250005  IF &STR(&SLSSJOB1) = &STR() THEN DO
01260006    ISPEXEC VGET (ZLLGJOB1 ZLLGJOB2 ZLLGJOB3 ZLLGJOB4)
01270005    SET SLSSJOB1 = &STR(&ZLLGJOB1)
01280005    SET SLSSJOB2 = &STR(&ZLLGJOB2)
01290005    SET SLSSJOB3 = &STR(&ZLLGJOB3)
01300005    SET SLSSJOB4 = &STR(&ZLLGJOB4)
01310006    ISPEXEC DISPLAY PANEL(SLSSJOBC)
01320005    SET RC = &LASTCC
01330006    IF &RC = 8 THEN DO
01340006      ISPEXEC TBEND SLSSPROF
01350006      EXIT
01360006    END DO
01370005    IF &RC ¬= 0 THEN DO
01380005      SET SLSSERR1 = UNABLE TO DISPLAY SLSS JOB CARD SETUP PANEL.
01390005      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
01400005      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01410005      SET SLSSERR4 = REGARDING THIS ERROR.
01420005      SET SLSSERR5 =
01430005      SET SLSSERRX = PRESS ENTER TO CONTINUE
01440005      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01450006      ISPEXEC TBEND SLSSPROF
01460005      EXIT
01470005    END DO
01480005  GOTO SUBMIT
01490005  END DO
01500005  SET SLSSINDX = &SLSSINDX + 1
01510005  IF &SLSSINDX = 27 THEN SET SLSSINDX = 1
01520005  SET TEMPNAME = &STR(//&SLSSUSR.&SUBSTR(&SLSSINDX:&SLSSINDX,&STR(ABCDEFGHIJKLMNOPQRSTUVWXYZ)))
01530005  SET TEMPLEN = &LENGTH(&STR(&SLSSJOB1))
01540005  SET SLSSJOB1 = &STR(&TEMPNAME.&SUBSTR(10:&TEMPLEN,&SLSSJOB1))
01550006  ISPEXEC TBPUT SLSSPROF
01560007  ISPEXEC TBCLOSE SLSSPROF
01570006  ISPEXEC VPUT (SLSSJOB1 SLSSJOB2 SLSSJOB3 SLSSJOB4)
01580004  ISPEXEC FTOPEN TEMP
01590004  ISPEXEC FTINCL SLSSCOMP
01600004  ISPEXEC FTCLOSE
01610006  ISPEXEC VGET (ZTEMPF)
01620004  IF &DEBUG ¬= &STR(  ) THEN DO
01630004    ISPEXEC EDIT  DATASET('&ZTEMPF')
01640004  END DO
01650004  SUBMIT '&ZTEMPF'
01660004  EXIT
01670016STOP: +
01680016  SET SLSS = &STR(MAIN)
01690016  ISPEXEC VPUT (SLSS DEBUG) SHARED
01700016  %SLSSENQ ENQOFF
01710016  EXIT
