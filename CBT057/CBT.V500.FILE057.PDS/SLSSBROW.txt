00010000PROC 0
00020009    ISPEXEC VGET (DEBUG SLSS CIBSRTKY CIBNUMBR LIBADMIN CIBOWNER)
00030000    IF &DEBUG = DEBUG THEN DO
00040000        CONTROL MSG LIST CONLIST SYMLIST
00050000    END DO
00060000    ELSE DO
00070000        CONTROL NOMSG
00080000    END DO
00090000INIT: +
00100005    ISPEXEC CONTROL ERRORS RETURN
00110010    ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
00120000    SET &RC = &LASTCC
00130000    IF &RC = 12 THEN DO
00140000      SET &SLSSWRN1 = LIBRARY IS CURRENTLY OPEN FOR EDIT BY ANOTHER
00150000      SET &SLSSWRN2 = USER.  PLEASE TRY PROCESS AT A LATER TIME.
00160000      SET &SLSSWRN3 =
00170000      SET &SLSSWRN4 =
00180000      SET &SLSSWRN5 =
00190000      SET &SLSSWRNX = PRESS ENTER TO CONTINUE
00200000      ISPEXEC DISPLAY PANEL(SLSS@WRN)
00210000      ISPEXEC TBEND &SLSS
00220000      EXIT
00230000    END DO
00240000    IF &RC ¬= 0 THEN DO
00250000      SET &SLSSERR1 = UNABLE TO OPEN LIBRARY &SLSS.
00260000      SET &SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC..
00270000      SET &SLSSERR3 =
00280000      SET &SLSSERR4 =
00290000      SET &SLSSERR5 =
00300000      SET &SLSSERRX = PRESS ENTER TO CONTINUE
00310000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00320000      ISPEXEC TBEND &SLSS
00330000      EXIT
00340000    END DO
00350013    ISPEXEC TBTOP &SLSS
00360000PROCESS: +
00370015    ISPEXEC CONTROL DISPLAY REFRESH
00380000    ISPEXEC TBDISPL &SLSS PANEL(SLSSBROW)
00390000    SET &RC = &LASTCC
00400000    IF &RC = 8 THEN DO
00410000      ISPEXEC TBEND &SLSS
00420006      ISPEXEC TBEND MAINLOCS
00430000      EXIT
00440000    END DO
00450013    IF &STR(&OPT) ¬= &STR( ) THEN DO
00460000      ISPEXEC TBVCLEAR &SLSS
00470015      IF &STR(&OPT) ¬= &STR(F) THEN DO
00480013        SET &SLSID = &STR(&OPT.*)
00490013      END DO
00500017      ELSE DO
00510020        ISPEXEC TBSKIP &SLSS ROW(&ROW#) NOREAD
00520017      END DO
00530000      ISPEXEC TBSARG &SLSS
00540019      ISPEXEC TBSCAN &SLSS ROWID(ROW#) NEXT
00550000      SET &LCC = &LASTCC
00560012      IF &LCC = 0 THEN GOTO PROCESS
00570000      IF &LCC = 8 THEN DO
00580014        ISPEXEC CONTROL ERRORS RETURN
00590000        SET &SLSSCAU1 = &STR(ENTRY '&SLSID' NOT FOUND IN LIBRARY)
00600000        SET &SLSSCAU2 =
00610000        SET &SLSSCAU3 =
00620000        SET &SLSSCAU4 =
00630000        SET &SLSSCAU5 =
00640000        SET &SLSSCAUX = PRESS ENTER TO CONTINUE
00650000        ISPEXEC DISPLAY PANEL(SLSS@CAU)
00660000        GOTO PROCESS
00670000      END DO
00680000    END DO
00690000    IF &RC = 0 THEN DO
00700000      GOTO DISPLAY
00710000    END DO
00720000    IF &RC = 12 THEN DO
00730000      GOTO DISPLAY
00740000    END DO
00750014    ISPEXEC CONTROL ERRORS RETURN
00760000    SET &SLSSERR1 = UNABLE TO BROWSE LIBRARY &SLSS.
00770000    SET &SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBDISPL' WAS &RC..
00780000    SET &SLSSERR3 =
00790000    SET &SLSSERR4 =
00800000    SET &SLSSERR5 =
00810000    SET &SLSSERRX = PRESS ENTER TO CONTINUE, ELSE END KEY TO TERMINATE.
00820000    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00830000    SET &RC = &LASTCC
00840000    IF &RC = 8 THEN EXIT
00850000DISPLAY: +
00860000    ISPEXEC DISPLAY PANEL(SLSSBRW2)
00870000    SET &RC = &LASTCC
00880000    IF &RC = 8 THEN DO
00890000      GOTO PROCESS
00900000    END DO
00910000    IF &LOCS = Y THEN GOTO PROCLOCS
00920000    GOTO DISPLAY
00930000PROCLOCS: +
00940000    IF &LOCSOPEN = Y THEN GOTO SHOWLOCS
00950010    ISPEXEC TBOPEN MAINLOCS NOWRITE LIBRARY(SLSSTLIB)
00960000    SET &RC = &LASTCC
00970000    IF &RC ¬= 0 THEN DO
00980006      SET &SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
00990000      SET &SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC.
01000000      SET &SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
01010000      SET &SLSSERR4 = CONCERNING THIS ERROR.
01020000      SET &SLSSERR5 =
01030000      SET &SLSSERRX = PRESS ENTER TO CONTINUE
01040000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01050006      ISPEXEC TBEND MAINLOCS
01060000      GOTO DISPLAY
01070000    END DO
01080000    SET &LOCSOPEN = Y
01090000SHOWLOCS: +
01100008    SET &LOCID = &STR(MAIN&SLSID)
01110006    ISPEXEC TBGET MAINLOCS
01120002    ISPEXEC DISPLAY PANEL(SLSSLOC1)
01130021    GOTO DISPLAY
