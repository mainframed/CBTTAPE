00010008PROC 6 SLSSRPT SLSSSEQ SLSSPRT SLSSLINE SLSSFORM SLSS
00020018  CONTROL NOMSG
00030003  SET FS = &STR(                                                                                          )
00040003  SET DSNCNT = 0
00050003  SET PRTRTN = &STR(N)
00060003  SET SAVELINE = &STR( )
00070003  ISPEXEC CONTROL ERRORS RETURN
00080008OUTFILE: +
00090003  FREE F(SLSSOUT)
00100003  SET FORM = &STR(P014)
00110003  IF &SLSSFORM = &STR(2) THEN DO
00120003    SET FORM = &STR(P001)
00130003  END DO
00140003  IF &SLSSRPT = &STR(5) OR &SLSSRPT = &STR(6) OR &SLSSRPT = &STR(7) THEN DO
00150003    IF &SLSSRPT ¬= &STR(7) THEN DO
00160016      SET TIME = &STR(&SYSTIME)
00170019      SET HOUR = &SUBSTR(1:2,&TIME&FS)
00180019      SET MIN = &SUBSTR(4:5,&TIME&FS)
00190019      SET SEC = &SUBSTR(7:8,&TIME&FS)
00200016      SET SLSSDSN = &STR(&SYSUID..T&HOUR&MIN&SEC..SLSSTEXT)
00210003      DELETE &SLSSDSN
00220003      ALLOC F(SLSSOUT) DA(&SLSSDSN) NEW CATALOG SPACE(1 1) CYLINDER LRECL(256) BLKSIZE(6148) RECFM(V B)
00230003    END DO
00240003    ELSE DO
00250016      SET TIME = &STR(&SYSTIME)
00260019      SET HOUR = &SUBSTR(1:2,&TIME&FS)
00270019      SET MIN = &SUBSTR(4:5,&TIME&FS)
00280019      SET SEC = &SUBSTR(7:8,&TIME&FS)
00290016      SET SLSSDSN = &STR(&SYSUID..T&HOUR&MIN&SEC..LOCS)
00300003      DELETE &SLSSDSN
00310003      ALLOC F(SLSSOUT) DA(&SLSSDSN) NEW CATALOG SPACE(1 1) CYLINDER LRECL(80) BLKSIZE(6240) RECFM(F B)
00320003    END DO
00330003  END DO
00340003  ELSE DO
00350003    IF &SLSSPRT = &STR(1) THEN DO
00360003      ALLOC F(SLSSOUT) SYSOUT(G) DEST(FETCH) FORM(&FORM) LRECL(91) BLKSIZE(5460) RECFM(F B A)
00370003    END DO
00380003    ELSE DO
00390003      ALLOC F(SLSSOUT) SYSOUT(A) DEST(FETCH) LRECL(91) BLKSIZE(5460) RECFM(F B A)
00400003    END DO
00410003  END DO
00420003  OPENFILE SLSSOUT OUTPUT
00430000SETPAGE: +
00440003  SET PAGNUM = 0
00450003  SET MAXLN = 59
00460003  SET CHKMXS = 56
00470003  SET CHKMXD = 53
00480003  IF &SLSSLINE = &STR(S) THEN DO
00490003    SET CR = &STR( )
00500003  END DO
00510003  ELSE DO
00520003    SET CR = &STR(0)
00530003  END DO
00540000RPT1: +
00550003  IF &SLSSRPT ¬= &STR(1) THEN GOTO RPT2
00560003  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
00570003  SET RC = &LASTCC
00580003  IF &RC ¬= 0 THEN DO
00590003    WRITE UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
00600003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
00610003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
00620003    WRITE INFORMATION REGARDING THIS ERROR.
00630003    WRITE ========================================
00640003    ISPEXEC TBEND SLSSCNTL
00650003    GOTO ENDRPT
00660003  END DO
00670003  ISPEXEC TBVCLEAR SLSSCNTL
00680003  SET CIBN = &STR(MAIN)
00690003  ISPEXEC TBSARG SLSSCNTL
00700003  ISPEXEC TBSCAN SLSSCNTL
00710003  SET RC = &LASTCC
00720003  IF &RC ¬= 0 THEN DO
00730003    WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY 'MAIN'.
00740003    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
00750003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
00760003    WRITE INFORMATION REGARDING THIS ERROR.
00770003    WRITE ========================================
00780003    ISPEXEC TBEND SLSSCNTL
00790003    GOTO ENDRPT
00800003  END DO
00810003  ISPEXEC TBEND SLSSCNTL
00820003  ISPEXEC TBOPEN MAIN NOWRITE LIBRARY(SLSSTLIB)
00830003  SET RC = &LASTCC
00840003  IF &RC ¬= 0 THEN DO
00850003    WRITE UNABLE TO OPEN COMPLETE SLSS LIBRARY, MAIN.
00860003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
00870003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
00880003    WRITE INFORMATION REGARDING THIS ERROR.
00890003    WRITE ========================================
00900003    ISPEXEC TBEND MAIN
00910003    GOTO ENDRPT
00920003  END DO
00930000SORT1: +
00940003  IF &SLSSSEQ = &STR(&CIBSRTKY) THEN GOTO SETHDR1
00950003  IF &STR(&SLSSSEQ) = B THEN +
00960003      SET FIELD = &STR(BOOK)
00970003  IF &STR(&SLSSSEQ) = M THEN +
00980003      SET FIELD = &STR(SLSSRTKY)
00990003  IF &STR(&SLSSSEQ) = T THEN +
01000003      SET FIELD = &STR(NAME1)
01010003  ISPEXEC TBSORT MAIN FIELDS(&FIELD,C,A)
01020003  SET RC = &LASTCC
01030003  IF &RC ¬= 0 THEN DO
01040003    WRITE UNABLE TO PROCESS LIBRARY, MAIN, FOR SORT.
01050003    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
01060003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01070003    WRITE REGARDING THIS ERROR.
01080003    WRITE ========================================
01090003    ISPEXEC TBEND MAIN
01100003    GOTO ENDRPT
01110003  END DO
01120000SETHDR1: +
01130019  SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
01140019  SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
01150019  SET CSLS = &SUBSTR(1:4,&STR(MAIN&FS))
01160003  SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
01170003  SET HDR0B = &STR( REPORT                      PAGE:  )
01180003  SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
01190003  SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
01200003  SET HDR4A = &STR(   ---------------------------------------------)
01210003  SET HDR4B = &STR(------------------------------------------)
01220003  IF &SLSSSEQ = &STR(B) THEN DO
01230003    SET HDR2A = &STR(                                    BINDER SE)
01240003    SET HDR2B = &STR(QUENCE LISTING                               )
01250003    SET HDR3A = &STR(    BINDER  MANUAL-ID VER NUM S            )
01260003    SET HDR3B = &STR(                TITLE                          )
01270003    GOTO PRTHDR1
01280003  END DO
01290003  IF &SLSSSEQ = &STR(T) THEN DO
01300003    SET HDR2A = &STR(                                     TITLE SE)
01310003    SET HDR2B = &STR(QUENCE LISTING                               )
01320003    SET HDR3A = &STR(                              TITLE          )
01330003    SET HDR3B = &STR(                 MANUAL-ID  BINDER  VER NUM S)
01340003    GOTO PRTHDR1
01350003  END DO
01360003  SET HDR2A = &STR(                                   MANUAL-ID )
01370003  SET HDR2B = &STR(SEQUENCE LISTING                             )
01380003  SET HDR3A = &STR(   MANUAL-ID  BINDER  VER NUM S           )
01390003  SET HDR3B = &STR(                 TITLE                          )
01400003  GOTO PRTHDR1
01410000PRTHDR1: +
01420003  SET PAGNUM = &PAGNUM + 1
01430003  SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
01440003  PUTFILE SLSSOUT
01450003  SET SLSSOUT = &STR( &HDR2A&HDR2B)
01460003  PUTFILE SLSSOUT
01470003  SET SLSSOUT = &STR( &HDR1A&HDR1B)
01480003  PUTFILE SLSSOUT
01490003  SET SLSSOUT = &STR(   )
01500003  PUTFILE SLSSOUT
01510003  SET SLSSOUT = &STR( &HDR3A&HDR3B)
01520003  PUTFILE SLSSOUT
01530003  SET SLSSOUT = &STR( &HDR4A&HDR4B)
01540003  PUTFILE SLSSOUT
01550003  SET LNCNT = 6
01560003  IF &PRTRTN = &STR(Y) THEN DO
01570003    SET SLSSOUT = &STR(&SAVELINE)
01580003    SET PRTRTN = &STR(N)
01590003    GOTO PRTLIN11
01600003  END DO
01610000LOOPTBL1: +
01620003  SET BYPASS = &STR(N)
01630003  SET SLSSOUT = &STR( )
01640003  ISPEXEC TBSKIP MAIN NUMBER(+1)
01650003  SET RC = &LASTCC
01660003  IF &RC = 8 THEN DO
01670003    ISPEXEC TBEND MAIN
01680003    WRITE ========================================
01690003    WRITE REPORT PROCESSING COMPLETE FOR LIBRARY, 'MAIN'.
01700003    WRITE ========================================
01710003    GOTO ENDRPT
01720003  END DO
01730003  IF &RC ¬= 0 THEN DO
01740003    WRITE UNABLE TO PROCESS LIBRARY MAIN FOR REPORT.
01750003    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
01760003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
01770003    WRITE INFORMATION REGARDING THIS ERROR.
01780003    WRITE ========================================
01790003    ISPEXEC TBEND MAIN
01800003    GOTO ENDRPT
01810003  END DO
01820003  SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
01830003  SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
01840003  SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
01850003  SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
01860003  SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
01870003  SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
01880003  SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
01890000SETLIN11: +
01900003  IF &SLSSSEQ = &STR(B) THEN DO
01910003    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
01920003    GOTO PRTLIN11
01930003  END DO
01940003  IF &SLSSSEQ = &STR(T) THEN DO
01950003    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
01960003    GOTO PRTLIN11
01970003  END DO
01980003  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
01990003  GOTO PRTLIN11
02000000PRTLIN11: +
02010003  IF &SLSSLINE = &STR(S) THEN DO
02020003    IF &LNCNT > &CHKMXS THEN DO
02030003      SET SAVELINE = &STR(&SLSSOUT)
02040003      SET PRTRTN = &STR(Y)
02050003      GOTO PRTHDR1
02060003    END DO
02070003  END DO
02080003  ELSE DO
02090003    IF &LNCNT > &CHKMXD THEN DO
02100003      SET SAVELINE = &STR(&SLSSOUT)
02110003      SET PRTRTN = &STR(Y)
02120003      GOTO PRTHDR1
02130003    END DO
02140003  END DO
02150003  PUTFILE SLSSOUT
02160003  IF &CR = &STR( ) THEN DO
02170003    SET LNCNT = &LNCNT + 1
02180003  END DO
02190003  ELSE DO
02200003    SET LNCNT = &LNCNT + 2
02210003  END DO
02220000SETLIN12: +
02230003  IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN1
02240003  SET R1 = &SUBSTR(1:9,&STR(&FS))
02250003  SET R2 = &SUBSTR(1:8,&STR(&FS))
02260003  SET R3 = &SUBSTR(1:1,&STR(&FS))
02270003  SET R4 = &SUBSTR(1:2,&STR(&FS))
02280003  SET R5 = &SUBSTR(1:2,&STR(&FS))
02290003  SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
02300003  SET R7 = &SUBSTR(1:8,&STR(&FS))
02310003  IF &SLSSSEQ = &STR(B) THEN DO
02320003    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
02330003    GOTO PRTLIN12
02340003  END DO
02350003  IF &SLSSSEQ = &STR(T) THEN DO
02360003    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
02370003    GOTO PRTLIN12
02380003  END DO
02390003  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
02400003  GOTO PRTLIN12
02410000PRTLIN12: +
02420003  PUTFILE SLSSOUT
02430003  IF &CR = &STR( ) THEN DO
02440003    SET LNCNT = &LNCNT + 1
02450003  END DO
02460003  ELSE DO
02470003    SET LNCNT = &LNCNT + 2
02480003  END DO
02490000SETLIN13: +
02500003  IF &BYPASS = &STR(Y) THEN GOTO CHKLN1
02510003  IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN1
02520003  SET BYPASS = &STR(Y)
02530003  SET NAME2 = &STR(&NAME3)
02540003  SET NAME3 = &STR( )
02550003  GOTO SETLIN12
02560000CHKLN1: +
02570003  IF &LNCNT < &MAXLN THEN DO
02580003    GOTO LOOPTBL1
02590003  END DO
02600003  ELSE DO
02610003    GOTO PRTHDR1
02620003  END DO
02630000RPT2: +
02640003  IF &SLSSRPT ¬= &STR(2) THEN GOTO RPT3
02650003  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
02660003  SET RC = &LASTCC
02670003  IF &RC ¬= 0 THEN DO
02680003    WRITE UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
02690003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
02700003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
02710003    WRITE INFORMATION REGARDING THIS ERROR.
02720003    WRITE ========================================
02730003    ISPEXEC TBEND SLSSCNTL
02740003    GOTO ENDRPT
02750003  END DO
02760003  ISPEXEC TBVCLEAR SLSSCNTL
02770003  SET CIBN = &STR(MAIN)
02780003  ISPEXEC TBSARG SLSSCNTL
02790003  ISPEXEC TBSCAN SLSSCNTL
02800003  SET RC = &LASTCC
02810003  IF &RC ¬= 0 THEN DO
02820003    WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY 'MAIN'.
02830003    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
02840003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
02850003    WRITE INFORMATION REGARDING THIS ERROR.
02860003    WRITE ========================================
02870003    ISPEXEC TBEND SLSSCNTL
02880003    GOTO ENDRPT
02890003  END DO
02900003  SET CNT = 0
02910003  DO WHILE &CNT < 120
02920003    SET CNT = &CNT + 1
02930003    SET PF  = &STR(&&SLB&CNT)
02940003    SET SAVSLB&CNT = &STR(&PF)
02950003  END DO
02960003  SET CNT = 1
02970003  SET PF  = &STR(&&SAVSLB&CNT)
02980003  SET SLSS = &STR(&PF)
02990003  IF &SLSS = &STR() THEN SET &CNT = 121
03000003  IF &SLSS = &STR(MAIN) THEN GOTO NEXTLIB2
03010003  DO WHILE &CNT < 121
03020003    ISPEXEC TBTOP SLSSCNTL
03030003    ISPEXEC TBVCLEAR SLSSCNTL
03040003    SET CIBN = &STR(&SLSS)
03050003    ISPEXEC TBSARG SLSSCNTL
03060003    ISPEXEC TBSCAN SLSSCNTL
03070003    SET RC = &LASTCC
03080003    IF &RC ¬= 0 THEN DO
03090003      WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY '&SLSS'.
03100003      WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
03110003      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
03120003      WRITE INFORMATION REGARDING THIS ERROR.
03130003      WRITE ========================================
03140003      GOTO NEXTLIB2
03150003    END DO
03160003    ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
03170003    SET RC = &LASTCC
03180003    IF &RC ¬= 0 THEN DO
03190003      WRITE UNABLE TO OPEN LIBRARY, &SLSS, FOR PRINT.
03200003      WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
03210003      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
03220003      WRITE INFORMATION REGARDING THIS ERROR.
03230003      WRITE ========================================
03240003      ISPEXEC TBEND &SLSS
03250003      GOTO NEXTLIB2
03260003    END DO
03270000SORT2: +
03280003    IF &SLSSSEQ = &STR(&CIBSRTKY) THEN GOTO SETHDR2
03290003    IF &STR(&SLSSSEQ) = B THEN +
03300003        SET FIELD = &STR(BOOK)
03310003    IF &STR(&SLSSSEQ) = M THEN +
03320003        SET FIELD = &STR(SLSSRTKY)
03330003    IF &STR(&SLSSSEQ) = T THEN +
03340003        SET FIELD = &STR(NAME1)
03350003    ISPEXEC TBSORT &SLSS FIELDS(&FIELD,C,A)
03360003    SET RC = &LASTCC
03370003    IF &RC ¬= 0 THEN DO
03380003      WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
03390003      WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
03400003      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
03410003      WRITE REGARDING THIS ERROR.
03420003      WRITE ========================================
03430003      ISPEXEC TBEND &SLSS
03440003      GOTO NEXTLIB2
03450003    END DO
03460000SETHDR2: +
03470003    SET PAGNUM = 0
03480019    SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
03490019    SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
03500019    SET CSLS = &SUBSTR(1:4,&STR(&SLSS&FS))
03510003    SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
03520003    SET HDR0B = &STR( REPORT                      PAGE:  )
03530003    SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
03540003    SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
03550003    SET HDR4A = &STR(   ---------------------------------------------)
03560003    SET HDR4B = &STR(------------------------------------------)
03570003    IF &SLSSSEQ = &STR(B) THEN DO
03580003      SET HDR2A = &STR(                                    BINDER SE)
03590003      SET HDR2B = &STR(QUENCE LISTING                               )
03600003      SET HDR3A = &STR(    BINDER  MANUAL-ID VER NUM S            )
03610003      SET HDR3B = &STR(                TITLE                          )
03620003      GOTO PRTHDR2
03630003    END DO
03640003    IF &SLSSSEQ = &STR(T) THEN DO
03650003      SET HDR2A = &STR(                                     TITLE SE)
03660003      SET HDR2B = &STR(QUENCE LISTING                               )
03670003      SET HDR3A = &STR(                              TITLE          )
03680003      SET HDR3B = &STR(                 MANUAL-ID  BINDER  VER NUM S)
03690003      GOTO PRTHDR2
03700003    END DO
03710003    SET HDR2A = &STR(                                   MANUAL-ID )
03720003    SET HDR2B = &STR(SEQUENCE LISTING                             )
03730003    SET HDR3A = &STR(   MANUAL-ID  BINDER  VER NUM S           )
03740003    SET HDR3B = &STR(                 TITLE                          )
03750003    GOTO PRTHDR2
03760000PRTHDR2: +
03770003    SET PAGNUM = &PAGNUM + 1
03780003    SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
03790003    PUTFILE SLSSOUT
03800003    SET SLSSOUT = &STR( &HDR2A&HDR2B)
03810003    PUTFILE SLSSOUT
03820003    SET SLSSOUT = &STR( &HDR1A&HDR1B)
03830003    PUTFILE SLSSOUT
03840003    SET SLSSOUT = &STR(   )
03850003    PUTFILE SLSSOUT
03860003    SET SLSSOUT = &STR( &HDR3A&HDR3B)
03870003    PUTFILE SLSSOUT
03880003    SET SLSSOUT = &STR( &HDR4A&HDR4B)
03890003    PUTFILE SLSSOUT
03900003    SET LNCNT = 6
03910003    IF &PRTRTN = &STR(Y) THEN DO
03920003      SET SLSSOUT = &STR(&SAVELINE)
03930003      SET PRTRTN = &STR(N)
03940003      GOTO PRTLIN21
03950003    END DO
03960000LOOPTBL2: +
03970003    SET BYPASS = &STR(N)
03980003    SET SLSSOUT = &STR( )
03990003    ISPEXEC TBSKIP &SLSS NUMBER(+1)
04000003    SET RC = &LASTCC
04010003    IF &RC = 8 THEN DO
04020003      ISPEXEC TBEND &SLSS
04030003      WRITE ========================================
04040003      WRITE REPORT PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
04050003      WRITE ========================================
04060003      GOTO NEXTLIB2
04070003    END DO
04080003    IF &RC ¬= 0 THEN DO
04090003      WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR REPORT.
04100003      WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
04110003      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
04120003      WRITE INFORMATION REGARDING THIS ERROR.
04130003      WRITE ========================================
04140003      ISPEXEC TBEND &SLSS
04150003      GOTO NEXTLIB2
04160003    END DO
04170003    SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
04180003    SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
04190003    SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
04200003    SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
04210003    SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
04220003    SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
04230003    SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
04240000SETLIN21: +
04250003    IF &SLSSSEQ = &STR(B) THEN DO
04260003      SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
04270003      GOTO PRTLIN21
04280003    END DO
04290003    IF &SLSSSEQ = &STR(T) THEN DO
04300003      SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
04310003      GOTO PRTLIN21
04320003    END DO
04330003    SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
04340003    GOTO PRTLIN21
04350000PRTLIN21: +
04360003    IF &SLSSLINE = &STR(S) THEN DO
04370003      IF &LNCNT > &CHKMXS THEN DO
04380003        SET SAVELINE = &STR(&SLSSOUT)
04390003        SET PRTRTN = &STR(Y)
04400003        GOTO PRTHDR2
04410003      END DO
04420003    END DO
04430003    ELSE DO
04440003      IF &LNCNT > &CHKMXD THEN DO
04450003        SET SAVELINE = &STR(&SLSSOUT)
04460003        SET PRTRTN = &STR(Y)
04470003        GOTO PRTHDR2
04480003      END DO
04490003    END DO
04500003    PUTFILE SLSSOUT
04510003    IF &CR = &STR( ) THEN DO
04520003      SET LNCNT = &LNCNT + 1
04530003    END DO
04540003    ELSE DO
04550003      SET LNCNT = &LNCNT + 2
04560003    END DO
04570000SETLIN22: +
04580003    IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN2
04590003    SET R1 = &SUBSTR(1:9,&STR(&FS))
04600003    SET R2 = &SUBSTR(1:8,&STR(&FS))
04610003    SET R3 = &SUBSTR(1:1,&STR(&FS))
04620003    SET R4 = &SUBSTR(1:2,&STR(&FS))
04630003    SET R5 = &SUBSTR(1:2,&STR(&FS))
04640003    SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
04650003    SET R7 = &SUBSTR(1:8,&STR(&FS))
04660003    IF &SLSSSEQ = &STR(B) THEN DO
04670003      SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
04680003      GOTO PRTLIN22
04690003    END DO
04700003    IF &SLSSSEQ = &STR(T) THEN DO
04710003      SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
04720003      GOTO PRTLIN22
04730003    END DO
04740003    SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
04750003    GOTO PRTLIN22
04760000PRTLIN22: +
04770003    PUTFILE SLSSOUT
04780003    IF &CR = &STR( ) THEN DO
04790003      SET LNCNT = &LNCNT + 1
04800003    END DO
04810003    ELSE DO
04820003      SET LNCNT = &LNCNT + 2
04830003    END DO
04840000SETLIN23: +
04850003    IF &BYPASS = &STR(Y) THEN GOTO CHKLN2
04860003    IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN2
04870003    SET BYPASS = &STR(Y)
04880003    SET NAME2 = &STR(&NAME3)
04890003    SET NAME3 = &STR( )
04900003    GOTO SETLIN22
04910000CHKLN2: +
04920003    IF &LNCNT < &MAXLN THEN DO
04930003      GOTO LOOPTBL2
04940003    END DO
04950003    ELSE DO
04960003      GOTO PRTHDR2
04970003    END DO
04980000NEXTLIB2: +
04990003    SET CNT = &CNT + 1
05000003    SET PF  = &STR(&&SAVSLB&CNT)
05010003    SET SLSS = &STR(&PF)
05020003    IF &SLSS = &STR() THEN SET &CNT = 121
05030003    IF &SLSS = &STR(MAIN) THEN GOTO NEXTLIB2
05040003  END DO
05050003  ISPEXEC TBEND SLSSCNTL
05060003  ISPEXEC CONTROL ERRORS RETURN
05070003  WRITE ========================================
05080003  WRITE REPORT PROCESSING COMPLETE FOR ALL LIBRARIES.
05090003  WRITE ========================================
05100003  GOTO ENDRPT
05110000RPT3: +
05120003  IF &SLSSRPT ¬= &STR(3) THEN GOTO RPT4
05130008  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
05140008  ISPEXEC TBVCLEAR SLSSCNTL
05150008  SET CIBN = &STR(&SLSS)
05160008  ISPEXEC TBSARG SLSSCNTL
05170008  ISPEXEC TBSCAN SLSSCNTL
05180008  ISPEXEC TBEND SLSSCNTL
05190003  ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
05200003  SET RC = &LASTCC
05210003  IF &RC ¬= 0 THEN DO
05220003    WRITE UNABLE TO OPEN SELECTED LIBRARY, &SLSS.
05230003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
05240003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
05250003    WRITE INFORMATION REGARDING THIS ERROR.
05260003    WRITE ========================================
05270003    ISPEXEC TBEND &SLSS
05280003    GOTO ENDRPT
05290003  END DO
05300000SORT3: +
05310003  IF &SLSSSEQ = &STR(&CIBSRTKY) THEN GOTO SETHDR3
05320003  IF &STR(&SLSSSEQ) = B THEN +
05330003      SET FIELD = &STR(BOOK)
05340003  IF &STR(&SLSSSEQ) = M THEN +
05350003      SET FIELD = &STR(SLSSRTKY)
05360003  IF &STR(&SLSSSEQ) = T THEN +
05370003      SET FIELD = &STR(NAME1)
05380003  ISPEXEC TBSORT &SLSS FIELDS(&FIELD,C,A)
05390003  SET RC = &LASTCC
05400003  IF &RC ¬= 0 THEN DO
05410003    WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
05420003    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
05430003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
05440003    WRITE REGARDING THIS ERROR.
05450003    WRITE ========================================
05460003    ISPEXEC TBEND &SLSS
05470003    GOTO ENDRPT
05480003  END DO
05490000SETHDR3: +
05500019  SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
05510019  SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
05520019  SET CSLS = &SUBSTR(1:4,&STR(&SLSS&FS))
05530003  SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
05540003  SET HDR0B = &STR( REPORT                      PAGE:  )
05550003  SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
05560003  SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
05570003  SET HDR4A = &STR(   ---------------------------------------------)
05580003  SET HDR4B = &STR(------------------------------------------)
05590003  IF &SLSSSEQ = &STR(B) THEN DO
05600003    SET HDR2A = &STR(                                    BINDER SE)
05610003    SET HDR2B = &STR(QUENCE LISTING                               )
05620003    SET HDR3A = &STR(    BINDER  MANUAL-ID VER NUM S            )
05630003    SET HDR3B = &STR(                TITLE                          )
05640003    GOTO PRTHDR3
05650003  END DO
05660003  IF &SLSSSEQ = &STR(T) THEN DO
05670003    SET HDR2A = &STR(                                     TITLE SE)
05680003    SET HDR2B = &STR(QUENCE LISTING                               )
05690003    SET HDR3A = &STR(                              TITLE          )
05700003    SET HDR3B = &STR(                 MANUAL-ID  BINDER  VER NUM S)
05710003    GOTO PRTHDR3
05720003  END DO
05730003  SET HDR2A = &STR(                                   MANUAL-ID )
05740003  SET HDR2B = &STR(SEQUENCE LISTING                             )
05750003  SET HDR3A = &STR(   MANUAL-ID  BINDER  VER NUM S           )
05760003  SET HDR3B = &STR(                 TITLE                          )
05770003  GOTO PRTHDR3
05780000PRTHDR3: +
05790003  SET PAGNUM = &PAGNUM + 1
05800003  SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
05810003  PUTFILE SLSSOUT
05820003  SET SLSSOUT = &STR( &HDR2A&HDR2B)
05830003  PUTFILE SLSSOUT
05840003  SET SLSSOUT = &STR( &HDR1A&HDR1B)
05850003  PUTFILE SLSSOUT
05860003  SET SLSSOUT = &STR(   )
05870003  PUTFILE SLSSOUT
05880003  SET SLSSOUT = &STR( &HDR3A&HDR3B)
05890003  PUTFILE SLSSOUT
05900003  SET SLSSOUT = &STR( &HDR4A&HDR4B)
05910003  PUTFILE SLSSOUT
05920003  SET LNCNT = 6
05930003  IF &PRTRTN = &STR(Y) THEN DO
05940003    SET SLSSOUT = &STR(&SAVELINE)
05950003    SET PRTRTN = &STR(N)
05960003    GOTO PRTLIN31
05970003  END DO
05980000LOOPTBL3: +
05990003  SET BYPASS = &STR(N)
06000003  SET SLSSOUT = &STR( )
06010003  ISPEXEC TBSKIP &SLSS NUMBER(+1)
06020003  SET RC = &LASTCC
06030003  IF &RC = 8 THEN DO
06040003    ISPEXEC TBEND &SLSS
06050003    WRITE ========================================
06060003    WRITE REPORT PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
06070003    WRITE ========================================
06080003    GOTO ENDRPT
06090003  END DO
06100003  IF &RC ¬= 0 THEN DO
06110003    WRITE UNABLE TO PROCESS LIBRARY &SLSS FOR REPORT.
06120003    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
06130003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
06140003    WRITE INFORMATION REGARDING THIS ERROR.
06150003    WRITE ========================================
06160003    ISPEXEC TBEND &SLSS
06170003    GOTO ENDRPT
06180003  END DO
06190003  SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
06200003  SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
06210003  SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
06220003  SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
06230003  SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
06240003  SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
06250003  SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
06260000SETLIN31: +
06270003  IF &SLSSSEQ = &STR(B) THEN DO
06280003    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
06290003    GOTO PRTLIN31
06300003  END DO
06310003  IF &SLSSSEQ = &STR(T) THEN DO
06320003    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
06330003    GOTO PRTLIN31
06340003  END DO
06350003  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
06360003  GOTO PRTLIN31
06370000PRTLIN31: +
06380003  IF &SLSSLINE = &STR(S) THEN DO
06390003    IF &LNCNT > &CHKMXS THEN DO
06400003      SET SAVELINE = &STR(&SLSSOUT)
06410003      SET PRTRTN = &STR(Y)
06420003      GOTO PRTHDR3
06430003    END DO
06440003  END DO
06450003  ELSE DO
06460003    IF &LNCNT > &CHKMXD THEN DO
06470003      SET SAVELINE = &STR(&SLSSOUT)
06480003      SET PRTRTN = &STR(Y)
06490003      GOTO PRTHDR3
06500003    END DO
06510003  END DO
06520003  PUTFILE SLSSOUT
06530003  IF &CR = &STR( ) THEN DO
06540003    SET LNCNT = &LNCNT + 1
06550003  END DO
06560003  ELSE DO
06570003    SET LNCNT = &LNCNT + 2
06580003  END DO
06590000SETLIN32: +
06600003  IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN3
06610003  SET R1 = &SUBSTR(1:9,&STR(&FS))
06620003  SET R2 = &SUBSTR(1:8,&STR(&FS))
06630003  SET R3 = &SUBSTR(1:1,&STR(&FS))
06640003  SET R4 = &SUBSTR(1:2,&STR(&FS))
06650003  SET R5 = &SUBSTR(1:2,&STR(&FS))
06660003  SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
06670003  SET R7 = &SUBSTR(1:8,&STR(&FS))
06680003  IF &SLSSSEQ = &STR(B) THEN DO
06690003    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
06700003    GOTO PRTLIN32
06710003  END DO
06720003  IF &SLSSSEQ = &STR(T) THEN DO
06730003    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
06740003    GOTO PRTLIN32
06750003  END DO
06760003  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
06770003  GOTO PRTLIN32
06780000PRTLIN32: +
06790003  PUTFILE SLSSOUT
06800003  IF &CR = &STR( ) THEN DO
06810003    SET LNCNT = &LNCNT + 1
06820003  END DO
06830003  ELSE DO
06840003    SET LNCNT = &LNCNT + 2
06850003  END DO
06860000SETLIN33: +
06870003  IF &BYPASS = &STR(Y) THEN GOTO CHKLN3
06880003  IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN3
06890003  SET BYPASS = &STR(Y)
06900003  SET NAME2 = &STR(&NAME3)
06910003  SET NAME3 = &STR( )
06920003  GOTO SETLIN32
06930000CHKLN3: +
06940003  IF &LNCNT < &MAXLN THEN DO
06950003    GOTO LOOPTBL3
06960003  END DO
06970003  ELSE DO
06980003    GOTO PRTHDR3
06990003  END DO
07000000RPT4: +
07010003  IF &SLSSRPT ¬= &STR(4) THEN GOTO RPT5
07020003  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
07030003  SET RC = &LASTCC
07040003  IF &RC ¬= 0 THEN DO
07050003    WRITE UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
07060003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
07070003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
07080003    WRITE INFORMATION REGARDING THIS ERROR.
07090003    WRITE ========================================
07100003    ISPEXEC TBEND SLSSCNTL
07110003    GOTO ENDRPT
07120003  END DO
07130003  ISPEXEC TBVCLEAR SLSSCNTL
07140003  SET CIBN = &STR(MAIN)
07150003  ISPEXEC TBSARG SLSSCNTL
07160003  ISPEXEC TBSCAN SLSSCNTL
07170003  SET RC = &LASTCC
07180003  IF &RC ¬= 0 THEN DO
07190003    WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY 'MAIN'.
07200003    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
07210003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
07220003    WRITE INFORMATION REGARDING THIS ERROR.
07230003    WRITE ========================================
07240003    ISPEXEC TBEND SLSSCNTL
07250003    GOTO ENDRPT
07260003  END DO
07270003  ISPEXEC TBEND SLSSCNTL
07280003  ISPEXEC TBOPEN MAIN NOWRITE LIBRARY(SLSSTLIB)
07290003  SET RC = &LASTCC
07300003  IF &RC ¬= 0 THEN DO
07310003    WRITE UNABLE TO OPEN COMPLETE SLSS LIBRARY, MAIN.
07320003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
07330003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
07340003    WRITE INFORMATION REGARDING THIS ERROR.
07350003    WRITE ========================================
07360003    ISPEXEC TBEND MAIN
07370003    GOTO ENDRPT
07380003  END DO
07390000SORT4: +
07400003  IF &CIBSRTKY = &STR(M) THEN GOTO SETHDR4
07410003  SET FIELD = &STR(SLSSRTKY)
07420003  ISPEXEC TBSORT MAIN FIELDS(&FIELD,C,A)
07430003  SET RC = &LASTCC
07440003  IF &RC ¬= 0 THEN DO
07450003    WRITE UNABLE TO PROCESS LIBRARY, MAIN, FOR SORT.
07460003    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
07470003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
07480003    WRITE REGARDING THIS ERROR.
07490003    WRITE ========================================
07500003    ISPEXEC TBEND MAIN
07510003    GOTO ENDRPT
07520003  END DO
07530000SETHDR4: +
07540019  SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
07550019  SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
07560019  SET CSLS = &SUBSTR(1:4,&STR(MAIN&FS))
07570003  SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
07580003  SET HDR0B = &STR( REPORT                      PAGE:  )
07590003  SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
07600003  SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
07610003  SET HDR4A = &STR(   ---------------------------------------------)
07620003  SET HDR4B = &STR(------------------------------------------)
07630003  SET HDR2A = &STR(                                    MANUALS ON)
07640003  SET HDR2B = &STR( ORDER LISTING                              )
07650003  SET HDR3A = &STR(   MANUAL-ID   DATE ORD                       )
07660003  SET HDR3B = &STR(       TITLE                                )
07670003  GOTO PRTHDR4
07680000PRTHDR4: +
07690003  SET PAGNUM = &PAGNUM + 1
07700003  SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
07710003  PUTFILE SLSSOUT
07720003  SET SLSSOUT = &STR( &HDR2A&HDR2B)
07730003  PUTFILE SLSSOUT
07740003  SET SLSSOUT = &STR( &HDR1A&HDR1B)
07750003  PUTFILE SLSSOUT
07760003  SET SLSSOUT = &STR(   )
07770003  PUTFILE SLSSOUT
07780003  SET SLSSOUT = &STR( &HDR3A&HDR3B)
07790003  PUTFILE SLSSOUT
07800003  SET SLSSOUT = &STR( &HDR4A&HDR4B)
07810003  PUTFILE SLSSOUT
07820003  SET LNCNT = 6
07830003  IF &PRTRTN = &STR(Y) THEN DO
07840003    SET SLSSOUT = &STR(&SAVELINE)
07850003    SET PRTRTN = &STR(N)
07860003    GOTO PRTLIN41
07870003  END DO
07880000LOOPTBL4: +
07890003  SET BYPASS = &STR(N)
07900003  SET SLSSOUT = &STR( )
07910003  ISPEXEC TBSKIP MAIN NUMBER(+1)
07920003  SET RC = &LASTCC
07930003  IF &RC = 8 THEN DO
07940003    ISPEXEC TBEND MAIN
07950003    WRITE ========================================
07960003    WRITE REPORT PROCESSING COMPLETE FOR MANUALS ON ORDER.
07970003    WRITE ========================================
07980003    GOTO ENDRPT
07990003  END DO
08000003  IF &RC ¬= 0 THEN DO
08010003    WRITE UNABLE TO PROCESS LIBRARY MAIN FOR REPORT.
08020003    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
08030003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
08040003    WRITE INFORMATION REGARDING THIS ERROR.
08050003    WRITE ========================================
08060003    ISPEXEC TBEND MAIN
08070003    GOTO ENDRPT
08080003  END DO
08090003  IF &STR(&ORDSTS) = &STR( ) THEN GOTO LOOPTBL4
08100003  SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
08110003  SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
08120003  SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
08130003  SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
08140003  SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
08150003  SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
08160003  SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
08170000SETLIN41: +
08180003  IF &STR(&R6) ¬= &STR( ) THEN DO
08190003    SET SLSSOUT = &STR(&CR   &R1   &R7   &R6)
08200003    GOTO PRTLIN41
08210003  END DO
08220003  GOTO LOOPTBL4
08230000PRTLIN41: +
08240003  IF &SLSSLINE = &STR(S) THEN DO
08250003    IF &LNCNT > &CHKMXS THEN DO
08260003      SET SAVELINE = &STR(&SLSSOUT)
08270003      SET PRTRTN = &STR(Y)
08280003      GOTO PRTHDR4
08290003    END DO
08300003  END DO
08310003  ELSE DO
08320003    IF &LNCNT > &CHKMXD THEN DO
08330003      SET SAVELINE = &STR(&SLSSOUT)
08340003      SET PRTRTN = &STR(Y)
08350003      GOTO PRTHDR4
08360003    END DO
08370003  END DO
08380003  PUTFILE SLSSOUT
08390003  IF &CR = &STR( ) THEN DO
08400003    SET LNCNT = &LNCNT + 1
08410003  END DO
08420003  ELSE DO
08430003    SET LNCNT = &LNCNT + 2
08440003  END DO
08450000SETLIN42: +
08460003  IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN4
08470003  SET R1 = &SUBSTR(1:9,&STR(&FS))
08480003  SET R2 = &SUBSTR(1:8,&STR(&FS))
08490003  SET R3 = &SUBSTR(1:1,&STR(&FS))
08500003  SET R4 = &SUBSTR(1:2,&STR(&FS))
08510003  SET R5 = &SUBSTR(1:2,&STR(&FS))
08520003  SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
08530003  SET R7 = &SUBSTR(1:8,&STR(&FS))
08540003  SET SLSSOUT = &STR(&CR   &R1   &R7   &R6)
08550003  GOTO PRTLIN42
08560000PRTLIN42: +
08570003  PUTFILE SLSSOUT
08580003  IF &CR = &STR( ) THEN DO
08590003    SET LNCNT = &LNCNT + 1
08600003  END DO
08610003  ELSE DO
08620003    SET LNCNT = &LNCNT + 2
08630003  END DO
08640000SETLIN43: +
08650003  IF &BYPASS = &STR(Y) THEN GOTO CHKLN4
08660003  IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN4
08670003  SET BYPASS = &STR(Y)
08680003  SET NAME2 = &STR(&NAME3)
08690003  SET NAME3 = &STR( )
08700003  GOTO SETLIN42
08710000CHKLN4: +
08720003  IF &LNCNT < &MAXLN THEN DO
08730003    GOTO LOOPTBL4
08740003  END DO
08750003  ELSE DO
08760003    GOTO PRTHDR4
08770003  END DO
08780000RPT5: +
08790003  IF &SLSSRPT ¬= &STR(5) THEN GOTO RPT6
08800003  SET SLSSPRNT = &STR(SLSSXICS)
08810008  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
08820008  ISPEXEC TBVCLEAR SLSSCNTL
08830008  SET CIBN = &STR(&SLSS)
08840008  ISPEXEC TBSARG SLSSCNTL
08850008  ISPEXEC TBSCAN SLSSCNTL
08860008  ISPEXEC TBEND SLSSCNTL
08870003  ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
08880003  SET RC = &LASTCC
08890003  IF &RC ¬= 0 THEN DO
08900003    WRITE UNABLE TO OPEN SELECTED LIBRARY, &SLSS.
08910003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
08920003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
08930003    WRITE INFORMATION REGARDING THIS ERROR.
08940003    WRITE ========================================
08950003    ISPEXEC TBEND &SLSS
08960003    GOTO ENDRPT
08970003  END DO
08980000SORT5: +
08990003  ISPEXEC TBSORT &SLSS FIELDS(BOOK,C,A,SLSSRTKY,C,A)
09000003  SET RC = &LASTCC
09010003  IF &RC ¬= 0 THEN DO
09020003    WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
09030003    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
09040003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
09050003    WRITE REGARDING THIS ERROR.
09060003    WRITE ========================================
09070003    ISPEXEC TBEND &SLSS
09080003    GOTO ENDRPT
09090003  END DO
09100003  SET SLSSOUT = &STR(<HYP,0,0,0>)
09110003  PUTFILE SLSSOUT
09120003  SET SLSSOUT = &STR(<FNT1=F,2,1/PT,11,12>)
09130003  PUTFILE SLSSOUT
09140003  SET SLSSOUT = &STR(<FNT2=F,2,1/PT,18,20>)
09150003  PUTFILE SLSSOUT
09160003  SET SLSSOUT = &STR(<#BIN1=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,180,34>>)
09170003  PUTFILE SLSSOUT
09180003  SET SLSSOUT = &STR(<#BIN2=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,354,208>>)
09190003  PUTFILE SLSSOUT
09200003  SET SLSSOUT = &STR(<#BIN3=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,528,382>>)
09210003  PUTFILE SLSSOUT
09220003  SET SLSSOUT = &STR(<#WIN1=<PD,542/PW,760/R,2,1/PT,11,0/SP,10/BOX,750,154,10,5,0,1,>>)
09230003  PUTFILE SLSSOUT
09240003  SET SLSSOUT = &STR(<#WIN2=<PD,542/PW,760/R,2,1/PT,11,0/SP,184/BOX,750,154,10,5,0,1,>>)
09250003  PUTFILE SLSSOUT
09260003  SET SLSSOUT = &STR(<#WIN3=<PD,542/PW,760/R,2,1/PT,11,0/SP,358/BOX,750,154,10,5,0,1,>>)
09270003  PUTFILE SLSSOUT
09280003  SET SLSSOUT = &STR(<#SID1=<FNT1/SP,1/QL,280,200>>)
09290003  PUTFILE SLSSOUT
09300003  SET SLSSOUT = &STR(<#SID2=<FNT1/NL/QL,280,200>>)
09310003  PUTFILE SLSSOUT
09320003  SET SLSSOUT = &STR(<#SID3=<FNT1/NL/QL,280,200>>)
09330003  PUTFILE SLSSOUT
09340003  SET SLSSOUT = &STR(<#SID4=<FNT1/NL/QL,280,200>>)
09350003  PUTFILE SLSSOUT
09360003  SET SLSSOUT = &STR(<#SID5=<FNT1/NL/QL,280,200>>)
09370003  PUTFILE SLSSOUT
09380003  SET SLSSOUT = &STR(<#SID6=<FNT1/NL/QL,280,200>>)
09390003  PUTFILE SLSSOUT
09400003  SET SLSSOUT = &STR(<#SID7=<FNT1/NL/QL,280,200>>)
09410003  PUTFILE SLSSOUT
09420003  SET SLSSOUT = &STR(<#SID8=<FNT1/NL/QL,280,200>>)
09430003  PUTFILE SLSSOUT
09440003  SET SLSSOUT = &STR(<#SID9=<FNT1/NL/QL,280,200>>)
09450003  PUTFILE SLSSOUT
09460003  SET SLSSOUT = &STR(<#SIDA =<FNT1/NL/QL,280,200>>)
09470003  PUTFILE SLSSOUT
09480003  SET SLSSOUT = &STR(<#SIDB=<FNT1/NL/QL,280,200>>)
09490003  PUTFILE SLSSOUT
09500003  SET SLSSOUT = &STR(<#SIDC=<FNT1/NL/QL,280,200>>)
09510003  PUTFILE SLSSOUT
09520003  SET SLSSOUT = &STR(<#TITL=<FNT1/QL,690,296>>)
09530003  PUTFILE SLSSOUT
09540003  ISPEXEC TBVCLEAR &SLSS
09550003  ISPEXEC TBSKIP &SLSS NUMBER(+1)
09560003  SET RC = &LASTCC
09570003  IF &RC = 8 THEN DO
09580003    ISPEXEC TBEND &SLSS
09590003    WRITE ========================================
09600003    WRITE BINDER LABEL PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
09610003    WRITE ========================================
09620003    GOTO SUBMIT1
09630003  END DO
09640003  IF &RC ¬= 0 THEN DO
09650003    WRITE UNABLE TO PROCESS SELECTED LIBRARY, &SLSS.
09660003    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
09670003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
09680003    WRITE INFORMATION REGARDING THIS ERROR.
09690003    WRITE ========================================
09700003    ISPEXEC TBEND &SLSS
09710003    GOTO ENDRPT
09720003  END DO
09730003  SET BINCNT = 1
09740003  SET SAVBOOK = &STR(&BOOK)
09750000XICSLOOP: +
09760003  DO WHILE &BINCNT < 4
09770003    SET LINCNT = 1
09780003    SET SID1 = &SUBSTR(1:12,&STR(&FS))
09790003    SET SID2 = &SUBSTR(1:12,&STR(&FS))
09800003    SET SID3 = &SUBSTR(1:12,&STR(&FS))
09810003    SET SID4 = &SUBSTR(1:12,&STR(&FS))
09820003    SET SID5 = &SUBSTR(1:12,&STR(&FS))
09830003    SET SID6 = &SUBSTR(1:12,&STR(&FS))
09840003    SET SID7 = &SUBSTR(1:12,&STR(&FS))
09850003    SET SID8 = &SUBSTR(1:12,&STR(&FS))
09860003    SET SID9 = &SUBSTR(1:12,&STR(&FS))
09870003    SET SIDA = &SUBSTR(1:12,&STR(&FS))
09880003    SET SIDB = &SUBSTR(1:12,&STR(&FS))
09890003    SET SIDC = &SUBSTR(1:12,&STR(&FS))
09900003    SET TIT1 = &SUBSTR(1:58,&STR(&FS))
09910003    SET TIT2 = &SUBSTR(1:58,&STR(&FS))
09920003    SET TIT3 = &SUBSTR(1:58,&STR(&FS))
09930003    SET TIT4 = &SUBSTR(1:58,&STR(&FS))
09940003    SET TIT5 = &SUBSTR(1:58,&STR(&FS))
09950003    SET TIT6 = &SUBSTR(1:58,&STR(&FS))
09960003    SET TIT7 = &SUBSTR(1:58,&STR(&FS))
09970003    SET TIT8 = &SUBSTR(1:58,&STR(&FS))
09980003    SET TIT9 = &SUBSTR(1:58,&STR(&FS))
09990003    SET TITA = &SUBSTR(1:58,&STR(&FS))
10000003    SET TITB = &SUBSTR(1:58,&STR(&FS))
10010003    SET TITC = &SUBSTR(1:58,&STR(&FS))
10020003    SET SLSSOUT = &STR(<SK> -------------------------------------------------------------)
10030003    PUTFILE SLSSOUT
10040003    SET SLSSOUT = &STR(<BIN&BINCNT>&BOOK                                                 )
10050003    PUTFILE SLSSOUT
10060003    DO WHILE &LINCNT < 13
10070003      IF &LINCNT = 1 THEN DO
10080019        SET SID6 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10090003        SET TIT6 = &SUBSTR(1:58,&STR(&NAME1&FS))
10100003      END DO
10110003      IF &LINCNT = 2 THEN DO
10120019        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10130003        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
10140003      END DO
10150003      IF &LINCNT = 3 THEN DO
10160019        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
10170003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
10180019        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
10190003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
10200019        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10210003        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
10220003      END DO
10230003      IF &LINCNT = 4 THEN DO
10240019        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10250003        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
10260003      END DO
10270003      IF &LINCNT = 5 THEN DO
10280019        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
10290003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
10300019        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
10310003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
10320019        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
10330003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
10340019        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
10350003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
10360019        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10370003        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
10380003      END DO
10390003      IF &LINCNT = 6 THEN DO
10400019        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10410003        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
10420003      END DO
10430003      IF &LINCNT = 7 THEN DO
10440019        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
10450003        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
10460019        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
10470003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
10480019        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
10490003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
10500019        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
10510003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
10520019        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
10530003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
10540019        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
10550003        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
10560019        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10570003        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
10580003      END DO
10590003      IF &LINCNT = 8 THEN DO
10600019        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10610003        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
10620003      END DO
10630003      IF &LINCNT = 9 THEN DO
10640019        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
10650003        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
10660019        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
10670003        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
10680019        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
10690003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
10700019        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
10710003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
10720019        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
10730003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
10740019        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
10750003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
10760019        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
10770003        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
10780019        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
10790003        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
10800019        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10810003        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
10820003      END DO
10830003      IF &LINCNT = 10 THEN DO
10840019        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
10850003        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
10860003      END DO
10870003      IF &LINCNT = 11 THEN DO
10880019        SET SID1 = &SUBSTR(1:12,&STR(&SID2&FS))
10890003        SET TIT1 = &SUBSTR(1:58,&STR(&TIT2&FS))
10900019        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
10910003        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
10920019        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
10930003        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
10940019        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
10950003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
10960019        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
10970003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
10980019        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
10990003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
11000019        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
11010003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
11020019        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
11030003        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
11040019        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
11050003        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
11060019        SET SIDA = &SUBSTR(1:12,&STR(&SIDB&FS))
11070003        SET TITA = &SUBSTR(1:58,&STR(&TITB&FS))
11080019        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
11090003        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
11100003      END DO
11110003      IF &LINCNT = 12 THEN DO
11120019        SET SIDC = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
11130003        SET TITC = &SUBSTR(1:58,&STR(&NAME1&FS))
11140003      END DO
11150003      SET LINCNT = &LINCNT + 1
11160003      IF &STR(&NAME2) ¬= &STR( ) THEN DO
11170003        SET SLSID = &SUBSTR(1:9,&STR(&FS))
11180003        SET SLSSVER = &SUBSTR(1:2,&STR(&FS))
11190003        SET NAME1 = &STR(&NAME2)
11200003        SET NAME2 = &STR( )
11210003      END DO
11220003      ELSE DO
11230003        ISPEXEC TBVCLEAR &SLSS
11240003        ISPEXEC TBSKIP &SLSS NUMBER(+1)
11250003        SET RC = &LASTCC
11260003        IF &RC = 8 THEN DO
11270003          ISPEXEC TBEND &SLSS
11280003          WRITE ========================================
11290003          WRITE BINDER LABEL PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
11300003          WRITE ========================================
11310003          GOTO SUBMIT1
11320003        END DO
11330003        IF &RC ¬= 0 THEN DO
11340003          WRITE UNABLE TO PROCESS SELECTED LIBRARY, &SLSS.
11350003          WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
11360003          WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
11370003          WRITE INFORMATION REGARDING THIS ERROR.
11380003          WRITE ========================================
11390003          ISPEXEC TBEND &SLSS
11400003          GOTO ENDRPT
11410003        END DO
11420003        IF &STR(&BOOK) ¬= &STR(&SAVBOOK) THEN DO
11430003          SET LINCNT = 13
11440003          SET SAVBOOK = &STR(&BOOK)
11450003        END DO
11460003      END DO
11470003    END DO
11480003    SET SLSSOUT = &STR(<WIN&BINCNT/SID1>&SID1<TITL>&TIT1)
11490003    PUTFILE SLSSOUT
11500003    SET SLSSOUT = &STR(<SID2>&SID2<TITL>&TIT2)
11510003    PUTFILE SLSSOUT
11520003    SET SLSSOUT = &STR(<SID3>&SID3<TITL>&TIT3)
11530003    PUTFILE SLSSOUT
11540003    SET SLSSOUT = &STR(<SID4>&SID4<TITL>&TIT4)
11550003    PUTFILE SLSSOUT
11560003    SET SLSSOUT = &STR(<SID5>&SID5<TITL>&TIT5)
11570003    PUTFILE SLSSOUT
11580003    SET SLSSOUT = &STR(<SID6>&SID6<TITL>&TIT6)
11590003    PUTFILE SLSSOUT
11600003    SET SLSSOUT = &STR(<SID7>&SID7<TITL>&TIT7)
11610003    PUTFILE SLSSOUT
11620003    SET SLSSOUT = &STR(<SID8>&SID8<TITL>&TIT8)
11630003    PUTFILE SLSSOUT
11640003    SET SLSSOUT = &STR(<SID9>&SID9<TITL>&TIT9)
11650003    PUTFILE SLSSOUT
11660003    SET SLSSOUT = &STR(<SIDA>&SIDA<TITL>&TITA)
11670003    PUTFILE SLSSOUT
11680003    SET SLSSOUT = &STR(<SIDB>&SIDB<TITL>&TITB)
11690003    PUTFILE SLSSOUT
11700003    SET SLSSOUT = &STR(<SIDC>&SIDC<TITL>&TITC)
11710003    PUTFILE SLSSOUT
11720003    SET BINCNT = &BINCNT + 1
11730003  END DO
11740003  SET SLSSOUT = &STR(<NP>)
11750003  PUTFILE SLSSOUT
11760003  SET BINCNT = 1
11770003  SET SAVBOOK = &STR(&BOOK)
11780003  GOTO XICSLOOP
11790000RPT6: +
11800003  IF &SLSSRPT ¬= &STR(6) THEN GOTO RPT7
11810003  SET SLSSPRNT = &STR(SLSSXICS)
11820008  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
11830008  ISPEXEC TBVCLEAR SLSSCNTL
11840008  SET CIBN = &STR(&SLSS)
11850008  ISPEXEC TBSARG SLSSCNTL
11860008  ISPEXEC TBSCAN SLSSCNTL
11870008  ISPEXEC TBEND SLSSCNTL
11880004  ISPEXEC TBOPEN BOOKIDS NOWRITE LIBRARY(SLSSTLIB)
11890004  SET RC = &LASTCC
11900004  IF &RC ¬= 0 THEN DO
11910004    WRITE UNABLE TO OPEN SELECTED LIBRARY, BOOKIDS.
11920004    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
11930004    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
11940004    WRITE INFORMATION REGARDING THIS ERROR.
11950004    WRITE ========================================
11960004    ISPEXEC TBEND BOOKIDS
11970004    GOTO ENDRPT
11980004  END DO
11990004  ISPEXEC TBVCLEAR BOOKIDS
12000004  ISPEXEC TBSKIP BOOKIDS NUMBER(+1)
12010004  SET RC = &LASTCC
12020004  IF &RC ¬= 0 THEN DO
12030004    WRITE UNABLE EXTRACT REQUESTED LABELS FROM BOOKIDS.
12040004    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
12050004    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
12060004    WRITE INFORMATION REGARDING THIS ERROR.
12070004    WRITE ========================================
12080004    ISPEXEC TBEND BOOKIDS
12090004    GOTO ENDRPT
12100004  END DO
12110003  ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
12120003  SET RC = &LASTCC
12130003  IF &RC ¬= 0 THEN DO
12140003    WRITE UNABLE TO OPEN SELECTED LIBRARY, &SLSS.
12150003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
12160003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
12170003    WRITE INFORMATION REGARDING THIS ERROR.
12180003    WRITE ========================================
12190003    ISPEXEC TBEND &SLSS
12200004    ISPEXEC TBEND BOOKIDS
12210003    GOTO ENDRPT
12220003  END DO
12230000SORT6: +
12240003  ISPEXEC TBSORT &SLSS FIELDS(BOOK,C,A,SLSSRTKY,C,A)
12250003  SET RC = &LASTCC
12260003  IF &RC ¬= 0 THEN DO
12270003    WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
12280003    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
12290003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
12300003    WRITE REGARDING THIS ERROR.
12310003    WRITE ========================================
12320003    ISPEXEC TBEND &SLSS
12330004    ISPEXEC TBEND BOOKIDS
12340003    GOTO ENDRPT
12350003  END DO
12360003  SET SLSSOUT = &STR(<HYP,0,0,0>)
12370003  PUTFILE SLSSOUT
12380003  SET SLSSOUT = &STR(<FNT1=F,2,1/PT,11,12>)
12390003  PUTFILE SLSSOUT
12400003  SET SLSSOUT = &STR(<FNT2=F,2,1/PT,18,20>)
12410003  PUTFILE SLSSOUT
12420003  SET SLSSOUT = &STR(<#BIN1=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,180,34>>)
12430003  PUTFILE SLSSOUT
12440003  SET SLSSOUT = &STR(<#BIN2=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,354,208>>)
12450003  PUTFILE SLSSOUT
12460003  SET SLSSOUT = &STR(<#BIN3=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,528,382>>)
12470003  PUTFILE SLSSOUT
12480003  SET SLSSOUT = &STR(<#WIN1=<PD,542/PW,760/R,2,1/PT,11,0/SP,10/BOX,750,154,10,5,0,1,>>)
12490003  PUTFILE SLSSOUT
12500003  SET SLSSOUT = &STR(<#WIN2=<PD,542/PW,760/R,2,1/PT,11,0/SP,184/BOX,750,154,10,5,0,1,>>)
12510003  PUTFILE SLSSOUT
12520003  SET SLSSOUT = &STR(<#WIN3=<PD,542/PW,760/R,2,1/PT,11,0/SP,358/BOX,750,154,10,5,0,1,>>)
12530003  PUTFILE SLSSOUT
12540003  SET SLSSOUT = &STR(<#SID1=<FNT1/SP,1/QL,280,200>>)
12550003  PUTFILE SLSSOUT
12560003  SET SLSSOUT = &STR(<#SID2=<FNT1/NL/QL,280,200>>)
12570003  PUTFILE SLSSOUT
12580003  SET SLSSOUT = &STR(<#SID3=<FNT1/NL/QL,280,200>>)
12590003  PUTFILE SLSSOUT
12600003  SET SLSSOUT = &STR(<#SID4=<FNT1/NL/QL,280,200>>)
12610003  PUTFILE SLSSOUT
12620003  SET SLSSOUT = &STR(<#SID5=<FNT1/NL/QL,280,200>>)
12630003  PUTFILE SLSSOUT
12640003  SET SLSSOUT = &STR(<#SID6=<FNT1/NL/QL,280,200>>)
12650003  PUTFILE SLSSOUT
12660003  SET SLSSOUT = &STR(<#SID7=<FNT1/NL/QL,280,200>>)
12670003  PUTFILE SLSSOUT
12680003  SET SLSSOUT = &STR(<#SID8=<FNT1/NL/QL,280,200>>)
12690003  PUTFILE SLSSOUT
12700003  SET SLSSOUT = &STR(<#SID9=<FNT1/NL/QL,280,200>>)
12710003  PUTFILE SLSSOUT
12720003  SET SLSSOUT = &STR(<#SIDA =<FNT1/NL/QL,280,200>>)
12730003  PUTFILE SLSSOUT
12740003  SET SLSSOUT = &STR(<#SIDB=<FNT1/NL/QL,280,200>>)
12750003  PUTFILE SLSSOUT
12760003  SET SLSSOUT = &STR(<#SIDC=<FNT1/NL/QL,280,200>>)
12770003  PUTFILE SLSSOUT
12780003  SET SLSSOUT = &STR(<#TITL=<FNT1/QL,690,296>>)
12790003  PUTFILE SLSSOUT
12800003  SET CNTR = 1
12810003  SET BINCNT = 1
12820000BOOKLOOP: +
12830003  DO WHILE &BINCNT < 4
12840003    ISPEXEC TBTOP &SLSS
12850003    ISPEXEC TBVCLEAR &SLSS
12860003    SET TEMP = &STR(&&BID&CNTR)
12870003    SET BOOK = &STR(&TEMP)
12880003    IF &STR(&BOOK) = &STR( ) THEN DO
12890003      ISPEXEC TBEND &SLSS
12900004      ISPEXEC TBEND BOOKIDS
12910003      WRITE ========================================
12920003      WRITE BINDER LABEL PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
12930003      WRITE ========================================
12940003      GOTO SUBMIT1
12950003    END DO
12960003    ISPEXEC TBSARG &SLSS
12970003    ISPEXEC TBSCAN &SLSS ROWID(ROW#) NEXT
12980003    SET RC = &LASTCC
12990003    IF &RC ¬= 0 THEN DO
13000003      WRITE UNABLE TO PRINT LABEL FOR SELECTED BINDER, &BOOK.
13010003      WRITE RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
13020003      WRITE WILL ATTEMPT TO PRINT OTHER SELECTIONS.
13030003      WRITE ========================================
13040003      SET CNTR = &CNTR + 1
13050003      GOTO BOOKLOOP
13060003    END DO
13070003    SET LINCNT = 1
13080003    SET SID1 = &SUBSTR(1:12,&STR(&FS))
13090003    SET SID2 = &SUBSTR(1:12,&STR(&FS))
13100003    SET SID3 = &SUBSTR(1:12,&STR(&FS))
13110003    SET SID4 = &SUBSTR(1:12,&STR(&FS))
13120003    SET SID5 = &SUBSTR(1:12,&STR(&FS))
13130003    SET SID6 = &SUBSTR(1:12,&STR(&FS))
13140003    SET SID7 = &SUBSTR(1:12,&STR(&FS))
13150003    SET SID8 = &SUBSTR(1:12,&STR(&FS))
13160003    SET SID9 = &SUBSTR(1:12,&STR(&FS))
13170003    SET SIDA = &SUBSTR(1:12,&STR(&FS))
13180003    SET SIDB = &SUBSTR(1:12,&STR(&FS))
13190003    SET SIDC = &SUBSTR(1:12,&STR(&FS))
13200003    SET TIT1 = &SUBSTR(1:58,&STR(&FS))
13210003    SET TIT2 = &SUBSTR(1:58,&STR(&FS))
13220003    SET TIT3 = &SUBSTR(1:58,&STR(&FS))
13230003    SET TIT4 = &SUBSTR(1:58,&STR(&FS))
13240003    SET TIT5 = &SUBSTR(1:58,&STR(&FS))
13250003    SET TIT6 = &SUBSTR(1:58,&STR(&FS))
13260003    SET TIT7 = &SUBSTR(1:58,&STR(&FS))
13270003    SET TIT8 = &SUBSTR(1:58,&STR(&FS))
13280003    SET TIT9 = &SUBSTR(1:58,&STR(&FS))
13290003    SET TITA = &SUBSTR(1:58,&STR(&FS))
13300003    SET TITB = &SUBSTR(1:58,&STR(&FS))
13310003    SET TITC = &SUBSTR(1:58,&STR(&FS))
13320003    SET SLSSOUT = &STR(<SK> -------------------------------------------------------------)
13330003    PUTFILE SLSSOUT
13340003    SET SLSSOUT = &STR(<BIN&BINCNT>&BOOK                                                 )
13350003    PUTFILE SLSSOUT
13360003    DO WHILE &LINCNT < 13
13370003      IF &LINCNT = 1 THEN DO
13380019        SET SID6 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13390003        SET TIT6 = &SUBSTR(1:58,&STR(&NAME1&FS))
13400003      END DO
13410003      IF &LINCNT = 2 THEN DO
13420019        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13430003        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
13440003      END DO
13450003      IF &LINCNT = 3 THEN DO
13460019        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
13470003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
13480019        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
13490003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
13500019        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13510003        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
13520003      END DO
13530003      IF &LINCNT = 4 THEN DO
13540019        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13550003        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
13560003      END DO
13570003      IF &LINCNT = 5 THEN DO
13580019        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
13590003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
13600019        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
13610003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
13620019        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
13630003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
13640019        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
13650003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
13660020        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13670003        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
13680003      END DO
13690003      IF &LINCNT = 6 THEN DO
13700020        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13710003        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
13720003      END DO
13730003      IF &LINCNT = 7 THEN DO
13740020        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
13750003        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
13760020        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
13770003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
13780020        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
13790003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
13800020        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
13810003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
13820020        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
13830003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
13840020        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
13850003        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
13860020        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13870003        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
13880003      END DO
13890003      IF &LINCNT = 8 THEN DO
13900020        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
13910003        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
13920003      END DO
13930003      IF &LINCNT = 9 THEN DO
13940020        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
13950003        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
13960020        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
13970003        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
13980020        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
13990003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
14000020        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
14010003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
14020020        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
14030003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
14040020        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
14050003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
14060020        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
14070003        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
14080020        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
14090003        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
14100020        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
14110003        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
14120003      END DO
14130003      IF &LINCNT = 10 THEN DO
14140020        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
14150003        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
14160003      END DO
14170003      IF &LINCNT = 11 THEN DO
14180020        SET SID1 = &SUBSTR(1:12,&STR(&SID2&FS))
14190003        SET TIT1 = &SUBSTR(1:58,&STR(&TIT2&FS))
14200020        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
14210003        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
14220020        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
14230003        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
14240020        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
14250003        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
14260020        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
14270003        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
14280020        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
14290003        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
14300020        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
14310003        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
14320020        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
14330003        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
14340020        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
14350003        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
14360020        SET SIDA = &SUBSTR(1:12,&STR(&SIDB&FS))
14370003        SET TITA = &SUBSTR(1:58,&STR(&TITB&FS))
14380020        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
14390003        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
14400003      END DO
14410003      IF &LINCNT = 12 THEN DO
14420020        SET SIDC = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
14430003        SET TITC = &SUBSTR(1:58,&STR(&NAME1&FS))
14440003      END DO
14450003      SET LINCNT = &LINCNT + 1
14460003      IF &STR(&NAME2) ¬= &STR( ) THEN DO
14470003        SET SLSID = &SUBSTR(1:9,&STR(&FS))
14480003        SET SLSSVER = &SUBSTR(1:2,&STR(&FS))
14490003        SET NAME1 = &STR(&NAME2)
14500003        SET NAME2 = &STR( )
14510003      END DO
14520003      ELSE DO
14530003        ISPEXEC TBVCLEAR &SLSS
14540003        ISPEXEC TBSKIP &SLSS ROW(&ROW#) NOREAD
14550003        SET BOOK = &STR(&TEMP)
14560003        ISPEXEC TBSARG &SLSS
14570003        ISPEXEC TBSCAN &SLSS ROWID(ROW#) NEXT
14580003        SET RC = &LASTCC
14590003        IF &RC = 8 THEN GOTO SETOUT
14600003        IF &RC ¬= 0 THEN DO
14610003          WRITE UNABLE TO PRINT LABEL FOR SELECTED BINDER, &BOOK.
14620003          WRITE RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
14630003          WRITE WILL ATTEMPT TO PRINT OTHER SELECTIONS.
14640003          WRITE ========================================
14650003          SET CNTR = &CNTR + 1
14660003          GOTO BOOKLOOP
14670003        END DO
14680003      END DO
14690003    END DO
14700000SETOUT: +
14710003    SET SLSSOUT = &STR(<WIN&BINCNT/SID1>&SID1<TITL>&TIT1)
14720003    PUTFILE SLSSOUT
14730003    SET SLSSOUT = &STR(<SID2>&SID2<TITL>&TIT2)
14740003    PUTFILE SLSSOUT
14750003    SET SLSSOUT = &STR(<SID3>&SID3<TITL>&TIT3)
14760003    PUTFILE SLSSOUT
14770003    SET SLSSOUT = &STR(<SID4>&SID4<TITL>&TIT4)
14780003    PUTFILE SLSSOUT
14790003    SET SLSSOUT = &STR(<SID5>&SID5<TITL>&TIT5)
14800003    PUTFILE SLSSOUT
14810003    SET SLSSOUT = &STR(<SID6>&SID6<TITL>&TIT6)
14820003    PUTFILE SLSSOUT
14830003    SET SLSSOUT = &STR(<SID7>&SID7<TITL>&TIT7)
14840003    PUTFILE SLSSOUT
14850003    SET SLSSOUT = &STR(<SID8>&SID8<TITL>&TIT8)
14860003    PUTFILE SLSSOUT
14870003    SET SLSSOUT = &STR(<SID9>&SID9<TITL>&TIT9)
14880003    PUTFILE SLSSOUT
14890003    SET SLSSOUT = &STR(<SIDA>&SIDA<TITL>&TITA)
14900003    PUTFILE SLSSOUT
14910003    SET SLSSOUT = &STR(<SIDB>&SIDB<TITL>&TITB)
14920003    PUTFILE SLSSOUT
14930003    SET SLSSOUT = &STR(<SIDC>&SIDC<TITL>&TITC)
14940003    PUTFILE SLSSOUT
14950003    SET BINCNT = &BINCNT + 1
14960003    SET CNTR = &CNTR + 1
14970003  END DO
14980003  SET SLSSOUT = &STR(<NP>)
14990003  PUTFILE SLSSOUT
15000003  SET BINCNT = 1
15010003  GOTO BOOKLOOP
15020000RPT7: +
15030003  IF &SLSSRPT ¬= &STR(7) THEN GOTO ENDRPT
15040003  SET SLSSPRNT = &STR(SLSSLOCS)
15050003  ISPEXEC TBOPEN MAIN NOWRITE LIBRARY(SLSSTLIB)
15060003  SET RC = &LASTCC
15070003  IF &RC ¬= 0 THEN DO
15080003    WRITE UNABLE TO OPEN COMPLETE LIBRARY, MAIN.
15090003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
15100003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
15110003    WRITE INFORMATION REGARDING THIS ERROR.
15120003    WRITE ========================================
15130003    ISPEXEC TBEND MAIN
15140003    GOTO ENDRPT
15150003  END DO
15160003  ISPEXEC TBOPEN MAINLOCS NOWRITE LIBRARY(SLSSTLIB)
15170003  SET RC = &LASTCC
15180003  IF &RC ¬= 0 THEN DO
15190003    WRITE UNABLE TO OPEN LOCATION LIBRARY, MAINLOCS.
15200003    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
15210003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
15220003    WRITE INFORMATION REGARDING THIS ERROR.
15230003    WRITE ========================================
15240003    ISPEXEC TBEND MAIN
15250003    ISPEXEC TBEND MAINLOCS
15260003    GOTO ENDRPT
15270003  END DO
15280000SORT7: +
15290003  ISPEXEC TBSORT MAIN FIELDS(SLSSRTKY,C,A)
15300003  SET RC = &LASTCC
15310003  IF &RC ¬= 0 THEN DO
15320003    WRITE UNABLE TO PROCESS LIBRARY, MAIN, FOR SORT.
15330003    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
15340003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
15350003    WRITE REGARDING THIS ERROR.
15360003    WRITE ========================================
15370003    ISPEXEC TBEND MAIN
15380003    ISPEXEC TBEND MAINLOCS
15390003    GOTO ENDRPT
15400003  END DO
15410003  ISPEXEC TBTOP MAIN
15420000LOOPTBL7: +
15430003  ISPEXEC TBSKIP MAIN NUMBER(+1)
15440003  SET RC = &LASTCC
15450003  IF &RC = 8 THEN DO
15460003    ISPEXEC TBEND MAIN
15470003    ISPEXEC TBEND MAINLOCS
15480003    WRITE ========================================
15490003    WRITE REPORT PROCESSING COMPLETE MANUALS BY LOCATION.
15500003    WRITE ========================================
15510003    GOTO SUBMIT1
15520003  END DO
15530003  IF &RC ¬= 0 THEN DO
15540003    WRITE UNABLE TO PROCESS LIBRARY MAIN FOR REPORT.
15550003    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
15560003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
15570003    WRITE INFORMATION REGARDING THIS ERROR.
15580003    WRITE ========================================
15590003    ISPEXEC TBEND MAIN
15600003    ISPEXEC TBEND MAINLOCS
15610003    GOTO ENDRPT
15620003  END DO
15630003  ISPEXEC TBTOP MAINLOCS
15640003  ISPEXEC TBVCLEAR MAINLOCS
15650003  SET LOCID = &STR(MAIN&SLSID)
15660003  ISPEXEC TBSARG MAINLOCS
15670003  ISPEXEC TBSCAN MAINLOCS
15680003  SET RC = &LASTCC
15690003  IF &RC > 8 THEN DO
15700003    WRITE &STR(UNABLE TO PROCESS LOCATION LIBRARY FOR ''&SLSID''.)
15710003    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
15720003    WRITE PROCESS WILL CONTINUE FOR REMAINING MANUALS.
15730003    WRITE ========================================
15740003    GOTO LOOPTBL7
15750003  END DO
15760003  SET CNTR = 1
15770003  DO WHILE &CNTR < 61
15780003    SET TEMP = &STR(&&LOC&CNTR)
15790003    SET LOCATN = &STR(&TEMP)
15800003    IF &STR(&LOCATN) = &STR( ) THEN DO
15810003      SET CNTR = 61
15820003    END DO
15830003    ELSE DO
15840003      SET &SLSSOUT = &STR(&FS)
15850003      SET R1 = &SUBSTR(1:8,&STR(&LOCATN&FS))
15860003      SET R2 = &SUBSTR(1:9,&STR(&SLSID&FS))
15870003      SET R3 = &SUBSTR(1:60,&STR(&NAME1&FS))
15880003      SET &SLSSOUT = &STR(&R1 &R2 &R3)
15890003      PUTFILE SLSSOUT
15900003      SET CNTR = &CNTR + 1
15910003    END DO
15920003  END DO
15930003  GOTO LOOPTBL7
15940000SUBMIT1: +
15950003  CLOSFILE SLSSOUT
15960003  FREE F(SLSSOUT)
15970003  ISPEXEC TBEND  SLSSPROF
15980003  ISPEXEC TBOPEN SLSSPROF
15990003  SET RC = &LASTCC
16000003  IF &RC ¬= 0 THEN DO
16010003    WRITE UNABLE TO OPEN YOUR SLSS PROFILE.
16020003    WRITE RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
16030003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
16040003    WRITE REGARDING THIS ERROR.
16050003    WRITE ========================================
16060010    GOTO ENDRPT
16070003  END DO
16080003  ISPEXEC TBTOP SLSSPROF
16090003  ISPEXEC TBVCLEAR SLSSPROF
16100003  SET SLSSUSR = &STR(&SYSUID)
16110003  ISPEXEC TBSKIP SLSSPROF
16120003  SET SKIPRC = &LASTCC
16130003  IF &SKIPRC ¬= 0 THEN DO
16140003    WRITE UNABLE TO OBTAIN INFORMATION FROM YOUR SLSS PROFILE.
16150003    WRITE RETURN CODE FOR 'ISPEXEC TBSKIP' WAS &SKIPRC..
16160003    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
16170003    WRITE REGARDING THIS ERROR.
16180003    WRITE ========================================
16190010    GOTO ENDRPT
16200003  END DO
16210000SUBMIT2: +
16220003  SET SLSSINDX = &SLSSINDX + 1
16230003  IF &SLSSINDX = 27 THEN SET SLSSINDX = 1
16240020  SET TEMPNAME = &STR(//&SLSSUSR.&SUBSTR(&SLSSINDX:&SLSSINDX,&STR(ABCDEFGHIJKLMNOPQRSTUVWXYZ&FS)))
16250003  SET TEMPLEN = &LENGTH(&STR(&SLSSJOB1))
16260020  SET SLSSJOB1 = &STR(&TEMPNAME.&SUBSTR(10:&TEMPLEN,&SLSSJOB1&FS))
16270003  ISPEXEC TBPUT SLSSPROF
16280003  ISPEXEC TBCLOSE SLSSPROF
16290003  ISPEXEC VPUT (SLSSJOB1 SLSSJOB2 SLSSJOB3 SLSSJOB4 SLSSDSN SLSSRPT SLSSPRT SLSSLINE SLSSFORM)
16300016  SET TIME = &STR(&SYSTIME)
16310020  SET HOUR = &SUBSTR(1:2,&TIME&FS)
16320020  SET MIN = &SUBSTR(4:5,&TIME&FS)
16330020  SET SEC = &SUBSTR(7:8,&TIME&FS)
16340017  SET SLSSFT = &STR(&SLSSUSR..T&HOUR&MIN&SEC..TEMPFT)
16350017  ALLOC F(ISPFILE) DA(&SLSSFT) NEW CATALOG SPACE(1 1) CYLINDER LRECL(80) BLKSIZE(3120) RECFM(F B) DSORG(PS)
16360013  ISPEXEC FTOPEN
16370003  ISPEXEC FTINCL &SLSSPRNT
16380003  ISPEXEC FTCLOSE
16390017  SUBMIT '&SLSSFT'
16400017  DELETE &SLSSFT
16410003  EXIT CODE(00)
16420000ENDRPT: +
16430003  CLOSFILE SLSSOUT
16440003  FREE F(SLSSOUT)
16450003  EXIT CODE(00)
