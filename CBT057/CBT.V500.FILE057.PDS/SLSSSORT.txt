00010000PROC 0
00020016    ISPEXEC VGET (DEBUG SLSS CHGFLG CIBSRTKY CIBOWNER) SHARED
00030000    IF &DEBUG = DEBUG THEN DO
00040000        CONTROL MSG LIST CONLIST SYMLIST
00050000    END DO
00060000    ELSE DO
00070000        CONTROL NOMSG NOLIST NOCONLIST NOSYMLIST
00080000    END DO
00090014BEGIN: +
00100015    ISPEXEC CONTROL ERRORS RETURN
00110015    ISPEXEC TBOPEN &SLSS LIBRARY(SLSSTLIB)
00120014    SET RC = &LASTCC
00130014    IF &RC = 12 THEN DO
00140014      SET SLSSERR1 = ENQ FAILED; &SLSS IN USE BY ANOTHER USER.
00150014      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC..
00160014      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00170014      SET SLSSERR4 = REGARDING THIS ERROR.
00180014      SET SLSSERR5 =
00190014      SET SLSSERRX = PRESS ENTER TO CONTINUE.
00200014      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00210014      ISPEXEC TBEND &SLSS
00220014      EXIT
00230014    END DO
00240014    IF &RC ¬= 0 THEN DO
00250014      SET SLSSERR1 = UNABLE TO OPEN TABLE FOR LIBRARY, &SLSS..
00260014      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC..
00270014      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00280014      SET SLSSERR4 = REGARDING THIS ERROR.
00290014      SET SLSSERR5 =
00300014      SET SLSSERRX = PRESS ENTER TO CONTINUE.
00310014      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00320014      ISPEXEC TBEND &SLSS
00330014      EXIT
00340014    END DO
00350000DISPLAY: +
00360000    ISPEXEC DISPLAY PANEL(SLSSSORT)
00370007    SET RC = &LASTCC
00380014    IF &RC = 8 THEN DO
00390014      ISPEXEC TBEND &SLSS
00400014      EXIT
00410014    END DO
00420007    IF &RC > 4 THEN DO
00430014      SET SLSSERR1 = UNABLE TO DISPLAY SORT SELECTION PANEL.
00440014      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC DISPLAY' WAS &RC..
00450014      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00460014      SET SLSSERR4 = REGARDING THIS ERROR.
00470014      SET SLSSERR5 =
00480014      SET SLSSERRX = PRESS ENTER TO CONTINUE.
00490007      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00500014      ISPEXEC TBEND &SLSS
00510007      EXIT
00520000    END DO
00530014    SET SLSSPRC1 =
00540014    SET SLSSPRC2 = &STR(                  SORTING)
00550014    SET SLSSPRC3 = &STR( )
00560014    SET SLSSPRC4 = &STR(                LIBRARY &SLSS)
00570014    SET SLSSPRC5 =
00580014    SET SLSSPRCX =
00590001    ISPEXEC CONTROL DISPLAY LOCK
00600001    ISPEXEC DISPLAY PANEL(SLSS@PRC)
00610001GETFIELD: +
00620018    IF &STR(&SRTKY) = B THEN +
00630017        SET FIELD = &STR(BOOK)
00640019    IF &STR(&SRTKY) = M THEN +
00650019        SET FIELD = &STR(SLSSRTKY)
00660017    IF &STR(&SRTKY) = T THEN +
00670017        SET FIELD = &STR(NAME1)
00680017SORT: +
00690017    ISPEXEC TBSORT &SLSS FIELDS(&FIELD,C,A)
00700014    SET RC = &LASTCC
00710014    IF &RC = 0 THEN GOTO CLOSLIB1
00720001    IF &RC ¬= 0 THEN DO
00730014      SET SLSSERR1 = UNABLE TO PROCESS LIBRARY FOR SORT.
00740014      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
00750014      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00760014      SET SLSSERR4 = REGARDING THIS ERROR.
00770014      SET SLSSERR5 =
00780014      SET SLSSERRX = PRESS ENTER TO CONTINUE.
00790000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00800014      ISPEXEC TBEND &SLSS
00810000      EXIT
00820000    END DO
00830014CLOSLIB1: +
00840010    ISPEXEC TBCLOSE &SLSS LIBRARY(SLSSTLIB)
00850014    SET RC = &LASTCC
00860001    IF &RC ¬= 0 THEN DO
00870014      SET SLSSERR1 = UNABLE TO PROCESS LIBRARY FOR SORT.
00880014      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBCLOSE' WAS &RC..
00890014      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00900014      SET SLSSERR4 = REGARDING THIS ERROR.
00910014      SET SLSSERR5 =
00920014      SET SLSSERRX = PRESS ENTER TO CONTINUE.
00930001      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00940001      ISPEXEC TBEND &SLSS
00950001      EXIT
00960001    END DO
00970014    SET SLSSPRC1 =
00980014    SET SLSSPRC2 = &STR(                SORT COMPLETED)
00990014    SET SLSSPRC3 =
01000014    SET SLSSPRC4 =
01010014    SET SLSSPRC5 =
01020014    SET SLSSPRCX =PRESS ENTER TO CONTINUE.
01030001    ISPEXEC DISPLAY PANEL(SLSS@PRC)
01040014TBLUPDT1: +
01050016    ISPEXEC TBOPEN SLSSCNTL LIBRARY(SLSSTLIB)
01060014    SET RC = &LASTCC
01070014    IF &RC ¬= 0 THEN DO
01080014      SET SLSSERR1 = UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
01090014      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
01100014      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01110014      SET SLSSERR4 = REGARDING THIS ERROR.
01120014      SET SLSSERR5 =
01130014      SET SLSSERRX = PRESS ENTER TO CONTINUE
01140014      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01150014      ISPEXEC TBEND SLSSCNTL
01160014      ISPEXEC VPUT (CHGFLG) SHARED
01170014      EXIT
01180014    END DO
01190016    ISPEXEC TBVCLEAR SLSSCNTL
01200016    SET CIBN = &STR(&SLSS)
01210016    ISPEXEC TBGET SLSSCNTL
01220014    SET RC = &LASTCC
01230008    IF &RC ¬= 0 THEN DO
01240014      SET SLSSERR1 = UNABLE TO UPDATE CONTROL FILE, SLSSCNTL.
01250008      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBGET' WAS &RC..
01260008      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01270008      SET SLSSERR4 = REGARDING THIS ERROR.
01280008      SET SLSSERR5 =
01290008      SET SLSSERRX = PRESS ENTER TO CONTINUE
01300008      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01310008      ISPEXEC TBEND SLSSCNTL
01320008      ISPEXEC VPUT (CHGFLG) SHARED
01330008      EXIT
01340008    END DO
01350008    ISPEXEC VGET (ZJDATE ZMONTH ZDAY ZYEAR)
01360016    SET CIBJDATE = &STR(&ZJDATE)
01370016    SET CIBTIME  = &STR(&SYSSTIME)
01380016    SET CIBMDATE = &STR(&ZMONTH/&ZDAY/&ZYEAR)
01390016    SET CIBUPDTE = &STR(Y)
01400016    SET CIBSRTKY = &STR(&SRTKY)
01410007    SET CHGFLG = &STR(Y)
01420014TBLUPDT2: +
01430016    ISPEXEC TBPUT SLSSCNTL
01440006    IF &RC ¬= 0 THEN DO
01450014      SET SLSSERR1 = UNABLE TO UPDATE CONTROL FILE, SLSSCNTL.
01460008      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBPUT' WAS &RC..
01470006      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01480006      SET SLSSERR4 = REGARDING THIS ERROR.
01490006      SET SLSSERR5 =
01500006      SET SLSSERRX = PRESS ENTER TO CONTINUE
01510006      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01520006      ISPEXEC TBEND SLSSCNTL
01530006      ISPEXEC VPUT (CHGFLG) SHARED
01540006    END DO
01550014CLOSLIB2: +
01560014    ISPEXEC TBCLOSE SLSSCNTL LIBRARY(SLSSTLIB)
01570014    SET RC = &LASTCC
01580014    IF &RC ¬= 0 THEN DO
01590014      SET SLSSERR1 = UNABLE TO CLOSE CONTROL FILE, SLSSCNTL.
01600014      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBCLOSE' WAS &RC..
01610014      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01620014      SET SLSSERR4 = REGARDING THIS ERROR.
01630014      SET SLSSERR5 =
01640014      SET SLSSERRX = PRESS ENTER TO CONTINUE.
01650014      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01660014      ISPEXEC TBEND SLSSCNTL
01670014      EXIT
01680014    END DO
01690009    ISPEXEC VPUT (CHGFLG) SHARED
01700001    EXIT
