00010003PROC 1 ENQFLAG
00020001  ISPEXEC VGET (SLSS DEBUG) SHARED
00030000  IF &DEBUG = &STR(DEBUG) THEN DO
00040000      CONTROL MSG NOFLUSH LIST CONLIST SYMLIST PROMPT
00050000  END DO
00060000  ELSE DO
00070000      CONTROL NOMSG NOFLUSH NOLIST NOCONLIST NOSYMLIST
00080000  END DO
00090006  ISPEXEC CONTROL ERRORS RETURN
00100013  IF &STR(&ENQFLAG) = &STR(ENQOFF) THEN GOTO ENQOFF
00110003ENQON: +
00120001  ISPEXEC TBOPEN &SLSS.ENQ LIBRARY(SLSSTLIB)
00130013  SET RC = &LASTCC
00140011  IF &RC = 8 THEN DO
00150011    EXIT CODE(00)
00160011  END DO
00170010  IF &RC ¬= 0 THEN DO
00180013    SET SLSSERR1 = UNABLE TO CHECK ENQUEUE ON LIBRARY &SLSS..
00190013    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC..
00200013    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
00210013    SET SLSSERR4 = INFORMATION REGARDING THIS ERROR.
00220013    SET SLSSERR5 =
00230013    SET SLSSERRX = PRESS ENTER TO CONTINUE
00240001    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00250001    ISPEXEC TBEND &SLSS.ENQ
00260002    EXIT CODE(20)
00270001  END DO
00280001  ISPEXEC TBSKIP &SLSS.ENQ NUMBER(+1)
00290013  IF &STR(&ENQU) = &STR(&SYSUID) THEN DO
00300001    ISPEXEC TBEND &SLSS.ENQ
00310002    EXIT CODE(00)
00320001  END DO
00330014  IF &STR(&ENQU) = &STR(ENQALL) THEN DO
00340013    SET SLSSERR1 = ALL LIBRARIES ARE UNAVAILABLE DUE TO COMPRESS
00350013    SET SLSSERR2 = OR SUB LIBRARY BUILD FUNCTION.
00360013    SET SLSSERR3 = PLEASE TRY PROCESS AT A LATER TIME.
00370013    SET SLSSERR4 =
00380013    SET SLSSERR5 =
00390013    SET SLSSERRX = PRESS ENTER TO CONTINUE
00400001    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00410001    ISPEXEC TBEND &SLSS.ENQ
00420002    EXIT CODE(20)
00430001  END DO
00440014  IF &STR(&ENQU) ¬= &STR(   ) AND &STR(&ENQFLAG) = &STR(ENQTALL) THEN DO
00450014    ISPEXEC TBEND &SLSS.ENQ
00460014    EXIT CODE(00)
00470014  END DO
00480013  IF &STR(&ENQU) ¬= &STR(    ) THEN DO
00490013    SET SLSSERR1 = SELECTED LIBRARY IS CURRENTLY BEING UPDATED BY
00500013    SET SLSSERR2 = USER '&ENQU'.  PLEASE TRY PROCESS AT A LATER
00510013    SET SLSSERR3 = TIME.
00520013    SET SLSSERR4 =
00530013    SET SLSSERR5 =
00540013    SET SLSSERRX = PRESS ENTER TO CONTINUE
00550008    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00560008    ISPEXEC TBEND &SLSS.ENQ
00570008    EXIT CODE(20)
00580008  END DO
00590001  ELSE DO
00600013    IF &STR(&ENQFLAG) = &STR(ENQTEST) OR &STR(&ENQFLAG) = &STR(ENQTALL) THEN DO
00610009      ISPEXEC TBEND &SLSS.ENQ
00620009      EXIT CODE(00)
00630009    END DO
00640013    IF &STR(&ENQFLAG) = &STR(ENQON) THEN DO
00650013      SET ENQU = &SYSUID
00660009    END DO
00670013    IF &STR(&ENQFLAG) = &STR(ENQALL) THEN DO
00680013      SET ENQU = &STR(ENQALL)
00690009    END DO
00700007    ISPEXEC TBPUT &SLSS.ENQ
00710007    ISPEXEC TBCLOSE &SLSS.ENQ LIBRARY(SLSSTLIB)
00720009    EXIT CODE(00)
00730004  END DO
00740003ENQOFF: +
00750013  SET MOD = &STR(Y)
00760003  ISPEXEC VPUT (MOD) SHARED
00770003  ISPEXEC TBOPEN &SLSS.ENQ LIBRARY(SLSSTLIB)
00780013  SET RC = &LASTCC
00790003  IF &RC ¬= 0 THEN DO
00800013    SET SLSSERR1 = UNABLE TO REMOVE ENQUEUE ON LIBRARY &SLSS..
00810013    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC..
00820013    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
00830013    SET SLSSERR4 = INFORMATION REGARDING THIS ERROR.
00840013    SET SLSSERR5 =
00850013    SET SLSSERRX = PRESS ENTER TO CONTINUE
00860003    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00870003    ISPEXEC TBEND &SLSS.ENQ
00880003    EXIT CODE(20)
00890003  END DO
00900005  ISPEXEC TBSKIP &SLSS.ENQ NUMBER(+1)
00910013  IF &STR(&ENQFLAG) = &STR(ENQOFF) THEN DO
00920013    SET ENQU = &STR(    )
00930007  END DO
00940003  ISPEXEC TBPUT &SLSS.ENQ
00950003  ISPEXEC TBCLOSE &SLSS.ENQ LIBRARY(SLSSTLIB)
00960003  EXIT CODE(00)
