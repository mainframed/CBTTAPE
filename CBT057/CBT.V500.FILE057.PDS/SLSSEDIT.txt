00010000PROC 0
00020000    ISPEXEC VGET (DEBUG SLSS CIBSRTKY CIBNUMBR LIBADMIN CIBOWNER CHGFLG) SHARED
00030000    IF &DEBUG = DEBUG THEN DO
00040000        CONTROL MSG LIST CONLIST SYMLIST
00050000    END DO
00060000    ELSE DO
00070000        CONTROL NOMSG
00080000    END DO
00090000    SET SELECT   = &STR( )
00100000    SET FUNC     = &STR( )
00110000    SET MOD      = &STR(N)
00120000    SET LOCSOPEN = &STR(N)
00130000PROCESS: +
00140000    ISPEXEC CONTROL ERRORS RETURN
00150000    ISPEXEC TBOPEN &SLSS LIBRARY(SLSSTLIB)
00160000    SET RC = &LASTCC
00170000    IF &RC = 12 THEN DO
00180000      SET SLSSERR1 = LIBRARY IS CURRENTLY OPEN FOR EDIT BY ANOTHER
00190000      SET SLSSERR2 = USER.  PLEASE TRY PROCESS AT A LATER TIME.
00200000      SET SLSSERR3 =
00210000      SET SLSSERR4 =
00220000      SET SLSSERR5 =
00230000      SET SLSSERRX = PRESS ENTER TO CONTINUE
00240000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00250000      ISPEXEC TBEND &SLSS
00260000      EXIT
00270000    END DO
00280000    IF &RC = 8 THEN DO
00290000      SET SLSSERR1 = REQUESTED LIBRARY, &SLSS,  DOES NOT EXIST.
00300000      SET SLSSERR2 = CONTACT LIBRARY ADMINISTRATOR, &LIBADMIN
00310000      SET SLSSERR3 = FOR FURTHER INFORMATION REGARDING THIS ERROR.
00320000      SET SLSSERR4 =
00330000      SET SLSSERR5 =
00340000      SET SLSSERRX = PRESS ENTER TO CONTINUE
00350000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00360000      ISPEXEC TBEND &SLSS
00370000      EXIT
00380000    END DO
00390000    IF &RC ¬= 0 THEN DO
00400000      SET SLSSERR1 = ERROR OPENING LIBRARY &SLSS.
00410000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC.
00420000      SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
00430000      SET SLSSERR4 = CONCERNING THIS ERROR.
00440000      SET SLSSERR5 =
00450000      SET SLSSERRX = PRESS ENTER TO CONTINUE
00460000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
00470000      ISPEXEC TBEND &SLSS
00480000      EXIT
00490000    END DO
00500000    ISPEXEC VPUT (SLSS DEBUG) SHARED
00510000    %SLSSENQ ENQON
00520000    SET RC = &LASTCC
00530000    IF &RC ¬= 0 THEN DO
00540000      ISPEXEC TBEND &SLSS
00550000      EXIT
00560000    END DO
00570000    GOTO SHOWIT
00580000SHOWIT: +
00590000    IF &FUNC = A THEN GOTO ADD
00600000    SET CREATE =
00610000    ISPEXEC CONTROL DISPLAY REFRESH
00620000    ISPEXEC TBDISPL &SLSS PANEL(SLSS)
00630000    SET LCC = &LASTCC
00640000    SET ADDMSG = &STR(  )
00650000    IF &LCC = 0 THEN GOTO TESTOPT
00660000    IF &LCC = 4 THEN GOTO UPDATE
00670000    IF &LCC = 8 THEN GOTO CLOSE
00680000    SET SLSSERR1 = UNABLE TO DISPLAY REQUESTED LIBRARY.
00690000    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBDISPL' WAS &LCC.
00700000    SET SLSSERR3 =
00710000    SET SLSSERR4 =
00720000    SET SLSSERR5 =
00730000    SET SLSSERRX = PRESS ENTER TO CONTINUE
00740000    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00750000    GOTO CLOSE
00760000TESTOPT:  +
00770000    IF &STR(&OPT) = C THEN GOTO EXIT
00780000    IF &STR(&OPT) = A THEN GOTO ADDS
00790000    IF &STR(&OPT) = SAVE THEN GOTO SAVEIT
00800000    IF &SELECT = D THEN GOTO DELETE
00810000    IF &SELECT = S THEN GOTO REFRESH
00820000    IF &STR(&OPT) = THEN GOTO SHOWIT
00830000    ISPEXEC TBVCLEAR &SLSS
00840000    SET SLSID = &STR(&OPT.*)
00850000    ISPEXEC TBSARG &SLSS
00860000    ISPEXEC TBSCAN &SLSS
00870000    SET LCC = &LASTCC
00880000    IF &LCC = 0 THEN GOTO SHOWIT
00890000    IF &LCC = 8 THEN DO
00900000      SET SLSSCAU1 = &STR(ENTRY '&SLSID' NOT FOUND IN LIBRARY)
00910000      SET SLSSCAU2 =
00920000      SET SLSSCAU3 =
00930000      SET SLSSCAU4 =
00940000      SET SLSSCAU5 =
00950000      SET SLSSCAUX = PRESS ENTER TO CONTINUE
00960000      ISPEXEC DISPLAY PANEL(SLSS@CAU)
00970000    END DO
00980000    GOTO SHOWIT
00990000SAVEIT:  +
01000000    ISPEXEC TBSAVE &SLSS PAD(30) LIBRARY(SLSSTLIB)
01010000    SET CHGFLG = &STR(Y)
01020000    GOTO REFRESH
01030000ADDS:  +
01040000    ISPEXEC TBVCLEAR &SLSS
01050000ADD:     +
01060000    ISPEXEC DISPLAY PANEL(SLSSADD)
01070000    IF &LASTCC > 0 THEN GOTO NOADD
01080000    ISPEXEC VPUT (NAME1 NAME2 NAME3)
01090000    ISPEXEC SELECT PGM(SLSSVEFY)
01100000    ISPEXEC VGET (NAME1 NAME2 NAME3)
01110000    IF &STR(&SLSID) = &STR( ) THEN GOTO ADD
01120000    SET SLSSVER = &SUBSTR(1:2,&STR(&SLSSVER   ))
01130000    SET SLSID = &SUBSTR(1:9,&STR(&SLSID            ))
01140000    SET SLSSRTKY = &SUBSTR(2:9,&STR(&SLSID            ))
01150000    IF &STR(&DATEORD) = &STR( ) THEN DO
01160000        SET DATEORD = &STR(        )
01170000        SET ORDSTS  = &STR( )
01180000    END DO
01190000    ELSE DO
01200000        SET ORDSTS  = &STR(*)
01210000    END DO
01220000    IF &STR(&DATERECV) = &STR( ) THEN DO
01230000        SET DATERECV = &STR(        )
01240000    END DO
01250000    SET CRETWHO = &SYSUID
01260000    SET CRETDAT = &STR(&SYSDATE)
01270000    SET CRETTIM = &STR(&SYSSTIME)
01280000    SET LSTUWHO = &STR(  )
01290000    SET LSTUDAT = &STR(  )
01300000    SET LSTUTIM = &STR(  )
01310000    ISPEXEC TBADD &SLSS
01320000    SET RC = &LASTCC
01330000    IF &RC = 0 THEN DO
01340000      SET ADDMSG = &STR(ENTRY &SLSID ADDED)
01350000      SET MOD = &STR(Y)
01360000      SET CHGFLG = &STR(Y)
01370000    END DO
01380000    IF &RC = 8 THEN DO
01390000      SET SLSSERR1 = &STR(ENTRY &SLSID ALREADY EXISTS.)
01400000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBADD' WAS &RC.
01410000      SET SLSSERR3 =
01420000      SET SLSSERR4 =
01430000      SET SLSSERR5 =
01440000      SET SLSSERRX = PRESS ENTER TO CONTINUE
01450000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01460000      GOTO ADD
01470000    END DO
01480000    IF &RC ¬= 0 THEN DO
01490000      SET SLSSERR1 = UNABLE TO COMPLETE REQUESTED FUNCTION.
01500000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBADD' WAS &RC.
01510000      SET SLSSERR3 = PLEASE TRY PROCESS AGAIN.
01520000      SET SLSSERR4 =
01530000      SET SLSSERR5 =
01540000      SET SLSSERRX = PRESS ENTER TO CONTINUE
01550000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01560000      GOTO ADD
01570000    END DO
01580000    IF &SELECT = R THEN GOTO SHOWIT
01590000    IF &LOCS = Y THEN GOTO PROCLOCS
01600000    ISPEXEC TBOPEN MAIN WRITE LIBRARY(SLSSTLIB)
01610000    SET RC = &LASTCC
01620000    IF &RC ¬= 0 THEN DO
01630000      SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, MAIN)
01640000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
01650000      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01660000      SET SLSSERR4 = REGARDING THIS ERROR.
01670000      SET SLSSERR5 =
01680000      SET SLSSERRX = PRESS ENTER TO CONTINUE
01690000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01700000    END DO
01710000    ELSE DO
01720000      ISPEXEC TBMOD MAIN ORDER
01730000      ISPEXEC TBCLOSE MAIN LIBRARY(SLSSTLIB)
01740000    END DO
01750000    GOTO ADD
01760000NOADD:  +
01770000    SET FUNC = D
01780000    GOTO SHOWIT
01790000DELETE:  +
01800000    SET ADDMSG = &STR(    )
01810000    SET SLSSPRC1 = &STR(CONFIRM REQUEST TO DELETE ENTRY &SLSID.)
01820000    SET SLSSPRC2 =
01830000    SET SLSSPRC3 = PRESS ENTER TO CONFIRM REQUEST.
01840000    SET SLSSPRC4 = PRESS END KEY TO TERMINATE REQUEST.
01850000    SET SLSSPRC5 =
01860000    SET SLSSPRCX = PRESS ENTER TO CONFIRM, END KEY TO TERMINATE.
01870000    ISPEXEC DISPLAY PANEL(SLSS@PRC)
01880000    SET RC = &LASTCC
01890000    IF &RC = 8 THEN DO
01900000      SET ADDMSG = &STR(DELETE REQUEST FOR ENTRY &SLSID TERMINATED)
01910000      GOTO SHOWIT
01920000    END DO
01930000    ISPEXEC TBDELETE &SLSS
01940000    SET RC = &LASTCC
01950000    IF &RC = 0 THEN DO
01960000      SET ADDMSG = &STR(ENTRY &SLSID DELETED )
01970000      SET MOD = &STR(Y)
01980000      SET CHGFLG = &STR(Y)
01990000      IF &SLSS = &STR(MAIN) THEN DO
02000000        IF &LOCSOPEN = &STR(N) THEN DO
02010000          ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
02020000          SET OPENRC = &LASTCC
02030000          IF &OPENRC ¬= 0 THEN DO
02040000            SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
02050000            SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &OPENRC.
02060000            SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
02070000            SET SLSSERR4 = CONCERNING THIS ERROR.
02080000            SET SLSSERR5 =
02090000            SET SLSSERRX = PRESS ENTER TO CONTINUE
02100000            ISPEXEC DISPLAY PANEL(SLSS@ERR)
02110000            ISPEXEC TBEND MAINLOCS
02120000            GOTO SHOWIT
02130000          END DO
02140000          SET LOCSOPEN = &STR(Y)
02150000        END DO
02160000        SET LOCID = &STR(MAIN&SLSID)
02170000        ISPEXEC TBGET MAINLOCS
02180000        IF &LASTCC ¬= 0 THEN GOTO TBDEL
02190000        ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
02200000        SET RC = &LASTCC
02210000        IF &RC = 12 THEN DO
02220000          SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
02230000          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
02240000          SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
02250000          SET SLSSERR4 = REGARDING THIS ERROR.
02260000          SET SLSSERR5 =
02270000          SET SLSSERRX = PRESS ENTER TO CONTINUE
02280000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
02290000          GOTO TBDEL
02300000        END DO
02310000        IF &RC ¬= 0 THEN DO
02320000          SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
02330000          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
02340000          SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
02350000          SET SLSSERR4 = REGARDING THIS ERROR.
02360000          SET SLSSERR5 =
02370000          SET SLSSERRX = PRESS ENTER TO CONTINUE
02380000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
02390000          GOTO TBDEL
02400000        END DO
02410000        SET CNT = 1
02420000        ISPEXEC TBVCLEAR MAINMEMS
02430000        SET PF  = &STR(&&LOC&CNT)
02440000        SET MEMBER = &STR(&PF)
02450000        IF &MEMBER = &STR() THEN SET &CNT = 61
02460000        DO WHILE &CNT < 61
02470000          ISPEXEC TBTOP MAINMEMS
02480000          ISPEXEC TBSARG MAINMEMS
02490000          ISPEXEC TBSCAN MAINMEMS
02500000          SET RC = &LASTCC
02510000          IF &RC ¬= 0 THEN DO
02520000            SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
02530000            SET SLSSERR2 = &STR(&SLSID CANNOT BE DELETED FROM THE LIBRARY)
02540000            SET SLSSERR3 = ASSOCIATED WITH &MEMBER..
02550000            SET SLSSERR4 =
02560000            SET SLSSERR5 =
02570000            SET SLSSERRX = PRESS ENTER TO CONTINUE
02580000            ISPEXEC DISPLAY PANEL(SLSS@ERR)
02590000          END DO
02600000          ELSE DO
02610000            IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
02620000              SET SUBLIB = &STR(&MEMBER)
02630000            END DO
02640000            IF &SUBLIB ¬= &SLSS THEN DO
02650000              ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
02660000              SET RC = &LASTCC
02670000              IF &RC ¬= 0 THEN DO
02680000                SET SLSSERR1 = &STR(UNABLE TO DELETE &SLSID FROM LIBRARY, &SUBLIB.)
02690000                SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
02700000                SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
02710000                SET SLSSERR4 = REGARDING THIS ERROR.
02720000                SET SLSSERR5 =
02730000                SET SLSSERRX = PRESS ENTER TO CONTINUE
02740000                ISPEXEC DISPLAY PANEL(SLSS@ERR)
02750000              END DO
02760000              ELSE DO
02770000                ISPEXEC TBDELETE &SUBLIB
02780000                ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
02790000              END DO
02800000            END DO
02810000          END DO
02820000          SET CNT = &CNT + 1
02830000          ISPEXEC TBVCLEAR MAINMEMS
02840000          SET PF  = &STR(&&LOC&CNT)
02850000          SET MEMBER = &STR(&PF)
02860000          IF &MEMBER = &STR() THEN SET &CNT = 61
02870000        END DO
02880000        ISPEXEC TBEND MAINMEMS
02890000TBDEL: +
02900000        ISPEXEC TBDELETE MAINLOCS
02910000        ISPEXEC TBCLOSE MAINLOCS LIBRARY(SLSSTLIB)
02920000        SET CLOSRC = &LASTCC
02930000        IF &CLOSRC ¬= 0 THEN DO
02940000          SET SLSSERR1 = ERROR CLOSING LIBRARY MAINLOCS
02950000          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBCLOSE' WAS &CLOSRC.
02960000          SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
02970000          SET SLSSERR4 = CONCERNING THIS ERROR.
02980000          SET SLSSERR5 =
02990000          SET SLSSERRX = PRESS ENTER TO CONTINUE
03000000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
03010000          ISPEXEC TBEND MAINLOCS
03020000          SET LOCSOPEN = &STR(N)
03030000          GOTO SHOWIT
03040000        END DO
03050000        SET LOCSOPEN = &STR(N)
03060000      END DO
03070000    END DO
03080000    ELSE DO
03090000      SET SLSSWRN1 = UNABLE TO COMPLETE REQUEST TO DELETE ENTRY.
03100000      SET SLSSWRN2 = RETURN CODE FROM 'ISPEXEC TBDELETE' WAS &RC.
03110000      SET SLSSWRN3 =
03120000      SET SLSSWRN4 =
03130000      SET SLSSWRN5 =
03140000      SET SLSSWRNX = PRESS ENTER TO CONTINUE.
03150000      ISPEXEC DISPLAY PANEL(SLSS@WRN)
03160000    END DO
03170000    GOTO SHOWIT
03180000UPDATE:  +
03190000    IF &SELECT = D THEN GOTO DELETE
03200000    SET ADDMSG = &STR(    )
03210000    IF &STR(&DATEORD) = &STR( ) THEN DO
03220000        SET DATEORD = &STR(        )
03230000        SET ORDSTS = &STR( )
03240000    END DO
03250000    ELSE DO
03260000        SET ORDSTS = &STR(*)
03270000    END DO
03280000    IF &STR(&DATERECV) = &STR( ) THEN DO
03290000        SET DATERECV = &STR(        )
03300000    END DO
03310000    SET LSTUWHO = &STR(&SYSUID)
03320000    SET LSTUDAT = &STR(&SYSDATE)
03330000    SET LSTUTIM = &STR(&SYSSTIME)
03340000    ISPEXEC TBMOD &SLSS
03350000    SET RC = &LASTCC
03360000    IF &RC = 0 THEN DO
03370000        SET ADDMSG = &STR(ENTRY &SLSID MODIFIED )
03380000        SET CHGFLG = &STR(Y)
03390000    END DO
03400000    IF &RC = 8 THEN DO
03410000      SET SLSSWRN1 = &STR(ENTRY &SLSID DID NOT EXIST, BUT WAS ADDED.)
03420000      SET SLSSWRN2 = RETURN CODE FROM 'ISPEXEC TBMOD' WAS &RC.
03430000      SET SLSSWRN3 =
03440000      SET SLSSWRN4 =
03450000      SET SLSSWRN5 =
03460000      SET SLSSWRNX = PRESS ENTER TO CONTINUE.
03470000      ISPEXEC DISPLAY PANEL(SLSS@WRN)
03480000      IF &LOCS = Y THEN GOTO PROCLOCS
03490000      GOTO SHOWIT
03500000    END DO
03510000    IF &RC ¬= 0 THEN DO
03520000      SET SLSSWRN1 = UNABLE TO COMPLETE REQUEST TO UPDATE ENTRY.
03530000      SET SLSSWRN2 = RETURN CODE FROM 'ISPEXEC TBMOD' WAS &RC.
03540000      SET SLSSWRN3 =
03550000      SET SLSSWRN4 =
03560000      SET SLSSWRN5 =
03570000      SET SLSSWRNX = PRESS ENTER TO CONTINUE.
03580000      ISPEXEC DISPLAY PANEL(SLSS@WRN)
03590000    END DO
03600000    IF &LOCS = Y THEN GOTO PROCLOCS
03610000    IF &SLSS = &STR(MAIN) THEN DO
03620000      IF &LOCSOPEN = &STR(N) THEN DO
03630000        ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
03640000        SET OPENRC = &LASTCC
03650000        IF &OPENRC ¬= 0 THEN DO
03660000          SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
03670000          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &OPENRC.
03680000          SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
03690000          SET SLSSERR4 = CONCERNING THIS ERROR.
03700000          SET SLSSERR5 =
03710000          SET SLSSERRX = PRESS ENTER TO CONTINUE
03720000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
03730000          ISPEXEC TBEND MAINLOCS
03740000          GOTO SHOWIT
03750000        END DO
03760000        SET LOCSOPEN = &STR(Y)
03770000      END DO
03780000      SET LOCID = &STR(MAIN&SLSID)
03790000      ISPEXEC TBGET MAINLOCS
03800000      IF &LASTCC ¬= 0 THEN GOTO SHOWIT
03810000      ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
03820000      SET RC = &LASTCC
03830000      IF &RC = 12 THEN DO
03840000        SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
03850000        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
03860000        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
03870000        SET SLSSERR4 = REGARDING THIS ERROR.
03880000        SET SLSSERR5 =
03890000        SET SLSSERRX = PRESS ENTER TO CONTINUE
03900000        ISPEXEC DISPLAY PANEL(SLSS@ERR)
03910000        GOTO SHOWIT
03920000      END DO
03930000      IF &RC ¬= 0 THEN DO
03940000        SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
03950000        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
03960000        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
03970000        SET SLSSERR4 = REGARDING THIS ERROR.
03980000        SET SLSSERR5 =
03990000        SET SLSSERRX = PRESS ENTER TO CONTINUE
04000000        ISPEXEC DISPLAY PANEL(SLSS@ERR)
04010000        GOTO SHOWIT
04020000      END DO
04030000      SET CNT = 1
04040000      ISPEXEC TBVCLEAR MAINMEMS
04050000      SET PF  = &STR(&&LOC&CNT)
04060000      SET MEMBER = &STR(&PF)
04070000      IF &MEMBER = &STR() THEN SET &CNT = 61
04080000      DO WHILE &CNT < 61
04090000        ISPEXEC TBTOP MAINMEMS
04100000        ISPEXEC TBSARG MAINMEMS
04110000        ISPEXEC TBSCAN MAINMEMS
04120000        SET RC = &LASTCC
04130000        IF &RC ¬= 0 THEN DO
04140000          SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
04150000          SET SLSSERR2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
04160000          SET SLSSERR3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
04170000          SET SLSSERR4 = PLEASE USE OPTION 1 UNDER ADMINISTRATION TO DEFINE &MEMBER..
04180000          SET SLSSERR5 =
04190000          SET SLSSERRX = PRESS ENTER TO CONTINUE
04200000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
04210000        END DO
04220000        ELSE DO
04230000          IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
04240000            SET SUBLIB = &STR(&MEMBER)
04250000          END DO
04260000          IF &SUBLIB ¬= &SLSS THEN DO
04270000            ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
04280000            SET RC = &LASTCC
04290000            IF &RC ¬= 0 THEN DO
04300000              SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, &SUBLIB.)
04310000              SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
04320000              SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
04330000              SET SLSSERR4 = REGARDING THIS ERROR.
04340000              SET SLSSERR5 =
04350000              SET SLSSERRX = PRESS ENTER TO CONTINUE
04360000              ISPEXEC DISPLAY PANEL(SLSS@ERR)
04370000            END DO
04380000            ELSE DO
04390000              ISPEXEC TBMOD &SUBLIB ORDER
04400000              ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
04410000            END DO
04420000          END DO
04430000        END DO
04440000        SET CNT = &CNT + 1
04450000        ISPEXEC TBVCLEAR MAINMEMS
04460000        SET PF  = &STR(&&LOC&CNT)
04470000        SET MEMBER = &STR(&PF)
04480000        IF &MEMBER = &STR() THEN SET &CNT = 61
04490000      END DO
04500000      ISPEXEC TBEND MAINMEMS
04510000    END DO
04520000    GOTO SHOWIT
04530000REFRESH:  +
04540000    SET EXTFLAG = &STR(NO)
04550000    SET OLDID = &STR(&SLSID)
04560000    SET ADDMSG = &STR(    )
04570000    ISPEXEC DISPLAY PANEL(SLSSADD)
04580000    IF &LASTCC >0 THEN SET EXTFLAG = &STR(YES)
04590001    ISPEXEC VPUT (NAME1 NAME2 NAME3)
04600001    ISPEXEC SELECT PGM(SLSSVEFY)
04610001    ISPEXEC VGET (NAME1 NAME2 NAME3)
04620000    SET SLSSVER = &SUBSTR(1:2,&STR(&SLSSVER  ))
04630000    SET SLSID = &SUBSTR(1:9,&STR(&SLSID           ))
04640000    IF &STR(&DATEORD) = &STR( ) THEN DO
04650000        SET DATEORD = &STR(        )
04660000        SET ORDSTS = &STR( )
04670000    END DO
04680000    ELSE DO
04690000        SET ORDSTS = &STR(*)
04700000    END DO
04710000    IF &STR(&DATERECV) = &STR( ) THEN DO
04720000        SET DATERECV = &STR(        )
04730000    END DO
04740000    SET LSTUWHO = &STR(&SYSUID)
04750000    SET LSTUDAT = &STR(&SYSDATE)
04760000    SET LSTUTIM = &STR(&SYSSTIME)
04770000    ISPEXEC TBMOD &SLSS
04780000    SET RC = &LASTCC
04790000    IF &RC = 0 THEN DO
04800000        SET ADDMSG = &STR(ENTRY &SLSID MODIFIED )
04810000        SET MOD = &STR(Y)
04820000        SET CHGFLG = &STR(Y)
04830000    END DO
04840000    IF &RC = 8 THEN DO
04850000      ISPEXEC TBDELETE &SLSS
04860000      SET SLSSERR1 = ENTRY WAS NOT MODIFIED.  TO ADD NEW A NEW ENTRY
04870000      SET SLSSERR2 = ENTER OPTION 'A' ON MAINTENANCE SELECTION PANEL.
04880000      SET SLSSERR3 =
04890000      SET SLSSERR4 =
04900000      SET SLSSERR5 =
04910000      SET SLSSERRX = PRESS ENTER TO CONTINUE.
04920000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
04930000      SET SLSID = &STR(&OLDID)
04940000      ISPEXEC TBGET &SLSS
04950000      IF &EXTFLAG = &STR(YES) THEN GOTO SHOWIT
04960000      GOTO REFRESH
04970000    END DO
04980000    IF &RC ¬= 0 THEN DO
04990000      SET SLSSERR1 = UNABLE TO COMPLETE REQUEST TO UPDATE ENTRY.
05000000      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBMOD' WAS &RC.
05010000      SET SLSSERR3 =
05020000      SET SLSSERR4 =
05030000      SET SLSSERR5 =
05040000      SET SLSSERRX = PRESS ENTER TO CONTINUE.
05050000      ISPEXEC DISPLAY PANEL(SLSS@WRN)
05060000      GOTO SHOWIT
05070000    END DO
05080000    IF &LOCS = Y THEN GOTO PROCLOCS
05090000    IF &SLSS = &STR(MAIN) THEN DO
05100000      IF &LOCSOPEN = &STR(N) THEN DO
05110000        ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
05120000        SET OPENRC = &LASTCC
05130000        IF &OPENRC ¬= 0 THEN DO
05140000          SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
05150000          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &OPENRC.
05160000          SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
05170000          SET SLSSERR4 = CONCERNING THIS ERROR.
05180000          SET SLSSERR5 =
05190000          SET SLSSERRX = PRESS ENTER TO CONTINUE
05200000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
05210000          ISPEXEC TBEND MAINLOCS
05220000          GOTO SHOWIT
05230000        END DO
05240000        SET LOCSOPEN = &STR(Y)
05250000      END DO
05260000      SET LOCID = &STR(MAIN&SLSID)
05270000      ISPEXEC TBGET MAINLOCS
05280000      IF &LASTCC ¬= 0 THEN GOTO SHOWIT
05290000      ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
05300000      SET RC = &LASTCC
05310000      IF &RC = 12 THEN DO
05320000        SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
05330000        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
05340000        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
05350000        SET SLSSERR4 = REGARDING THIS ERROR.
05360000        SET SLSSERR5 =
05370000        SET SLSSERRX = PRESS ENTER TO CONTINUE
05380000        ISPEXEC DISPLAY PANEL(SLSS@ERR)
05390000        GOTO SHOWIT
05400000      END DO
05410000      IF &RC ¬= 0 THEN DO
05420000        SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
05430000        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
05440000        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
05450000        SET SLSSERR4 = REGARDING THIS ERROR.
05460000        SET SLSSERR5 =
05470000        SET SLSSERRX = PRESS ENTER TO CONTINUE
05480000        ISPEXEC DISPLAY PANEL(SLSS@ERR)
05490000        GOTO SHOWIT
05500000      END DO
05510000      SET CNT = 1
05520000      ISPEXEC TBVCLEAR MAINMEMS
05530000      SET PF  = &STR(&&LOC&CNT)
05540000      SET MEMBER = &STR(&PF)
05550000      IF &MEMBER = &STR() THEN SET &CNT = 61
05560000      DO WHILE &CNT < 61
05570000        ISPEXEC TBTOP MAINMEMS
05580000        ISPEXEC TBSARG MAINMEMS
05590000        ISPEXEC TBSCAN MAINMEMS
05600000        SET RC = &LASTCC
05610000        IF &RC ¬= 0 THEN DO
05620000          SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
05630000          SET SLSSERR2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
05640000          SET SLSSERR3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
05650000          SET SLSSERR4 = PLEASE USE OPTION 1 UNDER ADMINISTRATION TO DEFINE &MEMBER..
05660000          SET SLSSERR5 =
05670000          SET SLSSERRX = PRESS ENTER TO CONTINUE
05680000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
05690000        END DO
05700000        ELSE DO
05710000          IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
05720000            SET SUBLIB = &STR(&MEMBER)
05730000          END DO
05740000          IF &SUBLIB ¬= &SLSS THEN DO
05750000            ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
05760000            SET RC = &LASTCC
05770000            IF &RC ¬= 0 THEN DO
05780000              SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, &SUBLIB.)
05790000              SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
05800000              SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
05810000              SET SLSSERR4 = REGARDING THIS ERROR.
05820000              SET SLSSERR5 =
05830000              SET SLSSERRX = PRESS ENTER TO CONTINUE
05840000              ISPEXEC DISPLAY PANEL(SLSS@ERR)
05850000            END DO
05860000            ELSE DO
05870000              ISPEXEC TBMOD &SUBLIB ORDER
05880000              ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
05890000            END DO
05900000          END DO
05910000        END DO
05920000        SET CNT = &CNT + 1
05930000        ISPEXEC TBVCLEAR MAINMEMS
05940000        SET PF  = &STR(&&LOC&CNT)
05950000        SET MEMBER = &STR(&PF)
05960000        IF &MEMBER = &STR() THEN SET &CNT = 61
05970000      END DO
05980000      ISPEXEC TBEND MAINMEMS
05990000    END DO
06000000    IF &EXTFLAG = &STR(YES) THEN GOTO SHOWIT
06010000    GOTO REFRESH
06020000PROCLOCS: +
06030000    IF &EXTFLAG = &STR(YES) THEN GOTO SHOWIT
06040000    IF &LOCSOPEN = Y THEN GOTO SHOWLOCS
06050000    ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
06060000    SET RC = &LASTCC
06070000    IF &RC = 8 THEN GOTO BLDLOCS
06080000    IF &RC ¬= 0 THEN DO
06090000      SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
06100000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC.
06110000      SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
06120000      SET SLSSERR4 = CONCERNING THIS ERROR.
06130000      SET SLSSERR5 =
06140000      SET SLSSERRX = PRESS ENTER TO CONTINUE
06150000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
06160000      ISPEXEC TBEND MAINLOCS
06170000      GOTO REFRESH
06180000    END DO
06190000    SET LOCSOPEN = Y
06200000    GOTO SHOWLOCS
06210000BLDLOCS: +
06220000    ISPEXEC TBCREATE MAINLOCS LIBRARY(SLSSTLIB) -
06230000    KEYS(LOCID) -
06240000    NAMES(LOC1  LOC2  LOC3  LOC4  LOC5  LOC6  LOC7  LOC8  LOC9  LOC10 -
06250000          LOC11 LOC12 LOC13 LOC14 LOC15 LOC16 LOC17 LOC18 LOC19 LOC20 -
06260000          LOC21 LOC22 LOC23 LOC24 LOC25 LOC26 LOC27 LOC28 LOC29 LOC30 -
06270000          LOC31 LOC32 LOC33 LOC34 LOC35 LOC36 LOC37 LOC38 LOC39 LOC40 -
06280000          LOC41 LOC42 LOC43 LOC44 LOC45 LOC46 LOC47 LOC48 LOC49 LOC50 -
06290000          LOC51 LOC52 LOC53 LOC54 LOC55 LOC56 LOC57 LOC58 LOC59 LOC60)
06300000    SET RC = &LASTCC
06310000    IF &RC ¬= 0 THEN DO
06320000      SET SLSSERR1 = UNABLE TO CREATE THE REQUESTED LIBRARY MAINLOCS
06330000      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBCREATE' WAS &RC..
06340000      SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
06350000      SET SLSSERR4 = INFORMATION REGARDING THIS ERROR.
06360000      SET SLSSERR5 =
06370000      SET SLSSERRX = PRESS ENTER TO CONTINUE
06380000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
06390000      ISPEXEC TBEND MAINLOCS
06400000      GOTO REFRESH
06410000    END DO
06420000    SET LOCSOPEN = Y
06430000SHOWLOCS: +
06440000    SET LOCID = &STR(MAIN&SLSID)
06450000    ISPEXEC TBGET MAINLOCS
06460000    SET CSRFLAG = &STR(OFF)
06470000    SET CNT = 1
06480000    DO WHILE &CNT < 61
06490000      SET PF  = &STR(&&LOC&CNT)
06500000      SET SAVLOC&CNT = &STR(&PF)
06510000      IF &STR(&PF) = &STR( ) AND &STR(&CSRFLAG) = &STR(OFF) THEN DO
06520000        SET CSRPOS = &STR(LOC&CNT)
06530000        SET CSRFLAG = &STR(ON)
06540000      END DO
06550000      SET CNT = &CNT + 1
06560000    END DO
06570000    ISPEXEC DISPLAY PANEL(SLSSLOCS)
06580000    IF &LASTCC = 8 THEN GOTO REFRESH
06590000    IF &SLSS = &STR(MAIN) THEN DO
06600000      ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
06610000      SET RC = &LASTCC
06620000      IF &RC = 12 THEN DO
06630000        SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
06640000        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
06650000        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
06660000        SET SLSSERR4 = REGARDING THIS ERROR.
06670000        SET SLSSERR5 =
06680000        SET SLSSERRX = PRESS ENTER TO CONTINUE
06690000        ISPEXEC DISPLAY PANEL(SLSS@ERR)
06700000        GOTO REFRESH
06710000      END DO
06720000      IF &RC ¬= 0 THEN DO
06730000        SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
06740000        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
06750000        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
06760000        SET SLSSERR4 = REGARDING THIS ERROR.
06770000        SET SLSSERR5 =
06780000        SET SLSSERRX = PRESS ENTER TO CONTINUE
06790000        ISPEXEC DISPLAY PANEL(SLSS@ERR)
06800000        GOTO REFRESH
06810000      END DO
06820000      SET CNT = 1
06830000      ISPEXEC TBVCLEAR MAINMEMS
06840000      SET PF  = &STR(&&LOC&CNT)
06850000      SET MEMBER = &STR(&PF)
06860000      IF &MEMBER = &STR() THEN SET &CNT = 61
06870000      DO WHILE &CNT < 61
06880000        ISPEXEC TBTOP MAINMEMS
06890000        ISPEXEC TBSARG MAINMEMS
06900000        ISPEXEC TBSCAN MAINMEMS
06910000        SET RC = &LASTCC
06920000        IF &RC ¬= 0 THEN DO
06930000          SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
06940000          SET SLSSERR2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
06950000          SET SLSSERR3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
06960000          SET SLSSERR4 = PLEASE USE OPTION 1 UNDER ADMINISTRATION TO DEFINE &MEMBER..
06970000          SET SLSSERR5 =
06980000          SET SLSSERRX = PRESS ENTER TO CONTINUE
06990000          ISPEXEC DISPLAY PANEL(SLSS@ERR)
07000000          ISPEXEC TBEND MAINMEMS
07010000          GOTO REFRESH
07020000        END DO
07030000        IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
07040000          SET SUBLIB = &STR(&MEMBER)
07050000        END DO
07060000        IF &STR(&SUBLIB) ¬= &STR(&SLSS) THEN DO
07070000          ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
07080000          SET RC = &LASTCC
07090000          IF &RC ¬= 0 THEN DO
07100000            SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, &SUBLIB.)
07110000            SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
07120000            SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
07130000            SET SLSSERR4 = REGARDING THIS ERROR.
07140000            SET SLSSERR5 =
07150000            SET SLSSERRX = PRESS ENTER TO CONTINUE
07160000            ISPEXEC DISPLAY PANEL(SLSS@ERR)
07170000          END DO
07180000          ELSE DO
07190000            ISPEXEC TBMOD &SUBLIB ORDER
07200000            ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
07210000          END DO
07220000        END DO
07230000        SET CNT = &CNT + 1
07240000        ISPEXEC TBVCLEAR MAINMEMS
07250000        SET PF  = &STR(&&LOC&CNT)
07260000        SET MEMBER = &STR(&PF)
07270000        IF &MEMBER = &STR() THEN SET &CNT = 61
07280000      END DO
07290000      SET CT = 1
07300000      SET PF  = &STR(&&SAVLOC&CT)
07310000      SET MEMBER1 = &STR(&PF)
07320000      IF &STR(&OPT) ¬= &STR(A) THEN DO
07330000        DO WHILE &CT < 61
07340000          SET FOUND = &STR(NO)
07350000          SET CNT = 1
07360000          DO WHILE &CNT < 61
07370000            SET PF  = &STR(&&LOC&CNT)
07380000            SET MEMBER = &STR(&PF)
07390000            IF &MEMBER = &STR() THEN SET &CNT = 61
07400000            ELSE DO
07410000              IF &MEMBER = &STR(&MEMBER1) THEN DO
07420000                SET &CNT = 61
07430000                SET FOUND = &STR(YES)
07440000              END DO
07450000            END DO
07460000            SET CNT = &CNT + 1
07470000          END DO
07480000          IF &FOUND = &STR(NO) THEN DO
07490000            ISPEXEC TBVCLEAR MAINMEMS
07500000            SET MEMBER = &STR(&MEMBER1)
07510000            ISPEXEC TBTOP MAINMEMS
07520000            ISPEXEC TBSARG MAINMEMS
07530000            ISPEXEC TBSCAN MAINMEMS
07540000            SET RC = &LASTCC
07550000            IF &RC ¬= 0 THEN DO
07560000              SET SLSSWRN1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
07570000              SET SLSSWRN2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
07580000              SET SLSSWRN3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
07590000              SET SLSSWRN4 = &STR(MANUAL, &SLSID, WILL NOT BE DELETED FROM &SLSS..)
07600000              SET SLSSWRN5 =
07610000              SET SLSSWRNX = PRESS ENTER TO CONTINUE
07620000              ISPEXEC DISPLAY PANEL(SLSS@WRN)
07630000            END DO
07640000            ELSE DO
07650000              IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
07660000                SET SUBLIB = &STR(&MEMBER)
07670000              END DO
07680000              IF &SUBLIB ¬= &SLSS THEN DO
07690000                ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
07700000                SET RC = &LASTCC
07710000                IF &RC ¬= 0 THEN DO
07720000                  SET SLSSERR1 = &STR(UNABLE TO DELETE &SLSID FROM LIB, &SUBLIB.)
07730000                  SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
07740000                  SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
07750000                  SET SLSSERR4 = REGARDING THIS ERROR.
07760000                  SET SLSSERR5 =
07770000                  SET SLSSERRX = PRESS ENTER TO CONTINUE
07780000                  ISPEXEC DISPLAY PANEL(SLSS@ERR)
07790000                END DO
07800000                ELSE DO
07810000                  ISPEXEC TBDELETE &SUBLIB
07820000                  ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
07830000                END DO
07840000              END DO
07850000            END DO
07860000          END DO
07870000          SET CT = &CT + 1
07880000          SET PF  = &STR(&&SAVLOC&CT)
07890000          SET MEMBER1 = &STR(&PF)
07900000          IF &MEMBER1 = &STR() THEN SET &CT = 61
07910000        END DO
07920000      END DO
07930000      ISPEXEC TBEND MAINMEMS
07940000    END DO
07950000    ISPEXEC TBMOD MAINLOCS
07960000    SET RC = &LASTCC
07970000    IF &RC > 12 THEN DO
07980000      SET SLSSERR1 = UNABLE TO ADD/UPDATE ENTRY.
07990000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBMOD' WAS &RC.
08000000      SET SLSSERR3 =
08010000      SET SLSSERR4 =
08020000      SET SLSSERR5 =
08030000      SET SLSSERRX = PRESS ENTER TO CONTINUE
08040000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
08050000    END DO
08060000    SET ADDMSG = &STR(ENTRY &SLSID AND LOCATIONS MODIFIED)
08070000    SET MOD = &STR(Y)
08080000    SET CHGFLG = &STR(Y)
08090000    GOTO REFRESH
08100000CLOSE: +
08110000    ISPEXEC VPUT (SLSS DEBUG) SHARED
08120000    %SLSSENQ ENQOFF
08130000    ISPEXEC TBCLOSE &SLSS PAD(30) LIBRARY(SLSSTLIB)
08140000    IF &LOCSOPEN = Y THEN DO
08150000      ISPEXEC TBCLOSE MAINLOCS LIBRARY(SLSSTLIB)
08160000    END DO
08170000    IF &MOD = &STR(N) THEN EXIT
08180000    ISPEXEC TBOPEN SLSSCNTL LIBRARY(SLSSTLIB)
08190000    SET RC = &LASTCC
08200000    IF &RC ¬= 0 THEN DO
08210000      SET SLSSERR1 = UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
08220000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
08230000      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
08240000      SET SLSSERR4 = REGARDING THIS ERROR.
08250000      SET SLSSERR5 =
08260000      SET SLSSERRX = PRESS ENTER TO CONTINUE
08270000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
08280000      ISPEXEC TBEND SLSSCNTL
08290000      ISPEXEC VPUT (CHGFLG) SHARED
08300000      EXIT
08310000    END DO
08320000    ISPEXEC TBVCLEAR SLSSCNTL
08330000    SET CIBN = &STR(&SLSS)
08340000    ISPEXEC TBGET SLSSCNTL
08350000    SET RC = &LASTCC
08360000    IF &RC ¬= 0 THEN DO
08370000      SET SLSSERR1 = UNABLE TO UPDATE CONTROL FILE, SLSSCNTL.
08380000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBGET' WAS &RC..
08390000      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
08400000      SET SLSSERR4 = REGARDING THIS ERROR.
08410000      SET SLSSERR5 =
08420000      SET SLSSERRX = PRESS ENTER TO CONTINUE
08430000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
08440000      ISPEXEC TBEND SLSSCNTL
08450000      ISPEXEC VPUT (CHGFLG) SHARED
08460000      EXIT
08470000    END DO
08480000    ISPEXEC VGET (ZJDATE ZMONTH ZDAY ZYEAR)
08490000    SET CIBJDATE = &STR(&ZJDATE)
08500000    SET CIBTIME  = &STR(&SYSSTIME)
08510000    SET CIBMDATE = &STR(&ZMONTH/&ZDAY/&ZYEAR)
08520000    SET CIBUPDTE = &STR(Y)
08530000    SET CHGFLG = &STR(Y)
08540000    ISPEXEC TBPUT SLSSCNTL
08550000    IF &RC ¬= 0 THEN DO
08560000      SET SLSSERR1 = UNABLE TO UPDATE CONTROL FILE, SLSSCNTL.
08570000      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBPUT' WAS &RC..
08580000      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
08590000      SET SLSSERR4 = REGARDING THIS ERROR.
08600000      SET SLSSERR5 =
08610000      SET SLSSERRX = PRESS ENTER TO CONTINUE
08620000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
08630000      ISPEXEC TBEND SLSSCNTL
08640000      ISPEXEC VPUT (CHGFLG) SHARED
08650000    END DO
08660000    ISPEXEC TBCLOSE SLSSCNTL LIBRARY(SLSSTLIB)
08670000    SET RC = &LASTCC
08680000    IF &RC ¬= 0 THEN DO
08690000      SET SLSSERR1 = UNABLE TO CLOSE CONTROL FILE, SLSSCNTL.
08700000      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBCLOSE' WAS &RC..
08710000      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
08720000      SET SLSSERR4 = REGARDING THIS ERROR.
08730000      SET SLSSERR5 =
08740000      SET SLSSERRX = PRESS ENTER TO CONTINUE.
08750000      ISPEXEC DISPLAY PANEL(SLSS@ERR)
08760000      ISPEXEC TBEND SLSSCNTL
08770000      EXIT
08780000    END DO
08790000    ISPEXEC VPUT (CHGFLG) SHARED
08800000    EXIT
08810000EXIT: +
08820000    ISPEXEC VPUT (SLSS DEBUG) SHARED
08830000    %SLSSENQ ENQOFF
08840000    ISPEXEC TBEND &SLSS
08850000    ISPEXEC TBEND MAINLOCS
08860000    EXIT
