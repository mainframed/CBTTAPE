         TITLE 'SLSSKEYW - SLSS KEYWORD DEFINITION'
***********************************************************************
*                                                                     *
*        MODULE NAME = SLSSKEYW                                       *
*                                                                     *
*        CHANGE ACTIVITY =                                            *
*              10/31/86  WRITTEN.                               JWC.  *
*                                                                     *
***********************************************************************
         EJECT
         TITLE 'SLSSKEYW - ISPCALL MACRO'
         MACRO
&LBL     ISPCALL &LIST,        CALL PARAMETERS                         +
               &EP=ISPLINK,                                            +
               &LISTLBL=,      LABEL FOR PARAMETER LIST (NON-REENT)    +
               &EPADDR=,       LABEL FOR ADDRESS OF EP OF ISPLINK      +
               &WKAREA=,       TO BUILD CALL LIST (REENTERANT CODE)    +
               &WKREG=,        WORK REGISTER (DEFAULT 1)               +
               &TRACE=         'OFF' OR BIT FOR TRACE MODE
.*  ONCE WKAREA, WKREG, AND TRACE ARE SPECIFIED, THEY ARE USED IN ALL
.*  SUBSEQUENT OCCURRENCES OF THIS MACRO, UNLESS THE PARAMETER IS
.*  EXPLICITLY CODED.
.*  NOTE: FIRST 4 BYTES OF WKAREA ARE USED TO STORE NUMERIC VALUES,
.*  WHICH ARE PRIMARILY LENGTH FIELDS.
         LCLA  &S,&T,&U,&TRCEMSK
         LCLB  &NUMSW
         LCLC  &NDX,&WKAR,&WKRG,&WKEP
         GBLC  &ISPRREG,&ISPRAR,&ISPTRC1,&ISPEP
         GBLA  &ISPTRC2
&NDX     SETC  '&SYSNDX'
&S       SETA  1               SUBSCRIPT FOR GOING THRU &LIST
***********************************************************************
         AIF   (T'&LBL NE 'O').L1
*                  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
         AGO   .L2
.L1      ANOP
&LBL     DS    0H  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
.L2      ANOP
         AIF   (T'&LIST NE 'O').A1
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE PROVIDED ***'
         AGO   .EXIT
.A1      AIF   ('&LIST'(1,1) EQ '(').CHKTRCE
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE ENCLOSED IN PARENTHES+
               ES ***'
         AGO   .EXIT
.****************** ANALYZE "TRACE" PARAMETER *************************
.CHKTRCE AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' NE '').TRCE4
         AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' EQ '').TRCEOFF
         AIF   ('&TRACE'(1,1) EQ '(').TRCEON
         AIF   ('&TRACE' EQ 'OFF').TRCEOFF
         MNOTE 12,'*** INVALID TRACE PARAMETERS ***'
         AGO   .EXIT
.TRCEON  AIF   (T'&TRACE(2) EQ 'N').TRCE2
.TRCE8   MNOTE 12,'*** TRACE BIT (2ND PARAMETER) MUST BE 0 - 7 ***'
         AGO   .EXIT
.TRCE2   AIF   (&TRACE(2) GE 0 OR &TRACE(2) LE 7).TRCE3
         AGO   .TRCE8
.TRCE3   ANOP
&ISPTRC1 SETC  '&TRACE(1)'     SET GLOBAL VARIABLE
&ISPTRC2 SETA  &TRACE(2)       SET GLOBAL VARIABLE
.TRCE4   ANOP
&U       SETA  0
&TRCEMSK SETA  255
&T       SETA  128
.TRCE5   AIF   (&U GT 7).CHKREG
         AIF   (&ISPTRC2 NE &U).TRCE7
.TRCE6   ANOP
&U       SETA  &U+1
&T       SETA  &T/2
         AGO   .TRCE5
.TRCE7   ANOP
&TRCEMSK SETA  &TRCEMSK-&T
         AGO   .TRCE6
.TRCEOFF ANOP
&ISPTRC1 SETC  ''              SET GLOBAL VARIABLE
.****************** ANALYZE "WKREG" PARAMETER *************************
.CHKREG  AIF   (T'&WKREG EQ 'O').A2
&ISPRREG SETC  '&WKREG'        SET GLOBAL VARIABLE
.A2      AIF   ('&ISPRREG' EQ '').A3
&WKRG    SETC  '&ISPRREG'
         AGO   .CHKAREA
.A3      ANOP
&ISPRREG SETC  '1'             SET GLOBAL VARIABLE
         AGO   .A2
.****************** SEE IF USING PROVIDED WORKAREA ********************
.CHKAREA AIF   (T'&WKAREA NE 'O' OR '&ISPRAR' NE '').RENT
         AIF   (T'&LISTLBL EQ 'O').B1
&WKAR    SETC  '&LISTLBL'
         AGO   .B2
.B1      ANOP
&WKAR    SETC  'ISPC&NDX'      LABEL FOR MACRO WORKAREA
.B2      ANOP
&T       SETA  4*(N'&LIST+1)   LENGTH OF MACRO WORKAREA
         B     &WKAR.+&T             BRANCH AROUND DATA         ISPCALL
&T       SETA  N'&LIST+1
&WKAR    DC    &T.F'0'               PARAMETER LIST             ISPCALL
.******************** BUILD PARAMETER LIST ****************************
.LOOP    AIF   (&S GT N'&LIST).ENDLOOP
         AIF   ('&LIST(&S)'(1,1) EQ '''').C1 TEST FOR LITERAL
         AIF   (T'&LIST(&S) EQ 'N').NUM      TEST FOR NUMERIC
         AIF   ('&LIST(&S)'(1,1) EQ '(').REG TEST FOR REG NOTATION
         LA    &WKRG,&LIST(&S)       LOAD DATA ADDR             ISPCALL
.ST      ANOP
&T       SETA  4*&S
         ST    &WKRG,&WKAR.+&T       STORE IN PARAM LIST        ISPCALL
         AIF   ('&ISPTRC1' EQ '' OR &S GT 1).C3           TRACE
         TM    &ISPTRC1,&TRCEMSK     IS TRACE BIT ON?     TRACE ISPCALL
         BZ    ISPT&NDX                                   TRACE ISPCALL
         AIF   ('&WKRG' EQ '1' OR '&WKRG' EQ 'R1').C4     TRACE
         LR    1,&WKRG               LOAD SRVC NAME ADDR  TRACE ISPCALL
         EJECT
.C4      AIF   ('&LIST(&S)'(1,1) EQ '''').C5 LITERAL?     TRACE
         LA    0,8                   LOAD LENGTH          TRACE ISPCALL
         AGO   .C6                                        TRACE
.C5      ANOP                                             TRACE
&U       SETA  K'&LIST(&S)-2   LENGTH OF SERVICE NAME     TRACE
         LA    0,&U                  LOAD LENGTH          TRACE ISPCALL
.C6      ANOP                                             TRACE
         SVC   93                    ISSUE TPUT SVC       TRACE ISPCALL
ISPT&NDX EQU   *                                          TRACE ISPCALL
.C3      ANOP
&S       SETA  &S+1
         AGO   .LOOP
.C1      AIF   (&S EQ 1).C2    SPF SERVICE NAME - LENGTH IS OK
&T       SETA  K'&LIST(&S)-2
         AIF   (&T GT 7).C2    LENGTH 8 OR GREATER IS OK
&T       SETA  &T+1            ADD FOR ONE BLANK
         LA    &WKRG,=CL&T.&LIST(&S) LOAD DATA ADDR             ISPCALL
         AGO   .ST
.C2      ANOP
         LA    &WKRG,=C&LIST(&S)     LOAD DATA ADDR             ISPCALL
         AGO   .ST
.NUM     AIF   (&NUMSW).NUM2
.*  NOTE: SPF WILL MODIFY LENGTH FIELDS, SO THEY CANNOT BE IN
.*  REENTERANT CODE.
         MVC   &WKAR.(4),=F'&LIST(&S)'                                 +
                                     MOVE NUMERIC VALUE         ISPCALL
&NUMSW   SETB  1
         AGO   .LA
.NUM2    MNOTE 12,'*** ONLY ONE NUMERIC ALLOWED PER ISPCALL MACRO - LIS+
               T ITEM &S --&LIST(&S)-- IS SECOND OCCURRENCE ***'
         AGO   .EXIT
.LA      ANOP
         LA    &WKRG,&WKAR           LOAD DATA ADDR             ISPCALL
         AGO   .ST
.REG     ANOP
&T       SETA  4*&S
         ST    &LIST(&S),&WKAR.+&T                              ISPCALL
         AGO   .C3
.******************** USING PROVIDED WORKAREA *************************
.RENT    AIF   (T'&WKAREA EQ 'O').RENT2
&ISPRAR  SETC  '&WKAREA'       SET GLOBAL VARIABLE
.RENT2   ANOP
&WKAR    SETC  '&ISPRAR'
         AGO   .LOOP
         EJECT
.****************** GENERATE STATEMENTS FOR CALL **********************
.ENDLOOP ANOP
         OI    &WKAR.+&T,X'80'       TURN ON VL BIT             ISPCALL
.*       LA    1,&WKAR.+4                                       ISPCALL
.*       L     15,=V(&EP)                                       ISPCALL
.*       BALR  14,15                                            ISPCALL
         AIF   (T'&EPADDR EQ 'O').EP2
&ISPEP   SETC  '&EPADDR'
         LOAD  EP=ISPLINK
         ST    R0,&ISPEP
.EP2     ANOP
&WKEP    SETC  '&ISPEP'
         L     15,&WKEP
         LA    1,&WKAR.+4
         CALL  (15)
.EXIT    ANOP
***********************************************************************
         SPACE 2
         MEND
         EJECT
         TITLE 'SLSSKEYW - INITIALIZATION SECTION'
SLSSKEYW CSECT
SLSSKEYW AMODE ANY
SLSSKEYW RMODE ANY
***********************************************************************
*  INITIALIZATION SECTION - GETMAIN WORKAREA AND SAVE AREA CHAINING
***********************************************************************
         SAVE  (14,12),,SLSSKEYW_&SYSDATE_&SYSTIME   SAVE REGISTERS
         LR    R12,R15                 LOAD REG 12 WITH ENTRY ADDRESS
         USING SLSSKEYW,R12            ESTABLISH ADDRESSABILITY TO
*                                      PROGRAM CSECT
         LA    R11,4095(R12)           LOAD REG 11 WITH ENTRY + 4095
         USING SLSSKEYW+4095,R11       ESTABLISH ADDRESSABILITY TO
*                                      REST OF PROGRAM
         GETMAIN R,LV=WORKLEN          GETMAIN DYNAMIC WORKAREA
         ST    R13,4(R1)               STORE ADDRESS PREVIOUS SAVEAREA
         ST    R1,8(,R13)              STORE ADDRESS OF CURRENT
*                                      SAVEAREA IN PREVIOUS SAVEAREA
         LR    R13,R1                  LOAD REG 13 WITH ADDRESS OF
*                                      CURRENT SAVEAREA
         USING WORKAREA,R13            ESTABLISH ADDRESSABILITY TO
*                                      DYNAMIC WORKAREA
***********************************************************************
*  INITIALIZATION SECTION - SET DIALOG CONTROL, DEFINE VARIABLES
***********************************************************************
*                                      SET DIALOG CONTROL
         ISPCALL ('CONTROL','ERRORS','RETURN'),                        +
               WKAREA=PARMS,                                           +
               EPADDR=ISPADDR
VDEF0    EQU   *
         MVC   ISPFSERV,DEFID          SET ISPF DIALOG SERVICE
*                                      DEFINE VARIABLES
         ISPCALL ('VDEFINE',NAMELST0,SLSS,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF1                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF1    EQU   *
         ISPCALL ('VDEFINE',NAMELST1,SCANMOD,'CHAR',1)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF2                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF2    EQU   *
         ISPCALL ('VDEFINE',NAMELST2,SLSSERR1,'CHAR',62)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF3                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF3    EQU   *
         ISPCALL ('VDEFINE',NAMELST3,GWORD,'CHAR',20)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF4                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF4    EQU   *
         ISPCALL ('VDEFINE',NAMELST4,NUM,'FIXED',4)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF5                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF5    EQU   *
         ISPCALL ('VDEFINE',NAMELST5,NAME1,'CHAR',60)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF6                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF6    EQU   *
         ISPCALL ('VDEFINE',NAMELSTX,BK1,'CHAR',9)
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF10   EQU   *
         B     VGET                    RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR VDEF)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (NOT VALID FOR VDEF)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - RETRIEVE 'SLSS' VARIABLE
***********************************************************************
VGET     EQU   *
         MVC   ISPFSERV,GETID          SET ISPF DIALOG SERVICE
*                                      RETRIEVE DIALOG VARIABLE
         ISPCALL ('VGET',NAMELSTY)
         B     VGET10(R15)             CHECK RETURN CODE
VGET10   EQU   *
         B     VGET20                  RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR VGET)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (NOT VALID FOR VGET)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
VGET20   EQU   *
         LA    R2,NAMELIST             SET UP
         LA    R3,LENLSTX                  REGISTERS
         LA    R4,NAMELSTX                     FOR
         LR    R5,R3                               LONG MOVE
         MVCL  R2,R4                   MOVE STATIC TO DYNAMIC
         MVC   SLSSERR1,ERRMSG1        INITIALIZE MESSAGE ONE
         MVC   SLSSERR2,ERRMSG2        INITIALIZE MESSAGE TWO
         MVC   SLSSERR3,ERRMSG3        INITIALIZE MESSAGE THREE
         MVC   SLSSERR4,ERRMSG4        INITIALIZE MESSAGE FOUR
         MVC   SLSSERR5,ERRMSG5        INITIALIZE MESSAGE FIVE
         MVC   SLSSERRX,ERRMSGX        INITIALIZE MESSAGE X
         MVC   SLSSPRC1,PRCMSG1A       INITIALIZE MESSAGE ONE
         MVC   SLSSPRC2,PRCMSG2        INITIALIZE MESSAGE TWO
         MVC   SLSSPRC3,PRCMSG3        INITIALIZE MESSAGE THREE
         MVC   SLSSPRC4,PRCMSG4        INITIALIZE MESSAGE FOUR
         MVC   SLSSPRC5,PRCMSG5        INITIALIZE MESSAGE FIVE
         MVC   SLSSPRCX,PRCMSGX        INITIALIZE MESSAGE X
         MVC   SLSSWRN1,WRNMSG1        INITIALIZE MESSAGE ONE
         MVC   SLSSWRN2,WRNMSG2        INITIALIZE MESSAGE TWO
         MVC   SLSSWRN3,WRNMSG3        INITIALIZE MESSAGE THREE
         MVC   SLSSWRN4,WRNMSG4        INITIALIZE MESSAGE FOUR
         MVC   SLSSWRN5,WRNMSG5        INITIALIZE MESSAGE FIVE
         MVC   SLSSWRNX,WRNMSGX        INITIALIZE MESSAGE X
         MVC   SCANMOD,NO              INITIALIZE SCANMOD
         MVC   WORKWORD,SPACES         INITIALIZE WORKWORD
         MVC   SLSSTABL(8),SPACES      INITIALIZE LIBRARY TABLE
         MVC   SLSSTABL,SLSS           INITIALIZE LIBRARY TABLE
         LA    R2,SCANTABL             INDEX THROUGH TABLE
         LA    R3,4                    MAX LENGTH OF SLSS NAME
VGET30   EQU   *
         CLC   0(1,R2),SPACES          INSERT SCAN HERE?
         BE    VGET40                  YES, INSERT AND CONTINUE
         LA    R2,1(R2)                INCREMENT R2
         BCT   R3,VGET30               CONTINUE
VGET40   EQU   *
         MVC   0(4,R2),SCAN            INITIALIZE 2ND PART OF SCANTABL
         SLR   R2,R2                   R2 - NUMBER OF MANUALS IN LIB
         LA    R3,10                   R3 - MANUAL PROCESSING CKPT
         MVC   PANEL,SLSS@WRN          IDENTIFY PANEL TO BE DISPLAYED
         BAL   R4,DISPLAY              DISPLAY WARNING PANEL
***********************************************************************
*  INITIALIZATION SECTION - ERASE SCAN TABLE
***********************************************************************
TBERASE  EQU   *
         MVC   ISPFSERV,ERAID          SET ISPF DIALOG SERVICE
*                                      ERASE A TABLE
         ISPCALL ('TBERASE',SCANTABL,'SLSSTLIB')
         B     TBERA10(R15)            CHECK RETURN CODE
TBERA10  EQU   *
         B     TBCREATE                RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBERASE)
         B     TBCREATE                RC = 08 (CONTINUE)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  INITIALIZATION SECTION - CREATE SCAN TABLE
***********************************************************************
TBCREATE EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
*                                      CREATE A TABLE
         ISPCALL ('TBCREATE',SCANTABL,NAMELST3,NAMELST4,'WRITE','REPLAC+
               E','SLSSTLIB')
         B     TBCRE10(R15)            CHECK RETURN CODE
TBCRE10  EQU   *
         B     TBOPEN                  RC = 00 (CONTINUE)
         B     TBOPEN                  RC = 04 (CONTINUE)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  INITIALIZATION SECTION - OPEN LIBRARY TABLE
***********************************************************************
TBOPEN   EQU   *
         MVC   ISPFSERV,OPNID          SET ISPF DIALOG SERVICE
*                                      OPEN A TABLE
         ISPCALL ('TBOPEN',SLSSTABL,'NOWRITE','SLSSTLIB')
         B     TBOPN10(R15)            CHECK RETURN CODE
TBOPN10  EQU   *
         B     TBSKIP                  RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBOPEN)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - SKIP ONE ROW IN LIBRARY TABLE
***********************************************************************
TBSKIP   EQU   *
         MVC   ISPFSERV,SKPID          SET ISPF DIALOG SERVICE
*                                      MOVE ROW POINTER
         ISPCALL ('TBSKIP',SLSSTABL)
         B     TBSKP10(R15)            CHECK RETURN CODE
TBSKP10  EQU   *
         B     TBSKP20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBSKIP)
         B     TBSKP30                 RC = 08 (CONTINUE)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBSKP20  EQU   *
         LA    R2,1(R2)                INCREMENT MANUAL COUNT
         CR    R2,R3                   SHOULD WE DISPLAY PROC SCREEN
         BNE   PARSE                   NO, PARSE MANUAL TITLE
         LA    R3,10(R2)               R3 - VALUE OF NEXT CKPT
         CVD   R2,CONAREA              CONVERT TO DECIMAL
         UNPK  UNPKAREA,CONAREA+1      MAKE IT PRINTABLE
         MVC   SLSSPRC3(4),UNPKAREA+2    MOVE TO BE DISPLAYED UPON SCRN
         MVC   PANEL,SLSS@PRC          IDENTIFY PANEL TO BE DISPLAYED
         BAL   R4,CONTROL              SET PROCESSING MODE
         BAL   R4,DISPLAY              DISPLAY PROCESSING PANEL
         B     PARSE                   PARSE MANUAL TITLE
TBSKP30  EQU   *
         LA    R2,1(R2)                INCREMENT MANUAL COUNT
         CVD   R2,CONAREA              CONVERT TO DECIMAL
         UNPK  UNPKAREA,CONAREA+1      MAKE IT PRINTABLE
         MVC   SLSSPRC3(4),UNPKAREA+2    MOVE TO BE DISPLAYED UPON SCRN
         MVC   SLSSPRC1,PRCMSG1B       MOVE ALTERNATE MESSAGE
         MVC   PANEL,SLSS@PRC          MOVE DISPLAY PANEL
         BAL   R4,DISPLAY              DISPLAY PROCESSING PANEL
         B     TBEND                   OK, WE'RE DONE
***********************************************************************
*  PROCESSING SECTION - PARSE MANUAL TITLES FOR KEY WORDS
***********************************************************************
PARSE    EQU   *
         LA    R5,NAME1                R5 - INDEX THRU MANUAL TITLE
         LA    R6,WORKWORD             R6 - INDEX THRU EXTRACTED KYWD
         LA    R7,20                   R7 - MAXIMUM LENGTH OF KYWD
         LA    R8,180                  R8 - MAXIMUM LENGTH OF TITLE
PARSE10  EQU   *
         CLC   0(1,R5),PERIOD          PART OF KEYWORD?
         BE    PARSE15                 YES, CONTINUE
         CLC   0(1,R5),SPACES          END OF KEYWORD?
         BE    PARSE20                 YES, UPDATE SCAN TABLE
         CLC   0(1,R5),SPECHAR1        END OF KEYWORD?
         BE    PARSE20                 YES, UPDATE SCAN TABLE
         CLC   0(1,R5),SPECHAR2        END OF KEYWORD?
         BE    PARSE20                 YES, UPDATE SCAN TABLE
         CLC   0(1,R5),SPECHAR3        END OF KEYWORD?
         BE    PARSE20                 YES, UPDATE SCAN TABLE
         CLC   0(1,R5),SPECHAR4        END OF KEYWORD?
         BE    PARSE20                 YES, UPDATE SCAN TABLE
         TM    0(R5),ALPHANUM          IS IT ALPHA-NUMERIC?
         BNO   PARSE20                 NO, UPDATE SCAN TABLE
PARSE15  EQU   *
         MVC   0(1,R6),0(R5)           MOVE KEYWORD TO WORK
         LA    R5,1(R5)                INCREMENT R5
         LA    R6,1(R6)                INCREMENT R6
         BCTR  R8,0                    DECREMENT R8
         C     R8,FULL00               END OF TITLE?
         BE    PARSE40                 YES, WE'RE DONE
         BCT   R7,PARSE10              CONTINUE EXTRACTION
PARSE20  EQU   *
         C     R7,FULL20               KEYWORD BEEN EXTRACTED?
         BE    PARSE30                 NO, INCREMENT R5 & CONTINUE
         CLC   A,WORKWORD              INSIGNIFICANT KEYWORD?
         BE    PARSE30                 YES, INCREMENT R5 & CONTINUE
         CLC   AND,WORKWORD            INSIGNIFICANT KEYWORD?
         BE    PARSE30                 YES, INCREMENT R5 & CONTINUE
         CLC   FOR,WORKWORD            INSIGNIFICANT KEYWORD?
         BE    PARSE30                 YES, INCREMENT R5 & CONTINUE
         CLC   IN,WORKWORD             INSIGNIFICANT KEYWORD?
         BE    PARSE30                 YES, INCREMENT R5 & CONTINUE
         CLC   OF,WORKWORD             INSIGNIFICANT KEYWORD?
         BE    PARSE30                 YES, INCREMENT R5 & CONTINUE
         CLC   THE,WORKWORD            INSIGNIFICANT KEYWORD?
         BE    PARSE30                 YES, INCREMENT R5 & CONTINUE
         CLC   TO,WORKWORD             INSIGNIFICANT KEYWORD?
         BE    PARSE30                 YES, INCREMENT R5 & CONTINUE
         BAL   R9,TBTOP                UPDATE SCAN TABLE
PARSE30  EQU   *
         MVC   WORKWORD,SPACES         CLEAR WORKWORD
         LA    R5,1(R5)                POINT R5 PAST DELIMITER
         LA    R6,WORKWORD             R6 - INDEX THRU EXTRACTED KYWD
         LA    R7,20                   R7 - MAXIMUM LENGTH OF KYWD
         BCTR  R8,0                    DECREMENT R8
         C     R8,FULL00               END OF TITLE?
         BNE   PARSE10                 CONTINUE PARSING
PARSE40  EQU   *
         CLC   WORKWORD,SPACES         ANYTHING TO USE FOR UPDATE?
         BE    TBSKIP                  NO, GET NEXT MANUAL TO PARSE
         BAL   R9,TBTOP                UPDATE SCAN TABLE
         B     TBSKIP                  GET NEXT MANUAL TO PARSE
***********************************************************************
*  PROCESSING SECTION - CLOSE LIBRARY TABLE WITHOUT SAVING
***********************************************************************
TBEND    EQU   *
         MVC   ISPFSERV,ENDID          SET ISPF DIALOG SERVICE
*                                      CLOSE TABLE WITHOUT SAVING
         ISPCALL ('TBEND',SLSSTABL)
         B     TBEND10(R15)            CHECK RETURN CODE
TBEND10  EQU   *
         B     TBCLOSE                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBEND)
         B     ISPERR08                RC = 08 (NOT VALID FOR TBEND)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBEND)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - CLOSE SCAN TABLE
***********************************************************************
TBCLOSE  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
*                                      CLOSE AND SAVE TABLE
         ISPCALL ('TBCLOSE',SCANTABL,'REPLCOPY',' ',' ','SLSSTLIB')
         B     TBCLO10(R15)            CHECK RETURN CODE
TBCLO10  EQU   *
         B     FINISH                  RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBCLOSE)
         B     ISPERR08                RC = 08 (NOT VALID FOR TBCLOSE)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
         TITLE 'SLSSKEYW - CLOSING SECTION'
***********************************************************************
*  CLOSING SECTION - FREE GETMAINED AREA, SET RETURN CODE RESTORE REGS
***********************************************************************
FINISH   EQU   *
         LR    R1,R13                  R1 - ADDRESS OF WORKAREA
         L     R13,4(R13)              R13 - ADDR CALLER'S SAVE AREA
         FREEMAIN R,LV=WORKLEN,A=(1)    FREE GETMAINED VIRTUAL STORAGE
         RETURN (14,12),RC=(15)        RESTORE REGISTERS AND RETURN
         TITLE 'SLSSKEYW - ROUTINE SECTION'
***********************************************************************
*  ROUTINE SECTION - POINT TO TOP OF SCAN TABLE
***********************************************************************
TBTOP    EQU   *
         MVC   ISPFSERV,TOPID          SET ISPF DIALOG SERVICE
*                                      POINT TO TOP OF TABLE
         ISPCALL ('TBTOP',SCANTABL)
         B     TBTOP10(R15)            CHECK RETURN CODE
TBTOP10  EQU   *
         B     TBVCLEAR                RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBTOP)
         B     ISPERR08                RC = 08 (NOT VALID FOR TBTOP)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBTOP)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  ROUTINE SECTION - CLEAR SCAN TABLE VARIABLES
***********************************************************************
TBVCLEAR EQU   *
         MVC   ISPFSERV,CLRID          SET ISPF DIALOG SERVICE
*                                      CLEAR TABLE VARIABLES
         ISPCALL ('TBVCLEAR',SCANTABL)
         B     TBCLR10(R15)            CHECK RETURN CODE
TBCLR10  EQU   *
         B     TBSARG                  RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBVCLEAR)
         B     ISPERR08                RC = 08 (NOT VALID FOR TBVCLEAR)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBVCLEAR)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  ROUTINE SECTION - DEFINE SEARCH ARGUMENT FOR SCAN TABLE
***********************************************************************
TBSARG   EQU   *
         MVC   ISPFSERV,ARGID          SET ISPF DIALOG SERVICE
         MVC   GWORD,WORKWORD          SET SEARCH VALUE
*                                      DEFINE SEARCH ARGUMENT
         ISPCALL ('TBSARG',SCANTABL)
         B     TBARG10(R15)            CHECK RETURN CODE
TBARG10  EQU   *
         B     TBSCAN                  RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBSARG)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBSARG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  ROUTINE SECTION - SEARCH SCAN TABLE
***********************************************************************
TBSCAN   EQU   *
         MVC   ISPFSERV,SCNID          SET ISPF DIALOG SERVICE
*                                      SEARCH TABLE
         ISPCALL ('TBSCAN',SCANTABL)
         B     TBSCN10(R15)            CHECK RETURN CODE
TBSCN10  EQU   *
         B     TBSCN20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBSCAN)
         B     TBADD                   RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBSCN20  EQU   *
         CLC   FULL150,NUM             MAX NUMBER OF MANUAL ID'S?
         BER   R9                      YES, NO NEED TO UPDATE TABLE REC
         L     R6,NUM                  R6 - NUM OF MANUAL ID'S / KYWD
         LA    R6,1(R6)                INCREMENT
         ST    R6,NAMELIST             NUMBER OF MANUAL ID'S
         ST    R6,NUM                  PUT IT BACK
         BCTR  R6,0                    DECREMENT R6
         MH    R6,HALF09               R6 - DISPLACEMENT FOR MANUAL ID
         LA    R7,BK1                  R7 - FIRST MANUAL ID
         AR    R7,R6                   POINT TO NEXT OPEN SLOT
         MVC   0(9,R7),SLSID           MANUAL ID TO EXTENS VAR LIST
***********************************************************************
*  ROUTINE SECTION - UPDATE A ROW IN SCAN TABLE
***********************************************************************
TBPUT    EQU   *
         MVC   ISPFSERV,PUTID          SET ISPF DIALOG SERVICE
*                                      UPDATE ROW IN TABLE
         ISPCALL ('TBPUT',SCANTABL,NAMELIST)
         B     TBPUT10(R15)            CHECK RETURN CODE
TBPUT10  EQU   *
         B     TBPUT20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBPUT)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBPUT20  EQU   *
         BR    R9                      RETURN
***********************************************************************
*  ROUTINE SECTION - ADD A ROW TO SCAN TABLE
***********************************************************************
TBADD    EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         LA    R6,1                    R6 - NUM OF MANUAL ID'S / KYWD
         ST    R6,NUM                  STORE IN TABLE VARIABLE
         MVC   NAMELIST(4),NUM         NUMBER OF MANUAL ID'S
         MVC   BK1,SLSID               MANUAL ID TO EXTENS VAR LIST
*                                      ADD A ROW TO TABLE
         ISPCALL ('TBADD',SCANTABL,NAMELIST)
         B     TBADD10(R15)            CHECK RETURN CODE
TBADD10  EQU   *
         B     TBADD20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBADD)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBADD20  EQU   *
         BR    R9                      RETURN
***********************************************************************
*  ROUTINE SECTION - DISPLAY PANEL
***********************************************************************
DISPLAY  EQU   *
         MVC   ISPFSERV,DISID          SET ISPF DIALOG SERVICE
*                                      DISPLAY PANEL
         ISPCALL ('DISPLAY',PANEL)
         B     DISPL10(R15)            CHECK RETURN CODE
DISPL10  EQU   *
         B     DISPL20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBADD)
         B     DISPL30                 RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
DISPL20  EQU   *
         BR    R4                      RETURN
DISPL30  EQU   *
         CLC   PANEL,SLSS@WRN          WARNING PANEL DISPLAYED?
         BE    FINISH                  YES, WE CHICKENED OUT
         CLC   PANEL,SLSS@PRC          PROCESSING PANEL DISPLAYED?
         BER   R4                      YES, RETURN
         CLC   PANEL,SLSS@ERR          ERROR PANEL DISPLAYED?
         BER   R4                      YES, RETURN
***********************************************************************
*  ROUTINE SECTION - SET PROCESSING MODE
***********************************************************************
CONTROL  EQU   *
         MVC   ISPFSERV,CONID          SET ISPF DIALOG SERVICE
*                                      SET PROCESSING MODE
         ISPCALL ('CONTROL','DISPLAY','LOCK')
         B     CONTL10(R15)            CHECK RETURN CODE
CONTL10  EQU   *
         B     CONTL20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR CONTROL)
         B     ISPERR08                RC = 08 (NOT VALID FOR CONTROL)
         B     ISPERR12                RC = 12 (NOT VALID FOR CONTROL)
         B     ISPERR16                RC = 16 (NOT VALID FOR CONTROL)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
CONTL20  EQU   *
         BR    R4                      RETURN
         TITLE 'SLSSKEYW - ERROR PROCESSING SECTION'
***********************************************************************
*  ERROR PROCESSING SECTION
***********************************************************************
ISPERR04 EQU   *
         MVC   SLSSERR2+15(2),FOUR     SET RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR08 EQU   *
         MVC   SLSSERR2+15(2),EIGHT    SET RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR12 EQU   *
         MVC   SLSSERR2+15(2),TWELVE   SET RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR16 EQU   *
         MVC   SLSSERR2+15(2),SIXTEEN  SET RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR20 EQU   *
         MVC   SLSSERR2+15(2),TWENTY   SET RETURN CODE
ISPERR30 EQU   *
         MVC   SLSSERR1+21(8),ISPFSERV     IDENTIFY ISPF SERVICE
         MVC   PANEL,SLSS@ERR          IDENTIFY DISPLAY PANEL
         BAL   R4,DISPLAY              DISPLAY ERROR PANEL
         B     FINISH                  WE'RE DONE
         TITLE 'SLSSKEYW - REGISTER EQUATES'
***********************************************************************
*  REGISTER EQUATES
***********************************************************************
         EQUATE
ALPHANUM EQU   X'C0'                   TEST FOR ALPHA-NUMERIC CHARACTER
         TITLE 'SLSSKEYW - DATA CONSTANTS'
***********************************************************************
*  CONSTANTS
***********************************************************************
HALF09   DC    H'09'                   HALFWORD CONSTANT, VALUE '09'
FULL00   DC    F'00'                   FULLWORD CONSTANT, VALUE '00'
FULL20   DC    F'20'                   FULLWORD CONSTANT, VALUE '20'
FULL150  DC    F'150'                  FULLWORD CONSTANT, VALUE '150'
FOUR     DC    CL2'04'                 RETURN CODE OF '04'
EIGHT    DC    CL2'08'                 RETURN CODE OF '08'
TWELVE   DC    CL2'12'                 RETURN CODE OF '12'
SIXTEEN  DC    CL2'16'                 RETURN CODE OF '16'
TWENTY   DC    CL2'20'                 RETURN CODE OF '20'
SPACES   DC    CL80' '                 USED FOR INITIALIZATION
NO       DC    CL1'N'                  USED FOR INITIALIZATION
PERIOD   DC    CL1'.'                  PARSING SPEC CHARACTER
SPECHAR1 DC    CL1'{'                  PARSING DELIMITER
SPECHAR2 DC    CL1'}'                  PARSING DELIMITER
SPECHAR3 DC    CL1'\'                  PARSING DELIMITER
SPECHAR4 DC    CL1'|'                  PARSING DELIMITER
A        DC    CL2'A '                 INSIGNIFICANT KEYWORD
AND      DC    CL4'AND '               INSIGNIFICANT KEYWORD
FOR      DC    CL4'FOR '               INSIGNIFICANT KEYWORD
IN       DC    CL3'IN '                INSIGNIFICANT KEYWORD
OF       DC    CL3'OF '                INSIGNIFICANT KEYWORD
THE      DC    CL4'THE '               INSIGNIFICANT KEYWORD
TO       DC    CL3'TO '                INSIGNIFICANT KEYWORD
SLSS@ERR DC    CL8'SLSS@ERR'           ERROR DISPLAY PANEL NAME
SLSS@PRC DC    CL8'SLSS@PRC'           PROCESSING DISPLAY PANEL NAME
SLSS@WRN DC    CL8'SLSS@WRN'           WARNING DISPLAY PANEL NAME
SCAN     DC    CL4'SCAN'               SECOND PART OF SCANTABL
ADDID    DC    CL8'TBADD'              ISPF DIALOG SERVICE (TBADD)
CLOID    DC    CL8'TBCLOSE'            ISPF DIALOG SERVICE (TBCLOSE)
CONID    DC    CL8'CONTROL'            ISPF DIALOG SERVICE (CONTROL)
CREID    DC    CL8'TBCREATE'           ISPF DIALOG SERVICE (TBCREATE)
ERAID    DC    CL8'TBERASE'            ISPF DIALOG SERVICE (TBERASE)
DEFID    DC    CL8'VDEFINE'            ISPF DIALOG SERVICE (VDEFINE)
GETID    DC    CL8'VGET'               ISPF DIALOG SERVICE (VGET)
OPNID    DC    CL8'TBOPEN'             ISPF DIALOG SERVICE (TBOPEN)
SKPID    DC    CL8'TBSKIP'             ISPF DIALOG SERVICE (TBSKIP)
ENDID    DC    CL8'TBEND'              ISPF DIALOG SERVICE (TBEND)
TOPID    DC    CL8'TBTOP'              ISPF DIALOG SERVICE (TBTOP)
CLRID    DC    CL8'TBVCLEAR'           ISPF DIALOG SERVICE (TBVCLEAR)
ARGID    DC    CL8'TBSARG'             ISPF DIALOG SERVICE (TBSARG)
SCNID    DC    CL8'TBSCAN'             ISPF DIALOG SERVICE (TBSCAN)
PUTID    DC    CL8'TBPUT'              ISPF DIALOG SERVICE (TBPUT)
DISID    DC    CL8'DISPLAY'            ISPF DIALOG SERVICE (DISPLAY)
ERRMSG1  DC    CL62'ISPF DIALOG SERVICE, 12345678, ENDED.'
ERRMSG2  DC    CL62'RETURN CODE IS 12.'
ERRMSG3  DC    CL62'CONTACT SYSTEMS PROGRAMMING FOR FURTHER INFORMATION+
               '
ERRMSG4  DC    CL62'REGARDING THIS ERROR.'
ERRMSG5  DC    CL62' '
ERRMSGX  DC    CL62'PRESS ENTER TO CONTINUE.'
PRCMSG1A DC    CL62'KEYWORD BUILD PROCESSING.'
PRCMSG1B DC    CL62'KEYWORD BUILD PROCESSING COMPLETED.'
PRCMSG2  DC    CL62' '
PRCMSG3  DC    CL62'1234 MANUALS PROCESSED.'
PRCMSG4  DC    CL62' '
PRCMSG5  DC    CL62' '
PRCMSGX  DC    CL62' '
WRNMSG1  DC    CL62'SELECTED OPTION WILL REQUIRE SEVERAL MINUTES'
WRNMSG2  DC    CL62'TO COMPLETE. PLEASE INSURE THAT YOU WANT TO'
WRNMSG3  DC    CL62'RUN SELECTED OPTION.'
WRNMSG4  DC    CL62' '
WRNMSG5  DC    CL62' '
WRNMSGX  DC    CL62'PRESS ENTER TO CONTINUE, END KEY TO TERMINATE'
NAMELST0 DS    0F                      NAMES OF VARIABLES (LENGTH 8)
         DC    F'01'
         DC    F'00'
         DC    CL8'SLSS'
NAMELST1 DS    0F                      NAMES OF VARIABLES (LENGTH 1)
         DC    F'01'
         DC    F'00'
         DC    CL8'SCANMOD'
NAMELST2 DS    0F                      NAMES OF VARIABLES (LENGTH 62)
         DC    F'18'
         DC    F'00'
         DC    CL8'SLSSERR1'
         DC    CL8'SLSSERR2'
         DC    CL8'SLSSERR3'
         DC    CL8'SLSSERR4'
         DC    CL8'SLSSERR5'
         DC    CL8'SLSSERRX'
         DC    CL8'SLSSPRC1'
         DC    CL8'SLSSPRC2'
         DC    CL8'SLSSPRC3'
         DC    CL8'SLSSPRC4'
         DC    CL8'SLSSPRC5'
         DC    CL8'SLSSPRCX'
         DC    CL8'SLSSWRN1'
         DC    CL8'SLSSWRN2'
         DC    CL8'SLSSWRN3'
         DC    CL8'SLSSWRN4'
         DC    CL8'SLSSWRN5'
         DC    CL8'SLSSWRNX'
NAMELST3 DS    0F                      NAMES OF VARIABLES (LENGTH 20)
         DC    F'01'
         DC    F'00'
         DC    CL8'GWORD'
NAMELST4 DS    0F                      NAMES OF VARIABLES (LENGTH 4)
         DC    F'01'
         DC    F'00'
         DC    CL8'NUM'
NAMELST5 DS    0F                      NAMES OF VARIABLES (LENGTH 60)
         DC    F'03'
         DC    F'00'
         DC    CL8'NAME1'
         DC    CL8'NAME2'
         DC    CL8'NAME3'
NAMELSTX DS    0F                      EXTENSION VARIABLES - STATIC
         DC    F'151'
         DC    F'00'
         DC    CL8'BK1'
         DC    CL8'BK2'
         DC    CL8'BK3'
         DC    CL8'BK4'
         DC    CL8'BK5'
         DC    CL8'BK6'
         DC    CL8'BK7'
         DC    CL8'BK8'
         DC    CL8'BK9'
         DC    CL8'BK10'
         DC    CL8'BK11'
         DC    CL8'BK12'
         DC    CL8'BK13'
         DC    CL8'BK14'
         DC    CL8'BK15'
         DC    CL8'BK16'
         DC    CL8'BK17'
         DC    CL8'BK18'
         DC    CL8'BK19'
         DC    CL8'BK20'
         DC    CL8'BK21'
         DC    CL8'BK22'
         DC    CL8'BK23'
         DC    CL8'BK24'
         DC    CL8'BK25'
         DC    CL8'BK26'
         DC    CL8'BK27'
         DC    CL8'BK28'
         DC    CL8'BK29'
         DC    CL8'BK30'
         DC    CL8'BK31'
         DC    CL8'BK32'
         DC    CL8'BK33'
         DC    CL8'BK34'
         DC    CL8'BK35'
         DC    CL8'BK36'
         DC    CL8'BK37'
         DC    CL8'BK38'
         DC    CL8'BK39'
         DC    CL8'BK40'
         DC    CL8'BK41'
         DC    CL8'BK42'
         DC    CL8'BK43'
         DC    CL8'BK44'
         DC    CL8'BK45'
         DC    CL8'BK46'
         DC    CL8'BK47'
         DC    CL8'BK48'
         DC    CL8'BK49'
         DC    CL8'BK50'
         DC    CL8'BK51'
         DC    CL8'BK52'
         DC    CL8'BK53'
         DC    CL8'BK54'
         DC    CL8'BK55'
         DC    CL8'BK56'
         DC    CL8'BK57'
         DC    CL8'BK58'
         DC    CL8'BK59'
         DC    CL8'BK60'
         DC    CL8'BK61'
         DC    CL8'BK62'
         DC    CL8'BK63'
         DC    CL8'BK64'
         DC    CL8'BK65'
         DC    CL8'BK66'
         DC    CL8'BK67'
         DC    CL8'BK68'
         DC    CL8'BK69'
         DC    CL8'BK70'
         DC    CL8'BK71'
         DC    CL8'BK72'
         DC    CL8'BK73'
         DC    CL8'BK74'
         DC    CL8'BK75'
         DC    CL8'BK76'
         DC    CL8'BK77'
         DC    CL8'BK78'
         DC    CL8'BK79'
         DC    CL8'BK80'
         DC    CL8'BK81'
         DC    CL8'BK82'
         DC    CL8'BK83'
         DC    CL8'BK84'
         DC    CL8'BK85'
         DC    CL8'BK86'
         DC    CL8'BK87'
         DC    CL8'BK88'
         DC    CL8'BK89'
         DC    CL8'BK90'
         DC    CL8'BK91'
         DC    CL8'BK92'
         DC    CL8'BK93'
         DC    CL8'BK94'
         DC    CL8'BK95'
         DC    CL8'BK96'
         DC    CL8'BK97'
         DC    CL8'BK98'
         DC    CL8'BK99'
         DC    CL8'BK100'
         DC    CL8'BK101'
         DC    CL8'BK102'
         DC    CL8'BK103'
         DC    CL8'BK104'
         DC    CL8'BK105'
         DC    CL8'BK106'
         DC    CL8'BK107'
         DC    CL8'BK108'
         DC    CL8'BK109'
         DC    CL8'BK110'
         DC    CL8'BK111'
         DC    CL8'BK112'
         DC    CL8'BK113'
         DC    CL8'BK114'
         DC    CL8'BK115'
         DC    CL8'BK116'
         DC    CL8'BK117'
         DC    CL8'BK118'
         DC    CL8'BK119'
         DC    CL8'BK120'
         DC    CL8'BK121'
         DC    CL8'BK122'
         DC    CL8'BK123'
         DC    CL8'BK124'
         DC    CL8'BK125'
         DC    CL8'BK126'
         DC    CL8'BK127'
         DC    CL8'BK128'
         DC    CL8'BK129'
         DC    CL8'BK130'
         DC    CL8'BK131'
         DC    CL8'BK132'
         DC    CL8'BK133'
         DC    CL8'BK134'
         DC    CL8'BK135'
         DC    CL8'BK136'
         DC    CL8'BK137'
         DC    CL8'BK138'
         DC    CL8'BK139'
         DC    CL8'BK140'
         DC    CL8'BK141'
         DC    CL8'BK142'
         DC    CL8'BK143'
         DC    CL8'BK144'
         DC    CL8'BK145'
         DC    CL8'BK146'
         DC    CL8'BK147'
         DC    CL8'BK148'
         DC    CL8'BK149'
         DC    CL8'BK150'
         DC    CL8'SLSID'
LENLSTX  EQU   *-NAMELSTX
NAMELSTY DS    0F                      NAMES OF VGET VARIABLE
         DC    F'01'
         DC    F'00'
         DC    CL8'SLSS'
         TITLE 'SLSSKEYW - LITERAL POOL'
         LTORG
         TITLE 'SLSSKEYW - DYNAMIC WORK AREA'
***********************************************************************
*  DYNAMIC WORK AREA
***********************************************************************
WORKAREA DSECT
SAVEAREA DS    18F                     PROGRAM SAVE AREA
ISPADDR  DS    A                       ADDRESS OF EP TO ISPLINK
PARMS    DS    7A                      PARM LIST FOR CALL
CONAREA  DS    D                       WORK AREA FOR BIN/DEC CONVERSION
UNPKAREA DS    D                       WORK AREA FOR DEC/ZONED CONVERSN
SCANTABL DS    0F
SLSS     DS    CL4                     LIBRARY NAME
SCANCON  DS    CL4                     CONSTANT OF 'SCAN'
SLSSTABL DS    CL8                     LIBRARY TABLE
SCANMOD  DS    CL1                     SCAN TABLE MODIFICATION FLAG
SLSSERR1 DS    CL62                    SLSS ERROR MESSAGE 1
SLSSERR2 DS    CL62                    SLSS ERROR MESSAGE 2
SLSSERR3 DS    CL62                    SLSS ERROR MESSAGE 3
SLSSERR4 DS    CL62                    SLSS ERROR MESSAGE 4
SLSSERR5 DS    CL62                    SLSS ERROR MESSAGE 5
SLSSERRX DS    CL62                    SLSS ERROR MESSAGE X
SLSSPRC1 DS    CL62                    SLSS PROCESSING MESSAGE 1
SLSSPRC2 DS    CL62                    SLSS PROCESSING MESSAGE 2
SLSSPRC3 DS    CL62                    SLSS PROCESSING MESSAGE 3
SLSSPRC4 DS    CL62                    SLSS PROCESSING MESSAGE 4
SLSSPRC5 DS    CL62                    SLSS PROCESSING MESSAGE 5
SLSSPRCX DS    CL62                    SLSS PROCESSING MESSAGE X
SLSSWRN1 DS    CL62                    SLSS WARNING MESSAGE 1
SLSSWRN2 DS    CL62                    SLSS WARNING MESSAGE 2
SLSSWRN3 DS    CL62                    SLSS WARNING MESSAGE 3
SLSSWRN4 DS    CL62                    SLSS WARNING MESSAGE 4
SLSSWRN5 DS    CL62                    SLSS WARNING MESSAGE 5
SLSSWRNX DS    CL62                    SLSS WARNING MESSAGE X
GWORD    DS    CL20                    SCAN TABLE KEYWORD
WORKWORD DS    CL20                    SCAN TABLE WORKWORD
NUM      DS    F                       NUMBER OF KEYWORD HITS IN LIB
NAME1    DS    CL60                    LINE 1 OF MANUAL TITLE
NAME2    DS    CL60                    LINE 2 OF MANUAL TITLE
NAME3    DS    CL60                    LINE 3 OF MANUAL TITLE
BK1      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK2      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK3      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK4      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK5      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK6      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK7      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK8      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK9      DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK10     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK11     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK12     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK13     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK14     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK15     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK16     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK17     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK18     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK19     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK20     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK21     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK22     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK23     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK24     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK25     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK26     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK27     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK28     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK29     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK30     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK31     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK32     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK33     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK34     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK35     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK36     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK37     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK38     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK39     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK40     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK41     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK42     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK43     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK44     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK45     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK46     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK47     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK48     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK49     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK50     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK51     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK52     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK53     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK54     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK55     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK56     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK57     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK58     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK59     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK60     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK61     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK62     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK63     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK64     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK65     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK66     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK67     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK68     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK69     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK70     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK71     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK72     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK73     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK74     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK75     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK76     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK77     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK78     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK79     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK80     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK81     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK82     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK83     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK84     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK85     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK86     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK87     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK88     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK89     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK90     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK91     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK92     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK93     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK94     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK95     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK96     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK97     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK98     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK99     DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK100    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK101    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK102    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK103    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK104    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK105    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK106    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK107    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK108    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK109    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK110    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK111    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK112    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK113    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK114    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK115    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK116    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK117    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK118    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK119    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK120    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK121    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK122    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK123    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK124    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK125    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK126    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK127    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK128    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK129    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK130    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK131    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK132    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK133    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK134    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK135    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK136    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK137    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK138    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK139    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK140    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK141    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK142    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK143    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK144    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK145    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK146    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK147    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK148    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK149    DS    CL9                     MANUAL ID USED IN SCAN TABLE
BK150    DS    CL9                     MANUAL ID USED IN SCAN TABLE
SLSID    DS    CL9                     MANUAL ID FROM LIBRARY TABLE
ISPFSERV DS    CL8                     ISPF SERVICE ROUTINE ID
PANEL    DS    CL8                     GENERIC PANEL NAME
NAMELIST DS    0F                      EXTENSION VARIABLES - DYNAMIC
         DS    F'151'
         DS    F'00'
         DS    CL8'BK1'
         DS    CL8'BK2'
         DS    CL8'BK3'
         DS    CL8'BK4'
         DS    CL8'BK5'
         DS    CL8'BK6'
         DS    CL8'BK7'
         DS    CL8'BK8'
         DS    CL8'BK9'
         DS    CL8'BK10'
         DS    CL8'BK11'
         DS    CL8'BK12'
         DS    CL8'BK13'
         DS    CL8'BK14'
         DS    CL8'BK15'
         DS    CL8'BK16'
         DS    CL8'BK17'
         DS    CL8'BK18'
         DS    CL8'BK19'
         DS    CL8'BK20'
         DS    CL8'BK21'
         DS    CL8'BK22'
         DS    CL8'BK23'
         DS    CL8'BK24'
         DS    CL8'BK25'
         DS    CL8'BK26'
         DS    CL8'BK27'
         DS    CL8'BK28'
         DS    CL8'BK29'
         DS    CL8'BK30'
         DS    CL8'BK31'
         DS    CL8'BK32'
         DS    CL8'BK33'
         DS    CL8'BK34'
         DS    CL8'BK35'
         DS    CL8'BK36'
         DS    CL8'BK37'
         DS    CL8'BK38'
         DS    CL8'BK39'
         DS    CL8'BK40'
         DS    CL8'BK41'
         DS    CL8'BK42'
         DS    CL8'BK43'
         DS    CL8'BK44'
         DS    CL8'BK45'
         DS    CL8'BK46'
         DS    CL8'BK47'
         DS    CL8'BK48'
         DS    CL8'BK49'
         DS    CL8'BK50'
         DS    CL8'BK51'
         DS    CL8'BK52'
         DS    CL8'BK53'
         DS    CL8'BK54'
         DS    CL8'BK55'
         DS    CL8'BK56'
         DS    CL8'BK57'
         DS    CL8'BK58'
         DS    CL8'BK59'
         DS    CL8'BK60'
         DS    CL8'BK61'
         DS    CL8'BK62'
         DS    CL8'BK63'
         DS    CL8'BK64'
         DS    CL8'BK65'
         DS    CL8'BK66'
         DS    CL8'BK67'
         DS    CL8'BK68'
         DS    CL8'BK69'
         DS    CL8'BK70'
         DS    CL8'BK71'
         DS    CL8'BK72'
         DS    CL8'BK73'
         DS    CL8'BK74'
         DS    CL8'BK75'
         DS    CL8'BK76'
         DS    CL8'BK77'
         DS    CL8'BK78'
         DS    CL8'BK79'
         DS    CL8'BK80'
         DS    CL8'BK81'
         DS    CL8'BK82'
         DS    CL8'BK83'
         DS    CL8'BK84'
         DS    CL8'BK85'
         DS    CL8'BK86'
         DS    CL8'BK87'
         DS    CL8'BK88'
         DS    CL8'BK89'
         DS    CL8'BK90'
         DS    CL8'BK91'
         DS    CL8'BK92'
         DS    CL8'BK93'
         DS    CL8'BK94'
         DS    CL8'BK95'
         DS    CL8'BK96'
         DS    CL8'BK97'
         DS    CL8'BK98'
         DS    CL8'BK99'
         DS    CL8'BK100'
         DS    CL8'BK101'
         DS    CL8'BK102'
         DS    CL8'BK103'
         DS    CL8'BK104'
         DS    CL8'BK105'
         DS    CL8'BK106'
         DS    CL8'BK107'
         DS    CL8'BK108'
         DS    CL8'BK109'
         DS    CL8'BK110'
         DS    CL8'BK111'
         DS    CL8'BK112'
         DS    CL8'BK113'
         DS    CL8'BK114'
         DS    CL8'BK115'
         DS    CL8'BK116'
         DS    CL8'BK117'
         DS    CL8'BK118'
         DS    CL8'BK119'
         DS    CL8'BK120'
         DS    CL8'BK121'
         DS    CL8'BK122'
         DS    CL8'BK123'
         DS    CL8'BK124'
         DS    CL8'BK125'
         DS    CL8'BK126'
         DS    CL8'BK127'
         DS    CL8'BK128'
         DS    CL8'BK129'
         DS    CL8'BK130'
         DS    CL8'BK131'
         DS    CL8'BK132'
         DS    CL8'BK133'
         DS    CL8'BK134'
         DS    CL8'BK135'
         DS    CL8'BK136'
         DS    CL8'BK137'
         DS    CL8'BK138'
         DS    CL8'BK139'
         DS    CL8'BK140'
         DS    CL8'BK141'
         DS    CL8'BK142'
         DS    CL8'BK143'
         DS    CL8'BK144'
         DS    CL8'BK145'
         DS    CL8'BK146'
         DS    CL8'BK147'
         DS    CL8'BK148'
         DS    CL8'BK149'
         DS    CL8'BK150'
         DS    CL8'SLSID'
WORKLEN  EQU   *-WORKAREA
         END   SLSSKEYW
