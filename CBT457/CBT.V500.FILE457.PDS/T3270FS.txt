FSTT     TITLE 'JUST A SMALL IBM-3270 FULL-SCREEN TERMINAL TEST ...'
         SPACE 1
        PRINT  OFF
         MACRO
&LBL    #GTB   &C=,&T=,&L=
         LCLA  &N
         AIF   ('&C' EQ 'END').END
         AIF   (K'&C NE 8).ERRC
         AIF   ('&T' EQ 'B').A
         AIF   ('&T' NE 'C').ERRT
.A       AIF   (K'&L GT 67).ERRL
&N       SETA  K'&L-3
&LBL     DC    XL4'&C',CL1'&T',AL1(&N)
         DC    C&L
         MEXIT
.END     ANOP
&LBL     DC    XL4'0'
         MEXIT
.ERRC    MNOTE 8,'--- C=... INVALID LENGTH (MUST BE 8)'
         MEXIT
.ERRT    MNOTE 8,'--- T=... INVALID (MUST BE "B" OR "C")'
         MEXIT
.ERRL    MNOTE 8,'--- L=... INVALID (GREATER THAN 65 CHARACTERS)'
         MEND
        PRINT  ON
         SPACE 1
T3270FS  START 0
         SPACE 1
        $DEFREG
KBYTES   EQU   1024
         SPACE 1
        $XENT  BASE=R11
         SPACE 1
        $FS    DOC=(EJECT,ALL)
         MVI   OPT,FSFULL
        EXTRACT    ATIOT,'S',FIELDS=(TIOT)
         L     R3,ATIOT            SEARCH DD IF SNAP AVAILABLE
         USING TIODSECT,R3
SCSNAP   CLC   TIOELNGH(4),=F'0'
         BE    SINT
         CLC   TIOEDDNM(L'TIOEDDNM),=CL8'SYSSNAP'
         BNE   *+L'*+4
         OI    OPT,FSSNAP
         CLC   TIOEDDNM(L'TIOEDDNM),=CL8'SYSTEST'
         BNE   *+L'*+4
         OI    SWITCH,INTEST
         XR    R1,R1
         IC    R1,TIOELNGH
         ALR   R3,R1
         B     SCSNAP
         DROP  R3
SINT    @FSI   BUFSZ,TERMAT,RQSZ
         LTR   R10,R15
         BNZ   LEAVE
         OI    OPT,FSSKIP
        @FS    OPT,INITR,INITRL
         LTR   R10,R15
         BNZ   TTERR
         L     R15,=A(VERIFY)
         BASR  R14,R15
         B     TTERR
STTT     LA    R7,TTMSGLEN
         LA    R8,TTMSG8
STTN     MVC   0(MSGAL,R8),MSGA
         LA    R7,MSGAL(R7)
         ST    R7,TTMSGL
         MVI   TTMSG7,C' '
         MVC   TTMSG7+1(L'TTMSG7-1),TTMSG7
         LA    R15,TTMSG7
         LA    R1,RQROW
         BAS   R14,STTD
         MVI   1(R15),C'x'
         LA    R15,3(R15)
         LA    R1,RQCOL
         BAS   R14,STTD
         CLC   RQSZ,FSPRMSZE
         BE    STPS
        $FS    SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,BLUE),MF=(E,(R15))
        $FS    TEXT='Primary size :',MF=E
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=E
         LA    R1,FSPRMROW
         BAS   R14,STTD
         MVI   1(R15),C'x'
         LA    R15,3(R15)
         LA    R1,FSPRMCOL
         BAS   R14,STTD
         B     STTS
STTD     XR    R0,R0               LOCAL EDIT SUBROUTINE
         IC    R0,0(R1)            R14 = LINK REGISTER
         CVD   R0,WORK
         MVC   0(4,R15),=XL4'40202120'
         ED    0(4,R15),WORK+L'WORK-2
         CLI   0(R15),C' '
         BNE   *+L'*+10
         MVC   0(4,R15),1(R15)
         B     *-14
         LA    R15,1(R15)
         CLI   0(R15),C' '
         BNE   *-8
         BR    R14
STPS     CLC   FSPRMSZE,FSALTSZE
         BE    STTS
        $FS    SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,BLUE),MF=(E,(R15))
        $FS    TEXT='Alternate size :',MF=E
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=E
         LA    R1,FSALTROW
         BAS   R14,STTD
         MVI   1(R15),C'x'
         LA    R15,3(R15)
         LA    R1,FSALTCOL
         BAS   R14,STTD
STTS     NI    OPT,255-FSSKIP
        @FS    OPT,TTMSG,TTMSGL
         LTR   R10,R15
         BNZ   TTERR
         CLI   0(R1),X'F3'         PF-3 KEY
         BE    TTERR
         CLI   0(R1),X'C3'         PF-15 KEY (ALT. 3)
         BE    TTERR
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,RED),            X
               MF=(I,TTMSG1)
         MVI   TTMSG2,C' '
         MVC   TTMSG2+1(L'TTMSG2-1),TTMSG2
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,RED),            X
               MF=(I,TTMSG3)
         MVI   TTMSG4,C' '
         MVC   TTMSG4+1(L'TTMSG4-1),TTMSG4
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),          X
               MF=(I,TTMSG5)
         MVI   TTMSG6,C' '
         MVC   TTMSG6+1(L'TTMSG6-1),TTMSG6
         CLI   0(R1),X'7D'         ENTER KEY
         BE    STTR
         CLI   0(R1),X'F1'         PF-1 KEY
         BE    HELP
         CLI   0(R1),X'C1'         PF-13 KEY (ALT. 1)
         BE    HELP
         LA    R2,=CL35'Invalid key depressed (no function)'
         LA    R3,35-1
         B     STTEM
STTE1    LA    R2,=CL33'What do you want ? (none entered)'
         LA    R3,33-1
         B     STTEM
STTE2    LA    R2,=CL35'What do you mean ? (input too long)'
         LA    R3,35-1
         B     STTEM
STTE3    LA    R2,=CL30'Test number missing (enter it)'
         LA    R3,30-1
         B     STTEM
STTE4    LA    R2,=CL31'Test number too long or invalid'
         LA    R3,31-1
         B     STTER
STTE5    LA    R2,=CL19'Unknown test number'
         LA    R3,19-1
         B     STTER
STTE6    LA    R2,=CL33'Repeat number too long or invalid'
         LA    R3,33-1
         B     STTER
STTE7    LA    R2,=CL32'Repeat number too big (max = 99)'
         LA    R3,32-1
         B     STTER
STTE8    LA    R2,=CL23'Unknown numeric keyword'
         LA    R3,23-1
         B     STTER
STTE9    LA    R2,=CL16'keyword too long'
         LA    R3,16-1
STTER   $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,RED),              X
               MF=(I,TTMSG1)
         LA    R8,TTMSG8
         MVC   0(MSGBL,R8),MSGB
         LA    R7,TTMSGLEN+MSGBL
         LA    R8,MSGBL(R8)
         L     R4,TXTP
         L     R1,TXTL
         EX    R1,STTEMV
         LA    R7,1(R1,R7)
         LA    R8,1(R1,R8)
         SLR   R5,R4
         LA    R5,TTMSG2(R5)
         MVI   0(R5),C'¬'
         BCT   R6,*+L'*+4
         B     STTEM+L'STTEM
         BCT   R6,*+L'*+6
         MVC   1(*-*,R5),0(R5)
         EX    R6,*-6
         B     STTEM+L'STTEM
STTEMV   MVC   0(*-*,R8),0(R4)
STTEM    XR    R7,R7
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,GREEN),        X
               MF=(I,TTMSG5)
         EX    R3,STTMV
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,RED),        X
               MF=(I,TTMSG3)
         MVC   TTMSG4(L'TTMSG4),=CL7'Error :'
         LTR   R7,R7
         BZ    STTT
         B     STTN
STTMV    MVC   TTMSG6(*-*),0(R2)
STTR    @FSR   ,
         LTR   R15,R15
         BZ    STTE1
         LTR   R1,R1
         BNP   STTE1
         CH    R1,=Y(L'TTMSG2)
         BH    STTE2
         LA    R4,3(R15)           SET BXLE VALUES (R4,R2-R3)
         LA    R3,2(R15,R1)
         LA    R2,1
         BCT   R1,*+L'*+6
         OC    0(*-*,R4),=CL70' '
         EX    R1,*-6
         ST    R1,TXTL
         ST    R4,TXTP
         BAS   R14,SCANS
         B     STTE3
         BAS   R14,SCANN
         B     STTE4
         CH    R1,=Y(TSTMX)
         BH    STTE5
         STH   R1,TNO
         LA    R1,1
         STH   R1,TNR
         MVI   TNS,255
         MVC   TNS+1(8),=CL70' '
         BAS   R14,SCANS
         B     STTA
         CLI   0(R5),C'0'
         BL    STTB
         BAS   R14,SCANN
         B     STTE6
         CH    R1,=H'99'
         BH    STTE7
         STH   R1,TNR
         BAS   R14,SCANS
         B     STTA
         CLI   0(R5),C'0'
         BNL   STTE8
STTB     LA    R1,TNS
         BAS   R14,SCANT
         B     STTE9
STTA     LH    R14,TNO
         BCTR  R14,0
         SLL   R14,2
         L     R15,T00(R14)
         BASR  R14,R15             GO TO REQUESTED TEST
         B     STTT                +0 = NORMAL RETURN
         B     TTRET               +4 = ERROR RETURN
         LR    R2,R0               +8 = MESSAGE RETURN
         LR    R3,R1
         B     STTEM
HELP     NI    OPT,255-FSSKIP
        @FS    OPT,HLMSG,HLMSGL
         LTR   R10,R15
         BNZ   TTERR
         CLI   0(R1),X'7D'         ENTER KEY
         BE    HELP
         B     STTS
         SPACE 1
SCANS    CLR   R4,R3               SET R5 = START OF OPERAND
         BHR   R14                     R6 = LENGTH OF OPERAND
         CLI   0(R4),C' '
         BNE   *+L'*+6
         BXLE  R4,R2,*-8
         BR    R14
         LR    R5,R4
         BXLE  R4,R2,*+L'*+4
         B     *+L'*+8
         CLI   0(R4),C' '
         BNE   *-12
         LR    R6,R4
         SLR   R6,R5
         B     4(R14)
         SPACE 1
SCANN    CH    R6,=H'8'            SET R1 = NUMERIC VALUE OF OPERAND
         BHR   R14
         LR    R1,R5
         LR    R0,R6
         CLI   0(R1),C'0'
         BLR   R14
         CLI   0(R1),C'9'
         BHR   R14
         LA    R1,1(R1)
         BCT   R0,*-16
         LR    R1,R6
         BCT   R1,*+L'*+6
         PACK  WORK,0(*-*,R5)
         EX    R1,*-6
         CVB   R1,WORK
         LTR   R1,R1
         BNPR  R14
         B     4(R14)
         SPACE 1
SCANT    CH    R6,=H'8'            R1 = ADDRESS OF STORE KEYWORD
         BHR   R14                      LENGTH AND VALUE
         LR    R15,R6
         BCT   R15,*+L'*+6
         MVC   1(*-*,R1),0(R5)
         EX    R15,*-6
         STC   R15,0(R1)
         B     4(R14)
         SPACE 1
TTRET    LR    R10,R15
TTERR    MVI   OPT,FSEXIT
        @FS    OPT
         LTR   R10,R10
         BNZ   *+L'*+6
         LTR   R10,R15
         BZ    LEAVE
         CH    R10,=H'99'
         BNE   FSERR
        TPUT   TERMSG,L'TERMSG
         B     QUIT
FSERR    CVD   R10,WORK
         MVC   ERRMRC,=XL4'40202120'
         ED    ERRMRC,WORK+L'WORK-(L'ERRMRC/2)
        TPUT   ERRMSG,L'ERRMSG
QUIT     LR    R10,R15
LEAVE   $XRET  CC=(R10)
         EJECT
T00      DC    A(T01,T02,T03,T04)
TSTMX    EQU   (*-T00)/L'T00
         SPACE 1
SSID     DS    0F
T03SVID  DC    F'0'
T04SVID  DC    F'0'
NSID     EQU   (*-SSID)/L'SSID
         SPACE 1
WORK     DC    D'0'
TERMAT  @FST   ,
ATIOT    DC    A(*-*)
BUFFL    DC    A(*-*)
BUFFA    DC    A(*-*)
BUFSZ    DC    A(4*KBYTES)
PSQA     DC    A(*-*)
UAQA     DC    A(*-*)
TXTL     DC    A(*-*)
TXTP     DC    A(*-*)
HLMSGL   DC    A(HLMSGLEN)
TNO      DC    H'0'
TNR      DC    H'0'
TNS      DC    AL1(255),CL8' '
RQSZ     DC    0H'0'
RQROW    DC    AL1(24)
RQCOL    DC    AL1(80)
OPT     @FSO   ,
SWITCH   DC    XL1'0'
INTEST   EQU   X'80'
FSXGE    EQU   X'10'
FSEXC    EQU   X'08'
FSEXH    EQU   X'04'
FSEXS    EQU   X'02'
FSEXD    EQU   X'01'
         SPACE 1
ERRMSG   DC    C' --- "FSRTN" - RC = ... -> Exit ---'
ERRMRC   EQU   ERRMSG+19,4
TERMSG   DC    C' --- Wait time interval error -> Exit ---'
         SPACE 1
        PRINT  NOGEN
INITRL   DC    A(LINITR)
INITR    $FS   CC=EW,WCC=(AL,RMDT),SBA=(24,79),MF=L
         $FS   SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,1),SF=(IC),MF=L
LINITR   EQU   *-INITR
         SPACE 1
TTMSGL   DC    A(*-*)
MSGA     $FS   SBA=(1,1),SF=(PT,IC),MF=L
MSGAL    EQU   *-MSGA
MSGB     $FS   SBA=(12,10),MF=L
MSGBL    EQU   *-MSGB
         SPACE 1
TTMSG    $FS   CC=EW,WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   SBA=(3,12),RA=(3,70,GE,93),MF=L
         $FS   SBA=(3,11),SET=(GE,95),MF=L
         $FS   SBA=(4,11),SET=(GE,95),MF=L
         $FS   SBA=(5,11),SET=(GE,95),MF=L
         $FS   SBA=(6,11),SET=(GE,95),MF=L
         $FS   SBA=(7,11),SET=(GE,95),MF=L
         $FS   SBA=(8,11),SET=(GE,95),MF=L
         $FS   SBA=(9,11),SET=(GE,95),MF=L
         $FS   SBA=(9,12),RA=(9,70,GE,94),MF=L
         $FS   SBA=(3,70),SET=(GE,95),MF=L
         $FS   SBA=(4,70),SET=(GE,95),MF=L
         $FS   SBA=(5,70),SET=(GE,95),MF=L
         $FS   SBA=(6,70),SET=(GE,95),MF=L
         $FS   SBA=(7,70),SET=(GE,95),MF=L
         $FS   SBA=(8,70),SET=(GE,95),MF=L
         $FS   SBA=(9,70),SET=(GE,95),MF=L
         $FS   SBA=(6,54),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   SBA=(6,27),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,USCORE,COLOUR,TURQ),MF=L
         $FS   SBA=(6,28),TEXT='3270 Structured Field test',MF=L
         $FS   SBA=(12,9),SF=NORMAL,MF=L
         $FS   SBA=(12,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,YELLOW),MF=L
         $FS   TEXT='Enter :',MF=L
         $FS   SBA=(12,80),SF=(PROT),MF=L
         $FS   SBA=(13,9),MF=L
TTMSG1   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,RED),MF=L
TTMSG2   $FS   TEXT=(' ',70),MF=L
         $FS   SBA=(13,80),SF=(PROT),MF=L
         $FS   SBA=(16,1),MF=L
TTMSG3   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,RED),MF=L
TTMSG4   $FS   TEXT=(' ',7),MF=L
TTMSG5   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
TTMSG6   $FS   TEXT=(' ',70),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(20,15),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
TTMSG7   $FS   TEXT=(' ',60),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(20,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,PINK),MF=L
         $FS   TEXT='Screen size :',MF=L
TTMSGLEN EQU   *-TTMSG
TTMSG8   DC    (MSGBL+L'TTMSG2+MSGAL)X'0'
        PRINT  GEN
         SPACE 1
        LTORG
         SPACE 1
         DROP  R11                 KILL BASE ADDRESSABILITY
         EJECT
        PRINT  NOGEN
HLMSG    $FS   CC=EW,WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         $FS   SBA=(3,12),RA=(3,70,GE,93),MF=L
         $FS   SBA=(3,11),SET=(GE,95),MF=L
         $FS   SBA=(4,11),SET=(GE,95),MF=L
         $FS   SBA=(5,11),SET=(GE,95),MF=L
         $FS   SBA=(6,11),SET=(GE,95),MF=L
         $FS   SBA=(7,11),SET=(GE,95),MF=L
         $FS   SBA=(8,11),SET=(GE,95),MF=L
         $FS   SBA=(9,11),SET=(GE,95),MF=L
         $FS   SBA=(9,12),RA=(9,70,GE,94),MF=L
         $FS   SBA=(3,70),SET=(GE,95),MF=L
         $FS   SBA=(4,70),SET=(GE,95),MF=L
         $FS   SBA=(5,70),SET=(GE,95),MF=L
         $FS   SBA=(6,70),SET=(GE,95),MF=L
         $FS   SBA=(7,70),SET=(GE,95),MF=L
         $FS   SBA=(8,70),SET=(GE,95),MF=L
         $FS   SBA=(9,70),SET=(GE,95),MF=L
         $FS   SBA=(6,54),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         $FS   SBA=(6,27),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,USCORE,COLOUR,PINK),MF=L
         $FS   SBA=(6,28),TEXT='3270 Structured Field test',MF=L
         $FS   SBA=(11,20),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         $FS   TEXT='Test  Repeat  Option',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(11,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,RED),MF=L
         $FS   TEXT='Command skeleton :',MF=L
         $FS   SBA=(13,11),SF=NORMAL,MF=L
         $FS   SBA=(13,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,BLUE),MF=L
         $FS   TEXT='Test n¢ :',MF=L
         $FS   SBA=(13,14),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,YELLOW),MF=L
         $FS   TEXT='1 =',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='Colours (i.e : 1 4 R)',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   TEXT='- White/Yellow/Turq/Green/Pink/',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(14,42),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   TEXT='Red/Blue',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(15,14),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,YELLOW),MF=L
         $FS   TEXT='2 =',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='Display Programmed Symbols (i.e : 2 2)',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(16,14),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,YELLOW),MF=L
         $FS   TEXT='3 =',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='Load PS single-plane (i.e : 3 2 D)',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   TEXT='- Load/Display/Cancel',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(17,14),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,YELLOW),MF=L
         $FS   TEXT='4 =',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='Load PS triple-plane (i.e : 4 1 L)',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   TEXT='- Load/Display/Cancel',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(20,12),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         $FS   TEXT='CGCSGID =',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='Coded Graphic Character Set Global ',MF=L
         $FS   TEXT='IDentifier',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(20,1),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,USCORE,COLOUR,PINK),MF=L
         $FS   SBA=(20,2),TEXT='Glossary :',MF=L
         $FS   SBA=(21,15),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         $FS   TEXT='CECP =',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='Country Extended Code Page',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(1,1),SF=(PT,IC),MF=L
HLMSGLEN EQU   *-HLMSG
        PRINT  GEN
         EJECT
*------- SELECT LCID ROUTINE.
         SPACE 1
         CNOP  0,4
         USING *,R15               LOCAL ADDRESSABILITY
         USING T3270FS,R11         BASE ADDRESSABILITY
SLLCID   STM   R1,R5,SLLSV         SET R0 = LCID
         L     R2,PSQA
         XR    R1,R1
         ICM   R1,B'0011',0(R2)
         LA    R5,0(R1,R2)
         XR    R1,R1
         IC    R1,12(R2)
         LA    R2,13(R2)
         LA    R0,X'EF'
         LA    R3,X'4A'
SLLSNT   LR    R4,R2
SLLSCN   CLI   2(R4),X'FF'
         BE    SLLNXT
         EX    R3,SLLCHK
         BNE   SLLNXT
         CLR   R3,R0
         BNL   *+L'*+8
         LA    R3,1(R3)
         B     SLLSNT
         XR    R0,R0
         B     SLLXRT
SLLNXT   ALR   R4,R1
         CLR   R4,R5
         BL    SLLSCN
         LR    R0,R3
SLLXRT   LM    R1,R5,SLLSV
         BR    R14
SLLCHK   CLI   2(R4),*-*
         SPACE 1
SLLSV    DC    5F'0'
         SPACE 1
         DROP  R15                 KILL LOCAL ADDRESSABILITY
         DROP  R11                 KILL BASE ADDRESSABILITY
         EJECT
*------- VERIFY TERMINAL.
         SPACE 1
         CNOP  0,4
         USING *,R12               LOCAL ADDRESSABILITY
         USING T3270FS,R11         BASE ADDRESSABILITY
VERIFY   STM   R14,R12,12(R13)
         LR    R12,R15
         LR    R15,R13
         LA    R13,VERIFYSV
         B     VERIFYCS
VERIFYSV DC    18F'0'
VERIFYCS ST    R13,8(R15)
         ST    R15,4(R13)
        @FSQ   ,
         LTR   R10,R15
         BNZ   VERRXR
         STM   R0,R1,BUFFL
         TM    SWITCH,INTEST
         BZ    VERANL
         LM    R2,R3,BUFFL         QUERY REPLY DATA
         MVI   VERLNE,C'1'
         ALR   R2,R3
         CLR   R3,R2
         BL    *+L'*+14
         MVC   VERLNE+2(27),=CL27'NO QUERY REPLY AID RECEIVED'
         BAS   R8,VERDQL
         B     VERDQC
         LA    R4,1
         UNPK  VERLNE+2(3),0(2,R3)
         TR    VERLNE+2(2),TRHEX-X'F0'
         MVC   VERLNE+4(18),=CL18' = QUERY REPLY AID'
         CLI   0(R3),88
         BNE   *+L'*+6
         MVC   VERLNE+23(16),=CL16'(ERROR / NOT 88)'
         BAS   R8,VERDQL
VERDQ1   ALR   R3,R4
         CLR   R3,R2
         BNL   VERDQC
         MVI   VERLNE,C'0'
         UNPK  VERLNE+2(5),0(3,R3)
         TR    VERLNE+2(4),TRHEX-X'F0'
         MVC   VERLNE+6(29),=CL29' = LENGTH OF NEXT INFORMATION'
         LA    R0,1(R3)
         CLR   R0,R2
         BL    *+L'*+12
         MVC   VERLNE+4(2),=CL2' '
         MVC   VERLNE+36(7),=CL7'(ERROR)'
         BAS   R8,VERDQL
         XR    R4,R4
         ICM   R4,B'0011',0(R3)
         LA    R0,0(R3,R4)
         CLR   R0,R2
         BNH   *+L'*+4
         LR    R4,R2
         SLR   R4,R3
         LR    R5,R4
         SH    R5,=H'2'
         BNP   VERDQ1
         UNPK  VERLNE+2(5),2(3,R3)
         TR    VERLNE+2(4),TRHEX-X'F0'
         MVC   VERLNE+6(18),=CL18' = QUERY LIST CODE'
         CH    R5,=H'2'
         BNL   *+L'*+12
         MVC   VERLNE+4(2),=CL2' '
         MVC   VERLNE+25(7),=CL7'(ERROR)'
         BAS   R8,VERDQL
         SH    R5,=H'2'
         BNP   VERDQ1
         MVC   VERLNE+4(6),=CL6'DATA ='
         LA    R6,4(R3)
VERDQ2   LA    R0,32
         CLR   R0,R5
         BNH   *+L'*+2
         LR    R0,R5
         SR    R5,R0
         LR    R8,R0
         LA    R7,VERLNE+11
         XR    R1,R1
VERDQ3   IC    R1,0(R6)
         STC   R1,1(R7)
         SRL   R1,4
         STC   R1,0(R7)
         NC    0(2,R7),=XL2'0F0F'
         LA    R7,2(R7)
         LA    R6,1(R6)
         BCT   R0,VERDQ3
         SLL   R8,1
         BCT   R8,*+L'*+6
         TR    VERLNE+11(*-*),TRHEX
         EX    R8,*-6
         BAS   R8,VERDQL
         LTR   R5,R5
         BP    VERDQ2
         B     VERDQ1
VERDQL  $PRINT VERLNE,,DDTEST
         LTR   R10,R15
         BNZ   VERER1
         MVI   VERLNE,C' '
         MVC   VERLNE+1(L'VERLNE-1),VERLNE
         BR    R8
VERDQC   MVI   VERLNE,C'0'
         MVC   VERLNE+2(19),=CL19'--- END OF DATA ---'
         BAS   R8,VERDQL
        $PCLOSE
         LTR   R10,R15
         BNZ   VERER2
VERANL   LA    R1,1
         L     R2,BUFFA
         LR    R3,R2
         AL    R3,BUFFL
         SLR   R3,R1
VERSCN   ALR   R2,R1
         CLR   R2,R3
         BH    VERRET
         CLC   2(2,R2),=XL2'8186'  COLORS DEFINED ?
         BE    SETEXC              YES
         CLC   2(2,R2),=XL2'8187'  HIGHLIGHTING DEFINED ?
         BE    SETEXH              YES
         CLC   2(2,R2),=XL2'8185'  CHARACTER SETS DEFINED ?
         BE    SETEXS              YES
         CLC   2(2,R2),=XL2'8181'  USABLE AREA DEFINED ?
         BE    SETEXA              YES
VERNXT   XR    R1,R1
         ICM   R1,B'0011',0(R2)
         B     VERSCN
SETEXC   CLC   0(2,R2),=H'6'
         BL    VERNXT
         CLI   5(R2),8
         BL    VERNXT
         OI    SWITCH,FSEXC
         B     VERNXT
SETEXH   CLC   0(2,R2),=H'5'
         BL    VERNXT
         CLI   4(R2),4
         BL    VERNXT
         OI    SWITCH,FSEXH
         B     VERNXT
SETEXS   CLC   0(2,R2),=H'13'
         BL    VERNXT
         TM    4(R2),X'80'         GE SUPPORT
         BZ    VERNXT
         OI    SWITCH,FSXGE
         ST    R2,PSQA
         TM    8(R2),X'40'         LPS DATA TYPE 1 SUPPORT
         BZ    VERNXT
         OI    SWITCH,FSEXS
         B     VERNXT
SETEXA   CLC   0(2,R2),=H'23'
         BL    VERNXT
         TM    4(R2),X'20'         3270DS SUPPORT
         BO    VERNXT
         OI    SWITCH,FSEXD
         ST    R2,UAQA
         B     VERNXT
VERRET   TM    SWITCH,FSEXC+FSEXH+FSXGE
         BNO   VERER3
         L     R13,4(R13)
         ST    R10,16(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     4(R14)
VERER1   LA    R2,L'VER1MSG
         LA    R3,VER1MSG
        $PCLOSE
         B     VERERX
VERER2   LA    R2,L'VER2MSG
         LA    R3,VER2MSG
         B     VERERX
VERER3   TM    SWITCH,FSXGE
         BO    *+L'*+4
         MVI   VER3MSG+25,C'G'
         TM    SWITCH,FSEXH
         BO    *+L'*+4
         MVI   VER3MSG+25,C'H'
         TM    SWITCH,FSEXC
         BO    *+L'*+4
         MVI   VER3MSG+25,C'C'
         LA    R2,L'VER3MSG
         LA    R3,VER3MSG
VERERX   MVI   OPT,FSEXIT
        @FS    OPT
         LTR   R10,R10
         BNZ   *+L'*+2
         LR    R10,R15
        TPUT   (R3),(R2),R
         LTR   R10,R10
         BNZ   VERRXR
         LR    R10,R15
VERRXR   L     R13,4(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         BR    R14
         SPACE 1
DDTEST   DC    CL8'SYSTEST'
TRHEX    DC    CL16'0123456789ABCDEF'
         DC    AL1(L'VERLNE)
VERLNE   DC    CL79' '
         SPACE 1
VER1MSG  DC    C' --- "$PRINT" error -> Exit ---'
VER2MSG  DC    C' --- "$PCLOSE" error -> Exit ---'
VER3MSG  DC    C' --- QUERY reply scan : " "  missing -> Exit ---'
         SPACE 1
        LTORG
         SPACE 1
         DROP  R12                 KILL LOCAL ADDRESSABILITY
         DROP  R11                 KILL BASE ADDRESSABILITY
         EJECT
*------- TEST NUMBER 1 - COLOURS.
         SPACE 1
         CNOP  0,4
         USING *,R12               LOCAL ADDRESSABILITY
         USING T3270FS,R11         BASE ADDRESSABILITY
T01      STM   R14,R12,12(R13)
         LR    R12,R15
         LR    R15,R13
         LA    R13,T01SV
         B     T01CS
T01SV    DC    18F'0'
T01CS    ST    R13,8(R15)
         ST    R15,4(R13)
         LH    R2,TNR
T01BIG   LA    R3,3
T01HIGH  LR    R1,R3
         SLL   R1,2
         L     R6,=A(T01RGE)
         B     *(R1)
         B     T01GE93             1
         B     T01GE94             2
         B     T01GE95             3
T01GE93 $FS    RA=(24,1,GE,93),MF=(I,(R6))
         B     T01SA
T01GE94 $FS    RA=(24,1,GE,94),MF=(I,(R6))
         B     T01SA
T01GE95 $FS    RA=(24,1,GE,95),MF=(I,(R6))
T01SA    LA    R4,T01SELN
         CLI   TNS,255
         BE    T01LOW
         LA    R15,T01SEL
         XR    R1,R1
         IC    R1,TNS
T01SNX   EX    R1,T01SCN
         BE    T01SET
         LA    R15,L'T01SEL(R15)
         BCT   R4,T01SNX
         LA    R2,=CL35'Unknown or invalid colour specified'
         LA    R3,35-1
         L     R13,4(R13)
         STM   R2,R3,20(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     8(R14)
T01SCN   CLC   TNS+1(*-*),1(R15)
T01SET   IC    R1,0(R15)
         LA    R4,1
         B     T01LOW+L'T01LOW
T01LOW   LR    R1,R4
         SLL   R1,2
         LM    R6,R8,=A(T01SCL,T01SAC,T01NME)
         B     *(R1)
         B     T01SAW              1
         B     T01SAY              2
         B     T01SAT              3
         B     T01SAG              4
         B     T01SAP              5
         B     T01SAR              6
         B     T01SAB              7
T01SAW  $FS    SA=(COLOUR,WHITE),MF=(I,(R6))
        $FS    SA=(COLOUR,WHITE),MF=(I,(R7))
         MVC   0(8,R8),T01SEL+1
         B     T01XFS
T01SAY  $FS    SA=(COLOUR,YELLOW),MF=(I,(R6))
        $FS    SA=(COLOUR,YELLOW),MF=(I,(R7))
         MVC   0(8,R8),T01SEL+L'T01SEL+1
         B     T01XFS
T01SAT  $FS    SA=(COLOUR,TURQ),MF=(I,(R6))
        $FS    SA=(COLOUR,TURQ),MF=(I,(R7))
         MVC   0(8,R8),T01SEL+2*L'T01SEL+1
         B     T01XFS
T01SAG  $FS    SA=(COLOUR,GREEN),MF=(I,(R6))
        $FS    SA=(COLOUR,GREEN),MF=(I,(R7))
         MVC   0(8,R8),T01SEL+3*L'T01SEL+1
         B     T01XFS
T01SAP  $FS    SA=(COLOUR,PINK),MF=(I,(R6))
        $FS    SA=(COLOUR,PINK),MF=(I,(R7))
         MVC   0(8,R8),T01SEL+4*L'T01SEL+1
         B     T01XFS
T01SAR  $FS    SA=(COLOUR,RED),MF=(I,(R6))
        $FS    SA=(COLOUR,RED),MF=(I,(R7))
         MVC   0(8,R8),T01SEL+5*L'T01SEL+1
         B     T01XFS
T01SAB  $FS    SA=(COLOUR,BLUE),MF=(I,(R6))
        $FS    SA=(COLOUR,BLUE),MF=(I,(R7))
         MVC   0(8,R8),T01SEL+6*L'T01SEL+1
T01XFS   OI    OPT,FSSKIP
        @FS    OPT,T01MS,T01MSL
         LTR   R10,R15
         BNZ   T01ERR
        STIMER WAIT,,BINTVL=T01TSC,ERRET=T01INT
         BCT   R4,T01LOW
         BCT   R3,T01HIGH
         BCT   R2,T01BIG
         L     R13,4(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         BR    R14
T01INT   LH    R10,=H'99'
T01ERR   L     R13,4(R13)
         ST    R10,16(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     4(R14)
         SPACE 1
T01TSC   DC    A(1*100)            1.00 SEC INTERVAL
T01MSL   DC    A(LT01MS)
T01SEL   DS    0CL9
         DC    AL1(1),CL8'WHITE'
         DC    AL1(2),CL8'YELLOW'
         DC    AL1(3),CL8'TURQ'
         DC    AL1(4),CL8'GREEN'
         DC    AL1(5),CL8'PINK'
         DC    AL1(6),CL8'RED'
         DC    AL1(7),CL8'BLUE'
T01SELN  EQU   (*-T01SEL)/L'T01SEL
         SPACE 1
        LTORG
         SPACE 1
         DROP  R12                 KILL LOCAL ADDRESSABILITY
         DROP  R11                 KILL BASE ADDRESSABILITY
         EJECT
        PRINT  NOGEN
T01MS    $FS   CC=EW,WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,1),SF=(PROT),MF=L
         $FS   SBA=(1,15),SF=(PROT),MF=L
         $FS   SBA=(1,24),SF=NORMAL,MF=L
         $FS   SBA=(1,26),SF=(PROT),MF=L
         $FS   SBA=(2,80),SF=(PROT),MF=L
         $FS   SBA=(24,1),SF=(PROT),MF=L
         $FS   SBA=(1,2),SA=(HILITE,USCORE),MF=L
T01SCL   $FS   SA=RESET,MF=L
         $FS   TEXT='Test colour :',MF=L
         $FS   SBA=(1,16),SA=(HILITE,DEFAULT),MF=L
T01NME   $FS   TEXT=(' ',8),MF=L
         $FS   SA=(HILITE,DEFAULT),MF=L
         $FS   SBA=(3,1),MF=L
T01SAC   $FS   SA=RESET,MF=L
T01RGE   $FS   RA=(24,1,GE,FILL),MF=L
         $FS   SBA=(1,1),SF=(PT,IC),MF=L
LT01MS   EQU   *-T01MS
        PRINT  GEN
         EJECT
*------- TEST NUMBER 2 - DISPLAY ALL PS.
         SPACE 1
         CNOP  0,4
         USING *,R12               LOCAL ADDRESSABILITY
         USING T3270FS,R11         BASE ADDRESSABILITY
T02      STM   R14,R12,12(R13)
         LR    R12,R15
         LR    R15,R13
         LA    R13,T02SV
         B     T02CS
T02SV    DC    18F'0'
T02CS    ST    R13,8(R15)
         ST    R15,4(R13)
         LH    R8,TNR
T02L     L     R1,PSQA
         XR    R7,R7
         ICM   R7,B'0011',0(R1)
         LA    R2,0(R7,R1)
         XR    R7,R7
         IC    R7,12(R1)
         LTR   R7,R7
         BNP   T02ER1
         LA    R6,13(R1)
T02SCN   CLR   R6,R2
         BNL   T02TST
         CLI   2(R6),X'FF'         FREE PS
         BE    T02FR
         XR    R1,R1
         IC    R1,0(R6)
         STC   R1,WORK+1
         SRL   R1,4
         STC   R1,WORK
         IC    R1,2(R6)
         LR    R0,R1
         STC   R1,WORK+3
         SRL   R1,4
         STC   R1,WORK+2
         NC    WORK(4),=XL4'0F0F0F0F'
         TR    WORK(4),=CL16'0123456789ABCDEF'
         L     R1,=A(T02PSN)
         MVC   0(2,R1),WORK
         MVC   11(2,R1),WORK+2
         LA    R14,T02VSTN
         LA    R15,T02VST
         L     R1,0(R15)
         STC   R0,2(R1)
         LA    R15,4(R15)
         BCT   R14,*-12
         L     R1,=A(T02PSM)
         MVI   0(R1),C' '
         MVC   1(L'T02PSM-1,R1),0(R1)
         TM    1(R6),X'80'
         BO    *+L'*+10
         MVC   0(3,R1),=CL3'not'
         LA    R1,4(R1)
         MVC   0(8,R1),=CL8'loadable'
         MVC   9(6,R1),=CL6'triple'
         TM    1(R6),X'40'
         BO    *+L'*+6
         MVC   9(6,R1),=CL6'single'
         MVC   15(6,R1),=CL6'-plane'
         CLI   2(R6),0
         BNE   *+L'*+6
         MVC   22(13,R1),=CL13'(default set)'
         CLI   2(R6),C'1'
         BNE   *+L'*+6
         MVC   22(19,R1),=CL19'(used by GE orders)'
         L     R3,=A(T02PST)
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,GREEN),      X
               MF=(I,(R3))
         L     R1,=A(T02PSA)
         MVI   0(R1),C' '
         MVC   1(L'T02PSA-1,R1),0(R1)
         TM    1(R6),X'80'
         BO    T02NCC
         MVC   0(3,R1),=CL3'not'
         LA    R1,4(R1)
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,RED),        X
               MF=(I,(R3))
T02NCC   MVC   0(9,R1),=CL9'resetable'
         L     R3,=A(T02PSC2)
         MVI   0(R3),C' '
         MVC   1(64,R3),0(R3)
         L     R4,=A(T02PSC0)
         MVC   0(9,R4),0(R3)
         L     R4,=A(T02PSC1)
         MVC   0(6,R4),0(R3)
         L     R4,=A(T02PSC3)
         MVC   0(6,R4),0(R3)
         L     R4,=A(T02PSC4)
         MVC   0(65,R4),0(R3)
         L     R3,=A(T02PSCZ)
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,YELLOW),         X
               MF=(I,(R3))
         L     R1,PSQA
         TM    4(R1),X'02'         CGCSGID ?
         BZ    T02LDS              NO
         L     R1,=A(T02PSC0)
         MVC   0(9,R1),=CL9'CGCSGID :'
        $FS    SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,YELLOW),          X
               MF=(I,(R3))
         LR    R1,R6
         BAS   R5,T02SID
         B     T02SIN
         L     R1,=A(T02PSC1)
         CLI   4(R4),C'C'
         BE    *+L'*+10
         MVC   0(6,R1),=CL6'Base ='
         B     *+L'*+6
         MVC   0(6,R1),=CL6'CECP ='
         L     R1,=A(T02PSC2)
         EX    R3,T02MVC
         B     T02SIA
T02SIN   L     R1,=A(T02PSC1)
         MVC   0(6,R1),=CL6'???? ='
         L     R1,=A(T02PSC2)
         MVC   0(16,R1),=CL16'Unknown type |||'
T02SIA   LR    R1,R6
         ALR   R1,R7
         CLR   R1,R2
         BNL   T02LDS
         CLC   0(3,R6),0(R1)
         BNE   T02LDS
         LR    R6,R1
         BAS   R5,T02SID
         B     T02NIS
         L     R1,=A(T02PSC3)
         CLI   4(R4),C'C'
         BE    *+L'*+10
         MVC   0(6,R1),=CL6'Base ='
         B     *+L'*+6
         MVC   0(6,R1),=CL6'CECP ='
         L     R1,=A(T02PSC4)
         EX    R3,T02MVC
         B     T02LDS
T02NIS   L     R1,=A(T02PSC3)
         MVC   0(6,R1),=CL6'???? ='
         L     R1,=A(T02PSC4)
         MVC   0(16,R1),=CL16'Unknown type |||'
T02LDS   LM    R3,R4,=A(T02MS1,T02MS1L)
         B     T02SSS
T02MVC   MVC   0(*-*,R1),6(R4)
T02FR    XR    R1,R1
         IC    R1,0(R6)
         STC   R1,WORK+1
         SRL   R1,4
         STC   R1,WORK
         IC    R1,2(R6)
         LR    R0,R1
         STC   R1,WORK+3
         SRL   R1,4
         STC   R1,WORK+2
         NC    WORK(4),=XL4'0F0F0F0F'
         TR    WORK(4),=CL16'0123456789ABCDEF'
         L     R1,=A(T02FRN)
         MVC   0(2,R1),WORK
         MVC   11(2,R1),WORK+2
         L     R1,=A(T02FRM)
         MVI   0(R1),C' '
         MVC   1(L'T02FRM-1,R1),0(R1)
         TM    1(R6),X'80'
         BO    *+L'*+10
         MVC   0(3,R1),=CL3'not'
         LA    R1,4(R1)
         MVC   0(8,R1),=CL8'loadable'
         MVC   9(6,R1),=CL6'triple'
         TM    1(R6),X'40'
         BO    *+L'*+6
         MVC   9(6,R1),=CL6'single'
         MVC   15(6,R1),=CL6'-plane'
         L     R3,=A(T02FRT)
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,GREEN),      X
               MF=(I,(R3))
         L     R1,=A(T02FRA)
         MVI   0(R1),C' '
         MVC   1(L'T02FRA-1,R1),0(R1)
         TM    1(R6),X'80'
         BO    T02FR1
         MVC   0(3,R1),=CL3'not'
         LA    R1,4(R1)
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,RED),        X
               MF=(I,(R3))
T02FR1   MVC   0(9,R1),=CL9'resetable'
         LM    R3,R4,=A(T02MS2,T02MS2L)
T02SSS   NI    OPT,255-FSSKIP
         BAS   R5,T02SND
         B     T02ERR
         TM    1(R6),X'80'
         BZ    T02NXT
         CLI   3(R15),C'R'
         BNE   T02NXT
         L     R1,=A(T02RWS)       PS RESET
         MVC   0(1,R1),0(R6)
         OI    OPT,FSSKIP
         LM    R3,R4,=A(T02MS3,T02MS3L)
         BAS   R5,T02SND
         B     T02ERR
         LA    R3,SSID
         LA    R4,NSID
         CL    R6,0(R3)
         BE    T02RSP
         LA    R3,L'SSID(R3)
         BCT   R4,*-12
         B     T02RST
T02RSP   XC    0(4,R3),0(R3)
T02RST   MVI   2(R6),X'FF'         FREE LCID
T02NXT   ALR   R6,R7
         B     T02SCN
T02TST   BCT   R8,T02L
         B     T02XRT
T02SID   XR    R3,R3
         L     R4,=A(T02TBN)
         CLC   3(4,R1),0(R4)
         BE    *+L'*+20
         IC    R3,5(R4)
         LA    R4,7(R3,R4)
         CLC   0(4,R4),=XL4'0'
         BNE   *-24
         BR    R5
         IC    R3,5(R4)
         B     4(R5)
T02SND  @FS    OPT,(R3),(R4)
         LTR   R10,R15
         BNZR  R5
         LA    R5,4(R5)
         LTR   R1,R1
         BZR   R5
         CLI   0(R1),X'7D'         ENTER KEY
         BNER  R5
        @FSR   ,
         LTR   R15,R15
         BZR   R5
         LTR   R1,R1
         BNPR  R5
         CH    R1,=H'1'
         BNER  R5
         OI    3(R15),C' '
         CLI   3(R15),C'Z'
         BNER  R5
T02XRT   L     R13,4(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         BR    R14
T02ERR   L     R13,4(R13)
         ST    R10,16(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     4(R14)
T02ER1   LA    R2,=CL34'Descriptor length is zero, so none'
         LA    R3,34-1
         L     R13,4(R13)
         STM   R2,R3,20(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     8(R14)
         SPACE 1
T02MS1L  DC    A(LT02MS1)
T02MS2L  DC    A(LT02MS2)
T02MS3L  DC    A(LT02MS3)
T02VST   DC    A(T02PS1,T02PS2,T02PS3,T02PS4,T02PS5,T02PS6)
         DC    A(T02PS7,T02PS8,T02PS9,T02PS10,T02PS11,T02PS12)
T02VSTN  EQU   (*-T02VST)/L'T02VST
         SPACE 1
        LTORG
         SPACE 1
         DROP  R12                 KILL LOCAL ADDRESSABILITY
         DROP  R11                 KILL BASE ADDRESSABILITY
         EJECT
        PRINT  NOGEN
T02MS1   $FS   CC=EW,WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,35),SF=NORMAL,MF=L
         $FS   SBA=(1,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,YELLOW),MF=L
         $FS   TEXT='Display Programmed Symbols (PS) :',MF=L
         $FS   SBA=(1,38),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='(type E or just ENTER-key to continue,',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(2,38),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='type R to reset PS, or type Z to stop)',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(4,5),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         $FS   TEXT='0 1 2 3 4 5 6 7 8 9 A B C D E F',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(4,45),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         $FS   TEXT='0 1 2 3 4 5 6 7 8 9 A B C D E F',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(6,1),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='4 -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS1   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(40404140424043404440454046404740),MF=L
         $FS   SET=(484049404A404B404C404D404E404F),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(6,41),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='5 -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS2   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(50405140524053405440554056405740),MF=L
         $FS   SET=(584059405A405B405C405D405E405F),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(8,1),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='6 -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS3   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(60406140624063406440654066406740),MF=L
         $FS   SET=(684069406A406B406C406D406E406F),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(8,41),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='7 -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS4   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(70407140724073407440754076407740),MF=L
         $FS   SET=(784079407A407B407C407D407E407F),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(10,1),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='8 -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS5   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(80408140824083408440854086408740),MF=L
         $FS   SET=(884089408A408B408C408D408E408F),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(10,41),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='9 -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS6   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(90409140924093409440954096409740),MF=L
         $FS   SET=(984099409A409B409C409D409E409F),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(12,1),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='A -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS7   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(A040A140A240A340A440A540A640A740),MF=L
         $FS   SET=(A840A940AA40AB40AC40AD40AE40AF),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(12,41),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='B -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS8   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(B040B140B240B340B440B540B640B740),MF=L
         $FS   SET=(B840B940BA40BB40BC40BD40BE40BF),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(14,1),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='C -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS9   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(C040C140C240C340C440C540C640C740),MF=L
         $FS   SET=(C840C940CA40CB40CC40CD40CE40CF),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(14,41),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='D -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS10  $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(D040D140D240D340D440D540D640D740),MF=L
         $FS   SET=(D840D940DA40DB40DC40DD40DE40DF),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(16,1),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='E -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS11  $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(E040E140E240E340E440E540E640E740),MF=L
         $FS   SET=(E840E940EA40EB40EC40ED40EE40EF),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(16,41),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         $FS   TEXT='F -',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PS12  $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SET=(F040F140F240F340F440F540F640F740),MF=L
         $FS   SET=(F840F940FA40FB40FC40FD40FE),MF=L
         $FS   SA=(PGSYM,DEFAULT),SF=(PROT),MF=L
         $FS   SBA=(19,16),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
T02PSN   $FS   TEXT='   (LCID =   ) /',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
T02PSM   $FS   TEXT=(' ',46),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(19,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,RED),MF=L
         $FS   TEXT='Stored PS n¢ :',MF=L
         $FS   SBA=(20,16),MF=L
T02PST   $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,RED),MF=L
         $FS   TEXT='Advice :',MF=L
         $FS   SBA=(20,25),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   TEXT='this PS table is ',MF=L
T02PSA   $FS   TEXT=(' ',15),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(21,11),SF=(PROT),MF=L
         $FS   SBA=(21,1),MF=L
T02PSCZ  $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,YELLOW),MF=L
T02PSC0  $FS   TEXT=(' ',9),MF=L
         $FS   SBA=(22,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
T02PSC1  $FS   TEXT=(' ',6),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PSC2  $FS   TEXT=(' ',65),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(23,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
T02PSC3  $FS   TEXT=(' ',6),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
T02PSC4  $FS   TEXT=(' ',65),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(1,1),SF=(PT,IC),MF=L
LT02MS1  EQU   *-T02MS1
         SPACE 1
T02MS2   $FS   CC=EW,WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,35),SF=NORMAL,MF=L
         $FS   SBA=(1,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,YELLOW),MF=L
         $FS   TEXT='Display Programmed Symbols (PS) :',MF=L
         $FS   SBA=(1,38),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='(type E or just ENTER-key to continue,',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(2,38),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='type R to reset PS, or type Z to stop)',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(5,16),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
T02FRN   $FS   TEXT='   (LCID =   ) /',MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
T02FRM   $FS   TEXT=(' ',46),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(5,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,RED),MF=L
         $FS   TEXT='Free - PS n¢ :',MF=L
         $FS   SBA=(6,16),MF=L
T02FRT   $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,RED),MF=L
         $FS   TEXT='Advice :',MF=L
         $FS   SBA=(6,25),MF=L
         $FS   SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         $FS   TEXT='this PS table is ',MF=L
T02FRA   $FS   TEXT=(' ',15),MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(1,1),SF=(PT,IC),MF=L
LT02MS2  EQU   *-T02MS2
        PRINT  GEN
         SPACE 1
T02MS3   $FS   CC=WSF,MF=L         WRITE STRUCTURED FIELD
T02MS31  DC    AL2(T02ML31)        LENGTH OF STRUCTURED FIELD
         DC    X'06'               LOAD PROGRAMMED SYMBOLS (LOAD PS)
         DC    B'01000001'         FLAGS - BASIC FORM
*                                        - CLEAR
*                                        - NO SUPRESSION
*                                        - DATA TYPE 1
         DC    X'FF'               LCID - LOCAL CHARACTER SET ID
         DC    X'41'               CHAR - SLOT IN RWS FOR FIRST CHAR
T02RWS   DC    X'00'               RWS - PHYSICAL RWS TO BE LOADED
T02ML31  EQU   *-T02MS31
LT02MS3  EQU   *-T02MS3
         EJECT
        PRINT  NOGEN
T02TBN  #GTB   C=00650025,T=B,                                         X
               L='EBCDIC (WT), English (U.S.A.), and Netherlands'
        #GTB   C=00670026,T=B,                                         X
               L='English (U.S.A.) ASCII-international'
        #GTB   C=0067016F,T=B,                                         X
               L='English (U.S.A.) ASCII-7 and ASCII-8'
        #GTB   C=006701F4,T=B,                                         X
               L='International'
        #GTB   C=01090111,T=B,                                         X
               L='Austrian/German'
        #GTB   C=010D0112,T=B,                                         X
               L='Belgian'
        #GTB   C=01110113,T=B,                                         X
               L='Brazilian'
        #GTB   C=011D0116,T=B,                                         X
               L='Finnish and Swedish'
        #GTB   C=01190115,T=B,                                         X
               L='Dannish and Norwegian'
        #GTB   C=01250118,T=B,                                         X
               L='Italian'
        #GTB   C=01290119,T=B,                                         X
               L='Japanese English'
        #GTB   C=0135011C,T=B,                                         X
               L='Spanish-Speaking'
        #GTB   C=0139011D,T=B,                                         X
               L='English (U.K.)'
        #GTB   C=014C0122,T=B,                                         X
               L='Japanese Katakana)'
        #GTB   C=017E0136,T=B,                                         X
               L='APL'
        #GTB   C=028A011C,T=B,                                         X
               L='Spanish'
        #GTB   C=02B90025,T=C,                                         X
               L='Canadian Bilingual, English (U.S.A.), Netherlands, anX
               d Portuguese'
        #GTB   C=02B901F4,T=C,                                         X
               L='Swiss-French (New), Swiss-German (New), and Belgian (X
               New)'
        #GTB   C=02B9011C,T=C,                                         X
               L='Spanish and Spanish-Speaking'
        #GTB   C=02B9011D,T=C,                                         X
               L='English (U.K.)'
        #GTB   C=02B90111,T=C,                                         X
               L='Austrian/German'
        #GTB   C=02B90115,T=C,                                         X
               L='Danish and Norwegian'
        #GTB   C=02B90116,T=C,                                         X
               L='Finnish and Swedish'
        #GTB   C=02B90118,T=C,                                         X
               L='Italian'
        #GTB   C=02B90129,T=C,                                         X
               L='French'
        #GTB   C=02B90367,T=C,                                         X
               L='Icelandic'
        #GTB   C=03AA0346,T=B,                                         X
               L='Thai'
        #GTB   C=03C30136,T=B,                                         X
               L='APL2'
        #GTB   C=038C01F4,T=B,                                         X
               L='Swiss-French (New) and Swiss-German (New)'
        #GTB   C=03890025,T=B,                                         X
               L='Canadian Bilingual'
        #GTB   C=045A0025,T=B,                                         X
               L='Portuguese'
        #GTB   C=045A01F4,T=B,                                         X
               L='Belgian (New)'
        #GTB   C=046401A7,T=B,                                         X
               L='Greek'
        #GTB   C=04650370,T=B,                                         X
               L='Cyrillic'
        #GTB   C=04660367,T=B,                                         X
               L='Icelandic'
        #GTB   C=04670389,T=B,                                         X
               L='Turkish'
        #GTB   C=04680366,T=B,                                         X
               L='ROECE Latin and Yugoslav'
        #GTB   C=04690129,T=B,                                         X
               L='French'
        #GTB   C=END
        PRINT  GEN
         EJECT
*------- TEST NUMBER 3 - LOAD PS SINGLE-PLANE.
         SPACE 1
         CNOP  0,4
         USING *,R12               LOCAL ADDRESSABILITY
         USING T3270FS,R11         BASE ADDRESSABILITY
T03      STM   R14,R12,12(R13)
         LR    R12,R15
         LR    R15,R13
         LA    R13,T03SV
         B     T03CS
T03SV    DC    18F'0'
T03CS    ST    R13,8(R15)
         ST    R15,4(R13)
         TM    SWITCH,FSEXS+FSEXD
         BNO   T03ER0
         MVI   T03SW,0
         CLI   TNS,255
         BNE   T03SLX
         OC    T03SVID,T03SVID
         BZ    T03PCD
         B     T03XDS
T03SLX   LA    R14,T03SELN
         LA    R15,T03SEL
         XR    R1,R1
         IC    R1,TNS
T03SNX   EX    R1,T03CMP
         BE    T03SET
         LA    R15,L'T03SEL(R15)
         BCT   R14,T03SNX
         LA    R2,=CL37'Unknown or invalid function specified'
         LA    R3,37-1
         B     T03ERM
T03CMP   CLC   TNS+1(*-*),0(R15)
T03SET   ICM   R14,B'1111',8(R15)
         BR    R14
T03DISP  OC    T03SVID,T03SVID
         BZ    T03ER1
         OI    T03SW,F03DISP
         B     T03XDS
T03CANL  OC    T03SVID,T03SVID
         BZ    T03ER2
         B     T03XCL
T03LOAD  OC    T03SVID,T03SVID
         BNZ   T03ER3
         OI    T03SW,F03LOAD
T03PCD   L     R2,PSQA
         TM    4(R2),X'30'         LPS AND LPSE SUPPORT
         BNO   T03ER4
         CLC   6(2,R2),=AL1(9,16)  DEFAULT SDW + SDH
         BNE   T03ER5
         TM    8(R2),X'40'         FORMAT TYPE 1
         BZ    T03ER6
         XR    R1,R1
         ICM   R1,B'0011',0(R2)
         LA    R5,0(R1,R2)
         XR    R1,R1
         IC    R1,12(R2)
         LTR   R1,R1
         BNP   T03ER7
         LA    R4,13(R2)
T03SCN   CLI   2(R4),X'FF'         FREE PS
         BNE   T03NXT
         TM    1(R4),X'80'         LOADABLE
         BZ    T03NXT
         TM    1(R4),X'40'         SINGLE-PLANE
         BZ    T03XLP
T03NXT   ALR   R4,R1
         CLR   R4,R5
         BL    T03SCN
         B     T03ER8
T03XLP   MVC   T03RWS1(1),0(R4)
         MVC   T03RWS3(1),0(R4)
         XR    R1,R1
         IC    R1,0(R4)
         STC   R1,T03RWS2+1
         SRL   R1,4
         STC   R1,T03RWS2
         NC    T03RWS2(2),=XL2'0F0F'
         TR    T03RWS2(2),=CL16'0123456789ABCDEF'
         L     R2,UAQA
         CLI   19(R2),9            AW (X UNITS)
         BNE   T03ER9
         CLI   20(R2),12           AH (Y UNITS)
         BL    T03ER9
         BH    T03STH
         LM    R14,R1,=A(T03UATB,T03UAL,T03UA12,T03UAL)
         MVCL  R14,R0
         B     T03STR
T03STH   LM    R14,R1,=A(T03UATB,T03UAL,T03UA16,T03UAL)
         MVCL  R14,R0
T03STR   L     R15,=A(SLLCID)      SELECT AN LCID
         BASR  R14,R15
         LTR   R0,R0
         BNP   T03ER10
         STC   R0,2(R4)            RETAIN LCID
         ST    R4,T03SVID
         L     R1,=A(T03LC11)
         STC   R0,0(R1)
         LA    R3,3
         LA    R4,=A(T03RA1,T03RA2,T03RA3)
         L     R1,0(R4)
         STC   R0,9(R1)
         LA    R4,4(R4)
         BCT   R3,*-12
         LA    R3,6
         LA    R4,=A(T03SA1,T03SA2,T03SA3,T03SA4,T03SA5,T03SA6)
         L     R1,0(R4)
         STC   R0,2(R1)
         LA    R4,4(R4)
         BCT   R3,*-12
         OI    OPT,FSSKIP
         LM    R3,R4,T03V1
         BAS   R5,T03SND
         B     T03ERR
         TM    T03SW,F03LOAD
         BO    T03XRT
T03XDS   LH    R6,TNR
T03L     NI    OPT,255-FSSKIP
         LM    R3,R4,T03V2
         BAS   R5,T03SND
         B     T03ERR
         BCT   R6,T03L
         TM    T03SW,F03DISP
         BO    T03XRT
T03XCL   OI    OPT,FSSKIP
         LM    R3,R4,T03V3
         BAS   R5,T03SND
         B     T03ERR
         L     R4,T03SVID
         MVI   2(R4),X'FF'         FREE LCID
         XC    T03SVID,T03SVID
         B     T03XRT
T03SND  @FS    OPT,(R3),(R4)
         LTR   R10,R15
         BNZR  R5
         LA    R5,4(R5)
         LTR   R1,R1
         BZR   R5
         CLI   0(R1),X'7D'         ENTER KEY
         BNER  R5
        @FSR   ,
         LTR   R15,R15
         BZR   R5
         LTR   R1,R1
         BNPR  R5
         CH    R1,=H'1'
         BNER  R5
         OI    3(R15),C' '
         CLI   3(R15),C'Z'
         BNER  R5
T03XRT   L     R13,4(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         BR    R14
T03ERR   L     R13,4(R13)
         ST    R10,16(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     4(R14)
T03ER0   LA    R2,=CL40'Unavailable : D and/or S missing (QUERY)'
         LA    R3,40-1
         B     T03ERM
T03ER1   LA    R2,=CL26'Single-plane PS not loaded'
         LA    R3,26-1
         B     T03ERM
T03ER2   LA    R2,=CL32'Single-plane PS already canceled'
         LA    R3,32-1
         B     T03ERM
T03ER3   LA    R2,=CL30'Single-plane PS already loaded'
         LA    R3,30-1
         B     T03ERM
T03ER4   LA    R2,=CL29'LPS and/or LPSE not supported'
         LA    R3,29-1
         B     T03ERM
T03ER5   LA    R2,=CL26'SDW and/or SDH not expected default'
         LA    R3,26-1
         B     T03ERM
T03ER6   LA    R2,=CL35'Load PS format type 1 not supported'
         LA    R3,35-1
         B     T03ERM
T03ER7   LA    R2,=CL34'Descriptor length is zero, so none'
         LA    R3,34-1
         B     T03ERM
T03ER8   LA    R2,=CL38'No loadable single-plane free PS found'
         LA    R3,38-1
         B     T03ERM
T03ER9   LA    R2,=CL43'Unexpected AW (X units) and/or AH (Y units)'
         LA    R3,43-1
         B     T03ERM
T03ER10  LA    R2,=CL42'No LCID (local character set ID) available'
         LA    R3,42-1
T03ERM   L     R13,4(R13)
         STM   R2,R3,20(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     8(R14)
         SPACE 1
T03MS1L  DC    A(LT03MS1)
T03MS2L  DC    A(LT03MS2)
T03MS3L  DC    A(LT03MS3)
T03V1    DC    A(T03MS1,T03MS1L)
T03V2    DC    A(T03MS2,T03MS2L)
T03V3    DC    A(T03MS3,T03MS3L)
T03SEL   DS    0CL12
         DC    CL8'LOAD',A(T03LOAD)
         DC    CL8'DISPLAY',A(T03DISP)
         DC    CL8'CANCEL',A(T03CANL)
T03SELN  EQU   (*-T03SEL)/L'T03SEL
T03SW    DC    XL1'0'
F03LOAD  EQU   X'80'
F03DISP  EQU   X'40'
F03CANL  EQU   X'20'
         SPACE 1
        LTORG
         SPACE 1
         DROP  R12                 KILL LOCAL ADDRESSABILITY
         DROP  R11                 KILL BASE ADDRESSABILITY
         EJECT
T03MS1   $FS   CC=WSF,MF=L         WRITE STRUCTURED FIELD
T03MS11  DC    AL2(T03ML11)        LENGTH OF STRUCTURED FIELD
         DC    X'06'               LOAD PROGRAMMED SYMBOLS (LOAD PS)
         DC    B'01000001'         FLAGS - BASIC FORM
*                                        - CLEAR
*                                        - NO SUPRESSION
*                                        - DATA TYPE 1
T03LC11  DC    X'00'               LCID - LOCAL CHARACTER SET ID
         DC    X'50'               CHAR - SLOT IN RWS FOR FIRST CHAR
T03RWS1  DC    X'00'               RWS - PHYSICAL RWS TO BE LOADED
T03UATB  DC    (T03UAL)X'0'
T03ML11  EQU   *-T03MS11
LT03MS1  EQU   *-T03MS1
         SPACE 1
         PRINT NOGEN
T03MS2   $FS   CC=EW,WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,29),SF=NORMAL,MF=L
         $FS   SBA=(1,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,YELLOW),MF=L
         $FS   TEXT='Load PS single-plane test :',MF=L
         $FS   SBA=(1,31),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='(E or ENTER-key = continue or Z = stop)',MF=L
         $FS   SBA=(2,1),SF=(PROT),MF=L
         $FS   SBA=(4,21),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,RED),MF=L
T03RWS2  $FS   TEXT='  ',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(4,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,TURQ),MF=L
         $FS   TEXT='Stored PS n¢ is :',MF=L
         $FS   SBA=(10,58),SF=(PROT),MF=L
         $FS   SBA=(10,22),MF=L
T03RA1   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE,           X
               PGSYM,DEFAULT),RA=(10,58,5B),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(12,48),SF=(PROT),MF=L
         $FS   SBA=(12,32),MF=L
T03SA1   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         $FS   SET=(535757575757575757575757575754),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(13,48),SF=(PROT),MF=L
         $FS   SBA=(13,32),MF=L
T03SA2   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         $FS   SET=(5A4050405140524052405140504058),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(14,48),SF=(PROT),MF=L
         $FS   SBA=(14,32),MF=L
T03SA3   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         $FS   SET=(555959595959595959595959595956),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(16,58),SF=(PROT),MF=L
         $FS   SBA=(16,22),MF=L
T03RA2   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE,           X
               PGSYM,DEFAULT),RA=(16,58,5B),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(18,48),SF=(PROT),MF=L
         $FS   SBA=(18,32),MF=L
T03SA4   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,WHITE),MF=L
         $FS   SET=(535757575757575757575757575754),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(19,48),SF=(PROT),MF=L
         $FS   SBA=(19,32),MF=L
T03SA5   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,WHITE),MF=L
         $FS   SET=(5A4050405140524052405140504058),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(20,48),SF=(PROT),MF=L
         $FS   SBA=(20,32),MF=L
T03SA6   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,WHITE),MF=L
         $FS   SET=(555959595959595959595959595956),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(22,58),SF=(PROT),MF=L
         $FS   SBA=(22,22),MF=L
T03RA3   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE,           X
               PGSYM,DEFAULT),RA=(22,58,5B),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(1,1),SF=(PT,IC),MF=L
LT03MS2  EQU   *-T03MS2
        PRINT  GEN
         SPACE 1
T03MS3   $FS   CC=WSF,MF=L         WRITE STRUCTURED FIELD
T03MS31  DC    AL2(T03ML31)        LENGTH OF STRUCTURED FIELD
         DC    X'06'               LOAD PROGRAMMED SYMBOLS (LOAD PS)
         DC    B'01000001'         FLAGS - BASIC FORM
*                                        - CLEAR
*                                        - NO SUPRESSION
*                                        - DATA TYPE 1
         DC    X'FF'               LCID - LOCAL CHARACTER SET ID
         DC    X'41'               CHAR - SLOT IN RWS FOR FIRST CHAR
T03RWS3  DC    X'00'               RWS - PHYSICAL RWS TO BE LOADED
T03ML31  EQU   *-T03MS31
LT03MS3  EQU   *-T03MS3
         SPACE 1
        PRINT  NOGEN
T03UA16 $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               111111111,                                              X
               011111110,                                              X
               001111100,                                              X
               000111000,                                              X
               000010000,                                              X
               000111000,                                              X
               001111100,                                              X
               011111110,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,PL=SINGLE
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               100000001,                                              X
               110000011,                                              X
               111000111,                                              X
               111101111,                                              X
               111111111,                                              X
               111101111,                                              X
               111000111,                                              X
               110000011,                                              X
               100000001,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               111111111,                                              X
               100000001,                                              X
               101111101,                                              X
               101000101,                                              X
               101010101,                                              X
               101000101,                                              X
               101111101,                                              X
               100000001,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111
        $FSDOT 111111111,          START OF SYMBOL 4 X'53'             X
               100000000,                                              X
               101111111,                                              X
               101000000,                                              X
               101011111,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000
        $FSDOT 111111111,          START OF SYMBOL 5 X'54'             X
               000000001,                                              X
               111111101,                                              X
               000000101,                                              X
               111110101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101
        $FSDOT 101010000,          START OF SYMBOL 6 X'55'             X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101011111,                                              X
               101000000,                                              X
               101111111,                                              X
               100000000,                                              X
               111111111
        $FSDOT 000010101,          START OF SYMBOL 7 X'56'             X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               111110101,                                              X
               000000101,                                              X
               111111101,                                              X
               000000001,                                              X
               111111111
        $FSDOT 111111111,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
        $FSDOT 000010101,          START OF SYMBOL 9 X'58'             X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111
        $FSDOT 101010000,          START OF SYMBOL 11 X'5A'            X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               000000000,                                              X
               000000000,                                              X
               111111111,                                              X
               111111111,                                              X
               000000000,                                              X
               000000000,                                              X
               111111111,                                              X
               111111111,                                              X
               000000000,                                              X
               000000000,                                              X
               111111111,                                              X
               111111111,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
T03UAL   EQU   *-T03UA16
         SPACE 1
T03UA12 $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               111111111,                                              X
               011111110,                                              X
               001111100,                                              X
               000111000,                                              X
               000010000,                                              X
               000111000,                                              X
               001111100,                                              X
               011111110,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,H=12,PL=SINGLE
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               100000001,                                              X
               110000011,                                              X
               111000111,                                              X
               111101111,                                              X
               111111111,                                              X
               111101111,                                              X
               111000111,                                              X
               110000011,                                              X
               100000001,                                              X
               000000000,                                              X
               111111111,H=12
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               111111111,                                              X
               100000001,                                              X
               101111101,                                              X
               101000101,                                              X
               101010101,                                              X
               101000101,                                              X
               101111101,                                              X
               100000001,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,H=12
        $FSDOT 111111111,          START OF SYMBOL 4 X'53'             X
               100000000,                                              X
               101111111,                                              X
               101000000,                                              X
               101011111,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,H=12
        $FSDOT 111111111,          START OF SYMBOL 5 X'54'             X
               000000001,                                              X
               111111101,                                              X
               000000101,                                              X
               111110101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,H=12
        $FSDOT 101010000,          START OF SYMBOL 6 X'55'             X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101011111,                                              X
               101000000,                                              X
               101111111,                                              X
               100000000,                                              X
               111111111,H=12
        $FSDOT 000010101,          START OF SYMBOL 7 X'56'             X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               111110101,                                              X
               000000101,                                              X
               111111101,                                              X
               000000001,                                              X
               111111111,H=12
        $FSDOT 111111111,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,H=12
        $FSDOT 000010101,          START OF SYMBOL 9 X'58'             X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,                                              X
               000010101,H=12
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,                                              X
               000000000,                                              X
               111111111,H=12
        $FSDOT 101010000,          START OF SYMBOL 11 X'5A'            X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,                                              X
               101010000,H=12
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               111111111,                                              X
               111111111,                                              X
               000000000,                                              X
               000000000,                                              X
               111111111,                                              X
               111111111,                                              X
               000000000,                                              X
               000000000,                                              X
               111111111,                                              X
               111111111,                                              X
               000000000,H=12
        PRINT  GEN
         EJECT
*------- TEST NUMBER 4 - LOAD PS TRIPLE-PLANE.
         SPACE 1
         CNOP  0,4
         USING *,R12               LOCAL ADDRESSABILITY
         USING T3270FS,R11         BASE ADDRESSABILITY
T04      STM   R14,R12,12(R13)
         LR    R12,R15
         LR    R15,R13
         LA    R13,T04SV
         B     T04CS
T04SV    DC    18F'0'
T04CS    ST    R13,8(R15)
         ST    R15,4(R13)
         MVI   T04SW,0
         TM    SWITCH,FSEXS+FSEXD
         BNO   T04ER0
         CLI   TNS,255
         BNE   T04SLX
         OC    T04SVID,T04SVID
         BZ    T04PCD
         B     T04XDS
T04SLX   LA    R14,T04SELN
         LA    R15,T04SEL
         XR    R1,R1
         IC    R1,TNS
T04SNX   EX    R1,T04CMP
         BE    T04SET
         LA    R15,L'T04SEL(R15)
         BCT   R14,T04SNX
         LA    R2,=CL37'Unknown or invalid function specified'
         LA    R3,37-1
         B     T04ERM
T04CMP   CLC   TNS+1(*-*),0(R15)
T04SET   ICM   R14,B'1111',8(R15)
         BR    R14
T04DISP  OC    T04SVID,T04SVID
         BZ    T04ER1
         OI    T04SW,F04DISP
         B     T04XDS
T04CANL  OC    T04SVID,T04SVID
         BZ    T04ER2
         B     T04XCL
T04LOAD  OC    T04SVID,T04SVID
         BNZ   T04ER3
         OI    T04SW,F04LOAD
T04PCD   L     R2,PSQA
         TM    4(R2),X'30'         LPS AND LPSE SUPPORT
         BNO   T04ER4
         CLC   6(2,R2),=AL1(9,16)  DEFAULT SDW + SDH
         BNE   T04ER5
         TM    8(R2),X'40'         FORMAT TYPE 1
         BZ    T04ER6
         XR    R1,R1
         ICM   R1,B'0011',0(R2)
         LA    R5,0(R1,R2)
         XR    R1,R1
         IC    R1,12(R2)
         LTR   R1,R1
         BNP   T04ER7
         LA    R4,13(R2)
T04SCN   CLI   2(R4),X'FF'         FREE PS
         BNE   T04NXT
         TM    1(R4),X'80'         LOADABLE
         BZ    T04NXT
         TM    1(R4),X'40'         TRIPLE-PLANE
         BO    T04XLP
T04NXT   ALR   R4,R1
         CLR   R4,R5
         BL    T04SCN
         B     T04ER8
T04XLP   L     R1,=A(T04RWS11)
         MVC   0(1,R1),0(R4)
         L     R1,=A(T04RWS12)
         MVC   0(1,R1),0(R4)
         L     R1,=A(T04RWS13)
         MVC   0(1,R1),0(R4)
         L     R1,=A(T04RWS3)
         MVC   0(1,R1),0(R4)
         L     R2,=A(T04RWS2)
         XR    R1,R1
         IC    R1,0(R4)
         STC   R1,1(R2)
         SRL   R1,4
         STC   R1,0(R2)
         NC    0(2,R2),=XL2'0F0F'
         TR    0(2,R2),=CL16'0123456789ABCDEF'
         L     R2,UAQA
         CLI   19(R2),9            AW (X UNITS)
         BNE   T04ER9
         CLI   20(R2),12           AH (Y UNITS)
         BL    T04ER9
         BH    T04STH
         LM    R14,R1,=A(T04UTBB,T04UBL,T04U12B,T04UBL)
         MVCL  R14,R0
         LM    R14,R1,=A(T04UTBR,T04URL,T04U12R,T04URL)
         MVCL  R14,R0
         LM    R14,R1,=A(T04UTBG,T04UGL,T04U12G,T04UGL)
         MVCL  R14,R0
         B     T04STR
T04STH   LM    R14,R1,=A(T04UTBB,T04UBL,T04U16B,T04UBL)
         MVCL  R14,R0
         LM    R14,R1,=A(T04UTBR,T04URL,T04U16R,T04URL)
         MVCL  R14,R0
         LM    R14,R1,=A(T04UTBG,T04UGL,T04U16G,T04UGL)
         MVCL  R14,R0
T04STR   L     R15,=A(SLLCID)      SELECT AN LCID
         BASR  R14,R15
         LTR   R0,R0
         BNP   T04ER10
         STC   R0,2(R4)            RETAIN LCID
         ST    R4,T04SVID
         LA    R3,3
         LA    R4,=A(T04LC11,T04LC12,T04LC13)
         L     R1,0(R4)
         STC   R0,0(R1)
         LA    R4,4(R4)
         BCT   R3,*-12
         LA    R3,3
         LA    R4,=A(T04RA1,T04RA2,T04RA3)
         L     R1,0(R4)
         STC   R0,9(R1)
         LA    R4,4(R4)
         BCT   R3,*-12
         LA    R3,6
         LA    R4,=A(T04SA1,T04SA2,T04SA3,T04SA4,T04SA5,T04SA6)
         L     R1,0(R4)
         STC   R0,2(R1)
         LA    R4,4(R4)
         BCT   R3,*-12
         OI    OPT,FSSKIP
         LM    R3,R4,T04V1
         BAS   R5,T04SND
         B     T04ERR
         TM    T04SW,F04LOAD
         BO    T04XRT
T04XDS   LH    R6,TNR
T04L     NI    OPT,255-FSSKIP
         LM    R3,R4,T04V2
         BAS   R5,T04SND
         B     T04ERR
         BCT   R6,T04L
         TM    T04SW,F04DISP
         BO    T04XRT
T04XCL   OI    OPT,FSSKIP
         LM    R3,R4,T04V3
         BAS   R5,T04SND
         B     T04ERR
         L     R4,T04SVID
         MVI   2(R4),X'FF'         FREE LCID
         XC    T04SVID,T04SVID
         B     T04XRT
T04SND  @FS    OPT,(R3),(R4)
         LTR   R10,R15
         BNZR  R5
         LA    R5,4(R5)
         LTR   R1,R1
         BZR   R5
         CLI   0(R1),X'7D'         ENTER KEY
         BNER  R5
        @FSR   ,
         LTR   R15,R15
         BZR   R5
         LTR   R1,R1
         BNPR  R5
         CH    R1,=H'1'
         BNER  R5
         OI    3(R15),C' '
         CLI   3(R15),C'Z'
         BNER  R5
T04XRT   L     R13,4(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         BR    R14
T04ERR   L     R13,4(R13)
         ST    R10,16(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     4(R14)
T04ER0   LA    R2,=CL40'Unavailable : D and/or S missing (QUERY)'
         LA    R3,40-1
         B     T04ERM
T04ER1   LA    R2,=CL26'Triple-plane PS not loaded'
         LA    R3,26-1
         B     T04ERM
T04ER2   LA    R2,=CL32'Triple-plane PS already canceled'
         LA    R3,32-1
         B     T04ERM
T04ER3   LA    R2,=CL30'Triple-plane PS already loaded'
         LA    R3,30-1
         B     T04ERM
T04ER4   LA    R2,=CL29'LPS and/or LPSE not supported'
         LA    R3,29-1
         B     T04ERM
T04ER5   LA    R2,=CL26'SDW and/or SDH not expected default'
         LA    R3,26-1
         B     T04ERM
T04ER6   LA    R2,=CL35'Load PS format type 1 not supported'
         LA    R3,35-1
         B     T04ERM
T04ER7   LA    R2,=CL34'Descriptor length is zero, so none'
         LA    R3,34-1
         B     T04ERM
T04ER8   LA    R2,=CL38'No loadable triple-plane free PS found'
         LA    R3,38-1
         B     T04ERM
T04ER9   LA    R2,=CL43'Unexpected AW (X units) and/or AH (Y units)'
         LA    R3,43-1
         B     T04ERM
T04ER10  LA    R2,=CL42'No LCID (local character set ID) available'
         LA    R3,42-1
T04ERM   L     R13,4(R13)
         STM   R2,R3,20(R13)
         LM    R14,R12,12(R13)
         MVI   12(R13),X'FF'
         B     8(R14)
         SPACE 1
T04MS1L  DC    A(LT04MS1)
T04MS2L  DC    A(LT04MS2)
T04MS3L  DC    A(LT04MS3)
T04V1    DC    A(T04MS1,T04MS1L)
T04V2    DC    A(T04MS2,T04MS2L)
T04V3    DC    A(T04MS3,T04MS3L)
T04SEL   DS    0CL12
         DC    CL8'LOAD',A(T04LOAD)
         DC    CL8'DISPLAY',A(T04DISP)
         DC    CL8'CANCEL',A(T04CANL)
T04SELN  EQU   (*-T04SEL)/L'T04SEL
T04SW    DC    XL1'0'
F04LOAD  EQU   X'80'
F04DISP  EQU   X'40'
F04CANL  EQU   X'20'
         SPACE 1
        LTORG
         SPACE 1
         DROP  R12                 KILL LOCAL ADDRESSABILITY
         DROP  R11                 KILL BASE ADDRESSABILITY
         EJECT
T04MS1   $FS   CC=WSF,MF=L         WRITE STRUCTURED FIELD
T04MS11  DC    AL2(T04MS11L)       LENGTH OF STRUCTURED FIELD
         DC    X'06'               LOAD PROGRAMMED SYMBOLS (LOAD PS)
         DC    B'11000001'         FLAGS - EXTENDED FORM
*                                        - CLEAR
*                                        - NO SUPRESSION
*                                        - DATA TYPE 1
T04LC11  DC    X'00'               LCID - LOCAL CHARACTER SET ID
         DC    X'50'               CHAR - SLOT IN RWS FOR FIRST CHAR
T04RWS11 DC    X'00'               RWS - PHYSICAL RWS TO BE LOADED
         DC    X'06'               LENGTH OF EXT FORM PARAMETERS
         DC    B'00000000'
         DC    AL1(9)              LW
         DC    AL1(16)             LH
         DC    X'00'               RESERVED
         DC    B'00000001'         BLUE PLANE
T04UTBB  DC    (T04UBL)X'0'
T04MS11L EQU   *-T04MS11
T04MS12  DC    AL2(T04MS12L)       LENGTH OF STRUCTURED FIELD
         DC    X'06'               LOAD PROGRAMMED SYMBOLS (LOAD PS)
         DC    B'11000001'         FLAGS - EXTENDED FORM
*                                        - CLEAR
*                                        - NO SUPRESSION
*                                        - DATA TYPE 1
T04LC12  DC    X'00'               LCID - LOCAL CHARACTER SET ID
         DC    X'50'               CHAR - SLOT IN RWS FOR FIRST CHAR
T04RWS12 DC    X'00'               RWS - PHYSICAL RWS TO BE LOADED
         DC    X'06'               LENGTH OF EXT FORM PARAMETERS
         DC    B'00000000'
         DC    AL1(9)              LW
         DC    AL1(16)             LH
         DC    X'00'               RESERVED
         DC    B'00000010'         RED PLANE
T04UTBR  DC    (T04UBL)X'0'
T04MS12L EQU   *-T04MS12
T04MS13  DC    AL2(T04MS13L)       LENGTH OF STRUCTURED FIELD
         DC    X'06'               LOAD PROGRAMMED SYMBOLS (LOAD PS)
         DC    B'11000001'         FLAGS - EXTENDED FORM
*                                        - CLEAR
*                                        - NO SUPRESSION
*                                        - DATA TYPE 1
T04LC13  DC    X'00'               LCID - LOCAL CHARACTER SET ID
         DC    X'50'               CHAR - SLOT IN RWS FOR FIRST CHAR
T04RWS13 DC    X'00'               RWS - PHYSICAL RWS TO BE LOADED
         DC    X'06'               LENGTH OF EXT FORM PARAMETERS
         DC    B'00000000'
         DC    AL1(9)              LW
         DC    AL1(16)             LH
         DC    X'00'               RESERVED
         DC    B'00000100'         GREEN PLANE
T04UTBG  DC    (T04UBL)X'0'
T04MS13L EQU   *-T04MS13
LT04MS1  EQU   *-T04MS1
         SPACE 1
        PRINT  NOGEN
T04MS2   $FS   CC=EW,WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
         $FS   SBA=(1,29),SF=NORMAL,MF=L
         $FS   SBA=(1,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,YELLOW),MF=L
         $FS   TEXT='Load PS triple-plane test :',MF=L
         $FS   SBA=(1,31),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         $FS   TEXT='(E or ENTER-key = continue or Z = stop)',MF=L
         $FS   SBA=(2,1),SF=(PROT),MF=L
         $FS   SBA=(4,21),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,RED),MF=L
T04RWS2  $FS   TEXT='  ',MF=L
         $FS   SF=(PROT),MF=L
         $FS   SBA=(4,1),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,USCORE,COLOUR,TURQ),MF=L
         $FS   TEXT='Stored PS n¢ is :',MF=L
         $FS   SBA=(10,58),SF=(PROT),MF=L
         $FS   SBA=(10,22),MF=L
T04RA1   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE,           X
               PGSYM,DEFAULT),RA=(10,58,5B),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(12,48),SF=(PROT),MF=L
         $FS   SBA=(12,32),MF=L
T04SA1   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         $FS   SET=(535757575757575757575757575754),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(13,48),SF=(PROT),MF=L
         $FS   SBA=(13,32),MF=L
T04SA2   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         $FS   SET=(5A4050405140524052405140504058),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(14,48),SF=(PROT),MF=L
         $FS   SBA=(14,32),MF=L
T04SA3   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         $FS   SET=(555959595959595959595959595956),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(16,58),SF=(PROT),MF=L
         $FS   SBA=(16,22),MF=L
T04RA2   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE,           X
               PGSYM,DEFAULT),RA=(16,58,5C),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(18,48),SF=(PROT),MF=L
         $FS   SBA=(18,32),MF=L
T04SA4   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,WHITE),MF=L
         $FS   SET=(535757575757575757575757575754),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(19,48),SF=(PROT),MF=L
         $FS   SBA=(19,32),MF=L
T04SA5   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,WHITE),MF=L
         $FS   SET=(5A4050405140524052405140504058),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(20,48),SF=(PROT),MF=L
         $FS   SBA=(20,32),MF=L
T04SA6   $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,WHITE),MF=L
         $FS   SET=(555959595959595959595959595956),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(22,58),SF=(PROT),MF=L
         $FS   SBA=(22,22),MF=L
T04RA3   $FS   SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE,           X
               PGSYM,DEFAULT),RA=(22,58,5B),MF=L
         $FS   SA=(PGSYM,DEFAULT),MF=L
         $FS   SBA=(1,1),SF=(PT,IC),MF=L
LT04MS2  EQU   *-T04MS2
        PRINT  GEN
         SPACE 1
T04MS3   $FS   CC=WSF,MF=L         WRITE STRUCTURED FIELD
T04MS31  DC    AL2(T04ML31)        LENGTH OF STRUCTURED FIELD
         DC    X'06'               LOAD PROGRAMMED SYMBOLS (LOAD PS)
         DC    B'01000001'         FLAGS - BASIC FORM
*                                        - CLEAR
*                                        - NO SUPRESSION
*                                        - DATA TYPE 1
         DC    X'FF'               LCID - LOCAL CHARACTER SET ID
         DC    X'41'               CHAR - SLOT IN RWS FOR FIRST CHAR
T04RWS3  DC    X'00'               RWS - PHYSICAL RWS TO BE LOADED
T04ML31  EQU   *-T04MS31
LT04MS3  EQU   *-T04MS3
         SPACE 1
        PRINT  NOGEN
T04U16B $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               WWGRRRGWW,                                              X
               0WWGRGWW0,                                              X
               00WWGWW00,                                              X
               000WWW000,                                              X
               0000W0000,                                              X
               000WWW000,                                              X
               00WWGWW00,                                              X
               0WWGRGWW0,                                              X
               WWGRRRGWW,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR,PL=BLUE
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               W0000000W,                                              X
               WW00000WW,                                              X
               GWW000WWG,                                              X
               RGWW0WWGR,                                              X
               RRGWWWGRR,                                              X
               RGWW0WWGR,                                              X
               GWW000WWG,                                              X
               WW00000WW,                                              X
               W0000000W,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               YYYYYYYYY,                                              X
               Y0000000Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0T000T0Y,                                              X
               Y0T0P0T0Y,                                              X
               Y0T000T0Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0000000Y,                                              X
               YYYYYYYYY,                                              X
               000000000,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR
        $FSDOT GGGGGGGGG,          START OF SYMBOL 4 X'53'             X
               G00000000,                                              X
               G0RRRRRRR,                                              X
               G0R000000,                                              X
               G0R0BBBBB,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000
        $FSDOT GGGGGGGGG,          START OF SYMBOL 5 X'54'             X
               00000000G,                                              X
               RRRRRRR0G,                                              X
               000000R0G,                                              X
               BBBBB0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G
        $FSDOT G0R0B0000,          START OF SYMBOL 6 X'55'             X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0BBBBB,                                              X
               G0R000000,                                              X
               G0RRRRRRR,                                              X
               G00000000,                                              X
               GGGGGGGGG
        $FSDOT 0000B0R0G,          START OF SYMBOL 7 X'56'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               BBBBB0R0G,                                              X
               000000R0G,                                              X
               RRRRRRR0G,                                              X
               00000000G,                                              X
               GGGGGGGGG
        $FSDOT GGGGGGGGG,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
        $FSDOT 0000B0R0G,          START OF SYMBOL 9 X'58'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               GGGGGGGGG
        $FSDOT G0R0B0000,          START OF SYMBOL 11 X'5A'            X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
        $FSDOT 000000000,          START OF SYMBOL 13 X'5C'            X
               000000000,                                              X
               000000000,                                              X
               GGGGGGGGG,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
T04UBL   EQU   *-T04U16B
         SPACE 1
T04U16R $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               WWGRRRGWW,                                              X
               0WWGRGWW0,                                              X
               00WWGWW00,                                              X
               000WWW000,                                              X
               0000W0000,                                              X
               000WWW000,                                              X
               00WWGWW00,                                              X
               0WWGRGWW0,                                              X
               WWGRRRGWW,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR,PL=RED
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               W0000000W,                                              X
               WW00000WW,                                              X
               GWW000WWG,                                              X
               RGWW0WWGR,                                              X
               RRGWWWGRR,                                              X
               RGWW0WWGR,                                              X
               GWW000WWG,                                              X
               WW00000WW,                                              X
               W0000000W,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               YYYYYYYYY,                                              X
               Y0000000Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0T000T0Y,                                              X
               Y0T0P0T0Y,                                              X
               Y0T000T0Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0000000Y,                                              X
               YYYYYYYYY,                                              X
               000000000,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR
        $FSDOT GGGGGGGGG,          START OF SYMBOL 4 X'53'             X
               G00000000,                                              X
               G0RRRRRRR,                                              X
               G0R000000,                                              X
               G0R0BBBBB,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000
        $FSDOT GGGGGGGGG,          START OF SYMBOL 5 X'54'             X
               00000000G,                                              X
               RRRRRRR0G,                                              X
               000000R0G,                                              X
               BBBBB0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G
        $FSDOT G0R0B0000,          START OF SYMBOL 6 X'55'             X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0BBBBB,                                              X
               G0R000000,                                              X
               G0RRRRRRR,                                              X
               G00000000,                                              X
               GGGGGGGGG
        $FSDOT 0000B0R0G,          START OF SYMBOL 7 X'56'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               BBBBB0R0G,                                              X
               000000R0G,                                              X
               RRRRRRR0G,                                              X
               00000000G,                                              X
               GGGGGGGGG
        $FSDOT GGGGGGGGG,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
        $FSDOT 0000B0R0G,          START OF SYMBOL 9 X'58'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               GGGGGGGGG
        $FSDOT G0R0B0000,          START OF SYMBOL 11 X'5A'            X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
        $FSDOT 000000000,          START OF SYMBOL 13 X'5C'            X
               000000000,                                              X
               000000000,                                              X
               GGGGGGGGG,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
T04URL   EQU   *-T04U16R
         SPACE 1
T04U16G $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               WWGRRRGWW,                                              X
               0WWGRGWW0,                                              X
               00WWGWW00,                                              X
               000WWW000,                                              X
               0000W0000,                                              X
               000WWW000,                                              X
               00WWGWW00,                                              X
               0WWGRGWW0,                                              X
               WWGRRRGWW,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR,PL=GREEN
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               W0000000W,                                              X
               WW00000WW,                                              X
               GWW000WWG,                                              X
               RGWW0WWGR,                                              X
               RRGWWWGRR,                                              X
               RGWW0WWGR,                                              X
               GWW000WWG,                                              X
               WW00000WW,                                              X
               W0000000W,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               YYYYYYYYY,                                              X
               Y0000000Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0T000T0Y,                                              X
               Y0T0P0T0Y,                                              X
               Y0T000T0Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0000000Y,                                              X
               YYYYYYYYY,                                              X
               000000000,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               RRRRRRRRR
        $FSDOT GGGGGGGGG,          START OF SYMBOL 4 X'53'             X
               G00000000,                                              X
               G0RRRRRRR,                                              X
               G0R000000,                                              X
               G0R0BBBBB,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000
        $FSDOT GGGGGGGGG,          START OF SYMBOL 5 X'54'             X
               00000000G,                                              X
               RRRRRRR0G,                                              X
               000000R0G,                                              X
               BBBBB0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G
        $FSDOT G0R0B0000,          START OF SYMBOL 6 X'55'             X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0BBBBB,                                              X
               G0R000000,                                              X
               G0RRRRRRR,                                              X
               G00000000,                                              X
               GGGGGGGGG
        $FSDOT 0000B0R0G,          START OF SYMBOL 7 X'56'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               BBBBB0R0G,                                              X
               000000R0G,                                              X
               RRRRRRR0G,                                              X
               00000000G,                                              X
               GGGGGGGGG
        $FSDOT GGGGGGGGG,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
        $FSDOT 0000B0R0G,          START OF SYMBOL 9 X'58'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               GGGGGGGGG
        $FSDOT G0R0B0000,          START OF SYMBOL 11 X'5A'            X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
        $FSDOT 000000000,          START OF SYMBOL 13 X'5C'            X
               000000000,                                              X
               000000000,                                              X
               GGGGGGGGG,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000
T04UGL   EQU   *-T04U16G
         SPACE 1
*                             BLUE PLANE
T04U12B $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               WWGRRRGWW,                                              X
               0WWGRGWW0,                                              X
               00WWGWW00,                                              X
               000WWW000,                                              X
               0000W0000,                                              X
               000WWW000,                                              X
               00WWGWW00,                                              X
               0WWGRGWW0,                                              X
               WWGRRRGWW,                                              X
               000000000,                                              X
               BBBWWWRRR,H=12,PL=BLUE
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               W0000000W,                                              X
               WW00000WW,                                              X
               GWW000WWG,                                              X
               RGWW0WWGR,                                              X
               RRGWWWGRR,                                              X
               RGWW0WWGR,                                              X
               GWW000WWG,                                              X
               WW00000WW,                                              X
               W0000000W,                                              X
               000000000,                                              X
               BBBWWWRRR,H=12
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               YYYYYYYYY,                                              X
               Y0000000Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0T000T0Y,                                              X
               Y0T0P0T0Y,                                              X
               Y0T000T0Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0000000Y,                                              X
               YYYYYYYYY,                                              X
               000000000,                                              X
               GGGWWWRRR,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 4 X'53'             X
               G00000000,                                              X
               G0RRRRRRR,                                              X
               G0R000000,                                              X
               G0R0BBBBB,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 5 X'54'             X
               00000000G,                                              X
               RRRRRRR0G,                                              X
               000000R0G,                                              X
               BBBBB0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,H=12
        $FSDOT G0R0B0000,          START OF SYMBOL 6 X'55'             X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0BBBBB,                                              X
               G0R000000,                                              X
               G0RRRRRRR,                                              X
               G00000000,                                              X
               GGGGGGGGG,H=12
        $FSDOT 0000B0R0G,          START OF SYMBOL 7 X'56'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               BBBBB0R0G,                                              X
               000000R0G,                                              X
               RRRRRRR0G,                                              X
               00000000G,                                              X
               GGGGGGGGG,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,H=12
        $FSDOT 0000B0R0G,          START OF SYMBOL 9 X'58'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,H=12
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               GGGGGGGGG,H=12
        $FSDOT G0R0B0000,          START OF SYMBOL 11 X'5A'            X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,H=12
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               BBBBBBBBB,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,H=12
        $FSDOT 000000000,          START OF SYMBOL 13 X'5C'            X
               GGGGGGGGG,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,H=12
         SPACE 1
*                             RED PLANE
T04U12R $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               WWGRRRGWW,                                              X
               0WWGRGWW0,                                              X
               00WWGWW00,                                              X
               000WWW000,                                              X
               0000W0000,                                              X
               000WWW000,                                              X
               00WWGWW00,                                              X
               0WWGRGWW0,                                              X
               WWGRRRGWW,                                              X
               000000000,                                              X
               BBBWWWRRR,H=12,PL=RED
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               W0000000W,                                              X
               WW00000WW,                                              X
               GWW000WWG,                                              X
               RGWW0WWGR,                                              X
               RRGWWWGRR,                                              X
               RGWW0WWGR,                                              X
               GWW000WWG,                                              X
               WW00000WW,                                              X
               W0000000W,                                              X
               000000000,                                              X
               BBBWWWRRR,H=12
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               YYYYYYYYY,                                              X
               Y0000000Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0T000T0Y,                                              X
               Y0T0P0T0Y,                                              X
               Y0T000T0Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0000000Y,                                              X
               YYYYYYYYY,                                              X
               000000000,                                              X
               GGGWWWRRR,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 4 X'53'             X
               G00000000,                                              X
               G0RRRRRRR,                                              X
               G0R000000,                                              X
               G0R0BBBBB,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 5 X'54'             X
               00000000G,                                              X
               RRRRRRR0G,                                              X
               000000R0G,                                              X
               BBBBB0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,H=12
        $FSDOT G0R0B0000,          START OF SYMBOL 6 X'55'             X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0BBBBB,                                              X
               G0R000000,                                              X
               G0RRRRRRR,                                              X
               G00000000,                                              X
               GGGGGGGGG,H=12
        $FSDOT 0000B0R0G,          START OF SYMBOL 7 X'56'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               BBBBB0R0G,                                              X
               000000R0G,                                              X
               RRRRRRR0G,                                              X
               00000000G,                                              X
               GGGGGGGGG,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,H=12
        $FSDOT 0000B0R0G,          START OF SYMBOL 9 X'58'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,H=12
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               GGGGGGGGG,H=12
        $FSDOT G0R0B0000,          START OF SYMBOL 11 X'5A'            X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,H=12
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               BBBBBBBBB,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,H=12
        $FSDOT 000000000,          START OF SYMBOL 13 X'5C'            X
               GGGGGGGGG,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,H=12
         SPACE 1
*                             GREEN PLANE
T04U12G $FSDOT 000000000,          START OF SYMBOL 1 X'50'             X
               WWGRRRGWW,                                              X
               0WWGRGWW0,                                              X
               00WWGWW00,                                              X
               000WWW000,                                              X
               0000W0000,                                              X
               000WWW000,                                              X
               00WWGWW00,                                              X
               0WWGRGWW0,                                              X
               WWGRRRGWW,                                              X
               000000000,                                              X
               BBBWWWRRR,H=12,PL=GREEN
        $FSDOT 000000000,          START OF SYMBOL 2 X'51'             X
               W0000000W,                                              X
               WW00000WW,                                              X
               GWW000WWG,                                              X
               RGWW0WWGR,                                              X
               RRGWWWGRR,                                              X
               RGWW0WWGR,                                              X
               GWW000WWG,                                              X
               WW00000WW,                                              X
               W0000000W,                                              X
               000000000,                                              X
               BBBWWWRRR,H=12
        $FSDOT 000000000,          START OF SYMBOL 3 X'52'             X
               YYYYYYYYY,                                              X
               Y0000000Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0T000T0Y,                                              X
               Y0T0P0T0Y,                                              X
               Y0T000T0Y,                                              X
               Y0TTTTT0Y,                                              X
               Y0000000Y,                                              X
               YYYYYYYYY,                                              X
               000000000,                                              X
               GGGWWWRRR,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 4 X'53'             X
               G00000000,                                              X
               G0RRRRRRR,                                              X
               G0R000000,                                              X
               G0R0BBBBB,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 5 X'54'             X
               00000000G,                                              X
               RRRRRRR0G,                                              X
               000000R0G,                                              X
               BBBBB0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,H=12
        $FSDOT G0R0B0000,          START OF SYMBOL 6 X'55'             X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0BBBBB,                                              X
               G0R000000,                                              X
               G0RRRRRRR,                                              X
               G00000000,                                              X
               GGGGGGGGG,H=12
        $FSDOT 0000B0R0G,          START OF SYMBOL 7 X'56'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               BBBBB0R0G,                                              X
               000000R0G,                                              X
               RRRRRRR0G,                                              X
               00000000G,                                              X
               GGGGGGGGG,H=12
        $FSDOT GGGGGGGGG,          START OF SYMBOL 8 X'57'             X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,H=12
        $FSDOT 0000B0R0G,          START OF SYMBOL 9 X'58'             X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,                                              X
               0000B0R0G,H=12
        $FSDOT 000000000,          START OF SYMBOL 10 X'59'            X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               000000000,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               000000000,                                              X
               GGGGGGGGG,H=12
        $FSDOT G0R0B0000,          START OF SYMBOL 11 X'5A'            X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,                                              X
               G0R0B0000,H=12
        $FSDOT 000000000,          START OF SYMBOL 12 X'5B'            X
               BBBBBBBBB,                                              X
               BBBBBBBBB,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,H=12
        $FSDOT 000000000,          START OF SYMBOL 13 X'5C'            X
               GGGGGGGGG,                                              X
               GGGGGGGGG,                                              X
               000000000,                                              X
               000000000,                                              X
               WWWWWWWWW,                                              X
               WWWWWWWWW,                                              X
               000000000,                                              X
               000000000,                                              X
               RRRRRRRRR,                                              X
               RRRRRRRRR,                                              X
               000000000,H=12
        PRINT  GEN
         SPACE 2
        PRINT  NOGEN
TIODSECT DSECT
        IEFTIOT1
        PRINT  GEN
         SPACE 2
         END
