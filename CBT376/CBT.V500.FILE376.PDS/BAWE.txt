PROC 0 TEST
CONTROL NOLIST NOCONLIST NOSYMLIST
CLEAR
IF &TEST = &STR(TEST) THEN CONTROL LIST CONLIST SYMLIST
FREE DD(SYSPRINT)
ALLOC DD(SYSPRINT) NEW SPACE(1,1) -
BLKSIZE(9040) LRECL(80) RECFM(F B) DSORG(PS) UNIT(VIO) REUSE
CALL 'C4ADMDM.PROD.LKED(TSODZN)' 'WEWE.PROD.DBADABAS.DATA'
OPENFILE SYSPRINT INPUT
ERROR DO
      SET &LCC = &LASTCC
      IF &LCC = 400 THEN GOTO HCONTP
      EXIT
      END
SET &CNT = 0
RETRYP:-
GETFILE SYSPRINT
 SET &TEXT = &SUBSTR(1:1,&SYSPRINT)
 SET &ADA  = &SUBSTR(1:6,&SYSPRINT)
 IF &TEXT = &STR(E) THEN -
 IF &ADA ¬= &STR(EDADAP) THEN DO
                     SET &CNT = &CNT + 1
                     SET &ADA = &SUBSTR(1:8,&SYSPRINT)
                     WRITE &ADA
                              END
 GOTO RETRYP
ERROR OFF
HCONTP:-
CLOSFILE SYSPRINT
FREE DD(SYSPRINT)
WRITE # BATCH PROD WEWE ADABAS RUNNING : &CNT
WRITE
ALLOC DD(SYSPRINT) NEW SPACE(1,1) -
BLKSIZE(9040) LRECL(80) RECFM(F B) DSORG(PS) UNIT(VIO) REUSE
CALL 'C4ADMDM.PROD.LKED(TSODZN)' 'WEWE.TEST.DBADABAS.DATA'
OPENFILE SYSPRINT INPUT
ERROR DO
      SET &LCC = &LASTCC
      IF &LCC = 400 THEN GOTO HCONTT
      EXIT
      END
SET &CNT = 0
RETRYT:-
GETFILE SYSPRINT
 SET &TEXT = &SUBSTR(1:1,&SYSPRINT)
 SET &ADA  = &SUBSTR(1:6,&SYSPRINT)
 IF &TEXT = &STR(E) THEN -
 IF &ADA ¬= &STR(EDADAT) THEN DO
                     SET &CNT = &CNT + 1
                     SET &ADA = &SUBSTR(1:8,&SYSPRINT)
                     WRITE &ADA
                              END
 GOTO RETRYT
ERROR OFF
HCONTT:-
CLOSFILE SYSPRINT
FREE DD(SYSPRINT)
WRITE # BATCH TEST WEWE ADABAS RUNNING : &CNT
WRITE
ALLOC DD(SYSPRINT) NEW SPACE(1,1) -
BLKSIZE(9040) LRECL(80) RECFM(F B) DSORG(PS) UNIT(VIO) REUSE
CALL 'C4ADMDM.PROD.LKED(TSODZN)' 'WEWE.DEVT.DBADABAS.DATA'
OPENFILE SYSPRINT INPUT
ERROR DO
      SET &LCC = &LASTCC
      IF &LCC = 400 THEN GOTO HCONTD
      EXIT
      END
SET &CNT = 0
RETRYD:-
GETFILE SYSPRINT
 SET &TEXT = &SUBSTR(1:1,&SYSPRINT)
 SET &ADA  = &SUBSTR(1:6,&SYSPRINT)
 IF &TEXT = &STR(E) THEN -
 IF &ADA ¬= &STR(EDADAD) THEN DO
                     SET &CNT = &CNT + 1
                     SET &ADA = &SUBSTR(1:8,&SYSPRINT)
                     WRITE &ADA
                              END
 GOTO RETRYD
ERROR OFF
HCONTD:-
CLOSFILE SYSPRINT
FREE DD(SYSPRINT)
ALLOC DD(SYSPRINT) DA(*)
WRITE # BATCH DEVT WEWE ADABAS RUNNING : &CNT
EXIT CODE(0)
