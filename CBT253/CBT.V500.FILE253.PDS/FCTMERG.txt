/* REXX PRODXREF FCT MERGE EXEC */
"EXECIO * DISKR FCTIN (STEM FCTIN. FINIS";
DO K = 1 TO FCTIN.0;
     TEMP = SUBSTR(FCTIN.K,1,72);
     CONT=SUBSTR(TEMP,72,1);
     IF WORDPOS("DFHFCT",TEMP)¬=0 THEN DO;
          CURRFCT=TEMP;
          DO WHILE (CONT¬=" ");
              K=K+1; /* INDEX */
              TEMP = SUBSTR(FCTIN.K,1,72);
              CONT=SUBSTR(TEMP,72,1);
              CURRFCT=CURRFCT TEMP;
          END;
     CURRFCT=TRANSLATE(CURRFCT,"   ",",()");
     PARSE VAR CURRFCT . "DATASET=" MEMBER . ;
     PARSE VAR CURRFCT . "DSNAME=" DSN . ;
     ACCESS="INPUT";
     IF WORDPOS("UPDATE",CURRFCT)¬=0 | ,
        WORDPOS("DELETE",CURRFCT)¬=0 | ,
        WORDPOS("ADD",CURRFCT)¬=0 THEN ACCESS="OUTPUT";
     DSN=LEFT(DSN,44);
     MEMBER=LEFT(MEMBER,8);
     JOBNAME="CICSPROD";
     ACCESS=LEFT(ACCESS,6);
     FCTOUT.1=COPIES(" ",116);
     FCTOUT.1 = ,
         OVERLAY(DSN,FCTOUT.1,56,44);
     FCTOUT.1 = ,
         OVERLAY(MEMBER,FCTOUT.1,100,8);
     FCTOUT.1 = ,
         OVERLAY(JOBNAME,FCTOUT.1,1,8);
     FCTOUT.1 = ,
         OVERLAY(ACCESS,FCTOUT.1,111,6);
     IF DSN=" " | MEMBER=" " THEN ITERATE K;
     "EXECIO 1 DISKW FCTOUT (STEM FCTOUT.";
END;
END;
"EXECIO 0 DISKW FCTOUT (FINIS";
EXIT 0;
