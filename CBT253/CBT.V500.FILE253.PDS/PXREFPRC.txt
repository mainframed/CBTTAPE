/* REXX PRODXREF FILLIN MISSING PROCEDURE NAMES */
"EXECIO * DISKR XREFIN (STEM XREFIN. FINIS";
XOUT=1;
PROCNAME_STACK="";
PROCSTEP_STACK="";
CURRENT_JOBNAME="";
DO I = 1 TO XREFIN.0;
  PARSE VAR XREFIN.I JOBNAME 9 JOBCLASS 10 EPROCSN 18 PROCNAME ,
      26 EPGMSN 34 EXECPGM 42 STEPPROC 45 STEPJOB ,
      48 DDNAME 56 DSNAME 100 MEMBER 108 DISP 111 ACCESS;
  JOBNAME=STRIP(JOBNAME);
  PROCNAME=STRIP(PROCNAME);
  EPROCSN=STRIP(EPROCSN);
  EPGMSN=STRIP(EPGMSN);
  DDNAME=STRIP(DDNAME);
  DSNAME=STRIP(DSNAME);
  MEMBER=STRIP(MEMBER);
  DISP=STRIP(DISP);
  ACCESS =STRIP(ACCESS);
  IF JOBNAME¬=CURRENT_JOBNAME THEN DO;
       FILLFLAG="";
       PROCNAME_STACK = "";
       PROCSTEP_STACK = "";
       CURRENT_JOBNAME = JOBNAME;
       XREFOUT.XOUT = XREFIN.I; /* DUP RECORD UNCHANGED */
       XOUT = XOUT + 1;
       ITERATE I;
       END;
  IF STEPPROC=" " & PROCNAME¬=" " THEN DO;
       FILLFLAG="";
       PROCNAME_STACK = PROCNAME PROCNAME_STACK;
       PROCSTEP_STACK = EPROCSN  PROCSTEP_STACK;
       XREFOUT.XOUT = XREFIN.I; /* DUP RECORD UNCHANGED */
       XOUT = XOUT + 1;
       ITERATE I;
       END;
  IF STEPPROC¬=" " & PROCNAME=" " & STEPPROC¬="000" & ,
     PROCNAME_STACK¬=" " & PROCSTEP_STACK¬=" " & ,
     PROCNAME_STACK¬="" & PROCSTEP_STACK¬="" THEN DO;
      IF FILLFLAG="" THEN DO;
       PROCNAME_STACK = DELWORD(PROCNAME_STACK,1,1);
       PROCSTEP_STACK = DELWORD(PROCSTEP_STACK,1,1);
       FILLFLAG="ON";
      END;
       EPROCSN=" ";
       PROCNAME=" ";
       IF PROCNAME_STACK¬="" THEN ,
          PROCNAME = WORD(PROCNAME_STACK,1);
       IF PROCSTEP_STACK¬="" THEN ,
          EPROCSN  = WORD(PROCSTEP_STACK,1);
       XREFOUT.XOUT = XREFIN.I; /* DUP RECORD UNCHANGED */
       XREFOUT.XOUT=OVERLAY(EPROCSN,XREFOUT.XOUT,10,8);
       XREFOUT.XOUT=OVERLAY(PROCNAME,XREFOUT.XOUT,18,8);
       XOUT = XOUT + 1;
       ITERATE I;
       END;
  ELSE DO;
       FILLFLAG="";
       XREFOUT.XOUT = XREFIN.I; /* DUP RECORD UNCHANGED */
       XOUT = XOUT + 1;
       ITERATE I;
       END;
END;
"EXECIO * DISKW XREFOUT (STEM XREFOUT. FINIS";
EXIT 0;
