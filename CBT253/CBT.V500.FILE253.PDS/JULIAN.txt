/*  REXX EXEC : ( JULIAN ).
    FUNCTION  : DISPLAY THE DATE, TIME, DAY, AND CURRENT JULIAN DATE.
                CALULATE AND DISPLAY THE JUIAN DATE FOR ANY PASSED
                CALINDAR DATE PARM FORMAT ( MM/DD/YY ).
                                                                      */

TRACE O
/*     */
HOUSE_KEEPING:
ADDRESS TSO
ARG PDATE
IF PDATE = '' THEN DO
   JULDATE = DATE(J)
   CURDATE = DATE(U)
   CURTIME = TIME()
   CURDAY = DATE(W)
   SAY
   SAY 'DAY:' CURDAY '- DATE:' CURDATE '- TIME:' CURTIME '- JULIAN:' JULDATE
   SAY
   EXIT
END

/*     */
CONVERT_JULIAN_DATE:
SCNT = 0
DLEN = LENGTH(PDATE)
IF DLEN = 7 | DLEN = 8 THEN DO I = 1 TO DLEN
   SLASH = SUBSTR(PDATE,I,1)
   IF SLASH = '/' THEN SCNT = SCNT + 1
END
IF SCNT Â¬= 2 THEN DO
   SAY '*** INVALID DATE PARM ('PDATE') - FORMAT: (M/DD/YY OR MM/DD/YY). ***'
   SAY '*** JULIAN EXEC MAINTASK CANCELLED. ***'
   EXIT 024
END
NUMDAYS.1 = '31 28 31 30 31 30 31 31 30 31 30 31'
NUMDAYS.2 = '31 29 31 30 31 30 31 31 30 31 30 31'
PARSE VALUE PDATE WITH PMM '/' PDD '/' PYY
D = 0
NDAYS = 0
Y = 2
LEAPYR = PYY // 4
LDAYS = 635
IF LEAPYR > 0 THEN DO
   Y = 1
   LDAYS = 636
END
IMONTH = PMM - 1
DO IMONTH
   D = D + 1
   MDAYS = WORD(NUMDAYS.Y,D)
   NDAYS = NDAYS + MDAYS
END
NDAYS = NDAYS + PDD
NDAYS = RIGHT(NDAYS,3,'0')
JULDATEO = PYY||NDAYS
SAY
SAY '+++ JULIAN DATE FOR 'PDATE':' JULDATEO
SAY
EXIT
