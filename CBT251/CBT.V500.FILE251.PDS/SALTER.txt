 PROC 0
 START: +
ISPEXEC VGET (DSDSN)  PROFILE
SET &DSN = &DSDSN
ISPEXEC DISPLAY PANEL(CHGSTS)
SET &PDSDSN = &DSN
SET &MEMBER = &MEM
SET &DSDSN = &DSN
IF &MEM = END THEN GOTO  QUIT
IF &PV  = PF03   THEN GOTO  QUIT
ISPEXEC VPUT (DSDSN)  PROFILE
/* INITIALIZE DATASET */
ISPEXEC  LMINIT DATAID(PDSID) DATASET(&PDSDSN) +
                ENQ(SHRW)                        +
                ORG(PDSORG)
SET LMRC = &LASTCC
IF &LMRC ¬= 0 THEN +
   DO
      WRITE LMINIT FAILED - RETURN CODE &LMRC
      WRITE DATA SET IS NOT ALLOCATED OR NOT PARTITIONED
      EXIT CODE(8)
   END

/* OPEN DATA SET */
ISPEXEC LMOPEN DATAID(&PDSID) OPTION(INPUT)
  ISPEXEC LMMFIND DATAID(&PDSID) -
        MEMBER(&MEMBER) -
        STATS(YES)
SET &MBRNAME =  &MEMBER
SET &VER1 =     &ZLVERS
SET &MOD1 =     &ZLMOD
SET &CDATE =    &ZLCDATE
SET &MDATE =    &ZLMDATE
SET &MTIME =    &ZLMTIME
SET &CSIZE =    &ZLCNORC
SET &ISIZE =    &ZLINORC
SET &MRECS =    &ZLMNORC
SET &USERID =   &ZLUSER
SET LMRC = &LASTCC
ISPEXEC DISPLAY PANEL(CHGID)
  ISPEXEC  LMMSTATS DATAID(&PDSID)  MEMBER(&MBRNAME) VERSION(&VER1)   +
                    MODLEVEL(&MOD1)   CREATED(&CDATE)  MODDATE(&MDATE)+
                    MODTIME(&MTIME) CURSIZE(&CSIZE) INITSIZE(&ISIZE)  +
                    MODRECS(&MRECS)   USER(&USERID)
  IF &LASTCC ¬= 0 THEN    /* RETURN CODES -                        */ +
    DO                    /*  4 - NO MEMBERS MATCH PATTERN.        */
    END                   /*    - NO MEMBER IN DATA SET.           */
  ELSE                    /*  8 - MEMBER NOT FOUND.                */ +
                          /* 10 - NO DATA SET ASSOCIATED WITH THE  */
                          /*      GIVEN DATA-ID.                   */
                          /* 12 - INVALID PARAMETER VALUE.         */
                          /*    - DATA SET IS NOT OPEN OR IS NOT   */
                          /*      PARTITIONED.                     */
                          /* 20 - SEVERE ERROR, UNABLE TO CONTINUE.*/

  WRITE LASTCC &LASTCC
ISPEXEC LMCLOSE DATAID(&PDSID)
/* FREE DATA ID */
ISPEXEC LMFREE  DATAID(&PDSID)
GOTO START
QUIT: +
EXIT CODE(0)
