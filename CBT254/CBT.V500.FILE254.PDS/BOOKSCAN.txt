/* REXX */
"ALLOC F(SHELVES) DA('TECH105.USER.CNTLLIB(BOOKSHL2)') SHR";
"EXECIO * DISKR SHELVES (FINIS STEM SHELF.";
"FREE F(SHELVES)";
DO I = 1 TO SHELF.0;
     PARSE VAR SHELF.I DSNAME . ;
     "ALLOC F(BOOKIN) DA('"DSNAME"') SHR";
     "EXECIO * DISKR BOOKIN (FINIS STEM BOOKDATA.";
     OUTBOOKPTR = 1;
     DO J = 1 TO BOOKDATA.0;
           IF SUBSTR(BOOKDATA.J,1,7)Â¬="BKNAME=" THEN DO;
                OUTBOOK.OUTBOOKPTR=BOOKDATA.J;
                OUTBOOKPTR=OUTBOOKPTR+1;
                END;
            ELSE DO;
                OUTBOOK.OUTBOOKPTR=BOOKDATA.J;
                OUTBOOKPTR=OUTBOOKPTR+1;
                BOOKID = STRIP(SUBSTR(BOOKDATA.J,8));
       OUTBOOK.OUTBOOKPTR="BKMDSN=SYSS.SOFTCOPY."BOOKID".BOOK";
                OUTBOOKPTR=OUTBOOKPTR+1;
                END;
     END;
     "EXECIO * DISKW BOOKIN (FINIS STEM OUTBOOK.";
     "FREE F(BOOKIN)";
     DROP BOOKDATA. ;
END;
