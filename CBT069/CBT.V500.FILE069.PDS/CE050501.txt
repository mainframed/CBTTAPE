*
* CODING EXAMPLE 5.5.1
*
*
         LA    R0,ZDNOLEN          LD LENGTH OF FIELD TO VALIDATE
         LA    R10,ZDNUMB          LD ADR OF FIELD TO VALIDATE
         BAL   R7,VALDTZD          VALIDATE FIELD FOR ZONED DEC DATA
         LTR   R15,R15             CHK IF FIELD CONTAIN VALID DATA
         BZ    DATAOK              IF O, FIELD CONTAINS VALID ZD NUMB
         B     DATAINV             IF NOT, FIELD CONTAINS INV ZD NUMB
*
*
***********************************************************************
*   THIS SUBROUTINE CHECKS IF A FIELD OF DATA CONTAINS ZONED DECIMAL
*   NUMBERS. THIS SUBROUTINE PERFORMES THE VALIDATION BY VERIFYING THAT
*   EACH BYTE OF THE FIELD IS IN THE RANGE X'F0' TO X'F9'. AN RC IS SET
*   IN REGISTER 15 FOR THE CALLING ROUTINE; X'00' INDICATES VALID DATA,
*   X'04' INDICATES INVALID DATA.
***********************************************************************
*
VALDTZD  DS    OH
NEXTDIG  CLI   0(R10),X'F0'        COMPARE A BYTE OF FIELD TO ZD ZERO
         BL    BADZDD              IF LESS THAN ZD 0, BAD ZD DATA
         CLI   0(R10),X'F9'        COMPARE A BYTE OF FIELD TO ZD NINE
         BH    BADZDD              IF GREATER THAN ZD 9, BAD ZD DATA
         LA    R10,1(0,R10)        INCR TO NEXT BYTE OF FIELD
         BCT   R0,NEXTDIG          IF MORE BYTES, COMPARE NEXT ONE
         LA    R15,0               IF NO MORE BYTES, DATA OK---IND IT
         BR    R7                  RETURN TO CALLING RTN
BADZDD   LA    R15,4               INDICATE BAD ZD DATA
         BR    R7                  RETURN TO CALLING RTN
*                                  VALIDATED FOR ZONED DECIMAL DATA
ZDNOLEN  EQU   L'ZDNUMB            CONTAINS THE LENGTH OF ZDNUMB
ZDNUMB   DC    ...                 THE FIELD WHICH IS TO BE VALIDATED
*                                  FOR ZONED DECIMAL DATA
