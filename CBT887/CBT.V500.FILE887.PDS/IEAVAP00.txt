         TITLE 'IEAVAP00 - VOLUME ATTRIBUTE PROCESSING                 *
                        '
IEAVAP00 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(24)                                          01S0001
         DC    C'IEAVAP00 77046  UZ08471 '                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  LA    @11,4095(,@12)                                   01S0001
         LA    @09,4095(,@11)                                   01S0001
         LA    @08,4095(,@09)                                   01S0001
         LA    @04,4095(,@08)                                   01S0001
         USING @PSTART,@12                                      01S0001
         USING @PSTART+4095,@11                                 01S0001
         USING @PSTART+8190,@09                                 01S0001
         USING @PSTART+12285,@08                                01S0001
         USING @PSTART+16380,@04                                01S0001
         ST    @13,@SA00001+4                                   01S0001
         LA    @14,@SA00001                                     01S0001
         ST    @14,8(,@13)                                      01S0001
         LR    @13,@14                                          01S0001
** REFS ARE GENERATED FOR NVT FIELDS THAT CONTAIN ADDRESSES OF
** NIP SERVICE ROUTINES, SO IEAPMNIP MACRO CALLS TO THESE ROUTINES
** WILL ASSEMBLE PROPERLY.
*CVTPTR = RCVT;                                                 01S0249
         ST    RCVT,CVTPTR                                      01S0249
*SWITCHES = ZERO;                      /* INITIALIZE SWITCHES TO OFF */
         SLR   @10,@10                                          01S0250
         ST    @10,SWITCHES                                     01S0250
*BADADDR = ZEROADDR;                   /* INIT INVALID DEVICE PTR    */
         MVC   BADADDR(3),ZEROADDR                              01S0251
*MTLSTCT = ZERO;                       /* INIT MNTLIST ENTRY COUNTER */
         STH   @10,MTLSTCT                                      01S0252
*FINDADDR = ZERO;                      /* INIT PTR TO UCB (EBCDIC)   */
         ST    @10,FINDADDR                                     01S0253
*DO;                                   /* INITIALIZE DA UCB'S        */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - INITUCBS                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - INITIALIZE P/R AND NOT-READY DIRECT           */
*/*                    ACCESS UCB'S                                  */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     SAVE LUT ADDR IN AREA NAMED 'LUTSAVE'. SET REGISTER 1 TO     */
*/*     POINT TO THE LUT.  CALL 'IEFSCAN' TO OBTAIN UCB ADDRESS. IF  */
*/*     UCB ADDRESS IS ZERO, ALL UCB'S HAVE BEEN SCANNED.  IF UCB    */
*/*     ADDRESS IS NOT ZERO, SEE IF THE UCB IS FOR DA.  IF UCB IS    */
*/*     FOR DA AND IS PERMANENTLY RESIDENT, SET USE STATUS TO PUBLIC.*/
*/*     IF UCB IS FOR DA AND THERE IS NO VOLUME SERIAL NUMBER, TURN  */
*/*     ON THE NOT-READY BIT.                                        */
*/*                                                                  */
*/*     OBTAIN NEXT UCB ADDRESS BY CALLING 'UCBCONT' WITH VALUE OF   */
*/*     REGISTER 1 OBTAINED FROM 'LUTSAVE'.  PROCESS EACH UCB AS     */
*/*     ABOVE.                                                       */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         SET UCB USE STATUS OF ALL VOLUMES THAT HAVE BEEN MARKED  */
*/*         PERMANENTLY RESIDENT BY PREVIOUS NIP PROCESSING TO       */
*/*         PUBLIC; SET A NOT-READY DEVICE STATUS IN ALL DIRECT      */
*/*         ACCESS UCB'S THAT DO NOT CONTAIN VOLUME SERIAL NUMBERS.  */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         CVTILK2 TO OBTAIN ADDRESS OF LUT                         */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - ALL UCB'S SCANNED                                */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB'S - MODIFIED                                         */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0255
*LUTSAVE = CVTILK2;                    /*OBTAIN ADDR OF LOOK UP TABLE*/
         L     @10,CVTPTR                                       02S0255
         L     @10,CVTILK2(,@10)                                02S0255
         ST    @10,LUTSAVE                                      02S0255
*RFY RPARM RSTD;                                                02S0256
*RPARM = LUTSAVE;                      /*MOVE LUT ADDR INTO PARM REG */
         LR    RPARM,@10                                        02S0257
*CALL IEFSCAN;                         /*OBTAIN UCB ADDRESS          */
         L     @15,@CV00229                                     02S0258
         BALR  @14,@15                                          02S0258
*UCBPTR = RPARM;                       /*SAVE ADDRESS OF UCB         */
         ST    RPARM,UCBPTR                                     02S0259
*RFY RPARM UNRSTD;                                              02S0260
*                                                               02S0260
*DO WHILE (UCBPTR ¬= ZERO);            /*PROCESS UCBS - ZERO UCB ADDR
*                                        INDICATES END OF UCBS       */
         B     @DE00261                                         02S0261
@DL00261 DS    0H                                               02S0262
*IF UCB3DACC = YES                     /*IS UCB DIRECT ACCESS?       */
*  THEN DO;                                                     02S0262
         L     @10,UCBPTR                                       02S0262
         TM    UCB3DACC(@10),B'00100000'                        02S0262
         BNO   @RF00262                                         02S0262
*    IF UCBPRES = YES                  /*IS IT PERMANENTLY RESIDENT? */
*      THEN DO;                                                 02S0264
         TM    UCBPRES(@10),B'00000100'                         02S0264
         BNO   @RF00264                                         02S0264
*        UCBBPUB = YES;                /*TURN ON PUBLIC BIT          */
         OI    UCBBPUB(@10),B'00001000'                         02S0266
*      END;                                                     02S0267
*    IF UCBVOLI = ZEROVOLI             /*IF NO VOL SER IN THIS UCB,  */
*      THEN DO;                        /*AND IT IS MULTIPLE  @YM02792*/
@RF00264 L     @10,UCBPTR                                       02S0268
         CLC   UCBVOLI(6,@10),ZEROVOLI                          02S0268
         BNE   @RF00268                                         02S0268
*        IF UCBMTPXP = YES             /*EXPOSURE DEVICE,    @YM02792*/
*          THEN DO;                    /*SET NOT-READY IN    @YM02792*/
         TM    UCBMTPXP(@10),B'00001000'                        02S0270
         BNO   @RF00270                                         02S0270
*            IF (UCBBASE + ADJBASE) = UCBPTR               /*@YM02792*/
*              THEN UCBNOTRD = YES;    /*BASE EXPOSURE;      @YM02792*/
         LA    @05,512                                          02S0272
         AL    @05,UCBBASE(,@10)                                02S0272
         CR    @05,@10                                          02S0272
         BNE   @RF00272                                         02S0272
         OI    UCBNOTRD(@10),B'01000000'                        02S0273
*          END;                                            /*@YM02792*/
*          ELSE DO;                                        /*@YM02792*/
         B     @RC00270                                         02S0275
@RF00270 DS    0H                                               02S0276
*            UCBNOTRD = YES;           /*TURN ON NOT RDY BIT @YM02792*/
         L     @10,UCBPTR                                       02S0276
         OI    UCBNOTRD(@10),B'01000000'                        02S0276
*          END;                        /*FOR OTHER DA DEVICES@YM02792*/
*      END;                                                /*@YM02792*/
@RC00270 DS    0H                                               02S0279
*  END;                                                         02S0279
*                                                               02S0279
@RF00268 DS    0H                                               02S0280
*RFY RPARM RSTD;                                                02S0280
@RF00262 DS    0H                                               02S0281
*RPARM = LUTSAVE;                      /*MOVE LUT ADDR INTO PARM REG */
         L     RPARM,LUTSAVE                                    02S0281
*CALL UCBCONT;                         /*OBTAIN NEXT UCB ADDRESS     */
         L     @15,@CV00230                                     02S0282
         BALR  @14,@15                                          02S0282
*UCBPTR = RPARM;                       /*SAVE ADDR OF UCB            */
         ST    RPARM,UCBPTR                                     02S0283
*RFY RPARM UNRSTD;                                              02S0284
*END;                                  /*RETURN TO TOP SEGMENT       */
@DE00261 L     @10,UCBPTR                                       02S0285
         LTR   @10,@10                                          02S0285
         BNZ   @DL00261                                         02S0285
*END;                                                           01S0286
*DO;                                   /* PROCESS SYSTEM PARAMETERS  */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CKPARMS                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - VALIDITY CHECK VAL PARAMETER LIST             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     SET 'PEND' SWITCH EQUAL TO NO, TO INDICATE PARAMETERS EXIST. */
*/*     IF 'PARMPTR' IS ZERO, THEN SET 'DEFAULT' SWITCH TO YES.      */
*/*     OTHERWISE, REMOVE PARENTHESIS IF NECESSARY AND CHECK PARA-   */
*/*     METER LIST FOR TWO DIGITS SEPARATED BY COMMAS.  IF NOT VALID,*/
*/*     ISSUE NIP PROMPT MACRO FOR VAL.  VALIDITY CHECK REPLY.       */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         VALIDITY CHECK VAL PARAMETER LIST FOR TWO DIGITS SEPARAT-*/
*/*         ED BY COMMAS.  IF NO PARAMETERS, SET 'DEFAULT' SWITCH.   */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         VAL - ADDRESS OF VAL PARAMETERS                          */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - VALID PARAMETER LIST                             */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         PEND - SET TO NO                                         */
*/*                                                                  */
*/*     CONDITION - NO PARAMETER LIST SPECIFIED                      */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         DEFAULT - SET TO YES                                     */
*/*         PEND - SET TO NO                                         */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0288
*PLIBMEM = READVAT;                    /*MOVE 'VATLST' INTO READ AREA*/
         L     @10,NVTPAREA(,RNVT)                              02S0288
         MVC   PLIBMEM(6,@10),@CC00142                          02S0288
*PEND = NO;                            /*INDICATE PARAMETERS EXIST   */
*RFY PARMTAB BASED(NVTPTAB);           /*SET ADDR OF VAL PARAMETERS  */
*BADVAL = YES;                         /*INCORRECT VAL FORMAT FOR    */
         OI    BADVAL,B'00000001'                               02S0291
         NI    PEND,B'10111111'                                 02S0291
*                                      /*LOOP ENTRY.                 */
*DO WHILE (BADVAL = YES);              /*VALIDITY CHECK VAL PARAMETERS
*                                        IF FORMAT IS WRONG, OBTAIN
*                                        NEW VAL FROM OPERATOR AND
*                                        CHECK FORMAT OF THESE       */
         B     @DE00292                                         02S0292
@DL00292 DS    0H                                               02S0293
*BADVAL = NO;                          /*RESET SWITCH -CORRECT FORMAT*/
         NI    BADVAL,B'11111110'                               02S0293
*PARMPTR = VAL;                        /*OBTAIN VAL PARAMETER ADDRESS*/
*                                                               02S0294
         L     @10,NVTPTAB(,RNVT)                               02S0294
         L     @10,VAL(,@10)                                    02S0294
         ST    @10,PARMPTR                                      02S0294
*IF PARMPTR = ZERO                     /*IF NO, CHECK VAL PARM ADDR  */
*  THEN DEFAULT = YES;                 /*SET SWITCH FOR DEFAULT 02S0295
*                                        VATLST                      */
         LTR   @10,@10                                          02S0295
         BNZ   @RF00295                                         02S0295
         OI    DEFAULT,B'10000000'                              02S0296
*  ELSE DO;                            /*VAL PARAMETER EXISTS        */
         B     @RC00295                                         02S0297
@RF00295 DS    0H                                               02S0298
*    J = 0;                                                     02S0298
         SLR   @10,@10                                          02S0298
         STH   @10,J                                            02S0298
*    LOOPSW = NO;                                               02S0299
         NI    LOOPSW,B'11101111'                               02S0299
*    DO WHILE LOOPSW = NO;            /*LOCATE END OF PARAMETERS -
*                                        INDICATED BY A QUOTE        */
         B     @DE00300                                         02S0300
@DL00300 DS    0H                                               02S0301
*      J = J + 1;                                               02S0301
         LA    @10,1                                            02S0301
         AH    @10,J                                            02S0301
         STH   @10,J                                            02S0301
*      IF VATPARMS(J) = QUOTE                                   02S0302
*        THEN LOOPSW = YES;                                     02S0302
         L     @05,PARMPTR                                      02S0302
         ALR   @05,@10                                          02S0302
         BCTR  @05,0                                            02S0302
         CLI   VATPARMS(@05),C''''                              02S0302
         BNE   @RF00302                                         02S0302
         OI    LOOPSW,B'00010000'                               02S0303
*    END;                                                       02S0304
@RF00302 DS    0H                                               02S0304
@DE00300 TM    LOOPSW,B'00010000'                               02S0304
         BZ    @DL00300                                         02S0304
*    IF VATPARMS(ONE) = LFTPAREN       /*REMOVE PARENTHESIS          */
*      THEN DO;                                                 02S0305
         L     @10,PARMPTR                                      02S0305
         CLI   VATPARMS(@10),C'('                               02S0305
         BNE   @RF00305                                         02S0305
*        VATPARMS(J-1) = QUOTE;                                 02S0307
         LH    @05,J                                            02S0307
         ALR   @05,@10                                          02S0307
         BCTR  @05,0                                            02S0307
         BCTR  @05,0                                            02S0307
         MVI   VATPARMS(@05),C''''                              02S0307
*        J = J - TWO;                                           02S0308
         LH    @05,J                                            02S0308
         BCTR  @05,0                                            02S0308
         BCTR  @05,0                                            02S0308
         STH   @05,J                                            02S0308
*        PARMPTR = PARMPTR + ONE;                               02S0309
         AH    @10,@CH00042                                     02S0309
         ST    @10,PARMPTR                                      02S0309
*      END;                                                     02S0310
*    IF J // 3 ¬= ZERO                 /*QUOTE IN WRONG POSITION     */
*      THEN BADVAL=YES;                                         02S0311
@RF00305 LH    @00,J                                            02S0311
         SRDA  @00,32                                           02S0311
         D     @00,@CF00064                                     02S0311
         LTR   @00,@00                                          02S0311
         BZ    @RF00311                                         02S0311
         OI    BADVAL,B'00000001'                               02S0312
*    DO K = THREE TO J BY THREE        /*SCAN REPLY                  */
*       WHILE (BADVAL=NO);                                      02S0313
@RF00311 LA    @10,3                                            02S0313
         STH   @10,K                                            02S0313
         B     @DE00313                                         02S0313
@DL00313 TM    BADVAL,B'00000001'                               02S0313
         BNZ   @DC00313                                         02S0313
*      IF VATPARMS(K) ¬= COMMA         /*CHECK FOR ,                 */
*        & VATPARMS(K) ¬= QUOTE        /*  OR '                      */
*        THEN BADVAL=YES;              /*INDICATE ERROR              */
         L     @05,PARMPTR                                      02S0314
         ALR   @10,@05                                          02S0314
         BCTR  @10,0                                            02S0314
         CLI   VATPARMS(@10),C','                               02S0314
         BE    @RF00314                                         02S0314
         LH    @10,K                                            02S0314
         ALR   @05,@10                                          02S0314
         BCTR  @05,0                                            02S0314
         CLI   VATPARMS(@05),C''''                              02S0314
         BE    @RF00314                                         02S0314
         OI    BADVAL,B'00000001'                               02S0315
*    END;                                                       02S0316
@RF00314 LA    @10,3                                            02S0316
         AH    @10,K                                            02S0316
         STH   @10,K                                            02S0316
@DE00313 CH    @10,J                                            02S0316
         BNH   @DL00313                                         02S0316
@DC00313 DS    0H                                               02S0317
*    IF BADVAL = YES                   /*INCORRECT PARAMETER FORMAT  */
*      THEN DO;                                                 02S0317
         TM    BADVAL,B'00000001'                               02S0317
         BNO   @RF00317                                         02S0317
*        GEN REFS(NVTPRMPT,PROMPT);   /*PROMPT OP FOR CORRECT PARAMS */
         IEAPMNIP TYPE=PRMPT,PARAM=PROMPT,OPT=ERROR
*        PROMPT OPERATOR FOR NEW VAL PARAMETERS
*      END;                                                     02S0320
*  END;                                                         02S0321
@RF00317 DS    0H                                               02S0322
*END;                                 /*RETURN TO TOP SEGMENT.       */
@RC00295 DS    0H                                               02S0322
@DE00292 TM    BADVAL,B'00000001'                               02S0322
         BO    @DL00292                                         02S0322
*END;                                                           01S0323
*NIPPAFL1 = YES;                       /* SUPPRESS 'MEMBER NOT FOUND'*/
         L     @10,NVTPTAB(,RNVT)                               01S0324
         OI    NIPPAFL1(@10),B'10000000'                        01S0324
*                                      /* MESSAGE FROM READ          */
*DO WHILE PEND = NO;                   /* PROCESS VATLST ENTRIES.    */
         B     @DE00325                                         01S0325
@DL00325 DS    0H                                               01S0326
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SYSPARMS                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - OBTAIN VATLST MEMBER NUMBER                   */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     SET 'READ' SWITCH EQUAL TO YES, TO INDICATE THIS VATLST      */
*/*     MEMBER HAS NOT BEEN READ YET.                                */
*/*                                                                  */
*/*     IF 'DEFAULT' SWITCH EQUALS YES, THEN SET 'PEND' SWITCH TO    */
*/*     YES, AND MOVE '00' INTO NIPPANAM+6.  OTHERWISE, 'PARMPTR'    */
*/*     CONTAINS ADDRESS OF FIRST VATLST MEMBER NUMBER IN            */
*/*     SYSTEM PARAMETER AREA.  MOVE TWO DIGITS INTO NIPPANAM+6.     */
*/*                                                                  */
*/*     SEE IF CHARACTER FOLLOWING MEMBER NUMBER IS A COMMA.         */
*/*     IF IT IS, THEN THERE  IS MORE THAN ONE VATLST; UPDATE        */
*/*     'PARMPTR' TO POINT TO NEXT PARAMETER. IF CHARACTER IS NOT    */
*/*     A COMMA, THEN THE END OF THE PARAMETER LIST HAS BEEN         */
*/*     REACHED; SET 'PEND' EQUAL TO YES.                            */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         PREPARE READ PARAMETER                                   */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         PARMPTR - ADDRESS OF VAL SYSTEM PARAMETERS               */
*/*         DEFAULT - SWITCH TO INDICATE DEFAULT LIST                */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NOT ALL VATLSTS HAVE BEEN READ                   */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         NAME OF VATLST TO BE READ                                */
*/*                                                                  */
*/*     CONDITION - END OF PARAMETER LISTS                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         NAME OF VATLST TO BE READ                                */
*/*         PEND - SET TO YES                                        */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0326
*READ = YES;                           /*INDICATE THERE IS A VATLST
*                                        TO BE READ                  */
         OI    READ,B'00100000'                                 02S0326
*IF DEFAULT = YES                      /*USE PARMS OR DEFAULT?       */
*  THEN DO;                                                     02S0327
         TM    DEFAULT,B'10000000'                              02S0327
         BNO   @RF00327                                         02S0327
*    PEND = YES;                       /*NO MORE PARMS AFTER THIS ONE*/
         OI    PEND,B'01000000'                                 02S0329
*    SUFFIX = DEFLTVAT;                /*MOVE '00' INTO READ AREA    */
         L     @10,NVTPAREA(,RNVT)                              02S0330
         MVC   SUFFIX(2,@10),@CC00144                           02S0330
*  END;                                                         02S0331
*  ELSE DO;                                                     02S0332
         B     @RC00327                                         02S0332
@RF00327 DS    0H                                               02S0333
*    SUFFIX = VATPARMS(ONE:TWO);       /*MOVE VATLST NUMBER INTO
*                                        READ AREA                   */
         L     @10,NVTPAREA(,RNVT)                              02S0333
         L     @05,PARMPTR                                      02S0333
         MVC   SUFFIX(2,@10),VATPARMS(@05)                      02S0333
*    IF VATPARMS(THREE) = COMMA        /*CHECK FOR MORE PARAMTERS    */
*      THEN DO;                                                 02S0334
         CLI   VATPARMS+2(@05),C','                             02S0334
         BNE   @RF00334                                         02S0334
*        PARMPTR = PARMPTR+THREE;      /*POINT TO NEXT PARAMETER     */
         AL    @05,@CF00064                                     02S0336
         ST    @05,PARMPTR                                      02S0336
*      END;                                                     02S0337
*      ELSE PEND = YES;                /*END OF PARAMETERS           */
*                                                               02S0338
*                                                               02S0338
         B     @RC00334                                         02S0338
@RF00334 OI    PEND,B'01000000'                                 02S0338
*  END;                                                         02S0339
@RC00334 DS    0H                                               02S0340
*DO WHILE (READ = YES);                /*READ VATLST                 */
@RC00327 B     @DE00340                                         02S0340
@DL00340 DS    0H                                               02S0341
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - RDENTRY                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - READ AN ENTRY FROM VATLST                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     READ AN ENTRY FROM VATLSTXX.  CHECK READ RETURN.  IF READ    */
*/*     WAS GOOD, EXECUTE SEGMENT 'CKENTRY'.  IF EOF, SET 'READ'     */
*/*     SWITCH TO OFF.  IF A LIST WAS NOT FOUND, EXECUTE SEGMENT     */
*/*     'NOLIST'.  IF AN  I/O ERROR OCCURRED, EXECUTE SEGMENT        */
*/*     'RDERR'.                                                     */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         NIPPANAM - PARMLIB MEMBER NAME                           */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         A VATLST ENTRY                                           */
*/*                                                                  */
*/*     CONDITION - EOF OR ERROR                                     */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         READ - SET TO OFF                                        */
*/*                                                                  */
*/*     CONDITION - NOT FOUND                                        */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         READ - SET TO OFF IF OPERATOR DID NOT SUPPLY AN          */
*/*                ALTERNATE LIST                                    */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0341
*RFY (RPARM) RSTD;                                              03S0341
*CALL NIPPMMEM;                        /* READ RECORD FROM VATLST    */
         BAL   @14,NIPPMMEM                                     03S0342
*IF REG1FIX ¬< ZERO                    /* IF NOT NEGATIVE, READ WAS  */
*  THEN DO;                            /* GOOD.                      */
         SLR   @10,@10                                          03S0343
         CR    REG1FIX,@10                                      03S0343
         BL    @RF00343                                         03S0343
*    MAPAD = RPARM;                    /* MAP VATLST ENTRY           */
         ST    RPARM,MAPAD                                      03S0345
*    RFY (RPARM) UNRSTD;               /* CHECK FORMAT OF ENTRY.     */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CKENTRY                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHECK FORMAT OF VATLST ENTRY                  */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     THE 'WTO' MESSAGE SWITCH IS SET ON IN CASE OF ERROR.  THE    */
*/*     FORMAT OF THE VATLST ENTRY IS CHECKED FOR:                   */
*/*         1. AN ABSENCE OF COMMAS IN THE VOLUME SERIAL AND DEVICE  */
*/*            TYPE FIELDS.                                          */
*/*         2. DELIMITERS (COMMAS) IN COLUMNS 7, 9, AND 11.          */
*/*         3. A COMMA OR BLANK IN COLUMN 20.                        */
*/*                                                                  */
*/*     IF NONE OF THE ABOVE TESTS FAIL, THE SWITCH 'WTO' IS SET     */
*/*     OFF.                                                         */
*/*                                                                  */
*/*     IF THE FORMAT IS VALID, CONTROL GOES TO THE SEGMENT THAT     */
*/*     DETERMINES IF THE ENTRY WILL BE PLACED IN THE MOUNT LIST.    */
*/*                                                                  */
*/*     IF THE 'WTO' SWITCH IS ON, MESSAGE 'IEA855I-INVALID VATLSTXX */
*/*     ENTRY' IS ISSUED.                                            */
*/*                                                                  */
*/*         NOTE: THE 'WTO' SWITCH IS ALSO SET BY SEGMENT 'MNTLSTCK' */
*/*               IF THE DEVICE TYPE IS INVALID.                     */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         AN 80-BYTE VATLSTXX ENTRY FROM SYS1.PARMLIB:             */
*/*           COL 1-6   VOLUME SERIAL                                */
*/*           COL 7     COMMA                                        */
*/*           COL 8     MOUNT CHARACTERISTIC                         */
*/*           COL 9     COMMA                                        */
*/*           COL 10    ALLOCATION CHARACTERISTIC                    */
*/*           COL 11    COMMA                                        */
*/*           COL 12-19 DEVICE TYPE                                  */
*/*           COL 20    COMMA OR BLANK                               */
*/*           COL 21    MOUNT PRIORITY                               */
*/*           COL 22    BLANK                                        */
*/*           COL 23-80 OPTIONAL INFORMATION                         */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - VATLST ENTRY VALIDATED                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         WTO - SET TO OFF                                         */
*/*                                                                  */
*/*     CONDITION - ERROR IN ENTRY                                   */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         WTO - SET ON                                             */
*/*         MESSAGE(S) IEA855I                                       */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               04S0347
*UCBPTR = ZERO;                        /* INITIALIZE UCB POINTER     */
         ST    @10,UCBPTR                                       04S0347
*ERROR = NO;                           /* INITIALIZE ERROR SWITCH.   */
         NI    ERROR,B'11011111'                                04S0348
*WTO = YES;                            /* SET MSG SW IN CASE ERROR.  */
         OI    WTO,B'00001000'                                  04S0349
*LOOPSW = NO;                          /* INIT LOOP SWITCH           */
         NI    LOOPSW,B'11101111'                               04S0350
*  DO I = SEVENTY2 TO ONE BY - ONE WHILE LOOPSW = NO;           04S0351
         LA    @10,72                                           04S0351
         STH   @10,I                                            04S0351
@DL00351 TM    LOOPSW,B'00010000'                               04S0351
         BNZ   @DC00351                                         04S0351
*    IF ENTRIE(I) = RDEND THEN         /* IF ENTRY DOES NOT BEGIN    */
         L     @05,MAPAD                                        04S0352
         ALR   @05,@10                                          04S0352
         BCTR  @05,0                                            04S0352
         CLC   ENTRIE(1,@05),RDEND                              04S0352
         BNE   @RF00352                                         04S0352
*      ERROR = YES;                    /* IN COL 1 THEN FORMAT IS IN */
         OI    ERROR,B'00100000'                                04S0353
*      LOOPSW = YES;                   /* ERROR. TERM. CHECK.        */
@RF00352 OI    LOOPSW,B'00010000'                               04S0354
*  END;                                                         04S0355
         SLR   @10,@10                                          04S0355
         BCTR  @10,0                                            04S0355
         AH    @10,I                                            04S0355
         STH   @10,I                                            04S0355
         LTR   @10,@10                                          04S0355
         BP    @DL00351                                         04S0355
@DC00351 DS    0H                                               04S0356
*IF ERROR = NO THEN                    /* IF NO ERROR SO FAR,        */
         TM    ERROR,B'00100000'                                04S0356
         BNZ   @RF00356                                         04S0356
*  DO;                                 /* CONTINUE CHECKING.         */
*    LOOPSW = NO;                      /* INIT LOOP SWITCH.          */
         NI    LOOPSW,B'11101111'                               04S0358
*    DO I = SIX TO ONE BY - ONE WHILE LOOPSW = NO;              04S0359
         LA    @10,6                                            04S0359
         STH   @10,I                                            04S0359
@DL00359 TM    LOOPSW,B'00010000'                               04S0359
         BNZ   @DC00359                                         04S0359
*      IF EVOLSER(I) = COMMA           /* IF THERE IS A COMMA IN THE */
*        THEN DO;                      /* VOLUME SERIAL FIELD, SET   */
         L     @05,MAPAD                                        04S0360
         ALR   @05,@10                                          04S0360
         BCTR  @05,0                                            04S0360
         CLI   EVOLSER(@05),C','                                04S0360
         BNE   @RF00360                                         04S0360
*          ERROR = YES;                /* ERROR SWITCH ON AND TERM.  */
         OI    ERROR,B'00100000'                                04S0362
*          LOOPSW = YES;               /* CHECKING.                  */
         OI    LOOPSW,B'00010000'                               04S0363
*        END;                                                   04S0364
*    END;                                                       04S0365
@RF00360 SLR   @10,@10                                          04S0365
         BCTR  @10,0                                            04S0365
         AH    @10,I                                            04S0365
         STH   @10,I                                            04S0365
         LTR   @10,@10                                          04S0365
         BP    @DL00359                                         04S0365
@DC00359 DS    0H                                               04S0366
*  END;                                                         04S0366
*LOOPSW = NO;                          /* INIT LOOP SWITCH           */
@RF00356 NI    LOOPSW,B'11101111'                               04S0367
*IF ERROR = NO                         /* IF NO ERROR SO FAR,        */
*  THEN IF DELIM1 = COMMA              /* CHECK FOR DELIMITERS IN    */
         TM    ERROR,B'00100000'                                04S0368
         BNZ   @RF00368                                         04S0368
*    THEN IF DELIM2 = COMMA            /* COLS 7, 9, AND 11.         */
         L     @10,MAPAD                                        04S0369
         CLI   DELIM1(@10),C','                                 04S0369
         BNE   @RF00369                                         04S0369
*      THEN IF DELIM3 = COMMA                                   04S0370
         CLI   DELIM2(@10),C','                                 04S0370
         BNE   @RF00370                                         04S0370
*        THEN DO I = EIGHT TO ONE BY - ONE WHILE LOOPSW = NO;   04S0371
         CLI   DELIM3(@10),C','                                 04S0371
         BNE   @RF00371                                         04S0371
         LA    @10,8                                            04S0372
         STH   @10,I                                            04S0372
@DL00372 TM    LOOPSW,B'00010000'                               04S0372
         BNZ   @DC00372                                         04S0372
*          IF EDEVTYPE(I) = COMMA      /* IF THERE IS A COMMA IN THE */
*            THEN DO;                  /* DEVICE TYPE FIELD, SET     */
         L     @05,MAPAD                                        04S0373
         ALR   @05,@10                                          04S0373
         CLI   EDEVTYPE-1(@05),C','                             04S0373
         BNE   @RF00373                                         04S0373
*              ERROR = YES;            /* ERROR SWITCH ON AND TERM.  */
         OI    ERROR,B'00100000'                                04S0375
*              LOOPSW = YES;           /* CHECKING.                  */
         OI    LOOPSW,B'00010000'                               04S0376
*            END;                                               04S0377
*        END;                                                   04S0378
@RF00373 SLR   @10,@10                                          04S0378
         BCTR  @10,0                                            04S0378
         AH    @10,I                                            04S0378
         STH   @10,I                                            04S0378
         LTR   @10,@10                                          04S0378
         BP    @DL00372                                         04S0378
@DC00372 DS    0H                                               04S0379
*      ELSE ERROR = YES;               /* FORMAT ERROR               */
         B     @RC00371                                         04S0379
@RF00371 OI    ERROR,B'00100000'                                04S0379
*    ELSE ERROR = YES;                                          04S0380
         B     @RC00370                                         04S0380
@RF00370 OI    ERROR,B'00100000'                                04S0380
*  ELSE ERROR = YES;                                            04S0381
         B     @RC00369                                         04S0381
@RF00369 OI    ERROR,B'00100000'                                04S0381
*IF ERROR = NO                         /* IF NO ERROR SO FAR, AND    */
*  THEN IF DELIM4 = BLANK | DELIM4 = COMMA  /* IF BLANK OR COMMA IN  */
@RC00369 DS    0H                                               04S0382
@RF00368 TM    ERROR,B'00100000'                                04S0382
         BNZ   @RF00382                                         04S0382
*    THEN DO;                          /* COL 20 THEN FORMAT IS      */
         L     @10,MAPAD                                        04S0383
         CLI   DELIM4(@10),C' '                                 04S0383
         BE    @RT00383                                         04S0383
         CLI   DELIM4(@10),C','                                 04S0383
         BNE   @RF00383                                         04S0383
@RT00383 DS    0H                                               04S0384
*      WTO = NO;                       /* CORRECT. TURN OFF ERROR    */
         NI    WTO,B'11110111'                                  04S0385
*      DO;                             /* MESSAGE SWITCH.            */
*                                      /* PUT ENTRY IN LIST.         */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - MNTLSTCK                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DETERMINE IF ENTRY SHOULD BE ADDED TO MOUNT   */
*/*                    LIST                                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     THE DEVICE TYPE IN THE VATLST ENTRY IS COMPARED      @Y30LPPD*/
*/*     AGAINST A TABLE OF VALID REAL DEVICE TYPES. IF THE   @Y30LPPD*/
*/*     ENTRY DEVICE TYPE MATCHES ONE IN THE TABLE, THE      @Y30LPPD*/
*/*     'FOUND' SWITCH IS SET ON TO TERMINATE THE SEARCH.    @Y30LPPD*/
*/*     IF THE DEVICE TYPE WASN'T FOUND IN THE TABLE, AND IF @Y30LPPD*/
*/*     THE FIRST CHARACTER IS 'V' THEN SERVICE ROUTINE UCBFN@Y30LPPD*/
*/*     IS CALLED FOR CHARACTERS 2  THRU 4. IF THE RETURN IS @Y30LPPD*/
*/*     SUCCESSFUL AND IF THE UCB RETURNED IS VIRTUAL THEN   @Y30LPPD*/
*/*     'FOUND' IS SET ON TO INDICATE A VALID DEVICE TYPE.   @Y30LPPD*/
*/*     FOR REAL VOLUMES, I IS THE INDEX INTO THE TABLE OF   @Y30LPPD*/
*/*     VALID REAL DEVICE TYPES. FOR MSS VOLUMES, I IS SET   @Y30LPPD*/
*/*     TO ONE GREATER THAN THE NUMBER OF VALID REAL DEVICE  @Y30LPPD*/
*/*     TYPES.                                               @Y30LPPD*/
*/*     MSS ENTRIES ARE SUPPRESSED IF MSS IS NOT             @G24LPSJ*/
*/*     INITIALIZED.                                         @G24LPSJ*/
*/*                                                                  */
*/*     IF THE DEVICE TYPE IS VALID AND THE MOUNT LIST IS FULL       */
*/*     (300 ENTRIES EXIST), NO MORE PROCESSING IS DONE FOR THE      */
*/*     ENTRY. IF THE MOUNT LIST IS NOT FULL, THE SEGMENT THAT       */
*/*     BUILDS THE MOUNT LIST IS EXECUTED.                           */
*/*                                                                  */
*/*     IF THE DEVICE TYPE IS INVALID (THE FOUND SWITCH IS NOT ON),  */
*/*     THE 'WTO' SWITCH IS SET ON SO THAT THE MESSAGE 'IEA855I-     */
*/*     INVALID VATLSTXX ENTRY' WILL BE ISSUED.                      */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         A VATLST ENTRY                                           */
*/*         MTLSTCT - THE NUMBER OF ENTRIES IN THE MOUNT LIST        */
*/*         DUPSER - SET ON IF MULTIPLE ENTRIES FOR VOLUME           */
*/*                  ARE ENCOUNTERED                                 */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - DEVICE TYPE IN ENTRY IS VALID                    */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         DEVCT - DEVICE TYPE COUNTER UPDATED IF FIRST VOLUME      */
*/*                 ENTRY                                            */
*/*         FOUND - SET ON                                           */
*/*                                                                  */
*/*     CONDITION - INVALID DEVICE TYPE ENTRY                        */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         WTO - SET ON                                             */
*/*         FOUND - SET OFF                                          */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               05S0387
*FOUND = NO;                           /* INITIALIZE FOUND SWITCH.   */
         NI    FOUND,B'11111101'                                05S0387
*SUPPRESS = OFF;                       /* INITIALIZE SUPPRESS SWITCH
*                                         OFF                @G24LPSJ*/
         NI    SUPPRESS,B'11110111'                             05S0388
*DO IND = NUMSUPTD TO ONE BY - ONE     /* IS ENTRY DEVICE            */
*  WHILE FOUND = NO;                   /* TYPE SUPPORTED?            */
         LA    @10,7                                            05S0389
         STH   @10,IND                                          05S0389
@DL00389 TM    FOUND,B'00000010'                                05S0389
         BNZ   @DC00389                                         05S0389
*  IF ETYPE(IND) = EDEVTYPE                                     05S0390
*    THEN DO;                          /* IF TYPE IS VALID, SET      */
         LR    @05,@10                                          05S0390
         MH    @05,@CH01793                                     05S0390
         LA    @01,ETYPE-14(@05)                                05S0390
         L     @05,MAPAD                                        05S0390
         CLC   0(8,@01),EDEVTYPE(@05)                           05S0390
         BNE   @RF00390                                         05S0390
*      FOUND = YES;                    /* FOUND SWITCH ON.           */
         OI    FOUND,B'00000010'                                05S0392
*      I = IND;                        /* SAVE INDEX         @Y30LPPD*/
         STH   @10,I                                            05S0393
*    END;                                                       05S0394
*END;                                                           05S0395
@RF00390 SLR   @10,@10                                          05S0395
         BCTR  @10,0                                            05S0395
         AH    @10,IND                                          05S0395
         STH   @10,IND                                          05S0395
         LTR   @10,@10                                          05S0395
         BP    @DL00389                                         05S0395
@DC00389 DS    0H                                               05S0396
*IF FOUND = NO                         /* IF DEVICE TYPE NOT    05S0396
*                                         FOUND IN TABLE     @Y30LPPD*/
*  THEN IF EDEVTYPE(ONE) = VIRT        /* CHECK FOR VXXX.    @Y30LPPD*/
         TM    FOUND,B'00000010'                                05S0396
         BNZ   @RF00396                                         05S0396
*    THEN DO;                          /* VIRTUAL SPECIFIED. @Y30LPPD*/
         L     @10,MAPAD                                        05S0397
         CLI   EDEVTYPE(@10),C'V'                               05S0397
         BNE   @RF00397                                         05S0397
*      FINDDEV = EDEVTYPE(2:4);        /* MOVE VUA TO PARM   @Y30LPPD*/
         MVC   FINDDEV(3),EDEVTYPE+1(@10)                       05S0399
*      RFY RPARM RSTD;                 /*                    @Y30LPPD*/
*      RPARM = FINDADDR;               /* SET UP PARAMETER   @Y30LPPD*/
         L     RPARM,FINDADDR                                   05S0401
*      GEN REFS(NVTUCBFN,RPARM)                                 05S0402
*      (IEAPMNIP TYPE=UCBFN,PARAM=RPARM); /*  LOCATE UCB     @Y30LPPD*/
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM
*      IF RPARM ¬= ZERO                /* UCB FOUND?         @Y30LPPD*/
*        THEN DO;                      /* YES                @Y30LPPD*/
         SLR   @10,@10                                          05S0403
         CR    RPARM,@10                                        05S0403
         BE    @RF00403                                         05S0403
*          UCBPTR = RPARM;             /* ADDRESS UCB        @Y30LPPD*/
         ST    RPARM,UCBPTR                                     05S0405
*          RFY RPARM UNRSTD;           /*                    @Y30LPPD*/
*          IF UCBRVDEV = YES &         /* IS UCB VIRTUAL?    @Y30LPPD*/
*             UCBTYP(3:4) = COMP3330   /* IS UCB 3330?       @Y30LPPD*/
*            THEN DO;                  /* YES                @Y30LPPD*/
         L     @05,UCBPTR                                       05S0407
         TM    UCBRVDEV(@05),B'00001000'                        05S0407
         BNO   @RF00407                                         05S0407
         CLC   UCBTYP+2(2,@05),@CB00140                         05S0407
         BNE   @RF00407                                         05S0407
*              FOUND = YES;            /* VALID DEVICE TYPE  @Y30LPPD*/
         OI    FOUND,B'00000010'                                05S0409
*              I = NUMSUPTD + ONE;     /* INDICATE 3330V     @Y30LPPD*/
         MVC   I(2),@CH00035                                    05S0410
*              IF CVTICB ¬= ZERO&      /* IF ICB EXISTS AND  @G24LPSJ*/
*                 ICBI = OFF THEN      /* MSS NOT INIT. THEN @G24LPSJ*/
         L     @05,CVTPTR                                       05S0411
         L     @05,CVTEXT2(,@05)                                05S0411
         L     @05,CVTICB(,@05)                                 05S0411
         CR    @05,@10                                          05S0411
         BE    @RF00411                                         05S0411
         TM    ICBI(@05),B'10000000'                            05S0411
         BNZ   @RF00411                                         05S0411
*                SUPPRESS = ON;        /* SUPPRESS MSS          05S0412
*                                         REQUESTS           @G24LPSJ*/
         OI    SUPPRESS,B'00001000'                             05S0412
*            END;                      /*                    @Y30LPPD*/
*            ELSE;                     /*                    @Y30LPPD*/
@RF00407 DS    0H                                               05S0415
*        END;                          /*                    @Y30LPPD*/
*        ELSE;                         /*                    @Y30LPPD*/
@RF00403 DS    0H                                               05S0417
*    END;                              /*                    @Y30LPPD*/
*    ELSE;                             /*                    @Y30LPPD*/
@RF00397 DS    0H                                               05S0419
*  ELSE;                                                        05S0419
@RF00396 DS    0H                                               05S0420
*IF FOUND = NO                         /* IF THE DEV TYPE IS INVALID,*/
*  THEN WTO = YES;                     /* SET ERR MSG SWITCH ON.     */
@RC00396 TM    FOUND,B'00000010'                                05S0420
         BNZ   @RF00420                                         05S0420
         OI    WTO,B'00001000'                                  05S0421
*  ELSE IF MTLSTCT ¬= MNTMAX&          /* IF MOUNT LIST IS   @Y30LPPD*/
*                                      /* NOT FULL AND       @G24LPSJ*/
*          SUPPRESS = OFF THEN         /* SUPPRESS IS NOT ON @G24LPSJ*/
         B     @RC00420                                         05S0422
@RF00420 LH    @10,MTLSTCT                                      05S0422
         CH    @10,@CH00086                                     05S0422
         BE    @RF00422                                         05S0422
         TM    SUPPRESS,B'00001000'                             05S0422
         BNZ   @RF00422                                         05S0422
*    DO;                               /* THEN ADD           @G24LPSJ*/
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - MOUNTLST                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD MOUNT LIST                              */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     THE VOLUME SERIAL IN THE VATLST ENTRY IS COMPARED WITH ANY   */
*/*     VOLUME SERIALS THAT ARE ALREADY IN THE MOUNT LIST.  IF A     */
*/*     DUPLICATE IS FOUND, THE EXISTING MOUNT LIST ENTRY IS OVER-   */
*/*     LAID WITH THE CURRENT ENTRY. IF A DUPLICATE VOLSER IS@Y30LPPD*/
*/*     NOT FOUND AND I INDICATES THAT THE DEVICE TYPE IS    @Y30LPPD*/
*/*     VIRTUAL, THEN THE DEVICE TYPE OF THE VATLST ENTRY IS @Y30LPPD*/
*/*     COMPARED AGAINST THOSE IN THE MOUNT LIST. THIS IS    @Y30LPPD*/
*/*     BECAUSE, FOR MSS VOLUMES, THE ACTUAL DEVICE ADDRESS  @Y30LPPD*/
*/*     IS SPECIFIED IN THE ENTRY; TWO ENTRIES WITH          @Y30LPPD*/
*/*     VOLUME SERIALS CAN NOT BE ENTERED IN THE MOUNT LIST  @Y30LPPD*/
*/*     FOR THE SAME DEVICE ADDRESS. IF A DUPLICATE          @Y30LPPD*/
*/*     IS FOUND, THE EXISTING MOUNT LIST ENTRY IS OVER-     @Y30LPPD*/
*/*     LAID WITH THE CURRENT VATLST ENTRY, SO THAT THE MOUNT AND    */
*/*     USE STATUS SET IN THE UCB WILL BE THAT OF THE LAST VATLST    */
*/*     ENTRY SPECIFIED BY THE USER.  IF NO DUPLICATE IS FOUND, THE  */
*/*     VATLST ENTRY IS ADDED TO THE END OF THE MOUNT LIST (MNTLIST).*/
*/*     THE INDEX OF THE UCB UNIT TYPE IN THE DEVTYPES TABLE IS      */
*/*     ADDED TO THE MNTLIST ALSO.                                   */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         A VATLST ENTRY                                           */
*/*         MTLSTCT - NUMBER OF ENTRIES IN THE MOUNT LIST            */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MNTLIST - UPDATED                                        */
*/*         MTLSTCT - UPDATED                                        */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               06S0424
*/********************************************************************/
*/*                                                                  */
*/* NOTE: IN THE FOLLOWING CODE, INSTRUCTION DEVENT(J) =I MUST       */
*/*       FOLLOW MNTLIST(J) = MNTENTRY, AND INSTRUCTION              */
*/*       DEVENT(MTLSTCT) = I MUST FOLLOW MNTLIST(MTLSTCT) =         */
*/*       MNTENTRY.                                                  */
*/********************************************************************/
*DUPSER = NO;                          /* INITIALIZE DUPSER SWITCH   */
*DUPADDR = NO;                         /*INIT DUPADDR SWITCH @Y30LPPD*/
         NI    DUPSER,B'11111100'                               06S0425
*IF MTLSTCT ¬= ZERO                    /* FIRST ENTRY?               */
*  THEN DO;                            /* NO                         */
         LTR   @10,@10                                          06S0426
         BZ    @RF00426                                         06S0426
*    DO J = ONE TO MTLSTCT             /* SCAN FOR DUPLICATE         */
*      WHILE DUPSER = NO;              /* VOLUME SERIALS             */
         LA    @10,1                                            06S0428
         B     @DE00428                                         06S0428
@DL00428 TM    DUPSER,B'00000010'                               06S0428
         BNZ   @DC00428                                         06S0428
*      IF EVOLSER = MVOLSER(J)         /* COMPARE VOLSERS            */
*        THEN DO;                                               06S0429
         L     @05,MAPAD                                        06S0429
         MH    @10,@CH00190                                     06S0429
         LA    @01,MVOLSER-22(@10)                              06S0429
         CLC   EVOLSER(6,@05),0(@01)                            06S0429
         BNE   @RF00429                                         06S0429
*          MNTLIST(J) = MNTENTRY;      /* IF DUPLICATE IS FOUND,     */
         LA    @01,MNTLIST-22(@10)                              06S0431
         MVI   21(@01),C' '                                     06S0431
         MVC   0(21,@01),MNTENTRY(@05)                          06S0431
*          DEVENT(J) = I;              /* COVER THE OLD ENTRY,       */
         LH    @05,I                                            06S0432
         STC   @05,DEVENT-22(@10)                               06S0432
*          DUPSER = YES;               /* SET UNIT TYPE INDEX AND    */
         OI    DUPSER,B'00000010'                               06S0433
*        END;                          /* SET DUPSER SWITCH ON.      */
*    END;                              /* END SCAN           @Y30LPPD*/
@RF00429 LA    @10,1                                            06S0435
         AH    @10,J                                            06S0435
@DE00428 STH   @10,J                                            06S0435
         CH    @10,MTLSTCT                                      06S0435
         BNH   @DL00428                                         06S0435
@DC00428 DS    0H                                               06S0436
*    IF DUPSER = NO &                  /* IF NO DUP VOLSERS  @Y30LPPD*/
*       I > NUMSUPTD                   /* AND ENTRY IS VIRT, @Y30LPPD*/
*      THEN DO J = ONE TO MTLSTCT      /* SCAN FOR DUPLICATE @Y30LPPD*/
         TM    DUPSER,B'00000010'                               06S0436
         BNZ   @RF00436                                         06S0436
         LH    @10,I                                            06S0436
         CH    @10,@CH00084                                     06S0436
         BNH   @RF00436                                         06S0436
*        WHILE DUPADDR = NO;           /* DEVICE ADDRESSES   @Y30LPPD*/
         LA    @10,1                                            06S0437
         B     @DE00437                                         06S0437
@DL00437 TM    DUPADDR,B'00000001'                              06S0437
         BNZ   @DC00437                                         06S0437
*        IF EDEVTYPE = MDEVTYPE(J)     /* COMPARE DEV ADDRS  @Y30LPPD*/
*          THEN DO;                    /* MATCH -            @Y30LPPD*/
         L     @05,MAPAD                                        06S0438
         MH    @10,@CH00190                                     06S0438
         LA    @01,MDEVTYPE-22(@10)                             06S0438
         CLC   EDEVTYPE(8,@05),0(@01)                           06S0438
         BNE   @RF00438                                         06S0438
*            MNTLIST(J) = MNTENTRY;    /* COVER OLD ENTRY    @Y30LPPD*/
         LA    @01,MNTLIST-22(@10)                              06S0440
         MVI   21(@01),C' '                                     06S0440
         MVC   0(21,@01),MNTENTRY(@05)                          06S0440
*            DEVENT(J) = I;            /* SET UNIT TYPE INDEX@Y30LPPD*/
         LH    @05,I                                            06S0441
         STC   @05,DEVENT-22(@10)                               06S0441
*            DUPADDR = YES;            /* IND DUPLICATE ADDR @Y30LPPD*/
         OI    DUPADDR,B'00000001'                              06S0442
*          END;                                                 06S0443
*      END;                                                     06S0444
@RF00438 LA    @10,1                                            06S0444
         AH    @10,J                                            06S0444
@DE00437 STH   @10,J                                            06S0444
         CH    @10,MTLSTCT                                      06S0444
         BNH   @DL00437                                         06S0444
@DC00437 DS    0H                                               06S0445
*  END;                                                         06S0445
@RF00436 DS    0H                                               06S0446
*IF (DUPSER = NO) &                    /* DUPLICATE VOLSER?  @Y30LPPD*/
*   (DUPADDR = NO)                     /* DUPLICATE DEV ADDR?@Y30LPPD*/
*  THEN DO;                            /* NO -               @Y30LPPD*/
@RF00426 TM    DUPSER,B'00000011'                               06S0446
         BNZ   @RF00446                                         06S0446
*    MTLSTCT = (MTLSTCT + ONE);        /* INCREMENT THE NUMBER OF    */
         LA    @10,1                                            06S0448
         AH    @10,MTLSTCT                                      06S0448
         STH   @10,MTLSTCT                                      06S0448
*    MNTLIST(MTLSTCT) = MNTENTRY;      /* ENTRIES IN THE LIST AND    */
         MH    @10,@CH00190                                     06S0449
         LA    @05,MNTLIST-22(@10)                              06S0449
         MVI   21(@05),C' '                                     06S0449
         L     @01,MAPAD                                        06S0449
         MVC   0(21,@05),MNTENTRY(@01)                          06S0449
*    DEVENT(MTLSTCT) = I;              /* SET UNIT TYPE INDEX        */
         LH    @05,I                                            06S0450
         STC   @05,DEVENT-22(@10)                               06S0450
*  END;                                /* ADD THIS ENTRY TO THE END. */
*                                      /* RETURN TO MNTLSTCK.        */
*    END;                              /*                    @Y30LPPD*/
@RF00446 DS    0H                                               05S0453
*                                      /* RETURN TO CKENTRY.         */
*      END;                                                     04S0453
@RF00422 DS    0H                                               04S0453
@RC00420 DS    0H                                               04S0454
*    END;                                                       04S0454
*IF WTO = YES                          /* IF FORMAT WAS INVALID, OR  */
*  THEN DO;                            /* DEVICE TYPE WAS INVALID,   */
@RF00383 DS    0H                                               04S0455
@RF00382 TM    WTO,B'00001000'                                  04S0455
         BNO   @RF00455                                         04S0455
*    NN855 = SUFFIX;                   /* SET UP AND ISSUE ERROR     */
         L     @10,NVTPAREA(,RNVT)                              04S0457
         MVC   NN855(2),SUFFIX(@10)                             04S0457
*    GEN REFS(NVTWTO);                 /* MESSAGE.                   */
     IEAPMNIP TYPE=WTO,PARAM=IEA855I
*  END;                                                         04S0459
*                                      /* RETURN TO RDENTRY.         */
*  END;                                                         03S0460
*  ELSE IF NIPPARC = SIXTEEN           /* IF EOF WAS RETURNED, THEN  */
*    THEN READ = NO;                   /* SET READ SWITCH TO OFF.    */
         B     @RC00343                                         03S0461
@RF00343 L     @10,NVTPAREA(,RNVT)                              03S0461
         CLC   NIPPARC(4,@10),@CF00080                          03S0461
         BNE   @RF00461                                         03S0461
         NI    READ,B'11011111'                                 03S0462
*    ELSE IF NIPPARC = FOUR            /* IF MEMBER WAS NOT FOUND,   */
*      THEN DO;                        /* THEN ASK OPERATOR TO RE-   */
         B     @RC00461                                         03S0463
@RF00461 L     @10,NVTPAREA(,RNVT)                              03S0463
         CLC   NIPPARC(4,@10),@CF00036                          03S0463
         BNE   @RF00463                                         03S0463
*                                      /* SPECIFY.                   */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - NOLIST                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - NO VATLST WITH SPECIFIED SUFFIX FOUND IN      */
*/*                    SYS1.PARMLIB                                  */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     IF 'DEFAULT' SWITCH IS ON, THEN NO MESSAGE SHOULD BE ISSUED; */
*/*     SET 'READ' SWITCH TO NO IN ORDER TO FALL THROUGH AND EXIT.   */
*/*                                                                  */
*/*     IF 'DEFAULT' SWITCH IS NOT ON, THEN MOVE VATLST SUFFIX INTO  */
*/*     MESSAGE 'IEA861A-VAL=NN NOT FOUND.  REPLY U OR CORRECT       */
*/*     VALUE'.  ISSUE WTOR.  WAIT FOR REPLY.  IF REPLY IS EOB OR    */
*/*     'U', THEN SET 'READ' EQUAL TO NO IN ORDER TO IGNORE THIS     */
*/*     VATLST.  IF REPLY IS A VALUE AA, MOVE AA INTO NIPPANAM+6     */
*/*     AND SET 'READ' EQUAL TO YES SO THAT THIS VATLST WILL BE      */
*/*     READ.  IF REPLY IS INVALID, REISSUE WTOR.                    */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         ISSUE WTOR TO NOTIFY OPERATOR OF NOT-FOUND CONDITION     */
*/*         AND OBTAIN REPLY FOR FURTHER ACTION.                     */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         NIPPANAM+6 - CONTAINS VATLST SUFFIX                      */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - LIST NOT FOUND IS THE DEFAULT LIST               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         READ - SET TO OFF                                        */
*/*                                                                  */
*/*     CONDITION - LIST NOT FOUND WAS SPECIFIED                     */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA861A IS ISSUED                                */
*/*                                                                  */
*/*     CONDITION - REPLY TO IEA861A IS EOB OR 'U'                   */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         READ - SET TO OFF                                        */
*/*                                                                  */
*/*     CONDITION - REPLY TO IEA861A IS VALUE                        */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         NIPPANAM+6 - UPDATED TO A NEW VALUE                      */
*/*         READ - SET TO ON                                         */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               04S0465
*IF DEFAULT = YES                      /*IF LIST NOT FOUND IS DEFAULT
*                                        VATLST, THEN VOLUME ATTRIBUTE
*                                        PROCESSOR NOT DESIRED.      */
*  THEN READ = NO;                                              04S0465
         TM    DEFAULT,B'10000000'                              04S0465
         BNO   @RF00465                                         04S0465
         NI    READ,B'11011111'                                 04S0466
*  ELSE DO;                                                     04S0467
         B     @RC00465                                         04S0467
@RF00465 DS    0H                                               04S0468
*    NN861 = SUFFIX;                   /*OBTAIN VATLST NUMBER FOR MSG*/
         L     @10,NVTPAREA(,RNVT)                              04S0468
         MVC   NN861(2),SUFFIX(@10)                             04S0468
*    BADREPLY = YES;                                            04S0469
         OI    BADREPLY,B'10000000'                             04S0469
*    DO WHILE BADREPLY = YES;                                   04S0470
         B     @DE00470                                         04S0470
@DL00470 DS    0H                                               04S0471
*      BADREPLY = NO;                                           04S0471
         NI    BADREPLY,B'01111111'                             04S0471
*      WTORBUF = BLANK;                /*BLANK OUT REPLY AREA        */
         MVI   WTORBUF+1,C' '                                   04S0472
         MVC   WTORBUF+2(78),WTORBUF+1                          04S0472
         MVI   WTORBUF,C' '                                     04S0472
*      GEN REFS(NVTWTOR);              /*ISSUE WTOR FOR MSG IEA861A  */
*      IEA861A VAL=NN NOT FOUND. REPLY U OR CORRECT VALUE.
           IEAPMNIP TYPE=WTOR,PARAM=IEA861A
*      IF SCAN2 = REPLYU               /*CHECK FOR REPLY OF U OR EOB */
*        | SCAN2 = REPLYEOB                                     04S0474
*        THEN READ = NO;               /*NOTHING TO READ             */
         CLC   SCAN2(2),@CC00168                                04S0474
         BE    @RT00474                                         04S0474
         CLC   SCAN2(2),@CC00170                                04S0474
         BNE   @RF00474                                         04S0474
@RT00474 DS    0H                                               04S0475
         NI    READ,B'11011111'                                 04S0475
*        ELSE IF SCAN2A = QUOTE        /*REPLY IS TWO CHARACTERS     */
*          THEN DO;                                             04S0476
         B     @RC00474                                         04S0476
@RF00474 CLI   SCAN2A,C''''                                     04S0476
         BNE   @RF00476                                         04S0476
*            SUFFIX = SCAN2;           /*MOVE VATLST NUMBER INTO
*                                        READ AREA.                  */
         L     @10,NVTPAREA(,RNVT)                              04S0478
         MVC   SUFFIX(2,@10),SCAN2                              04S0478
*            READ = YES;               /*READ THIS VATLST            */
         OI    READ,B'00100000'                                 04S0479
*          END;                                                 04S0480
*          ELSE BADREPLY = YES;        /*REISSUE WTOR                */
         B     @RC00476                                         04S0481
@RF00476 OI    BADREPLY,B'10000000'                             04S0481
*    END;                                                       04S0482
@RC00476 DS    0H                                               04S0482
@RC00474 DS    0H                                               04S0482
@DE00470 TM    BADREPLY,B'10000000'                             04S0482
         BO    @DL00470                                         04S0482
*  END;                                                         04S0483
*                                      /* RETURN TO RDENTRY.         */
*      END;                                                     03S0484
*      ELSE DO;                        /* IF I/O ERROR, GET INSTRUCT-*/
         B     @RC00463                                         03S0485
@RF00463 DS    0H                                               03S0486
*                                      /* IONS FROM OPERATOR.        */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - RDERR                                             */
*/*                                                                  */
*/* DESCRIPTIVE NAME - I/O ERROR READING VATLST ENTRY                */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     MOVE VATLST SUFFIX INTO MESSAGE 'IEA949A-I/O ERROR READING   */
*/*     VATLSTNN.  REPLY YES FOR LIST OF ENTRIES THAT WILL BE        */
*/*     PROCESSED, OR U FOR NO LIST.  IF REPLY IS 'YES', THEN        */
*/*     EXECUTE SEGMENT THAT PUTS OUT INFORMATIONAL MESSAGE.  IF     */
*/*     REPLY IS NOT 'YES' OR 'U', REISSUE MESSAGE IEA949A.          */
*/*                                                                  */
*/*     ISSUE MESSAGE 'IEA853A-REPLY CONT, END, OR RESPECIFY'.       */
*/*     WAIT FOR REPLY.  IF REPLY IS CONT OR END, SET 'READ' EQUAL   */
*/*     TO NO, TO INDICATE NO MORE ENTRIES SHOULD BE READ FROM THE   */
*/*     CURRENT VATLST.                                              */
*/*                                                                  */
*/*     IF REPLY IS END, THEN SET 'PEND' EQUAL TO YES TO TERMINATE   */
*/*     VATLST PROCESSING.  IF REPLY IS CONT, THEN GO ON TO PROCESS  */
*/*     ANY OTHER VATLSTS.  IF REPLY IS A NEW LIST, MOVE NUMBER      */
*/*     INTO NIPPANAM+6 AND SET 'READ' EQUAL TO YES.  IF REPLY IS    */
*/*     INVALID, REISSUE MESSAGE IEA853A AND PROCESS AS ABOVE.       */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         ISSUE MESSAGE TO INFORM OPERATOR OF I/O ERROR AND        */
*/*         PROCESS REPLY.                                           */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         NIPPANAM+6 - CONTAINS VATLST SUFFIX                      */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA949A IS ISSUED                                */
*/*         MESSAGE IEA853A IS ISSUED                                */
*/*         READ - SET TO OFF IF REPLY TO IEA853A IS CONT OR END     */
*/*                SET TO ON IF REPLY IS A NEW LIST                  */
*/*         PEND - SET TO ON IF REPLY TO IEA853A IS END              */
*/*         NIPPANAM+6 - CONTAINS NEW LIST NUMBER FOR EXCP IF        */
*/*                      REPLY TO IEA853A IS A NEW LIST              */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               04S0486
*NN949 = SUFFIX;                       /*MOVE VATLST NUMBER  @YM00442*/
         L     @10,NVTPAREA(,RNVT)                              04S0486
         MVC   NN949(2),SUFFIX(@10)                             04S0486
*                                      /*INTO MSG            @YM00442*/
*GEN REFS(NVTWTO);                     /*ISSUE MSG IEA949I   @YM00442*/
*                                                               04S0487
* IEA949I I/O ERROR READING VATLSTXX.                        @YM00442*/
         IEAPMNIP TYPE=WTO,PARAM=IEA949I                     @YM00442*/
*IF MTLSTCT > 0                        /*MOUNT LIST CONTAINS @YM00442*/
*  THEN DO;                            /*SOME ENTRIES        @YM00442*/
         LH    @10,MTLSTCT                                      04S0488
         LTR   @10,@10                                          04S0488
         BNP   @RF00488                                         04S0488
*    BADREPLY = YES;                   /*INCORRECT FORMAT    @YM00442*/
         OI    BADREPLY,B'10000000'                             04S0490
*    DO WHILE (BADREPLY = YES);        /*                    @YM00442*/
         B     @DE00491                                         04S0491
@DL00491 DS    0H                                               04S0492
*      BADREPLY = NO;                  /*                    @YM00442*/
         NI    BADREPLY,B'01111111'                             04S0492
*      GEN REFS(NVTWTOR);              /*ISSUE MSG IEA949A   @YM00442*/
*                                                               04S0493
* IEA949A REPLY YES FOR LIST OF ENTRIES THAT WILL BE         @YM00442
* PROCESSED, OR U FOR NO LIST.                               @YM00442
         IEAPMNIP TYPE=WTOR,PARAM=IEA949A                    @YM00442
*      IF SCAN3 = COMPYES              /*CHECK FOR  'YES'    @YM00442*/
*        THEN DO;                      /*ISSUE INFO LIST     @YM00442*/
         CLC   SCAN3(3),@CC00136                                04S0494
         BNE   @RF00494                                         04S0494
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - INFOLIST                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - INFORMATIONAL LISTING OF VOLUMES TO BE        */
*/*                    PROCESSED                                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     ISSUE WTO FOR HEADER MESSAGE 'IEA850I-FOLLOWING WILL @YM00442*/
*/*     BE PROCESSED.                                        @YM00442*/
*/*                                                                  */
*/*     FOR EACH ENTRY IN LIST, FILL IN MESSAGE TEXT WITH    @YM00442*/
*/*     VOLUME SERIAL, DEVICE TYPE AND ATTRIBUTES.  ISSUE    @YM00442*/
*/*     WTO 'SER ON UUUUUUUU CCC-CCC'.                       @YM00442*/
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         LIST VOLUME ENTRIES IN MOUNT LIST BEFORE ERROR   @YM00442*/
*/*         OCCURRED.                                        @YM00442*/
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         MNTLIST - MOUNT LIST                             @YM00442*/
*/*         MTLSTCT - NUMBER OF ENTRIES IN MOUNT LIST        @YM00442*/
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA850I AND SECONDARY MESSAGES ISSUED            */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               05S0496
*GEN REFS(NVTWTO);                     /*ISSUE HEADER MESSAGE IEA850I*/
*                                                               05S0496
* IEA850I FOLLOWING WILL BE PROCESSED.                       @YM00442
         IEAPMNIP TYPE=WTO,PARAM=IEA850I
*DO I = ONE TO MTLSTCT;                /*LOOP THROUGH LIST   @YM00442*/
         LA    @10,1                                            05S0497
         B     @DE00497                                         05S0497
@DL00497 DS    0H                                               05S0498
*  MAPAD = ADDR(MNTLIST(I));           /*                    @YM00442*/
         MH    @10,@CH00190                                     05S0498
         LA    @10,MNTLIST-22(@10)                              05S0498
         ST    @10,MAPAD                                        05S0498
*  SER850 = EVOLSER;                   /*MOVE VOLSER INTO MSG@YM00442*/
         MVC   SER850(6),EVOLSER(@10)                           05S0499
*  DEV850 = EDEVTYPE;                  /*MOVE DEVICE TYPE    @YM00442*/
         MVC   DEV850(8),EDEVTYPE(@10)                          05S0500
*  IF EMNTCHAR = RSV                   /*DETERMINE MOUNT ATTR@YM00442*/
*    THEN MT850 = MSGRSV;              /*MOVE 'RSV' INTO MSG @YM00442*/
         CLI   EMNTCHAR(@10),C'1'                               05S0501
         BNE   @RF00501                                         05S0501
         MVC   MT850(3),@CC02472                                05S0502
*    ELSE MT850 = MSGPR;               /*OTHERWISE MOVE 'P/R'@YM00442*/
         B     @RC00501                                         05S0503
@RF00501 MVC   MT850(3),@CC02470                                05S0503
*  IF EUSEATTR = STR                   /*DETERMINE USE ATTR  @YM00442*/
*    THEN USE850 = MSGSTR;             /*MOVE 'STR' INTO MSG @YM00442*/
@RC00501 L     @10,MAPAD                                        05S0504
         CLI   EUSEATTR(@10),C'0'                               05S0504
         BNE   @RF00504                                         05S0504
         MVC   USE850(3),@CC02474                               05S0505
*    ELSE IF EUSEATTR = PRIV           /*                    @YM00442*/
*      THEN USE850 = MSGPRV;           /*MOVE 'PRV' INTO MSG @YM00442*/
         B     @RC00504                                         05S0506
@RF00504 L     @10,MAPAD                                        05S0506
         CLI   EUSEATTR(@10),C'2'                               05S0506
         BNE   @RF00506                                         05S0506
         MVC   USE850(3),@CC02476                               05S0507
*      ELSE USE850 = MSGPUB;           /*MOVE 'PUB' INTO MSG @YM00442*/
         B     @RC00506                                         05S0508
@RF00506 MVC   USE850(3),@CC02478                               05S0508
*      GEN REFS(NVTWTO);               /*WRITE A LINE OF MSG         */
@RC00506 DS    0H                                               05S0509
@RC00504 DS    0H                                               05S0509
*       SER ON UUUUUUUU CCC-CCC                              @YM00442
         IEAPMNIP TYPE=WTO,PARAM=IEA850I2
*END;                                  /*                    @YM00442*/
         LA    @10,1                                            05S0510
         AH    @10,I                                            05S0510
@DE00497 STH   @10,I                                            05S0510
         CH    @10,MTLSTCT                                      05S0510
         BNH   @DL00497                                         05S0510
*        END;                          /*                    @YM00442*/
*        ELSE IF SCAN2 ¬= REPLYU       /*BAD REPLY           @YM00442*/
*          & SCAN2 ¬= REPLYEOB                                  04S0512
*          THEN BADREPLY = YES;        /*NOT 'YES', 'U', EOB @YM00442*/
         B     @RC00494                                         04S0512
@RF00494 CLC   SCAN2(2),@CC00168                                04S0512
         BE    @RF00512                                         04S0512
         CLC   SCAN2(2),@CC00170                                04S0512
         BE    @RF00512                                         04S0512
         OI    BADREPLY,B'10000000'                             04S0513
*    END;                              /*                    @YM00442*/
@RF00512 DS    0H                                               04S0514
@RC00494 DS    0H                                               04S0514
@DE00491 TM    BADREPLY,B'10000000'                             04S0514
         BO    @DL00491                                         04S0514
*  END;                                /*                    @YM00442*/
*                                                               04S0515
*BADREPLY = YES;                       /*INCORRECT FORMAT IN REPLY   */
@RF00488 OI    BADREPLY,B'10000000'                             04S0516
*DO WHILE (BADREPLY = YES);                                     04S0517
         B     @DE00517                                         04S0517
@DL00517 DS    0H                                               04S0518
*BADREPLY = NO;                                                 04S0518
         NI    BADREPLY,B'01111111'                             04S0518
*WTORBUF = BLANK;                      /*BLANK OUT REPLY AREA        */
         MVI   WTORBUF+1,C' '                                   04S0519
         MVC   WTORBUF+2(78),WTORBUF+1                          04S0519
         MVI   WTORBUF,C' '                                     04S0519
*GEN REFS(NVTWTOR);                    /*ISSUE MESSSAGE IEA853A      */
*                                                               04S0520
* IEA853A REPLY CONT, END, OR RESPECIFY.
         IEAPMNIP TYPE=WTOR,PARAM=IEA853A /*                 @YM00442*/
*IF SCAN4 = COMPCONT                   /*CHECK FOR REPLY OF 'CONT'   */
*  THEN READ = NO;                     /*DON'T READ ANY MORE ENTRIES
*                                        FROM THIS VATLST            */
         CLC   SCAN4(4),@CC00134                                04S0521
         BNE   @RF00521                                         04S0521
         NI    READ,B'11011111'                                 04S0522
*  ELSE IF SCAN3 = COMPEND             /*CHECK FOR REPLY OF 'END'    */
*    THEN DO;                                                   04S0523
         B     @RC00521                                         04S0523
@RF00521 CLC   SCAN3(3),@CC00132                                04S0523
         BNE   @RF00523                                         04S0523
*      READ = NO;                      /*DON'T READ ANY MORE ENTRIES */
*      PEND = YES;                     /*DON'T READ ANY MORE VATLSTS */
         OI    PEND,B'01000000'                                 04S0526
         NI    READ,B'11011111'                                 04S0526
*    END;                                                       04S0527
*    ELSE IF SCAN2A = QUOTE            /*CHECK VALIDITY OF REPLY     */
*      THEN DO;                        /*GOOD REPLY                  */
         B     @RC00523                                         04S0528
@RF00523 CLI   SCAN2A,C''''                                     04S0528
         BNE   @RF00528                                         04S0528
*        SUFFIX = SCAN2;               /*MOVE REPLY TO READ AREA     */
         L     @10,NVTPAREA(,RNVT)                              04S0530
         MVC   SUFFIX(2,@10),SCAN2                              04S0530
*        READ = YES;                   /*READ THIS VATLST            */
         OI    READ,B'00100000'                                 04S0531
*      END;                                                     04S0532
*      ELSE DO;                        /*INCORRECT REPLY             */
         B     @RC00528                                         04S0533
@RF00528 DS    0H                                               04S0534
*        BADREPLY = YES;               /*REPEAT MESSAGE              */
         OI    BADREPLY,B'10000000'                             04S0534
*      END;                                                     04S0535
*END;                                  /*RETURN TO RDENTRY.          */
@RC00528 DS    0H                                               04S0536
@RC00523 DS    0H                                               04S0536
@RC00521 DS    0H                                               04S0536
@DE00517 TM    BADREPLY,B'10000000'                             04S0536
         BO    @DL00517                                         04S0536
*      END;                                                     03S0537
*                                      /* RETURN TO SYSPARMS.        */
*END;                                  /*RETURN TO TOP SEGMENT.      */
*                                                               02S0538
@RC00463 DS    0H                                               02S0538
@RC00461 DS    0H                                               02S0538
@RC00343 DS    0H                                               02S0538
@DE00340 TM    READ,B'00100000'                                 02S0538
         BO    @DL00340                                         02S0538
*END;                                                           01S0539
@DE00325 TM    PEND,B'01000000'                                 01S0539
         BZ    @DL00325                                         01S0539
*DPLOADED = YES;                       /* INIT DP SWITCH     @ZA14221*/
         OI    DPLOADED,B'01000000'                             01S0540
*DATAPATH = ZERO;                      /* POINTER TO DP RTN. @ZA14221*/
         SLR   @10,@10                                          01S0541
         ST    @10,DATAPATH                                     01S0541
*RFY (FINDPATH) RSTD;                  /*                    @ZA14221*/
*  DO;        /*LOAD EP(NIEEVDEV) ERRET(ERR) */                 01S0543
*  RESPECIFY (GPR00P,GPR01P,GPR15F) RESTRICTED;                 01S0544
*  GPR00P=ADDR(NIEEVDEV);   /*LOAD ENTRY POINT NAME ADDRESS*/   01S0545
         LA    GPR00P,NIEEVDEV                                  01S0545
*  GPR01P=0;     /*JOBLIB OR LINKLIB DCB*/                      01S0546
         SLR   GPR01P,GPR01P                                    01S0546
*  GPR01P=GPR01P|'80000000'X; /*ERROR RETURN LABEL SPECIFIED*/  01S0547
         O     GPR01P,@CF02508                                  01S0547
*  SVC   (8);  /*ISSUE LOAD SVC*/                               01S0548
         SVC   8                                                01S0548
*  IF GPR15F ¬= 0 THEN   /*LOAD WAS UNSUCCESSFUL*/              01S0549
         LTR   GPR15F,GPR15F                                    01S0549
         BNZ   @RT00549                                         01S0549
*    GOTO ERR;   /*BRANCH TO ERROR LOCATION*/                   01S0550
*  RESPECIFY (GPR00P,GPR01P,GPR15F) UNRESTRICTED;               01S0551
*  END;       /*LOAD EP(NIEEVDEV) ERRET(ERR) */       /* LOAD DATA PATH
*RTN.@ZA14221*/                                                 01S0552
*DATAPATH = FINDPATH;                  /* SAVE IN CORE ADDR. @ZA14221*/
         ST    FINDPATH,DATAPATH                                01S0553
*RFY (FINDPATH) UNRSTD;                /*                    @ZA14221*/
*ERR:IF DATAPATH = ZERO                /* WAS VDEV LOADED?   @ZA14221*/
*      THEN DPLOADED = NO;             /* NO SET SWITCH OFF  @ZA14221*/
ERR      L     @10,DATAPATH                                     01S0555
         LTR   @10,@10                                          01S0555
         BNZ   @RF00555                                         01S0555
         NI    DPLOADED,B'10111111'                             01S0556
*DO;                                   /* PROC. VALID ENT.   @ZA14221*/
@RF00555 DS    0H                                               01S0558
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - LISTPROC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - PROCESS COMPILED VATLST ENTRIES               */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     FOR EACH ENTRY IN THE LIST, EXECUTE THE SEGMENT 'FINDVOL' TO */
*/*     DETERMINE IF A VOLUME IS MOUNTED WITH THAT VOLSER. IF IT IS, */
*/*     AND IF THE ENTRY IS REAL AND THE DEVICE TYPES MATCH, @Y30LPPD*/
*/*     OR THE ENTRY IS VIRTUAL AND THE VUA'S MATCH, THEN    @Y30LPPD*/
*/*     CALL ROUTINE 'SETSTAT' AND REMOVE THE ENTRY FROM     @Y30LPPD*/
*/*     THE LIST. IF THE DEVTYPES OR VUA'S DON'T MATCH, GO TO@Y30LPPD*/
*/*     SEGMENT 'WRONGVOL' TO PUT OUT ERROR MESSAGES.        @Y30LPPD*/
*/*                                                                  */
*/*     IF THE VOLUME IS NOT MOUNTED AND THE ENTRY SPECIFIES @Y30LPPD*/
*/*     AN MSS VOLUME, EXECUTE THE SEGMENT VIRTMONT TO MOUNT @Y30LPPD*/
*/*     IT. IF THE ENTRY IS NOT FOR AN MSS VOLUME AND IF     @Y30LPPD*/
*/*     THE MOUNT PRIORITY INDICATES THAT THE MOUNT MESSAGE IS TO BE */
*/*     SUPPRESSED, REMOVE THE ENTRY FROM THE LIST. OTHERWISE,       */
*/*     INCREASE THE DEVICE TYPE COUNT FOR THIS ENTRY'S DEVICE TYPE. */
*/*                                                                  */
*/* OPERATION -                                              @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     ENTRIES ARE REMOVED FROM THE MOUNTLIST BY COVERING   @Y30LPPD*/
*/*     THE CURRENT ENTRY WITH THE LAST ENTRY. THEN THE      @Y30LPPD*/
*/*     NUMBER OF ENTRIES IS DECREASED.                      @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         MNTLIST - COMPOSITE LIST OF VATLST ENTRIES               */
*/*         MTLSTCT - NUMBER OF ENTRIES IN MNTLIST                   */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MNTLIST - CONTAINS ONLY NON-MOUNTED VOLUME ENTRIES       */
*/*                                                                  */
*/*     CONDITION - INCONSISTENT DEVICE TYPE ON P/R VOLUME           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*         MESSAGE IEA866I                                          */
*/*         MESSAGE IEA947A                                          */
*/*         MNTLIST - MODIFIED                                       */
*/*         MTLSTCT - MODIFIED                                       */
*/*                                                                  */
*/*     CONDITION - INCONSISTENT DEVICE TYPE ON NON-P/R VOLUME       */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA866I                                          */
*/*         MESSAGE IEA948I                                          */
*/*                                                                  */
*/*     CONDITION - INCONSISTENT VUA FOR VIRTUAL VOLUME,     @Y30LPPD*/
*/*                 DEMOUNT FAILS.                           @Y30LPPD*/
*/*                                                                  */
*/*     OUTPUT DATA -                                        @Y30LPPD*/
*/*         MESSAGE IEA985I                                  @Y30LPPD*/
*/*         MESSAGE IEA866I                                  @Y30LPPD*/
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0558
*I = ONE;                                                       02S0558
*                                                               02S0558
         MVC   I(2),@CH00042                                    02S0558
*DO WHILE (I <= MTLSTCT);              /*SCAN LIST & PROCESS ENTRIES */
*                                                               02S0559
         B     @DE00559                                         02S0559
@DL00559 DS    0H                                               02S0560
*  MAPAD = ADDR(MNTLIST(I));           /*ADDRESS ENTRY MAPPING       */
         LH    @10,I                                            02S0560
         MH    @10,@CH00190                                     02S0560
         LA    @10,MNTLIST-22(@10)                              02S0560
         ST    @10,MAPAD                                        02S0560
*  DO;                                 /*LOCATE UCB WITH THIS VOLSER */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - FINDVOL                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - FIND THE UCB CONTAINING THE VOLUME SERIAL     */
*/*                    NUMBER                                        */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     FILL IN 'NMNTVS' (IN NIP MOUNT PARAMETER AREA) WITH THE      */
*/*     VOLUME SERIAL NUMBER OBTAINED FROM THE CURRENT VATLST ENTRY. */
*/*     ISSUE MACRO (IEAPMNIP TYPE=MOUNT, PARAM=LABEL,OPT=(,,,US))   */
*/*     TO OBTAIN UCB ADDRESS.  UCBPTR WILL CONTAIN THE UCB ADDRESS. */
*/*     (IF NOT FOUND, UCBPTR WILL BE ZERO.)                         */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         TO OBTAIN THE ADDRESS OF THE UCB CONTAINING THE VOLUME   */
*/*         SERIAL NUMBER IN THE CURRENT VATLST ENTRY.               */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         CURRENT VATLST ENTRY                                     */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCBPTR - CONTAINS UCB ADDRESS OR ZERO                    */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0562
*GEN DATA DEFS(NIPMNT);                                         03S0562
*RFY NIPMNTPL BASED(ADDR(NIPMNT));                              03S0563
*NMNTVS = EVOLSER;                     /*MOVE VOL SER INTO PARAMETER
*                                        LIST FOR UCB FIND           */
         LA    @10,NIPMNT                                       03S0564
         L     @05,MAPAD                                        03S0564
         MVC   NMNTVS(6,@10),EVOLSER(@05)                       03S0564
*RFY RPARM RSTD;                                                03S0565
*GEN REFS(NVTMOUNT);                   /*FIND UCB W/GIVEN VOL SERIAL */
         IEAPMNIP TYPE=MOUNT,PARAM=NIPMNT,OPT=(,,,US)
*UCBPTR = RPARM;                       /*SAVE UCB ADDRESS            */
         ST    RPARM,UCBPTR                                     03S0567
*RFY RPARM UNRSTD;                                              03S0568
*                                      /* RETURN TO LISTPROC.        */
*  END;                                                         02S0569
*  J = DEVENT(I);                      /*OBTAIN UNIT TYPE INDEX      */
         LH    @10,I                                            02S0570
         MH    @10,@CH00190                                     02S0570
         SLR   @05,@05                                          02S0570
         IC    @05,DEVENT-22(@10)                               02S0570
         STH   @05,J                                            02S0570
*  IF UCBPTR ¬= ZERO                   /*VOLUME IS MOUNTED           */
*    THEN IF ((J <= NUMSUPTD) &        /*IS ENTRY FOR REAL & @Y30LPPD*/
         L     @10,UCBPTR                                       02S0571
         LTR   @10,@10                                          02S0571
         BZ    @RF00571                                         02S0571
*            (UCBRVDEV = OFF) &        /*UCB FOR REAL &      @Y30LPPD*/
*            (UCBTYPE(J) = UCBTBYT4)) | /*DEVICE TYPES MATCH?@Y30LPPD*/
*            ((J > NUMSUPTD) &         /*OR IS DEVICE VIRTUAL@Y30LPPD*/
*            (EDEVTYPE(2:4) = UCBNAME)) /*AND VUA'S MATCH?   @Y30LPPD*/
*      THEN DO;                        /*YES-                @Y30LPPD*/
         CH    @05,@CH00084                                     02S0572
         BH    @GL00009                                         02S0572
         TM    UCBRVDEV(@10),B'00001000'                        02S0572
         BNZ   @GL00009                                         02S0572
         MH    @05,@CH01793                                     02S0572
         SLR   @15,@15                                          02S0572
         IC    @15,UCBTYPE-14(@05)                              02S0572
         MVC   @ZT00003+3(1),UCBTBYT4(@10)                      02S0572
         C     @15,@ZT00003                                     02S0572
         BE    @RT00572                                         02S0572
@GL00009 LH    @10,J                                            02S0572
         CH    @10,@CH00084                                     02S0572
         BNH   @RF00572                                         02S0572
         L     @10,MAPAD                                        02S0572
         L     @05,UCBPTR                                       02S0572
         CLC   EDEVTYPE+1(3,@10),UCBNAME(@05)                   02S0572
         BNE   @RF00572                                         02S0572
@RT00572 DS    0H                                               02S0573
*        CALL SETSTAT;                 /*SET VOL ATTRIBUTES  @Y30LPPD*/
         BAL   @14,SETSTAT                                      02S0574
*        MNTLIST(I) =MNTLIST(MTLSTCT); /*REMOVE ENTRY FROM LIST      */
         LA    @10,22                                           02S0575
         LR    @05,@10                                          02S0575
         MH    @05,I                                            02S0575
         LA    @01,MNTLIST-22(@05)                              02S0575
         LH    @05,MTLSTCT                                      02S0575
         LR    @07,@10                                          02S0575
         MR    @06,@05                                          02S0575
         LA    @10,MNTLIST-22(@07)                              02S0575
         MVC   @TS00001(22),0(@10)                              02S0575
         MVC   0(22,@01),@TS00001                               02S0575
*        MTLSTCT = MTLSTCT - ONE;      /*DECREMENT LIST COUNT        */
         BCTR  @05,0                                            02S0576
         STH   @05,MTLSTCT                                      02S0576
*      END;                                                     02S0577
*      ELSE DO;                        /*DEVTYPES DON'T MATCH@Y30LPPD*/
         B     @RC00572                                         02S0578
@RF00572 DS    0H                                               02S0579
*/***********************************************************@Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* SEGMENT NAME - WRONGVOL                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* DESCRIPTIVE NAME - HANDLE ERROR OF VOLUME MOUNTED        @Y30LPPD*/
*/*                    ON WRONG DEVICE TYPE                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* FUNCTION -                                               @Y30LPPD*/
*/*     ISSUE MESSAGE 'IEA866I VOLUME AAAAAA ON DDD REQUIRED @Y30LPPD*/
*/*     ON A UUUUUUUU.'                                      @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     IF THE MOUNT LIST ENTRY IS FOR A VIRTUAL VOLUME,     @Y30LPPD*/
*/*     ISSUE A DEMOUNT FOR THE VOLUME. IF THE DEMOUNT FAILS,@Y30LPPD*/
*/*     ISSUE MESSAGE 'IEA985I UNABLE TO UNLOAD MSS VOLUME   @Y30LPPD*/
*/*     AAAAAA FROM DDD - RC=RET.'                           @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     IF THE VOLUME IS P/R, REMOVE THE ENTRY FROM THE      @Y30LPPD*/
*/*     LIST AND ISSUE MESSAGE 'IEA947A REPLY U TO           @Y30LPPD*/
*/*     CONTINUE OR RE-IPL.' IF THE OPERATOR REPLIES 'U'     @Y30LPPD*/
*/*     VAP WILL CONTINUE PROCESSING WITHOUT THE ENTRY. IF   @Y30LPPD*/
*/*     THE VOLUME IS NOT P/R AND THE DEMOUNT, IF DONE, WAS  @Y30LPPD*/
*/*     SUCCESSFUL, UNLOAD THE VOLUME AND ISSUE MESSAGE      @Y30LPPD*/
*/*     'IEA948I DDD NOW UNLOADED.'. IF DEMOUNT NOT SUCCESS- @Y30LPPD*/
*/*     FUL, THE VOLUME IS NOT UNLOADED.                     @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* ENTRY - IN-LINE SEGMENT                                  @Y30LPPD*/
*/*     PURPOSE - SEE FUNCTION                               @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     INPUT DATA -                                         @Y30LPPD*/
*/*         MOUNT LIST ENTRY                                 @Y30LPPD*/
*/*         UCB ADDRESS                                      @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* EXITS -                                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*    CONDITION - NORMAL, VOLUME IS NOT P/R                 @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*    OUTPUT DATA -                                         @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*        MESSAGE IEA866I                                   @Y30LPPD*/
*/*        MESSAGE IEA948I                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*    CONDITION - DEMOUNT FAILS FOR VIRTUAL VOLUME          @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*    OUTPUT DATA -                                         @Y30LPPD*/
*/*        MESSAGE IEA866I                                   @Y30LPPD*/
*/*        MESSAGE IEA985I                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*    CONDITION - VOLUME IS P/R                             @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*    OUTPUT DATA -                                         @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*        MESSAGE IEA866I                                   @Y30LPPD*/
*/*        MESSAGE IEA947A                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*    RETURN CODE - NONE                                    @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/********************************************************** @Y30LPPD*/
*MSGSW = OFF;                          /*INIT FAILURE SWITCH @Y30LPPD*/
         NI    MSGSW,B'01111111'                                03S0579
*SER866 = MVOLSER(I);                  /*MOVE VOLSER INTO MSG        */
         LH    @10,I                                            03S0580
         MH    @10,@CH00190                                     03S0580
         LA    @05,MVOLSER-22(@10)                              03S0580
         MVC   SER866(6),0(@05)                                 03S0580
*DEV866 = UCBNAME;                     /*MOVE UNIT ADDR TO MSG       */
         L     @05,UCBPTR                                       03S0581
         MVC   DEV866(3),UCBNAME(@05)                           03S0581
*DT866 = MDEVTYPE(I);                  /*MOVE DEVTYPE TO MSG @Y30LPPD*/
         LA    @01,MDEVTYPE-22(@10)                             03S0582
         MVC   DT866(8),0(@01)                                  03S0582
*IF UCBRVDEV = ON &                    /*3330V DEVICE?       @Y30LPPD*/
*   UCBTYP(3:4) = COMP3330                                      03S0583
*  THEN V866 = VIRT;                   /*YES - MOVE IN V     @Y30LPPD*/
         TM    UCBRVDEV(@05),B'00001000'                        03S0583
         BNO   @RF00583                                         03S0583
         CLC   UCBTYP+2(2,@05),@CB00140                         03S0583
         BNE   @RF00583                                         03S0583
         MVI   V866,C'V'                                        03S0584
*  ELSE V866 = BLANK;                  /*NO - MOVE IN BLANK  @Y30LPPD*/
         B     @RC00583                                         03S0585
@RF00583 MVI   V866,C' '                                        03S0585
*GEN REFS(NVTWTO)                                               03S0586
*(IEAPMNIP TYPE=WTO,PARAM=IEA866I);    /*ISSUE MESSAGE               */
@RC00583 DS    0H                                               03S0586
         IEAPMNIP TYPE=WTO,PARAM=IEA866I
*/* IEA866I VOLUME AAAAAA  ON DDD REQUIRED ON A UUUUUUU.             */
*IF UCBRVDEV = ON &                    /*3330V DEVICE?       @Y30LPPD*/
*  UCBTYP(3:4) = COMP3330              /*                    @Y30LPPD*/
*  THEN DO;                            /*YES -               @Y30LPPD*/
*                                                               03S0587
         L     @10,UCBPTR                                       03S0587
         TM    UCBRVDEV(@10),B'00001000'                        03S0587
         BNO   @RF00587                                         03S0587
         CLC   UCBTYP+2(2,@10),@CB00140                         03S0587
         BNE   @RF00587                                         03S0587
*     DCL MDREG1 REG(1) PTR; /*ADDRESS OF REQUEST BLOCK @Y30LB02*/
*     /********************************************************* @Y30LB
*2*/                                                            03S0590
*     /*MACMEAN  MSSC DEMOUNT MACRO                              @Y30LB
*2*/                                                            03S0590
*     /*VS1-4/VS2-3 VERSION--01/19/76 LEVEL 00                   @ZDR20
*8*/                                                            03S0590
*     /*THIS IS THE STANDARD FORM - DEMOUNT MACRO                @Y30LB
*2*/                                                            03S0590
*     /********************************************************* @Y30LB
*2*/                                                            03S0590
*     RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/              03S0590
*     MDREG1=ADDR(DMLEN);/*R1 PTR TO LIST @Y30LB02*/            03S0591
         LA    MDREG1,DMLEN                                     03S0591
*     DCL 1 ICBDMLST  STATIC LOCAL, /*DEMOUNT REQUEST BLOCK @Y30LB02*/
*         2 DMLEN  FIXED(31)INIT('1C'X),/*LENGTH OF DEMOUNT BLOCK @Y30L
*02*/                                                           03S0592
*         2 DMOPCD FIXED(8)INIT('06'X),/*DEMOUNT OPCODE @Y30LB02*/
*         2  DMNTRES1  CHAR(1)INIT('00'X),/*INIT RESERVED AREA TO ZERO
*YM02186*/                                                      03S0592
*         2  DMNTFLAG BIT(16)INIT('0000000000000000'B), /*FLAGS AREA @Y
*02186*/                                                        03S0592
*         3  DMBITRE1 BIT(1), /*ONE RESERVED BIT @YM02186*/     03S0592
*         3  DMDELRSP BIT(1), /*DEMOUNT DELAYED RESPONSE ATTRIBUTE @Y30
*B02*/                                                          03S0592
*         3  DMVUAVAL BIT(1), /*DEMOUNT VUA VALID ATTRIBUTE @ZDR2048*/
*         3  DMBITRES BIT(13), /*THIRTEEN RESERVED BITS @ZDR2048*/
*         2  DMVOL CHAR(6) INIT(''B), /*INIT VOLID TO ZERO @Y30LB02*/
*         2  DMNTASID  CHAR(2)INIT(''B),/*INIT ASID AREA TO ZERO @Y30LB
*2*/                                                            03S0592
*         2  DMNTECB  FIXED(31)INIT(0), /*DEMOUNT EVENT CONTROL BLOCK @
*30LB02*/                                                       03S0592
*         2  DMHOST CHAR(5) INIT(''B),/*INIT HOSTID AREA  @Y30LB02*/
*         2  DMNTRES2  CHAR(1)INIT(''B),/*INIT RESERVED AREA TO ZERO @Z
*R2048*/                                                        03S0592
*         2  DMNTVUA   FIXED(15)INIT(0); /*VIRTUAL UNIT ADDRESS @ZDR204
**/                                                             03S0592
*     DMVOL=(UCBVOLI); /*VALUE OF VOLID @Y30LB02*/              03S0593
         MVC   DMVOL(6),UCBVOLI(@10)                            03S0593
*     DMNTVUA=(UCBCHAN); /*FILL VALUE OF VUA @ZDR2048*/         03S0594
         MVC   DMNTVUA(2),UCBCHAN(@10)                          03S0594
*     DMVUAVAL='1'B;/* OR ON THE VUA VALID ATTRIBUTE FLAG @ZDR2048*/
         OI    DMVUAVAL,B'00100000'                             03S0595
*     SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/               03S0596
         SVC   126                                              03S0596
*     RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /* VUA FOR DEMOUNT
* @G24LPSJ*/                                                    03S0597
*    RFY (RCODE,REG0) RSTD;;           /*                    @Y30LPPD*/
*    IF RCODE ¬= ZERO                  /*WAS DEMOUNT SUCCESS @Y30LPPD*/
*      THEN DO;                        /*NO- ISSUE MESSAGE   @Y30LPPD*/
         LTR   RCODE,RCODE                                      03S0600
         BZ    @RF00600                                         03S0600
*        MSGSW = ON;                   /*INDICATE FAILURE    @Y30LPPD*/
         OI    MSGSW,B'10000000'                                03S0602
*        RSNCDE = REG0;                /*MOVE REASON CODE    @Y30LPPD*/
         ST    REG0,RSNCDE                                      03S0603
*        RFY (RCODE,REG0) UNRSTD;      /*                    @Y30LPPD*/
*        UNPK (UNPKAR,RSNAREA(3:5));   /*UNPK REASON CODE    @Y30LPPD*/
         UNPK  UNPKAR(5),RSNAREA+2(3)                           03S0605
*        TR (UNPKAR(1:4),TRANSTAB);    /*TRANSLATE CODE      @Y30LPPD*/
         LA    @10,TRPATN                                       03S0606
         AL    @10,@CF02677                                     03S0606
         TR    UNPKAR(4),TRANSTAB(@10)                          03S0606
*        VOL985 = UCBVOLI;             /*PUT VOLSER IN MSG   @Y30LPPD*/
         L     @10,UCBPTR                                       03S0607
         MVC   VOL985(6),UCBVOLI(@10)                           03S0607
*        DEV985 = UCBNAME;             /*PUT VUA IN MSG      @Y30LPPD*/
         MVC   DEV985(3),UCBNAME(@10)                           03S0608
*        RET985 = UNPKAR(2:4);         /*INSERT REASON CODE  @Y30LPPD*/
         MVC   RET985(3),UNPKAR+1                               03S0609
*        GEN REFS(NVTWTO)                                       03S0610
*        (IEAPMNIP TYPE=WTO,PARAM=IEA985I); /*ISSUE IEA985I  @Y30LPPD*/
         IEAPMNIP TYPE=WTO,PARAM=IEA985I
*        /*IEA985I UNABLE TO UNLOAD VIRTUAL VOLUME AAAAAA    @Y30LPPD*/
*        /*FROM VXXX - RC=RET                                @Y30LPPD*/
*        MNTLIST(I) = MNTLIST(MTLSTCT);/*REMOVE MNTLIST ENTRY@Y30LPPD*/
         LA    @10,22                                           03S0611
         LR    @05,@10                                          03S0611
         MH    @05,I                                            03S0611
         LA    @01,MNTLIST-22(@05)                              03S0611
         LH    @05,MTLSTCT                                      03S0611
         LR    @07,@10                                          03S0611
         MR    @06,@05                                          03S0611
         LA    @10,MNTLIST-22(@07)                              03S0611
         MVC   @TS00001(22),0(@10)                              03S0611
         MVC   0(22,@01),@TS00001                               03S0611
*        MTLSTCT = MTLSTCT - ONE;      /*DECREASE LIST COUNT @Y30LPPD*/
         BCTR  @05,0                                            03S0612
         STH   @05,MTLSTCT                                      03S0612
*      END;                            /*                    @Y30LPPD*/
*  END;                                /*                    @Y30LPPD*/
@RF00600 DS    0H                                               03S0615
*IF UCBPRES = YES                      /*IF  P/R VOLUME              */
*  THEN DO;                            /*                            */
@RF00587 L     @10,UCBPTR                                       03S0615
         TM    UCBPRES(@10),B'00000100'                         03S0615
         BNO   @RF00615                                         03S0615
*    LOOPSW = NO;                      /*INIT LOOP CONTROL           */
         NI    LOOPSW,B'11101111'                               03S0617
*    MNTLIST(I) =MNTLIST(MTLSTCT);     /*REMOVE ENT FROM LIST        */
         LA    @10,22                                           03S0618
         LR    @05,@10                                          03S0618
         MH    @05,I                                            03S0618
         LA    @01,MNTLIST-22(@05)                              03S0618
         LH    @05,MTLSTCT                                      03S0618
         LR    @07,@10                                          03S0618
         MR    @06,@05                                          03S0618
         LA    @10,MNTLIST-22(@07)                              03S0618
         MVC   @TS00001(22),0(@10)                              03S0618
         MVC   0(22,@01),@TS00001                               03S0618
*    MTLSTCT = MTLSTCT - ONE;          /*DECREMENT LIST COUNT        */
         BCTR  @05,0                                            03S0619
         STH   @05,MTLSTCT                                      03S0619
*    DO WHILE (LOOPSW = NO);                                    03S0620
         B     @DE00620                                         03S0620
@DL00620 DS    0H                                               03S0621
*      GEN REFS(NVTWTOR)               /*ISSUE MESSAGE               */
*      (IEAPMNIP TYPE=WTOR,PARAM=IEA947A);                      03S0621
         IEAPMNIP TYPE=WTOR,PARAM=IEA947A
*      /* IEA947A REPLY U TO CONTINUE OR RE-IPL.                     */
*      IF SCAN2 = REPLYU               /*CHK FOR VALID REPLY         */
*         | SCAN2 = REPLYEOB           /*OF U OR EOB                 */
*        THEN LOOPSW = YES;            /*VALID REPLY RECEIVED        */
         CLC   SCAN2(2),@CC00168                                03S0622
         BE    @RT00622                                         03S0622
         CLC   SCAN2(2),@CC00170                                03S0622
         BNE   @RF00622                                         03S0622
@RT00622 DS    0H                                               03S0623
         OI    LOOPSW,B'00010000'                               03S0623
*    END;                                                       03S0624
@RF00622 DS    0H                                               03S0624
@DE00620 TM    LOOPSW,B'00010000'                               03S0624
         BZ    @DL00620                                         03S0624
*  END;                                                         03S0625
*  ELSE IF MSGSW = OFF                 /*IF NOT SYSTEM P/R VOLUME, AND
*                                      DEMOUNT OK OR NOT DONE@Y30LPPD*/
*    THEN DO;                          /*                    @Y30LPPD*/
         B     @RC00615                                         03S0626
@RF00615 TM    MSGSW,B'10000000'                                03S0626
         BNZ   @RF00626                                         03S0626
*      UCBVOLI = ZEROVOLI;             /*ZERO THE VOLSER             */
         L     @10,UCBPTR                                       03S0628
         MVC   UCBVOLI(6,@10),ZEROVOLI                          03S0628
*      UCBVTOC = ZEROVTOC;             /*ZERO VTOC TTR               */
         MVC   UCBVTOC(4,@10),ZEROVTOC                          03S0629
*      UCBNOTRD = YES;                 /*UNLOAD THE VOLUME           */
         OI    UCBNOTRD(@10),B'01000000'                        03S0630
*      IF UCBRVDEV = ON &              /*3330V DEVICE?       @Y30LPPD*/
*         UCBTYP(3:4) = COMP3330       /*                    @Y30LPPD*/
*        THEN V948 = VIRT;             /*YES - MOVE IN V     @Y30LPPD*/
         TM    UCBRVDEV(@10),B'00001000'                        03S0631
         BNO   @RF00631                                         03S0631
         CLC   UCBTYP+2(2,@10),@CB00140                         03S0631
         BNE   @RF00631                                         03S0631
         MVI   V948,C'V'                                        03S0632
*        ELSE V948 = BLANK;            /*NO - MOVE IN BLANK  @Y30LPPD*/
         B     @RC00631                                         03S0633
@RF00631 MVI   V948,C' '                                        03S0633
*      DEV948 = UCBNAME;               /*MOVE DEVICE ADDR            */
@RC00631 L     @10,UCBPTR                                       03S0634
         MVC   DEV948(3),UCBNAME(@10)                           03S0634
*      GEN REFS(NVTWTO)                /*ISSUE MESSAGE               */
*      (IEAPMNIP TYPE=WTO,PARAM=IEA948I);                       03S0635
         IEAPMNIP TYPE=WTO,PARAM=IEA948I
*      /* IEA948I VXXX NOW UNLOADED.                         @Y30LPPD*/
*    END;                                                       03S0636
*    ELSE;                             /*VOL NOT UNLOADED    @Y30LPPD*/
@RF00626 DS    0H                                               03S0638
*      END;                            /*                    @Y30LPPD*/
*    ELSE IF J > NUMSUPTD              /*UNMOUNTED MSS VOL?  @Y30LPPD*/
*      THEN DO;                        /*YES -               @Y30LPPD*/
         B     @RC00571                                         02S0639
@RF00571 LH    @10,J                                            02S0639
         CH    @10,@CH00084                                     02S0639
         BNH   @RF00639                                         02S0639
*/***********************************************************@Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* SEGMENT NAME - VIRTMONT                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* DESCRIPTIVE NAME - MOUNT MSS VOLUMES                     @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* FUNCTION -                                               @Y30LPPD*/
*/*     LOCATE THE UCB SPECIFIED IN THE MOUNT LIST ENTRY. IF @Y30LPPD*/
*/*     THERE IS A VOLUME ALREADY MOUNTED ON THE DEVICE,     @Y30LPPD*/
*/*     ISSUE THE DEMOUNT MACRO FOR THE DEVICE.  IF THE DE-  @Y30LPPD*/
*/*     MOUNT FAILS, ISSUE MESSAGE 'IEA986I MSS VOLUME AAAAAA@Y30LPPD*/
*/*     REQUIRED ON VXXX. IEA985I UNABLE TO UNLOAD MSS       @Y30LPPD*/
*/*     VOLUME BBBBBB FROM VXXX - RC=RET.'                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     IF THERE IS NO VOLUME ALREADY MOUNTED ON THE DEVICE, @Y30LPPD*/
*/*     OR IF THE DEMOUNT WAS SUCCESSFUL, THEN ISSUE THE     @Y30LPPD*/
*/*     MOUNT MACRO FOR THE VOLUME AND VUA SPECIFIED IN THE  @Y30LPPD*/
*/*     ENTRY. IF THE MOUNT FAILS, THEN ISSUE MESSAGE        @Y30LPPD*/
*/*     'IEA987I UNABLE TO MOUNT MSS VOLUME AAAAAA ON VXXX - @Y30LPPD*/
*/*     RC=RET.'  IF NO PATHS ARE AVAILABLE TO THE DEVICE    @ZA14221*/
*/*     OR IF THE DEVICE IS NOT OPERATIONAL THEN ISSUE       @ZA14221*/
*/*     MESSAGE 'IEA409I UNABLE TO MOUNT MSS VOLUME          @ZA14221*/
*/*     AAAAAA ON VXXX, DEVICE NOT ACCESSIBLE'. IF THE MOUNT @ZA14221*/
*/*     WAS SUCCESSFUL, THEN GO TO SEGMENT VIRTREAD TO       @ZA14221*/
*/*     READ THE VOLUME LABEL TO VERIFY THE VOLSER AND       @ZA14221*/
*/*     OBTAIN THE VTOC TTR.                                 @ZA14221*/
*/*                                                          @Y30LPPD*/
*/*     REMOVE THE PROCESSED ENTRY FROM THE MOUNT LIST.      @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* ENTRY - IN-LINE SEGMENT                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     PURPOSE - SEE FUNCTION                               @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     INPUT DATA -                                         @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*         MOUNT LIST ENTRY                                 @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* EXITS -                                                  @Y30LPPD*/
*/*     CONDITION - NORMAL - NO ERRORS MOUNTING VOLUME       @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     OUTPUT DATA -                                        @Y30LPPD*/
*/*         MNTLIST - MSS VOLUME ENTRY REMOVED               @Y30LPPD*/
*/*         UCB - MODIFIED                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     CONDITION - UNABLE TO DEMOUNT ALREADY MOUNTED        @Y30LPPD*/
*/*                 MSS VOLUME.                              @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     OUTPUT DATA -                                        @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*         MNTLIST - MSS VOLUME ENTRY REMOVED               @Y30LPPD*/
*/*         MESSAGE IEA986I                                  @Y30LPPD*/
*/*         MESSAGE IEA985I                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     CONDITION - UNABLE TO MOUNT MSS VOLUME               @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     OUTPUT DATA -                                        @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*         MNTLIST - MSS VOLUME ENTRY REMOVED               @Y30LPPD*/
*/*         MESSAGE IEA987I                                  @Y30LPPD*/
*/*         MESSAGE IEA409I                                  @ZA14221*/
*/*                                                          @Y30LPPD*/
*/*     RETURN CODE - NONE                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/***********************************************************@Y30LPPD*/
*FAILSW = OFF;                         /*INIT DEMOUNT FAIL SW@Y30LPPD*/
         NI    FAILSW,B'10111111'                               03S0641
*MSSVOL = MVOLSER(I);                  /*SAVE VOLSER         @Y30LPPD*/
         LH    @10,I                                            03S0642
         MH    @10,@CH00190                                     03S0642
         LA    @05,MVOLSER-22(@10)                              03S0642
         MVC   MSSVOL(6),0(@05)                                 03S0642
*FINDDEV = MDEVTYPE(I,2:4);            /*MOVE VUA TO PARM    @Y30LPPD*/
         LA    @05,MDEVTYPE-21(@10)                             03S0643
         MVC   FINDDEV(3),0(@05)                                03S0643
*RFY RPARM RSTD;                       /*                    @Y30LPPD*/
*RPARM = FINDADDR;                     /*SET UP PARM         @Y30LPPD*/
         L     RPARM,FINDADDR                                   03S0645
*GEN REFS(NVTUCBFN)                    /*                    @Y30LPPD*/
* (IEAPMNIP TYPE=UCBFN,PARAM=RPARM);   /*                    @Y30LPPD*/
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM
*UCBPTR = RPARM;                       /*POINT TO UCB        @Y30LPPD*/
         ST    RPARM,UCBPTR                                     03S0647
*RFY RPARM UNRSTD;                     /*                    @Y30LPPD*/
*                                                               03S0648
*IF UCBVOLI ¬= ZEROVOLI                /*IS THERE A VOLUME ALREADY
*                                        MOUNTED ON THAT DEV?@Y30LPPD*/
*  THEN DO;                            /*YES -               @Y30LPPD*/
*                                                               03S0649
         L     @10,UCBPTR                                       03S0649
         CLC   UCBVOLI(6,@10),ZEROVOLI                          03S0649
         BE    @RF00649                                         03S0649
*     /********************************************************* @Y30LB
*2*/                                                            03S0651
*     /*MACMEAN  MSSC DEMOUNT MACRO                              @Y30LB
*2*/                                                            03S0651
*     /*VS1-4/VS2-3 VERSION--01/19/76 LEVEL 00                   @ZDR20
*8*/                                                            03S0651
*     /*THIS IS THE OUTPUT FOR A SECONDARY                       @Y30LB
*2*/                                                            03S0651
*     /*INVOCATION OF THE STANDARD FORM MACRO                    @Y30LB
*2*/                                                            03S0651
*     /********************************************************* @Y30LB
*2*/                                                            03S0651
*     RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/              03S0651
*     MDREG1=ADDR(DMLEN);/*PTR TO REQ BLK @Y30LB02*/            03S0652
         LA    MDREG1,DMLEN                                     03S0652
*     DMVOL=(UCBVOLI); /*VALUE OF VOLID @Y30LB02*/              03S0653
         MVC   DMVOL(6),UCBVOLI(@10)                            03S0653
*     DMNTVUA=(UCBCHAN); /*FILL VALUE OF VUA @ZDR2048*/         03S0654
         MVC   DMNTVUA(2),UCBCHAN(@10)                          03S0654
*     DMVUAVAL='1'B;/* OR ON THE VUA VALID ATTRIBUTE FLAG @ZDR2048*/
         OI    DMVUAVAL,B'00100000'                             03S0655
*     SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/               03S0656
         SVC   126                                              03S0656
*     RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /* VUA FOR DEMOUNT
* @G24LPSJ*/                                                    03S0657
*    RFY (RCODE,REG0) RSTD;            /*                    @Y30LPPD*/
*    IF RCODE ¬= ZERO                  /*RETURN CODE OK?     @Y30LPPD*/
*      THEN DO;                        /*NO -                @Y30LPPD*/
         LTR   RCODE,RCODE                                      03S0659
         BZ    @RF00659                                         03S0659
*        FAILSW = ON;                  /*INDICATE FAILURE    @Y30LPPD*/
         OI    FAILSW,B'01000000'                               03S0661
*        RSNCDE = REG0;                /*MOVE REASON CODE    @Y30LPPD*/
         ST    REG0,RSNCDE                                      03S0662
*        RFY (RCODE,REG0) UNRSTD;      /*                    @Y30LPPD*/
*        UNPK (UNPKAR,RSNAREA(3:5));   /*CONVERT REASON CODE @Y30LPPD*/
         UNPK  UNPKAR(5),RSNAREA+2(3)                           03S0664
*        TR (UNPKAR(1:4),TRANSTAB);    /*                    @Y30LPPD*/
         LA    @10,TRPATN                                       03S0665
         AL    @10,@CF02677                                     03S0665
         TR    UNPKAR(4),TRANSTAB(@10)                          03S0665
*        VOL986 = MSSVOL;              /*MOVE REQUESTED VOLSER  03S0666
*                                        INTO IEA986I        @Y30LPPD*/
         MVC   VOL986(6),MSSVOL                                 03S0666
*        VOL985 = UCBVOLI;             /*MOVE VOLSER FOUND ON DEVICE
*                                        INTO IEA985I        @Y30LPPD*/
         L     @10,UCBPTR                                       03S0667
         MVC   VOL985(6),UCBVOLI(@10)                           03S0667
*        DEV986 = UCBNAME;             /*MOVE VUA TO MSGS    @Y30LPPD*/
         MVC   DEV986(3),UCBNAME(@10)                           03S0668
*        DEV985 = UCBNAME;             /*                    @Y30LPPD*/
         MVC   DEV985(3),UCBNAME(@10)                           03S0669
*        RET985 = UNPKAR(2:4);         /*MOVE RETURN CODE    @Y30LPPD*/
         MVC   RET985(3),UNPKAR+1                               03S0670
*        GEN REFS(NVTWTOR);            /*ISSUE IEA986I +985I @Y30LPPD*/
         IEAPMNIP TYPE=WTO,PARAM=IEA986I                       @Y30LPPD
         IEAPMNIP TYPE=WTO,PARAM=IEA985I                       @Y30LPPD
*        /*IEA986I MSS VOLUME AAAAAA REQUIRED ON VXXX.       @Y30LPPD*/
*        /*IEA985I UNABLE TO UNLOAD VIRTUAL VOLUME BBBBBB    @Y30LPPD*/
*        /*FROM VXXX - RC=RET.                               @Y30LPPD*/
*      END;                            /*                    @Y30LPPD*/
*      ELSE DO;                        /*DEMOUNT SUCCESSFUL- @Y30LPPD*/
         B     @RC00659                                         03S0673
@RF00659 DS    0H                                               03S0674
*        UCBVOLI = ZEROVOLI;           /*UNLOAD THE VOLUME-  @Y30LPPD*/
         L     @10,UCBPTR                                       03S0674
         MVC   UCBVOLI(6,@10),ZEROVOLI                          03S0674
*        UCBVTOC = ZEROVTOC;           /*ZERO VOLSER & VTOC  @Y30LPPD*/
         MVC   UCBVTOC(4,@10),ZEROVTOC                          03S0675
*        UCBNOTRD = YES;               /*MAKE NOT READY      @Y30LPPD*/
         OI    UCBNOTRD(@10),B'01000000'                        03S0676
*      END;                            /*                    @Y30LPPD*/
*  END;                                /*                    @Y30LPPD*/
@RC00659 DS    0H                                               03S0679
*IF FAILSW = OFF                       /*NO ERRORS ON DEMNT? @Y30LPPD*/
*  THEN DO;                            /*RIGHT -             @Y30LPPD*/
@RF00649 TM    FAILSW,B'01000000'                               03S0679
         BNZ   @RF00679                                         03S0679
*/***********************************************************@ZA14221*/
*/*                                                          @ZA14221*/
*/* SEGMENT NAME - CKPATH                                    @ZA14221*/
*/*                                                          @ZA14221*/
*/* DESCRIPTIVE NAME - CHECK MSS DATA PATHS                  @ZA14221*/
*/*                                                          @ZA14221*/
*/* FUNCTION                                                 @ZA14221*/
*/*                                                          @ZA14221*/
*/*     MSS VATLST ENTRIES ARE CHECKED TO DETERMINE WHETHER  @ZA14221*/
*/*     A PATH EXISTS TO THE DEVICE OR NOT. THIS IS DONE TO  @ZA14221*/
*/*     DETERMINE WHETHER THE MSS MOUNT SVC SHOULD BE ISSUED @ZA14221*/
*/*     OR NOT. A MOUNT CAN BE ISSUED UNDER THE FOLLOWING    @ZA14221*/
*/*     CONDITIONS:                                          @ZA14221*/
*/*       . THE UCB IS ONLINE                                @ZA14221*/
*/*       . THE UCB IS OFFLINE, BUT THE DATA PATH ROUTINE    @ZA14221*/
*/*         COULD BE LOADED AND DETERMINED THAT A PATH IS    @ZA14221*/
*/*         AVAILABLE.                                       @ZA14221*/
*/*                                                          @ZA14221*/
*/* ENTRY - IN-LINE SEGMENT                                  @ZA14221*/
*/*                                                          @ZA14221*/
*/*     PURPOSE - SEE FUNCTION                               @ZA14221*/
*/*                                                          @ZA14221*/
*/*     INPUT DATA                                           @ZA14221*/
*/*                                                          @ZA14221*/
*/*         THE UCB ADDRESS FOR THE VATLST ENTRY             @ZA14221*/
*/*                                                          @ZA14221*/
*/* EXITS                                                    @ZA14221*/
*/*                                                          @ZA14221*/
*/*       CONDITION - IT IS DETERMINED WHETHER A PATH IS     @ZA14221*/
*/*          IS AVAILABLE TO THE DEVICE.                     @ZA14221*/
*/*                                                          @ZA14221*/
*/*       OUTPUT DATA                                        @ZA14221*/
*/*                                                          @ZA14221*/
*/*          MSSMNT - IF 1, IT IS OK TO ISSUE THE MOUNT      @ZA14221*/
*/*                   IF 0, DO NOT ISSUE THE MOUNT           @ZA14221*/
*/*                                                          @ZA14221*/
*/*       RETURN CODE - NONE                                 @ZA14221*/
*/*                                                          @ZA14221*/
*/***********************************************************@ZA14221*/
*IF UCBONLI = ON                       /*PATH OK IF ONLINE   @ZA14221*/
*  THEN MSSMNT = ON;                   /*OK TO MOUNT UNIT    @ZA14221*/
         L     @10,UCBPTR                                       04S0681
         TM    UCBONLI(@10),B'10000000'                         04S0681
         BNO   @RF00681                                         04S0681
         OI    MSSMNT,B'00000100'                               04S0682
*ELSE                                  /*VERIFY PATH         @ZA14221*/
*  IF DPLOADED = YES                   /*VDEV LOADED         @ZA14221*/
*    THEN DO;                          /*YES, CHECK PATHS    @ZA14221*/
         B     @RC00681                                         04S0683
@RF00681 TM    DPLOADED,B'01000000'                             04S0683
         BNO   @RF00683                                         04S0683
*       RFY (RPARM) RSTD;              /*                    @ZA14221*/
*       DPPLIST = ADDR(DPPARM);        /*SET PLIST           @ZA14221*/
         LA    @10,DPPARM                                       04S0686
         ST    @10,DPPLIST                                      04S0686
*       RPARM = ADDR(DPPLIST);         /*SET R1 TO PLIST ADDR@ZA14221*/
         LA    RPARM,DPPLIST                                    04S0687
*       DPUCB = UCBPTR;                /*SET UCB PTR IN PLIST@ZA14221*/
         MVC   DPUCB(4),UCBPTR                                  04S0688
*       RFY (RCODE) RSTD;              /*                    @ZA14221*/
*       RCODE = DATAPATH;              /*SET ADDR OF VDEV    @ZA14221*/
         L     RCODE,DATAPATH                                   04S0690
*       GEN SETS(RCODE,REXIT);         /*CALL VDEV           @ZA14221*/
          BALR REXIT,RCODE                                     @ZA14221
*       IF RCODE = ZERO |              /*PATH OK OR          @ZA14221*/
*          RCODE = TWENTY              /*ALREADY VALIDATED   @ZA14221*/
*         THEN MSSMNT = ON;            /*OK TO MOUNT         @ZA14221*/
         LTR   RCODE,RCODE                                      04S0692
         BZ    @RT00692                                         04S0692
         CH    RCODE,@CH00078                                   04S0692
         BNE   @RF00692                                         04S0692
@RT00692 DS    0H                                               04S0693
         OI    MSSMNT,B'00000100'                               04S0693
*       ELSE MSSMNT = OFF;             /*NO PATH AVAILABLE   @ZA14221*/
         B     @RC00692                                         04S0694
@RF00692 NI    MSSMNT,B'11111011'                               04S0694
*    END;                              /*END CHECKING PATHS  @ZA14221*/
*  ELSE MSSMNT = OFF;                  /*VDEV NOT LOADED, CANNOT TELL
*                                        WHETHER PATH AVAILABLE, DO
*                                        NOT MOUNT           @ZA14221*/
         B     @RC00683                                         04S0696
@RF00683 NI    MSSMNT,B'11111011'                               04S0696
*    IF MSSMNT = ON THEN DO;           /*OK TO ISSUE MOUNT?  @ZA14221*/
*                                                               03S0697
@RC00683 DS    0H                                               03S0697
@RC00681 TM    MSSMNT,B'00000100'                               03S0697
         BNO   @RF00697                                         03S0697
*       /********************************************************* @Y30
*B02*/                                                          03S0699
*       /*MACMEAN  MSSC MOUNT MACRO                                @Y30
*B02*/                                                          03S0699
*       /*VS2-3 VERSION--02/06/76                                  @G18
*B04*/                                                          03S0699
*       /*THIS IS THE STANDARD FORM - MOUNT MACRO                  @Y30
*B02*/                                                          03S0699
*       /********************************************************* @Y30
*B02*/                                                          03S0699
*       RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/            03S0699
*       MDREG1=ADDR(MDLEN);/*R1 PTR TO REQBLK @Y30LB02*/        03S0700
         LA    MDREG1,MDLEN                                     03S0700
*       DCL 1  ICBMLST  STATIC LOCAL, /*MOUNT REQUEST BLOCK @Y30LB02*/
*           2  MDLEN  FIXED(31)INIT('1C'X),/*LENGTH OF MOUNT REQ BLK @Y
*0LB02*/                                                        03S0701
*           2  MDOPCD FIXED(8)INIT('08'X),/*MOUNT OPCODE @Y30LB02*/
*           2  *    CHAR(1) INIT('00'X) ,/*RESERVED @Y30LB02*/  03S0701
*           2  MDFLG BIT(16)INIT('0000000000000000'B),/*FLAGS AREA @Y30
*B02*/                                                          03S0701
*           3  * BIT(1), /* RESERVED  @YD00125*/                03S0701
*           3  MDVISMNT BIT(1), /*MSVC ISSUING THE MOUNT @Y30LB02*/
*           3  MDVSVRQ BIT(1), /*MSVC SECONDARY VOLUME REQUEST @Y30LB02
*/                                                              03S0701
*           3  MDSRTCH BIT(1), /*SCRATCH  @Y30LB02*/            03S0701
*           3  MDMEXT  BIT(1), /*MOUNT EXTENSION  @G18MB04*/    03S0701
*           3  *      BIT(11), /*RESERVE BITS OF ZERO @Y30LB02*/
*           2  MDVOL CHAR(6),/*VOLUME ID @Y30LB02*/             03S0701
*            3  *(6) CHAR(1) INIT((6)'00'X),/*INIT VOLID AREA TO ZERO @
*30LB02*/                                                       03S0701
*           2  MDVUA  FIXED(15) INIT(0),/*VIRTUAL UNIT ADDRESS @Y30LB02
*/                                                              03S0701
*           2  MDHOST CHAR(5),/*5-BYTE HOSTID AREA @Y30LB02*/   03S0701
*            3  *(5) CHAR(1) INIT((5)'00'X),/*INIT HOSTID AREA  @Y30LB0
**/                                                             03S0701
*           2  * CHAR(3),/*2-BYTE RESERVED AREA @Y30LB02*/      03S0701
*            3  *(3) CHAR(1) INIT((3)'00'X),/*INIT RESERVED AREA  @Y30L
*02*/                                                           03S0701
*           2  MNTEXTP PTR(31) INIT(0),/*ADDRESS OF MOUNT LIST EXTENSIO
* @G18MB04*/                                                    03S0701
*            3  MDJFCB FIXED(31); /* ADDRESS OF JFCB @G18MB04*/ 03S0701
*       MDVOL=(MSSVOL);/*VALUE OF VOLID @Y30LB02*/              03S0702
         MVC   MDVOL(6),MSSVOL                                  03S0702
*       MDVUA=(UCBCHAN); /*VALUE OF VUA    @Y30LB02*/           03S0703
         L     @14,UCBPTR                                       03S0703
         MVC   MDVUA(2),UCBCHAN(@14)                            03S0703
*       SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/             03S0704
         SVC   126                                              03S0704
*       RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /*MOUNT    03S0705
*                                      REQUESTED MSS VOLUME@Y30LPPD*/
*      RFY (RCODE,REG0) RSTD;          /*                    @Y30LPPD*/
*      IF RCODE ¬= ZERO                /*CHECK RETURN CODE   @Y30LPPD*/
*        THEN DO;                      /*FAILURE -           @Y30LPPD*/
         LTR   RCODE,RCODE                                      03S0707
         BZ    @RF00707                                         03S0707
*          RSNCDE = REG0;              /*MOVE REASON CODE    @Y30LPPD*/
         ST    REG0,RSNCDE                                      03S0709
*          RFY (RCODE,REG0) UNRSTD;    /*                    @Y30LPPD*/
*          UNPK (UNPKAR,RSNAREA(3:5)); /*CONVERT REASON CODE @Y30LPPD*/
         UNPK  UNPKAR(5),RSNAREA+2(3)                           03S0711
*          TR (UNPKAR(1:4),TRANSTAB);  /*                    @Y30LPPD*/
         LA    @10,TRPATN                                       03S0712
         AL    @10,@CF02677                                     03S0712
         TR    UNPKAR(4),TRANSTAB(@10)                          03S0712
*          VOL987 = MSSVOL;            /*MOVE VOLSER TO MSG  @Y30LPPD*/
         MVC   VOL987(6),MSSVOL                                 03S0713
*          DEV987 = FINDDEV;           /*MOVE VUA TO MSG     @Y30LPPD*/
         MVC   DEV987(3),FINDDEV                                03S0714
*          RET987 = UNPKAR(2:4);       /*MOVE RETURN CODE    @Y30LPPD*/
         MVC   RET987(3),UNPKAR+1                               03S0715
*          GEN REFS(NVTWTO)                                     03S0716
*          (IEAPMNIP TYPE=WTO,PARAM=IEA987I);/*ISSUE IEA987I @Y30LPPD*/
         IEAPMNIP TYPE=WTO,PARAM=IEA987I
*          /*IEA987I UNABLE TO MOUNT MSS VOLUME AAAAAA ON    @Y30LPPD*/
*          /*DDD - RC=RET                                    @Y30LPPD*/
*        END;                          /*                    @Y30LPPD*/
*        ELSE DO;                      /*MOUNT SUCCESSFUL    @Y30LPPD*/
         B     @RC00707                                         03S0718
@RF00707 DS    0H                                               03S0719
*/***********************************************************@Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* SEGMENT NAME - VIRTREAD                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* DESCRIPTIVE NAME - READ LABEL OF MSS VOLUME MOUNTED      @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* FUNCTION -                                               @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     USE SUBROUTINE EXCPSETP TO INITIALIZE CONTROL BLOCKS @Y30LPPD*/
*/*     FOR EXCP. ISSUE EXCP TO READ LABEL. IF THERE WAS AN  @Y30LPPD*/
*/*     ERROR IN THE EXCP OR THE LABEL IS NOT STANDARD OR    @Y30LPPD*/
*/*     THE LABEL DOES NOT CONTAIN THE SAME VOLSER AS IN THE @Y30LPPD*/
*/*     MOUNT LIST ENTRY, THEN ISSUE MESSAGE 'IEA854I ERROR  @Y30LPPD*/
*/*     READING VOLUME LABEL.' IF THE ERROR WAS DUE TO       @Y30LPPD*/
*/*     DEVICE FAILURE, ISSUE NIP SENSE TO PUT SENSE BYTES   @Y30LPPD*/
*/*     OUT TO CONSOLE. DEMOUNT THE VOLUME. IF THE DEMOUNT   @Y30LPPD*/
*/*     FAILS, ISSUE MESSAGE 'IEA985I UNABLE TO UNLOAD       @Y30LPPD*/
*/*     VOLUME AAAAAA FROM VXXX - RC=RET.' IF THE DEMOUNT    @Y30LPPD*/
*/*     WAS SUCCESSFUL, UNLOAD THE VOLUME AND ISSUE MESSAGE  @Y30LPPD*/
*/*     'IEA948I VXXX NOW UNLOADED.'                         @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     IF THERE WAS NO ERROR VERIFYING THE LABEL THEN CON-  @Y30LPPD*/
*/*     VERT THE VTOC TTR, MOVE THE TTR AND THE VOLSER       @Y30LPPD*/
*/*     INTO THE UCB, AND BRING THE DEVICE ONLINE. CALL      @Y30LPPD*/
*/*     SETSTAT TO SET THE VOLUME ATTRIBUTES.                @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* ENTRY - IN-LINE SEGMENT                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     PURPOSE - SEE FUNCTION                               @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     INPUT DATA -                                         @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*         UCB                                              @Y30LPPD*/
*/*         MOUNT LIST ENTRY                                 @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* EXITS -                                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     CONDITION - NORMAL - VOLUME LABEL READ + VERIFIED    @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     OUTPUT DATA -                                        @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*         UCB - MODIFIED, VOLUME MOUNTED, ATTRIBUTES SET   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     CONDITION - VERIFY LABEL FAILS, VOLUME SUCCESSFULLY  @Y30LPPD*/
*/*                 DEMOUNTED                                @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     OUTPUT DATA -                                        @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*         MESSAGE IEA854I                                  @Y30LPPD*/
*/*         MESSAGE IEA948I                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     CONDITION - VERIFY LABEL FAILS, DEMOUNT FAILS        @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     OUTPUT DATA -                                        @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*         MESSAGE IEA854I                                  @Y30LPPD*/
*/*         MESSAGE IEA985I                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     RETURN CODE - NONE                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/***********************************************************@Y30LPPD*/
*                                                               04S0719
*CALL EXCPSETP;                        /*SETUP TO READ LABEL @Y30LPPD*/
         BAL   @14,EXCPSETP                                     04S0719
*EXCPSW = ON;                          /*INDICATE SETUP DONE @Y30LPPD*/
         OI    EXCPSW,B'00100000'                               04S0720
*DEBUCBA = UCBPTR;                     /*UCB ADDRESS INTO DEB@Y30LPPD*/
         L     @10,DEBDAPTR                                     04S0721
         MVC   DEBUCBA(3,@10),UCBPTR+1                          04S0721
*ECB = ZERO;                           /*CLEAR ECB           @Y30LPPD*/
         L     @10,ECBPTR                                       04S0722
         SLR   @05,@05                                          04S0722
         ST    @05,ECB(,@10)                                    04S0722
*LABELBUF = BLANK;                     /*CLEAR LABEL AREA    @Y30LPPD*/
         MVI   LABELBUF+1,C' '                                  04S0723
         MVC   LABELBUF+2(78),LABELBUF+1                        04S0723
         MVI   LABELBUF,C' '                                    04S0723
*RFY RPARM RSTD;                       /*                    @Y30LPPD*/
*RPARM = IOBSTPTR;                     /*ADDRESS OF IOB      @Y30LPPD*/
         L     RPARM,IOBSTPTR                                   04S0725
*GEN REFS(RPARM) SETS(RPARM)                                    04S0726
*(EXCP (RPARM));                       /*READ VOLUME LABEL   @Y30LPPD*/
         EXCP (RPARM)
*RPARM = ECBPTR;                       /*ADDRESS OF ECB      @Y30LPPD*/
         L     RPARM,ECBPTR                                     04S0727
*GEN REFS(RPARM) SETS(REG0,RPARM)                               04S0728
*(WAIT ECB=(RPARM));                   /*AWAIT I/O COMPLETION@Y30LPPD*/
         WAIT ECB=(RPARM)
*RFY RPARM UNRSTD;                     /*                    @Y30LPPD*/
*IF ECBCC ¬= GOODPOST |                /*ERROR ON EXCP?      @Y30LPPD*/
*   VOL1 ¬= COMPVOL1 |                 /*NOT STANDARD LABEL? @Y30LPPD*/
*   VOLSER ¬= MSSVOL                   /*NOT RIGHT VOLSER?   @Y30LPPD*/
*  THEN DO;                            /*ERROR -             @Y30LPPD*/
         L     @10,ECBPTR                                       04S0730
         CLI   ECBCC(@10),X'7F'                                 04S0730
         BNE   @RT00730                                         04S0730
         CLC   VOL1(4),@CC00130                                 04S0730
         BNE   @RT00730                                         04S0730
         CLC   VOLSER(6),MSSVOL                                 04S0730
         BE    @RF00730                                         04S0730
@RT00730 DS    0H                                               04S0731
*    IOBFLAG1 = IOBFLAGS;              /*RE-INIT FLAGS       @Y30LPPD*/
         L     @10,IOBSTPTR                                     04S0732
         MVI   IOBFLAG1(@10),X'42'                              04S0732
*    IF ECBCC ¬= GOODPOST              /*IF I/O ERROR        @Y30LPPD*/
*      THEN DO;                        /*                    @Y30LPPD*/
         L     @05,ECBPTR                                       04S0733
         CLI   ECBCC(@05),X'7F'                                 04S0733
         BE    @RF00733                                         04S0733
*        RFY RPARM RSTD;               /*                    @Y30LPPD*/
*        RPARM = IOBSTPTR;             /*ISSUE NIP SENSE TO  @Y30LPPD*/
         LR    RPARM,@10                                        04S0736
*        GEN REFS(NVTSENSE)            /*INFORM OP OF ERROR  @Y30LPPD*/
*        (IEAPMNIP TYPE=SENSE,PARAM=RPARM);                     04S0737
         IEAPMNIP TYPE=SENSE,PARAM=RPARM
*        RFY RPARM UNRSTD;             /*                    @Y30LPPD*/
*      END;                            /*                    @Y30LPPD*/
*    GEN REFS(NVTWTO)                                           04S0740
*    (IEAPMNIP TYPE=WTO,PARAM=IEA854I);/*ISSUE IEA854I       @Y30LPPD*/
@RF00733 DS    0H                                               04S0740
         IEAPMNIP TYPE=WTO,PARAM=IEA854I
*    /*IEA854I ERROR READING VOLUME LABEL.                   @Y30LPPD*/
*                                                               04S0741
*     /********************************************************* @Y30LB
*2*/                                                            04S0741
*     /*MACMEAN  MSSC DEMOUNT MACRO                              @Y30LB
*2*/                                                            04S0741
*     /*VS1-4/VS2-3 VERSION--01/19/76 LEVEL 00                   @ZDR20
*8*/                                                            04S0741
*     /*THIS IS THE OUTPUT FOR A SECONDARY                       @Y30LB
*2*/                                                            04S0741
*     /*INVOCATION OF THE STANDARD FORM MACRO                    @Y30LB
*2*/                                                            04S0741
*     /********************************************************* @Y30LB
*2*/                                                            04S0741
*     RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/              04S0741
*     MDREG1=ADDR(DMLEN);/*PTR TO REQ BLK @Y30LB02*/            04S0742
         LA    MDREG1,DMLEN                                     04S0742
*     DMVOL=(MSSVOL); /*VALUE OF VOLID @Y30LB02*/               04S0743
         MVC   DMVOL(6),MSSVOL                                  04S0743
*     DMNTVUA=(UCBCHAN); /*FILL VALUE OF VUA @ZDR2048*/         04S0744
         L     @10,UCBPTR                                       04S0744
         MVC   DMNTVUA(2),UCBCHAN(@10)                          04S0744
*     DMVUAVAL='1'B;/* OR ON THE VUA VALID ATTRIBUTE FLAG @ZDR2048*/
         OI    DMVUAVAL,B'00100000'                             04S0745
*     SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/               04S0746
         SVC   126                                              04S0746
*     RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /*           04S0747
*                                    DEMOUNT MSS VOLUME  @Y30LPPD*/
*    RFY (RCODE,REG0) RSTD;            /*                    @Y30LPPD*/
*    IF RCODE ¬=ZERO                   /*RETURN CODE OK?     @Y30LPPD*/
*      THEN DO;                        /*NO -                @Y30LPPD*/
         LTR   RCODE,RCODE                                      04S0749
         BZ    @RF00749                                         04S0749
*        RSNCDE = REG0;                /*MOVE REASON CODE    @Y30LPPD*/
         ST    REG0,RSNCDE                                      04S0751
*        RFY (RCODE,REG0) UNRSTD;      /*                    @Y30LPPD*/
*        UNPK (UNPKAR,RSNAREA(3:5));   /*CONVERT REASON CODE @Y30LPPD*/
         UNPK  UNPKAR(5),RSNAREA+2(3)                           04S0753
*        TR (UNPKAR(1:4),TRANSTAB);    /*                    @Y30LPPD*/
         LA    @10,TRPATN                                       04S0754
         AL    @10,@CF02677                                     04S0754
         TR    UNPKAR(4),TRANSTAB(@10)                          04S0754
*        VOL985 = MSSVOL;              /*MOVE VOLSER TO MSG  @Y30LPPD*/
         MVC   VOL985(6),MSSVOL                                 04S0755
*        DEV985 = UCBNAME;             /*MOVE VUA TO MSG     @Y30LPPD*/
         L     @10,UCBPTR                                       04S0756
         MVC   DEV985(3),UCBNAME(@10)                           04S0756
*        RET985 = UNPKAR(2:4);         /*MOVE RETURN CODE    @Y30LPPD*/
         MVC   RET985(3),UNPKAR+1                               04S0757
*        GEN REFS(NVTWTO)                                       04S0758
*        (IEAPMNIP TYPE=WTO,PARAM=IEA985I); /*ISSUE IEA985I  @Y30LPPD*/
         IEAPMNIP TYPE=WTO,PARAM=IEA985I
*        /*IEA985I UNABLE TO UNLOAD MSS VOLUME AAAAAA FROM   @Y30LPPD*/
*        /*VXXX - RC=RET.                                    @Y30LPPD*/
*      END;                            /*                    @Y30LPPD*/
*      ELSE DO;                        /*DEMOUNT SUCCESSFUL  @Y30LPPD*/
         B     @RC00749                                         04S0760
@RF00749 DS    0H                                               04S0761
*        UCBNOTRD = YES;               /*UNLOAD VOLUME       @Y30LPPD*/
         L     @10,UCBPTR                                       04S0761
         OI    UCBNOTRD(@10),B'01000000'                        04S0761
*        V948 = VIRT;                  /*MOVE V TO MESSAGE   @Y30LPPD*/
         MVI   V948,C'V'                                        04S0762
*        DEV948 = UCBNAME;             /*MOVE VUA TO MSG     @Y30LPPD*/
         MVC   DEV948(3),UCBNAME(@10)                           04S0763
*        GEN REFS(NVTWTO)                                       04S0764
*        (IEAPMNIP TYPE=WTO,PARAM=IEA948I); /*ISSUE IEA948I  @Y30LPPD*/
         IEAPMNIP TYPE=WTO,PARAM=IEA948I
*        /*IEA948I VXXX NON UNLOADED.                        @Y30LPPD*/
*      END;                            /*                    @Y30LPPD*/
*  END;                                /*                    @Y30LPPD*/
*  ELSE DO;                            /*READ SUCCESSFUL     @Y30LPPD*/
         B     @RC00730                                         04S0767
@RF00730 DS    0H                                               04S0768
*    RFY (RTTR,RPARM,RCCHHR,REG4,RENTRY) RSTD; /*            @Y30LPPD*/
*    RPARM = DEBPTR;                   /*ADDRESS OF DEB      @Y30LPPD*/
         L     RPARM,DEBPTR                                     04S0769
*    MBB = ZERO;                       /*CLEAR BIN ADDRESS   @Y30LPPD*/
         SLR   @14,@14                                          04S0770
         ST    @14,@TF00001                                     04S0770
         MVC   MBB(3),@TF00001+1                                04S0770
*    CCHHR = VOLVTOC;                  /*VTOC CCHHR          @Y30LPPD*/
         MVC   CCHHR(5),VOLVTOC                                 04S0771
*    RENTRY = CVTPRLTV;                /*ADDR OF CONVERT RTN @Y30LPPD*/
         L     @10,CVTPTR                                       04S0772
         L     RENTRY,CVTPRLTV(,@10)                            04S0772
*    GEN REFS(RCCHHR,RENTRY,RPARM,MBBCCHHR) /*CONVERT THE TTR@Y30LPPD*/
*        SETS(REXIT,RTTR,RCCHHR,REGSAVE,REG4);                  04S0773
     STM   RPARM,RENTRY,REGSAVE          SAVE REGISTERS        @Y30LPPD
     LA    REG4,REGSAVE                                        @Y30LPPD
     LA    RCCHHR,MBBCCHHR                                     @Y30LPPD
     BALR  REXIT,RENTRY                  CONVERT ROUTINE       @Y30LPPD
     LM    RPARM,RENTRY,0(4)             RESTORE REGS          @Y30LPPD
*    UCBVTOC = RTTR;                   /*VTOC TTR INTO UCB   @Y30LPPD*/
         L     @14,UCBPTR                                       04S0774
         ST    RTTR,UCBVTOC(,@14)                               04S0774
*    RFY (RCCHHR,RTTR,RPARM,REG4,RENTRY) UNRSTD;/*           @Y30LPPD*/
*    UCBVOLI = VOLSER;                 /*MOVE VOLSER INTO UCB@Y30LPPD*/
         MVC   UCBVOLI(6,@14),VOLSER                            04S0776
*    UCBONLI = YES;                    /*MAKE UCB ONLINE     @Y30LPPD*/
         OI    UCBONLI(@14),B'10000000'                         04S0777
*    CALL SETSTAT;                     /*SET ATTRIBUTES      @Y30LPPD*/
         BAL   @14,SETSTAT                                      04S0778
*  END;                                /*                    @Y30LPPD*/
*        END;                          /*                    @Y30LPPD*/
*    END;                              /*                    @Y30LPPD*/
*    ELSE DO;                          /*DEVICE NOT ACCESSIBL@ZA14221*/
         B     @RC00697                                         03S0782
@RF00697 DS    0H                                               03S0783
*      VOL409 = MSSVOL;                /*VOLSER              @ZA14221*/
         MVC   VOL409(6),MSSVOL                                 03S0783
*      DEV409 = FINDDEV;               /*UNIT NAME           @ZA14221*/
         MVC   DEV409(3),FINDDEV                                03S0784
*      GEN REFS(NVTWTOR);              /*                    @ZA14221*/
       IEAPMNIP TYPE=WTO,PARAM=IEA409I   ISSUE MESSAGE          ZA14221
*      /*IEA409I UNABLE TO MOUNT MSS VOLUME AAAAAA ON DDD, DEVICE NOT
*        ACCESSIBLE.                                         @ZA14221*/
*    END;                              /*END DEVICE NOT ACCESSIBLE
*                                                            @ZA14221*/
*  END;                                /*                    @Y30LPPD*/
@RC00697 DS    0H                                               03S0788
*MNTLIST(I) = MNTLIST(MTLSTCT);        /*REMOVE MNTLIST ENTRY@Y30LPPD*/
@RF00679 LA    @10,22                                           03S0788
         LR    @05,@10                                          03S0788
         MH    @05,I                                            03S0788
         LA    @01,MNTLIST-22(@05)                              03S0788
         LH    @05,MTLSTCT                                      03S0788
         LR    @07,@10                                          03S0788
         MR    @06,@05                                          03S0788
         LA    @10,MNTLIST-22(@07)                              03S0788
         MVC   @TS00001(22),0(@10)                              03S0788
         MVC   0(22,@01),@TS00001                               03S0788
*MTLSTCT = MTLSTCT - ONE;              /*DECREASE COUNT      @Y30LPPD*/
         BCTR  @05,0                                            03S0789
         STH   @05,MTLSTCT                                      03S0789
*      END;                            /*                    @Y30LPPD*/
*      ELSE IF EMNTPRIO = SUPMNT       /*REAL VOLUME IS NOT MOUNTED.
*                                        IS MESSAGE SUPPRESSION 02S0791
*                                        INDICATED?          @Y30LPPD*/
*        THEN DO;                      /*YES-                @Y30LPPD*/
         B     @RC00639                                         02S0791
@RF00639 L     @10,MAPAD                                        02S0791
         CLI   EMNTPRIO(@10),C'N'                               02S0791
         BNE   @RF00791                                         02S0791
*          MNTLIST(I) = MNTLIST(MTLSTCT); /*REMOVE MNTLIST ENTRY     */
         LA    @10,22                                           02S0793
         LR    @05,@10                                          02S0793
         MH    @05,I                                            02S0793
         LA    @01,MNTLIST-22(@05)                              02S0793
         LH    @05,MTLSTCT                                      02S0793
         LR    @07,@10                                          02S0793
         MR    @06,@05                                          02S0793
         LA    @10,MNTLIST-22(@07)                              02S0793
         MVC   @TS00001(22),0(@10)                              02S0793
         MVC   0(22,@01),@TS00001                               02S0793
*          MTLSTCT = MTLSTCT - ONE;    /*DECREMENT LIST COUNT        */
         BCTR  @05,0                                            02S0794
         STH   @05,MTLSTCT                                      02S0794
*        END;                                                   02S0795
*        ELSE DO;                      /*LEAVE ENTRY IN LIST         */
         B     @RC00791                                         02S0796
@RF00791 DS    0H                                               02S0797
*          I = I + ONE;                /*INDICATE NEXT ENTRY         */
         LA    @10,1                                            02S0797
         LH    @05,I                                            02S0797
         ALR   @05,@10                                          02S0797
         STH   @05,I                                            02S0797
*          DEVCT(J) = DEVCT(J) + ONE;  /*INCR. DEVICE TYPE COUNTER   */
         LH    @05,J                                            02S0798
         MH    @05,@CH01793                                     02S0798
         AH    @10,DEVCT-14(@05)                                02S0798
         STH   @10,DEVCT-14(@05)                                02S0798
*        END;                                                   02S0799
*END;                                                           02S0800
@RC00791 DS    0H                                               02S0800
@RC00639 DS    0H                                               02S0800
@RC00571 DS    0H                                               02S0800
@DE00559 LH    @10,MTLSTCT                                      02S0800
         CH    @10,I                                            02S0800
         BNL   @DL00559                                         02S0800
*END;                                  /*                    @ZA14221*/
*IF MTLSTCT ¬= ZERO                    /* IF THERE IS A MOUNT LIST,  */
*  THEN DO;                                                     01S0802
         LTR   @10,@10                                          01S0802
         BZ    @RF00802                                         01S0802
*    DO I = ONE TO NUMSUPTD;           /* SET ALL AUXILIARY COUNTERS */
         LA    @10,1                                            01S0804
         STH   @10,I                                            01S0804
@DL00804 DS    0H                                               01S0805
*      AUXCT(I) = DEVCT(I);            /* EQUAL TO THE DEVICE TYPE   */
         LR    @05,@10                                          01S0805
         MH    @05,@CH01793                                     01S0805
         LH    @15,DEVCT-14(@05)                                01S0805
         STH   @15,AUXCT-14(@05)                                01S0805
*    END;                              /* COUNTERS.                  */
         AH    @10,@CH00042                                     01S0806
         STH   @10,I                                            01S0806
         CH    @10,@CH00084                                     01S0806
         BNH   @DL00804                                         01S0806
*    DO;                               /* PUT OUT MOUNT MESSAGES.    */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - MOUNTMSG                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ISSUE MOUNT MESSAGES                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     ISSUE WTO FOR MESSAGE 'IEA851I-FOLLOWING MAY BE MOUNTED'.    */
*/*     FOR EACH ENTRY IN THE MOUNT LIST, MOVE VOLUME SERIAL NUMBER  */
*/*     AND DEVICE TYPE INTO MESSAGE AREA AND ISSUE WTO.  WHEN ALL   */
*/*     MOUNT LIST ENTRIES HAVE BEEN PROCESSED, ISSUE WTOR FOR       */
*/*     MESSAGE 'IEA851A-REPLY DEVICE ADDRESSES OR U'.               */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         LIST ON THE OPERATOR'S CONSOLE ANY VOLUMES IN VATLST     */
*/*         THAT WERE NOT MOUNTED AT SYSTEM START, AND DEVICE TYPES  */
*/*         FOR THESE VOLUMES.                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         MNTLIST - MOUNT LIST                                     */
*/*         MTLSTCT - NUMBER OF ENTRIES IN MNTLIST                   */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGES IEA851I, IEA851A, LIST OF VOLUMES               */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0808
*GEN REFS(NVTWTO);                    /*ISSUE HEADER MESSAGE IEA851I */
* IEA851I FOLLOWING MAY BE MOUNTED.
         IEAPMNIP TYPE=WTO,PARAM=IEA851I
*DO NEXTPTR = ONE TO MTLSTCT;          /*LOOP THROUGH MOUNT LIST     */
         LA    @10,1                                            02S0809
         B     @DE00809                                         02S0809
@DL00809 DS    0H                                               02S0810
*  SER851 = MVOLSER(NEXTPTR);          /*MOVE VOL SER INTO MESSAGE   */
         MH    @10,@CH00190                                     02S0810
         LA    @05,MVOLSER-22(@10)                              02S0810
         MVC   SER851(6),0(@05)                                 02S0810
*  DEV851 = MDEVTYPE(NEXTPTR);         /*MOVE DEVICE TYPE INTO MSG   */
         LA    @05,MDEVTYPE-22(@10)                             02S0811
         MVC   DEV851(8),0(@05)                                 02S0811
*  GEN REFS(NVTWTO);                   /*PRINT ONE LINE              */
*    SER ON DDDTYP
         IEAPMNIP TYPE=WTO,PARAM=IEA851I2
*END;                                                           02S0813
         LA    @10,1                                            02S0813
         AH    @10,NEXTPTR                                      02S0813
@DE00809 STH   @10,NEXTPTR                                      02S0813
         CH    @10,MTLSTCT                                      02S0813
         BNH   @DL00809                                         02S0813
*GEN REFS(NVTWTOR);                    /*ISSUE MESSAGE IEA851A       */
* IEA851A REPLY DEVICE ADDRESSES OR U.
         IEAPMNIP TYPE=WTOR,PARAM=IEA851A
*                                      /* RETURN TO TOP SEGMENT.     */
*    END;                                                       01S0815
*    DO WHILE NODEV = NO;              /* VALIDATE OPERATOR REPLY    */
         B     @DE00816                                         01S0816
@DL00816 DS    0H                                               01S0817
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CKREPLY                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHECK REPLY TO MOUNT MESSAGES                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     WAIT FOR REPLY TO MESSAGE IEA851A.  IF REPLY IS 'U' OR EOB,  */
*/*     THEN SET 'NODEV' EQUAL TO YES (NO DEVICES REPLIED IN ANSWER  */
*/*     TO MESSAGE).  OTHERWISE, EXECUTE 'DEVREPLY' SEGMENT.         */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         EXAMINE REPLY FROM MESSAGE IEA851A.                      */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         WTORBUF - CONTAINS REPLY TO IEA851A                      */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - REPLY IS U OR EOB                                */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         NODEV - SET TO ON                                        */
*/*                                                                  */
*/*     CONDITION - REPLY IS DEVICE ADDRESS(ES)                      */
*/*                                                                  */
*/*     OUTPUT DATA - NONE                                           */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0817
*IF SCAN2=REPLYU | SCAN2=REPLYEOB      /*CHECK FOR REPLY OF U OR EOB */
*  THEN NODEV = YES;                   /*NO DEVICES REPLIED          */
         CLC   SCAN2(2),@CC00168                                02S0817
         BE    @RT00817                                         02S0817
         CLC   SCAN2(2),@CC00170                                02S0817
         BNE   @RF00817                                         02S0817
@RT00817 DS    0H                                               02S0818
         OI    NODEV,B'00010000'                                02S0818
*  ELSE DO;                            /* VALIDITY CHECK REPLY.      */
         B     @RC00817                                         02S0819
@RF00817 DS    0H                                               02S0820
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DEVREPLY                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CONTROL VALIDITY CHECK OF THE DEVICE REPLY    */
*/*                    AND ISSUE FORMAT ERROR MESSAGE                */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     INITIALIZE 'BADADDR', WHICH WILL CONTAIN THE INVALID DEVICE  */
*/*     ADDRESS IF ONE IS FOUND, TO ZERO.  SET SWITCHES 'MSG1',      */
*/*     'MSG2', AND 'GOODLIST' OFF.                                  */
*/*                                                                  */
*/*     AFTER THE REPLY HAS BEEN VALIDITY CHECKED, THE SWITCH 'MSG1' */
*/*     IS TESTED.  IF IT IS ON, A FORMAT ERROR HAS BEEN FOUND AND   */
*/*     MESSAGE IEA895A IS ISSUED.                                   */
*/*                                                                  */
*/*     IF NO FORMAT ERROR HAS BEEN FOUND, THE SEGMENT WHICH CHECKS  */
*/*     THE VALIDITY OF THE DEVICE IS EXECUTED.                      */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         DEVICE REPLY (TO MESSAGE IEA851A)                        */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA - NONE                                           */
*/*                                                                  */
*/*     CONDITION - FORMAT ERROR                                     */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA895A ISSUED                                   */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0820
*BADADDR = ZEROADDR;                   /* INIT INVALID DEVICE PTR.   */
         MVC   BADADDR(3),ZEROADDR                              03S0820
*MSG1 = NO;                            /* INIT MESSAGE SWITCHES.     */
*MSG2 = NO;                                                     03S0822
         NI    MSG1,B'11100111'                                 03S0822
*GOODLIST = NO;                        /* INIT VALID REPLY INDIC.    */
         NI    GOODLIST,B'11111011'                             03S0823
*DO;                                   /* CHECK FORMAT OF REPLY.     */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DELIMCK                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHECK DELIMITERS IN THE DEVICE REPLY          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     WHEN THE END OF THE REPLY HAS BEEN ENCOUNTERED, THE COUNTER  */
*/*     'TOMOUNT' IS SET TO THE NUMBER OF VOLUMES THE OPERATOR       */
*/*     WISHES TO MOUNT.                                             */
*/*                                                                  */
*/*     IF THE END INDICATOR OR A COMMA IS FOUND IN THE DEVICE ADD-  */
*/*     RESS FIELD, OR THE DELIMITER IS NOT A COMMA OR END INDICATOR,*/
*/*     'MSG1' SWITCH IS SET ON TO INDICATE THAT A FORMAT ERROR WAS  */
*/*     FOUND.                                                       */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         REPLAREA - CONTAINS THE DEVICE REPLY                     */
*/*         MSG1 - SET OFF                                           */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         TOMOUNT - SET TO THE NUMBER OF VOLUMES TO BE MOUNTED     */
*/*                                                                  */
*/*     CONDITION - THE END INDICATOR OR A COMMA IS FOUND IN THE     */
*/*                 DEVICE FIELD                                     */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MSG1 - SET ON                                            */
*/*                                                                  */
*/*     CONDITION - DELIMITER IS NOT COMMA OR END INDICATOR          */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MSG1 - SET ON                                            */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               04S0825
*LOOPSW = NO;                          /* INIT LOOP SWITCH.  SET UP  */
         NI    LOOPSW,B'11101111'                               04S0825
*DO I = ONE TO REPLYMAX WHILE LOOPSW = NO;    /* TO CHECK MAX REPLY. */
         LA    @10,1                                            04S0826
         STH   @10,I                                            04S0826
@DL00826 TM    LOOPSW,B'00010000'                               04S0826
         BNZ   @DC00826                                         04S0826
*  DO N = THREE TO ONE BY - ONE WHILE MSG1 = NO; /* CK DEV ADDR  FOR */
         LA    @10,3                                            04S0827
         STH   @10,N                                            04S0827
@DL00827 TM    MSG1,B'00010000'                                 04S0827
         BNZ   @DC00827                                         04S0827
*    IF UNIT(I,N) = QUOTE | UNIT(I,N) = COMMA     /* END INDIC. OR   */
*      THEN DO;                        /* DELIM. IF FOUND, SET SW TO */
         LH    @05,I                                            04S0828
         SLA   @05,2                                            04S0828
         ALR   @05,@10                                          04S0828
         LA    @10,UNIT-5(@05)                                  04S0828
         CLI   0(@10),C''''                                     04S0828
         BE    @RT00828                                         04S0828
         LA    @10,UNIT-5(@05)                                  04S0828
         CLI   0(@10),C','                                      04S0828
         BNE   @RF00828                                         04S0828
@RT00828 DS    0H                                               04S0829
*        MSG1 = YES;                   /* PUT OUT FORMAT ERROR MSG.  */
         OI    MSG1,B'00010000'                                 04S0830
*        LOOPSW = YES;                 /* AND TERM VALIDITY CHECK.   */
         OI    LOOPSW,B'00010000'                               04S0831
*      END;                                                     04S0832
*  END;                                                         04S0833
@RF00828 SLR   @10,@10                                          04S0833
         BCTR  @10,0                                            04S0833
         AH    @10,N                                            04S0833
         STH   @10,N                                            04S0833
         LTR   @10,@10                                          04S0833
         BP    @DL00827                                         04S0833
@DC00827 DS    0H                                               04S0834
*  IF MSG1 = NO                        /* IF NO ERROR DETECTED YET,  */
*    THEN DO;                          /* AND THIS IS THE END OF THE */
         TM    MSG1,B'00010000'                                 04S0834
         BNZ   @RF00834                                         04S0834
*      IF DELIM(I) = QUOTE             /* OPERATOR'S REPLY, THEN SET */
*        THEN DO;                      /* THE NUMBER OF VOLUMES TO   */
         LH    @10,I                                            04S0836
         LR    @05,@10                                          04S0836
         SLA   @05,2                                            04S0836
         LA    @01,DELIM-4(@05)                                 04S0836
         CLI   0(@01),C''''                                     04S0836
         BNE   @RF00836                                         04S0836
*          TOMOUNT = I;                /* BE MOUNTED.                */
         STH   @10,TOMOUNT                                      04S0838
*          LOOPSW = YES;               /* TERMINATE REPLY CHECKING.  */
         OI    LOOPSW,B'00010000'                               04S0839
*        END;                                                   04S0840
*        ELSE IF DELIM(I) ¬= COMMA     /* IF IT IS NOT THE END AND   */
*          THEN DO;                    /* NOT A VALID DELIMITER,     */
         B     @RC00836                                         04S0841
@RF00836 LH    @10,I                                            04S0841
         SLA   @10,2                                            04S0841
         LA    @05,DELIM-4(@10)                                 04S0841
         CLI   0(@05),C','                                      04S0841
         BE    @RF00841                                         04S0841
*            MSG1 = YES;               /* SET ERROR MSG SWITCH AND   */
         OI    MSG1,B'00010000'                                 04S0843
*            LOOPSW = YES;             /* TERMINATE REPLY CHECKING.  */
         OI    LOOPSW,B'00010000'                               04S0844
*          END;                                                 04S0845
*    END;                                                       04S0846
@RF00841 DS    0H                                               04S0846
@RC00836 DS    0H                                               04S0847
*END;                                  /* RETURN TO DEVREPLY.        */
@RF00834 LA    @10,1                                            04S0847
         AH    @10,I                                            04S0847
         STH   @10,I                                            04S0847
         CH    @10,@CH00088                                     04S0847
         BNH   @DL00826                                         04S0847
@DC00826 DS    0H                                               04S0848
*END;                                                           03S0848
*IF MSG1 = YES                         /* IF MSG SWITCH IS ON        */
*  THEN DO;                                                     03S0849
         TM    MSG1,B'00010000'                                 03S0849
         BNO   @RF00849                                         03S0849
*    GEN REFS(NVTWTOR);                /* ISSUE REPEAT REPLY MSG.    */
     IEAPMNIP TYPE=WTOR,PARAM=IEA895A  /* FOR FORMAT ERROR.          */
*  END;                                                         03S0852
*  ELSE DO;                            /* IF NO FORMAT ERROR, THEN   */
         B     @RC00849                                         03S0853
@RF00849 DS    0H                                               03S0854
*                                      /* VALIDATE UCB.              */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CHECKUCB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CONTROL VALIDITY CHECK OF DEVICE ADDRESSES    */
*/*                    IN THE REPLY AND ISSUE REPEAT REPLY MESSAGE.  */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     CONTROL IS GIVEN TO THE SEGMENT THAT CHECKS THE VALIDITY OF  */
*/*     THE ADDRESSES.                                               */
*/*                                                                  */
*/*     WHEN THE VALIDITY HAS BEEN CHECKED, 'BADADDR' IS TESTED.     */
*/*     IF AN ERROR HAS BEEN DETECTED, IT WILL CONTAIN THE INVALID   */
*/*     ADDRESS.  IF IT IS ZERO, THE SEGMENT THAT CHECKS FOR DUPLI-  */
*/*     CATE DEVICES IN THE REPLY IS EXECUTED.                       */
*/*                                                                  */
*/*     THE SWITCH 'MSG2' IS TESTED.  IF IT IS NOT ON, THE SWITCHES  */
*/*     'GOODLIST' AND 'NODEV' ARE SET ON.  THESE SWITCHES INDICATE  */
*/*     THAT VOLUMES WILL BE MOUNTED AND THE DEVICE REPLY HAS BEEN   */
*/*     COMPLETELY VALIDATED.  IF 'MSG2' IS ON, THE DEVICE COUNTS    */
*/*     ARE RESET AND MESSAGE 'IEA852A-REPEAT REPLY' IS ISSUED.      */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         GOODLIST - SWITCH IS SET ON                              */
*/*         REPLAREA - CONTAINS THE DEVICE ADDRESSES REPLY           */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         GOODLIST - SWITCH IS ON                                  */
*/*         NODEV - SWITCH IS ON                                     */
*/*                                                                  */
*/*     CONDITION - ERROR                                            */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         GOODLIST - SWITCH IS LEFT OFF                            */
*/*         MESSAGE IEA852A IS ISSUED                                */
*/*         DEVCT(X) - SET EQUAL TO AUXCT(X)                         */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               04S0854
*DO;                                   /* CHECK EACH DEVICE IN THE   */
*                                      /* REPLY FOR A VALID UCB.     */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UCBFIND                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - VALIDITY CHECK THE UCB'S CORRESPONDING TO     */
*/*                    THE DEVICE ADDRESSES IN THE REPLY             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     FOR EACH DEVICE ON THE REPLY, UCBFN IS ISSUED.  THE          */
*/*     DEVICE ADDRESS IS PLACED IN 'BADADDR' IN CASE ANY OF THESE   */
*/*     ERRORS OCCURS:                                               */
*/*                                                                  */
*/*         1. UCBFN DOES NOT RETURN A UCB ADDRESS.                  */
*/*         2. UCB IS FOR A DEMOUNTABLE DEVICE THAT CONTAINS @YM02792*/
*/*            A PERMANENTLY RESIDENT OR RESERVED VOLUME.            */
*/*         3. THE UCB DEVICE TYPE IS NOT A DEVICE TYPE ON WHICH     */
*/*            A VOLUME IS TO BE MOUNTED.                            */
*/*         4. THE UCB IS FOR A NON-DEMOUNTABLE DEVICE THAT  @YM02792*/
*/*            WAS ONLINE AT IPL.                            @YM02792*/
*/*         5. THE UCB IS AN EXPOSURE IN A MULTIPLE EXPOSURE @YM02792*/
*/*            DEVICE, BUT IS NOT FOR THE BASE EXPOSURE.             */
*/*         6. THE UCB IS FOR AN MSS DEVICE.                 @Y30LPPD*/
*/*                                                                  */
*/*     IF NONE OF THE ABOVE CONDITIONS ARE FOUND, THE SEGMENT WHICH */
*/*     CHECKS FOR ONLINE STATUS IS EXECUTED.                        */
*/*                                                                  */
*/*     IF THE UCB IS VALID (BADADDR IS ZERO), THE DEVICE TYPE COUNT-*/
*/*     ER IS DECREMENTED.  OTHERWISE, THE SEGMENT THAT ISSUES THE   */
*/*     ERROR MESSAGE IS EXECUTED.                                   */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         REPLAREA - CONTAINS THE DEVICE ADDRESS REPLY             */
*/*         TOMOUNT - CONTAINS THE NUMBER OF DEVICE ADDRESSES        */
*/*                   TO CHECK                                       */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         DEVCT(X) - DEVICE TYPE COUNTERS ARE DECREMENTED          */
*/*                                                                  */
*/*     CONDITION - THE UCB IS INVALID                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         BADADDR - CONTAINS THE DEVICE ADDRESS CORRESPONDING      */
*/*                   TO THE INVALID UCB                             */
*/*         R852 - REASON CODE FIELD IN MESSAGE IEA852I SET TO:      */
*/*                2 - IF NO UCB IS FOUND                            */
*/*                3 - IF UCB IS FOR DEMOUNTABLE DEVICE THAT @YM02792*/
*/*                    CONTAINS A P/R OR RESV VOLUME         @YM02792*/
*/*                4 - IF DEVICE IS NOT DA                           */
*/*                5 - IF THERE ARE NO MORE OF THIS TYPE TO BE       */
*/*                    MOUNTED                                       */
*/*                9 - ADDR SPECIFIED IS FOR AN EXPOSURE     @YM02792*/
*/*                    WITHIN A MULTIPLE EXPOSURE DEVICE     @YM02792*/
*/*               10 - UCB IS FOR A NON-DEMOUNTABLE DEVICE   @YM02792*/
*/*                    THAT WAS ONLINE AT IPL.               @YM02792*/
*/*               11 - UCB IS FOR AN MSS DEVICE              @Y30LPPD*/
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               05S0855
*DO I = ONE TO TOMOUNT;                /* FOR EACH DEVICE ADDRESS    */
         LA    @10,1                                            05S0855
         B     @DE00855                                         05S0855
@DL00855 DS    0H                                               05S0856
*  FINDDEV = UNIT(I);                  /* SPECIFIED IN THE REPLY,    */
         SLA   @10,2                                            05S0856
         LA    @05,UNIT-4(@10)                                  05S0856
         MVC   FINDDEV(3),0(@05)                                05S0856
*  RESPECIFY (RPARM) RSTD;                                      05S0857
*  RPARM = FINDADDR;                   /* FIND THE CORRESPONDING     */
         L     RPARM,FINDADDR                                   05S0858
*  GEN REFS (NVTUCBFN) (IEAPMNIP TYPE=UCBFN,PARAM=RPARM); /* UCB ADDR*/
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM
*  BADADDR = UNIT(I);                  /* SAVE DEV IN CASE OF ERROR. */
         LH    @10,I                                            05S0860
         SLA   @10,2                                            05S0860
         LA    @05,UNIT-4(@10)                                  05S0860
         MVC   BADADDR(3),0(@05)                                05S0860
*  IF RPARM ¬= ZERO                                             05S0861
*    THEN DO;                          /* IF THERE IS A CORRESPOND-  */
         LTR   RPARM,RPARM                                      05S0861
         BZ    @RF00861                                         05S0861
*      UCBPTR = RPARM;                 /* ING UCB, THEN TEST IT.     */
         ST    RPARM,UCBPTR                                     05S0863
*      RESPECIFY (RPARM) UNRSTD;                                05S0864
*      FOUND = NO;                     /* INIT SWITCH.               */
         NI    FOUND,B'11111101'                                05S0865
*      ERROR = NO;                     /* INIT SWITCH        @YM02792*/
         NI    ERROR,B'11011111'                                05S0866
*      IF UCB3DACC = YES               /* IF UCB IS FOR DIRECT ACCESS*/
*        THEN IF UCBRVDEV = NO         /* NOT VIRTUAL,       @Y30LPPD*/
         L     @10,UCBPTR                                       05S0867
         TM    UCB3DACC(@10),B'00100000'                        05S0867
         BNO   @RF00867                                         05S0867
*          THEN IF UCBRESV = NO        /* NOT RESERVED, AND  @YM02792*/
         TM    UCBRVDEV(@10),B'00001000'                        05S0868
         BNZ   @RF00868                                         05S0868
*            THEN DO;                                       /*YM02792*/
         TM    UCBRESV(@10),B'00100000'                         05S0869
         BNZ   @RF00869                                         05S0869
*              IF UCBPRES = NO         /* NOT PERMANENTLY     YM02792*/
*                THEN IF UCBMTPXP = YES/* RESIDENT,BUT IS     YM02792*/
         TM    UCBPRES(@10),B'00000100'                         05S0871
         BNZ   @RF00871                                         05S0871
*                  THEN DO;            /*MULTIPLE EXPOSURE,   YM02792*/
         TM    UCBMTPXP(@10),B'00001000'                        05S0872
         BNO   @RF00872                                         05S0872
*                    R852 = REASON9;   /*THEN THIS IS A       YM02792*/
         MVC   R852(2),@CC02496                                 05S0874
*                                      /*NON-BASE EXPOSURE.   YM02792*/
*                    ERROR = YES;                               05S0875
         OI    ERROR,B'00100000'                                05S0875
*                  END;                                         05S0876
*                  ELSE;                                    /*YM02792*/
@RF00872 DS    0H                                               05S0878
*                ELSE DO;              /*IF DA, P/R,MULTI-   @YM02792*/
         B     @RC00871                                         05S0878
@RF00871 DS    0H                                               05S0879
*                  IF UCBMTPXP = YES   /*EXPOSURE DEVICE UCB @YM02792*/
*                    THEN IF UCBVOLI ¬= ZEROVOLI/*WITH VOLSER@YM02792*/
         L     @10,UCBPTR                                       05S0879
         TM    UCBMTPXP(@10),B'00001000'                        05S0879
         BNO   @RF00879                                         05S0879
*                      THEN DO;        /*DEVICE WAS ONLINE AT@YM02792*/
         CLC   UCBVOLI(6,@10),ZEROVOLI                          05S0880
         BE    @RF00880                                         05S0880
*                        R852 = REASON10;/*IPL AND NOT       @YM02792*/
         MVC   R852(2),@CC02498                                 05S0882
*                                      /*ELIGIBLE FOR MOUNT. @YM02792*/
*                        ERROR = YES;                           05S0883
         OI    ERROR,B'00100000'                                05S0883
*                      END;                                     05S0884
*                      ELSE;                               /*@YM02792*/
@RF00880 DS    0H                                               05S0886
*                    ELSE DO;          /* DA, P/R,DEMOUNTABLE@YM02792*/
         B     @RC00879                                         05S0886
@RF00879 DS    0H                                               05S0887
*                      R852 = REASON3; /* DEVICE IS NOT      @YM02792*/
         MVC   R852(2),@CC02484                                 05S0887
*                      ERROR = YES;    /* ELIGIBLE.FOR MOUNT.@YM02792*/
         OI    ERROR,B'00100000'                                05S0888
*                    END;                                  /*@YM02792*/
*                END;                                      /*@YM02792*/
@RC00879 DS    0H                                               05S0891
*              IF ERROR = NO                               /*@YM02792*/
*                THEN DO;                                  /*@YM02792*/
@RC00871 TM    ERROR,B'00100000'                                05S0891
         BNZ   @RF00891                                         05S0891
*                  DO J = ONE TO SIX WHILE FOUND = NO;          05S0893
         LA    @10,1                                            05S0893
         STH   @10,J                                            05S0893
@DL00893 TM    FOUND,B'00000010'                                05S0893
         BNZ   @DC00893                                         05S0893
*                    IF UCBTBYT4 = UCBTYPE(J)                   05S0894
*                      THEN DO;        /* IF DEV TYPE IS SUPPORTED   */
         L     @05,UCBPTR                                       05S0894
         LR    @15,@10                                          05S0894
         MH    @15,@CH01793                                     05S0894
         SLR   @14,@14                                          05S0894
         IC    @14,UCBTBYT4(,@05)                               05S0894
         LA    @01,UCBTYPE-14(@15)                              05S0894
         MVC   @ZT00003+3(1),0(@01)                             05S0894
         C     @14,@ZT00003                                     05S0894
         BNE   @RF00894                                         05S0894
*                        FOUND = YES;  /* SET SWITCH.                */
         OI    FOUND,B'00000010'                                05S0896
*                        IF DEVCT(J) ¬= ZERO                    05S0897
*                          THEN DO;    /* IF MORE OF THIS TYPE TO BE */
         LH    @15,DEVCT-14(@15)                                05S0897
         LTR   @15,@15                                          05S0897
         BZ    @RF00897                                         05S0897
*                                      /* MOUNTED,                   */
*                            K = J;    /* SAVE INDEX AND     @YM01529*/
         STH   @10,K                                            05S0899
*                                      /* SEE IF THE UCB IS ONLINE.  */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CKONLINE                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHECK UCB ONLINE STATUS                       */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     THE UCB FOR EACH DEVICE ADDR IN THE REPLY IS CHECKED FOR     */
*/*     ONLINE STATUS.  IF IT IS ONLINE, 'BADADDR' IS SET TO ZERO    */
*/*     TO INDICATE THAT THE DEVICE IS VALID.  IF IT IS NOT ONLINE,  */
*/*     THE ROUTINE THAT CHECKS FOR AN AVAILABLE DATA PATH TO THE    */
*/*     DEVICE IS CALLED (IF IT IS LOADED).  IF THE RETURN CODE IS   */
*/*     ZERO, 'BADADDR' IS SET TO ZERO TO INDICATE THAT THE DEVICE   */
*/*     IS VALID.                                                    */
*/*                                                                  */
*/*     THE REASON CODE IN MESSAGE IEA852I IS SET WHEN:              */
*/*         1. THE DATA PATH FIND ROUTINE IS NOT LOADED.             */
*/*         2. THERE IS NO AVAILABLE DATA PATH TO THE DEVICE.        */
*/*         3. THERE IS NO OPERATIONAL PATH TO THE DEVICE.           */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         THE UCB FOR THE DEVICE ADDRESS IN THE REPLY              */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - THE UCB IS ONLINE OR A DATA PATH IS AVAILABLE    */
*/*                 TO THE DEVICE                                    */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         BADADDR - SET TO ZERO                                    */
*/*                                                                  */
*/*     CONDITION - NO DATA PATH IS AVAILABLE                        */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         R852 - IS SET TO 7                                       */
*/*                                                                  */
*/*     CONDITION - THERE IS NO OPERATIONAL PATH TO THE DEVICE       */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         R852 - IS SET TO 8                                       */
*/*                                                                  */
*/*     CONDITION - THE ROUTINE THAT CHECKS FOR A DATA PATH IS NOT   */
*/*                 LOADED                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         R852 - IS SET TO 6                                       */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               06S0900
*IF UCBONLI ¬= YES                                              06S0900
*  THEN DO;                            /* IF THE UCB IS OFFLINE, AND */
         TM    UCBONLI(@05),B'10000000'                         06S0900
         BO    @RF00900                                         06S0900
*    IF DPLOADED = YES                 /* THE DATA PATH ROUTINE IS   */
*      THEN DO;                        /* LOADED, THEN EXECUTE RTN.  */
         TM    DPLOADED,B'01000000'                             06S0902
         BNO   @RF00902                                         06S0902
*        RFY (RPARM) RSTD;                                      06S0904
*        DPPLIST = ADDR(DPPARM);       /* SET PARAMETER LIST         */
         LA    @10,DPPARM                                       06S0905
         ST    @10,DPPLIST                                      06S0905
*        RPARM = ADDR(DPPLIST);        /* PASS PARM LIST ADDR IN R1. */
         LA    RPARM,DPPLIST                                    06S0906
*        DPUCB = UCBPTR;               /* PUT UCB ADDR IN PARM LIST. */
         ST    @05,DPUCB                                        06S0907
*        RFY (RCODE) RSTD;                                      06S0908
*        RCODE = DATAPATH;             /* IS DATA PATH AVAIL TO DEV? */
         L     RCODE,DATAPATH                                   06S0909
*        GEN SETS(RCODE,REXIT) (BALR REXIT,RCODE);              06S0910
         BALR REXIT,RCODE
*        RFY (RPARM) UNRSTD;                                    06S0911
*        IF RCODE = ZERO               /* IF RETURN CODE IS ZERO,    */
*          THEN BADADDR = ZEROADDR;    /* PATH IS AVAIL, RESET ERROR */
         LTR   RCODE,RCODE                                      06S0912
         BNZ   @RF00912                                         06S0912
         MVC   BADADDR(3),ZEROADDR                              06S0913
*          ELSE IF RCODE > FOUR        /* INDIC.; IF > 4 NO OPERA-   */
*            THEN R852 = REASON8;      /* TIONAL PATH; IF 4 NO DATA  */
         B     @RC00912                                         06S0914
@RF00912 CH    RCODE,@CH00036                                   06S0914
         BNH   @RF00914                                         06S0914
         MVC   R852(2),@CC02494                                 06S0915
*            ELSE R852 = REASON7;      /* PATH AVAIL.                */
         B     @RC00914                                         06S0916
@RF00914 MVC   R852(2),@CC02492                                 06S0916
*        RFY RCODE UNRSTD;                                      06S0917
@RC00914 DS    0H                                               06S0917
@RC00912 DS    0H                                               06S0918
*      END;                                                     06S0918
*      ELSE R852 = REASON6;            /* DATA PATH RTN. NOT LOADED. */
         B     @RC00902                                         06S0919
@RF00902 MVC   R852(2),@CC02490                                 06S0919
*  END;                                                         06S0920
*  ELSE BADADDR = ZEROADDR;            /* IF ONLINE, DEV IS VALID.   */
         B     @RC00900                                         06S0921
@RF00900 MVC   BADADDR(3),ZEROADDR                              06S0921
*                                      /* RETURN TO UCBFIND.         */
*                          END;        /* ELSE TOO MANY OF THIS TYPE */
*                          ELSE R852 = REASON5; /* REPLIED.          */
         B     @RC00897                                         05S0923
@RF00897 MVC   R852(2),@CC02488                                 05S0923
*                      END;                                     05S0924
@RC00897 DS    0H                                               05S0925
*                  END;                                         05S0925
@RF00894 LA    @10,1                                            05S0925
         AH    @10,J                                            05S0925
         STH   @10,J                                            05S0925
         CH    @10,@CH00075                                     05S0925
         BNH   @DL00893                                         05S0925
@DC00893 DS    0H                                               05S0926
*                  IF FOUND = NO       /* TYPE NOT NEEDED FOR MOUNT. */
*                    THEN R852 = REASON5;                       05S0926
         TM    FOUND,B'00000010'                                05S0926
         BNZ   @RF00926                                         05S0926
         MVC   R852(2),@CC02488                                 05S0927
*                END;                                      /*@YM02792*/
*            END;                                               05S0929
*            ELSE R852 = REASON3;      /* DEVICE IS RESERVED         */
         B     @RC00869                                         05S0930
@RF00869 MVC   R852(2),@CC02484                                 05S0930
*          ELSE R852 = REASON11;       /* DEVICE IS VIRTUAL   Y30LPPD*/
         B     @RC00868                                         05S0931
@RF00868 MVC   R852(2),@CC02500                                 05S0931
*        ELSE R852 = REASON4;          /* DEVICE NOT DIRECT ACCESS   */
         B     @RC00867                                         05S0932
@RF00867 MVC   R852(2),@CC02486                                 05S0932
*    END;                                                       05S0933
*    ELSE R852 = REASON2;              /* REASON CODE - NO UCB       */
         B     @RC00861                                         05S0934
@RF00861 MVC   R852(2),@CC02482                                 05S0934
*  IF BADADDR = ZEROADDR               /* IF UCB IS VALID, THEN      */
*    THEN DEVCT(K) = (DEVCT(K) - ONE); /* DECRE. DEVS TO CK. @YM01529*/
@RC00861 CLC   BADADDR(3),ZEROADDR                              05S0935
         BNE   @RF00935                                         05S0935
         LH    @10,K                                            05S0936
         MH    @10,@CH01793                                     05S0936
         LH    @05,DEVCT-14(@10)                                05S0936
         BCTR  @05,0                                            05S0936
         STH   @05,DEVCT-14(@10)                                05S0936
*    ELSE DO;                          /* ELSE SEND ERROR MSG TO     */
         B     @RC00935                                         05S0937
@RF00935 DS    0H                                               05S0938
*                                      /* OPERATOR.                  */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - REASON                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ISSUE INVALID DEVICE MESSAGE TO OPERATOR      */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     'MSG2' SWITCH IS SET ON TO INDICATE THAT THE REPEAT REPLY    */
*/*     MESSAGE IS TO BE ISSUED.  THE INVALID DEVICE ADDRESS IS      */
*/*     MOVED INTO THE MESSAGE TEXT AND IEA852I IS ISSUED.           */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         BADADDR - CONTAINS THE INVALID DEVICE ADDRESS            */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA852I IS ISSUED                                */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               06S0938
*MSG2 = YES;                           /* INDIC. REPEAT REPLY MSG.   */
         OI    MSG2,B'00001000'                                 06S0938
*DEV852 = BADADDR;                     /* PUT DEV ADDR IN MSG.       */
         MVC   DEV852(3),BADADDR                                06S0939
*GEN REFS (NVTWTO);                    /* ISSUE ERROR MESSAGE.       */
 IEAPMNIP TYPE=WTO,PARAM=IEA852I
*                                      /* RET TO UCBFIND OR CHECKDUP */
*    END;                                                       05S0941
*END;                                  /* RETURN TO CHECKUCB.        */
@RC00935 LA    @10,1                                            05S0942
         AH    @10,I                                            05S0942
@DE00855 STH   @10,I                                            05S0942
         CH    @10,TOMOUNT                                      05S0942
         BNH   @DL00855                                         05S0942
*END;                                                           04S0943
*IF TOMOUNT > ONE THEN                 /* IF MORE THAN ONE DEVICE;   */
         LA    @10,1                                            04S0944
         CH    @10,TOMOUNT                                      04S0944
         BNL   @RF00944                                         04S0944
*  DO;                                                          04S0945
*    BADADDR = ZEROADDR;               /* RESET VALID DEVICE INDIC.  */
         MVC   BADADDR(3),ZEROADDR                              04S0946
*    DO;                               /* CHECK FOR DUPLICATE DEVICE */
*                                      /* IN REPLY.                  */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CHECKDUP                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHECK FOR DUPLICATE DEVICE ADDRESS WITHIN     */
*/*                    THE REPLY                                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     ALL OF THE DEVICE ADDRESSES REPLIED ARE CHECKED FOR DUPLICA- */
*/*     TION.  IF A DUPLICATE IS FOUND, IT IS PLACED IN 'BADADDR',   */
*/*     AND THE REASON CODE IN MESSAGE TEXT IEA852I IS SET TO 1.     */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         REPLAREA - CONTAINS THE DEVICE REPLY                     */
*/*         BADADDR - SET TO ZERO                                    */
*/*         TOMOUNT - CONTAINS NUMBER OF DEVICES IN REPLY            */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA - NONE                                           */
*/*                                                                  */
*/*     CONDITION - DUPLICATE FOUND IN REPLY                         */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         BADADDR - CONTAINS THE INVALID ADDRESS                   */
*/*         R852I - SET TO 1                                         */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               05S0948
*DO CHECK = ONE TO (TOMOUNT - ONE);    /* CHECK EACH DEV WITH REMAIN-*/
         B     @DE00948                                         05S0948
@DL00948 DS    0H                                               05S0949
*  DO SCAN = (CHECK + ONE) TO TOMOUNT; /* ING DEVS IN REPLY, TO SEE  */
         AH    @10,@CH00042                                     05S0949
         B     @DE00949                                         05S0949
@DL00949 DS    0H                                               05S0950
*    IF UNIT(CHECK) = UNIT(SCAN)       /* IF A DUPLICATE IS FOUND.   */
*      THEN DO;                        /* IF IT IS THEN              */
         LH    @05,CHECK                                        05S0950
         SLA   @05,2                                            05S0950
         SLA   @10,2                                            05S0950
         LA    @01,UNIT-4(@05)                                  05S0950
         LA    @05,UNIT-4(@10)                                  05S0950
         CLC   0(3,@01),0(@05)                                  05S0950
         BNE   @RF00950                                         05S0950
*        BADADDR = UNIT(SCAN);         /* SAVE THE INVALID DEV ADDR  */
         LA    @05,UNIT-4(@10)                                  05S0952
         MVC   BADADDR(3),0(@05)                                05S0952
*        R852 = REASON1;               /* AND SET REASON CODE.       */
         MVC   R852(2),@CC02480                                 05S0953
*        DO;                           /* SEND MSG TO OPERATOR.      */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - REASON                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ISSUE INVALID DEVICE MESSAGE TO OPERATOR      */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     'MSG2' SWITCH IS SET ON TO INDICATE THAT THE REPEAT REPLY    */
*/*     MESSAGE IS TO BE ISSUED.  THE INVALID DEVICE ADDRESS IS      */
*/*     MOVED INTO THE MESSAGE TEXT AND IEA852I IS ISSUED.           */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         BADADDR - CONTAINS THE INVALID DEVICE ADDRESS            */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA852I IS ISSUED                                */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               06S0955
*MSG2 = YES;                           /* INDIC. REPEAT REPLY MSG.   */
         OI    MSG2,B'00001000'                                 06S0955
*DEV852 = BADADDR;                     /* PUT DEV ADDR IN MSG.       */
         MVC   DEV852(3),BADADDR                                06S0956
*GEN REFS (NVTWTO);                    /* ISSUE ERROR MESSAGE.       */
 IEAPMNIP TYPE=WTO,PARAM=IEA852I
*                                      /* RET TO UCBFIND OR CHECKDUP */
*        END;                                                   05S0958
*      END;                                                     05S0959
*  END;                                                         05S0960
@RF00950 LA    @10,1                                            05S0960
         AH    @10,SCAN                                         05S0960
@DE00949 STH   @10,SCAN                                         05S0960
         CH    @10,TOMOUNT                                      05S0960
         BNH   @DL00949                                         05S0960
*END;                                                           05S0961
         LA    @10,1                                            05S0961
         AH    @10,CHECK                                        05S0961
@DE00948 STH   @10,CHECK                                        05S0961
         LH    @05,TOMOUNT                                      05S0961
         BCTR  @05,0                                            05S0961
         CR    @10,@05                                          05S0961
         BNH   @DL00948                                         05S0961
*                                      /* RETURN TO CHECKUCB.        */
*    END;                                                       04S0962
*  END;                                                         04S0963
*IF MSG2 = NO                          /* IF UCBS ARE VALID AND      */
*  THEN DO;                            /* THERE ARE NO DUPS IN REPLY */
@RF00944 TM    MSG2,B'00001000'                                 04S0964
         BNZ   @RF00964                                         04S0964
*    GOODLIST = YES;                   /* THEN SET VALID REPLY INDIC */
*    NODEV = YES;                      /* AND TERM. REPLY PROCESSING.*/
         OI    GOODLIST,B'00010100'                             04S0967
*  END;                                                         04S0968
*  ELSE DO;                            /* IF ERROR WAS FOUND,        */
         B     @RC00964                                         04S0969
@RF00964 DS    0H                                               04S0970
*    DO I = SIX TO ONE BY - ONE;                                04S0970
         LA    @10,6                                            04S0970
         STH   @10,I                                            04S0970
@DL00970 DS    0H                                               04S0971
*      DEVCT(I) = AUXCT(I);            /* RESET DEV TYPE COUNTERS.   */
         LR    @05,@10                                          04S0971
         MH    @05,@CH01793                                     04S0971
         LH    @15,AUXCT-14(@05)                                04S0971
         STH   @15,DEVCT-14(@05)                                04S0971
*    END;                                                       04S0972
         BCTR  @10,0                                            04S0972
         STH   @10,I                                            04S0972
         LTR   @10,@10                                          04S0972
         BP    @DL00970                                         04S0972
*    GEN REFS (NVTWTOR);               /* ISSUE REPEAT REPLY MSG.    */
     IEAPMNIP TYPE=WTOR,PARAM=IEA852A
*  END;                                                         04S0974
*                                      /* RETURN TO DEVREPLY.        */
*  END;                                                         03S0975
@RC00964 DS    0H                                               03S0976
*                                      /* RETURN TO CKREPLY.         */
*  END;                                                         02S0976
@RC00849 DS    0H                                               02S0977
*                                      /* RETURN TO TOP SEGMENT.     */
*    END;                                                       01S0977
@RC00817 DS    0H                                               01S0977
@DE00816 TM    NODEV,B'00010000'                                01S0977
         BZ    @DL00816                                         01S0977
*    IF GOODLIST = YES                 /* IF THE OPERATOR REPLY IS   */
*      THEN DO;                        /* VALID,                     */
         TM    GOODLIST,B'00000100'                             01S0978
         BNO   @RF00978                                         01S0978
*        DO;                           /* PREPARE FOR VOL MOUNTING   */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - RDYUCB                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - PREPARE THE UCB'S TO RECEIVE VOLUMES          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     THE UCBFN MACRO IS ISSUED FOR EACH DEVICE IN THE REPLY TO    */
*/*     FIND THE CORRESPONDING UCB ADDRESS.  THE DEVICE ADDRESS AND  */
*/*     UCB ADDRESS ARE PLACED IN 'DEVTABLE'.  THE VOLUME SERIAL IS  */
*/*     CLEARED IN THE UCB, THE TAG AND NOT-READY BITS ARE TURNED    */
*/*     ON, AND THE NUMBER OF ENTRIES IN 'DEVTABLE' IS SAVED IN      */
*/*     'TABLECT'.                                                   */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         REPLAREA - CONTAINS THE DEVICE ADDRESS REPLY             */
*/*         TOMOUNT - CONTAINS THE NUMBER OF DEVICES ON WHICH        */
*/*                   VOLUMES ARE TO BE MOUNTED                      */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB FIELDS ARE SET FOR VOLUME MOUNTING                   */
*/*         DEVTABLE IS BUILT                                        */
*/*         TABLECT - NUMBER OF ENTRIES IN DEVTABLE                  */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0981
*RFY NWTORLST BASED(ADDR(IEA8602));                             02S0981
*DO I = ONE TO TOMOUNT;                /* FOR EACH DEVICE IN THE     */
         LA    @10,1                                            02S0982
         B     @DE00982                                         02S0982
@DL00982 DS    0H                                               02S0983
*  FINDDEV = UNIT(I);                  /* REPLY, FIND THE CORRESPOND-*/
         SLA   @10,2                                            02S0983
         LA    @05,UNIT-4(@10)                                  02S0983
         MVC   FINDDEV(3),0(@05)                                02S0983
*  RFY (RPARM) RSTD;                   /* ING UCB ADDRESS.           */
*  RPARM = FINDADDR;                                            02S0985
         L     RPARM,FINDADDR                                   02S0985
*  GEN REFS(NVTUCBFN) (IEAPMNIP TYPE=UCBFN,PARAM=RPARM);        02S0986
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM
*  UCBPTR = RPARM;                                              02S0987
         ST    RPARM,UCBPTR                                     02S0987
*  RFY (RPARM) UNRSTD;                                          02S0988
*  UCBVOLI = ZEROVOLI;                 /* CLEAR THE VOL SER IN UCB.  */
         L     @10,UCBPTR                                       02S0989
         MVC   UCBVOLI(6,@10),ZEROVOLI                          02S0989
*  UCBVTOC = ZEROVTOC;                 /* CLEAR VTOC TTR             */
         MVC   UCBVTOC(4,@10),ZEROVTOC                          02S0990
*  UCBPRSRS = YES;                     /* TURN ON TAG BIT.           */
         OI    UCBPRSRS(@10),B'00100000'                        02S0991
*  UCBNOTRD = YES;                     /* TURN ON NOT-READY BIT.     */
         OI    UCBNOTRD(@10),B'01000000'                        02S0992
*  DEVICE(I) = UNIT(I);                /* BUILD THE DEVTABLE: DEVICE */
         LH    @05,I                                            02S0993
         LR    @15,@05                                          02S0993
         SLA   @15,3                                            02S0993
         LA    @14,DEVICE-8(@15)                                02S0993
         LR    @07,@05                                          02S0993
         SLA   @07,2                                            02S0993
         LA    @06,UNIT-4(@07)                                  02S0993
         MVC   0(3,@14),0(@06)                                  02S0993
*  UCBADDR(I) = UCBPTR;                /* PLUS UCB ADDRESS.          */
         ST    @10,UCBADDR-8(@15)                               02S0994
*END;                                                           02S0995
         AH    @05,@CH00042                                     02S0995
         LR    @10,@05                                          02S0995
@DE00982 STH   @10,I                                            02S0995
         CH    @10,TOMOUNT                                      02S0995
         BNH   @DL00982                                         02S0995
*TABLECT = TOMOUNT;                    /* SAVE NBR. TABLE ENTRIES.   */
*                                                               02S0996
         MVC   TABLECT(2),TOMOUNT                               02S0996
*IF EXCPSW = OFF                       /*SET UP EXCP IF NOT  @Y30LPPD*/
*  THEN CALL EXCPSETP;                 /*DONE ALREADY        @Y30LPPD*/
         TM    EXCPSW,B'00100000'                               02S0997
         BNZ   @RF00997                                         02S0997
         BAL   @14,EXCPSETP                                     02S0998
*        END;                                                   01S0999
@RF00997 DS    0H                                               01S1000
*        DO;                           /* ISSUE READY DEV MESSAGES.  */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - WTORMT                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ISSUE MESSAGE FOR DEVICES TO BE READIED       */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     SET 'DEVMTCT' EQUAL TO 'TOMOUNT'.  MOVE DEVICE ADDRESSES     */
*/*     FROM 'DEVTABLE' TO  MESSAGE TEXT.  ISSUE MESSAGE 'DDD,DDD,...*/
*/*     IEA860A REPLY U WHEN ALL DEVICES ARE READY.',        @YM02783*/
*/*     IF REPLY IS NOT U OR EOB, REPEAT MESSAGE.                    */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         DEVTABLE - CONTAINS DEVICE ADDRESSES FROM REPLY          */
*/*         TOMOUNT - NUMBER OF VOLS TO BE MOUNTED                   */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA860A                                          */
*/*         DEVMTCT - SET TO VALUE OF TOMOUNT                        */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1001
*DEVMTCT = TOMOUNT;                    /*INIT LOOP CONTROL COUNTER   */
*                                                               02S1001
         MVC   DEVMTCT(2),TOMOUNT                               02S1001
*DEV860 = BLANK;                       /*BLANK OUT MESSAGE AREA      */
*                                                               02S1002
         MVI   DEV860+1,C' '                                    02S1002
         MVC   DEV860+2(78),DEV860+1                            02S1002
         MVI   DEV860,C' '                                      02S1002
*I = ZERO;                             /*INDEX THROUGH MESSAGE AREA  */
         SLR   @10,@10                                          02S1003
         STH   @10,I                                            02S1003
*DO DEVIND = ONE TO TABLECT;           /*LOOP THROUGH DEVTABLE       */
         LA    @10,1                                            02S1004
         B     @DE01004                                         02S1004
@DL01004 DS    0H                                               02S1005
*      I = I + ONE;                                             02S1005
         LA    @05,1                                            02S1005
         AH    @05,I                                            02S1005
         STH   @05,I                                            02S1005
*      UNITAD(I) = DEVICE(DEVIND);     /*MOVE ENTRY INTO MESSAGE AREA*/
         SLA   @05,2                                            02S1006
         LA    @15,DEV860                                       02S1006
         ALR   @15,@05                                          02S1006
         AL    @15,@CF02680                                     02S1006
         LR    @05,@10                                          02S1006
         SLA   @05,3                                            02S1006
         LA    @14,DEVICE-8(@05)                                02S1006
         MVC   UNITAD(3,@15),0(@14)                             02S1006
*END;                                                           02S1007
         AH    @10,@CH00042                                     02S1007
@DE01004 STH   @10,DEVIND                                       02S1007
         CH    @10,TABLECT                                      02S1007
         BNH   @DL01004                                         02S1007
*IF I > ONE THEN                       /*IF THERE IS MORE THAN ONE
*                                        DEVICE IN MESSAGE AREA THEN */
         LA    @10,1                                            02S1008
         CH    @10,I                                            02S1008
         BNL   @RF01008                                         02S1008
*  DO J= ONE TO (I-ONE);                                        02S1009
         B     @DE01009                                         02S1009
@DL01009 DS    0H                                               02S1010
*    COM(J) = COMMA;                   /*INSERT COMMAS               */
         LR    @05,@10                                          02S1010
         SLA   @05,2                                            02S1010
         LA    @15,DEV860                                       02S1010
         ALR   @15,@05                                          02S1010
         BCTR  @15,0                                            02S1010
         MVI   COM-3(@15),C','                                  02S1010
*  END;                                                         02S1011
*                                                               02S1011
         AH    @10,@CH00042                                     02S1011
@DE01009 STH   @10,J                                            02S1011
         LH    @05,I                                            02S1011
         BCTR  @05,0                                            02S1011
         CR    @10,@05                                          02S1011
         BNH   @DL01009                                         02S1011
*BADREPLY=YES;                                             /*@YM02783*/
@RF01008 OI    BADREPLY,B'10000000'                             02S1012
*DO WHILE BADREPLY = YES;              /*REPLY LOOP FOR      @YM02783*/
         B     @DE01013                                         02S1013
@DL01013 DS    0H                                               02S1014
*  BADREPLY = NO;                      /*IEA860A             @YM02783*/
         NI    BADREPLY,B'01111111'                             02S1014
*  GEN REFS(NVTWTO,NVTWTOR);           /*ISSUE MESSAGE               */
*        DDD,DDD,...
         IEAPMNIP TYPE=WTO,PARAM=IEA860A
*        IEA860A REPLY U WHEN ALL DEVICES ARE READY.           @YM02783
         IEAPMNIP TYPE=WTOR,PARAM=IEA8602
*  IF SCAN2¬=REPLYU & SCAN2¬=REPLYEOB  /*CHECK FOR REPLY     @YM02783*/
*    THEN BADREPLY=YES;                /*OF U OR EOB         @YM02783*/
         CLC   SCAN2(2),@CC00168                                02S1016
         BE    @RF01016                                         02S1016
         CLC   SCAN2(2),@CC00170                                02S1016
         BE    @RF01016                                         02S1016
         OI    BADREPLY,B'10000000'                             02S1017
*END;                                                      /*@YM02783*/
@RF01016 DS    0H                                               02S1018
@DE01013 TM    BADREPLY,B'10000000'                             02S1018
         BO    @DL01013                                         02S1018
*        END;                                                   01S1019
*        DO WHILE DEVMTCT > ZERO;      /* PROCESS READIED VOLUMES.   */
         B     @DE01020                                         01S1020
@DL01020 DS    0H                                               01S1021
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - TESTRDY                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SCAN FOR READY UCB'S                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     IF THE UCB RETURNED BY IEFSCAN IS READY, AND THE VOLUME      */
*/*     SERIAL FIELD IS ZERO,  THE EXCP TO READ THE VOLUME SERIAL    */
*/*     IS SET UP AND THE SEGMENT THAT ISSUES THE EXCP IS EXECUTED.  */
*/*                                                                  */
*/*     WHEN A COMPLETE SCAN OF THE UCB'S HAS BEEN MADE, 'DEVMTCT'   */
*/*     IS UPDATED TO THE VALUE IN 'TOMOUNT'.MESSAGE IEA893A @YM02783*/
*/*     IS ISSUED AND THE REPLY IS EXAMINED. IF THE REPLY IS @YM02783*/
*/*     NO,THEN SCANNING OF UCB'S TERMINATES AND VAP         @YM02783*/
*/*     PREPARES TO EXIT.IF THE REPLY IS U OR EOB,           @YM02783*/
*/*     THEN THE VOLUMES LISTED IN THE MESSAGE ARE READY AND @YM02783*/
*/*     VAP SCANS THE UCB'S AGAIN.IF THE REPLY IS INVALID,   @YM02783*/
*/*     MESSAGE IEA893A IS REISSUED.                         @YM02783*/
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA - NONE                                            */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         EXCP - SET UP TO READ IF UCB IS READY AND VOLUME         */
*/*                SERIAL FIELD IS ZERO                              */
*/*         DEVMTCT - UPDATED                                        */
*/*         MESSAGE IEA893A                                          */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*RFY RPARM RSTD;                                                02S1021
*RPARM = LUTSAVE;                      /*MOVE LUT ADDR INTO PARM REG */
         L     RPARM,LUTSAVE                                    02S1022
*CALL IEFSCAN;                         /*OBTAIN UCB ADDRESS          */
         L     @15,@CV00229                                     02S1023
         BALR  @14,@15                                          02S1023
*UCBPTR= RPARM;                        /*SAVE ADDRESS OF UCB         */
         ST    RPARM,UCBPTR                                     02S1024
*RFY RPARM UNRSTD;                                              02S1025
*                                                               02S1025
*DO WHILE (UCBPTR¬= ZERO);             /*PROCESS UCBS - ZERO UCB ADDR
*                                        INDICATES END OF UCBS       */
         B     @DE01026                                         02S1026
@DL01026 DS    0H                                               02S1027
*  IF UCB3DACC = YES &                 /*IF UCB IS DIRECT ACCESS,    */
*    UCBNOTRD = NO &                   /*AND IS READY, AND HAS       */
*    UCBVOLI = ZEROVOLI                /*ZERO VOL SER NUMBER,        */
*    THEN DO;                          /*AND IS NOT A MULTIPLE       */
         L     @10,UCBPTR                                       02S1027
         TM    UCB3DACC(@10),B'00100000'                        02S1027
         BNO   @RF01027                                         02S1027
         TM    UCBNOTRD(@10),B'01000000'                        02S1027
         BNZ   @RF01027                                         02S1027
         CLC   UCBVOLI(6,@10),ZEROVOLI                          02S1027
         BNE   @RF01027                                         02S1027
*      IF UCBMTPXP = NO | (UCBBASE + ADJBASE) = UCBPTR     /*@YM02792*/
*        THEN DO;                      /*EXPOSURE DEVICE, OR @YM02792*/
         TM    UCBMTPXP(@10),B'00001000'                        02S1029
         BZ    @RT01029                                         02S1029
         LA    @05,512                                          02S1029
         AL    @05,UCBBASE(,@10)                                02S1029
         CR    @05,@10                                          02S1029
         BNE   @RF01029                                         02S1029
@RT01029 DS    0H                                               02S1030
*                                      /*IS THE              @YM02792*/
*                                      /*BASE EXPOSURE, THEN @YM02792*/
*                                      /*SET UP FOR EXCP:            */
*          DEBUCBA = UCBPTR;           /*UCB ADDRESS                 */
         L     @10,DEBDAPTR                                     02S1031
         MVC   DEBUCBA(3,@10),UCBPTR+1                          02S1031
*          ECB = ZERO;                 /*CLEAR ECB                   */
         SLR   @10,@10                                          02S1032
         L     @05,ECBPTR                                       02S1032
         ST    @10,ECB(,@05)                                    02S1032
*          LABELBUF = BLANK;           /*CLEAR LABEL READ AREA.      */
         MVI   LABELBUF+1,C' '                                  02S1033
         MVC   LABELBUF+2(78),LABELBUF+1                        02S1033
         MVI   LABELBUF,C' '                                    02S1033
*                                      /*READ VOLUME LABEL           */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - READSER                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - READ SERIAL OF THE VOLUME MOUNTED             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     THE MESSAGE INDICATOR 'ERRMSG' IS INITIALIZED TO ZERO, AND   */
*/*     AN EXCP IS ISSUED TO READ THE SERIAL OF THE VOLUME MOUNTED.  */
*/*     IF AN I/O ERROR OCCURS, THE NOT-READY BIT IN THE UCB IS      */
*/*     TURNED ON AND 'ERRMSG' IS SET TO 1.  IF THE READ IS SUCCESS- */
*/*     FUL, THE VOLUME SERIAL IS CHECKED FOR DUPLICATION.  IF THE   */
*/*     VOLUME SERIAL IS FOUND TO BE ALREADY MOUNTED, THE NOT-READY  */
*/*     BIT IS TURNED ON IN THE UCB AND 'ERRMSG' IS SET TO 2.  IF    */
*/*     THE VOLUME SERIAL IS NOT A DUPLICATE, THE SEGMENT WHICH      */
*/*     CHECKS FOR THE VOLUME SERIAL IN THE MOUNT LIST IS EXECUTED.  */
*/*                                                                  */
*/*     IF THE NOT-READY BIT HAS NOT BEEN TURNED ON IN THE UCB, THE  */
*/*     VOLUME SERIAL AND THE TTR ARE MOVED IN.                      */
*/*                                                                  */
*/*     IF 'ERRMSG' HAS BEEN SET, THE SEGMENT THAT HANDLES THE ERROR */
*/*     PROCESSING IS EXECUTED.                                      */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         EXCP - SET UP TO READ                                    */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*                                                                  */
*/*     CONDITION - I/O ERROR READING VOLUME SERIAL                  */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*         ERRMSG - SET TO 1                                        */
*/*                                                                  */
*/*     CONDITION - DUPLICATE VOLUME                                 */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*         ERRMSG - SET TO 2                                        */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               03S1034
*ERRMSG = ZERO;                        /*INITIALIZE ERROR INDICATOR  */
         ST    @10,ERRMSG                                       03S1034
*RFY RPARM RSTD;                                                03S1035
*RPARM = IOBSTPTR;                     /*ADDRESS OF IOB              */
         L     RPARM,IOBSTPTR                                   03S1036
*GEN REFS(RPARM) SETS(RPARM)                                    03S1037
*(EXCP (RPARM));                       /*ISSUE EXCP                  */
*                                                               03S1037
         EXCP (RPARM)
*RPARM = ECBPTR;                       /*ADDRESS OF ECB              */
         L     RPARM,ECBPTR                                     03S1038
*GEN REFS(RPARM) SETS(REG0,RPARM)                               03S1039
*(WAIT ECB=(RPARM));                   /*AWAIT I/O COMPLETION        */
*                                                               03S1039
         WAIT ECB=(RPARM)
*IF ECBCC ¬= GOODPOST |                /*IF ERROR IN EXCP OR         */
*  VOL1 ¬= COMPVOL1                    /*NO STANDARD LABEL,          */
*  THEN DO;                                                     03S1040
         L     @10,ECBPTR                                       03S1040
         CLI   ECBCC(@10),X'7F'                                 03S1040
         BNE   @RT01040                                         03S1040
         CLC   VOL1(4),@CC00130                                 03S1040
         BE    @RF01040                                         03S1040
@RT01040 DS    0H                                               03S1041
*    IOBFLAG1 = IOBFLAGS;              /*RE-INIT CHAINING AND   03S1042
*                                        UNRELATED REQUEST FLAGS,    */
         L     @10,IOBSTPTR                                     03S1042
         MVI   IOBFLAG1(@10),X'42'                              03S1042
*    UCBNOTRD = YES;                   /*UNLOAD DEVICE, AND          */
         L     @10,UCBPTR                                       03S1043
         OI    UCBNOTRD(@10),B'01000000'                        03S1043
*    ERRMSG = ONE;                     /*INDICATE ERROR.             */
         MVC   ERRMSG(4),@CF00042                               03S1044
*  END;                                                         03S1045
*  ELSE DO;                                                     03S1046
         B     @RC01040                                         03S1046
@RF01040 DS    0H                                               03S1047
*    NMNTVS = VOLSER;                  /*MOVE VOLSER INTO PARM LIST
*                                        FOR NIPMOUNT ROUTINE        */
         LA    @10,NIPMNT                                       03S1047
         MVC   NMNTVS(6,@10),VOLSER                             03S1047
*    GEN REFS(NVTMOUNT,NIPMNT) SETS(RPARM)/*CHECK FOR DUP VOLUME     */
*    (IEAPMNIP TYPE=MOUNT,PARAM=NIPMNT,OPT=(,,,US));            03S1048
         IEAPMNIP TYPE=MOUNT,PARAM=NIPMNT,OPT=(,,,US)
*    IF RPARM ¬= ZERO                  /*ANOTHER VOLUME WITH SAME    */
*      THEN DO;                        /*SERIAL IS MOUNTED           */
         LTR   RPARM,RPARM                                      03S1049
         BZ    @RF01049                                         03S1049
*        RFY RPARM UNRSTD;                                      03S1051
*        UCBNOTRD = YES;               /*UNLOAD VOLUME               */
         L     @10,UCBPTR                                       03S1052
         OI    UCBNOTRD(@10),B'01000000'                        03S1052
*        ERRMSG = TWO;                 /*SET ERROR INDICATOR         */
         MVC   ERRMSG(4),@CF00069                               03S1053
*      END;                                                     03S1054
*      ELSE DO;                        /*SEE IF VOL IS IN MOUNT LIST */
         B     @RC01049                                         03S1055
@RF01049 DS    0H                                               03S1056
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CKVOLIST                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHECK THE MOUNT LIST FOR THE MOUNTED VOLUME   */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*                                                                  */
*/*     IF THE READIED VOLUME IS IN THE MOUNTLIST, THEN THE DEVICE   */
*/*     TYPE IS CHECKED.  IF THE DEVICE TYPE OF THE MOUNT LIST ENTRY */
*/*     DOESN'T MATCH THAT OF THE DEVICE, THEN THE VOLUME IS UNLOADED*/
*/*     AND 'ERRMSG' IS SET TO 5.                                    */
*/*                                                                  */
*/*     IF THE DEVICE TYPES MATCH, THEN IF THE READIED VOLUME IS IN  */
*/*     THE MOUNT LIST, AND THE TAG BIT IS ON IN THE UCB (INDICATOR  */
*/*     FOR REQUESTED DEVICE), THEN THE TAG BIT IS TURNED OFF, THE   */
*/*     SUBROUTINE THAT SETS THE ATTRIBUTES IS EXECUTED, THE DEVICE  */
*/*     ENTRY IN 'DEVTABLE' IS ZEROED, THE DEVICE IS SET ONLINE AND  */
*/*     'TOMOUNT' IS DECREMENTED.                                    */
*/*                                                                  */
*/*     IF THE VOLUME IS IN THE MOUNT LIST, BUT MOUNTED ON AN UNRE-  */
*/*     QUESTED DEVICE, THE NOT-READY BIT IS TURNED ON IN THE UCB    */
*/*     AND 'ERRMSG' IS SET TO 4.                                    */
*/*                                                                  */
*/*     IF THE VOLUME IS NOT IN THE MOUNT LIST, BUT IS MOUNTED ON A  */
*/*     REQUESTED DEVICE, THE NOT-READY BIT IS TURNED ON IN THE UCB  */
*/*     AND 'ERRMSG' IS SET TO 3.                                    */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         MNTLIST - MOUNT LIST                                     */
*/*         THE VOLUME SERIAL OF THE MOUNTED VOLUME                  */
*/*         DEVTABLE - THE DEVICE ADDRESSES AND CORRESPONDING        */
*/*                    UCB ADDRESSES                                 */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - VOLUME AND ENTRY DEVICE TYPES ARE NOT THE SAME   */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*         ERRMSG - SET TO 5                                        */
*/*                                                                  */
*/*     CONDITION - VOLUME IS IN MOUNT LIST AND ON A REQUESTED       */
*/*                 DEVICE                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*         DEVTABLE - ENTRY IS ZEROED                               */
*/*         TOMOUNT - UPDATED                                        */
*/*                                                                  */
*/*     CONDITION - VOLUME IS IN THE MOUNT LIST AND ON AN            */
*/*                 UNREQUESTED DEVICE                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*         ERRMSG - SET TO 4                                        */
*/*                                                                  */
*/*     CONDITION - VOLUME IS NOT IN THE MOUNT LIST BUT IS ON        */
*/*                 A REQUESTED DEVICE                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*         ERRMSG - SET TO 3                                        */
*/*                                                                  */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               04S1056
*FOUND = NO;                                                    04S1056
         NI    FOUND,B'11111101'                                04S1056
*DO I = ONE TO MTLSTCT WHILE (FOUND = NO);                      04S1057
         LA    @10,1                                            04S1057
         B     @DE01057                                         04S1057
@DL01057 TM    FOUND,B'00000010'                                04S1057
         BNZ   @DC01057                                         04S1057
*  IF MVOLSER(I) = VOLSER              /*DETERMINE IF VOLUME IS IN   */
*    THEN DO;                          /*THE MOUNTLIST               */
         LR    @05,@10                                          04S1058
         MH    @05,@CH00190                                     04S1058
         LA    @01,MVOLSER-22(@05)                              04S1058
         CLC   0(6,@01),VOLSER                                  04S1058
         BNE   @RF01058                                         04S1058
*      FOUND = YES;                                             04S1060
         OI    FOUND,B'00000010'                                04S1060
*      J = DEVENT(I);                  /*OBTAIN UNIT TYPE INDEX      */
         SLR   @15,@15                                          04S1061
         IC    @15,DEVENT-22(@05)                               04S1061
         STH   @15,J                                            04S1061
*      MNTIND = I;                                              04S1062
         STH   @10,MNTIND                                       04S1062
*      IF UCBTYPE(J) ¬= UCBTBYT4       /*IF UCB IS NOT SAME UNIT TYPE*/
*        THEN DO;                      /*AS MNTLIST ENTRY            */
         MH    @15,@CH01793                                     04S1063
         L     @10,UCBPTR                                       04S1063
         SLR   @05,@05                                          04S1063
         IC    @05,UCBTYPE-14(@15)                              04S1063
         MVC   @ZT00003+3(1),UCBTBYT4(@10)                      04S1063
         C     @05,@ZT00003                                     04S1063
         BE    @RF01063                                         04S1063
*          UCBNOTRD = YES;             /*UNLOAD THE DEVICE           */
         OI    UCBNOTRD(@10),B'01000000'                        04S1065
*          ERRMSG = FIVE;              /*SET ERROR MESSAGE INDICATOR */
         MVC   ERRMSG(4),@CF00073                               04S1066
*        END;                                                   04S1067
*    END;                                                       04S1068
@RF01063 DS    0H                                               04S1069
*END;                                                           04S1069
*                                                               04S1069
@RF01058 LA    @10,1                                            04S1069
         AH    @10,I                                            04S1069
@DE01057 STH   @10,I                                            04S1069
         CH    @10,MTLSTCT                                      04S1069
         BNH   @DL01057                                         04S1069
@DC01057 DS    0H                                               04S1070
*IF ERRMSG = ZERO                                               04S1070
*  THEN IF FOUND = YES                 /*IF VOL IN MOUNT LIST AND    */
         L     @10,ERRMSG                                       04S1070
         LTR   @10,@10                                          04S1070
         BNZ   @RF01070                                         04S1070
*    THEN IF UCBPRSRS = YES            /*DEVICE IS REQUESTED, THEN   */
         TM    FOUND,B'00000010'                                04S1071
         BNO   @RF01071                                         04S1071
*      THEN DO;                        /*REQUESTED VOL ON REQ. DEV.  */
         L     @10,UCBPTR                                       04S1072
         TM    UCBPRSRS(@10),B'00100000'                        04S1072
         BNO   @RF01072                                         04S1072
*        UCBONLI = YES;                /*MAKE UCB ONLINE AND         */
         OI    UCBONLI(@10),B'10000000'                         04S1074
*        UCBPRSRS = NO;                /*TURN OFF REQ. DEV. BIT.     */
         NI    UCBPRSRS(@10),B'11011111'                        04S1075
*        MAPAD = ADDR(MNTLIST(MNTIND));  /*MAPPING FOR MOUNT LIST    */
         LH    @10,MNTIND                                       04S1076
         MH    @10,@CH00190                                     04S1076
         LA    @10,MNTLIST-22(@10)                              04S1076
         ST    @10,MAPAD                                        04S1076
*        CALL SETSTAT;                 /*SET VOL ATTRIBUTES  @Y30LPPD*/
         BAL   @14,SETSTAT                                      04S1077
*        LOOPSW = NO;                                           04S1078
         NI    LOOPSW,B'11101111'                               04S1078
*        DO J = ONE TO TABLECT         /*LOOP THROUGH THE DEVTABLE   */
*          WHILE (LOOPSW = NO);                                 04S1079
         LA    @10,1                                            04S1079
         B     @DE01079                                         04S1079
@DL01079 TM    LOOPSW,B'00010000'                               04S1079
         BNZ   @DC01079                                         04S1079
*          IF UCBADDR(J) = UCBPTR      /*WHEN ENTRY IS FOUND         */
*            THEN DO;                                           04S1080
         SLA   @10,3                                            04S1080
         L     @05,UCBADDR-8(@10)                               04S1080
         C     @05,UCBPTR                                       04S1080
         BNE   @RF01080                                         04S1080
*              DEVICE(J) = ZEROADDR;   /*ZERO THE ENTRY              */
         LA    @05,DEVICE-8(@10)                                04S1082
         MVC   0(3,@05),ZEROADDR                                04S1082
*              LOOPSW = YES;                                    04S1083
         OI    LOOPSW,B'00010000'                               04S1083
*            END;                                               04S1084
*        END;                                                   04S1085
@RF01080 LA    @10,1                                            04S1085
         AH    @10,J                                            04S1085
@DE01079 STH   @10,J                                            04S1085
         CH    @10,TABLECT                                      04S1085
         BNH   @DL01079                                         04S1085
@DC01079 DS    0H                                               04S1086
*        TOMOUNT = TOMOUNT - ONE;      /*DECR CT OF VOLS TO BE MTD   */
         LH    @10,TOMOUNT                                      04S1086
         BCTR  @10,0                                            04S1086
         STH   @10,TOMOUNT                                      04S1086
*      END;                                                     04S1087
*      ELSE DO;                        /*REQ. VOL. ON UNREQ. DEVICE  */
         B     @RC01072                                         04S1088
@RF01072 DS    0H                                               04S1089
*        UCBNOTRD = YES;               /*UNLOAD VOLUME               */
         L     @10,UCBPTR                                       04S1089
         OI    UCBNOTRD(@10),B'01000000'                        04S1089
*        ERRMSG = FOUR;                /*SET ERROR CODE              */
         MVC   ERRMSG(4),@CF00036                               04S1090
*      END;                                                     04S1091
*    ELSE IF UCBPRSRS = YES            /*UNREQUESTED VOLUME ON       */
*      THEN DO;                        /*REQUESTED DEVICE            */
         B     @RC01071                                         04S1092
@RF01071 L     @10,UCBPTR                                       04S1092
         TM    UCBPRSRS(@10),B'00100000'                        04S1092
         BNO   @RF01092                                         04S1092
*        UCBNOTRD = YES;               /*UNLOAD VOLUME               */
         OI    UCBNOTRD(@10),B'01000000'                        04S1094
*        ERRMSG = THREE;               /*SET ERROR CODE              */
         MVC   ERRMSG(4),@CF00064                               04S1095
*      END;                                                     04S1096
*      END;                                                     03S1097
@RF01092 DS    0H                                               03S1097
@RC01071 DS    0H                                               03S1097
@RF01070 DS    0H                                               03S1098
*    IF UCBNOTRD = NO                  /*NO ERRORS WITH THIS VOLUME  */
*      THEN DO;                        /*SET UP FOR TTR CONVERT      */
@RC01049 L     @10,UCBPTR                                       03S1098
         TM    UCBNOTRD(@10),B'01000000'                        03S1098
         BNZ   @RF01098                                         03S1098
*        RFY (RTTR,RPARM,RCCHHR,REG4,RENTRY) RSTD;              03S1100
*        RPARM = DEBPTR;               /*ADDRESS OF DEB              */
         L     RPARM,DEBPTR                                     03S1101
*        MBB = ZERO;                   /*CLEAR BIN ADDRESS           */
         SLR   @14,@14                                          03S1102
         ST    @14,@TF00001                                     03S1102
         MVC   MBB(3),@TF00001+1                                03S1102
*        CCHHR = VOLVTOC;              /*VTOC CCHHR                  */
         MVC   CCHHR(5),VOLVTOC                                 03S1103
*        RENTRY = CVTPRLTV;            /*ADDR OF CONVERT ROUTINE     */
         L     @10,CVTPTR                                       03S1104
         L     RENTRY,CVTPRLTV(,@10)                            03S1104
*        GEN REFS(RCCHHR,RENTRY,RPARM,MBBCCHHR) /*CONVERT THE TTR    */
*            SETS(REXIT,RTTR,RCCHHR,REGSAVE,REG4);              03S1105
         STM   RPARM,RENTRY,REGSAVE      SAVE REGISTERS
         LA    REG4,REGSAVE
         LA    RCCHHR,MBBCCHHR
         BALR  REXIT,RENTRY              CONVERT ROUTINE
         LM    RPARM,RENTRY,0(4)         RESTORE REGS
*        UCBVTOC = RTTR;               /*PUT VTOC TTR INTO UCB       */
         L     @14,UCBPTR                                       03S1106
         ST    RTTR,UCBVTOC(,@14)                               03S1106
*        RFY (RCCHHR,RTTR,RPARM,REG4,RENTRY) UNRSTD;            03S1107
*        UCBVOLI = VOLSER;             /*MOVE VOLSER INTO UCB        */
         MVC   UCBVOLI(6,@14),VOLSER                            03S1108
*      END;                                                     03S1109
*  END;                                                         03S1110
@RF01098 DS    0H                                               03S1111
*IF ERRMSG > ZERO                      /*PROCESS ERRORS FOR THIS VOL */
*  THEN DO;                                                     03S1111
@RC01040 L     @10,ERRMSG                                       03S1111
         LTR   @10,@10                                          03S1111
         BNP   @RF01111                                         03S1111
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - ERRPROC                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - HANDLE VOLUME ERRORS                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     IF 'ERRMSG' IS 1, AND IT WAS AN I/O ERROR, ISSUE NIPSENSE    */
*/*     TO INFORM THE OPERATOR OF THE DEVICE ERROR.  MESSAGES        */
*/*     'IEA854I-ERROR READING VOLUME LABEL. IEA948I         @Y30LPPD*/
*/*     XXX NOW UNLOADED.' ARE ISSUED.                       @Y30LPPD*/
*/*                                                                  */
*/*     IF 'ERRMSG' IS 2, MESSAGE 'IEA867I-DUPLICATE VOLUME AAAAAA.  */
*/*     UNIT XXX NOW UNLOADED.' IS ISSUED.                           */
*/*                                                                  */
*/*     IF 'ERRMSG' IS 3, AND MESSAGE 'IEA859I-UNREQUESTED VOLUME.   */
*/*     UNIT XXX NOW UNLOADED.' IS ISSUED.                           */
*/*                                                                  */
*/*     IF 'ERRMSG' IS 4, MESSAGE 'IEA894I-REQUESTED VOLUME ON UNRE- */
*/*     QUESTED UNIT.  DDD NOW UNLOADED.' IS ISSUED.                 */
*/*                                                                  */
*/*     IF 'ERRMSG' IS 5, MESSAGES 'IEA866I VOLUME AAAAAA ON DDD     */
*/*     REQUIRED ON A UUUUUUUU.' AND 'IEA948I DDD NOW UNLOADED.'     */
*/*     ARE ISSUED.                                                  */
*/*                                                                  */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     PURPOSE - SEE FUNCTION                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         UCB ADDRESS                                              */
*/*         ERRMSG - SET TO INDICATE ERROR ENCOUNTERED               */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - ERRMSG IS SET TO 1                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         SENSE MESSAGE ISSUED IF DEVICE ERROR                     */
*/*         MESSAGE IEA854I ISSUED                                   */
*/*                                                                  */
*/*     CONDITION - ERRMSG IS SET TO 2                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA867I ISSUED                                   */
*/*                                                                  */
*/*     CONDITION - ERRMSG IS SET TO 3                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA859I IS ISSUED                                */
*/*                                                                  */
*/*     CONDITION - ERRMSG IS SET TO 4                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA894I IS ISSUED                                */
*/*                                                                  */
*/*     CONDITION - ERRMSG IS SET TO 5                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         MESSAGE IEA866I                                          */
*/*         MESSAGE IEA948I                                          */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               04S1113
*IF ERRMSG = ONE                       /*ERROR READING VOL SER NUMBER*/
*  THEN DO;                                                     04S1113
         CH    @10,@CH00042                                     04S1113
         BNE   @RF01113                                         04S1113
*    IF ECBCC ¬= GOODPOST              /*IF I/O ERROR FROM EXCP      */
*      THEN DO;                                                 04S1115
         L     @10,ECBPTR                                       04S1115
         CLI   ECBCC(@10),X'7F'                                 04S1115
         BE    @RF01115                                         04S1115
*        RFY RPARM RSTD;                                        04S1117
*        RPARM = IOBSTPTR;             /*ISSUE NIP SENSE TO          */
         L     RPARM,IOBSTPTR                                   04S1118
*        GEN REFS(NVTSENSE)            /*INFORM OP OF DEVICE ERROR   */
*        (IEAPMNIP TYPE=SENSE,PARAM=RPARM);                     04S1119
         IEAPMNIP TYPE=SENSE,PARAM=RPARM
*        RFY RPARM UNRSTD;                                      04S1120
*      END;                                                     04S1121
*    V948 = BLANK;                     /*REMOVE V FROM MSG   @Y30LPPD*/
@RF01115 MVI   V948,C' '                                        04S1122
*    DEV948 = UCBNAME;                                          04S1123
         L     @10,UCBPTR                                       04S1123
         MVC   DEV948(3),UCBNAME(@10)                           04S1123
*    GEN REFS(NVTWTO);                 /*ISSUE IEA854I + 948I@Y30LPPD*/
     IEAPMNIP TYPE=WTO,PARAM=IEA854I                           @Y30LPPD
     IEAPMNIP TYPE=WTO,PARAM=IEA948I                           @Y30LPPD
*    /*IEA854I ERROR READING VOLUME LABEL.                   @Y30LPPD*/
*    /*IEA948I DDD NOW UNLOADED.                             @Y30LPPD*/
*  END;                                                         04S1125
*IF ERRMSG = TWO                       /*DUPLICATE VOLUME SER NUMBER */
*  THEN DO;                                                     04S1126
@RF01113 CLC   ERRMSG(4),@CF00069                               04S1126
         BNE   @RF01126                                         04S1126
*    SER867 = VOLSER;                  /*MOVE VOLSER INTO MESSAGE    */
         MVC   SER867(6),VOLSER                                 04S1128
*    DEV867 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */
         L     @10,UCBPTR                                       04S1129
         MVC   DEV867(3),UCBNAME(@10)                           04S1129
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA867I);        04S1130
         IEAPMNIP TYPE=WTO,PARAM=IEA867I
*    /*IEA867I DUPLICATE VOLUME AAAAAA.UNIT XXX NOW UNLOADED.        */
*  END;                                                         04S1131
*IF ERRMSG = THREE                     /*UNREQUESTED VOLUME ON       */
*  THEN DO;                            /*REQUESTED DEVICE.           */
@RF01126 CLC   ERRMSG(4),@CF00064                               04S1132
         BNE   @RF01132                                         04S1132
*    DEV859 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */
         L     @10,UCBPTR                                       04S1134
         MVC   DEV859(3),UCBNAME(@10)                           04S1134
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA859I);        04S1135
         IEAPMNIP TYPE=WTO,PARAM=IEA859I
*    /*IEA859I UNREQUESTED VOLUME. UNIT XXX NOW UNLOADED.            */
*  END;                                                         04S1136
*IF ERRMSG = FOUR                      /*REQUESTED VOLUME ON         */
*  THEN DO;                            /*UNREQUESTED DEVICE.         */
@RF01132 CLC   ERRMSG(4),@CF00036                               04S1137
         BNE   @RF01137                                         04S1137
*    DEV894 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */
         L     @10,UCBPTR                                       04S1139
         MVC   DEV894(3),UCBNAME(@10)                           04S1139
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA894I);        04S1140
         IEAPMNIP TYPE=WTO,PARAM=IEA894I
*   /*IEA894I REQUESTED VOLUME ON UNREQUESTED DEVICE.XXX NOW UNLOADED*/
*  END;                                                         04S1141
*IF ERRMSG = FIVE                      /*UCB DEVICE TYPE DOES NOT    */
*  THEN DO;                            /*MATCH MNTLIST ENTRY         */
@RF01137 CLC   ERRMSG(4),@CF00073                               04S1142
         BNE   @RF01142                                         04S1142
*    SER866 = VOLSER;                  /*MOVE VOLSER INTO MESSAGE    */
         MVC   SER866(6),VOLSER                                 04S1144
*    DEV866 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */
         L     @10,UCBPTR                                       04S1145
         MVC   DEV866(3),UCBNAME(@10)                           04S1145
*    DT866 = ETYPE(J);                                          04S1146
         LH    @10,J                                            04S1146
         MH    @10,@CH01793                                     04S1146
         LA    @05,ETYPE-14(@10)                                04S1146
         MVC   DT866(8),0(@05)                                  04S1146
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA866I);        04S1147
         IEAPMNIP TYPE=WTO,PARAM=IEA866I
*    /*IEA866I VOLUME AAAAAA ON DDD REQUIRED ON A UUUUUUUU.          */
*    DEV948 = UCBNAME;                                          04S1148
         L     @10,UCBPTR                                       04S1148
         MVC   DEV948(3),UCBNAME(@10)                           04S1148
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA948I);        04S1149
         IEAPMNIP TYPE=WTO,PARAM=IEA948I
*    /*IEA948I XXX NOW UNLOADED.                                     */
*  END;                                                         04S1150
*  END;                                                         03S1151
@RF01142 DS    0H                                               03S1152
*        END;                                                   02S1152
@RF01111 DS    0H                                               02S1153
*    END;                                                       02S1153
@RF01029 DS    0H                                               02S1154
*  RFY RPARM RSTD;                                              02S1154
@RF01027 DS    0H                                               02S1155
*  RPARM = LUTSAVE;                    /*MOVE LUT ADDR INTO PARM REG */
         L     RPARM,LUTSAVE                                    02S1155
*  CALL UCBCONT;                       /*OBTAIN NEXT UCB ADDRESS     */
         L     @15,@CV00230                                     02S1156
         BALR  @14,@15                                          02S1156
*  UCBPTR = RPARM;                     /*SAVE ADDRESS OF UCB         */
         ST    RPARM,UCBPTR                                     02S1157
*  RFY RPARM UNRSTD;                                            02S1158
*END;                                                           02S1159
*                                                               02S1159
@DE01026 SLR   @10,@10                                          02S1159
         C     @10,UCBPTR                                       02S1159
         BNE   @DL01026                                         02S1159
*DEVMTCT = TOMOUNT;                    /*UPDATE LOOP CONTROL COUNTER */
         LH    @05,TOMOUNT                                      02S1160
         STH   @05,DEVMTCT                                      02S1160
*IF TOMOUNT > 0                        /*IF ALL VOLS HAVE    @YM02783*/
*  THEN DO;                            /*NOT COME READY,     @YM02783*/
         CR    @05,@10                                          02S1161
         BNH   @RF01161                                         02S1161
*    DEV860 = BLANK;                   /*PREPARE MSG         @YM02783*/
         MVI   DEV860+1,C' '                                    02S1163
         MVC   DEV860+2(78),DEV860+1                            02S1163
         MVI   DEV860,C' '                                      02S1163
*    I = ZERO;                                             /*@YM02783*/
         STH   @10,I                                            02S1164
*    DO DEVIND = ONE TO TABLECT;       /*LOOP THROUGH DEVTABL@YM02783*/
         LA    @10,1                                            02S1165
         B     @DE01165                                         02S1165
@DL01165 DS    0H                                               02S1166
*      IF DEVICE(DEVIND) ¬= ZEROADDR   /*IF ENTRY HAS NOT    @YM02783*/
*        THEN DO;                      /*BEEN MOUNTED, THEN  @YM02783*/
         SLA   @10,3                                            02S1166
         LA    @05,DEVICE-8(@10)                                02S1166
         CLC   0(3,@05),ZEROADDR                                02S1166
         BE    @RF01166                                         02S1166
*          I = I + ONE;                /*MOVE ENTRY INTO     @YM02783*/
         LA    @05,1                                            02S1168
         AH    @05,I                                            02S1168
         STH   @05,I                                            02S1168
*          UNITAD(I) = DEVICE(DEVIND); /*MESSAGE AREA        @YM02783*/
         SLA   @05,2                                            02S1169
         LA    @15,DEV860                                       02S1169
         ALR   @15,@05                                          02S1169
         AL    @15,@CF02680                                     02S1169
         LA    @05,DEVICE-8(@10)                                02S1169
         MVC   UNITAD(3,@15),0(@05)                             02S1169
*        END;                                              /*@YM02783*/
*    END;                                                  /*@YM02783*/
@RF01166 LA    @10,1                                            02S1171
         AH    @10,DEVIND                                       02S1171
@DE01165 STH   @10,DEVIND                                       02S1171
         CH    @10,TABLECT                                      02S1171
         BNH   @DL01165                                         02S1171
*IF I > ONE THEN                       /*IF MORE THAN ONE    @YM02783*/
         LA    @10,1                                            02S1172
         CH    @10,I                                            02S1172
         BNL   @RF01172                                         02S1172
*  DO J = ONE TO (I-ONE);              /*DEVICE IN MESSAGE,  @YM02783*/
         B     @DE01173                                         02S1173
@DL01173 DS    0H                                               02S1174
*    COM(J) = COMMA;                   /*INSERT COMMAS       @YM02783*/
         LR    @05,@10                                          02S1174
         SLA   @05,2                                            02S1174
         LA    @15,DEV860                                       02S1174
         ALR   @15,@05                                          02S1174
         BCTR  @15,0                                            02S1174
         MVI   COM-3(@15),C','                                  02S1174
*  END;                                                    /*@YM02783*/
         AL    @10,@CF00042                                     02S1175
@DE01173 STH   @10,J                                            02S1175
         LH    @05,I                                            02S1175
         BCTR  @05,0                                            02S1175
         CR    @10,@05                                          02S1175
         BNH   @DL01173                                         02S1175
*                                                          /*@YM02783*/
*BADREPLY = YES;                                           /*@YM02783*/
@RF01172 OI    BADREPLY,B'10000000'                             02S1176
*DO WHILE BADREPLY = YES;              /*ISSUE MESSAGE       @YM02783*/
         B     @DE01177                                         02S1177
@DL01177 DS    0H                                               02S1178
*  BADREPLY = NO;                      /*AND CHECK REPLY     @YM02783*/
         NI    BADREPLY,B'01111111'                             02S1178
*  GEN REFS(NVTWTO,NVTWTOR);                               /*@YM02783*/
*          DDD,DDD,...                                       @YM02783
           IEAPMNIP TYPE=WTO,PARAM=IEA860A                   @YM02783
*          IEA893A DEVICES NOT READY. REPLY U WHEN DEVICES   @YM02783
*          ARE READY OR NO TO CONTINUE.                      @YM02783
         IEAPMNIP TYPE=WTOR,PARAM=IEA893A                    @YM02783
*                                      /*                    @YM02783*/
*  IF SCAN2 = COMPNO                   /*IF REPLY IS NO,     @YM02783*/
*    THEN DEVMTCT = ZERO;              /*THEN STOP LOOPING   @YM02783*/
         CLC   SCAN2(2),@CC00138                                02S1180
         BNE   @RF01180                                         02S1180
         SLR   @10,@10                                          02S1181
         STH   @10,DEVMTCT                                      02S1181
*    ELSE IF SCAN2 ¬= REPLYU &         /*FOR VOLS TO COME    @YM02783*/
*                                      /*RDY INVALID REPLY   @YM02783*/
*      SCAN2 ¬= REPLYEOB                                        02S1182
*      THEN BADREPLY = YES;            /*SET SWITCH          @YM02783*/
         B     @RC01180                                         02S1182
@RF01180 CLC   SCAN2(2),@CC00168                                02S1182
         BE    @RF01182                                         02S1182
         CLC   SCAN2(2),@CC00170                                02S1182
         BE    @RF01182                                         02S1182
         OI    BADREPLY,B'10000000'                             02S1183
*END;                                                      /*@YM02783*/
@RF01182 DS    0H                                               02S1184
@RC01180 DS    0H                                               02S1184
@DE01177 TM    BADREPLY,B'10000000'                             02S1184
         BO    @DL01177                                         02S1184
*END;                                                           02S1185
*        END;                                                   01S1186
@RF01161 DS    0H                                               01S1186
@DE01020 SLR   @10,@10                                          01S1186
         CH    @10,DEVMTCT                                      01S1186
         BL    @DL01020                                         01S1186
*        DO;                           /* CLEANUP TAG BITS IN UCBS.  */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CLEANUP                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - TURN OFF TAG BITS IN UCB                      */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     IF ALL VOLUMES WERE NOT MOUNTED, THE TAG BIT IS TURNED OFF   */
*/*     IN ALL UCB'S CORRESPONDING TO NON-ZEROED 'DEVTABLE' ENTRIES. */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         DEVTABLE - THE DEVICE ADDRESSES AND CORRESPONDING        */
*/*                    UCB ADDRESSES                                 */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - ALL VOLUMES WERE NOT MOUNTED                     */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - UPDATED                                            */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1188
*IF TOMOUNT > ZERO                     /*IF ALL VOLS WERE NOT MOUNTED*/
*  THEN DO;                            /*THEN TURN OFF UCBPRSRS BIT  */
         CH    @10,TOMOUNT                                      02S1188
         BNL   @RF01188                                         02S1188
*    DO I = ONE TO TABLECT;            /*SCAN DEVTABLE               */
         LA    @10,1                                            02S1190
         B     @DE01190                                         02S1190
@DL01190 DS    0H                                               02S1191
*      IF DEVICE(I) ¬= ZEROADDR        /*FOR ANY UNMOUNTED DEVICE    */
*        THEN DO;                                               02S1191
         SLA   @10,3                                            02S1191
         LA    @05,DEVICE-8(@10)                                02S1191
         CLC   0(3,@05),ZEROADDR                                02S1191
         BE    @RF01191                                         02S1191
*          UCBPTR = UCBADDR(I);                                 02S1193
         L     @10,UCBADDR-8(@10)                               02S1193
         ST    @10,UCBPTR                                       02S1193
*          UCBPRSRS = NO;              /*TURN OFF REQUESTED DEV BIT  */
         NI    UCBPRSRS(@10),B'11011111'                        02S1194
*        END;                                                   02S1195
*    END;                                                       02S1196
@RF01191 LA    @10,1                                            02S1196
         AH    @10,I                                            02S1196
@DE01190 STH   @10,I                                            02S1196
         CH    @10,TABLECT                                      02S1196
         BNH   @DL01190                                         02S1196
*  END;                                                         02S1197
*        END;                                                   01S1198
@RF01188 DS    0H                                               01S1199
*      END;                                                     01S1199
*    IF DPLOADED = YES THEN                                     01S1200
@RF00978 TM    DPLOADED,B'01000000'                             01S1200
         BNO   @RF01200                                         01S1200
*      DO;                                                      01S1201
*          DO;/* DELETE EP(NIEEVDEV)*/                          01S1202
*          RESPECIFY (GPR00P)RESTRICTED;                        01S1203
*          GPR00P = ADDR(NIEEVDEV);/* ->ENTRY NAME*/            01S1204
         LA    GPR00P,NIEEVDEV                                  01S1204
*          SVC    (9);/* DELETE SVC*/                           01S1205
         SVC   9                                                01S1205
*          RESPECIFY (GPR00P)UNRESTRICTED;                      01S1206
*          END;/* DELETE EP(NIEEVDEV)*/                         01S1207
*      END;                                                     01S1208
*  END;                                                         01S1209
*                                                               01S1209
*                                                               01S1209
*    DECLARE /*GENERAL PURPOSE REGISTERS */                     01S1210
*      GPR15F FIXED(31) REG(15),                                01S1210
*      GPR00P PTR(31) REG(0),                                   01S1210
*      GPR01P PTR(31) REG(1);                                   01S1210
*                                                               01S1210
*    DECLARE /* COMMON VARIABLES */                             01S1211
*      I256C CHAR(256) BASED,                                   01S1211
*      I031F FIXED(31) BASED,                                   01S1211
*      I031P PTR(31)   BASED,                                   01S1211
*      I015F FIXED(15) BASED,                                   01S1211
*      I015P PTR(15)   BASED,                                   01S1211
*      I008P PTR(8)    BASED,                                   01S1211
*      I001C CHAR(1)   BASED;                                   01S1211
*RETURN;                               /* RETURN TO NIP CALLER.      */
@EL00001 L     @13,4(,@13)                                      01S1212
@EF00001 DS    0H                                               01S1212
@ER00001 LM    @14,@12,12(@13)                                  01S1212
         BR    @14                                              01S1212
*/********************************************************************/
*/*                                                                  */
*/* MACRO-      IEAPSPIO                                             */
*/*                                                                  */
*/* STATUS-     VERSION DATE=10/24/73, VS/2 RELEASE 2                */
*/*                                                                  */
*/* FUNCTION-   IEAPSPIO IS PART OF THE  SUPERVISOR                  */
*/*             INITIALIZATION PROCESS FOR VS2.                      */
*/*                                                                  */
*/*             THIS MACRO GENERATES INLINE PL/S STATEMENTS          */
*/*             WHICH FORM A SUBROUTINE TO FIND AND READ TEXT        */
*/*             RECORDS FROM SYS1.PARMLIB.                           */
*/*                                                                  */
*/*  REGISTER DEPENDENCIES-                                          */
*/*                                                                  */
*/*                 1. IEAPSPIO DEPENDS ON THE INCLUDING ROUTINES    */
*/*                    BASE REGISTERS FOR ADDRESSABILITY             */
*/*                                                                  */
*/*                 2. REGISTER 3 MUST CONTAIN THE ADDRESS OF        */
*/*                    THE CVT ON ENTRY                              */
*/*                                                                  */
*/*                 3. REGISTER 2 MUST CONTAIN THE ADDRESS OF        */
*/*                    THE NVT ON ENTRY                              */
*/*                                                                  */
*/*                 4. REGISTER 14 MUST CONTAIN THE ADDRESS OF       */
*/*                    THE CALLERS RETURN POINT ON ENTRY             */
*/*                                                                  */
*/* ENTRY POINTS-                                                    */
*/*                                                                  */
*/*    TWO CALLING SEQUENCRS ARE AVAILABLE.  ONE PROVIDES            */
*/*    COMPATIBILITY WITH THE VS2-1 VERSION OF THIS MACRO,           */
*/*    THE OTHER CALLING SEQUENCE WAS DEVELOPED EXPRESSLY            */
*/*    FOR VS2-2.                                                    */
*/*                                                                  */
*/*        VS2-1 COMPATIBLE VERSION-                                 */
*/*                                                                  */
*/*            1. CALL NIPPMPDS TO LOCATE (VIA BLDL) THE MEMBER      */
*/*               OF SYS1.PARMLIB                                    */
*/*                                                                  */
*/*            2. CALL NIPPMTXT TO READ A TEXT RECORD FROM           */
*/*               SYS1.PARMLIB                                       */
*/*                                                                  */
*/*        VS2-2 VERSION-                                            */
*/*                                                                  */
*/*            1. CALL NIPPMMEM TO LOCATE THE MEMBER AND RETURN      */
*/*               A TEXT RECORD                                      */
*/*                                                                  */
*/*            2. REPEAT CALL TO NIPPMMEM TO READ ADDITIONAL         */
*/*               TEXT RECORDS                                       */
*/*                                                                  */
*/* OUTPUT (NORMAL) -                                                */
*/*                                                                  */
*/*     THE ROUTINE WILL SAVE AND RESTORE ALL GENERAL REGISTERS      */
*/*     WITH THE EXCEPTION OF RPARM.  ON A SUCCESSFUL READ,          */
*/*     RPARM (REGISTER 1) WILL BE SET TO POINT TO THE FIRST NON-    */
*/*     BLANK CHARACTER IN THE TEXT RECORD.  IF THE RECORD           */
*/*     COLUMNS 1 THRU 72 ALL CONTAIN BLANKS, RPARM WILL             */
*/*     POINT TO A BLANK IN COLUMN 72.  IF COLUMNS 1 THRU 71         */
*/*     ARE BLANK BUT COLUMN 72 IS NON-BLANK, THE ROUTINE            */
*/*     WILL AUTOMATICALLY ATTEMPT TO READ THE NEXT RECORD.  IN      */
*/*     ALL CASES, COLUMN 72 WILL BE SET TO BLANK AND COLUMN 73 WILL */
*/*     BE SET TO X'FF'.                                             */
*/*                                                                  */
*/* EXIT (NORMAL)-                                                   */
*/*                                                                  */
*/*     VS2-1 AND VS2-2 VERSIONS RETURN TO THE ADDRESS FOUND         */
*/*     IN REGISTER 14 ON ENTRY.                                     */
*/*                                                                  */
*/* EXIT (ERROR)-                                                    */
*/*                                                                  */
*/*     VS2-1 COMPATIBLE VERSION-                                    */
*/*                                                                  */
*/*         RETURN TO THE ADDRESS IN REGISTER 14 +4                  */
*/*                                                                  */
*/*         NOTE- WHEN AN ERROR OCCURS ON AN ATTEMP TO READ A RECORD */
*/*               THAT DOES NOT EXIST (E-O-F),                       */
*/*               IT IS CONSIDERED A PERMANENT I/O ERROR             */
*/*                                                                  */
*/*     VS2-2 VERSION-                                               */
*/*                                                                  */
*/*        RETURN TO THE ADDRESS FOUND IN REGISTER 14 ON ENTRY       */
*/*        WITH REGISTER 1 (RPARM) SET TO A NEGATIVE VALUE.  IN THE  */
*/*        CASE WHERE RPARM IS NEGATIVE ON RETURN, THE NIPPARC FIELD */
*/*        OF THE NIP PATAMETER AREA WILL INDICATE THE REASON FOR    */
*/*        FAILURE AS FOLLOWS-                                       */
*/*                            4 - MEMBER NOT FOUND                  */
*/*                            8 - I/O ERROR DURING BLDL             */
*/*                            12- I/O ERROR DURING READ             */
*/*                            16- END-OF-FILE                       */
*/*                                                                  */
*/*     COMMON TO BOTH VERSIONS-                                     */
*/*                                                                  */
*/*        AN INTERPRETIVE MESSAGE WILL BE WRITTEN TO THE OPERATOR   */
*/*        FOR EACH OF THE FIRST THREE ERROR CONDITIONS LISTED       */
*/*        ABOVE.  THE CALLER MAY SUPPRESS THE 'MEMBER NOT FOUND'    */
*/*        MESSAGE BY SETTING THE NIPPAFL1 FLAG FIELD TO BINARY      */
*/*        ONE IN THE NIP PARAMETER AREA BEFORE CALLING THIS         */
*/*        ROUTINE.  NO MESSAGE WILL BE WRITTEN FOR THE E-O-F        */
*/*        CONDITION IF THE VS2-2 VERSION IS USED.                   */
*/*                                                                  */
*/* MACROS-                                                          */
*/*     THE FOLLOWING MAPPING MACROS MUST BE                         */
*/*     INCLUDED IN THE MODULE WHICH INCLUDES                        */
*/*     IEAPSPIO-                                                    */
*/*                                       IEZIOB                     */
*/*                                       IHANVT                     */
*/*                                       IHAECB                     */
*/*                                       IEAPPNIP                   */
*/*                                       IEFUCBOB                   */
*/*                                       CVT                        */
*/*                                                                  */
*/* NOTES-                                                           */
*/*        THE FIRST FOUR LETTERS OF ALL IEAPSPIO SYMBOLES ARE:      */
*/*        NIPP OR IPPM.                                             */
*/*                                                                  */
*/*        REGISTERS 0, 1, 14, AND 15 WILL BE UNRESTRICTED AT THE    */
*/*        END OF THE SEGMENT GENERATED BY IEAPSPIO.                 */
*/*                                                                  */
*/*        NIPPAREA WILL BE BASED ON NVTPAREA AND IOBSTDRD WILL BE   */
*/*        BASED ON THE ADDR OF NIPPAIOB AT THE END OF THE SEGMENT   */
*/*        GENERATED BY IEAPSPIO                                     */
*/*                                                                  */
*/*        IEAPSPIO MUST BE INCLUDED IN A CODE SEGMENT,              */
*/*        NOT AT THE TOP OF THE PROCEDURE WITH THE                  */
*/*        MAPPING MACROS LISTED ABOVE.                              */
*/*                                                            Y02752*/
*/********************************************************************/
*                                                               02S1213
*                                                               02S1213
*                                                               02S1213
*          /* REGISTERS                                              */
*          DCL NIPPMR00 REG(0) PTR(24);                         02S1213
*          DCL NIPPMR01 REG(1) PTR(24);                         02S1214
*          DCL NIPPMR02 REG(2) PTR(24);                         02S1215
*          DCL NIPPMR06 REG(6) PTR(24);                         02S1216
*          DCL NIPPMR09 REG(9) PTR(24);                         02S1217
*          DCL NIPPMR12 REG(12) PTR(24);                        02S1218
*          DCL NIPPMR13 REG(13) PTR(24);                        02S1219
*          DCL NIPPMR14 REG(14) PTR(24);                        02S1220
*          DCL NIPPMR15 REG(15) PTR(24);                        02S1221
*                                                               02S1221
*          /* SAVE AREA FOR CALLER'S REGISTERS                       */
*          DCL NIPPMREG (16) FIXED(31);                         02S1222
*                                                               02S1222
*                                                               02S1222
*          /* SAVE AREA FOR CALLER'S RETURN ADDRESS                  */
*          DCL NIPPMADR PTR(31);                                02S1223
*                                                               02S1223
*          /* POINTER TO DCB FOR BLDL                                */
*          DCL NIPPMDCB PTR(31);                                02S1224
*                                                               02S1224
*          /* POINTER TO BLDL HEADER FOR BLDL                        */
*          DCL NIPPMBDL PTR(31);                                02S1225
*                                                               02S1225
*          /* NORMAL RETURN TO CALLER                                */
*          DCL NIPPMAD0 LABEL BASED(NIPPMADR);                  02S1226
*                                                               02S1226
*          /* ERROR RETURN TO CALLER                                 */
*          DCL NIPPMAD4 LABEL BASED(NIPPMADR+4);                02S1227
*                                                               02S1227
*          /* ESTABLISH BASE FOR NIP COMMUNICATION AREA        Y02752*/
*          RESPECIFY NIPPAREA BASED(NVTPAREA);              /* Y02752*/
*                                                               02S1228
*          /* ONE BYTE SCANNING FIELD                                */
*          DCL NIPPMBYT CHAR(1) BASED;                          02S1229
*                                                               02S1229
*          /* TEMPORARY POINTER                                Y02752*/
*          DCL NIPPMKPR PTR(31);                            /* Y02752*/
*                                                               02S1230
*                                                               02S1230
*          /* INPUT RECORD READ FROM PARMLIB                   Y02752*/
*          DCL NIPPMBUF CHAR(80) BASED(NIPPMR01);           /* Y02752*/
*                                                               02S1231
*          /* MBBCCHHR OF PARMLIB MEMBERS                            */
*          DCL 1 NIPPMMBC CHAR(8),                              02S1232
*                2 NIPPMMBB CHAR(3),                            02S1232
*                2 NIPPMCCH CHAR (5);                           02S1232
*                                                               02S1232
*           /*  CCHHR OF PARMLIB MEMBERS  @ZA07472  */          02S1233
*     DCL 1 NIPPMSID BDY(WORD) CHAR(5) BASED(ADDR(NIPPASID)), /*
*                               @ZA07472  */                    02S1233
*       2   NIPPMCC FIXED(15),  /* CYLINDER # OF SEARCH ID @ZA07472  */
*      2  NIPPMHH CHAR(2),  /* HEAD # OF SEARCH ID @ZA07472 */  02S1233
*     2  NIPPMR CHAR(1); /* RECORD # OF SEARCH ID @ZA07472 */   02S1233
*                                                               02S1233
*          /* LOW ORDER 7 BYTES OF THE CSW STORED IN THE PARMLIB
*             IOB BY EXCP                                      Y02752*/
*          DCL 1 NIPPMCSW BASED(ADDR(IOBCSW)) BDY(BYTE),    /* Y02752*/
*                2 * CHAR(3),                               /* Y02752*/
*                2 NIPPMCS2 BIT(8),   /* I/O OPERATION STATUS FLAGS
*                                                           /* Y02752*/
*                2 * CHAR(3);                               /* Y02752*/
*                                                               02S1234
*          /* MASKS TO TEST THE STATUS FLAGS OF THE PARMLIB CSW Y02752*
*          DCL  NIPPMMK1 BIT(8) BDY(BYTE) INIT('11110010'B);/* Y02752*/
*           DCL NIPPMMK2 BIT(8) BDY(BYTE) INIT('11110001'B); /*@ZA07472
*                              */                               02S1236
*                                                               02S1236
*             /* MASK TO TEST THE IOBSENSE FLAGS     @ZA07472 */
*      DCL NIPPMMK3 BIT(8) BDY(BYTE) INIT('00100000'B); /*      02S1237
*                         @ZA07472 */                           02S1237
*                                                               02S1237
*          /* INTERNALLY GENERATED LABELS                            */
*          DCL NIPPMMB1 LABEL GENERATED INTERNAL;               02S1238
*          DCL NIPPMMB2 LABEL GENERATED INTERNAL;               02S1239
*          DCL NIPPMTND LABEL GENERATED INTERNAL;               02S1240
*                                                               02S1240
*          /* MAPPING AREAS INTO ERROR MESSAGES                      */
*          DCL NIPPMME1 CHAR(8) BASED(ADDR(NIPPMMB1));          02S1241
*          DCL NIPPMME2 CHAR(8) BASED(ADDR(NIPPMMB2));          02S1242
*          DCL NIPPMNAM CHAR(8) INIT(' '); /*MEMBER NAME SAVE AREA
*                                                              Y02752*/
*          DCL NIPPMNEG FIXED(31) INIT('FFFFFFFF'X); /*NEGATIVE VALUE
*                                                              Y02752*/
*         RESPECIFY IOBSTDRD BASED(ADDR(NIPPAIOB));/* IOB BASE Y02752*/
*                                                               02S1245
*         RESPECIFY (NIPPMR14,NIPPMR15,NIPPMR00,NIPPMR01) RESTRICTED;/*
*                                                              Y02752*/
*NIPPMMEM: NIPPMADR=NIPPMR14;  /* SAVE CALLER'S RETURN REGISTER 02S1247
*                                                              Y02752*/
NIPPMMEM ST    NIPPMR14,NIPPMADR                                02S1247
*         GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);      02S1248
          STM   NIPPMR02,NIPPMR01,NIPPMREG   SAVE REGISTERS     Y02752
*          NIPPARC=NIPPARC && NIPPARC; /*SET RETURN CODE TO ZERO
*                                                              Y02752*/
         L     @10,NVTPAREA(,RNVT)                              02S1249
         L     @05,NIPPARC(,@10)                                02S1249
         LR    @07,@05                                          02S1249
         XR    @07,@05                                          02S1249
         ST    @07,NIPPARC(,@10)                                02S1249
*          IF NIPPMNAM = NIPPANAM      /*IS THIS NEW MEMBER NAME
*                                                              Y02752*/
*              THEN GO TO NIPPMPRD;    /*NO- GO READ RECORD    Y02752*/
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1250
         BE    @RT01250                                         02S1250
*          NIPPMNAM = NIPPANAM;        /*YES- SAVE MEMBER NAME Y02752*/
         MVC   NIPPMNAM(8),NIPPANAM(@10)                        02S1252
*          GO TO NIPPMENT;             /*GO FIND MEMBER        Y02752*/
*                                                               02S1253
         B     NIPPMENT                                         02S1253
*NIPPMPDS: NIPPMADR = NIPPMR14;          /* SAVE CALLER'S RETURN ADDR*/
NIPPMPDS ST    NIPPMR14,NIPPMADR                                02S1254
*          GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);     02S1255
         STM   NIPPMR02,NIPPMR01,NIPPMREG       SAVE REGS       Y02752
*          NIPPMNAM = NIPPMNAM && NIPPMNAM;  /*CLEAR MEMBER NAME
*                                                              Y02752*/
         XC    NIPPMNAM(8),NIPPMNAM                             02S1256
*NIPPMENT: NIPPMR01 = ADDR(NIPPADCB) - 44;      /* R1= ADDR OF DCB   */
NIPPMENT L     @10,NVTPAREA(,RNVT)                              02S1257
         LA    NIPPMR01,NIPPADCB(,@10)                          02S1257
         SH    NIPPMR01,@CH00325                                02S1257
*          NIPPMR00 = ADDR(NIPPABDL);    /* R0= ADDR OF BLDL LIST    */
*                                                               02S1258
         LA    NIPPMR00,NIPPABDL(,@10)                          02S1258
*          /* READ PDS ENTRY FOR MEMBER                              */
*          GENERATE;                                            02S1259
          BLDL (1),(0)
*          NIPPARC = NIPPMR15;   /* SET RETURN CODE            Y02752*/
*                                                               02S1260
         L     @10,NVTPAREA(,RNVT)                              02S1260
         ST    NIPPMR15,NIPPARC(,@10)                           02S1260
*          IF NIPPMR15 = 4               /* WAS MEMBER NAME FOUND
*                                                              Y02752*/
*             THEN GO TO NIPPMPFN;       /* NO - TELL OPERATOR NOT
*                                           FOUND                    */
         CH    NIPPMR15,@CH00036                                02S1261
         BE    @RT01261                                         02S1261
*          IF NIPPMR15 = 8               /* WAS THERE AN I/O ERROR   */
*             THEN GO TO NIPPMPER;       /* YES - TELL OPERATOR 02S1263
*                                           I/O ERROR                */
*                                                               02S1263
         CH    NIPPMR15,@CH00035                                02S1263
         BE    @RT01263                                         02S1263
*          /* SET UP PARAMETERS FOR CONVERSION ROUTINE               */
*                                                               02S1265
*          NIPPMR00 = NIPPATTR;          /* R0 = ACTUAL TTR          */
         MVC   @ZT00001+1(3),NIPPATTR(@10)                      02S1265
         L     NIPPMR00,@ZT00001                                02S1265
*          GENERATE;                                            02S1266
         SLL   0,8(0)                    ZERO LOW BYTE IN REG 0
*          NIPPMR01 = ADDR(NIPPADEB);    /* R1 = ADDR OF DEB         */
         L     NIPPMR01,NVTPAREA(,RNVT)                         02S1267
         LA    NIPPMR01,NIPPADEB(,NIPPMR01)                     02S1267
*          NIPPMR15 = CVTPCNVT;          /* R15 = ADDR OF CONVERSION
*                                           ROUTINE            Y02752*/
         L     @10,CVTPTR                                       02S1268
         L     NIPPMR15,CVTPCNVT(,@10)                          02S1268
*          /* CONVERT TTR TO CCHHR FORMAT                      Y02752*/
*          GENERATE REFS(NIPPMR02,NIPPMR13)                     02S1269
*                    SETS(NIPPMR14,NIPPMR15,NIPPMMBC);     /*   02S1269
*                                                               02S1269
         STM   NIPPMR02,NIPPMR13,NIPPMSAV SAVE REGISTERS        Y02752
         LA    NIPPMR02,NIPPMMBC          CONVERSION AREA       Y02752
         BALR  NIPPMR14,NIPPMR15          CALL CONVERT RTN      Y02752
**         RESTORE CSECT AND DSECT BASE REGISTERS               Y02752
*NIPPMRST  DS  0H                                               Y02752
NIPPMRST LM    NIPPMR02,NIPPMR13,NIPPMSAV-NIPPMRST(NIPPMR14)    Y02752
         BC    15,NIPPMSKP                SKIP SAVE AREA        Y02752
*NIPPMSAV  DS  0F                                               Y02752
NIPPMSAV DC    12F'0'                     DECLARE REG SAVE AREA Y02752
*NIPPMSKP DS  0H                                                Y02752
NIPPMSKP DS    0H                         RESUME EXECUTION      Y02752
*          IOBSEEK = NIPPMMBC;           /* RESET PARMLIB IOBSEEK TO
*                                           THIS MBBCCHHR            */
         L     @10,NVTPAREA(,RNVT)                              02S1270
         MVC   IOBSEEK+72(8,@10),NIPPMMBC                       02S1270
*          NIPPASID = NIPPMCCH;          /* RESET PARMLIB SEARCH ID
*                                           TO THIS CCHHR            */
         MVC   NIPPASID(5,@10),NIPPMCCH                         02S1271
*          IF NIPPMNAM = NIPPANAM   /*SEE IF MEM NAMES MATCH   Y02752*/
*              THEN GO TO NIPPMPRD; /*YES- NEW VERSION- GO READ 02S1272
*                                                              Y02752*/
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1272
         BE    @RT01272                                         02S1272
*         GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);      02S1274
          LM    NIPPMR02,NIPPMR01,NIPPMREG    RESTORE REGS      Y02752
*          GO TO NIPPMAD0;               /* NORMAL RETURN TO CALLER
*                                                              Y02752*/
*                                                               02S1275
         L     @10,NIPPMADR                                     02S1275
         BR    @10                                              02S1275
*NIPPMPER: NIPPMME1 = NIPPANAM;          /* MOVE MEMBER NAME TO I/O
*                                           ERROR MESSAGE            */
*                                                               02S1276
NIPPMPER LA    @10,NIPPMMB1                                     02S1276
         L     @05,NVTPAREA(,RNVT)                              02S1276
         MVC   NIPPMME1(8,@10),NIPPANAM(@05)                    02S1276
*          /* WTO I/O ERROR DURING BLDL MESSAGE                      */
*          GENERATE REFS(NVTWTO) SETS(RPARM,REXIT,RENTRY);      02S1277
*                                                               02S1277
          IEAPMNIP TYPE=WTO,PARAM=NIPPMMS1 CALL WTO SERVICE ROUTINE
*          GO TO NIPPMPXT;               /* ERROR RETURN TO CALLER   */
*                                                               02S1278
         B     NIPPMPXT                                         02S1278
*NIPPMPFN: IF NIPPMNAM = NIPPANAM  /*SEE IF MEMBER NAMES MATCH Y02752*/
*              THEN IF NIPPAFL1 = '1'B  /*YES- SUPPRESS MESSAGE?
*                                                              Y02752*/
NIPPMPFN L     @10,NVTPAREA(,RNVT)                              02S1279
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1279
         BNE   @RF01279                                         02S1279
*                 THEN GO TO NIPPMPXT;  /*YES- GO EXIT TO CALLER
*                                                              Y02752*/
         L     @10,NVTPTAB(,RNVT)                               02S1280
         TM    NIPPAFL1(@10),B'10000000'                        02S1280
         BO    @RT01280                                         02S1280
*                 ELSE;                                     /* Y02752*/
*          NIPPMME2 = NIPPANAM;          /* MOVE MEMBER NAME TO NOT
*                                           FOUND MESSAGE      Y02752*/
*                                                               02S1283
@RF01279 LA    @10,NIPPMMB2                                     02S1283
         L     @05,NVTPAREA(,RNVT)                              02S1283
         MVC   NIPPMME2(8,@10),NIPPANAM(@05)                    02S1283
*          /* WTO MEMBER NOT FOUND IN DATA SET MESSAGE               */
*          GENERATE REFS(NVTWTO) SETS(RPARM,REXIT,RENTRY);      02S1284
          IEAPMNIP TYPE=WTO,PARAM=NIPPMMS2 CALL WTO SERVICE ROUTINE
*NIPPMPXT: IF NIPPMNAM = NIPPANAM   /*SEE IF NAMES MATCH       Y02752*/
*             THEN DO;                                          02S1285
NIPPMPXT L     @10,NVTPAREA(,RNVT)                              02S1285
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1285
         BNE   @RF01285                                         02S1285
*                     NIPPMNAM = NIPPMNAM && NIPPMNAM; /* FORCE NEW
*                                            NAME PATH ON NEXT ENTRY
*                                                              Y02752*/
         XC    NIPPMNAM(8),NIPPMNAM                             02S1287
*                     NIPPMR01 = NIPPMNEG;  /* SET NEGATIVE VALUE RC
*                                                              Y02752*/
         L     NIPPMR01,NIPPMNEG                                02S1288
*                     GENERATE SETS(NIPPMR02,NIPPMR00) REFS(NIPPMREG);
          LM    NIPPMR02,NIPPMR00,NIPPMREG    RESTORE REGS      Y02752
*                     GO TO NIPPMAD0;   /*EXIT TO CALLER       Y02752*/
         L     @10,NIPPMADR                                     02S1290
         BR    @10                                              02S1290
*                  END;                                     /* Y02752*/
*          GENERATE SETS(NIPPMR02,NIPPMR01) REFS(NIPPMREG); /* Y02752*/
@RF01285 DS    0H                                               02S1292
         LM    NIPPMR02,NIPPMR01,NIPPMREG     RESTORE REGS      Y02752
*          GO TO NIPPMAD4;               /* READ ERROR - RETURN TO
*                                           CALLER                   */
         L     @10,NIPPMADR                                     02S1293
         LA    @10,NIPPMAD4+4(,@10)                             02S1293
         BR    @10                                              02S1293
*                                                               02S1294
*          /**********************************************************/
*          /*             ROUTINE TO READ PARMLIB TEXT               */
*          /**********************************************************/
*                                                               02S1294
*NIPPMTXT: NIPPMADR = NIPPMR14;          /* SAVE CALLER'S RETURN
*                                           ADDRESS                  */
NIPPMTXT ST    NIPPMR14,NIPPMADR                                02S1294
*          GENERATE REFS(NIPPMR02,NIPPMR01) SETS(NIPPMREG);     02S1295
         STM   NIPPMR02,NIPPMR01,NIPPMREG   SAVE CALLERS REGS
*NIPPMPRD: NIPPAECB = NIPPAECB && NIPPAECB;   /* ZERO WAIT ECB       */
NIPPMPRD L     @10,NVTPAREA(,RNVT)                              02S1296
         XC    NIPPAECB(4,@10),NIPPAECB(@10)                    02S1296
*          IOBSEEK(4:7) = NIPPASID;         /* FILL IN CCHH IN IOB   */
*                                                               02S1297
         LA    @05,72                                           02S1297
         ALR   @05,@10                                          02S1297
         MVC   IOBSEEK+3(4,@05),NIPPASID(@10)                   02S1297
*          /* REINITIALIZE IOB FLAGS                                 */
*                                                               02S1298
*          IOBFLAG1 = '42'X;                                    02S1298
         MVI   IOBFLAG1(@05),X'42'                              02S1298
*          IOBFLAG2 = '00'X;                                    02S1299
         MVI   IOBFLAG2(@05),X'00'                              02S1299
*          IOBFLAG3 = '00'X;                                    02S1300
         MVI   IOBFLAG3(@05),X'00'                              02S1300
*          IOBERRCT = '0000'X;                                  02S1301
         SLR   @07,@07                                          02S1301
         STH   @07,IOBERRCT(,@05)                               02S1301
*          IOBCSW = '00000000000000'X;                          02S1302
         MVC   IOBCSW(7,@05),@CB02631                           02S1302
*          IOBSENS0 = '00'X;                                    02S1303
         MVI   IOBSENS0(@05),X'00'                              02S1303
*          IOBSENS1 = '00'X;                                    02S1304
*                                                               02S1304
         MVI   IOBSENS1(@05),X'00'                              02S1304
*          /* READ PARMLIB TEXT RECORD                               */
*          NIPPMR01 = ADDR(NIPPAIOB);                           02S1305
         LA    NIPPMR01,NIPPAIOB(,@10)                          02S1305
*          GENERATE;                                            02S1306
          EXCP  (1)                 READ TEXT
*          NIPPMR01 = ADDR(NIPPAECB);                           02S1307
         L     NIPPMR01,NVTPAREA(,RNVT)                         02S1307
         LA    NIPPMR01,NIPPAECB(,NIPPMR01)                     02S1307
*          GENERATE;                                            02S1308
          WAIT  ECB=(1)                  AWAIT I/O COMPLETION
*          /* TEST FOR I/O ERROR AFTER PARMLIB READ            Y02752*/
*          IF NIPPAECC ¬= '7F'X          /* SKIP IF READ SUCCESSFUL
*                                                              Y02752*/
*             THEN                                              02S1309
         L     @10,NVTPAREA(,RNVT)                              02S1309
         CLI   NIPPAECC(@10),X'7F'                              02S1309
         BE    @RF01309                                         02S1309
*             DO;                                               02S1310
*               IF NIPPMNAM = NIPPANAM   /* SEE IF MEMBER NAMES MATCH
*                                                              Y02752*/
*               THEN                                            02S1311
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1311
         BNE   @RF01311                                         02S1311
*               DO;                                             02S1312
*                 /* DOES THE I/O ERROR REPRESENT EOF          Y02752*/
*                 IF NIPPAECC = '41'X &   /* IOBCSW FIELD VALID?     */
*                    /* FALL THROUGH IF UNIT EXCEPTION, CHANNEL END
*                       AND DEVICE END FLAGS ARE ON IN THE IOBCSW    */
*                    (NIPPMCS2 | NIPPMMK1) = 'FF'X              02S1313
*                    THEN                                       02S1313
         CLI   NIPPAECC(@10),X'41'                              02S1313
         BNE   @RF01313                                         02S1313
         MVC   @TS00001(1),NIPPMCS2+81(@10)                     02S1313
         OC    @TS00001(1),NIPPMMK1                             02S1313
         CLI   @TS00001,X'FF'                                   02S1313
         BNE   @RF01313                                         02S1313
*                      DO;                                      02S1314
*                        NIPPARC = 16;   /* INDICATE EOF CONDITION
*                                                              Y02752*/
         MVC   NIPPARC(4,@10),@CF00080                          02S1315
*                        GOTO NIPPMPXT;  /* RETURN TO CALLER   Y02752*/
         B     NIPPMPXT                                         02S1316
*                      END;                                 /* Y02752*/
*              /* DOES THE I/O ERROR REPRESENT END OF CYL? @ZA07472 */
*              IF NIPPAECC='41'X&                /* @ZA07472 */ 02S1318
*              (NIPPMCS2|NIPPMMK2)='FF'X&        /* @ZA07472 */ 02S1318
*              (IOBSENS1&NIPPMMK3)= '20'X THEN         /* @ZA07472 */
@RF01313 L     @10,NVTPAREA(,RNVT)                              02S1318
         CLI   NIPPAECC(@10),X'41'                              02S1318
         BNE   @RF01318                                         02S1318
         MVC   @TS00001(1),NIPPMCS2+81(@10)                     02S1318
         OC    @TS00001(1),NIPPMMK2                             02S1318
         CLI   @TS00001,X'FF'                                   02S1318
         BNE   @RF01318                                         02S1318
         MVC   @TS00001(1),IOBSENS1+72(@10)                     02S1318
         NC    @TS00001(1),NIPPMMK3                             02S1318
         CLI   @TS00001,X'20'                                   02S1318
         BNE   @RF01318                                         02S1318
*               /* IF YES, MAKE SEEK ADDRESS POINT TO START OF NEXT
*                              CYLINDER @ZA07472 */             02S1319
*               DO;      /* @ZA07472 */                         02S1319
*               NIPPMCC=NIPPMCC+1;          /* INCREMENT SEEK@ TO NEXT
*                CYL, @ZA07472 */                               02S1320
         AH    @10,@CH02653                                     02S1320
         LA    @05,1                                            02S1320
         AH    @05,NIPPMCC(,@10)                                02S1320
         STH   @05,NIPPMCC(,@10)                                02S1320
*            NIPPMHH=NIPPMHH&&NIPPMHH;  /* HEAD 0, @ZA07472 */  02S1321
         XC    NIPPMHH(2,@10),NIPPMHH(@10)                      02S1321
*                   NIPPMR='01'X;        /*  AND RECORD 1   @ZA07472 */
         MVI   NIPPMR(@10),X'01'                                02S1322
*                   GOTO NIPPMRCR;   /* CONTINUE TO PROCESS TEXT
*                                   @ZA07472 */                 02S1323
         B     NIPPMRCR                                         02S1323
*                    END;  /* @ZA07472 */                       02S1324
*                  END;                                     /* Y02752*/
*                 GOTO NIPPMTER;         /* INDICATE I/O ERROR Y02752*/
         B     NIPPMTER                                         02S1326
*               END;                                        /* Y02752*/
*          RESPECIFY NIPPMBYT BASED(NIPPMR01);                  02S1328
@RF01309 DS    0H                                               02S1329
*           NIPPMRCR:      /* @ZA07472 */                       02S1329
*                                                               02S1329
*          NIPPMR01 = ADDR(NIPPARCD);    /* R1 = ADDR OF TEXT RECORD
*                                           READ IN                  */
*                                                               02S1329
NIPPMRCR L     NIPPMR01,NVTPAREA(,RNVT)                         02S1329
         LA    NIPPMR01,NIPPARCD(,NIPPMR01)                     02S1329
*          /* SCAN THROUGH LEADING BLANK CHARACTERS                  */
*          NIPPMBUF(73:73) = 'FF'X;      /* PLACE 'FF'X IN COL 73    */
*                                                               02S1330
         MVI   NIPPMBUF+72(NIPPMR01),X'FF'                      02S1330
*          NIPPMKPR = 1;                 /* COUNT STARTS AT ONE      */
         MVC   NIPPMKPR(4),@CF00042                             02S1331
*NIPPMPBK: IF NIPPMBYT = ' '             /* IS THIS CHAR BLANK       */
*             THEN                       /* YES - CHECK NEXT CHAR    */
NIPPMPBK CLI   NIPPMBYT(NIPPMR01),C' '                          02S1332
         BNE   @RF01332                                         02S1332
*               DO;                                             02S1333
*                 NIPPMR01 = NIPPMR01 + 1;      /* POINT TO NEXT CHAR
*                                                              Y02752*/
         LA    @10,1                                            02S1334
         ALR   NIPPMR01,@10                                     02S1334
*                NIPPMKPR = NIPPMKPR + 1;      /* INCREMENT COUNTER
*                                                              Y02752*/
         AL    @10,NIPPMKPR                                     02S1335
         ST    @10,NIPPMKPR                                     02S1335
*                 IF NIPPMKPR = 72       /* ARE FIRST 71 CHARS BLANK
*                                                              Y02752*/
*                    THEN                /*YES-CHECK FOR CONTINUATION*/
         CH    @10,@CH00082                                     02S1336
         BNE   @RF01336                                         02S1336
*                      DO;                                      02S1337
*                        IF NIPPMBYT ¬= ' '      /* IS 72'ND CHAR BLK*/
*                           THEN                /* NO - INDICATES
*                                                  CONTINUATION      */
         CLI   NIPPMBYT(NIPPMR01),C' '                          02S1338
         BNE   @RT01338                                         02S1338
*                                GO TO NIPPMPRD;/* READ NEXT RECORD  */
*                           ELSE                /* 72ND IS BLANK - NO
*                                                  CONTINUATION      */
*                               GO TO NIPPMTND; /* REG 1 POINTS TO 72ND
*                                                  BLANK. NORMAL RETURN
*                                                  TO CALLER         */
         B     NIPPMTND                                         02S1340
*                      END;                                     02S1341
*                    ELSE GO TO NIPPMPBK; /* COUNT IS NOT 72 YET-
*                                            GO CHECK NEXT CHAR      */
*               END;                                            02S1343
*             ELSE                       /* FIRST 71 CHARS ARE NOT   */
*               DO;                      /* BLANK                    */
@RF01332 DS    0H                                               02S1345
*                 NIPPMKPR = NIPPMR01 - NIPPMKPR + 72;      /* POINT TO
*                                                 72'ND BYTE   Y02752*/
*                                                               02S1345
         LR    @10,NIPPMR01                                     02S1345
         SL    @10,NIPPMKPR                                     02S1345
         AH    @10,@CH00082                                     02S1345
         ST    @10,NIPPMKPR                                     02S1345
*                 RESPECIFY NIPPMBYT BASED(NIPPMKPR);       /* Y02752*/
*                                                               02S1346
*                 NIPPMBYT = ' ';        /* INSURE BLANK AT END BY
*                                           SETTING 72'ND BYTE TO BLK*/
         MVI   NIPPMBYT(@10),C' '                               02S1347
*               END;                                            02S1348
*           GENERATE REFS(NIPPMREG) SETS(NIPPMR02,NIPPMR00);     /*
*NIPPMTND  DS  0H                                               Y02752
NIPPMTND LM    NIPPMR02,NIPPMR00,NIPPMREG     RESTORE CALLERS REGS
*          GO TO NIPPMAD0;               /* NORMAL RETURN TO CALLER  */
*                                                               02S1350
         L     @10,NIPPMADR                                     02S1350
         BR    @10                                              02S1350
*NIPPMTER: NIPPMR01 = ADDR(NIPPAIOB);    /* R1 = ADDR OF PARMLIB IOB */
*                                                               02S1351
NIPPMTER L     NIPPMR01,NVTPAREA(,RNVT)                         02S1351
         LA    NIPPMR01,NIPPAIOB(,NIPPMR01)                     02S1351
*          /* NIPSENSE - FORMAT AND WRITE I/O ERROR MESSAGE          */
*          GENERATE REFS(NVTSENSE,NIPPMR01) SETS(RPARM,REXIT,RENTRY);
         IEAPMNIP TYPE=SENSE,PARAM=NIPPMR01
*          NIPPARC = 12;    /*SET RETURN CODE TO 12            Y02752*/
         L     @10,NVTPAREA(,RNVT)                              02S1353
         MVC   NIPPARC(4,@10),@CF00032                          02S1353
*          IF NIPPMNAM = NIPPANAM  /*SEE IF MEMBER NAMES MATCH Y02752*/
*             THEN GO TO NIPPMPXT; /*YES-TAKE NEW VERSION EXIT Y02752*/
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1354
         BE    @RT01354                                         02S1354
*          GENERATE REFS(NIPPMREG) SETS(NIPPMR01,NIPPMR02);     02S1356
*                                                               02S1356
         LM    NIPPMR02,NIPPMR01,NIPPMREG     RESTORE CALLERS REGS
*          GO TO NIPPMAD4;               /* READ ERROR - RETURN TO
*                                           CALLER + 4               */
*                                                               02S1357
         L     @10,NIPPMADR                                     02S1357
         LA    @10,NIPPMAD4+4(,@10)                             02S1357
         BR    @10                                              02S1357
*          RESPECIFY (NIPPMR01,NIPPMR00,NIPPMR14,NIPPMR15)  /* Y02752*/
*                                                 UNRESTRICTED; 02S1358
*          /**********************************************************/
*          /* GENERATED MACRO PARAMETER LISTS FOR MESSAGES           */
*          /**********************************************************/
*                                                               02S1359
*           GENERATE DATA;     /*                               02S1359
*SETSTAT: PROC;                        /*SET VOLUME ATTRIBS  @Y30LPPD*/
         B     @EL00001                                         02S1360
SETSTAT  STM   @14,@12,12(@13)                                  02S1360
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SETSTAT                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SET MOUNT AND USE STATUS IN UCB               */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*     IF THE VOLUME IS NOT ON A NON-DEMOUNTABLE DEVICE, OR IS      */
*/*     NOT ONE THAT THE SYSTEM REQUIRES TO BE PERMANENTLY RESI-     */
*/*     DENT, THEN SET THE MOUNT STATUS.  IF THE  MOUNT CHARACTER-   */
*/*     ISTIC IN VATLST ENTRY IS 1, THEN SET UCB MOUNT STATUS TO     */
*/*     RESERVED. OTHERWISE, SET UCB MOUNT STATUS TO PERMANENTLY     */
*/*     RESIDENT.                                                    */
*/*                                                                  */
*/*     IF USE ATTRIBUTE IN VATLST ENTRY IS 0, THEN UCB USE STATUS   */
*/*     IS STORAGE.  IF USE ATTRIBUTE IS 2, THEN UCB USE STATUS IS   */
*/*     PRIVATE. OTHERWISE, UCB USE STATUS IS PUBLIC.                */
*/*                                                                  */
*/* ENTRY - SUBROUTINE                                       @Y30LPPD*/
*/*                                                                  */
*/*     PURPOSE -                                                    */
*/*                                                                  */
*/*         SET MOUNT AND USE STATUS, AS INDICATED IN VATLST ENTRY,  */
*/*         IN ASSOCIATED UCB.                                       */
*/*                                                                  */
*/*     INPUT DATA -                                                 */
*/*                                                                  */
*/*         VATLST ENTRY                                             */
*/*         UCBPTR - CONTAINS UCB ADDRESS                            */
*/*         UCBPRES - SET ON FOR VOLUMES THE SYSTEM REQUIRES TO BE   */
*/*                   PERMANENTLY RESIDENT AND NON-DEMOUNTABLE       */
*/*                   DEVICES.                                       */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*     CONDITION - NORMAL                                           */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*                                                                  */
*/*         UCB - MODIFIED                                           */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1361
*IF UCBPRES = NO                       /*IF VOL IS NOT P/R,          */
*  THEN IF EMNTCHAR = RSV              /*SET MOUNT ATTRIBUTE         */
         L     @10,UCBPTR                                       02S1361
         TM    UCBPRES(@10),B'00000100'                         02S1361
         BNZ   @RF01361                                         02S1361
*    THEN DO;                          /*TO RESERVED IF COL 8 OF     */
         L     @05,MAPAD                                        02S1362
         CLI   EMNTCHAR(@05),C'1'                               02S1362
         BNE   @RF01362                                         02S1362
*      UCBRESV = YES;                  /*ENTRY IS EQUAL TO ONE, AND  */
*      UCBPRES = NO;                   /*TURN OFF PERMANENTLY   02S1365
*                                        RESIDENT ATTRIBUTE.         */
         OI    UCBRESV(@10),B'00100000'                         02S1365
         NI    UCBPRES(@10),B'11111011'                         02S1365
*    END;                                                       02S1366
*    ELSE DO;                          /*IF COL 8 ¬= 1 THEN          */
         B     @RC01362                                         02S1367
@RF01362 DS    0H                                               02S1368
*      UCBPRES = YES;                  /*SET DEFAULT ATTRIBUTE -
*                                        PERMANENTLY RESIDENT AND    */
*      UCBRESV = NO;                   /*TURN OFF RESERVED ATTRIBUTE */
         L     @10,UCBPTR                                       02S1369
         OI    UCBPRES(@10),B'00000100'                         02S1369
         NI    UCBRESV(@10),B'11011111'                         02S1369
*    END;                                                       02S1370
*                                                               02S1370
*UCBBSTR = NO;                         /*TURN OFF USE ATTRIBUTES     */
@RC01362 DS    0H                                               02S1371
@RF01361 DS    0H                                               02S1372
*UCBBPRV = NO;                                                  02S1372
*UCBBPUB = NO;                                                  02S1373
*                                                               02S1373
         L     @10,UCBPTR                                       02S1373
         NI    UCBBSTR(@10),B'11100011'                         02S1373
*IF EUSEATTR = STR                     /*SET USE ATTRIBUTES          */
*  THEN                                /*IF COL 10 OF ENTRY = 0      */
         L     @05,MAPAD                                        02S1374
         CLI   EUSEATTR(@05),C'0'                               02S1374
         BNE   @RF01374                                         02S1374
*    UCBBSTR = YES;                    /*SET USE ATTRI TO STORAGE,   */
         OI    UCBBSTR(@10),B'00000100'                         02S1375
*  ELSE IF EUSEATTR = PRIV             /*IF COL 10 = 2               */
*    THEN                                                       02S1376
         B     @RC01374                                         02S1376
@RF01374 L     @10,MAPAD                                        02S1376
         CLI   EUSEATTR(@10),C'2'                               02S1376
         BNE   @RF01376                                         02S1376
*      UCBBPRV = YES;                  /*SET USE ATTRI TO PRIVATE,   */
         L     @10,UCBPTR                                       02S1377
         OI    UCBBPRV(@10),B'00010000'                         02S1377
*    ELSE                              /*ELSE SET DEFAULT USE ATTRI  */
*      UCBBPUB = YES;                  /*OF PUBLIC                   */
         B     @RC01376                                         02S1378
@RF01376 L     @10,UCBPTR                                       02S1378
         OI    UCBBPUB(@10),B'00001000'                         02S1378
*END SETSTAT;                          /*RETURN TO CALLER    @Y30LPPD*/
@EL00002 DS    0H                                               02S1379
@EF00002 DS    0H                                               02S1379
@ER00002 LM    @14,@12,12(@13)                                  02S1379
         BR    @14                                              02S1379
*EXCPSETP: PROC;                       /* SET UP FOR EXCP    @Y30LPPD*/
EXCPSETP STM   @14,@12,12(@13)                                  02S1380
*/***********************************************************@Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* SEGMENT NAME - EXCPSETP                                  @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* DESCRIPTIVE NAME - SET UP CONTROL BLOCKS FOR EXCP        @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* FUNCTION -                                               @Y30LPPD*/
*/*     THE APPENDAGE VECTOR TABLE AND EXCP CONTROL BLOCKS   @Y30LPPD*/
*/*     ARE INITIALIZED.                                     @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*  ENTRY - SUBROUTINE                                      @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*      PURPOSE - SEE FUNCTION                              @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*      INPUT DATA - NONE                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*  EXITS -                                                 @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*      CONDITION - VECTOR TABLE AND CONTROL BLOCKS         @Y30LPPD*/
*/*              INITIALIZED                                 @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*      OUTPUT DATA -                                       @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*            APPENDAGE VECTOR TABLE                        @Y30LPPD*/
*/*            ECB                                           @Y30LPPD*/
*/*            IOB                                           @Y30LPPD*/
*/*            DEB                                           @Y30LPPD*/
*/*            CCW'S                                         @Y30LPPD*/
*/*            DCB                                           @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/*     RETURN CODE - NONE                                   @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/***********************************************************@Y30LPPD*/
*RFY IOBSTDRD BASED(IOBSTPTR);         /*                    @Y30LPPD*/
*DO VIND = ONE TO FIVE;                /*INITIALIZE APPENDAGE@Y30LPPD*/
         LA    @10,1                                            02S1382
         STH   @10,VIND                                         02S1382
@DL01382 DS    0H                                               02S1383
*  VECTAB(VIND) = ADDR(CVTBRET);       /*VECTOR TABLE        @Y30LPPD*/
         LR    @05,@10                                          02S1383
         SLA   @05,2                                            02S1383
         L     @01,CVTPTR                                       02S1383
         LA    @15,CVTBRET(,@01)                                02S1383
         ST    @15,VECTAB-4(@05)                                02S1383
*END;                                                           02S1384
*                                                               02S1384
         AL    @10,@CF00042                                     02S1384
         STH   @10,VIND                                         02S1384
         CH    @10,@CH00073                                     02S1384
         BNH   @DL01382                                         02S1384
*ECBPTR = ADDR(VAPECB);                /*ADDRESS OF ECB              */
         LA    @10,VAPECB                                       02S1385
         ST    @10,ECBPTR                                       02S1385
*IOBSTPTR = ADDR(VAPIOB);              /*ADDRESS OF IOB              */
         LA    @05,VAPIOB                                       02S1386
         ST    @05,IOBSTPTR                                     02S1386
*DEBPTR = ADDR(VAPDEB);                /*ADDRESS OF DEB              */
*                                                               02S1387
         LA    @15,VAPDEB                                       02S1387
         ST    @15,DEBPTR                                       02S1387
*SADDR1 = ADDR(VAPSRCH);               /*CYL 0, TRK 0, RCD 3         */
         LA    @14,VAPSRCH                                      02S1388
         ST    @14,@TF00001                                     02S1388
         MVC   SADDR1(3),@TF00001+1                             02S1388
*SADDR2 = ADDR(CCW1);                  /*POINT BACK TO FIRST CCW     */
         LA    @14,CCW1                                         02S1389
         ST    @14,@TF00001                                     02S1389
         MVC   SADDR2(3),@TF00001+1                             02S1389
*SADDR3 = ADDR(LABELBUF);              /*BUFFER FOR READ             */
         LA    @07,LABELBUF                                     02S1390
         ST    @07,@TF00001                                     02S1390
         MVC   SADDR3(3),@TF00001+1                             02S1390
*COUNT3 = LENGTH(LABELBUF);            /*NUMBER OF BYTES TO BE READ  */
*                                                               02S1391
         MVC   COUNT3(2),@CH00177                               02S1391
*DCBDEBAD = DEBPTR;                    /*DEB ADDRESS IN DCB          */
         ST    @15,@TF00001                                     02S1392
         MVC   DCBDEBAD(3),@TF00001+1                           02S1392
*DCBMACRF = MACRF;                     /*EXCP                        */
         MVC   DCBMACRF(4),MACRF                                02S1393
*DCBOFLGS = OFLAGS;                    /*DCB IS OPEN                 */
         MVC   DCBOFLGS(4),OFLAGS                               02S1394
*                                      /*SET UP IOB                  */
*IOBFLAG1 = IOBFLAGS;                  /*CHAINING & UNRELATED REQUEST*/
         MVI   IOBFLAG1(@05),X'42'                              02S1395
*IOBECBPT = ECBPTR;                    /*ECB ADDRESS                 */
         ST    @10,IOBECBPT(,@05)                               02S1396
*IOBSTART = ADDR(CCW1);                /*CCW ADDRESS                 */
         ST    @14,IOBSTART(,@05)                               02S1397
*IOBDCBPT = ADDR(VAPDCB1) - DCBDISP;   /*DCB ADDRESS                 */
         LA    @10,VAPDCB1                                      02S1398
         SH    @10,@CH00108                                     02S1398
         ST    @10,IOBDCBPT(,@05)                               02S1398
*IOBR = THREE;                         /*RECORD 3                    */
         MVI   IOBR(@05),X'03'                                  02S1399
*                                      /*SET UP DEB                  */
*DEBDAPTR = ADDR(DEBBASND);            /*ADDRESS OF DEB EXTENSION    */
         LA    @05,DEBBASND(,@15)                               02S1400
         ST    @05,DEBDAPTR                                     02S1400
*DEBNMEXT = EXTENTS;                   /*NUMBER OF EXTENTS           */
         MVI   DEBNMEXT(@15),X'01'                              02S1401
*DEBDEBID = DEBID;                     /*DEB ID                      */
         MVI   DEBDEBID(@15),X'0F'                              02S1402
*DEBDCBB = IOBDCBPT;                   /*DCB ADDRESS                 */
         ST    @10,@TF00001                                     02S1403
         MVC   DEBDCBB(3,@15),@TF00001+1                        02S1403
*DEBEXSCL = DASDEX;                    /*EXTENT SCALE                */
         MVI   DEBEXSCL(@15),X'04'                              02S1404
*DEBAPPB = ADDR(VECTAB);               /*APPENDAGE VECTOR TABLE      */
         LA    @10,VECTAB                                       02S1405
         ST    @10,@TF00001                                     02S1405
         MVC   DEBAPPB(3,@15),@TF00001+1                        02S1405
*DEBENDCC = ENDEXT;                    /*END CYLINDER                */
         LH    @10,ENDEXT                                       02S1406
         STH   @10,DEBENDCC(,@05)                               02S1406
*DEBENDHH = ENDEXT;                    /* END TRACK                  */
         STH   @10,DEBENDHH(,@05)                               02S1407
*DEBNMTRK = NUMTRKS;                   /*NUMBER OF TRACKS            */
         MVC   DEBNMTRK(2,@05),NUMTRKS                          02S1408
*END EXCPSETP;                         /*                    @Y30LPPD*/
@EL00003 DS    0H                                               02S1409
@EF00003 DS    0H                                               02S1409
@ER00003 LM    @14,@12,12(@13)                                  02S1409
         BR    @14                                              02S1409
*END IEAVAP00                                                   01S1410
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (VAPSPEC )                                        *
*/*%INCLUDE SYSLIB  (DECLARES)                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (IEZSSC  )                                        *
*/*%INCLUDE SYSLIB  (IHANVT  )                                        *
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        *
*/*%INCLUDE SYSLIB  (IEAPPNIP)                                        *
*/*%INCLUDE SYSLIB  (IEAPMNIP)                                        *
*/*%INCLUDE SYSLIB  (IHAECB  )                                        *
*/*%INCLUDE SYSLIB  (IEZIOB  )                                        *
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        *
*/*%INCLUDE SYSLIB  (MESSAGES)                                        *
*/*%INCLUDE SYSLIB  (INITUCBS)                                        *
*/*%INCLUDE SYSLIB  (INITSPEC)                                        *
*/*%INCLUDE SYSLIB  (CKPARMS )                                        *
*/*%INCLUDE SYSLIB  (CKPMSPEC)                                        *
*/*%INCLUDE SYSLIB  (SYSPARMS)                                        *
*/*%INCLUDE SYSLIB  (SYSPSPEC)                                        *
*/*%INCLUDE SYSLIB  (RDENTRY )                                        *
*/*%INCLUDE SYSLIB  (RDENSPEC)                                        *
*/*%INCLUDE SYSLIB  (CKENTRY )                                        *
*/*%INCLUDE SYSLIB  (CKENSPEC)                                        *
*/*%INCLUDE SYSLIB  (MNTLSTCK)                                        *
*/*%INCLUDE SYSLIB  (MTCKSPEC)                                        *
*/*%INCLUDE SYSLIB  (MOUNTLST)                                        *
*/*%INCLUDE SYSLIB  (MLSTSPEC)                                        *
*/*%INCLUDE SYSLIB  (NOLIST  )                                        *
*/*%INCLUDE SYSLIB  (NLSTSPEC)                                        *
*/*%INCLUDE SYSLIB  (RDERR   )                                        *
*/*%INCLUDE SYSLIB  (RDERSPEC)                                        *
*/*%INCLUDE SYSLIB  (INFOLIST)                                        *
*/*%INCLUDE SYSLIB  (INFOSPEC)                                        *
*/*%INCLUDE SYSLIB  (LISTPROC)                                        *
*/*%INCLUDE SYSLIB  (LISTSPEC)                                        *
*/*%INCLUDE SYSLIB  (FINDVOL )                                        *
*/*%INCLUDE SYSLIB  (FINDSPEC)                                        *
*/*%INCLUDE SYSLIB  (WRONGVOL)                                        *
*/*%INCLUDE SYSLIB  (WRNGSPEC)                                        *
*/*%INCLUDE SYSLIB  (VIRTMONT)                                        *
*/*%INCLUDE SYSLIB  (VIRTSPEC)                                        *
*/*%INCLUDE SYSLIB  (CKPATH  )                                        *
*/*%INCLUDE SYSLIB  (CKPHSPEC)                                        *
*/*%INCLUDE SYSLIB  (VIRTREAD)                                        *
*/*%INCLUDE SYSLIB  (VTRDSPEC)                                        *
*/*%INCLUDE SYSLIB  (MOUNTMSG)                                        *
*/*%INCLUDE SYSLIB  (MNTSPEC )                                        *
*/*%INCLUDE SYSLIB  (CKREPLY )                                        *
*/*%INCLUDE SYSLIB  (CKRPSPEC)                                        *
*/*%INCLUDE SYSLIB  (DEVREPLY)                                        *
*/*%INCLUDE SYSLIB  (DEVRSPEC)                                        *
*/*%INCLUDE SYSLIB  (DELIMCK )                                        *
*/*%INCLUDE SYSLIB  (DELISPEC)                                        *
*/*%INCLUDE SYSLIB  (CHECKUCB)                                        *
*/*%INCLUDE SYSLIB  (CUCBSPEC)                                        *
*/*%INCLUDE SYSLIB  (UCBFIND )                                        *
*/*%INCLUDE SYSLIB  (UCBFSPEC)                                        *
*/*%INCLUDE SYSLIB  (CKONLINE)                                        *
*/*%INCLUDE SYSLIB  (CKONSPEC)                                        *
*/*%INCLUDE SYSLIB  (REASON  )                                        *
*/*%INCLUDE SYSLIB  (REASON  )                                        *
*/*%INCLUDE SYSLIB  (RESNSPEC)                                        *
*/*%INCLUDE SYSLIB  (RESNSPEC)                                        *
*/*%INCLUDE SYSLIB  (CHECKDUP)                                        *
*/*%INCLUDE SYSLIB  (CDUPSPEC)                                        *
*/*%INCLUDE SYSLIB  (RDYUCB  )                                        *
*/*%INCLUDE SYSLIB  (RUCBSPEC)                                        *
*/*%INCLUDE SYSLIB  (WTORMT  )                                        *
*/*%INCLUDE SYSLIB  (WTORSPEC)                                        *
*/*%INCLUDE SYSLIB  (TESTRDY )                                        *
*/*%INCLUDE SYSLIB  (TESTSPEC)                                        *
*/*%INCLUDE SYSLIB  (READSER )                                        *
*/*%INCLUDE SYSLIB  (READSPEC)                                        *
*/*%INCLUDE SYSLIB  (CKVOLIST)                                        *
*/*%INCLUDE SYSLIB  (CKVLSPEC)                                        *
*/*%INCLUDE SYSLIB  (ERRPROC )                                        *
*/*%INCLUDE SYSLIB  (ERRSPEC )                                        *
*/*%INCLUDE SYSLIB  (CLEANUP )                                        *
*/*%INCLUDE SYSLIB  (CLENSPEC)                                        *
*/*%INCLUDE SYSLIB  (IEAPSPIO)                                        *
*/*%INCLUDE SYSLIB  (SETSTAT )                                        *
*/*%INCLUDE SYSLIB  (SETSSPEC)                                        *
*/*%INCLUDE SYSLIB  (EXCPSETP)                                        *
*/*%INCLUDE SYSLIB  (EXCPSPEC)                                        *
*;                                                              01S1410
@DATA    DS    0H
@CH00075 DC    H'6'
@CH00084 DC    H'7'
@CH00035 DC    H'8'
@CH01793 DC    H'14'
@CH00088 DC    H'19'
@CH00078 DC    H'20'
@CH00190 DC    H'22'
@CH00108 DC    H'40'
@CH00325 DC    H'44'
@CH02653 DC    H'64'
@CH00082 DC    H'72'
@CH00177 DC    H'80'
@CH00086 DC    H'300'
         DS    0F
@SA00001 DS    18F
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00001 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
         DS    0F
@CF00042 DC    F'1'
@CH00042 EQU   @CF00042+2
@CF00069 DC    F'2'
@CF00064 DC    F'3'
@CF00036 DC    F'4'
@CH00036 EQU   @CF00036+2
@CF00073 DC    F'5'
@CH00073 EQU   @CF00073+2
@CF00032 DC    F'12'
@CF00080 DC    F'16'
@CF02677 DC    F'-240'
@CF02680 DC    F'-4'
@CF02508 DC    XL4'80000000'
@CV00229 DC    V(IEFSCAN)
@CV00230 DC    V(UCBCONT)
         DS    0D
SWITCHES DS    FL4
         ORG   SWITCHES
DEFAULT  DS    BL1
PEND     EQU   SWITCHES+0
READ     EQU   SWITCHES+0
NODEV    EQU   SWITCHES+0
WTO      EQU   SWITCHES+0
GOODLIST EQU   SWITCHES+0
FOUND    EQU   SWITCHES+0
BADVAL   EQU   SWITCHES+0
BADREPLY DS    BL1
DPLOADED EQU   SWITCHES+1
ERROR    EQU   SWITCHES+1
MSG1     EQU   SWITCHES+1
MSG2     EQU   SWITCHES+1
MSSMNT   EQU   SWITCHES+1
DUPSER   EQU   SWITCHES+1
DUPADDR  EQU   SWITCHES+1
MSGSW    DS    BL1
FAILSW   EQU   SWITCHES+2
EXCPSW   EQU   SWITCHES+2
LOOPSW   EQU   SWITCHES+2
SUPPRESS EQU   SWITCHES+2
         ORG   SWITCHES+4
ERRMSG   DS    F
MACRF    DC    XL4'00008000'
OFLAGS   DC    XL4'12000000'
MAPAD    DS    A
PARMPTR  DS    A
DPPLIST  DS    A
DATAPATH DS    A
LUTSAVE  DS    A
UCBPTR   DS    A
CVTPTR   DS    A
ECBPTR   DS    A
IOBSTPTR DS    A
DEBPTR   DS    A
DEBDAPTR DS    A
DEBEXPTR DS    A
IOBPRPTR DS    A
DEBSBPTR DS    A
FINDADDR DS    FL4
         ORG   FINDADDR
FINDDEV  DS    CL3
@NM00004 DS    CL1
         ORG   FINDADDR+4
VAPECB   DS    F
NIPPMADR DS    A
NIPPMKPR DS    A
NIPPMNEG DC    XL4'FFFFFFFF'
NIPPMBDL DS    A
NIPPMDCB DS    A
ENDEXT   DC    XL2'FFFF'
NUMTRKS  DC    XL2'7FFF'
N        DS    H
I        DS    H
J        DS    H
K        DS    H
NEXTPTR  DS    H
DEVIND   DS    H
MNTIND   DS    H
IND      DS    H
VIND     DS    H
SCAN     DS    H
CHECK    DS    H
DEVMTCT  DS    H
TOMOUNT  DS    H
TABLECT  DS    H
MTLSTCT  DS    H
@TS00001 DS    CL22
@CC00142 DC    C'VATLST'
@CC00130 DC    C'VOL1'
@CC00134 DC    C'CONT'
@CC00132 DC    C'END'
@CC00136 DC    C'YES'
@CC02470 DC    C'P/R'
@CC02472 DC    C'RSV'
@CC02474 DC    C'STR'
@CC02476 DC    C'PRV'
@CC02478 DC    C'PUB'
@CC00138 DC    C'NO'
@CC00144 DC    C'00'
@CC00168 DC    C'U'''
@CC00170 DC    C' '''
@CC02480 DC    C' 1'
@CC02482 DC    C' 2'
@CC02484 DC    C' 3'
@CC02486 DC    C' 4'
@CC02488 DC    C' 5'
@CC02490 DC    C' 6'
@CC02492 DC    C' 7'
@CC02494 DC    C' 8'
@CC02496 DC    C' 9'
@CC02498 DC    C'10'
@CC02500 DC    C'11'
@CB02631 DC    X'00000000000000'
@CB00140 DC    X'2009'
BADADDR  DS    CL3
VAPSRCH  DC    X'0000000003'
ZEROSEEK DC    X'0000000000000000'
         ORG   ZEROSEEK
ZEROCSW  DS    CL7
         ORG   ZEROCSW
ZEROVOLI DS    CL6
         ORG   ZEROVOLI
ZEROVTOC DS    CL4
         ORG   ZEROVTOC
ZEROADDR DS    CL3
         ORG   ZEROSEEK+8
PROMPT   DC    CL8'VAL'
RDEND    DC    X'FF'
MSSVOL   DS    CL6
         DS    CL3
DPPARM   DS    CL8
         ORG   DPPARM
DPUCB    DS    AL4
DPFCETC  DC    F'0'
         ORG   DPPARM+8
WTORBUF  DS    CL80
RSNAREA  DS    CL5
         ORG   RSNAREA
RSNCDE   DS    FL4
         ORG   RSNAREA+5
TRPATN   DC    CL16'0123456789ABCDEF'
UNPKAR   DS    CL5
         DS    CL2
REGSAVE  DS    CL60
NIEEVDEV DC    CL8'IEEVDEV'
LABELBUF DS    CL80
         ORG   LABELBUF
VOL1     DS    CL4
VOLSER   DS    CL6
@NM00005 DS    CL1
VOLVTOC  DS    CL5
         ORG   LABELBUF+80
MBBCCHHR DS    CL8
         ORG   MBBCCHHR
MBB      DS    CL3
CCHHR    DS    CL5
         ORG   MBBCCHHR+8
@NM00006 DS    CL24
         ORG   @NM00006
CCW1     DS    CL8
         ORG   CCW1
@NM00007 DC    X'31'
SADDR1   DS    AL3
@NM00008 DC    X'4000'
COUNT1   DC    X'0005'
         ORG   @NM00006+8
CCW2     DS    CL8
         ORG   CCW2
@NM00009 DC    X'08'
SADDR2   DS    AL3
@NM00010 DC    X'0000'
COUNT2   DC    X'0000'
         ORG   @NM00006+16
CCW3     DS    CL8
         ORG   CCW3
@NM00011 DC    X'06'
SADDR3   DS    AL3
@NM00012 DC    X'0000'
COUNT3   DC    X'0000'
         ORG   @NM00006+24
@NM00014 DS    CL44
         ORG   @NM00014
VAPIOBF  DC    F'0'
VAPIOB   DC    10F'0'
         ORG   @NM00014+44
@NM00015 DS    CL60
         ORG   @NM00015
VAPDEB   DC    12F'0'
VAPDCB1  DC    3F'0'
         ORG   @NM00015+60
ICBDMLST DS    CL28
         ORG   ICBDMLST
DMLEN    DC    XL4'1C'
DMOPCD   DC    XL1'06'
DMNTRES1 DC    X'00'
DMNTFLAG DC    B'0000000000000000'
         ORG   DMNTFLAG
DMBITRE1 DS    BL1
DMDELRSP EQU   DMNTFLAG+0
DMVUAVAL EQU   DMNTFLAG+0
DMBITRES EQU   DMNTFLAG+0
         ORG   ICBDMLST+8
DMVOL    DC    XL6'0'
DMNTASID DC    XL2'0'
DMNTECB  DC    F'0'
DMHOST   DC    XL5'0'
DMNTRES2 DC    XL1'0'
DMNTVUA  DC    H'0'
         ORG   ICBDMLST+28
ICBMLST  DS    CL28
         ORG   ICBMLST
MDLEN    DC    XL4'1C'
MDOPCD   DC    XL1'08'
@NM00100 DC    X'00'
MDFLG    DC    B'0000000000000000'
         ORG   MDFLG
@NM00101 DS    BL1
MDVISMNT EQU   MDFLG+0
MDVSVRQ  EQU   MDFLG+0
MDSRTCH  EQU   MDFLG+0
MDMEXT   EQU   MDFLG+0
@NM00102 EQU   MDFLG+0
         ORG   ICBMLST+8
MDVOL    DS    CL6
         ORG   MDVOL
@NM00103 DC    6X'00'
         ORG   ICBMLST+14
MDVUA    DC    H'0'
MDHOST   DS    CL5
         ORG   MDHOST
@NM00104 DC    5X'00'
         ORG   ICBMLST+21
@NM00105 DS    CL3
         ORG   @NM00105
@NM00106 DC    3X'00'
         ORG   ICBMLST+24
MNTEXTP  DC    A(0)
         ORG   MNTEXTP
MDJFCB   DS    FL4
         ORG   ICBMLST+28
NIPPMMBC DS    CL8
         ORG   NIPPMMBC
NIPPMMBB DS    CL3
NIPPMCCH DS    CL5
         ORG   NIPPMMBC+8
NIPPMMK1 DC    B'11110010'
NIPPMMK2 DC    B'11110001'
NIPPMMK3 DC    B'00100000'
NIPPMNAM DC    CL8' '
MNTLIST  DS    CL22
         ORG   MNTLIST+0
MVOLSER  DS    CL6
@NM00001 DS    CL5
MDEVTYPE DS    CL8
@NM00002 DS    CL2
DEVENT   DS    AL1
         ORG   MNTLIST+6600
         DS    CL1
DEVTYPES DS    CL14
         ORG   DEVTYPES+0
ETYPE    DC    CL8'2305-1  '
UCBTYPE  DC    XL1'06'
         DS    CL1
DEVCT    DC    H'0'
AUXCT    DC    H'0'
         ORG   DEVTYPES+14
         ORG   DEVTYPES+14
         DC    CL8'2305-2  '
         DC    XL1'07'
         DS    CL1
         DC    H'0'
         DC    H'0'
         ORG   DEVTYPES+28
         ORG   DEVTYPES+28
         DC    CL8'2314    '
         DC    XL1'08'
         DS    CL1
         DC    H'0'
         DC    H'0'
         ORG   DEVTYPES+42
         ORG   DEVTYPES+42
         DC    CL8'3330    '
         DC    XL1'09'
         DS    CL1
         DC    H'0'
         DC    H'0'
         ORG   DEVTYPES+56
         ORG   DEVTYPES+56
         DC    CL8'3340    '
         DC    XL1'0A'
         DS    CL1
         DC    H'0'
         DC    H'0'
         ORG   DEVTYPES+70
         ORG   DEVTYPES+70
         DC    CL8'3330-1  '
         DC    XL1'0D'
         DS    CL1
         DC    H'0'
         DC    H'0'
         ORG   DEVTYPES+84
         ORG   DEVTYPES+84
         DC    CL8'3350    '
         DC    XL1'0B'
         DS    CL1
         DC    H'0'
         DC    H'0'
         ORG   DEVTYPES+98
         DS    CL2
DEVTABLE DS    CL8
         ORG   DEVTABLE+0
DEVICE   DS    CL3
         DS    CL1
UCBADDR  DS    AL4
         ORG   DEVTABLE+152
VECTAB   DS    5A
NIPPMREG DS    16F
IEAVAP00 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
IEAVAP00 CSECT
IEA409I  DS  0F                                                @ZA14221
         IEAPMNIP TYPE=HEADER,MSGST=IEA409I,MSGEND=END409I     @ZA14221
         DC  C'IEA409I UNABLE TO MOUNT MSS VOLUME '            @ZA14221
VOL409   DC  CL6' '                                            @ZA14221
         DC  C' ON V'                                          @ZA14221
DEV409   DC  CL3' '                                            @ZA14221
         DC  C', DEVICE NOT ACCESSIBLE.'                       @ZA14221
END409I  EQU *                                                 @ZA14221
*
*
IEA850I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA850I,MSGEND=END850I
         DC  C'IEA850I FOLLOWING WILL BE PROCESSED'            @YM00442
END850I  EQU *
*
*
IEA850I2 DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA850I2,MSGEND=END850I2,OPT=(,NBC)
SER850   DC  CL6' '                    FILL IN VOLUME SERIAL NUMBER
         DC  C' ON '
DEV850   DC  CL8' '                    FILL IN DEVICE TYPE     @YM00442
         DC  CL1' '
MT850    DC  CL3' '                    FILL IN MOUNT ATTRIBUTE
         DC  CL1'-'
USE850   DC  CL3' '                    FILL IN USE ATTRIBUTE
END850I2 EQU *
*
*
IEA851I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA851I,MSGEND=END851I
         DC  C'IEA851I FOLLOWING MAY BE MOUNTED'
END851I  EQU *
*
*
IEA851I2 DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA851I2,MSGEND=END851I2,OPT=(,NBC)
SER851   DC  CL6' '                    FILL IN VOLUME SERIAL NUMBER
         DC  C' ON '
DEV851   DC  CL8' '                    FILL IN DEVICE TYPE
END851I2 EQU *
*
*
IEAH851A DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEAH851A,MSGEND=END851A
         DC  C'IEA851A REPLY DEVICE ADDRESSES OR U.'
END851A  EQU *
*
*
IEA851A  DS  0F
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH851A,   X
               ASYNCH='NO'
*
*
IEA852I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA852I,MSGEND=END852I
         DC  C'IEA852I '
DEV852   DC  CL3' '
         DC  C' ADDRESS INVALID - '
R852     DC  CL2' '                                            @YM02792
END852I  EQU  *
*
*
IEAH852A DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEAH852A,MSGEND=END852A
         DC  C'IEA852A REPEAT REPLY.'
END852A  EQU *
*
*
IEA852A  DS  0F
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH852A,   X
               ASYNCH='NO'
*
*
IEAH853A DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEAH853A,MSGEND=END853A
         DC  C'IEA853A REPLY CONT, END OR RESPECIFY.'          @YM00442
END853A  EQU *
*
*
IEA853A  DS  0F
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH853A,   X
               ASYNCH='NO'
*
*
IEA854I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA854I,MSGEND=END854I
         DC  C'IEA854I ERROR READING VOLUME LABEL. '
END854I  EQU *
*
*
IEA855I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA855I,MSGEND=END855I
         DC  C'IEA855I INVALID VATLST'
NN855    DC  CL2' '                    FILL IN VATLST NUMBER
         DC  C' ENTRY.'
END855I  EQU *
*
*
IEA859I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA859I,MSGEND=END859I
         DC  C'IEA859I UNREQUESTED VOLUME. UNIT '
DEV859   DC  CL3' '                    FILL IN UNIT ADDRESS
         DC  C' NOW UNLOADED.'
END859I  EQU *
*
*
IEA860A  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA860A,MSGEND=END860A
DEV860   DS  CL80                      FILL IN UNIT ADDRESSES
END860A  EQU *
*
*
IEAH8602 DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEAH8602,MSGEND=END8602
         DC  C'IEA860A REPLY U WHEN ALL DEVICES ARE READY.'    @YM02783
END8602  EQU *
*
*
IEA8602  DS  0F
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH8602,   X
               ASYNCH='NO'                                     @YM07218
*
*
IEAH861A DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEAH861A,MSGEND=END861A
         DC  C'IEA861A VAL='
NN861    DC  CL2' '                    FILL IN VATLST NUMBER
         DC  C' NOT FOUND. REPLY U OR CORRECT VALUE.'
END861A  EQU *
*
*
IEA861A  DS  0F
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH861A,   X
               ASYNCH='NO'
*
*
IEA866I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA866I,MSGEND=END866I
         DC  C'IEA866I VOLUME '
SER866   DC  CL6' '
         DC  C' ON '
V866     DC  C' '                                              @Y30LPPD
DEV866   DC  CL3' '
         DC  C' REQUIRED ON A '
DT866    DC  CL8' '
END866I  EQU *
*
*
IEA867I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA867I,MSGEND=END867I
         DC  C'IEA867I DUPLICATE VOLUME '
SER867   DC  CL6' '                    FILL IN VOLUME SERIAL NUMBER
         DC  C'. UNIT '
DEV867   DC  CL3' '                    FILL IN UNIT ADDRESS
         DC  C' NOW UNLOADED.'
END867I  EQU *
*
*
IEAH893A DS  0F                                                @YM02783
         IEAPMNIP TYPE=HEADER,MSGST=IEAH893A,MSGEND=END893A    @YM02783
         DC  C'IEA893A NOT READY. REPLY U WHEN DEVICES ARE '
         DC  C'READY OR NO IF NOT MOUNTING.'                   @YM02783
END893A  EQU *                                                 @YM02783
*
*
IEA893A  DS  0F                                                @YM02783
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH893A,   X
               ASYNCH='NO'                                     @YM02783
*
*
IEA894I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA894I,MSGEND=END894I
         DC  C'IEA894I REQUESTED VOLUME ON UNREQUESTED UNIT. '
DEV894   DC  CL3' '
         DC  C' NOW UNLOADED.'
END894I  EQU  *
*
*
IEAH895A DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEAH895A,MSGEND=END895A
         DC  C'IEA895A FORMAT ERROR. REPEAT REPLY.'
END895A  EQU  *
*
*
IEA895A  DS  0F
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH895A,   X
               ASYNCH='NO'
*
*
IEA948I  DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEA948I,MSGEND=END948I
         DC  C'IEA948I '
V948     DC  C' '                                              @Y30LPPD
DEV948   DC  CL3' '
         DC  C' NOW UNLOADED.'
END948I  EQU *
*
*
IEAH947A DS  0F
         IEAPMNIP TYPE=HEADER,MSGST=IEAH947A,MSGEND=END947A
         DC  C'IEA947A REPLY U TO CONTINUE, OR RE-IPL.'
END947A  EQU *
*
*
IEA947A  DS  0F
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH947A,   X
               ASYNCH='NO'                                     @YM07218
*
*
IEA949I  DS  0F                                                @YM00442
         IEAPMNIP TYPE=HEADER,MSGST=IEA949I,MSGEND=END949I     @YM00442
         DC  C'IEA949I I/O ERROR READING VATLST'               @YM00442
NN949    DC  CL2' '                                            @YM00442
         DC  C'.'                                              @YM00442
END949I  EQU *                                                 @YM00442
*
*
IEAH949A DS  0F                                                @YM00442
         IEAPMNIP TYPE=HEADER,MSGST=IEAH949A,MSGEND=END949A    @YM00442
         DC  C'IEA949A REPLY YES FOR LIST OF ENTRIES '         @YM00442
         DC  C'THAT WILL BE PROCESSED, OR U FOR NO LIST.'      @YM00442
END949A  EQU *                                                 @YM00442
*
*
IEA949A  DS  0F                                                @YM00442
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH949A,   X
               ASYNCH='NO'                                     @YM07218
*
*
IEA985I DS  0F                                                 @Y30LPPD
        IEAPMNIP TYPE=HEADER,MSGST=IEA985I,MSGEND=END985I      @Y30LPPD
        DC  C'IEA985I UNABLE TO UNLOAD MSS VOLUME '            @Y30LPPD
VOL985  DC  CL6' '                                             @Y30LPPD
        DC  C' FROM V'                                         @Y30LPPD
DEV985  DC  CL3' '                                             @Y30LPPD
        DC  C' - RC='                                          @Y30LPPD
RET985  DC  CL3' '                                             @Y30LPPD
        DC  C'.'                                               @Y30LPPD
END985I EQU *                                                  @Y30LPPD
*                                                              @Y30LPPD
*                                                              @Y30LPPD
IEA986I  DS    0F                                              @Y30LPPD
         IEAPMNIP TYPE=HEADER,MSGST=IEA986I,MSGEND=END986I     @Y30LPPD
         DC    C'IEA986I MSS VOLUME '                          @Y30LPPD
VOL986   DC    CL6' '                                          @Y30LPPD
         DC    C' REQUIRED ON V'                               @Y30LPPD
DEV986   DC    CL3' '                                          @Y30LPPD
         DC    C'.'                                            @Y30LPPD
END986I  EQU   *                                               @Y30LPPD
*                                                              @Y30LPPD
*                                                              @Y30LPPD
IEA987I  DS    0F                                              @Y30LPPD
         IEAPMNIP TYPE=HEADER,MSGST=IEA987I,MSGEND=END987I     @Y30LPPD
         DC    C'IEA987I UNABLE TO MOUNT MSS VOLUME '          @Y30LPPD
VOL987   DC    CL6' '                                          @Y30LPPD
         DC    C' ON V'                                        @Y30LPPD
DEV987   DC    CL3' '                                          @Y30LPPD
         DC    C' - RC='                                       @Y30LPPD
RET987   DC    CL3' '                                          @Y30LPPD
         DC    C'.'                                            @Y30LPPD
END987I  EQU   *                                               @Y30LPPD
*                                                              @Y30LPPD
IEAVAP00 CSECT
NIPMNT   IEAPMNIP TYPE=MOUNTPL,PARAM=DUMMY
IEAVAP00 CSECT
*NIPPMMS1 DS   0F                                               Y02752
NIPPMMS1 DS    0F                                               Y02752
         IEAPMNIP TYPE=HEADER,MSGST=NIPPMMS1,MSGEND=NIPPMED1    Y02752
         DC    CL34'IEA300I I/O ERROR DURING BLDL FOR '
*NIPPMMB1  EQU *                                                Y02752
NIPPMMB1 DC    CL8'        '
         DC    CL16' IN SYS1.PARMLIB'
*NIPPMED1 EQU   *                                               Y02752
NIPPMED1 EQU   *                                                Y02752
         SPACE 1
*NIPPMMS2 DS    0F                                              Y02752
NIPPMMS2 DS    0F                                               Y02752
         IEAPMNIP TYPE=HEADER,MSGST=NIPPMMS2,MSGEND=NIPPMED2
         DC    CL8'IEA301I '
*NIPPMMB2 EQU  *                                                Y02752
NIPPMMB2 DC    CL8'        '                                    Y02752
         DC    CL26' NOT FOUND IN SYS1.PARMLIB'
*NIPPMED2 EQU   *                                               Y02752
NIPPMED2 EQU   *                                                Y02752
IEAVAP00 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
REG1FIX  EQU   @01
REG0     EQU   @00
RTTR     EQU   @00
RPARM    EQU   @01
RCCHHR   EQU   @02
REG4     EQU   @04
RCODE    EQU   @15
FINDPATH EQU   @00
RNVT     EQU   @02
RCVT     EQU   @03
REXIT    EQU   @14
RENTRY   EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR15F   EQU   @15
MDREG1   EQU   @01
NIPPMR00 EQU   @00
NIPPMR01 EQU   @01
NIPPMR02 EQU   @02
NIPPMR13 EQU   @13
NIPPMR14 EQU   @14
NIPPMR15 EQU   @15
NIPPMR06 EQU   @06
NIPPMR09 EQU   @09
NIPPMR12 EQU   @12
ENTRIE   EQU   0
MNTENTRY EQU   ENTRIE
EVOLSER  EQU   MNTENTRY
DELIM1   EQU   MNTENTRY+6
EMNTCHAR EQU   MNTENTRY+7
DELIM2   EQU   MNTENTRY+8
EUSEATTR EQU   MNTENTRY+9
DELIM3   EQU   MNTENTRY+10
EDEVTYPE EQU   MNTENTRY+11
DELIM4   EQU   MNTENTRY+19
EMNTPRIO EQU   MNTENTRY+20
VATPARMS EQU   0
TRANSTAB EQU   0
WTORDCB  EQU   0
CVTMAP   EQU   0
CVTPCNVT EQU   CVTMAP+28
CVTPRLTV EQU   CVTMAP+32
CVTILK2  EQU   CVTMAP+40
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTBRET  EQU   CVTMAP+82
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTICB   EQU   CVTXTNT2+48
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
ICB2SSCB EQU   0
ICBOPT   EQU   ICB2SSCB+48
ICBFLG   EQU   ICB2SSCB+52
ICBFG1   EQU   ICBFLG
ICBI     EQU   ICBFG1
ICBTRACE EQU   ICB2SSCB+112
NVT      EQU   0
NVTNPATR EQU   NVT+54
NVTNPREN EQU   NVTNPATR
NVTFLLB  EQU   NVT+55
NVTABSAV EQU   NVT+140
NVTFLCN  EQU   NVT+211
NVTWTPSW EQU   NVT+224
NVTWPSW2 EQU   NVTWTPSW+4
NVTFLWSC EQU   NVTWPSW2+3
NVTLOAD  EQU   NVT+232
NVTSENSE EQU   NVT+236
NVTSWAIT EQU   NVT+240
NVTTIME  EQU   NVT+244
NVTUCBFN EQU   NVT+248
NVTWTO   EQU   NVT+252
NVTWTOR  EQU   NVT+256
NVTWTOR2 EQU   NVT+260
NVTOPEN  EQU   NVT+264
NVTMOUNT EQU   NVT+268
NVTPRMPT EQU   NVT+272
NVTVIRT  EQU   NVT+276
NVTREAL  EQU   NVT+280
NVTSCHED EQU   NVT+284
NVTOPIO  EQU   NVT+288
NVTDCBIC EQU   NVT+324
NVTPAREA EQU   NVT+368
NVTPTAB  EQU   NVT+372
NVTXCTL  EQU   NVT+428
NVTLOCAT EQU   NVT+436
NVTFLPO  EQU   NVT+528
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBONLI  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBNOTRD EQU   UCBNRY
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBMTPXP EQU   UCBWGT
UCBNAME  EQU   UCBOB+13
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCBRVDEV EQU   UCBRWTAU
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3DACC EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00039 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
NIPPAHDR EQU   0
NIPPAREA EQU   0
NIPPARC  EQU   NIPPAREA+8
NIPPABDL EQU   NIPPAREA+12
NIPPABDH EQU   NIPPABDL
NIPPANAM EQU   NIPPABDL+4
NIPPATTR EQU   NIPPABDL+12
NIPPAIOD EQU   NIPPAREA+32
NIPPASID EQU   NIPPAIOD+32
NIPPAIOB EQU   NIPPAIOD+40
NIPPADCB EQU   NIPPAIOD+80
NIPPAECB EQU   NIPPAIOD+84
NIPPAECC EQU   NIPPAECB
NIPPADEB EQU   NIPPAIOD+88
NIPPARCD EQU   NIPPAIOD+136
PARMTAB  EQU   0
VAL      EQU   PARMTAB+232
@NM00079 EQU   PARMTAB+272
NIPPAFLG EQU   @NM00079
NIPPAFL1 EQU   NIPPAFLG
NIPPTE   EQU   0
NIPPTOPF EQU   NIPPTE+4
NIPPTATF EQU   NIPPTE+5
NWTOHDR  EQU   0
NWTOFL   EQU   NWTOHDR+2
NWTORLST EQU   0
NWTORFL  EQU   NWTORLST+10
NIPSPE   EQU   0
NIPMNTPL EQU   0
NMNTDS   EQU   NIPMNTPL
NMNTVS   EQU   NIPMNTPL+12
NMNTFL   EQU   NIPMNTPL+20
NIPOPNPL EQU   0
NOPNDS   EQU   NIPOPNPL
NOPNFL   EQU   NIPOPNPL+20
NIPSCHDL EQU   0
ECB      EQU   0
ECBRB    EQU   ECB
ECBEVTB  EQU   ECBRB
ECBEXTB  EQU   ECBEVTB
ECBCC    EQU   ECBEXTB
ECBCCCNT EQU   ECBEXTB+1
ECBRBA   EQU   ECBCCCNT
ECBEVTBA EQU   ECBRBA
ECBEXTBA EQU   ECBEVTBA
ECBBYTE3 EQU   ECBEXTBA+2
ECBEXTND EQU   ECBBYTE3
IOBPREFX EQU   0
IOBCFLG1 EQU   IOBPREFX
IOBSTDRD EQU   0
IOBFLAG1 EQU   IOBSTDRD
IOBCYCCK EQU   IOBFLAG1
IOBRSTRT EQU   IOBFLAG1
IOBFLAG2 EQU   IOBSTDRD+1
IOBPURGE EQU   IOBFLAG2
IOBRDHA0 EQU   IOBFLAG2
IOBSENS0 EQU   IOBSTDRD+2
IOBS0B7  EQU   IOBSENS0
IOBSENS1 EQU   IOBSTDRD+3
IOBECBPT EQU   IOBSTDRD+4
IOBFLAG3 EQU   IOBSTDRD+8
IOBFL3   EQU   IOBFLAG3
IOBCNC   EQU   IOBFL3
IOBICL   EQU   IOBFL3
IOBCSW   EQU   IOBSTDRD+9
IOBIOCSW EQU   IOBCSW
IOBSTBYT EQU   IOBIOCSW+3
IOBUSTAT EQU   IOBSTBYT
IOBCSTAT EQU   IOBSTBYT+1
IOBSTART EQU   IOBSTDRD+16
IOBDCBPT EQU   IOBSTDRD+20
IOBFLAG4 EQU   IOBDCBPT
IOBRESTR EQU   IOBSTDRD+24
IOBINCAM EQU   IOBSTDRD+28
IOBBTAMF EQU   IOBINCAM
IOBERRCT EQU   IOBSTDRD+30
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBUSRPG EQU   DEBBASIC+16
DEBNMEXT EQU   DEBUSRPG
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBDEBID EQU   DEBPROTG
DEBDCBB  EQU   DEBDCBAD+1
DEBAPPAD EQU   DEBBASIC+28
DEBEXSCL EQU   DEBAPPAD
DEBAPPB  EQU   DEBAPPAD+1
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBUCBA  EQU   DEBUCBAD+1
DEBENDCC EQU   DEBDASD+10
DEBENDHH EQU   DEBDASD+12
DEBNMTRK EQU   DEBDASD+14
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
DEVMSG   EQU   0
UNITAD   EQU   DEVMSG
COM      EQU   DEVMSG+3
NIPPMAD0 EQU   0
NIPPMAD4 EQU   0
NIPPMBYT EQU   0
NIPPMBUF EQU   0
NIPPMSID EQU   0
NIPPMCC  EQU   NIPPMSID
NIPPMHH  EQU   NIPPMSID+2
NIPPMR   EQU   NIPPMSID+4
NIPPMCSW EQU   0
NIPPMCS2 EQU   NIPPMCSW+3
NIPPMME1 EQU   0
NIPPMME2 EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
UCBBGN   EQU   0
@NM00003 EQU   NIPPANAM
PLIBMEM  EQU   @NM00003
SUFFIX   EQU   @NM00003+6
REPLAREA EQU   WTORBUF
REPENTRY EQU   REPLAREA
UNIT     EQU   REPENTRY
DELIM    EQU   REPENTRY+3
SCAN4    EQU   WTORBUF
SCAN3    EQU   SCAN4
SCAN2    EQU   SCAN3
SCAN2A   EQU   SCAN3+2
@NM00016 EQU   VAPDCB1
DCBMACRF EQU   @NM00016
DCBDEBAD EQU   @NM00016+5
DCBOFLGS EQU   @NM00016+8
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
UCBOBS01 EQU   UCBDEV
UCBVTOC  EQU   UCBOBS01
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBBASE  EQU   UCBOBS01+16
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00038 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
IOBORG01 EQU   IOBPREFX+8
IOBNIOBA EQU   IOBORG01
IOBNFLG1 EQU   IOBNIOBA
IOBPRTOV EQU   IOBNFLG1
IOBORG02 EQU   IOBPREFX+8
IOBDQADA EQU   IOBORG02
IOBDEQIN EQU   IOBDQADA
IOBORG03 EQU   IOBPREFX+12
IOBORG04 EQU   IOBINCAM
IOBORG12 EQU   IOBINCAM
IOBFL4   EQU   IOBORG12
IOBEXTEN EQU   IOBSTDRD+32
IOBSEEK  EQU   IOBEXTEN
IOBBB    EQU   IOBSEEK+1
IOBCC    EQU   IOBSEEK+3
IOBHH    EQU   IOBSEEK+5
IOBR     EQU   IOBSEEK+7
IOBORG05 EQU   IOBEXTEN
IOBORG06 EQU   IOBEXTEN
IOBNXTPT EQU   IOBORG06+4
IOBSTATA EQU   IOBNXTPT
IOBORG07 EQU   IOBEXTEN+8
W1IEXTEN EQU   IOBORG07
IOBORG08 EQU   IOBEXTEN+8
IOBINDCT EQU   IOBORG08+4
IOBUNSQR EQU   IOBORG08+5
IOBFCHAD EQU   IOBORG08+8
IOBORG09 EQU   IOBEXTEN+8
IOBDPLAD EQU   IOBORG09+4
IOBDTYPE EQU   IOBORG09+8
IOBDTYP2 EQU   IOBORG09+9
IOBDSTAT EQU   IOBORG09+10
IOBSTAT1 EQU   IOBDSTAT
IOBORG10 EQU   IOBEXTEN+8
IOBSEEK2 EQU   IOBORG10
IOBORG11 EQU   IOBEXTEN
IOBERCT  EQU   IOBORG11
IOBUCBXV EQU   IOBERCT
IOBNAME  EQU   IOBORG11+4
IOBORG13 EQU   IOBEXTEN
IOBSKADR EQU   IOBORG13
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSUCBB EQU   DEBSUCBA+1
DEBSDVM  EQU   DEBSUCBA
IOBSKSS  EQU   IOBSKADR+3
IOBSK0   EQU   IOBSKADR+2
IOBSKTT  EQU   IOBSKADR+1
IOBSKRV  EQU   IOBSKADR
IOBCSWSV EQU   IOBORG11+17
IOBSENSV EQU   IOBORG11+16
IOBRCD   EQU   IOBORG11+12
IOBMDREC EQU   IOBORG11+8
IOBNAMEA EQU   IOBNAME+1
IOBNAMSZ EQU   IOBNAME
IOBERCTA EQU   IOBERCT+1
IOBRTYPE EQU   IOBUCBXV
IOBRDCHP EQU   IOBORG10+20
IOBNEXTA EQU   IOBORG10+16
IOBREADA EQU   IOBORG10+12
IOBBUFC  EQU   IOBORG10+8
IOBSK2R  EQU   IOBSEEK2+7
IOBSK2HH EQU   IOBSEEK2+5
IOBSK2CC EQU   IOBSEEK2+3
IOBSK2BB EQU   IOBSEEK2+1
IOBSK2M  EQU   IOBSEEK2
IOBCHNPR EQU   IOBORG09+40
IOBDNCRF EQU   IOBORG09+32
IOBRSV35 EQU   IOBORG09+24
IOBDQPTR EQU   IOBORG09+20
IOBRSV34 EQU   IOBORG09+18
IOBDBYTN EQU   IOBORG09+16
IOBDCPND EQU   IOBORG09+12
IOBSTAT2 EQU   IOBDSTAT+1
IOBSIORT EQU   IOBSTAT1
IOBADDVU EQU   IOBSTAT1
IOBBUFF  EQU   IOBSTAT1
IOBENQUE EQU   IOBSTAT1
IOBPASS2 EQU   IOBSTAT1
IOBSYNCH EQU   IOBSTAT1
IOBNEWVL EQU   IOBSTAT1
IOBABNRM EQU   IOBSTAT1
IOBRELEX EQU   IOBDTYP2
IOBADDTY EQU   IOBDTYP2
IOBTYPE  EQU   IOBDTYP2
IOBRQUST EQU   IOBDTYP2
IOBSUFFX EQU   IOBDTYP2
IOBSBLKL EQU   IOBDTYP2
IOBSKEY  EQU   IOBDTYP2
IOBRELBL EQU   IOBDTYPE
IOBRDEXC EQU   IOBDTYPE
IOBDYNBF EQU   IOBDTYPE
IOBACTAD EQU   IOBDTYPE
IOBFDBCK EQU   IOBDTYPE
IOBEXTSC EQU   IOBDTYPE
IOBOVFLO EQU   IOBDTYPE
IOBVERFY EQU   IOBDTYPE
IOBDPLB  EQU   IOBDPLAD+1
IOBDAYLI EQU   IOBDPLAD
IOBDIOBS EQU   IOBORG09+2
IOBDBYTR EQU   IOBORG09
IOBBCHAD EQU   IOBORG08+12
IOBFCHNB EQU   IOBFCHAD+1
IOBCOUNT EQU   IOBFCHAD
IOBASYN  EQU   IOBORG08+7
IOBAPP   EQU   IOBORG08+6
IOBRSV32 EQU   IOBUNSQR
IOBRSV31 EQU   IOBUNSQR
IOBRSV30 EQU   IOBUNSQR
IOBKNRWR EQU   IOBUNSQR
IOBKNWR  EQU   IOBUNSQR
IOBNTAV2 EQU   IOBUNSQR
IOBNTAV1 EQU   IOBUNSQR
IOBCPBSY EQU   IOBUNSQR
IOBCHNNL EQU   IOBINDCT
IOBRSV29 EQU   IOBINDCT
IOBRSV28 EQU   IOBINDCT
IOBRSV27 EQU   IOBINDCT
IOBKEYAD EQU   IOBINDCT
IOBOVPTR EQU   IOBINDCT
IOBUNSCH EQU   IOBINDCT
IOBDEQCP EQU   IOBINDCT
IOBCCWAD EQU   IOBORG08
W1OEXTEN EQU   W1IEXTEN
IOBCCW   EQU   IOBORG06+8
IOBNXTPB EQU   IOBNXTPT+1
IOBRSV26 EQU   IOBSTATA
IOBRSV25 EQU   IOBSTATA
IOBRSV24 EQU   IOBSTATA
IOBRSV23 EQU   IOBSTATA
IOBRSV22 EQU   IOBSTATA
IOBRSV21 EQU   IOBSTATA
IOBRSV20 EQU   IOBSTATA
IOBAVLFL EQU   IOBSTATA
IOBRSV37 EQU   IOBORG06+1
IOBUCBXG EQU   IOBORG06
IOBCPA   EQU   IOBORG05+32
IOBERINF EQU   IOBORG05+16
IOBERCCW EQU   IOBORG05+8
IOBSNDPT EQU   IOBORG05+7
IOBRCVPT EQU   IOBORG05+6
IOBWORK  EQU   IOBORG05+1
IOBUCBX  EQU   IOBORG05
IOBHH2   EQU   IOBHH+1
IOBHH1   EQU   IOBHH
IOBCC2   EQU   IOBCC+1
IOBCC1   EQU   IOBCC
IOBBB2   EQU   IOBBB+1
IOBBB1   EQU   IOBBB
IOBM     EQU   IOBSEEK
IOBRSV46 EQU   IOBFL4
IOBRSV47 EQU   IOBFL4
IOBENT   EQU   IOBFL4
IOBEQP   EQU   IOBFL4
IOBBUS   EQU   IOBFL4
IOBDCK   EQU   IOBFL4
IOBREJ   EQU   IOBFL4
IOBOVR   EQU   IOBFL4
IOBCRILC EQU   IOBORG04+1
IOBCRDCC EQU   IOBORG04
IOBGQECB EQU   IOBORG03
IOBSWAP  EQU   IOBORG02+4
IOBDQADB EQU   IOBDQADA+1
IOBRSV13 EQU   IOBDEQIN
IOBRSV12 EQU   IOBDEQIN
IOBRSV11 EQU   IOBDEQIN
IOBRSV10 EQU   IOBDEQIN
IOBRSV09 EQU   IOBDEQIN
IOBRSV08 EQU   IOBDEQIN
IOBRSV07 EQU   IOBDEQIN
IOBDEQ   EQU   IOBDEQIN
IOBNECB  EQU   IOBORG01+4
IOBNIOBB EQU   IOBNIOBA+1
IOBFIRST EQU   IOBNFLG1
IOBUPERR EQU   IOBNFLG1
IOBSPAN  EQU   IOBNFLG1
IOBBKSPC EQU   IOBNFLG1
IOBUPDAT EQU   IOBNFLG1
IOBREAD  EQU   IOBNFLG1
IOBWRITE EQU   IOBNFLG1
IOBSEGMT EQU   IOBPRTOV
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00038
UCBSKPFG EQU   @NM00038
UCBRIPND EQU   @NM00038
UCBRTIAC EQU   @NM00038
UCBRSV79 EQU   @NM00038
UCBRSV78 EQU   @NM00038
UCBRSV77 EQU   @NM00038
UCBOLTEP EQU   @NM00038
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00037 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBMAT   EQU   UCBFL4
UCBHOLD  EQU   UCBFL4
UCBATTN  EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
VAPIFLGS EQU   @NM00016+4
SCAN1    EQU   SCAN2A
@NM00108 EQU   NIPPMCSW+4
@NM00107 EQU   NIPPMCSW
DEBXSAMB EQU   DEBXTN+28
DEBXOPNJ EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDCBM EQU   DEBXTN+8
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXDSSI EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBLNGTH EQU   DEBPREFX+12
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCEAD EQU   DEBXCEA+1
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCEAD  EQU   DEBCEA+1
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCIAD EQU   DEBPCIA+1
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIOAD EQU   DEBSIOA+1
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOEAD EQU   DEBEOEA+1
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBESMVR EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00099 EQU   DEBACS08+12
@NM00098 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00097 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00096 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBLRECL EQU   DEBACSMD+14
DEBBLKSI EQU   DEBACSMD+12
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBSTRHH EQU   DEBDASD+8
DEBSTRCC EQU   DEBDASD+6
DEBBINUM EQU   DEBDASD+4
DEBDVMOD EQU   DEBUCBAD
DEBECBB  EQU   DEBECBAD+1
DEBPRIOR EQU   DEBECBAD
DEBUSRPB EQU   DEBUSRPG+1
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBCINDI EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBRLSE  EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBTCBB  EQU   DEBTCBAD+1
DEBNMSUB EQU   DEBTCBAD
IOBRSV19 EQU   IOBINCAM+1
IOBOLTST EQU   IOBBTAMF
IOBRFTMG EQU   IOBBTAMF
IOBRSV17 EQU   IOBBTAMF
IOBRSV16 EQU   IOBBTAMF
IOBRSV15 EQU   IOBBTAMF
IOBRSV14 EQU   IOBBTAMF
IOBINUSE EQU   IOBBTAMF
IOBPRMER EQU   IOBBTAMF
IOBRSTRB EQU   IOBRESTR+1
IOBREPOS EQU   IOBRESTR
IOBDCBPB EQU   IOBDCBPT+1
IOBRSV44 EQU   IOBFLAG4
IOBJES3I EQU   IOBFLAG4
IOBRSV42 EQU   IOBFLAG4
IOBRSV41 EQU   IOBFLAG4
IOBRSV40 EQU   IOBFLAG4
IOBPMERR EQU   IOBFLAG4
IOBCC3WE EQU   IOBFLAG4
IOBGDPOL EQU   IOBFLAG4
IOBSTRTB EQU   IOBSTART+1
IOBSIOCC EQU   IOBSTART
IOBCSB7  EQU   IOBCSTAT
IOBCSB6  EQU   IOBCSTAT
IOBCSB5  EQU   IOBCSTAT
IOBCSB4  EQU   IOBCSTAT
IOBCSB3  EQU   IOBCSTAT
IOBCSB2  EQU   IOBCSTAT
IOBCSB1  EQU   IOBCSTAT
IOBCSB0  EQU   IOBCSTAT
IOBUSB7  EQU   IOBUSTAT
IOBUSB6  EQU   IOBUSTAT
IOBUSB5  EQU   IOBUSTAT
IOBUSB4  EQU   IOBUSTAT
IOBUSB3  EQU   IOBUSTAT
IOBUSB2  EQU   IOBUSTAT
IOBUSB1  EQU   IOBUSTAT
IOBUSB0  EQU   IOBUSTAT
IOBCMDA  EQU   IOBIOCSW
IOBLOG   EQU   IOBFL3
IOBJAM   EQU   IOBICL
IOBMSG   EQU   IOBFL3
IOBSDR   EQU   IOBCNC
IOBACU   EQU   IOBFL3
IOBCDC   EQU   IOBFL3
IOBICC   EQU   IOBFL3
IOBCCC   EQU   IOBFL3
IOBECBPB EQU   IOBECBPT+1
IOBECBCC EQU   IOBECBPT
IOBS1B7  EQU   IOBSENS1
IOBS1B6  EQU   IOBSENS1
IOBS1B5  EQU   IOBSENS1
IOBS1B4  EQU   IOBSENS1
IOBS1B3  EQU   IOBSENS1
IOBS1B2  EQU   IOBSENS1
IOBS1B1  EQU   IOBSENS1
IOBS1B0  EQU   IOBSENS1
IOBSNSC9 EQU   IOBS0B7
IOBS0B6  EQU   IOBSENS0
IOBS0B5  EQU   IOBSENS0
IOBS0B4  EQU   IOBSENS0
IOBS0B3  EQU   IOBSENS0
IOBS0B2  EQU   IOBSENS0
IOBS0B1  EQU   IOBSENS0
IOBS0B0  EQU   IOBSENS0
IOBPNCH  EQU   IOBFLAG2
IOBSTATO EQU   IOBFLAG2
IOBSKUPD EQU   IOBFLAG2
IOBALTTR EQU   IOBFLAG2
IOBRRT2  EQU   IOBRDHA0
IOBRRT3  EQU   IOBPURGE
IOBSENSE EQU   IOBFLAG2
IOBHALT  EQU   IOBFLAG2
IOBSPSVC EQU   IOBRSTRT
IOBUNREL EQU   IOBFLAG1
IOBIOERR EQU   IOBFLAG1
IOBFCREX EQU   IOBCYCCK
IOBRPSTN EQU   IOBFLAG1
IOBERRTN EQU   IOBFLAG1
IOBCMDCH EQU   IOBFLAG1
IOBDATCH EQU   IOBFLAG1
IOBCNOPA EQU   IOBPREFX+12
IOBCICB  EQU   IOBPREFX+8
IOBCECB  EQU   IOBPREFX+4
IOBCONOP EQU   IOBPREFX+3
IOBCINOP EQU   IOBPREFX+2
IOBRSV05 EQU   IOBPREFX+1
IOBPCI   EQU   IOBCFLG1
IOBRSTCH EQU   IOBCFLG1
IOBABAPP EQU   IOBCFLG1
IOBPTST  EQU   IOBCFLG1
IOBRSV04 EQU   IOBCFLG1
IOBRSV03 EQU   IOBCFLG1
IOBRSV02 EQU   IOBCFLG1
IOBRSV01 EQU   IOBCFLG1
ECBEVNT  EQU   ECBEXTND
@NM00095 EQU   ECBEXTND
@NM00094 EQU   ECBBYTE3
@NM00093 EQU   ECBEXTBA
@NM00092 EQU   ECBCC
ECBPOSTB EQU   ECBCC
ECBWAITB EQU   ECBCC
NSCHDCPU EQU   NIPSCHDL+8
NSCHDPRM EQU   NIPSCHDL+4
NSCHDPTR EQU   NIPSCHDL
@NM00091 EQU   NIPOPNPL+22
NOPNRC   EQU   NIPOPNPL+21
NOPNFLSX EQU   NOPNFL
NOPNFLLC EQU   NOPNFL
NOPNFLLB EQU   NOPNFL
NOPNFLNB EQU   NOPNFL
NOPNFLI  EQU   NOPNFL
NOPNFLM  EQU   NOPNFL
NOPNFAU  EQU   NOPNFL
NOPNFRS  EQU   NOPNFL
NOPNUCB  EQU   NIPOPNPL+16
NOPNDCB  EQU   NIPOPNPL+12
NOPNDSA  EQU   NOPNDS
@NM00090 EQU   NIPMNTPL+21
NMNTFLB  EQU   NMNTFL
NMNTFLC  EQU   NMNTFL
NMNTFLI  EQU   NMNTFL
NMNTFUS  EQU   NMNTFL
@NM00089 EQU   NMNTFL
NMNTDT   EQU   NIPMNTPL+18
NMNTUCB  EQU   NMNTVS
NMNTDSA  EQU   NMNTDS
NIPSPEA  EQU   NIPSPE+4
NIPSPEQ  EQU   NIPSPE
NWTORMSG EQU   NWTORLST+12
@NM00088 EQU   NWTORLST+11
@NM00087 EQU   NWTORFL
NWTORFLB EQU   NWTORFL
@NM00086 EQU   NWTORFL
NWTORFLA EQU   NWTORFL
NMTORRDL EQU   NWTORLST+8
NWTORECB EQU   NWTORLST+4
NWTORRPA EQU   NWTORLST
@NM00085 EQU   NWTOFL
NWTOFLNC EQU   NWTOFL
NWTOFLNH EQU   NWTOFL
NWTOLNG  EQU   NWTOHDR
NIPPTSID EQU   NIPPTE+6
@NM00084 EQU   NIPPTATF
NIPPTMRG EQU   NIPPTATF
@NM00083 EQU   NIPPTOPF
NIPPTCAN EQU   NIPPTOPF
NIPPTLST EQU   NIPPTOPF
NIPPTOPI EQU   NIPPTOPF
NIPPTADR EQU   NIPPTE
PTABEND  EQU   PARMTAB+288
@NM00082 EQU   PARMTAB+284
RSU      EQU   PARMTAB+280
@NM00081 EQU   @NM00079+1
@NM00080 EQU   NIPPAFLG
@NM00078 EQU   PARMTAB+268
PURGE    EQU   PARMTAB+264
@NM00077 EQU   PARMTAB+260
WTORPLY  EQU   PARMTAB+256
@NM00076 EQU   PARMTAB+252
WTOBFRS  EQU   PARMTAB+248
@NM00075 EQU   PARMTAB+244
VRREGN   EQU   PARMTAB+240
@NM00074 EQU   PARMTAB+236
@NM00073 EQU   PARMTAB+228
SYSP     EQU   PARMTAB+224
@NM00072 EQU   PARMTAB+220
SQA      EQU   PARMTAB+216
@NM00071 EQU   PARMTAB+212
SMF      EQU   PARMTAB+208
@NM00070 EQU   PARMTAB+204
REAL     EQU   PARMTAB+200
@NM00069 EQU   PARMTAB+196
PAGEO    EQU   PARMTAB+192
@NM00068 EQU   PARMTAB+188
PAGEP    EQU   PARMTAB+184
@NM00067 EQU   PARMTAB+180
OPT      EQU   PARMTAB+176
@NM00066 EQU   PARMTAB+172
OPI      EQU   PARMTAB+168
@NM00065 EQU   PARMTAB+164
NUCMAP   EQU   PARMTAB+160
@NM00064 EQU   PARMTAB+156
MLPA     EQU   PARMTAB+152
@NM00063 EQU   PARMTAB+148
MAXUSER  EQU   PARMTAB+144
@NM00062 EQU   PARMTAB+140
LOGLMT   EQU   PARMTAB+136
@NM00061 EQU   PARMTAB+132
LOGCLS   EQU   PARMTAB+128
@NM00060 EQU   PARMTAB+124
LNK      EQU   PARMTAB+120
@NM00059 EQU   PARMTAB+116
IPS      EQU   PARMTAB+112
@NM00058 EQU   PARMTAB+108
HARDCPY  EQU   PARMTAB+104
@NM00057 EQU   PARMTAB+100
FIX      EQU   PARMTAB+96
@NM00056 EQU   PARMTAB+92
DUMP     EQU   PARMTAB+88
@NM00055 EQU   PARMTAB+84
CVIO     EQU   PARMTAB+80
@NM00054 EQU   PARMTAB+76
CSA      EQU   PARMTAB+72
@NM00053 EQU   PARMTAB+68
CPQE     EQU   PARMTAB+64
@NM00052 EQU   PARMTAB+60
CONT     EQU   PARMTAB+56
@NM00051 EQU   PARMTAB+52
CMD      EQU   PARMTAB+48
@NM00050 EQU   PARMTAB+44
CLPA     EQU   PARMTAB+40
@NM00049 EQU   PARMTAB+36
BLDLF    EQU   PARMTAB+32
@NM00048 EQU   PARMTAB+28
BLDL     EQU   PARMTAB+24
@NM00047 EQU   PARMTAB+20
APG      EQU   PARMTAB+16
@NM00046 EQU   PARMTAB+12
APF      EQU   PARMTAB+8
PTABSTRT EQU   PARMTAB
NIPPABUF EQU   NIPPAREA+548
NIPPAPTB EQU   NIPPAREA+252
@NM00045 EQU   NIPPAREA+248
@NM00044 EQU   NIPPAECB+1
@NM00043 EQU   NIPPAIOD+37
NIPPATXT EQU   NIPPAIOD
@NM00042 EQU   NIPPAREA+30
@NM00041 EQU   NIPPABDL+15
NIPPA2BF EQU   NIPPABDH
@NM00040 EQU   NIPPAREA
NIPPABYT EQU   NIPPAHDR+4
NIPPAQ   EQU   NIPPAHDR
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBMIHTI EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBINHIO EQU   UCBFLP1
UCBNSWAP EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00039
UCBHALI  EQU   @NM00039
UCBRSV09 EQU   @NM00039
UCBRSV08 EQU   @NM00039
UCBRSV07 EQU   @NM00039
UCBRSV06 EQU   @NM00039
UCBRSV05 EQU   @NM00039
UCBRSV04 EQU   @NM00039
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00036 EQU   UCB
NVTRMSG  EQU   NVT+540
NVTRLOCK EQU   NVT+536
NVTRCODE EQU   NVT+532
@NM00035 EQU   NVT+529
@NM00034 EQU   NVTFLPO
NVTFLWS  EQU   NVTFLPO
NVTFLQS  EQU   NVTFLPO
@NM00033 EQU   NVTFLPO
NVTSYSP  EQU   NVTFLPO
NVTFLLST EQU   NVTFLPO
NVTAPQE  EQU   NVT+524
NVTFBQE2 EQU   NVT+520
NVTFBQE1 EQU   NVT+516
@NM00032 EQU   NVT+512
NVTREALR EQU   NVT+508
NVTFASVT EQU   NVT+504
NVTLPALG EQU   NVT+496
NVTVRLNG EQU   NVT+492
NVTVRREG EQU   NVT+488
NVTLVIRT EQU   NVT+484
NVTDIRA  EQU   NVT+480
NVTLPAND EQU   NVT+476
NVTRMSS  EQU   NVT+472
NVTRPQE  EQU   NVT+468
NVTRLLE  EQU   NVT+464
NVTRJPQ  EQU   NVT+460
NVTVMSS  EQU   NVT+456
NVTVPQE  EQU   NVT+452
NVTVLLE  EQU   NVT+448
NVTVJPQ  EQU   NVT+444
NVTLSEC  EQU   NVTLOCAT+4
NVTLFST  EQU   NVTLOCAT
NVTXSEC  EQU   NVTXCTL+4
NVTXFST  EQU   NVTXCTL
@NM00031 EQU   NVT+425
NVTLPACT EQU   NVT+424
NVTCSLPG EQU   NVT+420
NVTCSIOB EQU   NVT+416
NVTCSLNM EQU   NVT+412
NVTCSLIB EQU   NVT+408
NVTBLDL  EQU   NVT+404
NVTVRBLD EQU   NVT+400
@NM00030 EQU   NVT+392
NVTVRTCB EQU   NVT+388
NVTVVTCB EQU   NVT+384
NVTSPUCB EQU   NVT+382
NVTQSCNT EQU   NVT+380
NVTQSBUF EQU   NVT+376
NVTRPAGE EQU   NVT+364
@NM00029 EQU   NVT+363
NVTABWS1 EQU   NVT+362
NVTABCD1 EQU   NVT+360
@NM00028 EQU   NVT+358
NVTCPUAD EQU   NVT+356
NVTTOD   EQU   NVT+352
NVTSPE   EQU   NVT+344
NVTMBEND EQU   NVT+340
NVTMBUF  EQU   NVT+336
NVTDCBSN EQU   NVT+332
NVTDCBOC EQU   NVT+328
@NM00027 EQU   NVT+308
NVTNMBLD EQU   NVT+304
NVTNIPM  EQU   NVT+292
NVTIX    EQU   NVTFLWSC
NVTFLWS1 EQU   NVTWPSW2+2
NVTIDPSW EQU   NVTWPSW2
NVTWPSW1 EQU   NVTWTPSW
NVTMCPSW EQU   NVT+216
@NM00026 EQU   NVT+212
NVTCLKER EQU   NVTFLCN
NVTFLRAC EQU   NVTFLCN
NVTFLNCK EQU   NVTFLCN
NVTFLNHC EQU   NVTFLCN
NVTFLASM EQU   NVTFLCN
NVTMP    EQU   NVTFLCN
NVTFLIOC EQU   NVTFLCN
NVTFLAC  EQU   NVTFLCN
NVTFLSG  EQU   NVT+210
NVTTRACE EQU   NVT+208
NVTNXPTR EQU   NVT+204
NVTNXSIZ EQU   NVT+202
@NM00025 EQU   NVT+200
NVTSGPSA EQU   NVT+196
NVTN0MSG EQU   NVT+192
NVTVVPG1 EQU   NVT+188
NVTNBFND EQU   NVT+184
NVTNUCND EQU   NVT+180
NVTSTMAP EQU   NVT+176
NVTRTMSA EQU   NVT+172
NVTMFASA EQU   NVT+168
NVTLSPQE EQU   NVT+164
NVTALSQA EQU   NVT+160
NVTPQSAV EQU   NVT+156
NVTSVC60 EQU   NVT+148
NVTABSEC EQU   NVTABSAV+4
NVTABFST EQU   NVTABSAV
NVTNVSQA EQU   NVT+138
NVTRSVMN EQU   NVT+136
NVTNBMIN EQU   NVT+134
NVTRGNAV EQU   NVT+132
NVTLSQNO EQU   NVT+130
NVTSQANO EQU   NVT+128
NVTLSQAS EQU   NVT+124
NVTLNGFX EQU   NVT+120
NVTIGXER EQU   NVT+116
@NM00024 EQU   NVT+112
NVTASMAD EQU   NVT+108
NVTNVRSZ EQU   NVT+104
NVTMFA   EQU   NVT+100
NVTDSSNG EQU   NVT+96
NVTMSLNK EQU   NVT+92
NVTVVMDI EQU   NVT+88
NVTIGCER EQU   NVT+84
NVTVBLDL EQU   NVT+80
NVTSVCTB EQU   NVT+76
NVTASTCB EQU   NVT+72
NVTAASCB EQU   NVT+68
NVTMASCB EQU   NVT+64
NVTCMTCB EQU   NVT+60
NVTMSTCB EQU   NVT+56
@NM00023 EQU   NVTFLLB
NVTFLSLB EQU   NVTFLLB
@NM00022 EQU   NVTNPATR
NVTNPREU EQU   NVTNPREN
@NM00021 EQU   NVTNPREN
NVTNPSFX EQU   NVT+53
@NM00020 EQU   NVT+50
NVTNPSUF EQU   NVT
ICBCPUID EQU   ICB2SSCB+496
ICBLORD  EQU   ICBTRACE+256
ICBOTRC  EQU   ICBTRACE
ICBFAB   EQU   ICB2SSCB+108
ICBMSSC  EQU   ICB2SSCB+104
ICBRSVP  EQU   ICB2SSCB+100
ICBAEAP  EQU   ICB2SSCB+96
ICBSIOBP EQU   ICB2SSCB+92
ICBIATNA EQU   ICB2SSCB+88
ICBIPRGA EQU   ICB2SSCB+84
ICBSRBP  EQU   ICB2SSCB+80
ICBVVICB EQU   ICB2SSCB+76
ICBVVIC  EQU   ICB2SSCB+72
ICBSIOP  EQU   ICB2SSCB+68
ICBMEP   EQU   ICB2SSCB+64
ICBIORCI EQU   ICB2SSCB+60
ICB2ACTP EQU   ICB2SSCB+56
ICBSAMP  EQU   ICBFLG+2
ICBFG2   EQU   ICBFLG+1
@NM00019 EQU   ICBFG1
ICBMSCA  EQU   ICBFG1
ICBMSCMP EQU   ICBFG1
ICBS     EQU   ICBFG1
ICBB     EQU   ICBFG1
ICBV     EQU   ICBFG1
ICBR     EQU   ICBFG1
ICBNVT   EQU   ICBOPT
ICBVN02P EQU   ICB2SSCB+44
ICBTCB   EQU   ICB2SSCB+40
ICBQHEAD EQU   ICB2SSCB+36
ICBAUCB  EQU   ICB2SSCB+32
ICBPUCB  EQU   ICB2SSCB+28
ICBCOMQ  EQU   ICB2SSCB+24
ICBIOR   EQU   ICB2SSCB+20
ICBCOM   EQU   ICB2SSCB+16
ICBACTV  EQU   ICB2SSCB+12
ICBECB   EQU   ICB2SSCB+8
ICBSSNAM EQU   ICB2SSCB
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00018 EQU   CVTFIX+248
@NM00017 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK1  EQU   CVTMAP+36
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
WTORDEB  EQU   WTORDCB+44
@NM00013 EQU   WTORDCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00272 EQU   @RC00270
@RC00370 EQU   @RC00369
@RC00397 EQU   @RC00396
@RF00455 EQU   @RC00343
@RC00465 EQU   @RC00463
@RT00549 EQU   ERR
@RC00572 EQU   @RC00571
@RC00615 EQU   @RC00571
@RC00692 EQU   @RC00683
@RC00707 EQU   @RC00697
@RC00730 EQU   @RC00697
@RC00900 EQU   @RC00897
@RC00867 EQU   @RC00861
@RC01072 EQU   @RC01071
@RF00802 EQU   @EL00001
@RF01200 EQU   @EL00001
@RT01250 EQU   NIPPMPRD
@RT01261 EQU   NIPPMPFN
@RT01263 EQU   NIPPMPER
@RT01272 EQU   NIPPMPRD
@RT01280 EQU   NIPPMPXT
@RF01311 EQU   NIPPMTER
@RF01318 EQU   NIPPMTER
@RT01338 EQU   NIPPMPRD
@RF01338 EQU   NIPPMTND
@RF01336 EQU   NIPPMPBK
@RT01354 EQU   NIPPMPXT
@RC01376 EQU   @EL00002
@RC01374 EQU   @EL00002
@PB00003 EQU   @EL00001
@RC00371 EQU   @RC00370
@RC00403 EQU   @RC00397
@RC00749 EQU   @RC00730
@RC00902 EQU   @RC00900
@RC00868 EQU   @RC00867
@PB00002 EQU   @PB00003
@RC00407 EQU   @RC00403
@RC00869 EQU   @RC00868
@RF00411 EQU   @RC00407
@RF00891 EQU   @RC00869
@RF00926 EQU   @RC00869
@ENDDATA EQU   *
         END   IEAVAP00,(C'PLS1957',0701,77046)
