//SCOTTZ   JOB 'TSV0025 UMOD',NOTIFY=SCOTT,
//             CLASS=S,MSGCLASS=X,MSGLEVEL=(1,1)
//*
//*   NAME:    SYS2.USERMODS(TSV0025 )
//*   PURPOSE: TO ADD OPTIONS TO IEASYS-- THAT ARE FOUND IN NEWER
//*            SYSTEMS.  THESE ARE: LPA, NNS, MSTJCL, SVC, SYM, MPF
//*            TSO, AND LOGREC.
//*            ALSO IT ALLOWS COMMENT LINES!  A COMMENT LINE HAS AN
//*            '*' IN COLUMN 1.  WILD EH? COMMENTS IN IEASYS--.
//*
//*   WARNING: ***  HAVING COMMENTS AND THE NEW KEYWORDS ADDED TO
//*                 SYS1.PARMLIB WITHOUT THIS USERMOD WILL CAUSE
//*                 YOUR SYSTEM TO FAIL AT IPL!
//*
//*   NOTE(S):*A RE-IPL IS REQUIRED.
//*            FOR THE SOURCE TO ASSEMBLE CORRECTLY, THE DSNAME MUST
//*            INCLUDE IN THE SYSLIB CONCATINATION, BEFORE SYS1.AMODGEN
//*            THE DATASET DSTONE.SYM101.F01 AS THIS CONTAINS THE MACRO
//*            IEAPMNIP.
//*           *WARNING: YOU MAY FIND THAT SYS1.SAMPLIB MAY NEED TO BE
//*                     EXPANDED.
//*           *SINCE THIS IS COMPLETE SOURCE ANY MODIFICATIONS SHOULD
//*            BE DONE HERE AND NOT VIA IEBUPDTE WITH TEXT INSERTS OR
//*            SOME SUCH AS THE LINE NUMBERS MAY CHANGE.
//*           *THOUGH THE NEW KEYWORDS ARE ADDED THIS USERMOD DOES
//*            >NOT< IMPLEMENT THEM.
//*           *NO KNOWN PTFS AGAINST THIS MODULE.
//*
//*            SOURCE IS FROM DSTONE.SYM103.F04
//*
//RR     EXEC SMP,
//           RVOL=MVSRES
//SMPCNTL  DD *
  REJECT  S(TSV0025) .
   RESETRC .
  RESTORE S(TSV0025) .
   RESETRC .
/*
//RECV   EXEC SMP,
//           RVOL=MVSRES
//SMPPTFIN DD  *
++USERMOD(TSV0025) .
++VER(Z038) FMID(EBB1102) .
++SRC(IEAVNP03) DISTLIB(AOSC5) SYSLIB(SAMPLIB) .
         TITLE 'IEAVNP03 - PARAMETER ANALYSIS/LINKLIB                  *
                        '
* **************************************************************** *SKV
*                                                                  *SKV
*                                                                  *SKV
*                                                                  *SKV
*   CHANGE LOG:                                                    *SKV
*   12/18/2011 SKV  ADDED PARAMETERS OF: LPA, SSN, MSTJCL, SVC,    *SKV
*                   SYM, AND MPF.  RIGHT NOW THEY ARE TO           *SKV
*                   PREVENT ERRORS IF SPECIFIED.  ACTUAL           *SKV
*                   IMPLEMENTATION COME LATER.                     *SKV
*   10/20/2012 SKV  ADDED PARAMETERS OF: TSO AND LOGREC.           *SKV
*                                                                  *SKV
*                                                                  *SKV
*                                                                  *SKV
* **************************************************************** *SKV
IEAVNP03 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(19)                                             *SKV
*        DC    C'IEAVNP03R0300076086'                              *SKV
         DC    C'IEAVNP03'                                         *SKV
         DC    C'-'                                                *SKV
         DC    C'R03'                                              *SKV
         DC    C'-'                                                *SKV
         DC    C'&SYSDATE'                                         *SKV
         DC    C'-'                                                *SKV
         DC    C'&SYSTIME'                                         *SKV
         DC    C'-'                                                *SKV
         DC    C'TSV0025 '                                         *SKV
         DC    C'-'                                                *SKV
         DROP  @15
@PROLOG  STM   @14,@00,12(@13)                                     0001
         STM   @02,@12,28(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
          USING @PSTART+8190,@13
          ST    @13,NP3R13                 SAVE SAVEAREA ADDR
          LA    @13,4095(0,@12)            R13 = THIRD BASE REG
*
** REFS ARE GENERATED FOR NVT FIELDS THAT CONTAIN ADDRESSES OF
** NIP SERVICE ROUTINES, SO IEAPMNIP MACRO CALLS TO THESE ROUTINES
** WILL ASSEMBLE PROPERLY.
*                                                                  0373
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTRICT BASE ADDRESS REGISTER FOR THE CVT                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0374
*   NP3SAV1=RPARM;                  /* SAVE PARAMETER ADDR     Y02752*/
         ST    RPARM,NP3SAV1                                       0374
*   NP3FLAGS=NP3FLAGS&&NP3FLAGS;    /* SET CONTROL FLAG OFF          */
         XC    NP3FLAGS(3),NP3FLAGS                                0375
*   NP3MSGCL=''B;                   /* CLEAR ERROR TEXT FIELD  Y02752*/
         XC    NP3MSGCL(8),NP3MSGCL                                0376
*   RESPECIFY                                                      0377
*    (NP3BKADR,                                                    0377
*     NP3BKLN) RESTRICTED;          /*                         Y02752*/
*                                                                  0377
*   /*****************************************************************/
*   /*                                                               */
*   /* TRANSFER CONTROL TO THE NIP PROMPT CALL SEQUENCE IF THE NIP03 */
*   /* INITIALIZATION FUNCTION HAS COMPLETED.                  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0378
*   IF NVTSYSP='1'B                 /*                         Y02752*/
*     THEN                          /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           0378
         BNO   @RF00378                                            0378
*     CALL NPRMTRA3;                /*                         Y02752*/
         BAL   @14,NPRMTRA3                                        0379
*   ELSE                            /*                         Y02752*/
*     DO;                           /*                         Y02752
*                                                              Y02752*/
         B     @RC00378                                            0380
@RF00378 DS    0H                                                  0381
*       RESPECIFY                                                  0381
*         RPARM UNRESTRICTED;       /*                         Y02752*/
*       NP3BKADR=ADDR(OPTABLN);     /* ADDR OF AREA TO BE CLEARED  0382
*                                                              Y02752*/
         LA    NP3BKADR,OPTABLN                                    0382
*       NP3BKLN=LENGTH(OPTABLN);    /* LENGHT OF AREA TO BE CLEARED
*                                                              Y02752*/
*                                                                  0383
         LA    NP3BKLN,640                                         0383
*       /*************************************************************/
*       /*                                                           */
*       /* CLEAR OPERATOR PARM TABLE                           Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0384
*       CALL NP3CLRIT;              /*                         Y02752
*                                                              Y02752*/
         BAL   @14,NP3CLRIT                                        0384
*       NP3BKADR=ADDR(PTABLN);      /* ADDR OF AREA TO BE CLEARED  0385
*                                                              Y02752*/
         LA    NP3BKADR,PTABLN                                     0385
*       NP3BKLN=LENGTH(PTABLN);     /* LENGHT OF AREA TO BE CLEARED
*                                                              Y02752*/
*                                                                  0386
         LA    NP3BKLN,640                                         0386
*       /*************************************************************/
*       /*                                                           */
*       /* CLEAR PARMLIB PARM TABLE                            Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0387
*       CALL NP3CLRIT;              /*                         Y02752*/
         BAL   @14,NP3CLRIT                                        0387
*       RESPECIFY                                                  0388
*        (NP3BKADR,                                                0388
*         NP3BKLN) UNRESTRICTED;    /*                         Y02752
*                                                              Y02752*/
*                                                                  0388
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO ANALYZE PARAMETERS FROM OPERATOR    Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0389
*       CALL NP3OPSP;               /*                         Y02752
*                                                              Y02752*/
*                                                                  0389
         BAL   @14,NP3OPSP                                         0389
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO DEFINE INITIAL PARMAREA BASE        Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0390
*       CALL NP3PBASE;              /*                         Y02752
*                                                              Y02752*/
*                                                                  0390
         BAL   @14,NP3PBASE                                        0390
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO OPEN SYS1.PARMLIB                   Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0391
*       CALL NP3PMLIB;              /*                         Y02752
*                                                              Y02752*/
*                                                                  0391
         BAL   @14,NP3PMLIB                                        0391
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO READ AND ANALYZE PARMLIB PARAMETERS Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0392
*       CALL NP3SYSP;               /*                         Y02752
*                                                              Y02752*/
*                                                                  0392
         BAL   @14,NP3SYSP                                         0392
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO MERGE OPERATOR AND PARMLIB INPUT    Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0393
*       CALL NP3PLMRG;              /*                         Y02752
*                                                              Y02752*/
*                                                                  0393
         BAL   @14,NP3PLMRG                                        0393
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO INITIALIZE PARMTAB (IN PARMAREA)    Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0394
*       CALL NP3PTAB;               /*                         Y02752
*                                                              Y02752*/
         BAL   @14,NP3PTAB                                         0394
*       NVTSYSP='1'B;               /* INDICATE THAT THE NIP03     0395
*                                      PARMLIB INITIALIZATION      0395
*                                      FUNCTION HAS COMPLETED  Y02752*/
         OI    NVTSYSP(RNVT),B'01000000'                           0395
*       NP3SLR13=NP3R13;            /* SAVE R13 TO ALLOW SECONDARY 0396
*                                      ENTRY FOR NIP PROMPT    Y02752
*                                                              Y02752*/
*                                                                  0396
         MVC   NP3SLR13(4),NP3R13                                  0396
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO OPEN SYS1.LINKLIB                   Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0397
*       CALL NP3LKLIB;              /*                         Y02752
*                                                              Y02752*/
*                                                                  0397
         BAL   @14,NP3LKLIB                                        0397
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO DEFINE LINKLIB CONCATENATIONS       Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0398
*       CALL NP3LCAT;               /*                         Y02752
*                                                              Y02752*/
         BAL   @14,NP3LCAT                                         0398
*       NP3R13=NP3SLR13;            /* RESTORE R13 SAVE AREA   Y02752*/
         MVC   NP3R13(4),NP3SLR13                                  0399
*     END;                          /*                         Y02752
*                                                              Y02752*/
*                                                                  0400
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT TO IEAVNIPM CONTROL ROUTINE                        Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*   GO TO NP3EXIT;                  /*                         Y02752
*                                                              Y02752*/
*                                                                  0401
         B     NP3EXIT                                             0401
*   /*****************************************************************/
*   /*                                                               */
*   /* NIP PROMPT SERVICE ROUTINE ENTRY POINT                  Y02752*/
*   /* - USED INTERNALLY BY NP3LCAT -                          Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*IEAVNPA3:                          /*                         Y02752*/
*   GENERATE NOSEQFLOW FLOWS(IEAVNP03) EXIT;                       0402
IEAVNPA3 DS    0H                                                  0402
           STM   @13,@14,NPA3RSAV-IEAVNPA3(@15)  SAVE REGS 13 AND 14
           LA    @13,NPA3RSAV-IEAVNPA3(@15)      SAVE AREA ADDR
           LA    @14,IEAVNPA3-IEAVNP03(0)        ENTRY ADDR DIFFERENCE
           SR    @15,@14           NIP03 ENTRY POINT
           BALR  @14,@15           GOTO NIP03 MAIN ENTRY
NP3AEXT    LM    @13,@14,NPA3RSAV-NP3AEXT(@14)  RESTORE REGS 13 AND 14
           BR    @14               RETURN TO CALLER
NPA3RSAV   DC    18F'0'            REGISTER SAVE AREA
*                                                                  0403
*   /*****************************************************************/
*   /*                                                               */
*   /* ANALYZE PARAMETERS FROM OPERATOR                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*NP3OPSP:                                                          0403
*   NP3RTADR=REXIT;                 /* SAVE CALLERS RETURN ADDR      */
NP3OPSP  ST    REXIT,NP3RTADR                                      0403
*   NP3CTAB=ADDR(OPTABLN);          /* GET ADDR OF OPERATOR PARMTAB  */
         LA    @10,OPTABLN                                         0404
         ST    @10,NP3CTAB                                         0404
*   NP3CENT=ADDR(OPSPPGPM);         /* POINT TO PAGE(PARMLIB) ENTRY  */
         LA    @10,OPSPPGPM(,@10)                                  0405
         ST    @10,NP3CENT                                         0405
*   MRGOP='1'B;                     /* TURN MERGE BIT ON             */
*                                                                  0406
         OI    MRGOP(@10),B'10000000'                              0406
*   /*****************************************************************/
*   /*                                                               */
*   /* PICKUP ORIGIN SPE FROM NVT                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*   NP3DSPE=ADDR(NVTSPE);           /* SET BASE ADDRESS FOR SPE      */
         LA    @10,NVTSPE(,RNVT)                                   0407
         ST    @10,NP3DSPE                                         0407
*   SCANREG=NIPSPEA;                /* POINT TO OPERATOR REPLY       */
*                                                                  0408
         L     SCANREG,NIPSPEA(,@10)                               0408
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK OPERATOR REPLY FOR U' OR EOB (DEFAULT REPLY TO USE      */
*   /* IEASYS00 MEMBER OF SYS1.PARMLIB FOR SYSTEM PARAMETERS).       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   IF OPREPLY1=NP3UQ               /* IS THIS U' OR                 */
*       |OPREPLY1=NP3BLNKQ          /* IS THIS EOB                   */
*     THEN                          /* IT IS U' OR EOB               */
         CLC   OPREPLY1(2,SCANREG),NP3UQ                           0409
         BE    @RT00409                                            0409
         CLC   OPREPLY1(2,SCANREG),NP3BLNKQ                        0409
         BNE   @RF00409                                            0409
@RT00409 DS    0H                                                  0410
*     GO TO NP3RTAD0;               /* RETURN AND DEFINE INITIAL   0410
*                                      PARMAREA BASE                 */
         L     @10,NP3RTADR                                        0410
         BR    @10                                                 0410
*   ELSE                                                           0411
*     ;                             /* NOT U' OR EOB , FALL THROUGH  */
*                                                                  0411
@RF00409 DS    0H                                                  0412
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK OPERATOR REPLY FOR U,L' (DEFAULT REPLY TO USE IEASYS00  */
*   /* MEMBER OF SYS1.PARMLIB FOR SYSTEM PARAMETERS WITH LIST OPTION */
*   /* SPECIFIED). IS THIS U,L'                                Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*   IF OPREPLY2=NP3UCLQ             /*                         Y02752*/
*     THEN                          /* IT IS U,L'                    */
         CLC   OPREPLY2(4,SCANREG),NP3UCLQ                         0412
         BNE   @RF00412                                            0412
*     DO;                                                          0413
*       NVTFLLST='1'B;              /* SET "LIST" FLAG ON, IN NVT    */
         OI    NVTFLLST(RNVT),B'10000000'                          0414
*       GO TO NP3RTAD0;             /* RETURN AND DEFINE INITIAL   0415
*                                      PARMAREA BASE                 */
         L     @10,NP3RTADR                                        0415
         BR    @10                                                 0415
*     END;                                                         0416
*                                                                  0416
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP POINTERS AND CONTROL SWITCHES FOR ENTRY INTO THE NP3SCAN*/
*   /* SUBROUTINE FOR SCANNING OPERATOR REPLY PARAMETER CHARACTER    */
*   /* STRING.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0417
*NP3OPSCN:                                                         0417
*   NP3CONT='0'B;                   /* SET CONTINUE PARAMETER FLAG 0417
*                                      OFF                           */
@RF00412 DS    0H                                                  0417
NP3OPSCN NI    NP3CONT,B'01111111'                                 0417
*   OPSPCONT=OPSPCONT&&OPSPCONT;    /* ZERO CONT PARM                */
         L     @10,NP3CTAB                                         0418
         XC    OPSPCONT(16,@10),OPSPCONT(@10)                      0418
*   NP3INID='0000'X;                /* SET INPUT ID TO ZERO          */
         MVC   NP3INID(2),@CB02317                                 0419
*NP3SREPL:                                                         0420
*   NP3NCHAR=NIPSPEA;               /* POINT TO FIRST CHARACTER OF 0420
*                                      CURRENT SYMBOL IN PARAMETER 0420
*                                      CHARACTER STRING              */
NP3SREPL L     @10,NP3DSPE                                         0420
         MVC   NP3NCHAR(4),NIPSPEA(@10)                            0420
*NP3SCALL:                                                         0421
*   CALL NP3SCAN;                   /* BRANCH TO SCAN SUBROUTINE FOR
*                                      PARAMETER VALIDATION          */
*                                                                  0421
NP3SCALL BAL   @14,NP3SCAN                                         0421
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING GENERATED STATEMENTS ARE A BRANCH TABLE RETURN +*/
*   /* 0 FROM NP3SCAN INDICATES A VALID PARAMETER RETURN + 4 FROM    */
*   /* NP3SCAN INDICATES AN INVALID PARAMETER RETURN + 8 FROM NP3SCAN*/
*   /* INDICATES A CONTINUATION OF OF SUBPARAMETERS OR END OF ALL    */
*   /* OPERATOR REPLY PARAMETERS.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*   GENERATE FLOWS(NP3OPIA,NP3OPRES,NP3OPCNT);                     0422
*                                                                  0422
         B     NP3OPIA             GO CHECK FOR OPERATOR OPI
         B     NP3OPRES            GO TO INVALID PARAMETER HANDLING
         B     NP3OPCNT            GO CHECK FOR CONTINUATION
*   /*****************************************************************/
*   /*                                                               */
*   /* IEAVNPA3 SUBROUTINE ENTRY POINT                         Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*NPOPCNT:                                                          0423
*   NPRMRTN1=REXIT;                 /*                         Y02752
*                                                              Y02752*/
*                                                                  0423
NPOPCNT  ST    REXIT,NPRMRTN1                                      0423
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECKS FOR NON-ZERO CHAIN POINTER IN CURRENT SPE TO NEXT SPE  */
*   /* FOR CONTINUATION OF SYSTEM PARAMETERS.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0424
*NP3OPCNT:                                                         0424
*   IF NIPSPEQ=0                    /* IS SPE CHAIN POINTER ZERO   0424
*                                      VALUE                         */
*     THEN                          /* YES- NO VALID CONTINUATION    */
NP3OPCNT L     @10,NP3DSPE                                         0424
         L     @10,NIPSPEQ(,@10)                                   0424
         LTR   @10,@10                                             0424
         BZ    @RT00424                                            0424
*     GO TO NP3OPIA;                /* BRANCH TO INVALID PREVIOUS  0425
*                                      PARAMETER CHECKING            */
*   ELSE                            /* SPE CHAIN POINTER IS NON-ZERO */
*     DO;                                                          0426
*       NP3TSPE=NIPSPEQ;            /* SAVE SPE CHAIN POINTER        */
         ST    @10,NP3TSPE                                         0427
*       NP3DSPE=NP3TSPE;            /* SET BASE ADDRESS FOR NEW SPE  */
         ST    @10,NP3DSPE                                         0428
*       GO TO NP3SREPL;             /* GO TO SCAN CONTINUATION FOR 0429
*                                      MORE PARAMETER ANALYSIS       */
         B     NP3SREPL                                            0429
*     END;                                                         0430
*NP3OPRTY:                                                         0431
*   NP3RTADR=REXIT;                 /* SAVE CALLERS RETURN ADDR      */
*                                                                  0431
NP3OPRTY ST    REXIT,NP3RTADR                                      0431
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CURRENT PARMTAB POINTER TO ADDRESS OF OPERATOR'S PARMTAB  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0432
*   NP3CTAB=ADDR(OPTABLN);          /* POINT TO OPERATOR PARMTAB     */
*                                                                  0432
         LA    @10,OPTABLN                                         0432
         ST    @10,NP3CTAB                                         0432
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PROMPT MODE, RETURN TO PROMPT CALL SEQUENCE          Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0433
*   IF NVTSYSP='1'B                 /*                         Y02752*/
*     THEN                          /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           0433
         BNO   @RF00433                                            0433
*     DO;                           /*                         Y02752*/
*       RETCODE=4;                  /* EXTRANEOUS INFO FOUND   Y02752*/
         MVC   RETCODE(4),@CF00371                                 0435
*       GOTO NPRMRTN1;              /* RETURN TO IEAVNPA3 CALL     0436
*                                      SEQUENCE                Y02752*/
         L     @10,NPRMRTN1                                        0436
         BR    @10                                                 0436
*     END;                          /*                         Y02752
*                                                              Y02752*/
*                                                                  0437
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATE THE INTERFACE BRANCH MACRO CALL TO NIPWTOR FOR       */
*   /* RESPECIFY PARAMETERS MESSAGE TO OPERATOR                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0438
*   GENERATE REFS(NVTWTOR) DEFS(NP3OPRES);                         0438
@RF00433 DS    0H                                                  0438
NP3OPRES IEAPMNIP   TYPE=WTOR,PARAM=PLIST01  CALL WTOR SERVICE ROUTINE
*   RESPECIFY                                                      0439
*     RPARM RESTRICTED;             /* PARAMETER INTERFACE REG(1)    */
*   RESPECIFY                                                      0440
*     OPREPLY1 BASED(RPARM);        /* MAP TO OPERATOR REPLY         */
*                                                                  0440
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR OPERATOR REPLY OF EOB (CANCEL), WHICH IMPLIES       */
*   /* OPERATOR DID NOT SPECIFY ANY SYSTEM PARAMETERS                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0441
*   IF OPREPLY1=NP3BLNKQ            /* DID OPERATOR CANCEL           */
*     THEN                          /* YES,OPERATOR CANCELLED        */
         CLC   OPREPLY1(2,RPARM),NP3BLNKQ                          0441
         BE    @RT00441                                            0441
*     GO TO NP3OPIA;                /* GO TO OPERATOR SPECIFIED "OPI"
*                                      CHECK HANDLER                 */
*   ELSE                            /* NO,OPERATOR HAS RESPECIFIED 0443
*                                      SYSTEM PARAMETERS             */
*     DO;                                                          0443
*       NP3OPSV=RPARM;              /* SAVE ADDRESS OF OPERATOR    0444
*                                      RESPECIFIED PARAMETERS        */
         ST    RPARM,NP3OPSV                                       0444
*     END;                                                         0445
*   RESPECIFY                                                      0446
*     RPARM UNRESTRICTED;           /* PARAMETER INTERFACE REG1      */
*   RESPECIFY                                                      0447
*     OPREPLY1 BASED(SCANREG);      /* RESET TO ORIGINAL MAPPING BASE
*                                      ADDRESS                 Y02752*/
*                                                                  0447
*   /*****************************************************************/
*   /*                                                               */
*   /* GET CORE FOR SPE - ISSUE 'CONTINUE SYSTEM PARAMETERS' MESSAGE */
*   /* IF THE OPERATOR REQUESTED CONTINUATION                  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0448
*   CALL NPGETMN;                   /*                         Y02752*/
         BAL   @14,NPGETMN                                         0448
*   GOTO NP3OPSCN;                  /* GO TO PARAMETER SCAN    Y02752*/
*                                                                  0449
         B     NP3OPSCN                                            0449
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CHECKS TO SEE IF THE OPERATOR SPECIFIED "OPI" WITH THE   */
*   /* SYSTEM PARAMETERS HE SPECIFIED. IF YES,A MESSAGE IS ISSUED TO */
*   /* HIM, SAYING "OPI" IGNORED                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*NP3OPIA:                                                          0450
*   IF OPSPOPI='00000000000000000000000000000000'X/* HAS OPER      0450
*                                      SPECIFIED "OPI"               */
*     THEN                          /* NO,HE HAS NOT SPECIFIED "OPI" */
NP3OPIA  L     @10,NP3CTAB                                         0450
         CLC   OPSPOPI(16,@10),@CB02424                            0450
         BNE   @RF00450                                            0450
*     DO;                                                          0451
*                                                                  0451
*       /*************************************************************/
*       /*                                                           */
*       /* IF PROMPT MODE, RETURN TO NIP PROMPT CALL SEQUENCE        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0452
*       IF NVTSYSP='1'B             /*                         Y02752*/
*         THEN                                                     0452
         TM    NVTSYSP(RNVT),B'01000000'                           0452
         BNO   @RF00452                                            0452
*         GO TO NPRMRTN1;           /*                         Y02752*/
         L     @10,NPRMRTN1                                        0453
         BR    @10                                                 0453
*       GO TO NP3RTAD0;             /* RETURN TO CALLER        Y02752*/
@RF00452 L     @10,NP3RTADR                                        0454
         BR    @10                                                 0454
*     END;                          /*                         Y02752*/
*   ELSE                            /* YES, HE HAS SPECIFIED "OPI"   */
*     DO;                                                          0456
@RF00450 DS    0H                                                  0457
*       OPSPOPI=OPSPOPI&&OPSPOPI;   /* RESET OPI ENTRY IN OPERTAB TO
*                                      ZERO                          */
         L     @10,NP3CTAB                                         0457
         XC    OPSPOPI(16,@10),OPSPOPI(@10)                        0457
*       OPREPLY5=NP3OPIMG;          /* MOVE "OPI" KEYWORD INTO ERROR
*                                      MESSAGE TEXT                  */
         MVC   OPREPLY5(3),NP3OPIMG                                0458
*     END;                                                         0459
*                                                                  0459
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS GENERATED INTERFACE BRANCH MACRO CALLS THE NIPWTO SERVICE*/
*   /* ROUTINE IN IEAVNIPM TO WRITE OUT THE OPI IGNORE MESSAGE TEXT  */
*   /* TO THE OPERATOR                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0460
*   GENERATE REFS(NVTWTO);                                         0460
*                                                                  0460
         IEAPMNIP   TYPE=WTO,PARAM=MESG03    CALL WTO SERVICE ROUTINE
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IEAVNPA3 CALL SEQUENCE IF IN NIP PROMPT MODE  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0461
*   IF NVTSYSP='1'B THEN            /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           0461
         BNO   @RF00461                                            0461
*     GO TO NPRMRTN1;               /*                         Y02752
*                                                              Y02752*/
         L     @10,NPRMRTN1                                        0462
         BR    @10                                                 0462
*   GO TO NP3RTAD0;                 /* RETURN TO CALLER              */
@RF00461 L     @10,NP3RTADR                                        0463
         BR    @10                                                 0463
*                                                                  0464
*   /*****************************************************************/
*   /*                                                               */
*   /* DEFINE INITIAL PARMAREA BASE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0464
*NP3PBASE:                                                         0464
*   NP3RTADR=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
*                                                                  0464
NP3PBASE ST    REXIT,NP3RTADR                                      0464
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL GETMAIN SUBROUTINE FOR INITIAL PAREA                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0465
*   CALL NP3PAGM;                   /* GO TO GETMAIN SUBROUTINE      */
*                                                                  0465
         BAL   @14,NP3PAGM                                         0465
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE ADDRESS OF INITIAL PAREA IN NVT AND SET BASE             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0466
*   NVTPAREA=NP3GBFR;               /* SET PAREA ADDRESS IN NVT      */
         L     @10,NP3GBFR                                         0466
         ST    @10,NVTPAREA(,RNVT)                                 0466
*   NP3PBFR=NP3GBFR;                /* SET BASE ADDRESS FOR HEADER   */
*                                                                  0467
         ST    @10,NP3PBFR                                         0467
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE ADDRESS SIZE REQUIREMENTS FOR IOB,DCB,DEB,          */
*   /* PARMTAB,I/O DATA AND PARMLTB READ AREA FOR PAREA              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0468
*   NIPPABYT=LENGTH(NIPPAREA)+NP3PBFR;/* SET NEXT AVAILABLE ADDRESS  */
         LA    @09,573                                             0468
         ALR   @09,@10                                             0468
         ST    @09,NIPPABYT(,@10)                                  0468
*   RESPECIFY                                                      0469
*     NP3BKLN RESTRICTED;           /* TRACKS LENGTH OF AREA   Y02752*/
*   RESPECIFY                                                      0470
*     NP3BKADR RESTRICTED;          /* TRACKS POSITION OF AREA Y02752*/
*                                                                  0470
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEARS THE INITIAL PAREA (EXCEPT HEADER) TO ZERO'S CALCULATE  */
*   /* AREA LENGTH TO CLEAR                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0471
*   NP3BKLN=2048-(ADDR(NIPPA2BF)-ADDR(NIPPAREA));/*            Y02752*/
         LA    NP3BKLN,2036                                        0471
*   NP3BKADR=ADDR(NIPPA2BF);        /* SET AREA POSITION POINTER TO
*                                      ADDRESS OF BYTE FOLLOWING   0472
*                                      HEADER IN INITIAL PAREA Y02752*/
*                                                                  0472
         LA    NP3BKADR,NIPPA2BF(,@10)                             0472
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR INITIAL PAREA TO ZERO'S                           Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*   CALL NP3CLRIT;                  /*                         Y02752*/
         BAL   @14,NP3CLRIT                                        0473
*   RESPECIFY                                                      0474
*     NP3BKLN UNRESTRICTED;         /* RELEASE LENGTH REG.     Y02752*/
*   RESPECIFY                                                      0475
*     NP3BKADR UNRESTRICTED;        /* RELEASE POSITION REG.   Y02752*/
*   NIPPABDH=BLDLHEAD;              /* MOVE BLDL HEADER TO PARMAREA  */
*                                                                  0476
         L     @10,NVTPAREA(,RNVT)                                 0476
         MVC   NIPPABDH(4,@10),BLDLHEAD                            0476
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN IOB IN PARMAREA                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0477
*   IOBSTPTR=ADDR(NIPPAIOB);        /* SET IOB DSECT PTR = PARMAREA
*                                      IOB                           */
         LA    @09,NIPPAIOB(,@10)                                  0477
         ST    @09,IOBSTPTR                                        0477
*   ECBPTR=ADDR(NIPPAECB);          /* SET ECB BASE TO POINT TO    0478
*                                      PARMAREA ECB                  */
         LA    @15,NIPPAECB(,@10)                                  0478
         ST    @15,ECBPTR                                          0478
*   IOBFLAG1='42'X;                 /* SET IOB FOR COMMAND CHAINING
*                                      WITH NO RELATED REQUESTS      */
         MVI   IOBFLAG1(@09),X'42'                                 0479
*   IOBECBPT=ECBPTR;                /* SET ADDR OF ECB IN IOB        */
         ST    @15,IOBECBPT(,@09)                                  0480
*   IOBDCBPT=ADDR(DCBSTART);        /* SET ADDR OF DCB IN IOB        */
         LA    @15,NIPPADCB(,@10)                                  0481
         SH    @15,@CH02133                                        0481
         ST    @15,IOBDCBPT(,@09)                                  0481
*   IOBSTART=ADDR(NIPPAIOD);        /* SET ADDR OF CCW CHAIN IN IOB  */
*                                                                  0482
         LA    @15,NIPPAIOD(,@10)                                  0482
         ST    @15,IOBSTART(,@09)                                  0482
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN DCB IN PARMAREA                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0483
*   DCBDEBAD=ADDR(NIPPADEB);        /* SET ADDR OF DEB IN DCB        */
*                                                                  0483
         LA    @09,NIPPADEB(,@10)                                  0483
         ST    @09,DCBDEBAD(,@10)                                  0483
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN CCW ADDRESSES                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   SRCHAD=ADDR(NIPPASID);                                         0484
         LA    @09,NIPPASID(,@10)                                  0484
         STCM  @09,7,SRCHAD                                        0484
*   TICAD=ADDR(NIPPATXT);                                          0485
         LA    @15,NIPPATXT(,@10)                                  0485
         STCM  @15,7,TICAD                                         0485
*   RDDATAD=ADDR(NIPPARCD);                                        0486
         LA    @15,NIPPARCD(,@10)                                  0486
         STCM  @15,7,RDDATAD                                       0486
*   RDCNTAD=ADDR(NIPPASID);                                        0487
         STCM  @09,7,RDCNTAD                                       0487
*   NIPPATXT=NP3CCW;                /* MOVE TEXT READ CCW'S TO     0488
*                                      PARMAREA                      */
         MVC   NIPPATXT(32,@10),NP3CCW                             0488
*   GO TO NP3RTAD0;                 /* RETURN TO CALLER              */
         L     @10,NP3RTADR                                        0489
         BR    @10                                                 0489
*                                                                  0490
*   /*****************************************************************/
*   /*                                                               */
*   /* OPEN SYS1.PARMLIB                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0490
*NP3PMLIB:                                                         0490
*   NP3RTADR=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
NP3PMLIB ST    REXIT,NP3RTADR                                      0490
*   PRMLIB=PARMLIB;                 /* SET SYS1.PARMLIB NAME IN    0491
*                                      LOCATE                        */
*                                                                  0491
         MVC   PRMLIB(12),PARMLIB                                  0491
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATES LOCATE MACRO FOR SYS1.PARMLIB                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0492
*   GENERATE;                                                      0492
*                                                                  0492
         LOCATE LOCLIB              ISSUE LOCATE FOR SYS1.PARMLIB
*   /*****************************************************************/
*   /*                                                               */
*   /* EXAMINE RETURN CODE FROM LOCATE. IF ANYTHING OTHER THAN ZERO, */
*   /* SYS1.PARMLIB IS ASSUMED TO BE ON SYSRES.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0493
*   IF LOCREG=0                    /* IS RETURN CODE OTHER THAN ZERO*/
*     THEN                          /* YES - ASSUME SYSRES           */
         LTR   LOCREG,LOCREG                                       0493
         BZ    @RF00493                                            0493
*     DO;                                                          0494
*       NVTSPUCB=CVTSYSAD;          /* GET ADDR OF SYSRES UCB        */
         MVC   NVTSPUCB(2,RNVT),CVTSYSAD+2(CVTPTR)                 0495
*       GO TO NP3PLOPN;             /* GO TRY TO OPEN DATASET        */
         B     NP3PLOPN                                            0496
*     END;                                                         0497
*   ELSE                                                           0498
*     DO;                                                          0498
@RF00493 DS    0H                                                  0499
*       NMNTDS=PARMLIB;             /* SET SYS1.PARMLIB NAME IN MOUNT
*                                      PARAMETER LIST                */
         L     @10,NP3LST03                                        0499
         MVC   NMNTDS(12,@10),PARMLIB                              0499
*       NMNTVS=NP3VOLSR;            /* SET VOLUME SERIAL IN MOUNT  0500
*                                      PARAMETER LIST                */
         MVC   NMNTVS(6,@10),NP3VOLSR                              0500
*       NMNTDT=NP3DVTYP;            /* SET DEVICE TYPE IN MOUNT    0501
*                                      PARAMETER LIST                */
         MVC   NMNTDT(2,@10),NP3DVTYP                              0501
*     END;                                                         0502
*                                                                  0502
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO BRANCH INTERFACE TO NIPMOUNT (IEAVNP02)       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0503
*   GENERATE REFS(NVTMOUNT) SETS(RPARM,REXIT,RENTRY);              0503
          IEAPMNIP TYPE=MOUNT,PARAM=PLIST03     ISSUE NIPMOUNT CALL
*   NVTSPUCB=RPARM;                 /* SAVE PARMLIB UCB ADDR IN NVT  */
*                                                                  0504
         STH   RPARM,NVTSPUCB(,RNVT)                               0504
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETERS FOR OPEN REQUEST (UNCONDITIONAL)            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0505
*   RESPECIFY                                                      0505
*     NIPOPNPL BASED(NP3LST05);                                    0505
*NP3PLOPN:                                                         0506
*   NOPNUCB=NVTSPUCB;               /* SET UP UCB ADDR FOR OPEN LIST */
NP3PLOPN L     @10,NP3LST05                                        0506
         SLR   @09,@09                                             0506
         ICM   @09,3,NVTSPUCB(RNVT)                                0506
         ST    @09,NOPNUCB(,@10)                                   0506
*   NOPNDCB=ADDR(DCBSTART);         /* SET UP DCB ADDR FOR OPEN LIST */
*                                                                  0507
         L     @09,NVTPAREA(,RNVT)                                 0507
         LA    @09,NIPPADCB(,@09)                                  0507
         SH    @09,@CH02133                                        0507
         ST    @09,NOPNDCB(,@10)                                   0507
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO BRANCH INTERFACE TO NIPOPEN (UNCONDITIONAL)   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*   GENERATE REFS(NVTOPEN) SETS(RPARM,REXIT,RENTRY,NOPNFL);        0508
          IEAPMNIP TYPE=OPEN,PARAM=PLIST05,OPT=(NB,,,SX)
*   GO TO NP3RTAD0;                 /* RETURN TO CALLER              */
         L     @10,NP3RTADR                                        0509
         BR    @10                                                 0509
*                                                                  0510
*   /*****************************************************************/
*   /*                                                               */
*   /* READ AND ANALYZE PARAMETERS IN SYS1.PARMLIB                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0510
*   RESPECIFY                                                      0510
*     NIPPAREA BASED(NVTPAREA);                                    0510
*   RESPECIFY                                                      0511
*     NIPPAHDR BASED(NVTPAREA);                                    0511
*NP3SYSP:                                                          0512
*   NP3SYPAD=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
*                                                                  0512
NP3SYSP  ST    REXIT,NP3SYPAD                                      0512
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL GETMAIN SUBROUTINE FOR 2ND LEVEL PARMAREA                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0513
*   CALL NP3PAGM;                   /* GET 2ND PARMAREA              */
         BAL   @14,NP3PAGM                                         0513
*NP3SYRCK:                                                         0514
*   PARMBASE=NIPPAQ;                /* SET BASE FOR SECONDARY      0514
*                                      PARMAREA                      */
NP3SYRCK L     @10,NVTPAREA(,RNVT)                                 0514
         MVC   PARMBASE(4),NIPPAQ(@10)                             0514
*   NP3CENT=ADDR(OPSPSYSP);         /* SET BASE FOR SYSP ENTRY       */
*                                                                  0515
         L     @10,NP3CTAB                                         0515
         LA    @10,OPSPSYSP(,@10)                                  0515
         ST    @10,NP3CENT                                         0515
*   /*****************************************************************/
*   /*                                                               */
*   /* IF EITHER THE NVT LIST FLAG OR THE SYSP LIST FLAG ARE ON, SET */
*   /* FLAG FOR THE LIST OPTION.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0516
*   IF NVTFLLST='1'B|NIPPTLST='1'B THEN                            0516
         TM    NVTFLLST(RNVT),B'10000000'                          0516
         BO    @RT00516                                            0516
         TM    NIPPTLST(@10),B'01000000'                           0516
         BNO   @RF00516                                            0516
@RT00516 DS    0H                                                  0517
*     NP3SYLST='1'B;                                               0517
         OI    NP3SYLST,B'00100000'                                0517
*   NP3CTAB=ADDR(PTABLN);           /* CURRENT PARM TABLE POINTER =
*                                      ADDR OF PLIBTAB               */
@RF00516 LA    @10,PTABLN                                          0518
         ST    @10,NP3CTAB                                         0518
*   IF SYSPRTRY='1'B               /* IS SYSP RETRY SWITCH SET      */
*     THEN                          /* NO -                          */
         TM    SYSPRTRY,B'00000100'                                0519
         BNO   @RT00519                                            0519
*     GO TO NP3SYSDE;               /* GET SYSP DEFAULT              */
*NP3SYNDF:                                                         0521
*   SCANREG=NIPPTADR;               /* SCAN PTR = ADDR OF SYSP INPUT
*                                      FROM OPERATOR                 */
NP3SYNDF L     @10,NP3CENT                                         0521
         L     SCANREG,NIPPTADR(,@10)                              0521
*   IF SCANREG=0|                   /* IS THERE ANY SYSP INPUT TO BE
*                                      ANALYZED                      */
*       NP3SCAN4=SPLIST             /* CHECK FOR (,L) VALUE  @YM06755*/
*     THEN                          /* NO - CHECK RETRY SWITCH       */
         LTR   SCANREG,SCANREG                                     0522
         BZ    @RT00522                                            0522
         CLC   NP3SCAN4(4,SCANREG),@CB01889                        0522
         BE    @RT00522                                            0522
*     GO TO NP3SYXIT;               /* RETURN TO CALLER              */
*   SYSPRTRY='0'B;                  /* RESET SYSP RETRY SWITCH TO  0524
*                                      ZERO                          */
         NI    SYSPRTRY,B'11111011'                                0524
*NP3SYRTY:                                                         0525
*   IF NP3SCANR='('                 /* IS CHARACTER A '('            */
*     THEN                          /* YES - MUST BE MORE THAN ONE 0525
*                                      LIST SPECIFIED                */
NP3SYRTY CLI   NP3SCANR(SCANREG),C'('                              0525
         BNE   @RF00525                                            0525
*     DO;                                                          0526
*       MULTSYSP='1'B;              /* SET MULTI SYSP SWITCH ON      */
         OI    MULTSYSP,B'01000000'                                0527
*NP3UPDAT:                                                         0528
*       SCANREG=SCANREG+1;          /* UPDATE SCAN TO NEXT CHARACTER */
NP3UPDAT LA    SCANREG,1(,SCANREG)                                 0528
*       IF NP3SCANR='('             /* IS CHARACTER A '('            */
*         THEN                                                     0529
         CLI   NP3SCANR(SCANREG),C'('                              0529
         BE    @RT00529                                            0529
*         GO TO NP3UPDAT;           /* YES,UPDATE TO NEXT CHAR       */
*       ELSE                                                       0531
*         GO TO NP3ALPHA;           /* NO,CHECK FOR ALPHAMERIC       */
         B     NP3ALPHA                                            0531
*     END;                                                         0532
*   ELSE                                                           0533
*     DO;                                                          0533
*                                                                  0533
@RF00525 DS    0H                                                  0534
*       /*************************************************************/
*       /*                                                           */
*       /* ARE NEXT TWO CHACTERS ALPHMERIC                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0534
*NP3ALPHA:                                                         0534
*       IF NP3SCAN2>='AA'&NP3SCAN2<='99' THEN                      0534
NP3ALPHA CLC   NP3SCAN2(2,SCANREG),@CC02448                        0534
         BL    @RF00534                                            0534
         CLC   NP3SCAN2(2,SCANREG),@CC02449                        0534
         BH    @RF00534                                            0534
*         DO;                                                      0535
*           IF NP3SCAN5=CONTCHAR    /* ARE NEXT CHARS                */
*             THEN                  /* CONT'                         */
         CLC   NP3SCAN5(5,SCANREG),CONTCHAR                        0536
         BNE   @RF00536                                            0536
*             DO;                                                  0537
*               IF CONTAD=0        /* IS CONT PTR                   */
*                 THEN              /* NON-ZERO                      */
         L     @10,NP3CENT                                         0538
         L     @10,CONTAD(,@10)                                    0538
         LTR   @10,@10                                             0538
         BZ    @RF00538                                            0538
*                 DO;               /* GET REST OF SYSP INPUT        */
*                   SCANREG=CONTAD; /* GET CONT ADDRESS              */
         LR    SCANREG,@10                                         0540
*                   GO TO NP3ALPHA;                                0541
         B     NP3ALPHA                                            0541
*                 END;                                             0542
*                                                                  0542
*               /*****************************************************/
*               /*                                                   */
*               /* INVALID - CONT HAS BEEN SPECIFIED WITHOUT A CONT  */
*               /* ADDR                                              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0543
*               ELSE                                               0543
*                 GO TO NP3SYINV;                                  0543
*             END;                                                 0544
*           ELSE                                                   0545
*             GO TO NP3SETXX;       /* GO SET UP TO READ SPECIFIED 0545
*                                      LIST                          */
*         END;                                                     0546
*       ELSE                                                       0547
*         GO TO NP3SYINV;           /* INVALID - XX OF IEASYSXX IS 0547
*                                      NOT ALPHAMERIC                */
*     END;                                                         0548
*NP3SYSDE:                                                         0549
*   LISTNAM='00';                   /* SET UP DEFAULT LIST NAME      */
NP3SYSDE MVC   LISTNAM(2),@CC01913                                 0549
*   GO TO NP3MOVNM;                                                0550
         B     NP3MOVNM                                            0550
*NP3SETXX:                                                         0551
*   LISTNAM=NP3SCAN2;               /* MOVE TWO CHARS FROM SCAN TO 0551
*                                      IEASYSXX NAME                 */
NP3SETXX MVC   LISTNAM(2),NP3SCAN2(SCANREG)                        0551
*NP3MOVNM:                                                         0552
*   NIPPANAM=IEASYS;                /* MOVE NAME TO PARMAREA         */
NP3MOVNM L     @10,NVTPAREA(,RNVT)                                 0552
         MVC   NIPPANAM(8,@10),IEASYS                              0552
*   SAVESCAN=SCANREG;               /* SAVE SYSP POINTER             */
*                                                                  0553
         ST    SCANREG,SAVESCAN                                    0553
*   /*****************************************************************/
*   /*                                                               */
*   /* READ PDS DATA FOR IEASYSXX                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0554
*   CALL NIPPMPDS;                                                 0554
         BAL   @14,NIPPMPDS                                        0554
*   GENERATE FLOWS(NP3SINID,NP3SYPFL) NOSEQFLOW;                   0555
          B      NP3SINID
          B      NP3SYPFL
*   RESPECIFY                                                      0556
*     NIPPAREA BASED(PARMBASE);                                    0556
*   RESPECIFY                                                      0557
*     NIPPAHDR BASED(PARMBASE);                                    0557
*NP3SINID:                                                         0558
*   NP3INID=LISTNAM;                /* SET INPUT IDENTIFIER TO XX  0558
*                                      CHAR VALUE                    */
NP3SINID MVC   NP3INID(2),LISTNAM                                  0558
*   NP3SYHDR='1'B;                  /* INDICATE FIRST READ FOR MEMBER*/
         OI    NP3SYHDR,B'00000010'                                0559
*   NP3NCHAR=NIPPABYT;              /* POINT TO BEGINNING OF       0560
*                                      PARAMETERS                    */
*                                                                  0560
         L     @10,PARMBASE                                        0560
         MVC   NP3NCHAR(4),NIPPABYT(@10)                           0560
*   /*****************************************************************/
*   /*                                                               */
*   /* READ IEASYS TEXT RECORD                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0561
*NP3SYTXT:                                                         0561
*   CALL NIPPMTXT;                                                 0561
NP3SYTXT BAL   @14,NIPPMTXT                                        0561
*   GENERATE FLOWS(NP3DETLN,NP3SYPFL) NOSEQFLOW;                   0562
          B     NP3DETLN
          B     NP3SYPFL
*NP3SYPFL:                                                         0563
*   PARM='SYSP';                    /* FILL IN SYSP CONSTANT         */
NP3SYPFL MVC   PARM(4),@CC01908                                    0563
*   NAME=IEASYS;                    /* FILL IN IEASYSXX NAME         */
*                                                                  0564
         MVC   NAME(8),IEASYS                                      0564
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO 'SYSP INPUT TERMINATED IN IEASYSXX' MESSAGE               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0565
*   GENERATE REFS(NVTWTO);                                         0565
          IEAPMNIP TYPE=WTO,PARAM=MESG07 CALL WTO SERVICE ROUTINE
*   SYSPRTRY='1'B;                  /* INDICATE SECOND LEVEL ENTRY TO
*                                      SYSP ROUTINE                  */
         OI    SYSPRTRY,B'00000100'                                0566
*   NP3SYSPD='1'B;                  /* INDICATE NOT TO DO IEASYS00 0567
*                                      AGAIN                         */
         OI    NP3SYSPD,B'00010000'                                0567
*   NP3CTAB=ADDR(OPTABLN);          /* POINT TO OPERATOR TABLE       */
         LA    @10,OPTABLN                                         0568
         ST    @10,NP3CTAB                                         0568
*   NP3CENT=ADDR(OPSPSYSP);         /* SET BASE FOR SYSP ENTRY       */
         LA    @10,OPSPSYSP(,@10)                                  0569
         ST    @10,NP3CENT                                         0569
*   NP3SYLST='0'B;                  /* TURN LIST INDICATOR OFF       */
*   MULTSYSP='0'B;                  /* TURN MULTI SYSP SWITCH OFF    */
         NI    NP3SYLST,B'10011111'                                0571
*   OPLIBENT=OPLIBENT&&OPLIBENT;    /* ZERO SYSP ENTRY IN OPERTAB    */
*                                                                  0572
         XC    OPLIBENT(16,@10),OPLIBENT(@10)                      0572
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE PARAMETERS OPTION                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0573
*   CALL NP3OPRTY;                                                 0573
         BAL   @14,NP3OPRTY                                        0573
*   GO TO NP3SYRCK;                                                0574
         B     NP3SYRCK                                            0574
*   RESPECIFY                                                      0575
*     NP3SCAN5 BASED(COUNTREG);                                    0575
*   RESPECIFY                                                      0576
*     RPARM RESTRICTED;                                            0576
*   RESPECIFY                                                      0577
*     COUNTREG RESTRICTED;                                         0577
*NP3DETLN:                                                         0578
*   COUNTREG=RPARM;                                                0578
*                                                                  0578
NP3DETLN LR    COUNTREG,RPARM                                      0578
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FIRST CHARACTER RETURNED FROM READ TEXT ROUTINE IS BLANK,  */
*   /* THE ENTIRE RECORD READ IS BLANK.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0579
*   IF NP3SCANR=' ' THEN            /* YES - NO PARAMETERS ARE     0579
*                                      SPECIFIED IN THIS READ FOR  0579
*                                      MEMBER                        */
         CLI   NP3SCANR(COUNTREG),C' '                             0579
         BNE   @RF00579                                            0579
         CLI   NP3SCANR(COUNTREG),C'*'                         SKV 0579
         BNE   @RF00579                                        SKV 0579
*     DO;                                                          0580
*       IF NP3SYHDR='1'B            /* IS THIS FIRST MEMBER READ     */
*         THEN                      /* YES - NO PARAMS IN THIS MEMBER*/
         TM    NP3SYHDR,B'00000010'                                0581
         BO    @RT00581                                            0581
*         GO TO NP3SYNXT;           /* CHECK FOR ANOTHER LIST        */
*       ELSE                        /* NO - END OF PARAMS IN MEMBER  */
*         GO TO NP3SYTND;           /* INDICATE TEXT END             */
         B     NP3SYTND                                            0583
*     END;                                                         0584
*NP3DETL0:                                                         0585
*   IF NP3SCANR=' '                /* IS CHAR BLANK                 */
*     THEN                          /* NO - UPDATE TO NEXT CHAR      */
@RF00579 DS    0H                                                  0585
NP3DETL0 CLI   NP3SCANR(COUNTREG),C' '                             0585
         BE    @RF00585                                            0585
*     DO;                                                          0586
*       COUNTREG=COUNTREG+1;                                       0587
         LA    COUNTREG,1(,COUNTREG)                               0587
*       GO TO NP3DETL0;             /* CHECK NEXT CHAR               */
         B     NP3DETL0                                            0588
*     END;                                                         0589
*   ELSE                            /* YES - END OF STRING           */
*     DO;                                                          0590
@RF00585 DS    0H                                                  0591
*       STRGLN=COUNTREG-RPARM;      /* GET STRING LENGTH             */
         LR    @10,COUNTREG                                        0591
         SLR   @10,RPARM                                           0591
         ST    @10,STRGLN                                          0591
*     END;                                                         0592
*   RESPECIFY                                                      0593
*     COUNTREG UNRESTRICTED;                                       0593
*   SAVEONE=RPARM;                  /* SAVE REG 1                    */
         ST    RPARM,SAVEONE                                       0594
*   IF NP3SYLST='1'B               /* IS LIST FLAG ON               */
*     THEN                                                         0595
         TM    NP3SYLST,B'00100000'                                0595
         BNO   @RT00595                                            0595
*     GO TO NP3SPAVL;               /* NO - FIND IF THERE IS ENOUGH
*                                      SPACE AVAILABLE IN PRESENT  0596
*                                      PARMAREA                      */
*   RESPECIFY                                                      0597
*     NWTOHDR BASED(MSG08PT);                                      0597
*   STRING=MSGBUFF;                                                0598
         MVC   STRING(71),MSGBUFF(RPARM)                           0598
*   NWTOLNG=STRGLN+LENGTH(NWTOHDR);                                0599
         AL    @10,@CF00371                                        0599
         L     @09,MSG08PT                                         0599
         STH   @10,NWTOLNG(,@09)                                   0599
*   IF NP3SYHDR='1'B                /* IS THIS FIRST MEMBER READ     */
*     THEN                                                         0600
         TM    NP3SYHDR,B'00000010'                                0600
         BNO   @RF00600                                            0600
*     DO;                                                          0601
*       XX=LISTNAM;                 /* FILL IN LIST NAME (XX) FOR  0602
*                                      PARAM LIST HEADER             */
*                                                                  0602
         MVC   XX(2),LISTNAM                                       0602
*       /*************************************************************/
*       /*                                                           */
*       /* IEASYSXX PARAMETER LIST HEADER MESSAGE                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0603
*       GENERATE REFS(NVTWTO);                                     0603
          IEAPMNIP TYPE=WTO,PARAM=MESG17   CALL WTO SERVICE ROUTINE
*     END;                                                         0604
*                                                                  0604
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT PARAMETER STRING                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0605
*   GENERATE REFS(NVTWTO);                                         0605
*                                                                  0605
@RF00600 DS    0H                                                  0605
          IEAPMNIP TYPE=WTO,PARAM=MESG08 CALL WTO SERVICE ROUTINE
*   /*****************************************************************/
*   /*                                                               */
*   /* IS THE STRING LENGTH PLUS THE LENGTH OF CONT' GREATER THAN THE*/
*   /* SPACE AVAILABLE IN PARMAREA                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0606
*NP3SPAVL:                                                         0606
*   NP3SYHDR='0'B;                  /* RESET SWITCH TO ZERO          */
NP3SPAVL NI    NP3SYHDR,B'11111101'                                0606
*   IF NIPPABYT+STRGLN+LENGTH(CONTCHAR)>ADDR(NIPPAHDR)+2048 THEN   0607
         L     @10,PARMBASE                                        0607
         L     @09,NIPPABYT(,@10)                                  0607
         AL    @09,STRGLN                                          0607
         AH    @09,@CH00170                                        0607
         AH    @10,@CH02180                                        0607
         CR    @09,@10                                             0607
         BNH   @RF00607                                            0607
*     DO;                                                          0608
*                                                                  0608
*       /*************************************************************/
*       /*                                                           */
*       /* GET ADDITIONAL PARMAREA                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0609
*       CALL NP3PAGM;                                              0609
         BAL   @14,NP3PAGM                                         0609
*       RESPECIFY                                                  0610
*         NP3SCAN5 BASED(NIPPABYT);                                0610
*                                                                  0610
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF THE NEXT CHARACTER POINTER REFLECTS ADDITIONS*/
*       /* TO THE PREVIOUS PARMAREA                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0611
*       IF NP3NCHAR=NIPPABYT       /* DOES NEXT CHAR PTR = NEXT   0611
*                                      AVAILABLE BYTE                */
*         THEN                                                     0611
         L     @10,PARMBASE                                        0611
         L     @09,NIPPABYT(,@10)                                  0611
         C     @09,NP3NCHAR                                        0611
         BE    @RF00611                                            0611
*         DO;                                                      0612
*           NP3SCAN5=CONTCHAR;      /* NO - MOVE CONT' TO PREVIOUS 0613
*                                      PARAMAREA                     */
         MVC   NP3SCAN5(5,@09),CONTCHAR                            0613
*           PARMBASE=NIPPAQ;        /* SET BASE FOR NEW PARMAREA     */
         L     @10,NIPPAQ(,@10)                                    0614
         ST    @10,PARMBASE                                        0614
*         END;                                                     0615
*       ELSE                                                       0616
*         DO;                                                      0616
         B     @RC00611                                            0616
@RF00611 DS    0H                                                  0617
*           PARMBASE=NIPPAQ;        /* YES - POINT TO NEXT PARMAREA  */
         L     @10,PARMBASE                                        0617
         L     @10,NIPPAQ(,@10)                                    0617
         ST    @10,PARMBASE                                        0617
*           NP3NCHAR=NIPPABYT;      /* NEXT CHAR PTR = NEXT AVAIL  0618
*                                      BYTE IN NEW PARMAREA          */
         MVC   NP3NCHAR(4),NIPPABYT(@10)                           0618
*         END;                                                     0619
*     END;                                                         0620
@RC00611 DS    0H                                                  0621
*   RPARM=SAVEONE;                  /* RESTORE REG 1                 */
*                                                                  0621
@RF00607 L     RPARM,SAVEONE                                       0621
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE PARM STRING TO NEXT AVAILABLE SPACE IN PARMAREA          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0622
*NP3MOVST:                                                         0622
*   IF STRGLN=0                    /* HAS ALL OF STRING BEEN MOVED  */
*     THEN                          /* NO - MOVE REST                */
NP3MOVST L     @10,STRGLN                                          0622
         LTR   @10,@10                                             0622
         BZ    @RF00622                                            0622
*     DO;                                                          0623
*       NP3SCANR=MSGBUFF1;          /* MOVE NEXT CHAR TO PARMAREA    */
         L     @09,PARMBASE                                        0624
         L     @15,NIPPABYT(,@09)                                  0624
         MVC   NP3SCANR(1,@15),MSGBUFF1(RPARM)                     0624
*       RPARM=RPARM+1;              /* INCREMENT STRING PTR          */
         LA    @14,1                                               0625
         ALR   RPARM,@14                                           0625
*       NIPPABYT=NIPPABYT+1;        /* INCREMENT NEXT AVAILABLE BYTE
*                                      IN PARMAREA PTR               */
         ALR   @15,@14                                             0626
         ST    @15,NIPPABYT(,@09)                                  0626
*       STRGLN=STRGLN-1;            /* DECREMENT STRING LENGTH       */
         BCTR  @10,0                                               0627
         ST    @10,STRGLN                                          0627
*       GO TO NP3MOVST;             /* CHECK STRING LENGTH           */
         B     NP3MOVST                                            0628
*     END;                                                         0629
*   RPARM=RPARM-1;                  /* POINT TO LAST CHAR MOVED      */
@RF00622 BCTR  RPARM,0                                             0630
*   IF MSGBUFF1=','                 /* IS LAST CHAR A ','            */
*     THEN                                                         0631
         CLI   MSGBUFF1(RPARM),C','                                0631
         BE    @RT00631                                            0631
*     GO TO NP3SYTXT;               /* YES - GO READ NEXT RECORD     */
*NP3SYTND:                                                         0633
*   NP3SCANR=QUOTE;                 /* APPEND EBCDIC QUOTE TO END OF
*                                      PARM STRING                   */
NP3SYTND L     @10,PARMBASE                                        0633
         L     @10,NIPPABYT(,@10)                                  0633
         MVC   NP3SCANR(1,@10),QUOTE                               0633
*   RESPECIFY                                                      0634
*     RPARM UNRESTRICTED;                                          0634
*   NP3CTAB=ADDR(PTABLN);           /* SET OPLIBTAB BASE AS PLIBTAB  */
         LA    @10,PTABLN                                          0635
         ST    @10,NP3CTAB                                         0635
*   NP3CENT=ADDR(OPSPOPI);          /* POINT TO OPI ENTRY            */
         LA    @10,OPSPOPI(,@10)                                   0636
         ST    @10,NP3CENT                                         0636
*   OPLIBENT=OPLIBENT&&OPLIBENT;    /* SET OPI ENTRY TO ZERO IN    0637
*                                      PLIBTAB                       */
         XC    OPLIBENT(16,@10),OPLIBENT(@10)                      0637
*   SAVESCAN=SCANREG;               /* SAVE SYSP LIST SCAN POINTER   */
*                                                                  0638
         ST    SCANREG,SAVESCAN                                    0638
*   /*****************************************************************/
*   /*                                                               */
*   /* IDENTIFY PARAMETERS AND ENTER IN PLIBTAB                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0639
*NP3SYSFT:                                                         0639
*   CALL NP3SCAN;                                                  0639
NP3SYSFT BAL   @14,NP3SCAN                                         0639
*   GENERATE FLOWS(NP3SYOPI,NP3SYPFL,NP3SYCNT) NOSEQFLOW;          0640
          B     NP3SYOPI
          B     NP3SYPFL
          B     NP3SYCNT
*NP3SYCNT:                                                         0641
*   NP3NCHAR=NIPPAQ+LENGTH(NIPPAHDR);/* UPDATE NEXT CHAR POINTER TO
*                                      BYTE AFTER NEXT PARMAREA    0641
*                                      HEADER                        */
NP3SYCNT LA    @10,8                                               0641
         L     @09,PARMBASE                                        0641
         AL    @10,NIPPAQ(,@09)                                    0641
         ST    @10,NP3NCHAR                                        0641
*   GO TO NP3SYSFT;                                                0642
         B     NP3SYSFT                                            0642
*   RESPECIFY                                                      0643
*     NP3SCAN5 BASED(NIPPTADR);                                    0643
*NP3SYOPI:                                                         0644
*   NP3CENT=ADDR(OPSPOPI);          /* POINT TO OPI ENTRY            */
NP3SYOPI L     @10,NP3CTAB                                         0644
         LA    @10,OPSPOPI(,@10)                                   0644
         ST    @10,NP3CENT                                         0644
*   IF NIPPTADR=0                   /* IS OPI SPECIFIED              */
*     THEN                                                         0645
         L     @10,NIPPTADR(,@10)                                  0645
         LTR   @10,@10                                             0645
         BZ    @RT00645                                            0645
*     GO TO NP3SYNXT;               /* NO - CHECK NEXT LIST NAME     */
*   IF NP3SCAN3='YES'               /* IS OPI = YES                  */
*     THEN                                                         0647
         CLC   NP3SCAN3(3,@10),@CC02486                            0647
         BE    @RT00647                                            0647
*     GO TO NP3SYNXT;               /* YES - CHECK NEXT LIST NAME    */
*   IF NP3SCAN2='NO'               /* IS OPI = NO                   */
*     THEN                          /* NO- WHAT OPI ='S IS INVALID   */
         CLC   NP3SCAN2(2,@10),@CC02487                            0649
         BE    @RF00649                                            0649
*     DO;                                                          0650
*NP3SYOER:                                                         0651
*       SYSNAME=IEASYS;             /* FILL IN MEMBER NAME           */
*                                                                  0651
NP3SYOER MVC   SYSNAME(8),IEASYS                                   0651
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID OPI PARAMETER                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0652
*       GENERATE REFS(NVTWTO);                                     0652
          IEAPMNIP TYPE=WTO,PARAM=MESG09 CALL WTO SERVICE ROUTINE
*       GO TO NP3SYPFL;                                            0653
         B     NP3SYPFL                                            0653
*     END;                                                         0654
*                                                                  0654
*   /*****************************************************************/
*   /*                                                               */
*   /* OPI = NO - SCAN PLIBTAB FOR INPUT ID AND RESTRICT THOSE       */
*   /* ENTRIES                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0655
*   NP3CENT=ADDR(PTABLN);           /* GET BEGINNING ADDRESS OF    0655
*                                      PLIBTAB                       */
@RF00649 LA    @10,PTABLN                                          0655
         ST    @10,NP3CENT                                         0655
*NP3NXOPI:                                                         0656
*   NP3CENT=NP3CENT+LENGTH(OPLIBENT);/* SKIP DUMMY ENTRY FIRST TIME -
*                                      UPDATE TO NEXT ENTRIES LATER  */
NP3NXOPI LA    @10,16                                              0656
         AL    @10,NP3CENT                                         0656
         ST    @10,NP3CENT                                         0656
*   IF NP3CENT=ADDR(PTABLN)+LENGTH(OPLIBTAB)/* IS THIS THE END OF 0657
*                                      THE TABLE                     */
*     THEN                          /* NO - CHECK PARAMETER          */
         LA    @09,PTABLN                                          0657
         AH    @09,@CH02860                                        0657
         CR    @10,@09                                             0657
         BE    @RF00657                                            0657
*     DO;                                                          0658
*       IF INSRCID=LISTNAM          /* IF THIS PARM IS SPECIFIED,    */
*         THEN                                                     0659
         CLC   INSRCID(2,@10),LISTNAM                              0659
         BNE   @RF00659                                            0659
*         OPIOPT='1'B;              /* SET OPI OPTION FOR THIS PARM  */
         OI    OPIOPT(@10),B'10000000'                             0660
*       GO TO NP3NXOPI;             /* GO CHECK NEXT PARM            */
         B     NP3NXOPI                                            0661
*     END;                                                         0662
*NP3SYNXT:                                                         0663
*   IF MULTSYSP='0'B                /* IS MULTI SYSP SWITCH SET      */
*     THEN                          /* NO -                          */
@RF00657 DS    0H                                                  0663
NP3SYNXT TM    MULTSYSP,B'01000000'                                0663
         BNZ   @RF00663                                            0663
*     DO;                                                          0664
*                                                                  0664
*       /*************************************************************/
*       /*                                                           */
*       /* IS SYSP DEFAULT SWITCH SET                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0665
*       IF NP3SYSPD='1'B THEN       /* YES - IEASYS00 DONE           */
         TM    NP3SYSPD,B'00010000'                                0665
         BO    @RT00665                                            0665
*         GO TO NP3SYXIT;           /* RETURN TO CALLER              */
*       ELSE                        /* NO -                          */
*         DO;                                                      0667
*           NP3SYSPD='1'B;          /* INDICATE IEASYS00 DONE        */
         OI    NP3SYSPD,B'00010000'                                0668
*           NP3CTAB=ADDR(OPTABLN);  /* POINT TO OPER TAB             */
         LA    @10,OPTABLN                                         0669
         ST    @10,NP3CTAB                                         0669
*           NP3CENT=ADDR(OPSPSYSP); /* PT TO OPER SYSP               */
         LA    @10,OPSPSYSP(,@10)                                  0670
         ST    @10,NP3CENT                                         0670
*           NP3CTAB=ADDR(PTABLN);   /* POINT BACK TO PTAB            */
         LA    @10,PTABLN                                          0671
         ST    @10,NP3CTAB                                         0671
*           GO TO NP3SYNDF;         /* GET REST OF SYSP              */
         B     NP3SYNDF                                            0672
*         END;                                                     0673
*     END;                                                         0674
*   SCANREG=SAVESCAN;               /* RESTORE SCAN LIST POINTER     */
@RF00663 L     SCANREG,SAVESCAN                                    0675
*   SCANREG=SCANREG+2;              /* POINT TO NEXT LIST NAME     0676
*                                      PARAMETER                     */
         LA    SCANREG,2(,SCANREG)                                 0676
*   RESPECIFY                                                      0677
*     NP3SCAN5 BASED(SCANREG);                                     0677
*NP3SYSCN:                                                         0678
*   IF NP3SCANR='FF'X               /* IS THIS A NULL CHAR           */
*     THEN                                                         0678
NP3SYSCN CLI   NP3SCANR(SCANREG),X'FF'                             0678
         BNE   @RF00678                                            0678
*     DO;                                                          0679
*       SCANREG=SCANREG+1;          /* UPDATE SCAN PTR               */
         LA    SCANREG,1(,SCANREG)                                 0680
*       GO TO NP3SYSCN;             /* CHECK NEXT CHAR               */
         B     NP3SYSCN                                            0681
*     END;                                                         0682
*   IF NP3SCANR=','                 /* IS CHAR A ','                 */
*     THEN                          /* YES - LOOK AT NEXT CHAR       */
@RF00678 CLI   NP3SCANR(SCANREG),C','                              0683
         BNE   @RF00683                                            0683
*     DO;                                                          0684
*       SCANREG=SCANREG+1;          /* UPDATE SCAN POINTER           */
         LA    SCANREG,1(,SCANREG)                                 0685
*       GO TO NP3ALPHA;             /* CHECK FOR ALPHAMERIC          */
         B     NP3ALPHA                                            0686
*     END;                                                         0687
*   IF NP3SCANR=')'                 /* IS CHAR A ')'                 */
*     THEN                                                         0688
@RF00683 CLI   NP3SCANR(SCANREG),C')'                              0688
         BE    @RT00688                                            0688
*     GO TO NP3SYXIT;               /* END OF LIST NAMES RETURN TO 0689
*                                      CALLER                        */
*NP3SYINV:                                                         0690
*   SYSPNAME=SYSPCHAR;                                             0690
*                                                                  0690
NP3SYINV MVC   SYSPNAME(4),SYSPCHAR                                0690
*   /*****************************************************************/
*   /*                                                               */
*   /* MESSAGE - INVALID SYSP PARM - RESPECIFY OR CANCEL             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0691
*   GENERATE REFS(NVTWTOR);                                        0691
          IEAPMNIP TYPE=WTOR,PARAM=PLIST10 CALL WTOR SERVICE ROUTINE
*   SCANREG=ADDR(RPLYBUF);          /* SET SCAN LIST POINTER TO    0692
*                                      OPERATOR REPLY                */
         LA    SCANREG,RPLYBUF                                     0692
*   IF NP3SCAN2=NP3BLNKQ            /* DID OPERATOR REPLY CANCEL   0693
*                                      (EOB)                         */
*     THEN                                                         0693
         CLC   NP3SCAN2(2,SCANREG),NP3BLNKQ                        0693
         BE    @RT00693                                            0693
*     GO TO NP3SYXIT;               /* YES - RETURN TO CALLER        */
*   IF NP3SCAN5='SYSP='            /* IS PARM SYSP=                 */
*     THEN                                                         0695
         CLC   NP3SCAN5(5,SCANREG),@CC02498                        0695
         BNE   @RT00695                                            0695
*     GO TO NP3SYINV;               /* NO - INVALID PARM MESSAGE     */
*   SCANREG=SCANREG+LENGTH('SYSP=');/* POINT TO START OF           0697
*                                      SUBPARAMETERS                 */
         LA    SCANREG,5(,SCANREG)                                 0697
*   NP3CTAB=ADDR(OPTABLN);          /* SET BASE FOR SYSP ENTRY IN  0698
*                                      OPERTAB                       */
         LA    @10,OPTABLN                                         0698
         ST    @10,NP3CTAB                                         0698
*   NP3CENT=ADDR(OPSPSYSP);                                        0699
         LA    @10,OPSPSYSP(,@10)                                  0699
         ST    @10,NP3CENT                                         0699
*   CONTAD=CONTAD&&CONTAD;          /* RESET CONT PTR FOR SYSP IN  0700
*                                      OPERTAB TO ZERO               */
         L     @09,CONTAD(,@10)                                    0700
         LR    @15,@09                                             0700
         XR    @15,@09                                             0700
         ST    @15,CONTAD(,@10)                                    0700
*   MULTSYSP='0'B;                  /* TURN MULTI SYSP SWITCH OFF    */
         NI    MULTSYSP,B'10111111'                                0701
*   GO TO NP3SYRTY;                 /* GO ANALYZE NEW PARMS          */
         B     NP3SYRTY                                            0702
*NP3SYXIT:                                                         0703
*   GO TO NP3SYPA0;                 /* RETURN TO CALLER              */
NP3SYXIT L     @10,NP3SYPAD                                        0703
         BR    @10                                                 0703
*                                                                  0704
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE MERGES THE OPERATOR SPECIFIED SYSTEM          */
*   /* PARAMETERS WITH THOSE SYSTEM PARAMETERS SPECIFIED THROUGH THE */
*   /* IEASYSXX MEMBERS OF SYS1.PARMLIB. SPECIFICALLY, THE OPERATORS */
*   /* PARMTAB IS MERGED INTO THE PARMLIB PARMTAB                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0704
*   RESPECIFY                                                      0704
*     OPERREG RESTRICTED;           /* POINTS TO OPERATOR PARMTAB    */
*   RESPECIFY                                                      0705
*     PARMREG RESTRICTED;           /* POINTS TO PARMLIB PARMTAB     */
*   RESPECIFY                                                      0706
*     INDEXREG RESTRICTED;          /* CONTAINS CELL INCREMENT FOR 0706
*                                      PARMTAB'S                     */
*   RESPECIFY                                                      0707
*     COUNTREG RESTRICTED;          /* TRACKS COUNT CYCLE FOR MERGE
*                                      OPERATION                     */
*NP3PLMRG:                                                         0708
*   NP3RTADR=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
NP3PLMRG ST    REXIT,NP3RTADR                                      0708
*   OPERREG=ADDR(OPTABLN);          /* SET MAPPING BASE ADDRESS FOR
*                                      OPERATOR PARMTAB              */
         LA    OPERREG,OPTABLN                                     0709
*   PARMREG=ADDR(PTABLN);           /* SET MAPPING BASE ADDRESS FOR
*                                      PARMLIB PARMTAB               */
         LA    PARMREG,PTABLN                                      0710
*   NP3CTAB=PARMREG;                /* MAP PARMTAB TO PARMLIB ADDRESS*/
*                                                                  0711
         ST    PARMREG,NP3CTAB                                     0711
*   /*****************************************************************/
*   /*                                                               */
*   /* GET NUMBER OF ENTRIES IN PARAMETER ADDRESS TABLE              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0712
*   COUNTREG=LENGTH(PARMTAB)/LENGTH(PTABSTRT);                     0712
         LA    COUNTREG,40                                         0712
*   INDEXREG=0;                     /* SET INDEX CONTROL ELEMENT TO
*                                      ZERO ORIGIN                   */
*                                                                  0713
         SLR   INDEXREG,INDEXREG                                   0713
*   /*****************************************************************/
*   /*                                                               */
*   /* BEGIN MERGE SEQUENCE FOR OPERATOR/PARMLIB PARMTAB'S OPERATORS */
*   /* PARMTAB IS MERGED INTO THE PARMLIB PARMTAB CHECK TO SEE IF ALL*/
*   /* PARMTAB ENTRIES HAVE BEEN MERGED                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0714
*NP3MRGST:                                                         0714
*   IF COUNTREG=0                  /* IS ENTRY COUNT GREATER THEN 0 */
*     THEN                          /* YES, MERGE SEQUENCE NOT DONE  */
NP3MRGST LTR   COUNTREG,COUNTREG                                   0714
         BZ    @RF00714                                            0714
*     DO;                                                          0715
*       NP3CENT=PARMREG;            /* POINT TO PLIBTAB              */
*                                                                  0716
         ST    PARMREG,NP3CENT                                     0716
*       /*************************************************************/
*       /*                                                           */
*       /* HAS THIS PARAMETER BEEN CANCELED                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0717
*       IF CANOPT='1'B THEN         /* YES -                         */
         L     @10,NP3CENT                                         0717
         TM    CANOPT(@10),B'00100000'                             0717
         BNO   @RF00717                                            0717
*         OPLIBENT=OPLIBENT&&OPLIBENT;/* ZERO PLIBTAB ENTRY          */
*                                                                  0718
         XC    OPLIBENT(16,@10),OPLIBENT(@10)                      0718
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF OPERATOR PARMTAB ENTRY IS EMPTY           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0719
*       IF OPERVAL=0               /* ENTRY GREATER THEN ZERO       */
*         THEN                      /* YES, THE OPERATOR HAS       0719
*                                      SPECIFIED PARAMETERS FOR THIS
*                                      CURRENT PARMTAB ENTRY         */
@RF00717 ICM   @10,15,OPERVAL(OPERREG)                             0719
         BZ    @RF00719                                            0719
*         DO;                                                      0720
*           NP3CENT=OPERREG;        /* POINT TO OPERTAB ENTRY        */
         ST    OPERREG,NP3CENT                                     0721
*           RESPECIFY                                              0722
*             NP3SCAN5 BASED(NIPPTADR);                            0722
*           IF NP3SCAN4='(,L)'      /* IS DEFAULT WITH LIST OPTION 0723
*                                      SPECIFIED(,L)                 */
*             THEN                                                 0723
         L     @10,NP3CENT                                         0723
         L     @10,NIPPTADR(,@10)                                  0723
         CLC   NP3SCAN4(4,@10),@CC02504                            0723
         BNE   @RF00723                                            0723
*             DO;                   /* YES - SET LIST OPTION         */
*               NP3CENT=PARMREG;    /* POINT TO PARMTB               */
         ST    PARMREG,NP3CENT                                     0725
*               NIPPTLST='1'B;      /* SET LIST FLAG                 */
         L     @10,NP3CENT                                         0726
         OI    NIPPTLST(@10),B'01000000'                           0726
*               GO TO NP3NXFLD;     /* BRANCH TO SET UP FOR NEXT   0727
*                                      ENTRY MERG                    */
         B     NP3NXFLD                                            0727
*             END;                                                 0728
*           ELSE                                                   0729
*             DO;                                                  0729
@RF00723 DS    0H                                                  0730
*               NP3CENT=PARMREG;    /* POINT TO PARMTB               */
         ST    PARMREG,NP3CENT                                     0730
*               IF NIPPTOPI='1'B    /* IS THIS A RESTRICTED PARM     */
*                 THEN                                             0731
         L     @10,NP3CENT                                         0731
         TM    NIPPTOPI(@10),B'10000000'                           0731
         BO    @RT00731                                            0731
*                 GO TO NP3IGNOP;   /* YES - GIVE PARM IGNORED MSG   */
*               NP3CENT=OPERREG;    /* POINT TO OPERTB               */
*                                                                  0733
         ST    OPERREG,NP3CENT                                     0733
*               /*****************************************************/
*               /*                                                   */
*               /* HAS THIS PARAMETER BEEN CANCELED                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0734
*               IF CANOPT='1'B THEN /* YES - OPERATOR HAS CANCELLED
*                                      THIS PARM                     */
         L     @10,NP3CENT                                         0734
         TM    CANOPT(@10),B'00100000'                             0734
         BNO   @RF00734                                            0734
*                 DO;               /* ZERO ENTRY FOR THIS PARM IN 0735
*                                      OPERTAB AND PARMTAB           */
*                   OPLIBENT=OPLIBENT&&OPLIBENT;                   0736
         XC    OPLIBENT(16,@10),OPLIBENT(@10)                      0736
*                   NP3CENT=PARMREG;/* POINT TO PARMTAB              */
         ST    PARMREG,NP3CENT                                     0737
*                   OPLIBENT=OPLIBENT&&OPLIBENT;                   0738
         L     @10,NP3CENT                                         0738
         XC    OPLIBENT(16,@10),OPLIBENT(@10)                      0738
*                 END;                                             0739
*               NP3CENT=OPERREG;    /* POINT TO OPERTB               */
@RF00734 ST    OPERREG,NP3CENT                                     0740
*               IF NIPPTMRG='1'B    /* IS MERGE FLAG ON FOR THIS PARM*/
*                 THEN                                             0741
         L     @10,NP3CENT                                         0741
         TM    NIPPTMRG(@10),B'10000000'                           0741
         BNO   @RF00741                                            0741
*                 DO;                                              0742
*                                                                  0742
*                   /*************************************************/
*                   /*                                               */
*                   /* DECREMENT COUNT CONTROL ELEMENT FOR THIS ENTRY*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0743
*                   COUNTREG=COUNTREG-1;                           0743
*                                                                  0743
         BCTR  COUNTREG,0                                          0743
*                   /*************************************************/
*                   /*                                               */
*                   /* MOVE OPERATOR SPECIFIED PARAMETER ENTRY       */
*                   /* CONTENTS INTO PARMLIB PARMTAB ENTRY.          */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0744
*                   PARMTABO=OPERTABC;                             0744
*                                                                  0744
         LA    @10,16                                              0744
         LR    @09,PARMREG                                         0744
         ALR   @09,@10                                             0744
         MVC   PARMTABO(16,@09),OPERTABC(OPERREG)                  0744
*                   /*************************************************/
*                   /*                                               */
*                   /* INCREMENT OFFSET INTO PARMTABS BY ENTRY       */
*                   /* CELLSIZE                                      */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0745
*                   INDEXREG=LENGTH(OPLIBENT)+INDEXREG;            0745
*                                                                  0745
         ALR   INDEXREG,@10                                        0745
*                   /*************************************************/
*                   /*                                               */
*                   /* BRANCH TO SET UP FOR NEXT ENTRY MERGE         */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0746
*                   GO TO NP3NXFLD;                                0746
         B     NP3NXFLD                                            0746
*                 END;                                             0747
*               ELSE                                               0748
*                 DO;                                              0748
*                                                                  0748
@RF00741 DS    0H                                                  0749
*                   /*************************************************/
*                   /*                                               */
*                   /* MOVE THE OPERATOR ENTRY CONTENT INTO THE      */
*                   /* PARMLIB ENTRY                                 */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0749
*                   PARMTABC=OPERTABC;                             0749
*                                                                  0749
         MVC   PARMTABC(16,PARMREG),OPERTABC(OPERREG)              0749
*                   /*************************************************/
*                   /*                                               */
*                   /* BRANCH TO SET UP FOR NEXT ENTRY MERGE         */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0750
*                   GO TO NP3NXFLD;                                0750
         B     NP3NXFLD                                            0750
*                 END;                                             0751
*             END;                                                 0752
*         END;                                                     0753
*       ELSE                        /* OPERATOR DID NOT SPECIFY    0754
*                                      PARAM. FOR THIS CURRENT     0754
*                                      PARMTAB ENTRY                 */
*         GO TO NP3NXFLD;           /* BRANCH TO SETUP FOR NEXT ENTRY
*                                      MERGE                         */
*     END;                                                         0755
*   ELSE                            /* MERGE OPERATION IS COMPLETED  */
*     GO TO NP3RTAD0;               /* RETURN TO CALLER              */
*                                                                  0756
@RF00714 L     @10,NP3RTADR                                        0756
         BR    @10                                                 0756
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP FOR NEXT PARMTAB'S ENTRY MERGE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0757
*NP3NXFLD:                                                         0757
*   COUNTREG=COUNTREG-1;            /* DECREMENT PARMTAB ENTRY COUNT */
NP3NXFLD BCTR  COUNTREG,0                                          0757
*   INDEXREG=LENGTH(OPLIBENT)+INDEXREG;/* UPDATE INDEX BY ENTRY SIZE */
*                                                                  0758
         LA    INDEXREG,16(,INDEXREG)                              0758
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE MAPPING BASE ADDRESS FOR PARMLIB PARMTAB               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0759
*   PARMREG=INDEXREG+ADDR(PTABLN);                                 0759
*                                                                  0759
         LA    PARMREG,PTABLN                                      0759
         ALR   PARMREG,INDEXREG                                    0759
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE MAPPING BASE ADDRESS FOR OPERATOR PARMTAB              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0760
*   OPERREG=INDEXREG+ADDR(OPTABLN);                                0760
         LA    OPERREG,OPTABLN                                     0760
         ALR   OPERREG,INDEXREG                                    0760
*   GO TO NP3MRGST;                 /* BRANCH TO MERGE SEQUENCE      */
*                                                                  0761
         B     NP3MRGST                                            0761
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE SETS UP TO ISSUE A PARAMETER IGNORE MESSAGE TO*/
*   /* THE OPERATOR AND CONVERTS THE NEGATIVE CONTENT OF THE CURRENT */
*   /* MERGE ENTRY IN THE PARMLIB PARMTAB                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0762
*   RESPECIFY                                                      0762
*     SYMBLREG RESTRICTED;          /* BASED ADDRESS OF IGNORED    0762
*                                      PARAMETER SYMBOL FROM SYMBOL
*                                      TABLE                         */
*NP3IGNOP:                                                         0763
*   SYMBLREG=INDEXREG/2+ADDR(NP3SYMBL);/* LOCATE ERROR PARAMETER   0763
*                                      SYMBOL IN SYMBOL TABLE        */
NP3IGNOP LR    SYMBLREG,INDEXREG                                   0763
         SRL   SYMBLREG,1                                          0763
         LA    @10,NP3SYMBL                                        0763
         ALR   SYMBLREG,@10                                        0763
*   PRMIGNOR=SYMBLID;               /* MOVE SYMBOL INTO IGNORE     0764
*                                      MESSAGE                       */
*                                                                  0764
         MVC   PRMIGNOR(8),SYMBLID(SYMBLREG)                       0764
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECKS THE LENGTH OF SYMBOL MOVED INTO IGNORE MESSAGE TEXT FOR*/
*   /* VALUE GREATER THEN SEVEN. IF YES, NO OVERSTRIKE OF LENGTH     */
*   /* VALUE IN TEXT IS NEEDED.                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0765
*   IF SYMLNGTH>LENGTH(SYMBSTRT)-1  /* LENGTH VALUE GREATER THEN 7   */
*     THEN                          /* YES, NO OVERSTRIKE IS NEEDED  */
         CLI   SYMLNGTH,7                                          0765
         BH    @RT00765                                            0765
*     GO TO NP3IMSG;                /* BRANCH TO NIPWTO INTERFACE  0766
*                                      BRANCH CALL                   */
*   ELSE                            /* NO, OVERSTRIKE OF LENGTH VALUE
*                                      NEEDED                        */
*     DO;                                                          0767
*       SYMBREP=NP3BLANK;           /* MOVE BLANK ONTO LENGTH VALUE  */
         MVC   SYMBREP(1),NP3BLANK                                 0768
*       GO TO NP3IMSG;              /* BRANCH TO NIPWTO INTERFACE  0769
*                                      BRANCH CALL                   */
         B     NP3IMSG                                             0769
*     END;                                                         0770
*   RESPECIFY                                                      0771
*     SYMBLREG UNRESTRICTED;        /* RELEASE ADDRESS REG.          */
*                                                                  0771
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS GENERATED BRANCH INTERFACE MACRO CALL NIPWTO IN IEAVNIPM */
*   /* FOR ISSUING THE IGNORE MESSAGE TEXT TO THE OPERATOR.          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0772
*   GENERATE REFS(NVTWTO) DEFS(NP3IMSG);                           0772
NP3IMSG  DS    0H
         IEAPMNIP   TYPE=WTO,PARAM=MESG03
*   GO TO NP3NXFLD;                 /* BRANCH TO SETUP FOR NEXT ENTRY
*                                      FOR MERGE OPERATION           */
         B     NP3NXFLD                                            0773
*   RESPECIFY                                                      0774
*     OPERREG UNRESTRICTED;         /* RELEASE MERGE REGISTER        */
*   RESPECIFY                                                      0775
*     INDEXREG UNRESTRICTED;        /* RELEASE MERGE REGISTER        */
*                                                                  0776
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE PLIBTAB TO PARMTAB IN PARMAREA AND COMPRESS BY DELETING  */
*   /* NULL CHARACTERS                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0776
*   RESPECIFY                                                      0776
*     PLIBREG RESTRICTED;                                          0776
*   RESPECIFY                                                      0777
*     NIPPTE BASED(PARMREG);                                       0777
*   RESPECIFY                                                      0778
*     OPLIBENT BASED(PLIBREG);                                     0778
*   RESPECIFY                                                      0779
*     NIPPAREA BASED(PARMPTR);                                     0779
*   RESPECIFY                                                      0780
*     NIPPAHDR BASED(PARMPTR);                                     0780
*NP3PTAB:                                                          0781
*   NP3RTADR=REXIT;                 /* SAVE CALLER'S REUTRN ADDR     */
NP3PTAB  ST    REXIT,NP3RTADR                                      0781
*   PARMPTR=NVTPAREA;               /* POINT TO INITIAL PARMAREA     */
         L     @10,NVTPAREA(,RNVT)                                 0782
         ST    @10,PARMPTR                                         0782
*   NP3PAREA=NVTPAREA;              /* SET PTR TO LAST 2K AREA GOTTEN
*                                      = INITIAL PARMAREA (FOR     0783
*                                      GETMAIN SUBROUTINE)           */
         ST    @10,NP3PAREA                                        0783
*   NIPPABYT=ADDR(NIPPABUF);        /* NEXT AVAILABLE BYTE IS AREA 0784
*                                      FOLLOWING PARMTAB             */
         LA    @09,NIPPABUF(,@10)                                  0784
         ST    @09,NIPPABYT(,@10)                                  0784
*   PARMQPTR=NIPPAQ;                /* SAVE QUEUE POINTER            */
         L     @09,NIPPAQ(,@10)                                    0785
         ST    @09,PARMQPTR                                        0785
*   NIPPAQ=NIPPAQ&&NIPPAQ;          /* ZERO INITIAL PARMAREA CHAIN 0786
*                                      POINTER                       */
         LR    @05,@09                                             0786
         XR    @05,@09                                             0786
         ST    @05,NIPPAQ(,@10)                                    0786
*   PARMREG=ADDR(NIPPAPTB);         /* GET ADDR OF PARMTAB           */
         LA    PARMREG,NIPPAPTB(,@10)                              0787
*   PLIBREG=ADDR(PTABLN);           /* GET ADDR OF PLIBTAB           */
*                                                                  0788
         LA    PLIBREG,PTABLN                                      0788
*   /*****************************************************************/
*   /*                                                               */
*   /* GET NUMBER OF ENTRIES IN PARMTAB                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0789
*   COUNTREG=LENGTH(PARMTAB)/LENGTH(PTABSTRT);                     0789
         LA    COUNTREG,40                                         0789
*NP3PTNXT:                                                         0790
*   IF COUNTREG=0                   /* IS ENTRY COUNT ZERO           */
*     THEN                                                         0790
NP3PTNXT SLR   @10,@10                                             0790
         CR    COUNTREG,@10                                        0790
         BE    @RT00790                                            0790
*     GO TO NP3PTINT;               /* YES - MERGE IS DONE - GO    0791
*                                      FREEMAIN QUEUE                */
*   IF ORAD=0                       /* IS THIS ENTRY ZERO            */
*     THEN                                                         0792
         C     @10,ORAD(,PLIBREG)                                  0792
         BE    @RT00792                                            0792
*     GO TO NP3PTINX;               /* YES - NO SPECIFICATION FOR  0793
*                                      THIS PARAMETER                */
*   IF ORLN='0000'X                 /* IS SUBSTRING LENGTH OF THIS 0794
*                                      ENTRY ZERO                    */
*     THEN                          /* YES - SET ADDRESS VALUE       */
         CLC   ORLN(2,PLIBREG),@CB02317                            0794
         BNE   @RF00794                                            0794
*     DO;                           /* IN CURRENT ENTRY TO X'0A'     */
*       NIPPTADR='0A'X;             /* ADDR = X'0A'                  */
         LA    @10,10                                              0796
         ST    @10,NIPPTADR(,PARMREG)                              0796
*       GO TO NP3PTKEY;                                            0797
         B     NP3PTKEY                                            0797
*     END;                          /*                         Y02752*/
*                                                                  0798
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE PARAMETER ENTRY INTO SYSTEM PARMLIB            Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0799
*   CALL NPMOVEP;                   /*                         Y02752
*                                                              Y02752*/
@RF00794 BAL   @14,NPMOVEP                                         0799
*NP3PTKEY:                                                         0800
*   NIPPTOPF=OPFLAG;                /* MOVE OPI ,LIST, AND           */
NP3PTKEY MVC   NIPPTOPF(1,PARMREG),OPFLAG(PLIBREG)                 0800
*   NIPPTATF=ATTRFLAG;              /* MERGE FLAGS , AND INPUT       */
         MVC   NIPPTATF(1,PARMREG),ATTRFLAG(PLIBREG)               0801
*   NIPPTSID=INSRCID;               /* SOURCE ID TO PARMTAB          */
         MVC   NIPPTSID(2,PARMREG),INSRCID(PLIBREG)                0802
*NP3PTINX:                          /* WAS 'U,L' REQUESTED           */
*   IF NVTFLLST='1'B THEN           /* YES -                         */
NP3PTINX TM    NVTFLLST(RNVT),B'10000000'                          0803
         BNO   @RF00803                                            0803
*     NIPPTLST='1'B;                /* SET LIST FLAG IN PARMTAB ENTRY*/
         OI    NIPPTLST(PARMREG),B'01000000'                       0804
*   COUNTREG=COUNTREG-1;            /* DECREMENT COUNTER             */
@RF00803 BCTR  COUNTREG,0                                          0805
*   PARMREG=PARMREG+LENGTH(NIPPTE); /* UPDATE PARMTAB PTR BY ENTRY 0806
*                                      SIZE                          */
         LA    PARMREG,8(,PARMREG)                                 0806
*   PLIBREG=PLIBREG+LENGTH(OPLIBENT);/* UPDATE PLIBTAB PTR BY ENTRY
*                                      SIZE                          */
         LA    PLIBREG,16(,PLIBREG)                                0807
*   GO TO NP3PTNXT;                                                0808
         B     NP3PTNXT                                            0808
*   RESPECIFY                                                      0809
*     NIPPAREA BASED(NVTPAREA);                                    0809
*NP3PTINT:                                                         0810
*   NVTPTAB=ADDR(NIPPAPTB);         /* MOVE PARMTAB ADDR TO NVT      */
NP3PTINT L     @10,NVTPAREA(,RNVT)                                 0810
         LA    @10,NIPPAPTB(,@10)                                  0810
         ST    @10,NVTPTAB(,RNVT)                                  0810
*   RESPECIFY                                                      0811
*     NIPPAREA BASED(PARMPTR);                                     0811
*NP3PAFM:                                                          0812
*   PARMPTR=PARMQPTR;               /* GET ADDR OF CURRENT PARMAREA
*                                      ON QUEUE                      */
NP3PAFM  L     @10,PARMQPTR                                        0812
         ST    @10,PARMPTR                                         0812
*   PARMQPTR=NIPPAQ;                /* SAVE ADDR OF NEXT PARMAREA ON
*                                      QUEUE                         */
*                                                                  0813
         MVC   PARMQPTR(4),NIPPAQ(@10)                             0813
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE 2K BLOCK OF PARMAREA                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0814
*   GENERATE;                                                      0814
          FREEMAIN E,LV=2048,A=PARMPTR
*   IF PARMQPTR=0                  /* ARE THERE MORE PARMAREAS      */
*     THEN                                                         0815
         ICM   @10,15,PARMQPTR                                     0815
         BNZ   @RT00815                                            0815
*     GO TO NP3PAFM;                /* YES - GO FREE THEM            */
*                                                                  0816
*   /*****************************************************************/
*   /*                                                               */
*   /* NO MORE PARMAREAS TO FREE SO -                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0817
*NP3PTXIT:                                                         0817
*   GO TO NP3RTAD0;                 /* RETURN TO CALLER              */
NP3PTXIT L     @10,NP3RTADR                                        0817
         BR    @10                                                 0817
*   RESPECIFY                                                      0818
*     NIPPAREA BASED(NVTPAREA);                                    0818
*   RESPECIFY                                                      0819
*     PARMREG UNRESTRICTED;                                        0819
*   RESPECIFY                                                      0820
*     PLIBREG UNRESTRICTED;                                        0820
*   RESPECIFY                                                      0821
*     COUNTREG UNRESTRICTED;                                       0821
*                                                                  0822
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS FOR THE SYS1.LINKLIB DEFINITION               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0822
*   RESPECIFY                                                      0822
*     LNKLIB BASED(LCNAMPTR);                                      0822
*NP3LKLIB:                                                         0823
*   NP3RTADR=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
*                                                                  0823
NP3LKLIB ST    REXIT,NP3RTADR                                      0823
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH FOR SYS1.LINKLIB VIA LOCATE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0824
*   LNKLIB=LINKLIB;                 /* SET SYS1.LINKLIB NAME IN    0824
*                                      LOCATE LIST                   */
*                                                                  0824
         L     @10,LCNAMPTR                                        0824
         MVC   LNKLIB(12,@10),LINKLIB                              0824
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATES LOCATE MACRO FOR SYS1.LINKLIB SEARCH                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0825
*   GENERATE;                                                      0825
*                                                                  0825
         LOCATE     LOCLIB         ISSUE LOCATE FOR SYS1.LINKLIB
*   /*****************************************************************/
*   /*                                                               */
*   /* EXAMINES RETURN CODE FROM LOCATE FOR SYS1.LINKLIB. IF THE     */
*   /* RETURN CODE IS ANYTHING OTHER THEN ZERO,AN ERROR CONDITION IS */
*   /* ASSUMED. IF AN ERROR CONDITION EXIST,THE OPERATOR IS NOTIFIED */
*   /* AN ACTION TO PLACE THE SYSTEM IN A DISABLED WAIT STATE IS     */
*   /* TAKEN.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0826
*   IF LOCREG=0                    /* IS RETURN CODE OTHER THEN ZERO*/
*     THEN                          /* YES, ERROR CONDITION EXIST    */
         LTR   LOCREG,LOCREG                                       0826
         BZ    @RF00826                                            0826
*     DO;                                                          0827
*       NP3LOCER=LINKLIB;           /* MOVE DATA SET NAME INTO ERROR
*                                      MESSAGE TEXT                  */
*                                                                  0828
         MVC   NP3LOCER(12),LINKLIB                                0828
*       /*************************************************************/
*       /*                                                           */
*       /* GENERATED MACRO BRANCH INTERFACE CALL TO WTO              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0829
*       GENERATE REFS(NVTWTO);                                     0829
         IEAPMNIP   TYPE=WTO,PARAM=MESG06    ISSUE CALL TO WTO
*       NVTFLWSC=NVTFLWLC;          /* SET WAIT STATE CODE IN NVT    */
*                                                                  0830
         MVI   NVTFLWSC(RNVT),X'0A'                                0830
*       /*************************************************************/
*       /*                                                           */
*       /* GENERATE MACRO BRANCH INTERFACE CALL TO NIPSWAIT(IEAVNIPM)*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0831
*       GENERATE REFS(NVTSWAIT);                                   0831
         IEAPMNIP   TYPE=SWAIT               ISSUE CALL TO SWAIT
*     END;                                                         0832
*   ELSE                                                           0833
*     ;                             /* NO, LOCATE WAS SUCCESSFULL    */
@RF00826 DS    0H                                                  0834
*   RESPECIFY                                                      0834
*     NIPMNTPL BASED(NP3LST03);                                    0834
*   NMNTDS=LINKLIB;                 /* SET SYS1.LINKLIB NAME IN MOUNT
*                                      PARAMETER LIST                */
         L     @10,NP3LST03                                        0835
         MVC   NMNTDS(12,@10),LINKLIB                              0835
*   NMNTVS=NP3VOLSR;                /* SET VOLUME SERIAL IN NIPMOUNT
*                                      PARAMETER LIST                */
         MVC   NMNTVS(6,@10),NP3VOLSR                              0836
*   NMNTDT=NP3DVTYP;                /* SET DEVICE TYPE IN NIPMOUNT 0837
*                                      PARAMETER LIST                */
*                                                                  0837
         MVC   NMNTDT(2,@10),NP3DVTYP                              0837
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO BRANCH INTERFACE TO NIPMOUNT(IEAVNPM3)        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0838
*   GENERATE REFS(NVTMOUNT) SETS(RPARM,REXIT,RENTRY);              0838
         IEAPMNIP   TYPE=MOUNT,PARAM=PLIST03      ISSUE NIPMOUNT CALL
*   RESPECIFY                                                      0839
*     NIPOPNPL BASED(NP3LST04);                                    0839
*   RESPECIFY                                                      0840
*     RPARM RESTRICTED;                                            0840
*NP3OPEN:                                                          0841
*   NOPNUCB=RPARM;                  /* SET UCB ADDR IN LIST          */
NP3OPEN  L     @10,NP3LST04                                        0841
         ST    RPARM,NOPNUCB(,@10)                                 0841
*   RESPECIFY                                                      0842
*     RPARM UNRESTRICTED;                                          0842
*   NOPNDCB=CVTLINK;                /* SET LINKLIB DCB ADDRESS IN  0843
*                                      NIPOPEN PARAMETER LIST        */
*                                                                  0843
         MVC   NOPNDCB(4,@10),CVTLINK(CVTPTR)                      0843
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO BRANCH INTERFACE TO NIPOPEN(IEAVNPM3)         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0844
*   GENERATE REFS(NVTOPEN) SETS(RPARM,REXIT,RENTRY,NOPNFL);        0844
         IEAPMNIP   TYPE=OPEN,PARAM=PLIST04,OPT=(,LB,,,,,,RS)  @ZA01561
*   UCBPTR=NOPNUCB;                 /* SET BASE POINTER TO UCB       */
         L     @10,NP3LST04                                        0845
         L     @10,NOPNUCB(,@10)                                   0845
         ST    @10,UCBPTR                                          0845
*   UCBUSER=UCBUSER+1;              /* INCREMENT USE COUNT   @ZA02591*/
         LA    @09,1                                               0846
         SLR   @15,@15                                             0846
         IC    @15,UCBUSER(,@10)                                   0846
         ALR   @09,@15                                             0846
         STC   @09,UCBUSER(,@10)                                   0846
*   GO TO NP3RTAD0;                 /* RETURN TO CALLER              */
         L     @10,NP3RTADR                                        0847
         BR    @10                                                 0847
*                                                                  0848
*   /*****************************************************************/
*   /*                                                               */
*   /* DEFINE LINKLIB CONCATENATIONS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0848
*   DCL                                                            0848
*     YESS BIT(1) CONSTANT('1'B),   /* YES='1'BIT                    */
*     NONO BIT(1) CONSTANT('0'B),   /* NO='0'BIT                     */
*     LPARAN CHAR(1) CONSTANT('('), /* LEFT PARANTHESIS              */
*     RPARAN CHAR(1) CONSTANT(')'), /* RIGHT PARAN                   */
*     COMMA CHAR(1) CONSTANT(','),  /* COMMA CONSTANT                */
*     ONE FIXED(15) CONSTANT(01),   /* FOR ADDITION                  */
*     TWO FIXED(32) CONSTANT(02),   /* FOR ADDR UPDATE               */
*     FIVE FIXED(32) CONSTANT(05),  /* FOR TRT COMPARE               */
*     EIGHT FIXED(32) CONSTANT(08), /* FOR TRT COMPARE               */
*     SIXTEEN FIXED(32) CONSTANT(16),/* FOR END FILE TEST            */
*     UPCASE CHAR(2) CONSTANT('  '),/* FOR UPCASE SHIFT              */
*     ZERO FIXED(31) CONSTANT(00),  /* ZERO CONSTANT                 */
*     ZEROBIT BIT(1) CONSTANT('0'B),/* TO SET BITS                   */
*     ONEBIT BIT(1) CONSTANT('1'B); /* TO SET BITS             Y02754*/
*   DCL                                                            0849
*     MESG12B CHAR(8) GEND;         /* MESG MEM NAME           Y02754*/
*   DCL                                                            0850
*     ALLDONE BIT(1);               /* CONTROLER FORD          Y02754*/
*   DCL                                                            0851
*     PTRSAVE PTR(31);              /* SAVES ADDRESS           Y02754*/
*   DCL                                                            0852
*     #MEMBERS FIXED(15);           /* MEMS TO PROCES          Y02754*/
*   DCL                                                            0853
*     #PROCESD FIXED(15);           /* # MEMS PROCESD          Y02754*/
*   DCL                                                            0854
*     LNKPARMS CHAR(80) BASED;      /* RECORD IN PARM          Y02754*/
*   DCL                                                            0855
*     BADLNK CHAR(8) INIT('LNK') LOCAL;/* FOR MESG             Y02754*/
*   DCL                                                            0856
*     1 LNKMEM,                                                    0856
*       3 * CHAR(6),                /* MEM NAME HEAD           Y02754*/
*       3 NUMBER CHAR(2);           /* MEM NUMBER              Y02754*/
*   DCL                                                            0857
*     R2SAVE PTR(31);               /* SAVES NVT ADDR          Y02754*/
*   DCL                                                            0858
*     1 TRTTAB LOCAL,               /* TRANLATE + TEST               */
*       3 *(77) CHAR(1) INIT((77)'04'X),/* ERRORS                    */
*       3 * CHAR(1) INIT('03'X),    /* LEFTPARAN                     */
*       3 *(13) CHAR(1) INIT((13)'04'X),/* ERRORS                    */
*       3 * CHAR(1) INIT('00'X),    /* DOLLAR SIGN                   */
*       3 * CHAR(1) INIT('04'X),    /* ERROR                         */
*       3 * CHAR(1) INIT('08'X),    /* RIGHT PARAN                   */
*       3 *(13) CHAR(1) INIT((13)'04'X),/* ERROR CHARS               */
*       3 * CHAR(1) INIT('05'X),    /* COMMA                         */
*       3 *(15) CHAR(1) INIT((15)'04'X),/* ERROR CHARS               */
*       3 *(2) CHAR(1) INIT((2)'00'X),/* POUND + ATSING              */
*       3 * CHAR(1) INIT('01'X),    /* QOUTE TO STOP                 */
*       3 *(3) CHAR(1) INIT((3)'04'X),/* ERROR CHARS                 */
*       3 *(9) CHAR(1) INIT((9)'00'X),/* LOW CASE A-I                */
*       3 *(7) CHAR(1) INIT((7)'04'X),/* ERROR CHARS                 */
*       3 *(9) CHAR(1) INIT((9)'00'X),/* LOW CASE J-R                */
*       3 *(8) CHAR(1) INIT((8)'04'X),/* ERROR CHARS                 */
*       3 *(8) CHAR(1) INIT((8)'00'X),/* LOW CASE S-Z                */
*       3 *(23) CHAR(1) INIT((23)'04'X),/* ERROR CHARS               */
*       3 *(9) CHAR(1) INIT((9)'00'X),/* A-I                         */
*       3 *(7) CHAR(1) INIT((7)'04'X),/* ERROR CHARS                 */
*       3 *(9) CHAR(1) INIT((9)'00'X),/* J-R                         */
*       3 *(8) CHAR(1) INIT((8)'04'X),/* ERROR CHARS                 */
*       3 *(8) CHAR(1) INIT((8)'00'X),/* S-Z                         */
*       3 *(6) CHAR(1) INIT((6)'04'X),/* ERROR CHARS                 */
*       3 *(10) CHAR(1) INIT((10)'00'X),/* NUMERICS                  */
*       3 *(6) CHAR(1) INIT((6)'04'X);/* ERROR CHARS           Y02754*/
*NP3LCAT:                                                          0859
*   NP3RTADR=REXIT;                 /* SAVE CALLERS RETURN ADDRESS 0859
*                                                              Y02754*/
NP3LCAT  ST    REXIT,NP3RTADR                                      0859
*   R2SAVE=RNVT;                    /* SAVE THE NVT ADDRESS FOR NIP
*                                      SERVICES                Y02754*/
         ST    RNVT,R2SAVE                                         0860
*   ALLDONE=NONO;                   /* CONTROLLING FACTOR FOR THE DO
*                                      WHILE FOR SYNTAX        Y02754*/
         NI    ALLDONE,B'01111111'                                 0861
*   DO WHILE ALLDONE=NONO;          /* DO UNTIL THE SYNTAX IS CORRECT
*                                      FOR LNK PARAMETERS IN PARMTAB
*                                                              Y02754*/
         B     @DE00862                                            0862
@DL00862 DS    0H                                                  0863
*     RNVT=R2SAVE;                  /* USED IN DO WHILE GROUP  Y02754*/
         L     RNVT,R2SAVE                                         0863
*     RESPECIFY                                                    0864
*       PARMTAB BASED(NVTPTAB);     /*                         Y02754*/
*     PTRSAVE=LNK;                  /* SAVE PARMS PTR          Y02754*/
         L     @10,NVTPTAB(,RNVT)                                  0865
         L     @10,LNK(,@10)                                       0865
         ST    @10,PTRSAVE                                         0865
*     #PROCESD=ZERO;                /* ZERO OUT                Y02754*/
         SLR   @09,@09                                             0866
         STH   @09,#PROCESD                                        0866
*     #MEMBERS=ONE;                 /* USED FOR END FILE FOR #     0867
*                                      MEMBERS TO PROCESS      Y02754*/
         MVC   #MEMBERS(2),@CH00034                                0867
*     RESPECIFY                                                    0868
*       LNKPARMS BASED(LNK);        /*                         Y02754*/
*     IF LNK=ZERO THEN              /* TEST FOR DEFAULT USE    Y02754*/
         CR    @10,@09                                             0869
         BNE   @RF00869                                            0869
*       ALLDONE=YESS;               /* IF IT IS ZERO THEN GET OUT OF
*                                      DO WHILE                Y02754*/
         OI    ALLDONE,B'10000000'                                 0870
*     ELSE                          /* PROCESS THE LNK PARM    Y02754*/
*       IF LNKPARMS(1:1)=LPARAN THEN/* TEST FOR MULTI MEM BERS     0871
*                                      SPECIFIED               Y02754*/
         B     @RC00869                                            0871
@RF00869 L     @10,NVTPTAB(,RNVT)                                  0871
         L     @10,LNK(,@10)                                       0871
         CLI   LNKPARMS(@10),C'('                                  0871
         BNE   @RF00871                                            0871
*         DO;                       /* SO PROCESS THE PARM     Y02754*/
*           PTRSAVE=PTRSAVE+ONE;    /* POINT TO 1ST CHAR AFTER THE 0873
*                                      LEFT PARAN              Y02754*/
         LA    @10,1                                               0873
         AL    @10,PTRSAVE                                         0873
         ST    @10,PTRSAVE                                         0873
*           RESPECIFY                                              0874
*             LNKPARMS BASED(PTRSAVE);/*                       Y02754*/
*           DO WHILE RNVT=EIGHT;   /* SCAN THE PARMS FOR A RIGHT  0875
*                                      PARAN THEN STOP         Y02754*/
         B     @DE00875                                            0875
@DL00875 DS    0H                                                  0876
*             RNVT=ZERO;            /* SET TO 00               Y02754*/
         SLR   RNVT,RNVT                                           0876
*             TRT(LNKPARMS,TRTTAB); /* TRT THE PARMS FOR AN INVALID
*                                      CHAR OR RPARAN AND ,    Y02754*/
         L     @10,PTRSAVE                                         0877
         TRT   LNKPARMS(80,@10),TRTTAB                             0877
*             IF RNVT=FIVE THEN     /* TEST IF IT STOPED ON A COMMA
*                                                              Y02754*/
         CH    RNVT,@CH00170                                       0878
         BNE   @RF00878                                            0878
*               DO;                 /* IF SO IS THE COMMA IN THE   0879
*                                      PROPER PLACE            Y02754*/
*                 PTRSAVE=PTRSAVE+TWO;/* MOVE THE PTR TO WHERE THE 0880
*                                      COMMA SHOULD BE         Y02754*/
         LA    @10,2                                               0880
         AL    @10,PTRSAVE                                         0880
         ST    @10,PTRSAVE                                         0880
*                 IF RPARM=PTRSAVE THEN/* TEST FOR COMMA IN PROPER 0881
*                                      PLACE IN PARMS          Y02754*/
         CR    RPARM,@10                                           0881
         BNE   @RF00881                                            0881
*                   DO;                                            0882
*                     #MEMBERS=#MEMBERS+ONE;/* ADD 1 TO # OF MEM   0883
*                                                              Y02754*/
         LA    @09,1                                               0883
         LH    @15,#MEMBERS                                        0883
         ALR   @15,@09                                             0883
         STH   @15,#MEMBERS                                        0883
*                     PTRSAVE=PTRSAVE+ONE;/* POINT TO CHAR AFTER THE
*                                      COMMA AND GO BACK' TO TRT THE
*                                      REST OF PARMS           Y02754*/
         ALR   @10,@09                                             0884
         ST    @10,PTRSAVE                                         0884
*                   END;                                           0885
*                 ELSE              /* THE COMMA IS WRONG      Y02754*/
*                   DO;                                            0886
         B     @RC00881                                            0886
@RF00881 DS    0H                                                  0887
*                     RNVT=R2SAVE;  /* SET THE NVT PTR         Y02754*/
         L     RNVT,R2SAVE                                         0887
*                     RCVT=CVTPTR;  /* SET THE CVT PTR         Y02754*/
*                     RPARM=ADDR(BADLNK);/* PONIT R1 TO LNKBAD Y02754*/
         LA    RPARM,BADLNK                                        0889
*                     RENTRY=ADDR(IEAVNPA3);/* ADDR PRMPT      Y02754*/
         LA    RENTRY,IEAVNPA3                                     0890
*                     GEN( LCR   RPARM,RPARM );/* COMPLIMENT R1    0891
*                                                              Y02754*/
          LCR   RPARM,RPARM
*                     GEN( BALR  REXIT,RENTRY  ) FLOWS(IEAVNPA3);/*
*                                      GO TO PRMPT OPERATOR    Y02754*/
          BALR  REXIT,RENTRY  ) FLOWS(IEAVNPA3
*                     RNVT=EIGHT;   /* TO GET OUT OF DO WHILE NO   0893
*                                      RPARAN AND START OVE    Y02754*/
         LA    RNVT,8                                              0893
*                   END;            /*                         Y02754*/
*               END;                /*                         Y02754*/
*             ELSE                  /* TRT STOPED ON A CHAR OTHER  0896
*                                      THAN A COMMA            Y02754*/
*               IF RNVT=EIGHT THEN  /* SEE IF IT IS A RPARAN         */
         B     @RC00878                                            0896
@RF00878 CH    RNVT,@CH00156                                       0896
         BNE   @RF00896                                            0896
*                 DO;               /*                         Y02754*/
*                   PTRSAVE=PTRSAVE+TWO;/* SET PTR TO VALID DELIMETER
*                                                              Y02754*/
         LA    @10,2                                               0898
         AL    @10,PTRSAVE                                         0898
         ST    @10,PTRSAVE                                         0898
*                   IF RPARM=PTRSAVE THEN/* IS RPARAN IN PROPER PLACE
*                                      IN PARMS                Y02754*/
         CR    RPARM,@10                                           0899
         BNE   @RF00899                                            0899
*                     IF LNKPARMS(2:2)=QUOTE THEN/* A QUOTE SHOULD BE
*                                      AFTER THE RIGHT PARAN         */
         CLC   LNKPARMS+1(1,@10),QUOTE                             0900
         BNE   @RF00900                                            0900
*                       ALLDONE=YESS;/* IF SO THEN THE SYNTAX CHECK
*                                      IS ALL OK GETOUT        Y02754*/
         OI    ALLDONE,B'10000000'                                 0901
*                     ELSE          /* ERROR SO PROMPT OPER.         */
*                       DO;         /*                         Y02754*/
         B     @RC00900                                            0902
@RF00900 DS    0H                                                  0903
*                         RNVT=R2SAVE;/* SET THE NVT PT        Y02754*/
         L     RNVT,R2SAVE                                         0903
*                         RCVT=CVTPTR;/* SET THE CVT PTR       Y02754*/
*                         RPARM=ADDR(BADLNK);/* POINT R1 TO BADLNK 0905
*                                      FOR ERR MSG             Y02754*/
         LA    RPARM,BADLNK                                        0905
*                         RENTRY=ADDR(IEAVNPA3);/* ADDR PRMPT  Y02754*/
         LA    RENTRY,IEAVNPA3                                     0906
*                         GEN( LCR   RPARM,RPARM );/* COMPLIMENT R1
*                                                              Y02754*/
          LCR   RPARM,RPARM
*                         GEN( BALR  REXIT,RENTRY ) FLOWS(IEAVNPA3);
          BALR  REXIT,RENTRY ) FLOWS(IEAVNPA3
*                                   /* GO TO PRMPT OPERATOR    Y02754*/
*                         RNVT=EIGHT;/* TO GETOUT OF DOWHILE   Y02754*/
         LA    RNVT,8                                              0909
*                       END;        /*                         Y02754*/
*                   ELSE            /* THE RPARAN WAS OUT OF PLACE SO
*                                      IT IS                   Y02754*/
*                     DO;                                          0911
         B     @RC00899                                            0911
@RF00899 DS    0H                                                  0912
*                       RNVT=R2SAVE;/* SET THE NVT PTR         Y02754*/
         L     RNVT,R2SAVE                                         0912
*                       RCVT=CVTPTR;/* SET THE CVT PTR         Y02754*/
*                       RENTRY=ADDR(IEAVNPA3);/* ADDR PRMPT    Y02754*/
         LA    RENTRY,IEAVNPA3                                     0914
*                       RPARM=ADDR(BADLNK);/* POINT TO BADLNK  Y02754*/
         LA    RPARM,BADLNK                                        0915
*                       GEN( LCR   RPARM,RPARM );/* COMPLIMENT R1  0916
*                                                              Y02754*/
          LCR   RPARM,RPARM
*                       GEN( BALR  REXIT,RENTRY ) FLOWS(IEAVNPA3);/*
*                                      GO TO PRMPT OPERATOR    Y02754*/
          BALR  REXIT,RENTRY ) FLOWS(IEAVNPA3
*                       RNVT=EIGHT; /* TO GETOUT OF DOWHILE    Y02754*/
         LA    RNVT,8                                              0918
*                     END;          /*                         Y02754*/
*                 END;              /*                         Y02754*/
*               ELSE                /* TRT STOPPED ON AN INV ALID  0921
*                                      CHAR IN THE PARMS       Y02754*/
*                 DO;               /*                         Y02754*/
         B     @RC00896                                            0921
@RF00896 DS    0H                                                  0922
*                   RNVT=R2SAVE;    /* SET THE NVT PTR         Y02754*/
         L     RNVT,R2SAVE                                         0922
*                   RCVT=CVTPTR;    /* SET THE CVT PTR         Y02754*/
*                   RPARM=ADDR(BADLNK);/* POINT TO BADLNK      Y02754*/
         LA    RPARM,BADLNK                                        0924
*                   RENTRY=ADDR(IEAVNPA3);/* PTR PRMPT         Y02754*/
         LA    RENTRY,IEAVNPA3                                     0925
*                   GEN( LCR   RPARM,RPARM );/* COMPLIMENT R1  Y02754*/
          LCR   RPARM,RPARM
*                   GEN( BALR  REXIT,RENTRY  ) FLOWS(IEAVNPA3);/* GO
*                                      TO PRMPT OPERATOR       Y02754*/
          BALR  REXIT,RENTRY  ) FLOWS(IEAVNPA3
*                   RNVT=EIGHT;     /* TO GET OUT OF WHILE LOOP    0928
*                                                              Y02754*/
         LA    RNVT,8                                              0928
*                 END;              /*                         Y02754*/
*           END;                    /* WHILE=8                Y02754*/
@RC00896 DS    0H                                                  0930
@RC00878 DS    0H                                                  0930
@DE00875 CH    RNVT,@CH00156                                       0930
         BNE   @DL00875                                            0930
*         END;                      /* IF=RPARAN               Y02754*/
*       ELSE                        /* 1ST CHAR WAS NOT A LEFT PARAN
*                                      SO SYNTAX THIS PARM     Y02754*/
*         IF LNKPARMS(3:3)=QUOTE THEN/* IT IS A SINGLE MEM SPECIFIED
*                                      CHECK IT                Y02754*/
         B     @RC00871                                            0932
@RF00871 L     @10,PTRSAVE                                         0932
         CLC   LNKPARMS+2(1,@10),QUOTE                             0932
         BNE   @RF00932                                            0932
*           DO;                     /* FOR VALIDITY            Y02754*/
*             RNVT=ZERO;            /* SET TO 00               Y02754*/
         SLR   RNVT,RNVT                                           0934
*             TRT(LNKPARMS,TRTTAB); /* TRT FOR GOOD SYNTAX OF      0935
*                                      ALPHAMERIC CHARS        Y02754*/
         L     @10,PTRSAVE                                         0935
         TRT   LNKPARMS(80,@10),TRTTAB                             0935
*             IF RNVT=ONE THEN     /* IT SHOULD STOP ON A QUOTE IF
*                                      ALL OK                  Y02754*/
         CH    RNVT,@CH00034                                       0936
         BE    @RF00936                                            0936
*               DO;                 /* PROCESS IT              Y02754*/
*                 RNVT=R2SAVE;      /* SET NVT PTR             Y02754*/
         L     RNVT,R2SAVE                                         0938
*                 RCVT=CVTPTR;      /* SET THE CVT PTR         Y02754*/
*                 RPARM=ADDR(BADLNK);/* POINT TO BADLNK        Y02754*/
         LA    RPARM,BADLNK                                        0940
*                 RENTRY=ADDR(IEAVNPA3);/* PTR PRMPT           Y02754*/
         LA    RENTRY,IEAVNPA3                                     0941
*                 GEN( LCR   RPARM,RPARM );/* COMPLIMENT R1    Y02754*/
          LCR   RPARM,RPARM
*                 GEN( BALR  REXIT,RENTRY   ) FLOWS(IEAVNPA3);     0943
*                                                                  0943
          BALR  REXIT,RENTRY   ) FLOWS(IEAVNPA3
*                 /***************************************************/
*                 /*                                                 */
*                 /* GO TO PRMPT OPERATOR                      Y02754*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0944
*               END;                /*                         Y02754*/
*             ELSE                  /* ALL WAS OK              Y02754*/
*               ALLDONE=YESS;       /* TO GET OUT OF LOOP      Y02754*/
         B     @RC00936                                            0945
@RF00936 OI    ALLDONE,B'10000000'                                 0945
*           END;                    /* IF = QUOTE              Y02754*/
*         ELSE                      /* PARM IS INVALID         Y02754*/
*           DO;                     /* PRMPT OPERATOR          Y02754*/
         B     @RC00932                                            0947
@RF00932 DS    0H                                                  0948
*             RNVT=R2SAVE;          /* SET NVT PTR             Y02754*/
         L     RNVT,R2SAVE                                         0948
*             RCVT=CVTPTR;          /* SET CVT PTR             Y02754*/
*             RPARM=ADDR(BADLNK);   /* POINT TO BADLNK         Y02754*/
         LA    RPARM,BADLNK                                        0950
*             RENTRY=ADDR(IEAVNPA3);/* PTR PRMPT               Y02754*/
         LA    RENTRY,IEAVNPA3                                     0951
*             GEN( LCR   RPARM,RPARM );/* COMPLIMENT R1        Y02754*/
          LCR   RPARM,RPARM
*             GEN( BALR  REXIT,RENTRY   ) FLOWS(IEAVNPA3);/* GO TO 0953
*                                      PRMPT THE OPERATOR      Y02754*/
          BALR  REXIT,RENTRY   ) FLOWS(IEAVNPA3
*           END;                    /*                         Y02754*/
*   END;                            /* END OF ALLDONE DO WHILE Y02754*/
@RC00932 DS    0H                                                  0955
@RC00871 DS    0H                                                  0955
@RC00869 DS    0H                                                  0955
@DE00862 TM    ALLDONE,B'10000000'                                 0955
         BZ    @DL00862                                            0955
*   RESPECIFY                                                      0956
*     LNKPARMS BASED(LNK);          /* NEW BASE                Y02754*/
*   LNKMEM=LNKLST;                  /* BASIC MEMBER            Y02754*/
         MVC   LNKMEM(8),LNKLST                                    0957
*   RNVT=R2SAVE;                    /* RESTORE RNVT            Y02754*/
         L     RNVT,R2SAVE                                         0958
*   IF LNK=ZERO THEN               /* TEST FOR DEFAULT        Y02754*/
         L     @10,NVTPTAB(,RNVT)                                  0959
         L     @10,LNK(,@10)                                       0959
         LTR   @10,@10                                             0959
         BZ    @RF00959                                            0959
*     IF LNKPARMS(1:1)=LPARAN THEN  /* TEST FOR MULTI MEMBER       0960
*                                      SPECIFIED               Y02754*/
         CLI   LNKPARMS(@10),C'('                                  0960
         BNE   @RF00960                                            0960
*       DO;                         /* SET UP MEM NUM          Y02754*/
*         NUMBER(1:2)=LNKPARMS(2:3)|UPCASE;/* MOVE IN 1ST DIGIT OF 0962
*                                      NUM.                    Y02754*/
         MVC   NUMBER(2),LNKPARMS+1(@10)                           0962
         OC    NUMBER(2),@CC02547                                  0962
*         PTRSAVE=LNK+4;            /* POINT TO NEXT MEMBER NAME   0963
*                                      SPECIFIED               Y02754*/
         AL    @10,@CF00371                                        0963
         ST    @10,PTRSAVE                                         0963
*       END;                        /*                         Y02754*/
*     ELSE                          /* IT IS A SINGLE MEMBER   Y02754*/
*       NUMBER(1:2)=LNKPARMS(1:2)|UPCASE;/* MOVE IN 1ST + 2ND DIGIT
*                                      OF NUMBER               Y02754*/
         B     @RC00960                                            0965
@RF00960 L     @10,NVTPTAB(,RNVT)                                  0965
         L     @10,LNK(,@10)                                       0965
         MVC   NUMBER(2),LNKPARMS(@10)                             0965
         OC    NUMBER(2),@CC02547                                  0965
*   ELSE                                                           0966
*     ;                             /* NULL ELSE               Y02754*/
@RF00959 DS    0H                                                  0967
*   GEN( GETMAIN EC,LV=2048,A=GETAREA,SP=0 );/*                Y02754*/
@RC00959 DS    0H                                                  0967
          GETMAIN EC,LV=2048,A=GETAREA,SP=0
*   IF GETMRTCD=ZERO THEN          /* TEST GET OK             Y02754*/
         LTR   GETMRTCD,GETMRTCD                                   0968
         BNZ   @RT00968                                            0968
*     GO TO NP3SW38;                /* GO TO WAIT STATE        Y02754*/
*   GETPTR=GETAREA;                 /* SAVE GET PTR            Y02754*/
         MVC   GETPTR(4),GETAREA                                   0970
*   NIPPANAM=LNKMEM;                /* SET THE MEMBER NAME FOR FIND
*                                      AND READ                Y02754*/
         L     @10,NVTPAREA(,RNVT)                                 0971
         MVC   NIPPANAM(8,@10),LNKMEM                              0971
*   MESG12B=LNKMEM;                 /* PUT MEM NAME IN MESS. FOR   0972
*                                      TRUNC LNKLST            Y02754*/
         MVC   MESG12B(8),LNKMEM                                   0972
*   RNVT=R2SAVE;                    /* SET NVT PTR             Y02754*/
         L     RNVT,R2SAVE                                         0973
*NP3LCTXT:                                                         0974
*   CALL NIPPMMEM;                  /* CALL PSIO TO DO THE READ OF 0974
*                                      PARMLIB                 Y02754*/
NP3LCTXT BAL   @14,NIPPMMEM                                        0974
*   IF RPRM1<ZERO THEN              /* THE I/O RTN SENDS A RETUTN  0975
*                                      ADDR IN REG1 IF POSITIVE ALLIS
*                                      OK                      Y02754*/
         LTR   RPRM1,RPRM1                                         0975
         BM    @RT00975                                            0975
*     GO TO NP3ENDFL;               /* HERE ON AN ERROR OR FOR END 0976
*                                      FILE SO FIND OUT        Y02754*/
*   ELSE                            /* A RECORD HAS BEEN READ        */
*     GO TO SCANRCD;                /* PROCESS IT              Y02754*/
         B     SCANRCD                                             0977
*NP3ENDFL:                                                         0978
*   #PROCESD=#PROCESD+ONE;          /* ADD ONE TO NUM          Y02754*/
NP3ENDFL LA    @10,1                                               0978
         AH    @10,#PROCESD                                        0978
         STH   @10,#PROCESD                                        0978
*   RESPECIFY                                                      0979
*     PARMTAB BASED(NP3CTAB);       /*                         Y02754*/
*   IF NIPPARC=SIXTEEN THEN        /* 16 IS END FILE          Y02754*/
         L     @09,NVTPAREA(,RNVT)                                 0980
         CLC   NIPPARC(4,@09),@CF00173                             0980
         BNE   @RT00980                                            0980
*     GO TO NP3LCTFL;               /* IF 16 IT SIS AN ERROR  Y02754*/
*   ELSE                            /* IT WAS END FILE SO PROCESS THE
*                                      NUMBER OF MEMS          Y02754*/
*     IF #MEMBERS=#PROCESD THEN    /* TEST TO SEE IF ALL MEM- BERS
*                                      HAVE BEEN PROCESSED     Y02754*/
         CH    @10,#MEMBERS                                        0982
         BE    @RF00982                                            0982
*       DO;                         /* PROCESS ANOTHER MEMBER FOR  0983
*                                      LNKLST                  Y02754*/
*         RFY                                                      0984
*           LNKPARMS BASED(PTRSAVE);/*                         Y02754*/
*         LNKMEM=LNKLST;            /* BASIC MEM NAME          Y02754*/
         MVC   LNKMEM(8),LNKLST                                    0985
*         NUMBER(1:2)=LNKPARMS(1:2)|UPCASE;/* SET 1ST + 2ND DIGIT OF
*                                      THE NUM                 Y02754*/
         L     @10,PTRSAVE                                         0986
         MVC   NUMBER(2),LNKPARMS(@10)                             0986
         OC    NUMBER(2),@CC02547                                  0986
*         PTRSAVE=PTRSAVE+3;        /* POINT TO NEXT           Y02754*/
         AH    @10,@CH00261                                        0987
         ST    @10,PTRSAVE                                         0987
*         MESG12B=LNKMEM;           /* SET FOR ERROR MESSAGE FOR   0988
*                                      PROPER MEM NAME USED    Y02754*/
         MVC   MESG12B(8),LNKMEM                                   0988
*         NIPPANAM=LNKMEM;          /* SET NEXT MEMBER NAME FOR THE
*                                      I/O RTN                 Y02754*/
         MVC   NIPPANAM(8,@09),LNKMEM                              0989
*         GO TO NP3LCTXT;           /* GO READ IT              Y02754*/
         B     NP3LCTXT                                            0990
*       END;                        /*                         Y02754*/
*     ELSE                          /* ALL FINISHED READING SO DO THE
*                                      CONCAT                  Y02754*/
*       GO TO NP3LCNND;             /* RTN TO CONCAT.          Y02754*/
*   RESPECIFY                                                      0993
*     INDEXREG RESTRICTED;                                         0993
*   RESPECIFY                                                      0994
*     DSNCTR RESTRICTED;                                           0994
*   RESPECIFY                                                      0995
*     NP3SCAN5 BASED(SCANREG);                                     0995
*SCANRCD:                                                          0996
*   SCANREG=RPARM;                  /* SAVE ADDR OF TEXT RECORD      */
SCANRCD  LR    SCANREG,RPARM                                       0996
*NP3LCDSN:                                                         0997
*   DSNCTR=0;                       /* ZERO DATASET NAME COUNTER     */
NP3LCDSN SLR   DSNCTR,DSNCTR                                       0997
*   INDEXREG=SCANREG;               /* SAVE START ADDR OF NAME       */
*                                                                  0998
         LR    INDEXREG,SCANREG                                    0998
*   /*****************************************************************/
*   /*                                                               */
*   /* IS THIS CARACTER A ',' OR A BLANK                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0999
*NP3LCNCR:                                                         0999
*   IF NP3SCANR=','|NP3SCANR=' ' THEN                              0999
NP3LCNCR CLI   NP3SCANR(SCANREG),C','                              0999
         BE    @RT00999                                            0999
         CLI   NP3SCANR(SCANREG),C' '                              0999
         BE    @RT00999                                            0999
*     GO TO NP3LCNAM;               /* YES - GO MOVE NAME            */
*   IF DSNCTR=44                    /* IS NUMBER OF DSN CHAR=44      */
*     THEN                                                         1001
         CH    DSNCTR,@CH02133                                     1001
         BE    @RT01001                                            1001
*     GO TO NP3LCNAM;               /* GO MOVE NAME TO WORKAREA      */
*   DSNCTR=DSNCTR+1;                /* INCREMENT CHAR CTR            */
         LA    @10,1                                               1003
         ALR   DSNCTR,@10                                          1003
*   SCANREG=SCANREG+1;              /* INCREMENT CHAR PTR            */
         ALR   SCANREG,@10                                         1004
*   GO TO NP3LCNCR;                 /* GO CHECK NEXT CHAR            */
         B     NP3LCNCR                                            1005
*NP3LCNAM:                                                         1006
*   IF DSNCTR=0                     /* ARE THERE NO CHARS IN THE   1006
*                                      RECORD                        */
*     THEN                                                         1006
NP3LCNAM LTR   DSNCTR,DSNCTR                                       1006
         BZ    @RT01006                                            1006
*     GO TO NP3LCNXT;               /* NO - THERE IS NO CONCATENATION*/
*   IF NP3SCANC=LINKLIB&            /* IS DATASET NAME SYS1.LINKLIB
*                                                             YM04365*/
*       (LNKAREA(13:13)=' '|        /* BLANK TEST             YM04365*/
*       LNKAREA(13:13)=',')         /* COMMA TEST             YM04365*/
*     THEN                                                         1008
         CLC   NP3SCANC(12,INDEXREG),LINKLIB                       1008
         BNE   @RF01008                                            1008
         CLI   LNKAREA+12(INDEXREG),C' '                           1008
         BE    @RT01008                                            1008
         CLI   LNKAREA+12(INDEXREG),C','                           1008
         BE    @RT01008                                            1008
*     GO TO NP3LCNXT;               /* YES - DO NOT MOVE TO NEXT   1009
*                                      WORKAREA. CHECK NEXT NAME     */
*   DSNAME=LNKAREA;                 /* MOVE DSN TO NEXT SLOT IN    1010
*                                      WORKAREA                      */
@RF01008 L     @10,GETPTR                                          1010
         MVC   DSNAME(44,@10),LNKAREA(INDEXREG)                    1010
*   LNKFLAG=LNKFLAG&&LNKFLAG;       /* ZERO FLAG BYTE                */
         XC    LNKFLAG(1,@10),LNKFLAG(@10)                         1011
*   LNKVOLID=LNKVOLID&&LNKVOLID;    /* ZERO VOLUME ID                */
         XC    LNKVOLID(6,@10),LNKVOLID(@10)                       1012
*   GETPTR=GETPTR+DSNCTR+1;         /* POINT TO END OF NAME          */
         ALR   @10,DSNCTR                                          1013
         AH    @10,@CH00034                                        1013
         ST    @10,GETPTR                                          1013
*   DSNCTR=44-DSNCTR;               /* GET NUMBER OF CHARACTERS TO BE
*                                      PADDED WITH BLANKS            */
         LA    @10,44                                              1014
         SLR   @10,DSNCTR                                          1014
         LR    DSNCTR,@10                                          1014
*NP3IFPAD:                                                         1015
*   IF DSNCTR=0                    /* ARE THERE ANY OF THE 44 CHARS
*                                      THAT NEED PADDING WITH BLANKS */
*     THEN                          /* YES - PAD REMAINING BYTES WITH
*                                      BLANKS                        */
NP3IFPAD LTR   DSNCTR,DSNCTR                                       1015
         BZ    @RF01015                                            1015
*     DO;                                                          1016
*       RESPECIFY                                                  1017
*         NP3SCAN5 BASED(GETPTR);                                  1017
*       NP3SCANR=' ';               /* BLANK BYTE                    */
         L     @10,GETPTR                                          1018
         MVI   NP3SCANR(@10),C' '                                  1018
*       GETPTR=GETPTR+1;            /* POINT TO NEXT BYTE            */
         AH    @10,@CH00034                                        1019
         ST    @10,GETPTR                                          1019
*       DSNCTR=DSNCTR-1;            /* DECREMENT COUNTER             */
         BCTR  DSNCTR,0                                            1020
*       GO TO NP3IFPAD;                                            1021
         B     NP3IFPAD                                            1021
*     END;                                                         1022
*   GETPTR=GETPTR+6;                /* UPDATE PTR TO NEXT WORKAREA 1023
*                                      ENTRY                         */
@RF01015 LA    @10,6                                               1023
         AL    @10,GETPTR                                          1023
         ST    @10,GETPTR                                          1023
*   IF GETAREA+2048-GETPTR<LENGTH(LNKNAME)/* IS THERE ENOUGH SPACE 1024
*                                      FOR ADDITION                  */
*     THEN                                                         1024
         LA    @09,2048                                            1024
         AL    @09,GETAREA                                         1024
         SLR   @09,@10                                             1024
         CH    @09,@CH02625                                        1024
         BL    @RT01024                                            1024
*     GO TO NP3LCTRN;               /* NO - TRUNCATE                 */
*   RESPECIFY                                                      1026
*     NP3SCAN5 BASED(SCANREG);                                     1026
*NP3LCNXT:                                                         1027
*   IF NP3SCANR=','                /* IS CHAR A ','                 */
*     THEN                          /* NO - GO LIMIT NUMBER OF     1027
*                                      ENTRIES TO 15 1ST CHECK IF ALL
*                                      MEMBERS HAVE BEEN PROCESSED 1027
*                                      FOR I/O READ AT EOFF          */
NP3LCNXT CLI   NP3SCANR(SCANREG),C','                              1027
         BE    @RF01027                                            1027
*     DO;                           /*                         Y02754*/
*       NIPPARC=SIXTEEN;            /* SO INDICATE EOF HAS OCCURED 1029
*                                                              Y02754*/
         L     @10,NVTPAREA(,RNVT)                                 1029
         MVC   NIPPARC(4,@10),@CF00173                             1029
*       GO TO NP3ENDFL;             /* GO TEST EOF             Y02754*/
         B     NP3ENDFL                                            1030
*     END;                          /*                         Y02754*/
*   SCANREG=SCANREG+1;              /* POINT TO NEXT CHAR            */
@RF01027 LA    SCANREG,1(,SCANREG)                                 1032
*   IF NP3SCANR=' '                 /* IS CHAR A BLANK               */
*     THEN                                                         1033
         CLI   NP3SCANR(SCANREG),C' '                              1033
         BE    @RT01033                                            1033
*     GO TO NP3LCTXT;               /* YES - END OF RECORD. GO READ
*                                      ANOTHER                       */
*   GO TO NP3LCDSN;                 /* NOT A BLANK - GO ANALYZE NEXT
*                                      NAME                          */
         B     NP3LCDSN                                            1035
*NP3LCTRN:                                                         1036
*   GETPTR=GETPTR-51;               /* POINT TO BEGINNING OF LAST  1036
*                                      NAME                          */
NP3LCTRN L     @10,GETPTR                                          1036
         SH    @10,@CH02625                                        1036
         ST    @10,GETPTR                                          1036
*   RESPECIFY                                                      1037
*     DSN BASED(MSG12APT);                                         1037
*   DSN=DSNAME;                     /* FILL IN DSN IN MSG            */
*                                                                  1038
         L     @09,MSG12APT                                        1038
         MVC   DSN(44,@09),DSNAME(@10)                             1038
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO LNKLST TRUNCATED AT DSN MSG                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1039
*   GENERATE REFS(NVTWTO);                                         1039
          IEAPMNIP TYPE=WTO,PARAM=MESG12 CALL WTO SERVICE ROUTINE
*   GETPTR=GETPTR+51;               /* POINT TO END OF LAST ENTRY    */
         LA    @10,51                                              1040
         AL    @10,GETPTR                                          1040
         ST    @10,GETPTR                                          1040
*NP3LCNND:                                                         1041
*   SCANREG=GETAREA;                /* RESET SCAN PTR TO FIRST     1041
*                                      WORKAREA ENTRY                */
NP3LCNND L     SCANREG,GETAREA                                     1041
*   IF SCANREG=GETPTR               /* IF ENTRY PTR = FIRST WORKAREA
*                                      ENTRY, THEN THERE IS NO     1042
*                                      CONCATENATION                 */
*     THEN                                                         1042
         C     SCANREG,GETPTR                                      1042
         BE    @RT01042                                            1042
*     GO TO NP3LCEND;               /* THE WORKAREA CAN BE FREED     */
*                                                                  1043
*   /*****************************************************************/
*   /*                                                               */
*   /* LIMIT THE ACTIVE CONCATENATED DATASETS TO 15                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1044
*   DSNCTR=0;                       /* INITIALIZE DSN CTR TO 0       */
         SLR   DSNCTR,DSNCTR                                       1044
*   RESPECIFY                                                      1045
*     LNKAREA BASED(LCNAMPTR);                                     1045
*   RESPECIFY                                                      1046
*     LNKNAME BASED(SCANREG);                                      1046
*NP3LCLOC:                                                         1047
*   LNKAREA=DSNAME;                 /* SET DSNAME FOR LOCATE REQ     */
*                                                                  1047
NP3LCLOC L     @10,LCNAMPTR                                        1047
         MVC   LNKAREA(44,@10),DSNAME(SCANREG)                     1047
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE LOCATE AND FIND VOLID FOR DSNAME                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*   GENERATE;                                                      1048
          LOCATE LOCLIB  ISSUE LOCATE FOR DATASET
*   IF LOCREG=0                    /* IS RETURN CODE ZERO           */
*     THEN                          /* NO - INDICATE LOCATE WAS NOT
*                                      SUCCESFUL                     */
         LTR   LOCREG,LOCREG                                       1049
         BZ    @RF01049                                            1049
*     DO;                                                          1050
*       LNKFLAG='FF'X;              /* SET FLAG IN CURRENT WORK AREA
*                                      ENTRY TO ZERO                 */
         MVI   LNKFLAG(SCANREG),X'FF'                              1051
*       GO TO NP3LCLXT;             /* GO DO NEXT ENTRY              */
         B     NP3LCLXT                                            1052
*     END;                                                         1053
*   ELSE                            /* LOCATE WAS SUCCESSFUL         */
*     DO;                                                          1054
@RF01049 DS    0H                                                  1055
*       LNKVOLID=NP3VOLSR;          /* MOVE VOLID TO CURRENT WORKAREA
*                                      ENTRY                         */
         MVC   LNKVOLID(6,SCANREG),NP3VOLSR                        1055
*     END;                                                         1056
*NP3LCLXT:                                                         1057
*   SCANREG=SCANREG+LENGTH(LNKNAME);/* UPDATE SCAN PTR TO NEXT ENTRY */
NP3LCLXT LA    SCANREG,51(,SCANREG)                                1057
*   IF SCANREG=GETPTR              /* HAVE ALL ENTRIES BEEN LOC     */
*     THEN                                                         1058
         C     SCANREG,GETPTR                                      1058
         BNE   @RT01058                                            1058
*     GO TO NP3LCLOC;               /* NO - LOCATE NEXT ENTRY        */
*   SCANREG=GETAREA;                /* RESET SCAN PTR TO FIRST     1060
*                                      WORKAREA ENTRY                */
         L     SCANREG,GETAREA                                     1060
*NP3LCVL1:                                                         1061
*   IF LNKFLAG='FF'X                /* WAS THIS ENTRY LOCATED        */
*     THEN                                                         1061
NP3LCVL1 CLI   LNKFLAG(SCANREG),X'FF'                              1061
         BE    @RT01061                                            1061
*     GO TO NP3LCVXT;               /* NO - TRY NEXT WORKAREA ENTRY  */
*   IF DSNCTR=15                    /* HAVE 15 ENTRIES BEEN PROCESSED*/
*     THEN                                                         1063
         CH    DSNCTR,@CH00210                                     1063
         BE    @RT01063                                            1063
*     GO TO NP3LCVFL;               /* YES - NULL FOLLOWING ENTRIES  */
*                                                                  1064
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETERS FOR MOUNT REQUEST                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1065
*   RESPECIFY                                                      1065
*     NIPMNTPL BASED(NP3LST06);                                    1065
*NP3LCVOL:                                                         1066
*   NMNTVS=LNKVOLID;                /* FILL IN VOLID                 */
NP3LCVOL L     @10,NP3LST06                                        1066
         MVC   NMNTVS(6,@10),LNKVOLID(SCANREG)                     1066
*   NMNTDSA=SCANREG+1;              /* FILL IN DATA SET NAME PTR     */
*                                                                  1067
         LA    @09,1                                               1067
         ALR   @09,SCANREG                                         1067
         ST    @09,NMNTDSA(,@10)                                   1067
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO BRANCH TO NIPMOUNT (CONDITIONAL)              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1068
*   GENERATE REFS(NVTMOUNT) SETS(RPARM,REXIT,RENTRY);              1068
          IEAPMNIP TYPE=MOUNT,PARAM=PLIST06,OPT=(,LC,LI)
*   UCBPTR=RPARM;                   /* SET UCB BASE TO CURRENT UCB   */
         ST    RPARM,UCBPTR                                        1069
*   IF UCBPTR=0                     /* WAS REQUEST CANCELLED         */
*     THEN                                                         1070
         L     @10,UCBPTR                                          1070
         LTR   @10,@10                                             1070
         BZ    @RT01070                                            1070
*     GO TO NP3LCCAN;               /* YES - SCAN REMAINDER OF     1071
*                                      ENTRIES FOR THIS VOLID        */
*                                                                  1071
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETERS FOR OPEN REQUEST                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1072
*   RESPECIFY                                                      1072
*     NIPOPNPL BASED(NP3LST07);                                    1072
*   NOPNDCB=CVTLINK;                /* GET ADDR OF DCB FROM CVT      */
         L     @09,NP3LST07                                        1073
         MVC   NOPNDCB(4,@09),CVTLINK(CVTPTR)                      1073
*   NOPNDSA=SCANREG+1;              /* FILL IN DATASET NAME PTR      */
         LA    @07,1                                               1074
         ALR   @07,SCANREG                                         1074
         ST    @07,NOPNDSA(,@09)                                   1074
*   NOPNUCB=UCBPTR;                 /* FILL IN UCB ADDR              */
*                                                                  1075
         ST    @10,NOPNUCB(,@09)                                   1075
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO BRANCH TO NIPOPEN (CONDITIONAL)               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1076
*   GENERATE REFS(NVTOPEN) SETS(RPARM,REXIT,RENTRY,NOPNFL);        1076
        IEAPMNIP TYPE=OPEN,PARAM=PLIST07,OPT=(,LB,LC,,,LI,,RS) @ZA01561
*   IF RPRM1<0                      /* DID OPEN FAIL                 */
*     THEN                          /* YES - SET NULL FLAG IN CURRENT
*                                      ENTRY TO X'FF'                */
         LTR   RPRM1,RPRM1                                         1077
         BNM   @RF01077                                            1077
*     DO;                                                          1078
*NP3LCVFL:                                                         1079
*       LNKFLAG='FF'X;                                             1079
NP3LCVFL MVI   LNKFLAG(SCANREG),X'FF'                              1079
*       GO TO NP3LCVXT;             /* TRY NEXT ENTRY                */
         B     NP3LCVXT                                            1080
*     END;                                                         1081
*   DSNCTR=DSNCTR+1;                /* INCREMENT ENTRY COUNTER       */
@RF01077 LA    @10,1                                               1082
         ALR   DSNCTR,@10                                          1082
*   UCBUSER=UCBUSER+1;              /* INCREMENT USE COUNT   @ZA02591*/
         L     @09,UCBPTR                                          1083
         SLR   @07,@07                                             1083
         IC    @07,UCBUSER(,@09)                                   1083
         ALR   @10,@07                                             1083
         STC   @10,UCBUSER(,@09)                                   1083
*   GO TO NP3LCVXT;                 /* TRY NEXT ENTRY                */
*                                                                  1084
         B     NP3LCVXT                                            1084
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN REMAINING ENTRIES FOR THE NON-LOCATABLE VOLID AND NULL   */
*   /* (X'FF') THE ONES FOUND                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1085
*NP3LCCAN:                                                         1085
*   SAVESCAN=SCANREG;               /* SAVE CURRENT ENTRY ADDR       */
NP3LCCAN ST    SCANREG,SAVESCAN                                    1085
*NP3IFLOC:                                                         1086
*   IF LNKVOLID=NMNTVS              /* DOES THIS ENTRY HAVE        1086
*                                      NON-LOCATABLE VOLID           */
*     THEN                                                         1086
NP3IFLOC L     @10,NP3LST06                                        1086
         CLC   LNKVOLID(6,SCANREG),NMNTVS(@10)                     1086
         BNE   @RF01086                                            1086
*     LNKFLAG='FF'X;                /* YES - NULL ENTRY              */
         MVI   LNKFLAG(SCANREG),X'FF'                              1087
*   SCANREG=SCANREG+LENGTH(LNKNAME);/* POINT TO NEXT ENTR            */
@RF01086 LA    SCANREG,51(,SCANREG)                                1088
*   IF SCANREG=GETPTR               /* IS THIS THE END OF THE ENTRIES*/
*     THEN                          /* YES - GO BACK TO NEXT ENTRY TO
*                                      BE LOCATED                    */
         C     SCANREG,GETPTR                                      1089
         BNE   @RF01089                                            1089
*     DO;                                                          1090
*       SCANREG=SAVESCAN;           /* RESET SCAN PTR TO LAST LOCATED
*                                      ENTRY                         */
         L     SCANREG,SAVESCAN                                    1091
*       GO TO NP3LCVXT;                                            1092
         B     NP3LCVXT                                            1092
*     END;                                                         1093
*   GO TO NP3IFLOC;                 /* CHECK VOLID OF NEXT ENTRY     */
         B     NP3IFLOC                                            1094
*NP3LCVXT:                                                         1095
*   SCANREG=SCANREG+LENGTH(LNKNAME);/* POINT TO NEXT ENTRY           */
NP3LCVXT LA    SCANREG,51(,SCANREG)                                1095
*   IF SCANREG=GETPTR              /* ARE THERE ANY MORE ENTRIES    */
*     THEN                                                         1096
         C     SCANREG,GETPTR                                      1096
         BNE   @RT01096                                            1096
*     GO TO NP3LCVL1;               /* YES - PROCESS REST            */
*NP3LCVND:                                                         1098
*   SCANREG=GETAREA;                /* RESET SCAN PTR TO BEGINNING OF
*                                      WORKAREA                      */
NP3LCVND L     SCANREG,GETAREA                                     1098
*NP3LCMCK:                                                         1099
*   IF LNKFLAG='FF'X               /* IS THIS ENTRY NULL            */
*     THEN                                                         1099
NP3LCMCK CLI   LNKFLAG(SCANREG),X'FF'                              1099
         BNE   @RT01099                                            1099
*     GO TO NP3LCMXT;               /* NO - CHECK NEXT ENTRY         */
*   IF NP3HDMSG='1'B                /* HAS HEADER BEEN ISSUED        */
*     THEN                                                         1101
         TM    NP3HDMSG,B'10000000'                                1101
         BO    @RT01101                                            1101
*     GO TO NP3LCMNH;               /* YES - DO NOT PRINT HEADER     */
*                                                                  1102
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO HEADER MESSAGE THAT FOLLOWING LINKLIB DATASETS WERE NOT   */
*   /* FOUND                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1103
*   GENERATE REFS(NVTWTO);                                         1103
          IEAPMNIP TYPE=WTO,PARAM=MESG13 ISSUE WTO SERVICE ROUTINE
*   NP3HDMSG='1'B;                  /* INDICATE HEADER MESSAGE HAS 1104
*                                      BEEN ISSUED                   */
         OI    NP3HDMSG,B'10000000'                                1104
*   RESPECIFY                                                      1105
*     DSN BASED(MSG14APT);                                         1105
*NP3LCMNH:                                                         1106
*   DSN=DSNAME;                     /* FILL IN DATASET NAME          */
*                                                                  1106
NP3LCMNH L     @10,MSG14APT                                        1106
         MVC   DSN(44,@10),DSNAME(SCANREG)                         1106
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST MISSING DATA SET NAME                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1107
*   GENERATE REFS(NVTWTO);                                         1107
          IEAPMNIP TYPE=WTO,PARAM=MESG14 ISSUE WTO SERVICE ROUTINE
*NP3LCMXT:                                                         1108
*   SCANREG=SCANREG+LENGTH(LNKNAME);/* POINT TO NEXT ENTRY           */
NP3LCMXT LA    SCANREG,51(,SCANREG)                                1108
*   IF SCANREG=GETPTR              /* ARE THERE MORE ENTRIES        */
*     THEN                                                         1109
         C     SCANREG,GETPTR                                      1109
         BNE   @RT01109                                            1109
*     GO TO NP3LCMCK;               /* YES - PRINT THEM OUT          */
*                                                                  1110
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE 2K LNKLST WORKAREA FROM SP0                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1111
*   GENERATE DEFS(NP3LCEND);                                       1111
NP3LCEND  FREEMAIN E,LV=2048,A=GETAREA
*   GO TO NP3LCXIT;                 /* RETURN TO CALLER              */
*                                                                  1112
         B     NP3LCXIT                                            1112
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE 2K LNKLST TEXT WORKAREA FROM SUBPOOL 0                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1113
*   GENERATE DEFS(NP3LCTFL);                                       1113
*                                                                  1113
NP3LCTFL  FREEMAIN E,LV=2048,A=GETAREA
*   /*****************************************************************/
*   /*                                                               */
*   /* TELL THE OPERATOR THE LNKLST FUNCTION IS INOPERATIVE          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1114
*NP3LCMFL:                                                         1114
*   LKNAME=LNKLSTNM;                /* FILL IN 'LNKLST00' NAME       */
NP3LCMFL MVC   LKNAME(6),LNKLSTNM                                  1114
*   GENERATE REFS(NVTWTO);                                         1115
         IEAPMNIP TYPE=WTO,PARAM=MESG11 ISSUE WTO SERVICE ROUTINE
*NP3LCXIT:                                                         1116
*   GO TO NP3RTAD0;                 /* RETURN TO CALLER              */
*                                                                  1116
NP3LCXIT L     @10,NP3RTADR                                        1116
         BR    @10                                                 1116
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO GETMAIN FAILED DURING INITIALIZATION                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1117
*   GENERATE REFS(NVTWTO) DEFS(NP3SW38);                           1117
NP3SW38  DS    0F
         IEAPMNIP TYPE=WTO,PARAM=MESG05 CALL WTO SERVICE ROUTINE
*   NVTFLWSC=NVTWCN01;              /* SET WAIT STATE CODE IN NVT /*
*                                                              Y02752*/
*                                                                  1118
         MVI   NVTFLWSC(RNVT),X'63'                                1118
*   /*****************************************************************/
*   /*                                                               */
*   /* MACRO BRANCH INTERFACE TO NIPSWAIT SERVICE ROUTINE IN IEAVNIPM*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1119
*   GENERATE REFS(NVTSWAIT);                                       1119
          IEAPMNIP TYPE=SWAIT   CALL WAIT SERVICE ROUTINE
*   RESPECIFY                                                      1120
*     INDEXREG UNRESTRICTED;                                       1120
*   RESPECIFY                                                      1121
*     DSNCTR UNRESTRICTED;                                         1121
*                                                                  1122
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE (NP3SCAN) SCANS THE SYSTEM PARAMETERS FOR     */
*   /* VALIDITY. AFTER VERIFYING ONE LINE OF PARAMETERS,IT BRANCHES  */
*   /* BACK TO ITS CALLER AT: +0 FOR VALID PARAMETER AND SUBPARAMETER*/
*   /* OF PARAMETER +4 FOR INVALID PARAMETER OR SUBPARAMETER OF      */
*   /* PARAMETER +8 FOR CONTINUATION OF PARAMETERS OR SUBPARAMETERS  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1122
*   RESPECIFY                                                      1122
*     SYMBLREG RESTRICTED;          /* BASE ADDRESS OF SYMBOL TABLE
*                                      FOR MAPPING                   */
*   RESPECIFY                                                      1123
*     OFFSTREG RESTRICTED;          /* CONTAINS OFFSET INTO SYMBOL 1123
*                                      TABLE FOR PARAMETER VALIDATION*/
*   RESPECIFY                                                      1124
*     NP3SCAN5 BASED(SCANREG);                                     1124
*   RESPECIFY                                                      1125
*     OPLIBENT BASED(NP3CENT);                                     1125
*NP3SCAN:                                                          1126
*   NP3RTRN=REXIT;                  /* SAVE RETURN ADDRESS OF CALLER */
NP3SCAN  ST    REXIT,NP3RTRN                                       1126
*NP3SCNXT:                                                         1127
*   SCANREG=NP3NCHAR;               /* SET BASE ADDRESS FOR MAPPING
*                                      INTO PARAMETER CHARACTER    1127
*                                                              STRING*/
*                                                                  1127
NP3SCNXT L     SCANREG,NP3NCHAR                                    1127
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO IF CURRENT CHARACTER IS BLANK OR COMMA. IF YES       */
*   /* ,UPDATE TO NEXT CHARACTER IN PARAMETER STRING AND REPEAT      */
*   /* CHARACTER CHECK.                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1128
*NP3PCHAR:                                                         1128
*   IF NP3SCANR=NP3BLANK            /* IS THIS A BLANK CHARACTER OR  */
*       |NP3SCANR=NP3COMMA          /* A COMMA CHARACTER             */
*     THEN                          /* YES,IT IS A BLANK OR A COMMA  */
NP3PCHAR CLC   NP3SCANR(1,SCANREG),NP3BLANK                        1128
         BE    @RT01128                                            1128
         CLC   NP3SCANR(1,SCANREG),NP3COMMA                        1128
         BNE   @RF01128                                            1128
@RT01128 DS    0H                                                  1129
*     DO;                                                          1129
*       SCANREG=1+SCANREG;          /* UPDATE TO NEXT CHARACTER      */
         LA    SCANREG,1(,SCANREG)                                 1130
*       GO TO NP3PCHAR;             /* GO BACK TO CHARACTER CHECK    */
         B     NP3PCHAR                                            1131
*     END;                                                         1132
*   ELSE                                                           1133
*     ;                             /* NO, IT IS NOT A BLANK OR A  1133
*                                      COMMA,FALL THROUGH            */
*                                                                  1133
@RF01128 DS    0H                                                  1134
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF CONTINUE SUBPARAMETER SWITCH IS ON.IF YES,THEN*/
*   /* BRANCH TO SETUP FOR CONTINUATION OF SUBPARAMETERS FROM        */
*   /* PREVIOUS LINE OF SYSTEM PARAMETERS                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1134
*   IF NP3CONT='1'B                 /* IS CONTINUE PARAMETER FLAG ON */
*     THEN                          /* YES,IT IS ON                  */
         TM    NP3CONT,B'10000000'                                 1134
         BO    @RT01134                                            1134
*     GO TO NP3CHNDL;               /* BRANCH TO CONTINUE          1135
*                                      SUBPARAMETER BALANCING CHECK
*                                      SETUP                         */
*   ELSE                            /* NO,CONTINUE PARAMETER FLAG NOT
*                                      ON                            */
*     DO;                                                          1136
*       NP3CCHAR=SCANREG;           /* SET CURRENT CHARACTER POINTER
*                                      TO ADDRESS OF SCANNED       1137
*                                      CHARACTER                     */
         ST    SCANREG,NP3CCHAR                                    1137
*     END;                                                         1138
*                                                                  1138
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR END OF CURRENT LINE OF PARAMETER CHARACTER          */
*   /* STRING.LOOKS FOR A QUOTE.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1139
*   IF NP3SCANR=NP3QUOTE            /* IS THIS END OF LINE           */
*     THEN                          /* YES,IT IS END OF LINE         */
         CLC   NP3SCANR(1,SCANREG),NP3QUOTE                        1139
         BNE   @RF01139                                            1139
*     DO;                                                          1140
*       IF OPSPCONT='00000000000000000000000000000000'X/* IS 'CONT'
*                                      SPECIFIED                     */
*         THEN                      /* YES- RESET 'CONT' PARM ENTRY
*                                      TO ZERO                       */
         L     @10,NP3CTAB                                         1141
         CLC   OPSPCONT(16,@10),@CB02424                           1141
         BE    @RF01141                                            1141
*         DO;                                                      1142
*NP3SCCNT:                                                         1143
*           OPSPCONT=OPSPCONT&&OPSPCONT;/*                     Y02752*/
*                                                                  1143
NP3SCCNT L     @10,NP3CTAB                                         1143
         XC    OPSPCONT(16,@10),OPSPCONT(@10)                      1143
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO IEAVNPA3 CALL SEQUENCE IF IN NIP PROMPT MODE*/
*           /*                                                 Y02752*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1144
*           IF NVTSYSP='1'B         /*                         Y02752*/
*             THEN                  /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           1144
         BNO   @RF01144                                            1144
*             DO;                   /*                         Y02752*/
*               RETCODE=8;          /* CONTINUATION FOUND      Y02752*/
         MVC   RETCODE(4),@CF00156                                 1146
*               GO TO NPRMRTN1;     /* RETURN TO IEAVNPA3 CALL     1147
*                                      SEQUENCE                Y02752*/
         L     @10,NPRMRTN1                                        1147
         BR    @10                                                 1147
*             END;                  /*                         Y02752
*                                                              Y02752*/
*           GO TO NP3RTRN8;         /* CONTINUED PARAM EXIT          */
@RF01144 L     @10,NP3RTRN                                         1149
         LA    @10,NP3RTRN8(,@10)                                  1149
         BR    @10                                                 1149
*         END;                                                     1150
*       ELSE                                                       1151
*NP3SCLST:                                                         1151
*         DO;                       /*                         Y02752
*                                                              Y02752*/
*                                                                  1151
@RF01141 DS    0H                                                  1151
NP3SCLST DS    0H                                                  1152
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO IEAVNPA3 CALL SEQUENCE IF IN NIP PROMPT MODE*/
*           /*                                                 Y02752*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1152
*           IF NVTSYSP='1'B         /*                         Y02752*/
*             THEN                  /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           1152
         BNO   @RF01152                                            1152
*             DO;                   /*                         Y02752*/
*               RETCODE=0;          /* VALID REPLY             Y02752*/
         SLR   @10,@10                                             1154
         ST    @10,RETCODE                                         1154
*               GO TO NPRMRTN1;     /* RETURN TO IEAVNPA3 CALL     1155
*                                      SEQUENCE                Y02752*/
         L     @10,NPRMRTN1                                        1155
         BR    @10                                                 1155
*             END;                  /*                         Y02752*/
*           GO TO NP3RTRN0;         /* NORMAL RETURN           Y02752*/
@RF01152 L     @10,NP3RTRN                                         1157
         BR    @10                                                 1157
*         END;                      /*                         Y02752*/
*     END;                          /*                         Y02752
*                                                              Y02752*/
*                                                                  1159
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IEAVNPA3 CALL SEQUENCE IF IN NIP PROMPT MODE  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1160
*   IF NVTSYSP='1'B                 /*                         Y02752*/
*     THEN                          /*                         Y02752*/
@RF01139 TM    NVTSYSP(RNVT),B'01000000'                           1160
         BNO   @RF01160                                            1160
*     DO;                           /*                         Y02752*/
*       RETCODE=4;                  /* EXTRANEOUS INFO FOUND   Y02752*/
         MVC   RETCODE(4),@CF00371                                 1162
*       GO TO NPRMRTN1;             /* RETURN TO IEAVNPA3 CALL     1163
*                                      SEQUENCE                Y02752*/
         L     @10,NPRMRTN1                                        1163
         BR    @10                                                 1163
*     END;                          /*                         Y02752
*                                                              Y02752*/
*   CALL NP3MATCH;                  /* SCAN FOR MATCH IN SYMBOL TABLE
*                                                              Y02752*/
@RF01160 BAL   @14,NP3MATCH                                        1165
*   IF RENTRY=0                     /* RETURN CODE ZERO ON MATCH   1166
*                                                              Y02752*/
*     THEN                                                         1166
         LTR   RENTRY,RENTRY                                       1166
         BZ    @RT01166                                            1166
*     GO TO NP3EQUSB;               /* BRANCH TO PARMTAB ADDRESS MARK
*                                                              Y02752*/
*   ELSE                            /* INVALID PARM            Y02752*/
*     CAUSE04=UNDKEY;               /* FILL IN 'UNDEFINED KEYWORD' AS
*                                      CAUSE                   Y02752*/
*                                                                  1168
         MVC   CAUSE04(20),UNDKEY                                  1168
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO INVALID PARAMETER SYNTAX MESSAGE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1169
*NP3SCINV:                                                         1169
*   CALL NP3PINV;                                                  1169
*                                                                  1169
NP3SCINV BAL   @14,NP3PINV                                         1169
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IEAVNPA3 CALL SEQUENCE IF IN NIP PROMPT MODE  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1170
*   IF NVTSYSP='1'B                 /*                         Y02752*/
*     THEN                          /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           1170
         BNO   @RF01170                                            1170
*     DO;                           /*                         Y02752*/
*       RETCODE=12;                 /* INDICATE ERROR MSG ISSUED   1172
*                                                              Y02752*/
         MVC   RETCODE(4),@CF00036                                 1172
*       GO TO NPRMRTN1;             /* RETURN TO CALLER        Y02752*/
         L     @10,NPRMRTN1                                        1173
         BR    @10                                                 1173
*     END;                          /*                         Y02752
*                                                              Y02752*/
*NP3SCRNV:                                                         1175
*   NP3CONT='0'B;                   /* RESET CONT PARM SWITCH=0    1175
*                                                              Y02752*/
@RF01170 DS    0H                                                  1175
NP3SCRNV NI    NP3CONT,B'01111111'                                 1175
*   OPSPCONT=OPSPCONT&&OPSPCONT;    /* RESET 'CONT' ENTRY TO ZERO  1176
*                                                              Y02752
*                                                              Y02752*/
*                                                                  1176
         L     @10,NP3CTAB                                         1176
         XC    OPSPCONT(16,@10),OPSPCONT(@10)                      1176
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IEAVNPA3 CALL SEQUENCE IF IN NIP PROMPT MODE  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1177
*   IF NVTSYSP='1'B                 /*                         Y02752*/
*     THEN                          /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           1177
         BNO   @RF01177                                            1177
*     DO;                           /*                         Y02752*/
*       RETCODE=4;                  /* EXTRANEOUS INFO FOUND   Y02752*/
         MVC   RETCODE(4),@CF00371                                 1179
*       GO TO NPRMRTN1;             /* RETURN TO IEAVNPA3 CALL     1180
*                                      SEQUENCE                Y02752*/
         L     @10,NPRMRTN1                                        1180
         BR    @10                                                 1180
*     END;                          /*                         Y02752
*                                                              Y02752*/
*   GO TO NP3RTRN4;                 /* RETURN TO CALLER AT + 4     1182
*                                      INVALID PARAMETER RETURN      */
*                                                                  1182
@RF01177 L     @10,NP3RTRN                                         1182
         LA    @10,NP3RTRN4(,@10)                                  1182
         BR    @10                                                 1182
*   /*****************************************************************/
*   /*                                                               */
*   /* PARAMETER SYMBOL AND SYMBOL IN SYMBOL TABLE ARE EQUAL. CHECK  */
*   /* SYMBOL FOR "=" SIGN,WHICH IMPLIES PARAMETER HAS SUBPARAMETERS */
*   /* ASSOCIATED WITH IT.                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1183
*                                   /*                         Y02752*/
*NPEQCK:                            /* IEAVNPA3 SUBROUTINE ENTRY   1183
*                                      POINT                   Y02752*/
*   NPRMRTN1=REXIT;                 /* SAVE RETURN ADDR        Y02752*/
NPEQCK   ST    REXIT,NPRMRTN1                                      1183
*NP3EQUSB:                                                         1184
*   NP3EQADR=SYMBLREG+(SLN-1);      /* LOCATE "=" SIGN               */
*                                                                  1184
NP3EQUSB SLR   @10,@10                                             1184
         IC    @10,SLN                                             1184
         LR    @05,@10                                             1184
         BCTR  @05,0                                               1184
         ALR   @05,SYMBLREG                                        1184
         ST    @05,NP3EQADR                                        1184
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECKS TO SEE IF THIS PARAMETER HAS SUBPARAMETERS             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1185
*   IF NP3SUBSP=NP3EQUAL            /* DOES PARAMETER HAVE "=" SIGN  */
*     THEN                          /* YES, SUBPARAMETERS ASSOCIATED
*                                      WITH THIS PARAMETER           */
         CLC   NP3SUBSP(1,@05),NP3EQUAL                            1185
         BE    @RT01185                                            1185
*     GO TO NP3BALN;                /* BRANCH TO SUBPARAMETER BALANCE
*                                      CHECK SETUP                   */
*   ELSE                            /* NO,SUBPARAMETERS NOT        1187
*                                      ASSOCIATED WITH THIS PARAMETER*/
*     DO;                                                          1187
*       NP3EQADR=SCANREG+SLN;       /* UPDATE MAPPING BASE ADDRESS TO
*                                      POINT TO PARAMETER SYMBOL IN
*                                      CHARACTER STRING              */
         ALR   @10,SCANREG                                         1188
         ST    @10,NP3EQADR                                        1188
*       GO TO NP3NBALN;             /* BRANCH TO KEYWORD ENDING CHECK*/
         B     NP3NBALN                                            1189
*     END;                                                         1190
*                                                                  1190
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SETS UP FOR ENTRY INTO NP3NXSYM FOR CHECKING THE         */
*   /* BALANCING OF THE SUBPARAMETERS AND TO SET THE POSITION OF THE */
*   /* NEXT PARAMETER IN THE CURRENT CHARACTER STRING                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1191
*NP3BALN:                                                          1191
*   SCANREG=NP3CCHAR+SLN;           /* SET MAPPING BASE ADDRESS TO 1191
*                                      SUBPARAMETERS                 */
NP3BALN  SLR   SCANREG,SCANREG                                     1191
         IC    SCANREG,SLN                                         1191
         AL    SCANREG,NP3CCHAR                                    1191
*   CALL NP3NXSYM;                  /* BRANCH TO BALANCING CHECK     */
*                                                                  1192
         BAL   @14,NP3NXSYM                                        1192
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS A GENERATED BRANCH TABLE FOR RETURN FROM NP3NXSYM.    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1193
*   GENERATE FLOWS(NP3ENTER,NP3SCRNV,NP3SCCNT) NOSEQFLOW;          1193
*                                                                  1193
         B     NP3ENTER            VALID SUBPARAMETERS BRANCH RETURN
         B     NP3SCRNV            INVALID SUBPARAMETERS BRANCH RETURN
         B     NP3SCCNT
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE ADDRESS OF ENTRY IN PARMTAB FOR THIS VALID      */
*   /* PARAMETER AND SET BASE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1194
*NP3ENTER:                                                         1194
*   NP3CENT=NP3CTAB+(INDXELMT*LENGTH(OPLIBENT));                   1194
NP3ENTER SLR   @10,@10                                             1194
         IC    @10,INDXELMT                                        1194
         SLA   @10,4                                               1194
         AL    @10,NP3CTAB                                         1194
         ST    @10,NP3CENT                                         1194
*   ORAD=NP3CCHAR+SLN;              /* SET ADDRESS OF SUBPARAMETERS
*                                      IN PARMTAB ENTRY              */
         SLR   @05,@05                                             1195
         IC    @05,SLN                                             1195
         AL    @05,NP3CCHAR                                        1195
         ST    @05,ORAD(,@10)                                      1195
*   CONTAD=CONTAD&&CONTAD;          /* ZERO CONTINUE ADDRESS         */
         L     @15,CONTAD(,@10)                                    1196
         LR    @14,@15                                             1196
         XR    @14,@15                                             1196
         ST    @14,CONTAD(,@10)                                    1196
*   ORLN=NP3NCHAR-ORAD;             /* SET PARM LENGTH FOR THIS ENTRY*/
         LCR   @05,@05                                             1197
         AL    @05,NP3NCHAR                                        1197
         STH   @05,ORLN(,@10)                                      1197
*   CONTLN=CONTLN&&CONTLN;          /* ZERO CONTINUE LENGTH          */
         XC    CONTLN(2,@10),CONTLN(@10)                           1198
*NP3SCTID:                                                         1199
*   INSRCID=NP3INID;                /* SET INPUT SOURCE ID           */
NP3SCTID L     @10,NP3CENT                                         1199
         MVC   INSRCID(2,@10),NP3INID                              1199
*   OPFLAG=CUROPT;                  /* SET OPTION FLAGS IN ENTRY TO
*                                      CURRENT OPTION FLAGS          */
         MVC   OPFLAG(1,@10),CUROPT                                1200
*   CUROPT='00'X;                   /* TURN CURRENT OPTION FLAGS OFF */
         MVI   CUROPT,X'00'                                        1201
*   GO TO NP3SCNXT;                 /* SCAN NEXT PARM                */
*                                                                  1202
         B     NP3SCNXT                                            1202
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CHECKS TO SEE THAT A PARAMETER WHICH HAS NO ASSOCIATED   */
*   /* SUBPARAMETERS IS TERMINATED CORRECTLY.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1203
*NP3NBALN:                                                         1203
*   IF NP3SUBSP=NP3BLANK            /* IS CHARACTER A BLANK          */
*       |NP3SUBSP=NP3COMMA          /* IS CHARACTER A COMMA          */
*       |NP3SUBSP=NP3QUOTE          /* IS CHARACTER A QUOTE          */
*     THEN                          /* IT IS ONE OF THEM,PARAMETER IS
*                                      VALID                         */
NP3NBALN L     @10,NP3EQADR                                        1203
         CLC   NP3SUBSP(1,@10),NP3BLANK                            1203
         BE    @RT01203                                            1203
         CLC   NP3SUBSP(1,@10),NP3COMMA                            1203
         BE    @RT01203                                            1203
         CLC   NP3SUBSP(1,@10),NP3QUOTE                            1203
         BNE   @RF01203                                            1203
@RT01203 DS    0H                                                  1204
*     DO;                                                          1204
*       NP3NCHAR=NP3CCHAR+SLN;      /* UPDATE POINTER TO NEXT      1205
*                                      PARAMETER CHARACTER           */
         SLR   @10,@10                                             1205
         IC    @10,SLN                                             1205
         AL    @10,NP3CCHAR                                        1205
         ST    @10,NP3NCHAR                                        1205
*       GO TO NP3ENTER;             /* BRANCH TO PARMTAB ADDRESS MARK*/
         B     NP3ENTER                                            1206
*     END;                                                         1207
*   ELSE                            /* NOT A VALID PARAMETER         */
*     DO;                                                          1208
@RF01203 DS    0H                                                  1209
*       CAUSE04=IMPDEL;             /* SET CAUSE IN INVALID SYNTAX 1209
*                                      MESSAGE                       */
         MVC   CAUSE04(20),IMPDEL                                  1209
*       GO TO NP3SCINV;                                            1210
         B     NP3SCINV                                            1210
*     END;                                                         1211
*                                                                  1211
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE IS ENTERED WHEN A CONTINUATION OF             */
*   /* SUBPARAMETERS HAS BEEN RECOGNIZED BY NP3SCAN.                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1212
*NP3CHNDL:                                                         1212
*   NP3CONT='0'B;                   /* RESET CONTINUE SUBPARAMETERS
*                                      FLAG TO OFF STATUS            */
NP3CHNDL NI    NP3CONT,B'01111111'                                 1212
*   NP3BALCK=SCANREG;               /* SAVE POINTER TO CONTINUED   1213
*                                      SUBPARAMETERS                 */
         ST    SCANREG,NP3BALCK                                    1213
*   CALL NP3CTSYM;                  /* BRANCH TO BALANCE CHECK     1214
*                                      ROUTINE AT ITS CONTINUATION 1214
*                                      ENTRY POINT                   */
*                                                                  1214
         BAL   @14,NP3CTSYM                                        1214
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS A GENERATED BRANCH TABLE FOR THE RETURN BRANCH FROM   */
*   /* NP3NXSYM.                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1215
*   GENERATE FLOWS(NP3CHNTR,NP3SCRNV,NP3NGCNT) NOSEQFLOW;          1215
         B     NP3CHNTR            VALID SUBPARAMETER BRANCH ENTRY
         B     NP3SCRNV            INVALID SUBPARAMETER BRANCH ENTRY
         B     NP3NGCNT
*NP3NGCNT:                                                         1216
*   CAUSE04=INVCON;                 /* MOVE CAUSE INTO INVALID SYNTAX
*                                      MESSAGE                       */
NP3NGCNT MVC   CAUSE04(20),INVCON                                  1216
*   GO TO NP3SCINV;                 /* GIVE MESSAGE                  */
*                                                                  1217
         B     NP3SCINV                                            1217
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE ADDRESS OF ENTRY IN PARMTAB FOR THIS VALID      */
*   /* PARAMETER                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1218
*NP3CHNTR:                                                         1218
*   NP3CENT=NP3CTAB+(INDXELMT*LENGTH(OPLIBENT));                   1218
NP3CHNTR SLR   @10,@10                                             1218
         IC    @10,INDXELMT                                        1218
         SLA   @10,4                                               1218
         AL    @10,NP3CTAB                                         1218
         ST    @10,NP3CENT                                         1218
*   CONTAD=NP3BALCK;                /* SET ADDRESS OF CONTINUED    1219
*                                      SUBPARAMETERS                 */
         L     @05,NP3BALCK                                        1219
         ST    @05,CONTAD(,@10)                                    1219
*   ORAD=NP3CCHAR+SLN;              /* SET ADDRESS OF BEGINNING OF 1220
*                                      SUBPARAMETERS                 */
         SLR   @15,@15                                             1220
         IC    @15,SLN                                             1220
         AL    @15,NP3CCHAR                                        1220
         ST    @15,ORAD(,@10)                                      1220
*   CONTLN=NP3NCHAR-CONTAD;         /* SET CONT PARM LENGTH          */
         LCR   @05,@05                                             1221
         AL    @05,NP3NCHAR                                        1221
         STH   @05,CONTLN(,@10)                                    1221
*   ORLN=PRENDPTR-ORAD;             /* SET PARM LENGTH               */
         LCR   @15,@15                                             1222
         AL    @15,PRENDPTR                                        1222
         STH   @15,ORLN(,@10)                                      1222
*   GO TO NP3SCTID;                                                1223
         B     NP3SCTID                                            1223
*                                                                  1224
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE VERIFIES THE BALANCING OF SYNTACTICAL         */
*   /* CHARACTERS ASSOCIATED WITH SUBPARAMETERS. IT ALSO CHECKS FOR  */
*   /* AN OPERATES ON THE "CONT" SUBPARAMETERS OPTION.IT SECOND      */
*   /* OBJECTIVE IS TO LOCATE THE NEXT CHARACTER FOLLOWING THE       */
*   /* COMPLETED SUBPARAMETERS AND PLACE ITS ADDRESS IN THE NEXT     */
*   /* CHARACTER POINTER. THE NEXT CHARACTER POINTER IS USED BY      */
*   /* NP3SCAN AS THE POSITION IN THE CHARACTER STRING TO BEGIN      */
*   /* SCANNING FOR THE NEXT SYSTEM PARAMETER TO VERIFY.             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1224
*   RESPECIFY                                                      1224
*     NP3SCAN5 BASED(SCANREG);                                     1224
*                                                                  1224
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTRY FOR CONTINUED PARAMETERS                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1225
*NP3CTSYM:                                                         1225
*   NP3SRTRN=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
*                                                                  1225
NP3CTSYM ST    REXIT,NP3SRTRN                                      1225
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR IMBEDDED PARM OPTION                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1226
*   CALL NP3POPT;                                                  1226
         BAL   @14,NP3POPT                                         1226
*   GO TO NP3PCHCK;                                                1227
         B     NP3PCHCK                                            1227
*NP3NXSYM:                                                         1228
*   NP3SRTRN=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
NP3NXSYM ST    REXIT,NP3SRTRN                                      1228
*   NP3PAREN=0;                     /* SET PARENTHESIS COUNT TO ZERO */
         SLR   @10,@10                                             1229
         ST    @10,NP3PAREN                                        1229
*   CUROPT='00'X;                   /* TURN CURRENT OPTION FLAGS OFF */
*                                                                  1230
         MVI   CUROPT,X'00'                                        1230
*   /*****************************************************************/
*   /*                                                               */
*   /* IS CHARACTER A BLANK OR A QUOTE                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1231
*   IF NP3SCANR=' '|NP3SCANR=NP3QUOTE THEN                         1231
         CLI   NP3SCANR(SCANREG),C' '                              1231
         BE    @RT01231                                            1231
         CLC   NP3SCANR(1,SCANREG),NP3QUOTE                        1231
         BE    @RT01231                                            1231
*     GO TO NP3SNDER;               /* GO GIVE ERROR MESSAGE         */
*                                                                  1232
*   /*****************************************************************/
*   /*                                                               */
*   /* IS CHARACTER A COMMA                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1233
*   IF NP3SCANR=NP3COMMA THEN       /* YES - CANCEL                  */
         CLC   NP3SCANR(1,SCANREG),NP3COMMA                        1233
         BNE   @RF01233                                            1233
*     DO;                                                          1234
*       CURCANOP='1'B;              /* SET CANCEL FLAG IN CURRENT  1235
*                                      OPTION BYTE                   */
         OI    CURCANOP,B'00100000'                                1235
*       GO TO NP3OUT;               /* RETURN                        */
         B     NP3OUT                                              1236
*     END;                                                         1237
*                                                                  1237
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK CURRENT CHARACTER FOR LEFT PARENTHESIS                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1238
*NP3PCHCK:                                                         1238
*   IF SCNPAREN=LPAREN             /* CHARACTER OTHER THAN LEFT   1238
*                                      PAREN                         */
*     THEN                          /* YES, NOT A LEFT PAREN         */
*                                                                  1238
@RF01233 DS    0H                                                  1238
NP3PCHCK CLC   SCNPAREN(1,SCANREG),LPAREN                          1238
         BE    @RF01238                                            1238
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK CURRENT CHARACTER FOR RIGHT PARENTHESIS               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1239
*     IF SCNPAREN=RPAREN           /* CHARACTER OTHER THAN RIGHT  1239
*                                      PAREN                         */
*       THEN                        /* YES, NOT A RIGHT PAREN        */
*                                                                  1239
         CLC   SCNPAREN(1,SCANREG),RPAREN                          1239
         BE    @RF01239                                            1239
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK CURRENT CHARACTER FOR COMMA,QUOTE BLANK             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1240
*       IF NP3SCANR=NP3COMMA        /* CHARACTER = COMMA             */
*           |NP3SCANR=NP3QUOTE      /* CHAR. = QUOTE                 */
*           |NP3SCANR=NP3BLANK      /* CHAR. = BLANK                 */
*         THEN                      /* YES, CHARACTER = TO ONE OF  1240
*                                      THEM                          */
*                                                                  1240
         CLC   NP3SCANR(1,SCANREG),NP3COMMA                        1240
         BE    @RT01240                                            1240
         CLC   NP3SCANR(1,SCANREG),NP3QUOTE                        1240
         BE    @RT01240                                            1240
         CLC   NP3SCANR(1,SCANREG),NP3BLANK                        1240
         BNE   @RF01240                                            1240
@RT01240 DS    0H                                                  1241
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR PAREN COUNT OF ZERO, WHICH IMPLIES            */
*         /* SUBPARAMETERS HAVE BEEN COMPLETELY BALANCED CHECKED     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1241
*         IF NP3PAREN=0             /* COUNT = 0                     */
*           THEN                    /* YES                           */
         ICM   @10,15,NP3PAREN                                     1241
         BNZ   @RF01241                                            1241
*           DO;                     /* SET NEXT CHARACTER POINTER    */
*NP3OUT:                                                           1243
*             NP3NCHAR=SCANREG;     /* RETURN TO CALLER AT VALID   1243
*                                      PARAMETER ENTRY               */
NP3OUT   ST    SCANREG,NP3NCHAR                                    1243
*             GO TO NP3SRTN0;                                      1244
         L     @10,NP3SRTRN                                        1244
         BR    @10                                                 1244
*           END;                                                   1245
*         ELSE                      /* PAREN COUNT NOT ZERO,FALL   1246
*                                      THROUGH                       */
*           DO;                     /* CHECK CHARACTER FOR COMMA     */
@RF01241 DS    0H                                                  1247
*             IF NP3SCANR=NP3COMMA THEN/* YES, CHARACTER IS          */
         CLC   NP3SCANR(1,SCANREG),NP3COMMA                        1247
         BNE   @RF01247                                            1247
*               DO;                 /* A COMMA                       */
*                 NP3SUBCK='1'B;    /* TURN SUBPARAM CHECK SWITCH ON */
         OI    NP3SUBCK,B'00001000'                                1249
*                 GO TO NP3RECNT;   /* BRANCH TO POINTER UPDATE      */
         B     NP3RECNT                                            1250
*               END;                                               1251
*             ELSE                  /* NO, CHARACTER NOT A COMMA     */
*               GO TO NP3ENDL;      /* BRANCH TO END OF CHARACTER  1252
*                                      STRING CHECK                  */
*           END;                                                   1253
*       ELSE                        /* NO, CHARACTER NOT A COMMA OR A
*                                      QUOTE OR A BLANK              */
*         GO TO NP3RECNT;           /* BRANCH TO CHARACTER POINTER 1254
*                                      UPDATE                        */
*     ELSE                          /* YES, CHARACTER IS A RIGHT   1255
*                                      PAREN                         */
*       DO;                                                        1255
*                                                                  1255
@RF01239 DS    0H                                                  1256
*         /***********************************************************/
*         /*                                                         */
*         /* DECREMENT PARENTHESIS COUNT BY ONE(1)                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1256
*         NP3PAREN=NP3PAREN-1;                                     1256
         L     @10,NP3PAREN                                        1256
         BCTR  @10,0                                               1256
         ST    @10,NP3PAREN                                        1256
*         GO TO NP3PRENC;           /* BRANCH TO PAREN COUNT CHK     */
         B     NP3PRENC                                            1257
*       END;                                                       1258
*   ELSE                            /* YES, CHARACTER IS A LEFT PAREN*/
*     DO;                                                          1259
*                                                                  1259
@RF01238 DS    0H                                                  1260
*       /*************************************************************/
*       /*                                                           */
*       /* INCREMENT PARENTHESIS COUNT BY ONE(1)                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1260
*       NP3PAREN=1+NP3PAREN;                                       1260
         LA    @10,1                                               1260
         AL    @10,NP3PAREN                                        1260
         ST    @10,NP3PAREN                                        1260
*       GO TO NP3PRENC;             /* BRANCH TO PAREN COUNT CHECK   */
         B     NP3PRENC                                            1261
*     END;                                                         1262
*                                                                  1262
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK CURRENT COUNT OF PARENTHESIS FOR THIS SUBPARAMETER      */
*   /* CHARACTER STRING FOR GREATER THAN ZERO                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1263
*NP3PRENC:                                                         1263
*   IF NP3PAREN>0                   /* IS COUNT GREATER THAN ZERO    */
*     THEN                                                         1263
NP3PRENC L     @10,NP3PAREN                                        1263
         SLR   @05,@05                                             1263
         CR    @10,@05                                             1263
         BH    @RT01263                                            1263
*     GO TO NP3RECNT;               /* YES - GREATER THAN ZERO       */
*                                                                  1264
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK CURRENT COUNT OF PARENTHESIS FOR THIS SUBPARAMETER      */
*   /* CHARACTER STRING FOR LESS THAN ZERO                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1265
*   IF NP3PAREN<0                   /* COUNT LESS THAN ZERO          */
*     THEN                                                         1265
         CR    @10,@05                                             1265
         BL    @RT01265                                            1265
*     GO TO NP3PRINV;               /* YES,COUNT LESS THAN ZERO      */
*                                                                  1266
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE SCAN POINTER BY ONE(1)                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1267
*   SCANREG=1+SCANREG;                                             1267
*                                                                  1267
         LA    SCANREG,1(,SCANREG)                                 1267
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PARENTHESIS COUNT IS ZERO. THE NEXT CHARACTER SHOULD BE A */
*   /* COMMA OR A BLANK OR A QUOTE. IF THE CHARACTER IS ONE OF THESE */
*   /* THEN THE SUBPARAMETERS HAVE BEEN TERMINATED PROPERLY. IF      */
*   /* NOT,THEN THE SUBPARAMETERS ARE NOT SPECIFIED CORRECTLY        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1268
*   IF NP3SCANR=NP3COMMA            /* CHARACTER A COMMA             */
*       |NP3SCANR=NP3BLANK          /* CHAR. A BLANK                 */
*       |NP3SCANR=NP3QUOTE          /* CHAR. A QUOTE                 */
*     THEN                          /* YES, CHARACTER IS ONE OF THEM,
*                                      SUBPARAMETERS ARE VALID       */
         CLC   NP3SCANR(1,SCANREG),NP3COMMA                        1268
         BE    @RT01268                                            1268
         CLC   NP3SCANR(1,SCANREG),NP3BLANK                        1268
         BE    @RT01268                                            1268
         CLC   NP3SCANR(1,SCANREG),NP3QUOTE                        1268
         BE    @RT01268                                            1268
*     GO TO NP3OUT;                 /* BRANCH TO CALLER RETURN     1269
*                                      HANDLER                       */
*                                                                  1269
*   /*****************************************************************/
*   /*                                                               */
*   /* NO, CHARACTER IS NONE OF THEM, INVALID SUBPARAMETERS          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1270
*NP3SNDER:                                                         1270
*   CAUSE04=IMPDEL;                 /* CAUSE IS IMPROPER DELIMETER   */
*                                                                  1270
NP3SNDER MVC   CAUSE04(20),IMPDEL                                  1270
*   /*****************************************************************/
*   /*                                                               */
*   /* PAREN COUNT IS LESS THAN ZERO WHICH IMPLIES THE SUBPARAMETERS */
*   /* WERE SPECIFIED INCORRECTLY                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1271
*NP3PRINV:                                                         1271
*   IF NP3PAREN=0                  /* IS PAREN CTR ZERO             */
*     THEN                          /* NO - SET CAUSE AS IMBALENCED
*                                      PARENS                        */
NP3PRINV ICM   @10,15,NP3PAREN                                     1271
         BZ    @RF01271                                            1271
*     DO;                                                          1272
*       CAUSE04=IMBPAR;                                            1273
         MVC   CAUSE04(20),IMBPAR                                  1273
*     END;                                                         1274
*NP3PINV2:                                                         1275
*   NP3NCHAR=SCANREG;               /* SET NEXT CHAR. POINTER        */
*                                                                  1275
@RF01271 DS    0H                                                  1275
NP3PINV2 ST    SCANREG,NP3NCHAR                                    1275
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO INVALID PARAMETER SYNTAX MESSAGE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1276
*   CALL NP3PINV;                   /*                         Y02752*/
*                                                                  1276
         BAL   @14,NP3PINV                                         1276
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO NIP PROMPT CONTROL SEQUENCE IF IN PROMPT MODE Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1277
*   IF NVTSYSP='1'B                 /*                         Y02752*/
*     THEN                          /*                         Y02752*/
         TM    NVTSYSP(RNVT),B'01000000'                           1277
         BNO   @RF01277                                            1277
*     DO;                           /*                         Y02752*/
*       RETCODE=12;                 /* INVALID MSG ISSUED RTN CODE 1279
*                                                              Y02752*/
         MVC   RETCODE(4),@CF00036                                 1279
*       GO TO NPRMRTN1;             /* RETURN TO IEAVNPA3 CALL     1280
*                                      SEQUENCE                Y02752*/
         L     @10,NPRMRTN1                                        1280
         BR    @10                                                 1280
*     END;                          /*                         Y02752
*                                                              Y02752*/
*   GO TO NP3SRTN4;                 /* INVALID PARM - RETURN TO    1282
*                                      CALLER                        */
*                                                                  1282
@RF01277 L     @10,NP3SRTRN                                        1282
         LA    @10,NP3SRTN4(,@10)                                  1282
         BR    @10                                                 1282
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CHECKS TO SEE IF "CONT" HAS BEEN SPECIFIED WITH THESE    */
*   /* SUBPARAMETERS. IF NOT, THE SUBPARAMETERS HAVE BEEN SPECIFIED  */
*   /* INCORRECTLY.                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1283
*NP3ENDL:                                                          1283
*   IF NP3SCANR=NP3QUOTE            /* IS CURRENT CHARACTER A QUOTE  */
*     THEN                          /* YES, CHARACTER IS A QUOTE     */
NP3ENDL  CLC   NP3SCANR(1,SCANREG),NP3QUOTE                        1283
         BNE   @RF01283                                            1283
*     DO;                                                          1284
*                                                                  1284
*       /*************************************************************/
*       /*                                                           */
*       /* SET MAPPING BASE ADDRESS POINTER FOR "CONT" CHECK IN      */
*       /* SUBPARAMETER CHARACTER STRING                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1285
*       NP3LKCNT=SCANREG-4;                                        1285
*                                                                  1285
         LR    @10,SCANREG                                         1285
         SL    @10,@CF00371                                        1285
         ST    @10,NP3LKCNT                                        1285
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF "CONT" WAS SPECIFIED WITH THESE           */
*       /* SUBPARAMETERS                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1286
*       IF BALNCONT=NP3RCONT        /* CHARACTERS = "CONT"           */
*         THEN                      /* YES, CONTINUE SUBPARAMETERS 1286
*                                      SPECIFIED                     */
         CLC   BALNCONT(4,@10),NP3RCONT                            1286
         BNE   @RF01286                                            1286
*         DO;                                                      1287
*           PRENDPTR=NP3LKCNT;      /* SET PRIME END PTR TO BEGINNING
*                                      OF 'CONT' CHARACTERS          */
         ST    @10,PRENDPTR                                        1288
*           NP3CONT='1'B;           /* SET CONTINUE SUBPARAMETERS  1289
*                                      SPECIFIED                     */
         OI    NP3CONT,B'10000000'                                 1289
*           GO TO NP3SRTN8;         /* CONT - RETURN TO CALLER       */
         L     @10,NP3SRTRN                                        1290
         LA    @10,NP3SRTN8(,@10)                                  1290
         BR    @10                                                 1290
*         END;                                                     1291
*       ELSE                        /* NO, CONTINUE SUBPARAMETERS NOT
*                                      SPECIFIED, IMPLIES          1292
*                                      SUBPARAMETERS ARE INVALID     */
*         GO TO NP3PRINV;           /* BRANCH TO INVALID           1292
*                                      SUBPARAMETERS RETURN HANDLER  */
*     END;                                                         1293
*   ELSE                            /* NO, CHARACTER IS NOT A QUOTE  */
*     GO TO NP3PRINV;               /* BRANCH TO INVALID           1294
*                                      SUBPARAMETERS RETURN HANDLER  */
*NP3RECNT:                                                         1295
*   SCANREG=1+SCANREG;              /* UPDATE SCAN POINTER           */
NP3RECNT LA    SCANREG,1(,SCANREG)                                 1295
*   IF NP3SUBCK='1'B               /* IS SUBPARAM CHECK FLAG ON     */
*     THEN                                                         1296
         TM    NP3SUBCK,B'00001000'                                1296
         BNO   @RT01296                                            1296
*     GO TO NP3PCHCK;               /* NO - LOOK FOR PAREN           */
*   NP3SUBCK='0'B;                  /* RESET SUBPARAM SWITCH TO ZERO */
*                                                                  1298
         NI    NP3SUBCK,B'11110111'                                1298
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR IMBEDDED PARAMETER OPTIONS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1299
*   CALL NP3POPT;                                                  1299
         BAL   @14,NP3POPT                                         1299
*   GO TO NP3PCHCK;                 /* LOOK FOR PARENS               */
         B     NP3PCHCK                                            1300
*                                                                  1301
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE IS FOR ISSUING INVALID PARAMETER MESSAGES TO  */
*   /* THE CONSOLE OPERATOR THROUGH THE NIPWTO (IEAVNIPM) BRANCH     */
*   /* INTERFACE.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1301
*NP3PINV:                                                          1301
*   NP3PRTRN=REXIT;                 /* SAVE CALLERS RETURN ADDRESS   */
NP3PINV  ST    REXIT,NP3PRTRN                                      1301
*   NP3ECHMV=NP3ERCHR;              /* MOVE ERROR CHARACTERS INTO  1302
*                                      MESSAGE BUFFER                */
*                                                                  1302
         L     @10,NP3CCHAR                                        1302
         MVC   NP3ECHMV(8),NP3ERCHR(@10)                           1302
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF LENGTH OF ERROR CHARACTERS IS LESS THAN       */
*   /* EIGHT(8). IF YES,THEN BLANK FILL CHARACTERS ARE NEEDED IN THE */
*   /* ERROR PARAMETER TEXT                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1303
*   IF SLN<LENGTH(SYMBSTRT)         /* ERROR CHARACTERS LESS THAN  1303
*                                      EIGHT(8)                      */
*     THEN                          /* YES, LENGTH LESS THAN EIGHT(8)*/
         CLI   SLN,8                                               1303
         BNL   @RF01303                                            1303
*     DO;                                                          1304
*                                                                  1304
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE FILL CHARACTER LENGTH VALUE                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1305
*       NP3MELNG=LENGTH(SYMBSTRT);                                 1305
*                                                                  1305
         LA    @10,8                                               1305
         STC   @10,NP3MELNG                                        1305
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE BLANK FILL CHARACTERS INTO ERROR PARAMETER TEXT      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1306
*       NP3ECHMI(SLN:NP3MELNG)=NP3FILL;                            1306
         SLR   @05,@05                                             1306
         IC    @05,SLN                                             1306
         LA    @01,NP3ECHMI-1(@05)                                 1306
         SLR   @10,@05                                             1306
         EX    @10,@SM02878                                        1306
*     END;                                                         1307
*   ELSE                                                           1308
*     ;                             /* NO, LENGTH NOT LESS THAN    1308
*                                      EIGHT, FALL THROUGH           */
*                                                                  1308
@RF01303 DS    0H                                                  1309
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS GENERATE IS A MACRO BRANCH INTERFACE TO NIPWTO           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1309
*   GENERATE REFS(NVTWTO);                                         1309
         IEAPMNIP   TYPE=WTO,PARAM=MESG04    CALL WTO SERVICE ROUTINE
*   GO TO NP3PRTR0;                 /* RETURN TO CALLER              */
         L     @10,NP3PRTRN                                        1310
         BR    @10                                                 1310
*                                                                  1311
*   /*****************************************************************/
*   /*                                                               */
*   /* PARAMETER OPTION ROUTINE SCANS FOR LIST OR OPI OPTIONS. IF    */
*   /* FOUND, THE CHARACTERS ('L,' , 'L)' , 'OPI=') ARE REPLACED BY  */
*   /* NULL CHARACTERS (X'FF') AND CORRESPONDING OPTION FLAGS ARE SET*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1311
*   RESPECIFY                                                      1311
*     NP3SCAN5 BASED(SCANREG);                                     1311
*NP3POPT:                                                          1312
*   NP3POADR=REXIT;                 /* SAVE CALLER'S RETURN ADDRESS  */
NP3POPT  ST    REXIT,NP3POADR                                      1312
*   IF NP3SCAN2='L,'                /* IS CHAR 'L,'                  */
*     THEN                                                         1313
         CLC   NP3SCAN2(2,SCANREG),@CC02718                        1313
         BE    @RT01313                                            1313
*     GO TO NP3POLST;               /* YES - OVERRIDE WITH NULL CHAR */
*   IF NP3SCAN2='L)'               /* IS CHAR 'L)'                  */
*     THEN                                                         1315
         CLC   NP3SCAN2(2,SCANREG),@CC02720                        1315
         BNE   @RT01315                                            1315
*     GO TO NP3PONXT;               /* NO - CHECK FOR OPI OPTION     */
*NP3POLST:                                                         1317
*   NP3SCANR='FF'X;                 /* REPLACE 'L' WITH X'FF'        */
NP3POLST MVI   NP3SCANR(SCANREG),X'FF'                             1317
*   SCANREG=SCANREG-1;              /* POINT TO PRECEEDING COMMA     */
         BCTR  SCANREG,0                                           1318
*   NP3SCANR='FF'X;                 /* REPLACE PRECEEDING COMMA WITH
*                                      X'FF'                         */
         MVI   NP3SCANR(SCANREG),X'FF'                             1319
*   CLISTOPT='1'B;                  /* SET LIST OPTION IN CURRENT  1320
*                                      FLAG                          */
         OI    CLISTOPT,B'01000000'                                1320
*   SCANREG=SCANREG+2;              /* UPDATE SCAN PTR PAST ',L'     */
         LA    SCANREG,2(,SCANREG)                                 1321
*NP3PONXT:                                                         1322
*   IF NP3SCAN4='OPI='             /* IS CHAR 'OPI='                */
*     THEN                                                         1322
NP3PONXT CLC   NP3SCAN4(4,SCANREG),@CC02723                        1322
         BNE   @RT01322                                            1322
*     GO TO NP3POXIT;               /* NO - RETURN                   */
*                                                                  1323
*   /*****************************************************************/
*   /*                                                               */
*   /* YES - OPI IS SPECIFIED                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1324
*   NP3SCAN4='FFFFFFFF'X;           /* OVERRIDE 'OPI=' WITH NULL     */
         MVC   NP3SCAN4(4,SCANREG),@CB02726                        1324
*   SCANREG=SCANREG-1;              /* POINT TO PRECEEDING COMMA     */
         BCTR  SCANREG,0                                           1325
*   NP3SCANR='FF'X;                 /* REPLACE PRECEEDING COMMA WITH
*                                      X'FF'                         */
         MVI   NP3SCANR(SCANREG),X'FF'                             1326
*   IF NP3INID='0000'X              /* IS OPERATOR THE SOURCE        */
*     THEN                                                         1327
         CLC   NP3INID(2),@CB02317                                 1327
         BE    @RT01327                                            1327
*     GO TO NP3INVOP;               /* YES - GIVE INVALID PARAMETER
*                                      SYNTAX MESSAGE                */
*   SCANREG=SCANREG+5;              /* POINT TO CHAR AFTER ',OPI='   */
         LA    SCANREG,5(,SCANREG)                                 1329
*   IF NP3SCAN2='NO'                /* IS OPI = NO SPECIFIED         */
*     THEN                                                         1330
         CLC   NP3SCAN2(2,SCANREG),@CC02487                        1330
         BNE   @RF01330                                            1330
*     DO;                           /* YES - SET OPI FLAG            */
*       COPIOPT='1'B;               /* SET OPI OPTION IN CURRENT FLAG*/
         OI    COPIOPT,B'10000000'                                 1332
*       NP3SCAN2='FFFF'X;           /* REPLACE WITH NULL CHARS       */
         MVC   NP3SCAN2(2,SCANREG),@CB02728                        1333
*       SCANREG=SCANREG+2;          /* UPDATE PAST OPI = NO          */
         LA    SCANREG,2(,SCANREG)                                 1334
*       GO TO NP3POXIT;             /* RETURN                        */
         B     NP3POXIT                                            1335
*     END;                                                         1336
*   IF NP3SCAN3='YES'               /* IS OPI = YES SPECIFIED        */
*     THEN                                                         1337
@RF01330 CLC   NP3SCAN3(3,SCANREG),@CC02486                        1337
         BNE   @RF01337                                            1337
*     DO;                                                          1338
*       NP3SCAN3='FFFFFF'X;         /* REPLACE WITH NULL CHARS       */
         MVC   NP3SCAN3(3,SCANREG),@CB02729                        1339
*       SCANREG=SCANREG+3;          /* UPDATE PAST OPI = YES         */
         LA    SCANREG,3(,SCANREG)                                 1340
*     END;                                                         1341
*   ELSE                                                           1342
*     GO TO NP3INVOP;               /* NEITHER OPI=YES NOR OPI=NO    */
*NP3POXIT:                                                         1343
*   GO TO NP3POAD0;                 /* RETURN TO CALLER              */
NP3POXIT L     @10,NP3POADR                                        1343
         BR    @10                                                 1343
*NP3INVOP:                                                         1344
*   CAUSE04=INVOPI;                 /* SET CAUSE AS 'INVALID OPI   1344
*                                      KEYWORD'                      */
NP3INVOP MVC   CAUSE04(20),INVOPI                                  1344
*   GO TO NP3PINV2;                 /* GO GIVE INVALID PARAMETER   1345
*                                      SYNTAX MESSAGE                */
         B     NP3PINV2                                            1345
*   RESPECIFY                                                      1346
*     SYMBLREG UNRESTRICTED;        /* RELEASE SCAN CONTROL REGISTER */
*   RESPECIFY                                                      1347
*     OFFSTREG UNRESTRICTED;        /* RELEASE SCAN CONTROL REGISTER */
*                                                                  1348
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE OBTAINS PAREAS FROM SUBPOOL 252. IF THE GETMAIN  */
*   /* IS UNSUCCESSFULL,THE OPERATOR IS NOTIFIED AN ACTION IS TAKEN  */
*   /* TO PLACE THE SYSTEM IN A DISABLED WAIT STATE.                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1348
*NP3PAGM:                                                          1348
*   NP3RTRN=REXIT;                  /* SAVE CALLERS RETURN ADDRESS   */
*                                                                  1348
NP3PAGM  ST    REXIT,NP3RTRN                                       1348
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS GENERATES A GETMAIN MACRO TO GET A 2K BUFFER FROM SUBPOOL*/
*   /* 0 .                                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1349
*   GENERATE;                                                      1349
*                                                                  1349
         GETMAIN    LC,LA=PAREA01,A=NP3GBFR,SP=0    ISSUE GETMAIN
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SUCCESSFULL GETMAIN - 0=YES, 4=NO                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1350
*   IF GETMRTCD=0                   /* WAS GETMAIN SUCCESSFULL       */
*     THEN                          /* YES, 2K BUFFER WAS GOTTEN     */
         SLR   @14,@14                                             1350
         CR    GETMRTCD,@14                                        1350
         BNE   @RF01350                                            1350
*     DO;                                                          1351
*       RESPECIFY                                                  1352
*         NIPPAHDR BASED(NP3GBFR);  /* RESET POINTER                 */
*       NIPPAQ=0;                   /* CLEAR FIRST HALF OF HEADER    */
         L     @10,NP3GBFR                                         1353
         ST    @14,NIPPAQ(,@10)                                    1353
*       NIPPABYT=0;                 /* CLEAR SECOND HALF OF HEADER   */
*                                                                  1354
         ST    @14,NIPPABYT(,@10)                                  1354
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF THIS IS THE INITIAL PAREA,,FIRST 2K BUFFER*/
*       /* GOTTEN                                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1355
*       IF NP3ADBFR='1'B            /* IS THIS THE INITIAL PAREA     */
*         THEN                      /* NO, THIS IS NOT INITIAL PAREA */
         TM    NP3ADBFR,B'00100000'                                1355
         BNO   @RF01355                                            1355
*         DO;                                                      1356
*           RESPECIFY                                              1357
*             NIPPAHDR BASED(NP3PAREA);                            1357
*           NIPPAQ=NP3GBFR;         /* CHAIN THIS BUFFER TO LAST   1358
*                                      BUFFER GOTTEN                 */
         L     @09,NP3PAREA                                        1358
         ST    @10,NIPPAQ(,@09)                                    1358
*           RESPECIFY                                              1359
*             NIPPAHDR BASED(NP3PBFR);                             1359
*         END;                                                     1360
*       ELSE                        /* YES, THIS IS FIRST PAREA      */
*         DO;                                                      1361
         B     @RC01355                                            1361
@RF01355 DS    0H                                                  1362
*           NP3ADBFR='1'B;          /* SET INITIAL PAREA GOTTEN FLAG
*                                      ON                            */
         OI    NP3ADBFR,B'00100000'                                1362
*         END;                                                     1363
*       NP3PAREA=NP3GBFR;           /* SAVE NEW BUFFER ADDRESS       */
@RC01355 L     @10,NP3GBFR                                         1364
         ST    @10,NP3PAREA                                        1364
*       RESPECIFY                                                  1365
*         NIPPAHDR BASED(NP3GBFR);  /* RESET POINTER                 */
*       NIPPABYT=NP3GBFR+LENGTH(NIPPAHDR);/* SET NEXT AVAILABLE BYTE
*                                      ADDRESS IN HEADER             */
         LA    @09,8                                               1366
         ALR   @09,@10                                             1366
         ST    @09,NIPPABYT(,@10)                                  1366
*       RESPECIFY                                                  1367
*         NIPPAHDR BASED(NP3PBFR);  /* RESET POINTER                 */
*       GO TO NP3RTRN0;             /* RETURN TO CALLER              */
         L     @10,NP3RTRN                                         1368
         BR    @10                                                 1368
*     END;                                                         1369
*   ELSE                                                           1370
*     ;                             /* NO ,2K BUFFER WAS NOT       1370
*                                      ALLOCATED ,AN ERROR CONDITION
*                                      EXIST.                        */
@RF01350 DS    0H                                                  1371
*   GO TO NP3SW38;                  /* GO TELL OPERATOR GETMAIN    1371
*                                      FAILED DURING INITIALIZATION  */
         B     NP3SW38                                             1371
*/********************************************************************/
*/*                                                                  */
*/* MACRO-      IEAPSPIO                                             */
*/*                                                                  */
*/* STATUS-     VERSION DATE=10/24/73, VS/2 RELEASE 2                */
*/*                                                                  */
*/* FUNCTION-   IEAPSPIO IS PART OF THE  SUPERVISOR                  */
*/*             INITIALIZATION PROCESS FOR VS2.                      */
*/*                                                                  */
*/*             THIS MACRO GENERATES INLINE PL/S STATEMENTS          */
*/*             WHICH FORM A SUBROUTINE TO FIND AND READ TEXT        */
*/*             RECORDS FROM SYS1.PARMLIB.                           */
*/*                                                                  */
*/*  REGISTER DEPENDENCIES-                                          */
*/*                                                                  */
*/*                 1. IEAPSPIO DEPENDS ON THE INCLUDING ROUTINES    */
*/*                    BASE REGISTERS FOR ADDRESSABILITY             */
*/*                                                                  */
*/*                 2. REGISTER 3 MUST CONTAIN THE ADDRESS OF        */
*/*                    THE CVT ON ENTRY                              */
*/*                                                                  */
*/*                 3. REGISTER 2 MUST CONTAIN THE ADDRESS OF        */
*/*                    THE NVT ON ENTRY                              */
*/*                                                                  */
*/*                 4. REGISTER 14 MUST CONTAIN THE ADDRESS OF       */
*/*                    THE CALLERS RETURN POINT ON ENTRY             */
*/*                                                                  */
*/* ENTRY POINTS-                                                    */
*/*                                                                  */
*/*    TWO CALLING SEQUENCRS ARE AVAILABLE.  ONE PROVIDES            */
*/*    COMPATIBILITY WITH THE VS2-1 VERSION OF THIS MACRO,           */
*/*    THE OTHER CALLING SEQUENCE WAS DEVELOPED EXPRESSLY            */
*/*    FOR VS2-2.                                                    */
*/*                                                                  */
*/*        VS2-1 COMPATIBLE VERSION-                                 */
*/*                                                                  */
*/*            1. CALL NIPPMPDS TO LOCATE (VIA BLDL) THE MEMBER      */
*/*               OF SYS1.PARMLIB                                    */
*/*                                                                  */
*/*            2. CALL NIPPMTXT TO READ A TEXT RECORD FROM           */
*/*               SYS1.PARMLIB                                       */
*/*                                                                  */
*/*        VS2-2 VERSION-                                            */
*/*                                                                  */
*/*            1. CALL NIPPMMEM TO LOCATE THE MEMBER AND RETURN      */
*/*               A TEXT RECORD                                      */
*/*                                                                  */
*/*            2. REPEAT CALL TO NIPPMMEM TO READ ADDITIONAL         */
*/*               TEXT RECORDS                                       */
*/*                                                                  */
*/* OUTPUT (NORMAL) -                                                */
*/*                                                                  */
*/*     THE ROUTINE WILL SAVE AND RESTORE ALL GENERAL REGISTERS      */
*/*     WITH THE EXCEPTION OF RPARM.  ON A SUCCESSFUL READ,          */
*/*     RPARM (REGISTER 1) WILL BE SET TO POINT TO THE FIRST NON-    */
*/*     BLANK CHARACTER IN THE TEXT RECORD.  IF THE RECORD           */
*/*     COLUMNS 1 THRU 72 ALL CONTAIN BLANKS, RPARM WILL             */
*/*     POINT TO A BLANK IN COLUMN 72.  IF COLUMNS 1 THRU 71         */
*/*     ARE BLANK BUT COLUMN 72 IS NON-BLANK, THE ROUTINE            */
*/*     WILL AUTOMATICALLY ATTEMPT TO READ THE NEXT RECORD.  IN      */
*/*     ALL CASES, COLUMN 72 WILL BE SET TO BLANK AND COLUMN 73 WILL */
*/*     BE SET TO X'FF'.                                             */
*/*                                                                  */
*/* EXIT (NORMAL)-                                                   */
*/*                                                                  */
*/*     VS2-1 AND VS2-2 VERSIONS RETURN TO THE ADDRESS FOUND         */
*/*     IN REGISTER 14 ON ENTRY.                                     */
*/*                                                                  */
*/* EXIT (ERROR)-                                                    */
*/*                                                                  */
*/*     VS2-1 COMPATIBLE VERSION-                                    */
*/*                                                                  */
*/*         RETURN TO THE ADDRESS IN REGISTER 14 +4                  */
*/*                                                                  */
*/*         NOTE- WHEN AN ERROR OCCURS ON AN ATTEMP TO READ A RECORD */
*/*               THAT DOES NOT EXIST (E-O-F),                       */
*/*               IT IS CONSIDERED A PERMANENT I/O ERROR             */
*/*                                                                  */
*/*     VS2-2 VERSION-                                               */
*/*                                                                  */
*/*        RETURN TO THE ADDRESS FOUND IN REGISTER 14 ON ENTRY       */
*/*        WITH REGISTER 1 (RPARM) SET TO A NEGATIVE VALUE.  IN THE  */
*/*        CASE WHERE RPARM IS NEGATIVE ON RETURN, THE NIPPARC FIELD */
*/*        OF THE NIP PATAMETER AREA WILL INDICATE THE REASON FOR    */
*/*        FAILURE AS FOLLOWS-                                       */
*/*                            4 - MEMBER NOT FOUND                  */
*/*                            8 - I/O ERROR DURING BLDL             */
*/*                            12- I/O ERROR DURING READ             */
*/*                            16- END-OF-FILE                       */
*/*                                                                  */
*/*     COMMON TO BOTH VERSIONS-                                     */
*/*                                                                  */
*/*        AN INTERPRETIVE MESSAGE WILL BE WRITTEN TO THE OPERATOR   */
*/*        FOR EACH OF THE FIRST THREE ERROR CONDITIONS LISTED       */
*/*        ABOVE.  THE CALLER MAY SUPPRESS THE 'MEMBER NOT FOUND'    */
*/*        MESSAGE BY SETTING THE NIPPAFL1 FLAG FIELD TO BINARY      */
*/*        ONE IN THE NIP PARAMETER AREA BEFORE CALLING THIS         */
*/*        ROUTINE.  NO MESSAGE WILL BE WRITTEN FOR THE E-O-F        */
*/*        CONDITION IF THE VS2-2 VERSION IS USED.                   */
*/*                                                                  */
*/* MACROS-                                                          */
*/*     THE FOLLOWING MAPPING MACROS MUST BE                         */
*/*     INCLUDED IN THE MODULE WHICH INCLUDES                        */
*/*     IEAPSPIO-                                                    */
*/*                                       IEZIOB                     */
*/*                                       IHANVT                     */
*/*                                       IHAECB                     */
*/*                                       IEAPPNIP                   */
*/*                                       IEFUCBOB                   */
*/*                                       CVT                        */
*/*                                                                  */
*/* NOTES-                                                           */
*/*        THE FIRST FOUR LETTERS OF ALL IEAPSPIO SYMBOLES ARE:      */
*/*        NIPP OR IPPM.                                             */
*/*                                                                  */
*/*        REGISTERS 0, 1, 14, AND 15 WILL BE UNRESTRICTED AT THE    */
*/*        END OF THE SEGMENT GENERATED BY IEAPSPIO.                 */
*/*                                                                  */
*/*        NIPPAREA WILL BE BASED ON NVTPAREA AND IOBSTDRD WILL BE   */
*/*        BASED ON THE ADDR OF NIPPAIOB AT THE END OF THE SEGMENT   */
*/*        GENERATED BY IEAPSPIO                                     */
*/*                                                                  */
*/*        IEAPSPIO MUST BE INCLUDED IN A CODE SEGMENT,              */
*/*        NOT AT THE TOP OF THE PROCEDURE WITH THE                  */
*/*        MAPPING MACROS LISTED ABOVE.                              */
*/*                                                            Y02752*/
*/********************************************************************/
*                                                                  1372
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTERS                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1372
*   DCL                                                            1372
*     NIPPMR00 REG(0) PTR(24);                                     1372
*   DCL                                                            1373
*     NIPPMR01 REG(1) PTR(24);                                     1373
*   DCL                                                            1374
*     NIPPMR02 REG(2) PTR(24);                                     1374
*   DCL                                                            1375
*     NIPPMR06 REG(6) PTR(24);                                     1375
*   DCL                                                            1376
*     NIPPMR09 REG(9) PTR(24);                                     1376
*   DCL                                                            1377
*     NIPPMR12 REG(12) PTR(24);                                    1377
*   DCL                                                            1378
*     NIPPMR13 REG(13) PTR(24);                                    1378
*   DCL                                                            1379
*     NIPPMR14 REG(14) PTR(24);                                    1379
*   DCL                                                            1380
*     NIPPMR15 REG(15) PTR(24);                                    1380
*                                                                  1380
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE AREA FOR CALLER'S REGISTERS                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1381
*   DCL                                                            1381
*     NIPPMREG(16) FIXED(31);                                      1381
*                                                                  1381
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE AREA FOR CALLER'S RETURN ADDRESS                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1382
*   DCL                                                            1382
*     NIPPMADR PTR(31);                                            1382
*                                                                  1382
*   /*****************************************************************/
*   /*                                                               */
*   /* POINTER TO DCB FOR BLDL                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1383
*   DCL                                                            1383
*     NIPPMDCB PTR(31);                                            1383
*                                                                  1383
*   /*****************************************************************/
*   /*                                                               */
*   /* POINTER TO BLDL HEADER FOR BLDL                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1384
*   DCL                                                            1384
*     NIPPMBDL PTR(31);                                            1384
*                                                                  1384
*   /*****************************************************************/
*   /*                                                               */
*   /* NORMAL RETURN TO CALLER                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1385
*   DCL                                                            1385
*     NIPPMAD0 LABEL BASED(NIPPMADR);                              1385
*                                                                  1385
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR RETURN TO CALLER                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1386
*   DCL                                                            1386
*     NIPPMAD4 LABEL BASED(NIPPMADR+4);                            1386
*                                                                  1386
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH BASE FOR NIP COMMUNICATION AREA               Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1387
*   RESPECIFY                                                      1387
*     NIPPAREA BASED(NVTPAREA);     /*                         Y02752*/
*                                                                  1387
*   /*****************************************************************/
*   /*                                                               */
*   /* ONE BYTE SCANNING FIELD                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1388
*   DCL                                                            1388
*     NIPPMBYT CHAR(1) BASED;                                      1388
*                                                                  1388
*   /*****************************************************************/
*   /*                                                               */
*   /* TEMPORARY POINTER                                       Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1389
*   DCL                                                            1389
*     NIPPMKPR PTR(31);             /*                         Y02752*/
*                                                                  1389
*   /*****************************************************************/
*   /*                                                               */
*   /* INPUT RECORD READ FROM PARMLIB                          Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1390
*   DCL                                                            1390
*     NIPPMBUF CHAR(80) BASED(NIPPMR01);/*                     Y02752*/
*                                                                  1390
*   /*****************************************************************/
*   /*                                                               */
*   /* MBBCCHHR OF PARMLIB MEMBERS                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1391
*   DCL                                                            1391
*     1 NIPPMMBC CHAR(8),                                          1391
*      2 NIPPMMBB CHAR(3),                                         1391
*      2 NIPPMCCH CHAR(5);                                         1391
*                                                                  1391
*   /*****************************************************************/
*   /*                                                               */
*   /* CCHHR OF PARMLIB MEMBERS                              @ZA07472*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1392
*   DCL                                                            1392
*     1 NIPPMSID BDY(WORD) CHAR(5) BASED(ADDR(NIPPASID)),/*  @ZA07472*/
*      2 NIPPMCC FIXED(15),         /* CYLINDER # OF SEARCH ID     1392
*                                                            @ZA07472*/
*      2 NIPPMHH CHAR(2),           /* HEAD # OF SEARCH ID   @ZA07472*/
*      2 NIPPMR CHAR(1);            /* RECORD # OF SEARCH ID @ZA07472*/
*                                                                  1392
*   /*****************************************************************/
*   /*                                                               */
*   /* LOW ORDER 7 BYTES OF THE CSW STORED IN THE PARMLIB IOB BY EXCP*/
*   /*                                                         Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1393
*   DCL                                                            1393
*     1 NIPPMCSW BASED(ADDR(IOBCSW)) BDY(BYTE),/*              Y02752*/
*      2 * CHAR(3),                 /*                         Y02752*/
*      2 NIPPMCS2 BIT(8),           /* I/O OPERATION STATUS FLAGS /*
*                                                              Y02752*/
*      2 * CHAR(3);                 /*                         Y02752*/
*                                                                  1393
*   /*****************************************************************/
*   /*                                                               */
*   /* MASKS TO TEST THE STATUS FLAGS OF THE PARMLIB CSW Y02752      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1394
*   DCL                                                            1394
*     NIPPMMK1 BIT(8) BDY(BYTE) INIT('11110010'B);/*           Y02752*/
*   DCL                                                            1395
*     NIPPMMK2 BIT(8) BDY(BYTE) INIT('11110001'B);/*         @ZA07472*/
*                                                                  1395
*   /*****************************************************************/
*   /*                                                               */
*   /* MASK TO TEST THE IOBSENSE FLAGS                       @ZA07472*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1396
*   DCL                                                            1396
*     NIPPMMK3 BIT(8) BDY(BYTE) INIT('00100000'B);/*         @ZA07472*/
*                                                                  1396
*   /*****************************************************************/
*   /*                                                               */
*   /* INTERNALLY GENERATED LABELS                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1397
*   DCL                                                            1397
*     NIPPMMB1 LABEL GENERATED INTERNAL;                           1397
*   DCL                                                            1398
*     NIPPMMB2 LABEL GENERATED INTERNAL;                           1398
*   DCL                                                            1399
*     NIPPMTND LABEL GENERATED INTERNAL;                           1399
*                                                                  1399
*   /*****************************************************************/
*   /*                                                               */
*   /* MAPPING AREAS INTO ERROR MESSAGES                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1400
*   DCL                                                            1400
*     NIPPMME1 CHAR(8) BASED(ADDR(NIPPMMB1));                      1400
*   DCL                                                            1401
*     NIPPMME2 CHAR(8) BASED(ADDR(NIPPMMB2));                      1401
*   DCL                                                            1402
*     NIPPMNAM CHAR(8) INIT(' ');   /* MEMBER NAME SAVE AREA   Y02752*/
*   DCL                                                            1403
*     NIPPMNEG FIXED(31) INIT('FFFFFFFF'X);/* NEGATIVE VALUE   Y02752*/
*   RESPECIFY                                                      1404
*     IOBSTDRD BASED(ADDR(NIPPAIOB));/* IOB BASE               Y02752*/
*   RESPECIFY                                                      1405
*    (NIPPMR14,                                                    1405
*     NIPPMR15,                                                    1405
*     NIPPMR00,                                                    1405
*     NIPPMR01) RESTRICTED;         /*                         Y02752*/
*NIPPMMEM:                                                         1406
*   NIPPMADR=NIPPMR14;              /* SAVE CALLER'S RETURN REGISTER
*                                                              Y02752*/
NIPPMMEM ST    NIPPMR14,NIPPMADR                                   1406
*   GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);               1407
          STM   NIPPMR02,NIPPMR01,NIPPMREG   SAVE REGISTERS     Y02752
*   NIPPARC=NIPPARC&&NIPPARC;       /* SET RETURN CODE TO ZERO Y02752*/
         L     @10,NVTPAREA(,RNVT)                                 1408
         L     @09,NIPPARC(,@10)                                   1408
         LR    @07,@09                                             1408
         XR    @07,@09                                             1408
         ST    @07,NIPPARC(,@10)                                   1408
*   IF NIPPMNAM=NIPPANAM            /* IS THIS NEW MEMBER NAME Y02752*/
*     THEN                                                         1409
         CLC   NIPPMNAM(8),NIPPANAM(@10)                           1409
         BE    @RT01409                                            1409
*     GO TO NIPPMPRD;               /* NO- GO READ RECORD      Y02752*/
*   NIPPMNAM=NIPPANAM;              /* YES- SAVE MEMBER NAME   Y02752*/
         MVC   NIPPMNAM(8),NIPPANAM(@10)                           1411
*   GO TO NIPPMENT;                 /* GO FIND MEMBER          Y02752*/
         B     NIPPMENT                                            1412
*NIPPMPDS:                                                         1413
*   NIPPMADR=NIPPMR14;              /* SAVE CALLER'S RETURN ADDR     */
NIPPMPDS ST    NIPPMR14,NIPPMADR                                   1413
*   GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);               1414
         STM   NIPPMR02,NIPPMR01,NIPPMREG       SAVE REGS       Y02752
*   NIPPMNAM=NIPPMNAM&&NIPPMNAM;    /* CLEAR MEMBER NAME       Y02752*/
         XC    NIPPMNAM(8),NIPPMNAM                                1415
*NIPPMENT:                                                         1416
*   NIPPMR01=ADDR(NIPPADCB)-44;     /* R1= ADDR OF DCB               */
NIPPMENT L     @10,NVTPAREA(,RNVT)                                 1416
         LA    NIPPMR01,NIPPADCB(,@10)                             1416
         SH    NIPPMR01,@CH02133                                   1416
*   NIPPMR00=ADDR(NIPPABDL);        /* R0= ADDR OF BLDL LIST         */
*                                                                  1417
         LA    NIPPMR00,NIPPABDL(,@10)                             1417
*   /*****************************************************************/
*   /*                                                               */
*   /* READ PDS ENTRY FOR MEMBER                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1418
*   GENERATE;                                                      1418
          BLDL (1),(0)
*   NIPPARC=NIPPMR15;               /* SET RETURN CODE         Y02752*/
         L     @10,NVTPAREA(,RNVT)                                 1419
         ST    NIPPMR15,NIPPARC(,@10)                              1419
*   IF NIPPMR15=4                   /* WAS MEMBER NAME FOUND   Y02752*/
*     THEN                                                         1420
         CH    NIPPMR15,@CH00371                                   1420
         BE    @RT01420                                            1420
*     GO TO NIPPMPFN;               /* NO - TELL OPERATOR NOT FOUND  */
*   IF NIPPMR15=8                   /* WAS THERE AN I/O ERROR        */
*     THEN                                                         1422
         CH    NIPPMR15,@CH00156                                   1422
         BE    @RT01422                                            1422
*     GO TO NIPPMPER;               /* YES - TELL OPERATOR I/O ERROR */
*                                                                  1423
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETERS FOR CONVERSION ROUTINE                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1424
*   NIPPMR00=NIPPATTR;              /* R0 = ACTUAL TTR               */
         SLR   NIPPMR00,NIPPMR00                                   1424
         ICM   NIPPMR00,7,NIPPATTR(@10)                            1424
*   GENERATE;                                                      1425
         SLL   0,8(0)                    ZERO LOW BYTE IN REG 0
*   NIPPMR01=ADDR(NIPPADEB);        /* R1 = ADDR OF DEB              */
         L     NIPPMR01,NVTPAREA(,RNVT)                            1426
         LA    NIPPMR01,NIPPADEB(,NIPPMR01)                        1426
*   NIPPMR15=CVTPCNVT;              /* R15 = ADDR OF CONVERSION    1427
*                                      ROUTINE                 Y02752*/
*                                                                  1427
         L     NIPPMR15,CVTPCNVT(,CVTPTR)                          1427
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT TTR TO CCHHR FORMAT                             Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1428
*   GENERATE REFS(NIPPMR02,NIPPMR13) SETS(NIPPMR14,NIPPMR15,NIPPMMBC);
*                                                          /*
         STM   NIPPMR02,NIPPMR13,NIPPMSAV SAVE REGISTERS        Y02752
         LA    NIPPMR02,NIPPMMBC          CONVERSION AREA       Y02752
         BALR  NIPPMR14,NIPPMR15          CALL CONVERT RTN      Y02752
**         RESTORE CSECT AND DSECT BASE REGISTERS               Y02752
*NIPPMRST  DS  0H                                               Y02752
NIPPMRST LM    NIPPMR02,NIPPMR13,NIPPMSAV-NIPPMRST(NIPPMR14)    Y02752
         BC    15,NIPPMSKP                SKIP SAVE AREA        Y02752
*NIPPMSAV  DS  0F                                               Y02752
NIPPMSAV DC    12F'0'                     DECLARE REG SAVE AREA Y02752
*NIPPMSKP DS  0H                                                Y02752
NIPPMSKP DS    0H                         RESUME EXECUTION      Y02752
*   IOBSEEK=NIPPMMBC;               /* RESET PARMLIB IOBSEEK TO THIS
*                                      MBBCCHHR                      */
         L     @10,NVTPAREA(,RNVT)                                 1429
         MVC   IOBSEEK+72(8,@10),NIPPMMBC                          1429
*   NIPPASID=NIPPMCCH;              /* RESET PARMLIB SEARCH ID TO  1430
*                                      THIS CCHHR                    */
         MVC   NIPPASID(5,@10),NIPPMCCH                            1430
*   IF NIPPMNAM=NIPPANAM            /* SEE IF MEM NAMES MATCH  Y02752*/
*     THEN                                                         1431
         CLC   NIPPMNAM(8),NIPPANAM(@10)                           1431
         BE    @RT01431                                            1431
*     GO TO NIPPMPRD;               /* YES- NEW VERSION- GO READ   1432
*                                                              Y02752*/
*   GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);               1433
          LM    NIPPMR02,NIPPMR01,NIPPMREG    RESTORE REGS      Y02752
*   GO TO NIPPMAD0;                 /* NORMAL RETURN TO CALLER Y02752*/
         L     @10,NIPPMADR                                        1434
         BR    @10                                                 1434
*NIPPMPER:                                                         1435
*   NIPPMME1=NIPPANAM;              /* MOVE MEMBER NAME TO I/O ERROR
*                                      MESSAGE                       */
*                                                                  1435
NIPPMPER LA    @10,NIPPMMB1                                        1435
         L     @09,NVTPAREA(,RNVT)                                 1435
         MVC   NIPPMME1(8,@10),NIPPANAM(@09)                       1435
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO I/O ERROR DURING BLDL MESSAGE                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1436
*   GENERATE REFS(NVTWTO) SETS(RPARM,REXIT,RENTRY);                1436
          IEAPMNIP TYPE=WTO,PARAM=NIPPMMS1 CALL WTO SERVICE ROUTINE
*   GO TO NIPPMPXT;                 /* ERROR RETURN TO CALLER        */
         B     NIPPMPXT                                            1437
*NIPPMPFN:                                                         1438
*   IF NIPPMNAM=NIPPANAM            /* SEE IF MEMBER NAMES MATCH   1438
*                                                              Y02752*/
*     THEN                                                         1438
NIPPMPFN L     @10,NVTPAREA(,RNVT)                                 1438
         CLC   NIPPMNAM(8),NIPPANAM(@10)                           1438
         BNE   @RF01438                                            1438
*     IF NIPPAFL1='1'B              /* YES- SUPPRESS MESSAGE?  Y02752*/
*       THEN                                                       1439
         L     @10,NP3CTAB                                         1439
         TM    NIPPAFL1(@10),B'10000000'                           1439
         BO    @RT01439                                            1439
*       GO TO NIPPMPXT;             /* YES- GO EXIT TO CALLER  Y02752*/
*     ELSE                                                         1441
*       ;                           /*                         Y02752*/
*   NIPPMME2=NIPPANAM;              /* MOVE MEMBER NAME TO NOT FOUND
*                                      MESSAGE                 Y02752*/
*                                                                  1442
@RF01438 LA    @10,NIPPMMB2                                        1442
         L     @09,NVTPAREA(,RNVT)                                 1442
         MVC   NIPPMME2(8,@10),NIPPANAM(@09)                       1442
*   /*****************************************************************/
*   /*                                                               */
*   /* WTO MEMBER NOT FOUND IN DATA SET MESSAGE                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1443
*   GENERATE REFS(NVTWTO) SETS(RPARM,REXIT,RENTRY);                1443
          IEAPMNIP TYPE=WTO,PARAM=NIPPMMS2 CALL WTO SERVICE ROUTINE
*NIPPMPXT:                                                         1444
*   IF NIPPMNAM=NIPPANAM            /* SEE IF NAMES MATCH      Y02752*/
*     THEN                                                         1444
NIPPMPXT L     @10,NVTPAREA(,RNVT)                                 1444
         CLC   NIPPMNAM(8),NIPPANAM(@10)                           1444
         BNE   @RF01444                                            1444
*     DO;                                                          1445
*       NIPPMNAM=NIPPMNAM&&NIPPMNAM;/* FORCE NEW NAME PATH ON NEXT 1446
*                                      ENTRY                   Y02752*/
         XC    NIPPMNAM(8),NIPPMNAM                                1446
*       NIPPMR01=NIPPMNEG;          /* SET NEGATIVE VALUE RC   Y02752*/
         L     NIPPMR01,NIPPMNEG                                   1447
*       GENERATE SETS(NIPPMR02,NIPPMR00) REFS(NIPPMREG);           1448
          LM    NIPPMR02,NIPPMR00,NIPPMREG    RESTORE REGS      Y02752
*       GO TO NIPPMAD0;             /* EXIT TO CALLER          Y02752*/
         L     @10,NIPPMADR                                        1449
         BR    @10                                                 1449
*     END;                          /*                         Y02752*/
*   GENERATE SETS(NIPPMR02,NIPPMR01) REFS(NIPPMREG);               1451
@RF01444 DS    0H                                                  1451
*                                                           /* Y02752*/
         LM    NIPPMR02,NIPPMR01,NIPPMREG     RESTORE REGS      Y02752
*   GO TO NIPPMAD4;                 /* READ ERROR - RETURN TO CALLER */
         L     @10,NIPPMADR                                        1452
         LA    @10,NIPPMAD4+4(,@10)                                1452
         BR    @10                                                 1452
*                                                                  1453
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO READ PARMLIB TEXT                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1453
*NIPPMTXT:                                                         1453
*   NIPPMADR=NIPPMR14;              /* SAVE CALLER'S RETURN ADDRESS  */
NIPPMTXT ST    NIPPMR14,NIPPMADR                                   1453
*   GENERATE REFS(NIPPMR02,NIPPMR01) SETS(NIPPMREG);               1454
         STM   NIPPMR02,NIPPMR01,NIPPMREG   SAVE CALLERS REGS
*NIPPMPRD:                                                         1455
*   NIPPAECB=NIPPAECB&&NIPPAECB;    /* ZERO WAIT ECB                 */
NIPPMPRD L     @10,NVTPAREA(,RNVT)                                 1455
         XC    NIPPAECB(4,@10),NIPPAECB(@10)                       1455
*   IOBSEEK(4:7)=NIPPASID;          /* FILL IN CCHH IN IOB           */
*                                                                  1456
         LA    @09,72                                              1456
         ALR   @09,@10                                             1456
         MVC   IOBSEEK+3(4,@09),NIPPASID(@10)                      1456
*   /*****************************************************************/
*   /*                                                               */
*   /* REINITIALIZE IOB FLAGS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1457
*   IOBFLAG1='42'X;                                                1457
         MVI   IOBFLAG1(@09),X'42'                                 1457
*   IOBFLAG2='00'X;                                                1458
         MVI   IOBFLAG2(@09),X'00'                                 1458
*   IOBFLAG3='00'X;                                                1459
         MVI   IOBFLAG3(@09),X'00'                                 1459
*   IOBERRCT='0000'X;                                              1460
         SLR   @07,@07                                             1460
         STH   @07,IOBERRCT(,@09)                                  1460
*   IOBCSW='00000000000000'X;                                      1461
         MVC   IOBCSW(7,@09),@CB02796                              1461
*   IOBSENS0='00'X;                                                1462
         MVI   IOBSENS0(@09),X'00'                                 1462
*   IOBSENS1='00'X;                                                1463
*                                                                  1463
         MVI   IOBSENS1(@09),X'00'                                 1463
*   /*****************************************************************/
*   /*                                                               */
*   /* READ PARMLIB TEXT RECORD                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1464
*   NIPPMR01=ADDR(NIPPAIOB);                                       1464
         LA    NIPPMR01,NIPPAIOB(,@10)                             1464
*   GENERATE;                                                      1465
          EXCP  (1)                 READ TEXT
*   NIPPMR01=ADDR(NIPPAECB);                                       1466
         L     NIPPMR01,NVTPAREA(,RNVT)                            1466
         LA    NIPPMR01,NIPPAECB(,NIPPMR01)                        1466
*   GENERATE;                                                      1467
*                                                                  1467
          WAIT  ECB=(1)                  AWAIT I/O COMPLETION
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR I/O ERROR AFTER PARMLIB READ                   Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1468
*   IF NIPPAECC='7F'X              /* SKIP IF READ SUCCESSFUL Y02752*/
*     THEN                                                         1468
         L     @10,NVTPAREA(,RNVT)                                 1468
         CLI   NIPPAECC(@10),X'7F'                                 1468
         BE    @RF01468                                            1468
*     DO;                                                          1469
*       IF NIPPMNAM=NIPPANAM        /* SEE IF MEMBER NAMES MATCH   1470
*                                                              Y02752*/
*         THEN                                                     1470
         CLC   NIPPMNAM(8),NIPPANAM(@10)                           1470
         BNE   @RF01470                                            1470
*         DO;                                                      1471
*                                                                  1471
*           /*********************************************************/
*           /*                                                       */
*           /* DOES THE I/O ERROR REPRESENT EOF                Y02752*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1472
*           IF NIPPAECC='41'X&      /* IOBCSW FIELD VALID?           */
*                                                                  1472
*           /*********************************************************/
*           /*                                                       */
*           /* FALL THROUGH IF UNIT EXCEPTION, CHANNEL END AND DEVICE*/
*           /* END FLAGS ARE ON IN THE IOBCSW                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1472
*               (NIPPMCS2|NIPPMMK1)='FF'X THEN                     1472
         CLI   NIPPAECC(@10),X'41'                                 1472
         BNE   @RF01472                                            1472
         MVC   @TS00001(1),NIPPMCS2+81(@10)                        1472
         OC    @TS00001(1),NIPPMMK1                                1472
         CLI   @TS00001,X'FF'                                      1472
         BNE   @RF01472                                            1472
*             DO;                                                  1473
*               NIPPARC=16;         /* INDICATE EOF CONDITION  Y02752*/
         MVC   NIPPARC(4,@10),@CF00173                             1474
*               GOTO NIPPMPXT;      /* RETURN TO CALLER        Y02752*/
         B     NIPPMPXT                                            1475
*             END;                  /*                         Y02752*/
*                                                                  1476
*           /*********************************************************/
*           /*                                                       */
*           /* DOES THE I/O ERROR REPRESENT END OF CYL?      @ZA07472*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1477
*           IF NIPPAECC='41'X&      /*                       @ZA07472*/
*               (NIPPMCS2|NIPPMMK2)='FF'X&/*                 @ZA07472*/
*               (IOBSENS1&NIPPMMK3)='20'X THEN/*             @ZA07472*/
*                                                                  1477
@RF01472 L     @10,NVTPAREA(,RNVT)                                 1477
         CLI   NIPPAECC(@10),X'41'                                 1477
         BNE   @RF01477                                            1477
         MVC   @TS00001(1),NIPPMCS2+81(@10)                        1477
         OC    @TS00001(1),NIPPMMK2                                1477
         CLI   @TS00001,X'FF'                                      1477
         BNE   @RF01477                                            1477
         MVC   @TS00001(1),IOBSENS1+72(@10)                        1477
         NC    @TS00001(1),NIPPMMK3                                1477
         CLI   @TS00001,X'20'                                      1477
         BNE   @RF01477                                            1477
*             /*******************************************************/
*             /*                                                     */
*             /* IF YES, MAKE SEEK ADDRESS POINT TO START OF NEXT    */
*             /* CYLINDER                                    @ZA07472*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1478
*             DO;                   /*                       @ZA07472*/
*               NIPPMCC=NIPPMCC+1;  /* INCREMENT SEEK@ TO NEXT CYL,
*                                                            @ZA07472*/
         AH    @10,@CH02864                                        1479
         LA    @09,1                                               1479
         AH    @09,NIPPMCC(,@10)                                   1479
         STH   @09,NIPPMCC(,@10)                                   1479
*               NIPPMHH=NIPPMHH&&NIPPMHH;/* HEAD 0,          @ZA07472*/
         XC    NIPPMHH(2,@10),NIPPMHH(@10)                         1480
*               NIPPMR='01'X;       /* AND RECORD 1          @ZA07472*/
         MVI   NIPPMR(@10),X'01'                                   1481
*               GOTO NIPPMRCR;      /* CONTINUE TO PROCESS TEXT    1482
*                                                            @ZA07472*/
         B     NIPPMRCR                                            1482
*             END;                  /*                       @ZA07472*/
*         END;                      /*                         Y02752*/
*       GOTO NIPPMTER;              /* INDICATE I/O ERROR      Y02752*/
         B     NIPPMTER                                            1485
*     END;                          /*                         Y02752*/
*   RESPECIFY                                                      1487
*     NIPPMBYT BASED(NIPPMR01);                                    1487
@RF01468 DS    0H                                                  1488
*NIPPMRCR:                          /*                       @ZA07472*/
*   NIPPMR01=ADDR(NIPPARCD);        /* R1 = ADDR OF TEXT RECORD READ
*                                      IN                            */
*                                                                  1488
NIPPMRCR L     NIPPMR01,NVTPAREA(,RNVT)                            1488
         LA    NIPPMR01,NIPPARCD(,NIPPMR01)                        1488
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN THROUGH LEADING BLANK CHARACTERS                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1489
*   NIPPMBUF(73:73)='FF'X;          /* PLACE 'FF'X IN COL 73         */
         MVI   NIPPMBUF+72(NIPPMR01),X'FF'                         1489
*   NIPPMKPR=1;                     /* COUNT STARTS AT ONE           */
         MVC   NIPPMKPR(4),@CF00034                                1490
*                                                                  *SKV
         CLI   NIPPMBYT(NIPPMR01),C'*' A COMMENT LINE?             *SKV
         BE    SKVCONT1                YES - BYPASS CONTENTS CHECK *SKV
*                                                                  *SKV
*NIPPMPBK:                                                         1491
*   IF NIPPMBYT=' '                 /* IS THIS CHAR BLANK            */
*     THEN                          /* YES - CHECK NEXT CHAR         */
NIPPMPBK CLI   NIPPMBYT(NIPPMR01),C' '                             1491
         BNE   @RF01491                                            1491
*     DO;                                                          1492
*       NIPPMR01=NIPPMR01+1;        /* POINT TO NEXT CHAR      Y02752*/
         LA    @10,1                                               1493
         ALR   NIPPMR01,@10                                        1493
*       NIPPMKPR=NIPPMKPR+1;        /* INCREMENT COUNTER       Y02752*/
         AL    @10,NIPPMKPR                                        1494
         ST    @10,NIPPMKPR                                        1494
*       IF NIPPMKPR=72              /* ARE FIRST 71 CHARS BLANK    1495
*                                                              Y02752*/
*         THEN                      /* YES-CHECK FOR CONTINUATION    */
         CH    @10,@CH02808                                        1495
         BNE   @RF01495                                            1495
SKVCONT1 EQU   *                                                   *SKV
*         DO;                                                      1496
*           IF NIPPMBYT=' '        /* IS 72'ND CHAR BLK             */
*             THEN                  /* NO - INDICATES CONTINUATION   */
         CLI   NIPPMBYT(NIPPMR01),C' '                             1497
         BNE   @RT01497                                            1497
*             GO TO NIPPMPRD;       /* READ NEXT RECORD              */
*           ELSE                    /* 72ND IS BLANK - NO          1499
*                                      CONTINUATION                  */
*             GO TO NIPPMTND;       /* REG 1 POINTS TO 72ND BLANK. 1499
*                                      NORMAL RETURN TO CALLER       */
         B     NIPPMTND                                            1499
*         END;                                                     1500
*       ELSE                                                       1501
*         GO TO NIPPMPBK;           /* COUNT IS NOT 72 YET- GO CHECK
*                                      NEXT CHAR                     */
*     END;                                                         1502
*   ELSE                            /* FIRST 71 CHARS ARE NOT        */
*     DO;                           /* BLANK                         */
@RF01491 DS    0H                                                  1504
*       NIPPMKPR=NIPPMR01-NIPPMKPR+72;/* POINT TO 72'ND BYTE   Y02752*/
         LR    @10,NIPPMR01                                        1504
         SL    @10,NIPPMKPR                                        1504
         AH    @10,@CH02808                                        1504
         ST    @10,NIPPMKPR                                        1504
*       RESPECIFY                                                  1505
*         NIPPMBYT BASED(NIPPMKPR); /*                         Y02752*/
*       NIPPMBYT=' ';               /* INSURE BLANK AT END BY SETTING
*                                      72'ND BYTE TO BLK             */
         MVI   NIPPMBYT(@10),C' '                                  1506
*     END;                                                         1507
*   GENERATE REFS(NIPPMREG) SETS(NIPPMR02,NIPPMR00);               1508
*                                                                /*
*NIPPMTND  DS  0H                                               Y02752
NIPPMTND LM    NIPPMR02,NIPPMR00,NIPPMREG     RESTORE CALLERS REGS
*   GO TO NIPPMAD0;                 /* NORMAL RETURN TO CALLER       */
         L     @10,NIPPMADR                                        1509
         BR    @10                                                 1509
*NIPPMTER:                                                         1510
*   NIPPMR01=ADDR(NIPPAIOB);        /* R1 = ADDR OF PARMLIB IOB      */
*                                                                  1510
NIPPMTER L     NIPPMR01,NVTPAREA(,RNVT)                            1510
         LA    NIPPMR01,NIPPAIOB(,NIPPMR01)                        1510
*   /*****************************************************************/
*   /*                                                               */
*   /* NIPSENSE - FORMAT AND WRITE I/O ERROR MESSAGE                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1511
*   GENERATE REFS(NVTSENSE,NIPPMR01) SETS(RPARM,REXIT,RENTRY);     1511
         IEAPMNIP TYPE=SENSE,PARAM=NIPPMR01
*   NIPPARC=12;                     /* SET RETURN CODE TO 12   Y02752*/
         L     @10,NVTPAREA(,RNVT)                                 1512
         MVC   NIPPARC(4,@10),@CF00036                             1512
*   IF NIPPMNAM=NIPPANAM            /* SEE IF MEMBER NAMES MATCH   1513
*                                                              Y02752*/
*     THEN                                                         1513
         CLC   NIPPMNAM(8),NIPPANAM(@10)                           1513
         BE    @RT01513                                            1513
*     GO TO NIPPMPXT;               /* YES-TAKE NEW VERSION EXIT   1514
*                                                              Y02752*/
*   GENERATE REFS(NIPPMREG) SETS(NIPPMR01,NIPPMR02);               1515
         LM    NIPPMR02,NIPPMR01,NIPPMREG     RESTORE CALLERS REGS
*   GO TO NIPPMAD4;                 /* READ ERROR - RETURN TO CALLER
*                                      + 4                           */
         L     @10,NIPPMADR                                        1516
         LA    @10,NIPPMAD4+4(,@10)                                1516
         BR    @10                                                 1516
*   RESPECIFY                                                      1517
*    (NIPPMR01,                                                    1517
*     NIPPMR00,                                                    1517
*     NIPPMR14,                                                    1517
*     NIPPMR15)                     /*                         Y02752*/
*         UNRESTRICTED;                                            1517
*                                                                  1517
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO PARAMETER LISTS FOR MESSAGES                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1518
*   GENERATE DATA;                                                 1518
*                                                                  1518
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERATED MACRO PARAMETER LISTS FOR INTERFACE BRANCHES        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1519
*   GENERATE DATA;                                                 1519
*                                                                  1520
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE PARAMETER LIST AREA                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1520
*   GENERATE DATA;                                                 1520
*                                                                  1521
*   /*****************************************************************/
*   /*                                                               */
*   /* THE NP3MATCH ROUTINE COMPARES THE LIST OF VALID         Y02752*/
*   /* PARAMETERS TO THE DATA ADDRESED BY SCANREG.             Y02752*/
*   /* RETURN CODES: MATCH FOUND - 0                           Y02752*/
*   /* NO MATCH - 4                                            Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1521
*NP3MATCH:                          /*                         Y02752
*                                                              Y02752*/
*   RESPECIFY                                                      1521
*    (SYMBLREG,                                                    1521
*     OFFSTREG,                                                    1521
*     RNVT,                                                        1521
*     SCANREG) RESTRICTED;          /*                         Y02752*/
NP3MATCH DS    0H                                                  1522
*   RESPECIFY                                                      1522
*     NP3SCAN5 BASED(SCANREG);      /*                         Y02752*/
*   RESPECIFY                                                      1523
*     OPLIBENT BASED(NP3CENT);      /*                         Y02752*/
*                                                                  1523
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTRY POINT TO SYMBOL TAB SCAN                          Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1524
*   NP3MSAVR=REXIT;                 /* SAVE RETURN ADDR        Y02752*/
         ST    REXIT,NP3MSAVR                                      1524
*   INDXELMT=0;                     /* INIT INDEX              Y02752*/
*                                                                  1525
         MVI   INDXELMT,X'00'                                      1525
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE OFFSET TO SYMBOL TABLE                        Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1526
*NP3OFST:                                                          1526
*   OFFSTREG=INDXELMT*LENGTH(SYMBSTRT);/*                      Y02752
*                                                              Y02752*/
*                                                                  1526
NP3OFST  SLR   OFFSTREG,OFFSTREG                                   1526
         IC    OFFSTREG,INDXELMT                                   1526
         SLA   OFFSTREG,3                                          1526
*   /*****************************************************************/
*   /*                                                               */
*   /* SET BASE ADDRESS OF SYMBOL IN SYMBOL TABLE FOR VALIDITY CHECK */
*   /* ON PARAMETER                                            Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1527
*   SYMBLREG=OFFSTREG+ADDR(NP3SYMBL);/*                        Y02752
*                                                              Y02752*/
         LA    SYMBLREG,NP3SYMBL                                   1527
         ALR   SYMBLREG,OFFSTREG                                   1527
*   IF SYMBLREG>=ADDR(SYMBEND) THEN                                1528
         LA    @10,SYMBEND                                         1528
         CR    SYMBLREG,@10                                        1528
         BL    @RF01528                                            1528
*     DO;                                                          1529
*       RENTRY=4;                   /* INDICATE NO MATCH     @Y30LPXD*/
*                                                                  1530
         LA    RENTRY,4                                            1530
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE SLN TO LENGTH OF INVALID CHARACTER STRING  @Y30LPXD*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1531
*       DO SLN=0 TO 7 BY 1 WHILE NP3SCANR='''';/*           @Y30LPXD*/
         SLR   @10,@10                                             1531
         STC   @10,SLN                                             1531
@DL01531 CLI   NP3SCANR(SCANREG),C''''                             1531
         BE    @DC01531                                            1531
*         SCANREG=SCANREG+1;        /* UPDATE NP3SCANR BASE TO NEXT
*                                      CHARACTER             @Y30LPXD*/
         LA    SCANREG,1(,SCANREG)                                 1532
*       END;                                                       1533
         AL    @10,@CF00034                                        1533
         STC   @10,SLN                                             1533
         CH    @10,@CH00168                                        1533
         BNH   @DL01531                                            1533
@DC01531 DS    0H                                                  1534
*       SCANREG=SCANREG-SLN;        /* RESET SCANREG         @Y30LPXD*/
         SLR   @10,@10                                             1534
         IC    @10,SLN                                             1534
         SLR   SCANREG,@10                                         1534
*       GO TO NP3MSAVR;             /* RETURN TO CALLER      @Y30LPXD*/
         L     @10,NP3MSAVR                                        1535
         BR    @10                                                 1535
*     END;                                                         1536
*                                                                  1536
*   /*****************************************************************/
*   /*                                                               */
*   /* SET SYMBOL LENGTH VALUE TO MAXIMUM MINUS ONE(1)       @Y30LPXD*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1537
*   SLN=LENGTH(SYMBSTRT)-1;         /*                       @Y30LPXD
*                                                              Y02752*/
*                                                                  1537
@RF01528 LA    @10,7                                               1537
         STC   @10,SLN                                             1537
*   /*****************************************************************/
*   /*                                                               */
*   /* SET MAPPING BASE ADDRESS TO LENGTH ELEMENT IN CURRENT SYMBOL  */
*   /* TABLE ENTRY                                             Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1538
*   NP3SYMLN=SYMBLREG+SLN;          /*                         Y02752
*                                                              Y02752*/
*                                                                  1538
         ALR   @10,SYMBLREG                                        1538
         ST    @10,NP3SYMLN                                        1538
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECKS FOR SYMBOL LENGTH. IF GREATER THAN 7,THEN SYMBOL LENGTH*/
*   /* VALUE IS SET TO 8. ELSE, SYMBOL LENGTH                  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1539
*   IF NP3LCHAR>SLN                 /* IS SYMBOL LENGTH GREATER THAN
*                                      7                       Y02752*/
*     THEN                          /* YES,LENGTH GREATER THEN 7   1539
*                                                              Y02752*/
         CLC   NP3LCHAR(1,@10),SLN                                 1539
         BNH   @RF01539                                            1539
*     SLN=LENGTH(SYMBSTRT);         /* SET MAXIMUM LENGTH      Y02752*/
         MVI   SLN,X'08'                                           1540
*   ELSE                            /* NO, LENGTH NOT GREATER THEN 7
*                                                              Y02752*/
*     SLN=NP3LCHAR;                 /* SET LENGTH TO SYMBOL LENGTH 1541
*                                                              Y02752*/
*                                                                  1541
         B     @RC01539                                            1541
@RF01539 L     @10,NP3SYMLN                                        1541
         MVC   SLN(1),NP3LCHAR(@10)                                1541
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SYMBOL IN SYMBOL TABLE EQUAL TO PARAMETER     Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1542
*   IF NP3TABSB(1:SLN)=NP3SCAN5(1:SLN)/* ARE SYMBOLS EQUAL   @Y30LPXD*/
*     THEN                                                         1542
@RC01539 SLR   @10,@10                                             1542
         IC    @10,SLN                                             1542
         BCTR  @10,0                                               1542
         EX    @10,@SC02880                                        1542
         BNE   @RF01542                                            1542
*     DO;                                                          1543
*       RENTRY=0;                   /* INDICATE MATCH        @Y30LPXD*/
         SLR   RENTRY,RENTRY                                       1544
*       GOTO NP3MSAVR;              /* RETURN TO CALLER      @Y30LPXD*/
         L     @10,NP3MSAVR                                        1545
         BR    @10                                                 1545
*     END;                                                         1546
*   INDXELMT=1                      /* UPDATE INDEX FOR NEXT SYMBOL
*                                                            @Y30LPXD*/
*       +INDXELMT;                                                 1547
@RF01542 IC    @10,INDXELMT                                        1547
         LA    @10,1(,@10)                                         1547
         STC   @10,INDXELMT                                        1547
*   GOTO NP3OFST;                   /* ATTEMP ANOTHER MATCH  @Y30LPXD*/
         B     NP3OFST                                             1548
*                                                                  1549
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE MOVES THE ENTRIES IN THE TEMPORARY         Y02752*/
*   /* PARMTAB INTO THE PARAMETER TABLE USED BY THE RIM'S            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1549
*NPMOVEP:                                                          1549
*   RESPECIFY                                                      1549
*    (RNVT,                                                        1549
*     SCANREG,                                                     1549
*     PLIBREG,                                                     1549
*     COUNTREG) RESTRICTED;         /*                         Y02752*/
NPMOVEP  DS    0H                                                  1550
*   RESPECIFY                                                      1550
*    (PARMREG) RESTRICTED;                                         1550
*   RESPECIFY                                                      1551
*     NIPPAHDR BASED(PARMPTR);                                     1551
*   RESPECIFY                                                      1552
*     NIPPAREA BASED(PARMPTR);                                     1552
*   RESPECIFY                                                      1553
*     OPLIBENT BASED(PLIBREG);                                     1553
*   NPMSAVE=REXIT;                  /* SAVE RETURN ADDR        Y02752*/
         ST    REXIT,NPMSAVE                                       1554
*   STRINGSZ=ORLN+CONTLN+LENGTH('''');/* GET LENGTH OF PARM STRING +
*                                      QUOTE                   Y02752*/
*                                                                  1555
         SLR   @10,@10                                             1555
         ICM   @10,3,ORLN(PLIBREG)                                 1555
         SLR   @05,@05                                             1555
         ICM   @05,3,CONTLN(PLIBREG)                               1555
         ALR   @10,@05                                             1555
         LA    @10,1(,@10)                                         1555
         STH   @10,STRINGSZ                                        1555
*   /*****************************************************************/
*   /*                                                               */
*   /* WILL THE PARM STRING FIT IN THIS PARMAREA'S FREE SPACE  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1556
*FREEAREA:                                                         1556
*   IF STRINGSZ>ADDR(NIPPAREA)+2048-NIPPABYT THEN/* NO - TRY NEXT  1556
*                                      PARMAREA                Y02752*/
FREEAREA L     @10,PARMPTR                                         1556
         LA    @05,2048                                            1556
         ALR   @05,@10                                             1556
         SL    @05,NIPPABYT(,@10)                                  1556
         SLR   @15,@15                                             1556
         ICM   @15,3,STRINGSZ                                      1556
         CR    @05,@15                                             1556
         BNL   @RF01556                                            1556
*     DO;                                                          1557
*       IF NIPPAQ=0                 /* IS THERE ANOTHER PARMAREA ON
*                                      THE QUEUE               Y02752*/
*         THEN                                                     1558
         ICM   @05,15,NIPPAQ(@10)                                  1558
         BNZ   @RF01558                                            1558
*         CALL NP3PAGM;             /* N0 - FREE AREA NOT FOUND GET
*                                      ANOTHER PARMAREA        Y02752*/
         BAL   @14,NP3PAGM                                         1559
*       PARMPTR=NIPPAQ;             /* POINT TO NEXT PARMAREA  Y02752*/
@RF01558 L     @10,PARMPTR                                         1560
         L     @10,NIPPAQ(,@10)                                    1560
         ST    @10,PARMPTR                                         1560
*       GO TO FREEAREA;             /* CHECK FREE AREA         Y02752*/
         B     FREEAREA                                            1561
*     END;                          /*                         Y02752*/
*   NIPPTADR=NIPPABYT;              /* SET START ADRRESS OF PARMAREA
*                                      PARAMETERS IN PARMTAB   Y02752*/
@RF01556 L     @10,PARMPTR                                         1563
         MVC   NIPPTADR(4,PARMREG),NIPPABYT(@10)                   1563
*   RESPECIFY                                                      1564
*     NP3SCAN5 BASED(ADPTR);        /*                         Y02752*/
*   RESPECIFY                                                      1565
*     MSGBUFF BASED(NIPPABYT);      /*                         Y02752*/
*   ADPTR=ORAD;                     /* POINT TO PLIBTAB PARMETER   1566
*                                      STRING ORGIN            Y02752*/
         MVC   ADPTR(4),ORAD(PLIBREG)                              1566
*   STRINGSZ=ORLN;                  /* SET PARM STRING LENGTH      1567
*                                      (WITHOUT CONTINUATION)  Y02752*/
         MVC   STRINGSZ(2),ORLN(PLIBREG)                           1567
*   CONTDONE='0'B;                  /* SET CONT SWITCH TO ZERO Y02752*/
         NI    CONTDONE,B'11111110'                                1568
*NP3NULL:                                                          1569
*   IF NP3SCANR='FF'X              /* IS THIS CHAR X'FF'      Y02752*/
*     THEN                          /* N0 - MOVE CHAR TO PARMTAB   1569
*                                                              Y02752*/
NP3NULL  L     @10,ADPTR                                           1569
         CLI   NP3SCANR(@10),X'FF'                                 1569
         BE    @RF01569                                            1569
*     DO;                                                          1570
*       MSGBUFF1=NP3SCANR;          /* MOVE PARAMETER FROM PLIBTAB TO
*                                      PARMTAB                 Y02752*/
         L     @05,PARMPTR                                         1571
         L     @15,NIPPABYT(,@05)                                  1571
         MVC   MSGBUFF1(1,@15),NP3SCANR(@10)                       1571
*       NIPPABYT=NIPPABYT+1;        /* POINT TO NEXT BYTE IN PARMTAB
*                                                              Y02752*/
         LA    @14,1                                               1572
         ALR   @15,@14                                             1572
         ST    @15,NIPPABYT(,@05)                                  1572
*       ADPTR=ADPTR+1;              /* POINT TO NEXT BYTE IN PLIBTAB
*                                                              Y02752*/
         ALR   @10,@14                                             1573
         ST    @10,ADPTR                                           1573
*       STRINGSZ=STRINGSZ-1;        /* DECREMENT STRING BY ONE Y02752*/
         SLR   @10,@10                                             1574
         ICM   @10,3,STRINGSZ                                      1574
         BCTR  @10,0                                               1574
         STH   @10,STRINGSZ                                        1574
*       IF STRINGSZ=0               /* IF ALL OF STRING HAS BEEN   1575
*                                                              Y02752*/
*         THEN                      /* MOVED, GO CHECK FOR CONT    1575
*                                                              Y02752*/
         LTR   @10,@10                                             1575
         BZ    @RT01575                                            1575
*         GO TO CONTCHK;                                           1576
*       ELSE                                                       1577
*         GO TO NP3NULL;            /* OTHERWISE,CHECK NEXT CHAR   1577
*                                                              Y02752*/
         B     NP3NULL                                             1577
*     END;                                                         1578
*   ELSE                            /* CHAR IS NULL (X'FF')    Y02752*/
*     DO;                           /* SKIP NULL CHAR AND DO   Y02752*/
@RF01569 DS    0H                                                  1580
*       ADPTR=ADPTR+1;              /* NOT MOVE TO PARMTAB     Y02752*/
         LA    @10,1                                               1580
         AL    @10,ADPTR                                           1580
         ST    @10,ADPTR                                           1580
*       STRINGSZ=STRINGSZ-1;        /* DECREMENT SIZE          Y02752*/
         SLR   @10,@10                                             1581
         ICM   @10,3,STRINGSZ                                      1581
         BCTR  @10,0                                               1581
         STH   @10,STRINGSZ                                        1581
*       GO TO NP3NULL;              /* GO CHECK NEXT CHAR      Y02752*/
         B     NP3NULL                                             1582
*     END;                          /*                         Y02752*/
*CONTCHK:                                                          1584
*   IF CONTDONE='1'B               /* HAS CONTINUATION BEEN MOVED 1584
*                                                              Y02752*/
*     THEN                                                         1584
CONTCHK  TM    CONTDONE,B'00000001'                                1584
         BO    @RF01584                                            1584
*     DO;                           /* NO - CHECK FOR CONTINUAT    1585
*                                                              Y02752*/
*       IF CONTAD=0                /* NO - IS THERE CINTINUAT Y02752*/
*         THEN                      /* YES - MOVE CONT         Y02752*/
         L     @10,CONTAD(,PLIBREG)                                1586
         LTR   @10,@10                                             1586
         BZ    @RF01586                                            1586
*         DO;                                                      1587
*           CONTDONE='1'B;          /* INDICATE CONTINUATION IS BEING
*                                      MOVED                   Y02752*/
         OI    CONTDONE,B'00000001'                                1588
*           ADPTR=CONTAD;           /* SET BASE TO CONT STRING Y02752*/
         ST    @10,ADPTR                                           1589
*           STRINGSZ=CONTLN;        /* SET CONT STRING LENGTH  Y02752*/
         MVC   STRINGSZ(2),CONTLN(PLIBREG)                         1590
*           GO TO NP3NULL;          /* GO DO THE MOVE          Y02752*/
         B     NP3NULL                                             1591
*         END;                      /*                         Y02752*/
*     END;                          /*                         Y02752*/
*                                                                  1593
@RF01586 DS    0H                                                  1594
*   /*****************************************************************/
*   /*                                                               */
*   /* EITHER THERE WAS NO CONTINUATION OR THE CONTINUATION    Y02752*/
*   /* HAS BEEN MOVED                                          Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1594
*   MSGBUFF1=QUOTE;                 /* ADD QUOTE TO END OF PARAMETER
*                                      STRING                  Y02752*/
@RF01584 L     @10,PARMPTR                                         1594
         L     @05,NIPPABYT(,@10)                                  1594
         MVC   MSGBUFF1(1,@05),QUOTE                               1594
*   NIPPABYT=NIPPABYT+1;            /* UPDATE NEXT AVAILABLE BYT   1595
*                                                              Y02752*/
*                                                                  1595
         AL    @05,@CF00034                                        1595
         ST    @05,NIPPABYT(,@10)                                  1595
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR NULL REPLY Y02752                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1596
*   IF NIPPTADR=0 THEN                                            1596
         L     @10,NIPPTADR(,PARMREG)                              1596
         LTR   @10,@10                                             1596
         BZ    @RF01596                                            1596
*     DO;                                                          1597
*                                                                  1597
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR LIST OPTION ONLY REPLY Y02752                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1598
*       IF NIPPTADR->NP3SCAN8(1:3)='()''' THEN                     1598
         CLC   NP3SCAN8(3,@10),@CC02828                            1598
         BNE   @RF01598                                            1598
*         DO;                                                      1599
*                                                                  1599
*           /*********************************************************/
*           /*                                                       */
*           /* PROMPT IN NIP PROMPT MODE IF ERROR OPTION NOT         */
*           /* SPECIFIED                                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1600
*           IF NVTSYSP='1'B&NPEPRMT='0'B THEN                      1600
         TM    NVTSYSP(RNVT),B'01000000'                           1600
         BNO   @RF01600                                            1600
         TM    NPEPRMT,B'10000000'                                 1600
         BNZ   @RF01600                                            1600
*             RETCODE=4;                                           1601
         MVC   RETCODE(4),@CF00371                                 1601
*           ELSE                                                   1602
*             DO;                   /* NORMAL EOB PROCESSING   Y02752*/
         B     @RC01600                                            1602
@RF01600 DS    0H                                                  1603
*               NIPPTCAN='1'B;      /* SET CANCEL FLAG         Y02752*/
         OI    NIPPTCAN(PARMREG),B'00100000'                       1603
*               NIPPTADR=NIPPTADR&&NIPPTADR;/* ZERO ENTRY ADDR Y02752*/
         L     @10,NIPPTADR(,PARMREG)                              1604
         LR    @05,@10                                             1604
         XR    @05,@10                                             1604
         ST    @05,NIPPTADR(,PARMREG)                              1604
*             END;                  /*                         Y02752*/
*         END;                      /*                         Y02752*/
@RC01600 DS    0H                                                  1607
*     END;                          /*                         Y02752*/
@RF01598 DS    0H                                                  1608
*   GO TO NPMSAVE;                  /* RETURN TO CALLER        Y02752*/
@RF01596 L     @10,NPMSAVE                                         1608
         BR    @10                                                 1608
*                                                                  1609
*   /*****************************************************************/
*   /*                                                               */
*   /* NIP PROMPT CONTROL ROUTINE                              Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1609
*NPRMTRA3:                                                         1609
*   RESPECIFY                                                      1609
*    (RNVT,                                                        1609
*     RPARM,                                                       1609
*     SCANREG) RESTRICTED;          /*                         Y02752*/
NPRMTRA3 DS    0H                                                  1610
*   NP3RTNR=REXIT;                  /* SAVE RETURN ADDR        Y02752*/
         ST    REXIT,NP3RTNR                                       1610
*   IF RPARMNEG<0                   /* RPARM COMPLEMEMTED BY IEAPMNIP
*                                      MACRO CODE FOR OPT = ERROR  1611
*                                      PROCESSING              Y02752*/
*     THEN                                                         1611
         LTR   RPARMNEG,RPARMNEG                                   1611
         BNM   @RF01611                                            1611
*     DO;                                                          1612
*       RPARMNEG=-RPARMNEG;         /* COMPLEMENT RPARM        Y02752*/
         LCR   RPARMNEG,RPARMNEG                                   1613
*       NPEPRMT='1'B;               /* TURN ON ERROR MODE INDICATOR
*                                                              Y02752*/
         OI    NPEPRMT,B'10000000'                                 1614
*     END;                                                         1615
*   ELSE                                                           1616
*     NPEPRMT='0'B;                 /* ZERO ERROR MODE INDICATOR   1616
*                                                              Y02752*/
         B     @RC01611                                            1616
@RF01611 NI    NPEPRMT,B'01111111'                                 1616
*   NPTPARM=NP3SCAN8;               /* MOVE INPUT PARM INTO WORK AREA
*                                                              Y02752*/
@RC01611 MVC   NPTPARM(8),NP3SCAN8(RPARM)                          1617
*   SCANREG=ADDR(NPTPARM);          /* SET UP NP3SCANR BASE    Y02752*/
         LA    SCANREG,NPTPARM                                     1618
*   RESPECIFY                                                      1619
*     NP3SCAN5 BASED(SCANREG);      /* NP3SCANR BASE           Y02752*/
*                                                                  1619
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE LAST CHAR OF INPUT PARM                          Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1620
*   DO I=8 TO 1 BY-1 WHILE NP3SCANR=' ';                          1620
         LA    @10,8                                               1620
         STH   @10,I                                               1620
@DL01620 CLI   NP3SCANR(SCANREG),C' '                              1620
         BE    @DC01620                                            1620
*     SCANREG=SCANREG+1;            /* INCREMENT NP3SCANR BASE Y02752*/
         LA    SCANREG,1(,SCANREG)                                 1621
*   END;                            /*                         Y02752*/
*                                                                  1622
         BCTR  @10,0                                               1622
         STH   @10,I                                               1622
         LTR   @10,@10                                             1622
         BP    @DL01620                                            1622
@DC01620 DS    0H                                                  1623
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER IF THE PARM IS EIGHT CHARACTERS LONG AND THE */
*   /* LAST CHARACTER IS NOT AN EQUAL SIGN                     Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1623
*   IF I<1 THEN                                                   1623
         LH    @10,I                                               1623
         CH    @10,@CH00034                                        1623
         BL    @RF01623                                            1623
*     NP3SCANR='=';                                                1624
         MVI   NP3SCANR(SCANREG),C'='                              1624
*   ELSE                                                           1625
*     DO;                                                          1625
         B     @RC01623                                            1625
@RF01623 DS    0H                                                  1626
*       SCANREG=SCANREG-1;          /* BACK UP TO LAST VALID CHAR  1626
*                                                              Y02752*/
*                                                                  1626
         BCTR  SCANREG,0                                           1626
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO CALLER INDICATING INVALID INPUT           Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1627
*       IF NP3SCANR='=' THEN                                      1627
         CLI   NP3SCANR(SCANREG),C'='                              1627
         BE    @RF01627                                            1627
*         DO;                                                      1628
*           NP3SAV1='FFFFFFFF'X;    /* NEGATIVE RPARM RETURN   Y02752*/
         MVC   NP3SAV1(4),@CF02726                                 1629
*           GOTO NP3RTNR;           /* RETURN TO CALLER        Y02752*/
         L     @10,NP3RTNR                                         1630
         BR    @10                                                 1630
*         END;                      /*                         Y02752*/
*     END;                          /*                         Y02752*/
@RF01627 DS    0H                                                  1633
*   NP3SAV1=0;                      /* RPARM ZERO ON NORMAL RETURN 1633
*                                                              Y02752*/
@RC01623 SLR   @10,@10                                             1633
         ST    @10,NP3SAV1                                         1633
*   NP3SCANR='=';                   /* PLACE = SIGN IN WORKAREA    1634
*                                                              Y02752*/
         MVI   NP3SCANR(SCANREG),C'='                              1634
*   SCANREG=ADDR(NPTPARM);          /* NPMATCH INPUT PARAMETER Y02752*/
         LA    SCANREG,NPTPARM                                     1635
*   CALL NP3MATCH;                  /* MATCH INPUT PARAMETER AGAINST
*                                      THE LIST OF VALID SYSTEM    1636
*                                      PARAMETER NAMES         Y02752*/
*                                                                  1636
         BAL   @14,NP3MATCH                                        1636
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID INPUT PARM PROCESSING                           Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1637
*   IF RENTRY=0|                   /* MATCH FOUND IF RTN CODE IS 0
*                                                              Y02752*/
*       NPTPARM(1:4)=NP3OPI(1:4)    /* OPI PROMPT INVALID      Y02752*/
*     THEN                                                         1637
         LTR   RENTRY,RENTRY                                       1637
         BNZ   @RT01637                                            1637
         CLC   NPTPARM(4),NP3OPI                                   1637
         BNE   @RF01637                                            1637
@RT01637 DS    0H                                                  1638
*     DO;                                                          1638
*       NP3SAV1='FFFFFFFF'X;        /* NEGATIVE RPARM INDICATES    1639
*                                      INVALID INPUT PARAMETER Y02752*/
         MVC   NP3SAV1(4),@CF02726                                 1639
*       GO TO NP3RTNR;              /* RETURN TO CALLER        Y02752*/
         L     @10,NP3RTNR                                         1640
         BR    @10                                                 1640
*     END;                          /*                         Y02752*/
*   RESPECIFY                                                      1642
*     NIPPTE BASED(NP3NPPRM);       /*                         Y02752*/
@RF01637 DS    0H                                                  1643
*   RESPECIFY                                                      1643
*     PARMTAB BASED(NVTPTAB);       /*                         Y02752*/
*   NP3NPPRM=NVTPTAB+               /* CALCULATE ADDR OF PARM TAB  1644
*                                      ENTRY                   Y02752*/
*       INDXELMT*LENGTH(PTABSTRT);  /* CALCULATE OFF- SET INTO     1644
*                                      PARMTAB                 Y02752*/
         SLR   @10,@10                                             1644
         IC    @10,INDXELMT                                        1644
         SLA   @10,3                                               1644
         AL    @10,NVTPTAB(,RNVT)                                  1644
         ST    @10,NP3NPPRM                                        1644
*   IF NPTPARM(1:4)=NP3PAGE(1:4) THEN/* SECOND PAGE ENTRY FOR      1645
*                                      OPERATOR SPECIFIED PARM Y02752*/
         CLC   NPTPARM(4),NP3PAGE                                  1645
         BNE   @RF01645                                            1645
*     NP3NPPRM=NP3NPPRM+LENGTH(PTABSTRT);/*                    Y02752*/
         AL    @10,@CF00156                                        1646
         ST    @10,NP3NPPRM                                        1646
*   NP3NPSBL=ADDR(SYMBSTRT)+        /* CALCULATE ADDR SYMBLE TABLE 1647
*                                      ENTRY                   Y02752*/
*       INDXELMT*LENGTH(SYMBSTRT);  /* CALCULATE OFFSET INTO SYMBLE
*                                      TABLE                   Y02752*/
@RF01645 LA    @10,SYMBSTRT                                        1647
         SLR   @05,@05                                             1647
         IC    @05,INDXELMT                                        1647
         SLA   @05,3                                               1647
         ALR   @10,@05                                             1647
         ST    @10,NP3NPSBL                                        1647
*   SCANREG=SLN-1+NP3NPSBL;         /* POINT TO LAST CHAR      Y02752*/
*                                                                  1648
         SLR   @05,@05                                             1648
         IC    @05,SLN                                             1648
         BCTR  @05,0                                               1648
         ALR   @10,@05                                             1648
         LR    SCANREG,@10                                         1648
*   /*****************************************************************/
*   /*                                                               */
*   /* PREVENT EQUAL SIGN FROM APPEARING IN MSG TEXT           Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1649
*   IF SCANREG->NP3SCANR='=' THEN                                  1649
         CLI   NP3SCANR(SCANREG),C'='                              1649
         BNE   @RF01649                                            1649
*     SLNWOE=SLN-1;                 /* PARM WITH EQUAL SIGN    Y02752*/
*                                                                  1650
         STC   @05,SLNWOE                                          1650
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR EXIT IF PROMPT IS FOR PARM WITH OUT EQUAL SIGN    Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1651
*   ELSE                                                           1651
*     DO;                                                          1651
         B     @RC01649                                            1651
@RF01649 DS    0H                                                  1652
*       NP3SAV1='FFFFFFFF'X;        /* NEGATIVE RPARM          Y02752*/
         MVC   NP3SAV1(4),@CF02726                                 1652
*       GOTO NP3RTNR;               /* RETURN TO CALLER        Y02752*/
         L     @10,NP3RTNR                                         1653
         BR    @10                                                 1653
*     END;                          /*                         Y02752*/
*   NP3SAV1=0;                      /* NEGATIVE RPARM          Y02752*/
@RC01649 SLR   @10,@10                                             1655
         ST    @10,NP3SAV1                                         1655
*   RETCODE=255;                    /* 'DO WHILE' GROUP ENTRY VALUE
*                                                              Y02752*/
         MVC   RETCODE(4),@CF02834                                 1656
*                                                                  1657
*   /*****************************************************************/
*   /*                                                               */
*   /* PROMPT UNTIL A VALID REPLY IS RECEIVED AND THEN         Y02752*/
*   /* UPDATE OPLIBTAB                                         Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1657
*   DO WHILE RETCODE=0;            /*                         Y02752*/
         B     @DE01657                                            1657
@DL01657 DS    0H                                                  1658
*     NP3FLAG1=NP3FLAG1&&NP3FLAG1;  /* ZERO FLAGS              Y02752*/
         XC    NP3FLAG1(1),NP3FLAG1                                1658
*     NP3FLAG2=NP3FLAG2&&NP3FLAG2;  /* ZERO FLAGS              Y02752*/
*                                                                  1659
         XC    NP3FLAG2(1),NP3FLAG2                                1659
*     /***************************************************************/
*     /*                                                             */
*     /* PROMPT FOR SYSTEM PARAMETER                           Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1660
*     CALL NPPROMPT;                                               1660
*                                                                  1660
         BAL   @14,NPPROMPT                                        1660
*     /***************************************************************/
*     /*                                                             */
*     /* REPLY IS PROCESSED BY NPPROMPT IF EOB RETURNED        Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1661
*     IF NPEOB='1'B THEN                                          1661
         TM    NPEOB,B'00000100'                                   1661
         BO    @RF01661                                            1661
*       DO;                                                        1662
*         NP3CTAB=ADDR(OPTABLN);    /* SET CURRENT TABLE PTR TO    1663
*                                      OPERATOR PARMTAB        Y02752*/
         LA    @10,OPTABLN                                         1663
         ST    @10,NP3CTAB                                         1663
*         RESPECIFY                                                1664
*          (NP3BKADR,                                              1664
*           NP3BKLN) RESTRICTED;    /*                         Y02752*/
*         NP3BKADR=ADDR(OPTABLN);   /* ADDR OF AREA TO BE CLEARED  1665
*                                                              Y02752*/
         LR    NP3BKADR,@10                                        1665
*         NP3BKLN=LENGTH(OPTABLN);  /* LENGHT OF AREA TO BE CLEARED
*                                                              Y02752*/
*                                                                  1666
         LA    NP3BKLN,640                                         1666
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAR OPLIB PARM TABLE                            Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1667
*         CALL NP3CLRIT;                                           1667
         BAL   @14,NP3CLRIT                                        1667
*         RESPECIFY                                                1668
*          (NP3BKADR,                                              1668
*           NP3BKLN) UNRESTRICTED;  /*                         Y02752*/
*         SYSPRTRY='1'B;            /* INDICATE SECOND LEVEL ENTRY 1669
*                                      INTO SYSP ROUTINE       Y02752*/
         OI    SYSPRTRY,B'00000100'                                1669
*         NP3SYSPD='1'B;            /* INDICATE NOT TO READ IEASYS00
*                                      AGAIN                   Y02752*/
*                                                                  1670
         OI    NP3SYSPD,B'00010000'                                1670
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS CONTINUE REQUESTS AND BUILD SPE CHAIN FOR       */
*         /* REPLIES CHAINED ACROSS MULTIPLE BUFFERS           Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1671
*         CALL NPGETMN;                                            1671
         BAL   @14,NPGETMN                                         1671
*         SYMBLREG=NP3NPSBL;        /* ADDR SYMBLE TABLE ENTRY Y02752*/
         L     SYMBLREG,NP3NPSBL                                   1672
*         CUROPT='00'X;             /* ZERO CURRENT OPTIONS FALGS  1673
*                                                              Y02752*/
         MVI   CUROPT,X'00'                                        1673
*         NP3INID='0000'X;          /* OPERATOR INPUT          Y02752*/
*                                                                  1674
         MVC   NP3INID(2),@CB02317                                 1674
*         /***********************************************************/
*         /*                                                         */
*         /* SCAN OPERATOR REPLY AND UPDATE OPLIBTAB           Y02752*/
*         /* RETURN CODE SET: 0 - VALID ENTRY FOUND, TABLE UPDATED 4 */
*         /* - INVALID INFORMATION PRESENT ON THE REPLY        Y02752*/
*         /* 8 - SUBPARAMETER CONTINUED                        Y02752*/
*         /* 12 - ERROR MSG ISSUED                             Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1675
*         CALL NPEQCK;                                             1675
*                                                                  1675
         BAL   @14,NPEQCK                                          1675
*         /***********************************************************/
*         /*                                                         */
*         /* IF SUBPARAMETERS ARE CONTINUED ONTO A THIRD LINE, Y02752*/
*         /* NPOPCNT WILL ISSUE AN ERROR MSG AND SET THE       Y02752*/
*         /* RETURN CODE TO 12                                 Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1676
*         IF RETCODE=8              /* PARAMETER CONTINUED ON RTN 8
*                                                              Y02752*/
*           THEN                                                   1676
         CLC   RETCODE(4),@CF00156                                 1676
         BNE   @RF01676                                            1676
*           CALL NPOPCNT;                                          1677
*                                                                  1677
         BAL   @14,NPOPCNT                                         1677
*         /***********************************************************/
*         /*                                                         */
*         /* ADD REPLY TO PARMTABLE                            Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1678
*         IF RETCODE=0 THEN                                        1678
@RF01676 ICM   @10,15,RETCODE                                      1678
         BNZ   @RF01678                                            1678
*           DO;                                                    1679
*             RESPECIFY                                            1680
*               NIPPAHDR BASED(PARMPTR);/*                     Y02752*/
*             RESPECIFY                                            1681
*               NIPPAREA BASED(PARMPTR);/*                     Y02752*/
*             RESPECIFY                                            1682
*               OPLIBENT BASED(PLIBREG);/*                     Y02752*/
*             PLIBREG=ADDR(OPTABLN)+/* ADDR OPTAB ENTRY        Y02752*/
*                 INDXELMT*LENGTH(OPSPDUM1);                       1683
         LA    PLIBREG,OPTABLN                                     1683
         SLR   @10,@10                                             1683
         IC    @10,INDXELMT                                        1683
         SLA   @10,4                                               1683
         ALR   PLIBREG,@10                                         1683
*             PARMPTR=NVTPAREA;     /* POINTER TO FIRST PARM AREA  1684
*                                                              Y02752*/
         MVC   PARMPTR(4),NVTPAREA(RNVT)                           1684
*             PARMREG=NP3NPPRM;     /* POINTER TO SYSTEM PARAMETER 1685
*                                      ENTRY                   Y02752*/
*                                                                  1685
         L     PARMREG,NP3NPPRM                                    1685
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE OPERATOR PARMTAB ENTRY INTO PERMANENT PARMLIB  */
*             /*                                               Y02752*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1686
*             CALL NPMOVEP;                                        1686
*                                                                  1686
         BAL   @14,NPMOVEP                                         1686
*             /*******************************************************/
*             /*                                                     */
*             /* RETURN CODE SET BY NPMOVEP IF ERROR IS DETECTED     */
*             /*                                               Y02752*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1687
*             IF RETCODE=0 THEN                                    1687
         ICM   @10,15,RETCODE                                      1687
         BNZ   @RF01687                                            1687
*               DO;                                                1688
*                 NIPPTSID='0000'X; /* MOVE OPERATOR INPUT ID INTO 1689
*                                      PARMTAB                 Y02752*/
*                                                                  1689
         L     @10,NP3NPPRM                                        1689
         MVC   NIPPTSID(2,@10),@CB02317                            1689
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF LIST OPTION SPECIFIED, TURN ON LIST FLAG     */
*                 /*                                           Y02752*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1690
*                 IF LISTOPT='1'B THEN                             1690
         TM    LISTOPT(PLIBREG),B'01000000'                        1690
         BNO   @RF01690                                            1690
*                   NIPPTLST='1'B;                                 1691
*                                                                  1691
         OI    NIPPTLST(@10),B'01000000'                           1691
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF OPERATOR CANCELED THIS PARM, TURN ON CANCEL  */
*                 /* FLAG                                      Y02752*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1692
*                 IF NIPPTADR=0 THEN                               1692
@RF01690 L     @10,NP3NPPRM                                        1692
         ICM   @05,15,NIPPTADR(@10)                                1692
         BNZ   @RF01692                                            1692
*                   NIPPTCAN='1'B;                                 1693
         OI    NIPPTCAN(@10),B'00100000'                           1693
*                 ELSE                                             1694
*                   NIPPTCAN='0'B;  /* TURN OFF CANCEL FLAG    Y02752*/
         B     @RC01692                                            1694
@RF01692 L     @10,NP3NPPRM                                        1694
         NI    NIPPTCAN(@10),B'11011111'                           1694
*                 NIPPTOPI='0'B;    /* ZERO OPI FLAG           Y02752*/
@RC01692 L     @10,NP3NPPRM                                        1695
         NI    NIPPTOPI(@10),B'01111111'                           1695
*               END;                /* NPMOVEP ERROR DETECTED  Y02752*/
*           END;                    /* PARM TABLE ENTRY GROUP      1697
*                                      COMPLETE                Y02752*/
@RF01687 DS    0H                                                  1698
*       END;                        /* NON-EOB REPLY GROUP COMPLETE
*                                                              Y02752*/
@RF01678 DS    0H                                                  1699
*   END;                            /* 'DO WHILE' GROUP COMPLETE     */
@RF01661 DS    0H                                                  1699
@DE01657 ICM   @10,15,RETCODE                                      1699
         BNZ   @DL01657                                            1699
*   GO TO NP3RTNR;                  /* RETURN TO CALLER        Y02752*/
         L     @10,NP3RTNR                                         1700
         BR    @10                                                 1700
*   GENERATE DATA;                                                 1701
*                                                                  1702
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE ISSUES NIP PROMPT FUNCTION MSG'S           Y02752*/
*   /* THAT REQUIRE A REPLY FROM THE OPERATOR                  Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1702
*NPPROMPT:                                                         1702
*   RESPECIFY                                                      1702
*    (SCANREG,                                                     1702
*     RPARM,                                                       1702
*     RNVT) RESTRICTED;             /*                         Y02752*/
NPPROMPT DS    0H                                                  1703
*   NPPMTSAV=REXIT;                 /* SAVE RETURN ADDR        Y02752*/
*                                                                  1703
         ST    REXIT,NPPMTSAV                                      1703
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIATE PROMPT SEQUENCE SEGMENT                        Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1704
*   DO WHILE RETCODE=0;            /*                         Y02752*/
*                                                                  1704
         B     @DE01704                                            1704
@DL01704 DS    0H                                                  1705
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE INVALID REPLY FORMAT MESSAGE ON RETRY           Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1705
*     IF RETCODE=4 THEN                                            1705
         CLC   RETCODE(4),@CF00371                                 1705
         BNE   @RF01705                                            1705
*       DO;                                                        1706
*         GENERATE REFS(NVTWTOR) DEFS(NP3NP03M);                   1707
NP3NP03M IEAPMNIP TYPE=WTOR,PARAM=NPPLIST3
*       END;                        /* END INVALID FORMAT MSG SEGMENT
*                                                              Y02752*/
*     ELSE                                                         1709
*       DO;                         /* FIRST PROMPT MSG SEGMENT    1709
*                                                              Y02752*/
*                                                                  1709
         B     @RC01705                                            1709
@RF01705 DS    0H                                                  1710
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE FIRST PROMPT MSG WHEN OPT = ERROR NOT SPECIFIED   */
*         /*                                                   Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1710
*         IF NPEPRMT='0'B THEN                                     1710
         TM    NPEPRMT,B'10000000'                                 1710
         BNZ   @RF01710                                            1710
*           DO;                                                    1711
*             NP3PID02='        ';  /* BLANK OUT PARM NAME     Y02752*/
         MVC   NP3PID02(8),@CC01891                                1712
*             NP3PID02(1:SLNWOE)=NPSYSP(1:SLNWOE);/*           Y02752
*                                      PLACE SYSP NAME IN MESSAGE  1713
*                                      SEGMENT                 Y02752*/
         SLR   @10,@10                                             1713
         IC    @10,SLNWOE                                          1713
         BCTR  @10,0                                               1713
         L     @05,NP3NPSBL                                        1713
         EX    @10,@SM02885                                        1713
*             GENERATE REFS(NVTWTOR) DEFS(NP3NP02M);               1714
NP3NP02M IEAPMNIP TYPE=WTOR,PARAM=NPPLIST2
*           END;                    /* END OPT NOT = ERROR SEGMENT 1715
*                                                              Y02752*/
*         ELSE                                                     1716
*           DO;                                                    1716
*                                                                  1716
         B     @RC01710                                            1716
@RF01710 DS    0H                                                  1717
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE SYSP PROMPT IF OPT = ERROR SPECIFIED    Y02752*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1717
*             NP3PID01='        ';  /* BLANK OUT PARM NAME     Y02752*/
         MVC   NP3PID01(8),@CC01891                                1717
*             NP3PID01(1:SLNWOE)=NPSYSP(1:SLNWOE);/* PLACE SYSP NAME
*                                      IN MESSAGE SEGMENT      Y02752*/
         SLR   @10,@10                                             1718
         IC    @10,SLNWOE                                          1718
         BCTR  @10,0                                               1718
         L     @05,NP3NPSBL                                        1718
         EX    @10,@SM02887                                        1718
*             GENERATE REFS(NVTWTOR) DEFS(NP3NP01M);               1719
NP3NP01M IEAPMNIP   TYPE=WTOR,PARAM=NPPLIST1
*           END;                    /* END FIRST MESSAGE SEGMENT   1720
*                                                              Y02752*/
*       END;                        /* END OP = ERROR PROMPT SEGMENT */
*                                                                  1721
@RC01710 DS    0H                                                  1722
*     /***************************************************************/
*     /*                                                             */
*     /* INITIATE SCAN OF OPERATOR REPLY                       Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1722
*     NP3NCHAR=RPARM;               /* INITIATE WITH REPLY ADDR    1722
*                                                              Y02752*/
@RC01705 ST    RPARM,NP3NCHAR                                      1722
*     NP3OPSV=RPARM;                /* SAVE ADDR OPERATOR REPLY    1723
*                                                              Y02752*/
         ST    RPARM,NP3OPSV                                       1723
*     SCANREG=RPARM;                /* ESTABLISH SCAN BASE POINTER 1724
*                                                              Y02752*/
         LR    SCANREG,RPARM                                       1724
*     NP3CCHAR=RPARM;               /* INITIATE WITH REPLY ADDR    1725
*                                                              Y02752*/
         ST    RPARM,NP3CCHAR                                      1725
*     RESPECIFY                                                    1726
*       NIPSPE BASED(NP3DSPE);      /*                         Y02752*/
*     NP3DSPE=ADDR(NVTSPE);         /* FIRST SPE CHAINED OUT OF NVT
*                                                              Y02752*/
*                                                                  1727
         LA    @10,NVTSPE(,RNVT)                                   1727
         ST    @10,NP3DSPE                                         1727
*     /***************************************************************/
*     /*                                                             */
*     /* UPDATE NP3DSPE TO LAST SPE ON CHAIN                   Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1728
*     DO WHILE NIPSPEQ=0;                                         1728
         B     @DE01728                                            1728
@DL01728 DS    0H                                                  1729
*       NP3DSPE=NIPSPEQ;            /* PICK UP SPE CHAIN PTR   Y02752*/
         L     @10,NP3DSPE                                         1729
         L     @10,NIPSPEQ(,@10)                                   1729
         ST    @10,NP3DSPE                                         1729
*     END;                                                         1730
@DE01728 SLR   @10,@10                                             1730
         L     @05,NP3DSPE                                         1730
         C     @10,NIPSPEQ(,@05)                                   1730
         BNE   @DL01728                                            1730
*     RESPECIFY                                                    1731
*       NIPPTE BASED(NP3NPPRM);                                    1731
*     RETCODE=0;                    /* ASSUME NORMAL RETURN CODE   1732
*                                                              Y02752*/
*                                                                  1732
         ST    @10,RETCODE                                         1732
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS EOB REPLY                                     Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1733
*     IF NP3SCAN2=' ''' THEN                                       1733
         CLC   NP3SCAN2(2,SCANREG),@CC01867                        1733
         BNE   @RF01733                                            1733
*       DO;                                                        1734
*                                                                  1734
*         /***********************************************************/
*         /*                                                         */
*         /* NULL REPLY NOT ALLOWED IF OPT NOT EQUAL ERROR     Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1735
*         IF NPEPRMT='0'B THEN                                     1735
         TM    NPEPRMT,B'10000000'                                 1735
         BNZ   @RF01735                                            1735
*           RETCODE=4;                                             1736
         MVC   RETCODE(4),@CF00371                                 1736
*         ELSE                                                     1737
*           DO;                                                    1737
         B     @RC01735                                            1737
@RF01735 DS    0H                                                  1738
*             NPEOB='1'B;           /* INDICATE EOB REPLY      Y02752*/
         OI    NPEOB,B'00000100'                                   1738
*             NIPPTOPI='0'B;        /* ZERO PARMTAB ENTRY OPI FLAG 1739
*                                                              Y02752*/
*             NIPPTCAN='1'B;        /* SET CANCEL INDICATOR FLAG ON
*                                                              Y02752*/
         L     @10,NP3NPPRM                                        1740
         OI    NIPPTCAN(@10),B'00100000'                           1740
         NI    NIPPTOPI(@10),B'01111111'                           1740
*             NIPPTADR=NIPPTADR&&NIPPTADR;/* ZERO PTR TO ORIGINAL  1741
*                                      PARMTAB ENTRY           Y02752*/
         L     @05,NIPPTADR(,@10)                                  1741
         LR    @00,@05                                             1741
         XR    @00,@05                                             1741
         ST    @00,NIPPTADR(,@10)                                  1741
*             NIPPTSID=NIPPTSID&&NIPPTSID;/* ZERO INPUT ID INDICATES
*                                      OPERATOR                Y02752*/
         XC    NIPPTSID(2,@10),NIPPTSID(@10)                       1742
*           END;                    /* NULL REPLY ERROR        Y02752*/
*       END;                        /* END EOB PROCESSING      Y02752*/
*                                                                  1744
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE PROMPT IF THE PROPER PARM WAS NOT SPECIFIED     Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1745
*     ELSE                                                         1745
*       DO;                                                        1745
         B     @RC01733                                            1745
@RF01733 DS    0H                                                  1746
*         RPARM=SCANREG+SLN;        /* FIRST VALUE CHARACTER   Y02752*/
*                                                                  1746
         LR    RPARM,SCANREG                                       1746
         SLR   @10,@10                                             1746
         IC    @10,SLN                                             1746
         ALR   RPARM,@10                                           1746
*         /***********************************************************/
*         /*                                                         */
*         /* DOES A VALID VALUE CHAR FOLLOW EQUAL SIGN         Y02752*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1747
*         IF RPARM->NP3SCANR=NP3COMMA|RPARM->NP3SCANR=NP3QUOTE|RPARM->
*             NP3SCANR=NP3BLANK THEN                               1747
         CLC   NP3SCANR(1,RPARM),NP3COMMA                          1747
         BE    @RT01747                                            1747
         CLC   NP3SCANR(1,RPARM),NP3QUOTE                          1747
         BE    @RT01747                                            1747
         CLC   NP3SCANR(1,RPARM),NP3BLANK                          1747
         BNE   @RF01747                                            1747
@RT01747 DS    0H                                                  1748
*           RETCODE=4;                                             1748
         MVC   RETCODE(4),@CF00371                                 1748
*         RPARM=SCANREG;            /* RESTORE RPARM           Y02752*/
@RF01747 LR    RPARM,SCANREG                                       1749
*         IF NP3SCAN7(1:SLN)=NPSYSP(1:SLN) THEN                   1750
         SLR   @10,@10                                             1750
         IC    @10,SLN                                             1750
         BCTR  @10,0                                               1750
         L     @05,NP3NPSBL                                        1750
         EX    @10,@SC02889                                        1750
         BE    @RF01750                                            1750
*           RETCODE=4;              /* INDICATE ERROR          Y02752*/
         MVC   RETCODE(4),@CF00371                                 1751
*       END;                        /*                         Y02752*/
@RF01750 DS    0H                                                  1753
*   END;                            /* END PROMPT SEQUENCE     Y02752*/
@RC01733 DS    0H                                                  1753
@DE01704 ICM   @10,15,RETCODE                                      1753
         BNZ   @DL01704                                            1753
*   GO TO NPPMTSAV;                 /* RETURN TO CALLER        Y02752*/
         L     @10,NPPMTSAV                                        1754
         BR    @10                                                 1754
*                                                                  1755
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE ISSUES THE CONTINUE SYSTEM PARAMETERS MESSAGE AND*/
*   /* CHAINS THE CORRESPONDING OPERATOR REPLIES ON THE SPE QUEUE    */
*   /*                                                         Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1755
*NPGETMN:                                                          1755
*   RESPECIFY                                                      1755
*    (RNVT,                                                        1755
*     SCANREG) RESTRICTED;          /*                         Y02752*/
NPGETMN  DS    0H                                                  1756
*   NPGETSAV=REXIT;                 /* SAVE RETURN ADDR        Y02752*/
*                                                                  1756
         ST    REXIT,NPGETSAV                                      1756
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS GENERATES A GETMAIN FOR 8 BYTES FROM SUBPOOL 255, TO     */
*   /* HOUSE A NEW SPE TO BE ADDED TO THE CURRENT CHAIN OF SPE'S     */
*   /*                                                         Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1757
*   GENERATE DEFS(NP3GETMN);                                       1757
NP3GETMN GETMAIN    LC,LA=SPESZ01,A=NP3ADSPE,SP=255
*   IF GETMRTCD=ZERO THEN          /* TEST GET OK           @ZA00093*/
         SLR   @14,@14                                             1758
         CR    GETMRTCD,@14                                        1758
         BNE   @RT01758                                            1758
*     GO TO NP3SW38;                /* WAIT STATE            @ZA00093*/
*/*                                                            Y02752*/
*                                                                  1760
*   RESPECIFY                                                      1760
*     NIPSPE BASED(NP3ADSPE);       /* RESET SPE MAPPING             */
*   NIPSPEA=NP3OPSV;                /* SET POINTER TO OPERATOR     1761
*                                      RESPECIFIED SYSTEM PARAMETERS
*                                      IN NEW SPE              Y02752*/
         L     @10,NP3ADSPE                                        1761
         MVC   NIPSPEA(4,@10),NP3OPSV                              1761
*/*                                                            Y02752*/
*                                                                  1762
*   NIPSPEQ=0;                      /* CLEAR CHAIN POINTER TO ZEROS  */
         ST    @14,NIPSPEQ(,@10)                                   1762
*/*                                                            Y02752*/
*                                                                  1763
*   RESPECIFY                                                      1763
*     NIPSPE BASED(NP3DSPE);        /* RESET SPE MAPPING TO ORIGINAL
*                                      BASE ADDRESS                  */
*   NIPSPEQ=NP3ADSPE;               /* CHAIN NEW SPE TO CURRENT SPE
*                                      QUE                     Y02752*/
         L     @05,NP3DSPE                                         1764
         ST    @10,NIPSPEQ(,@05)                                   1764
*/*                                                            Y02752*/
*                                                                  1765
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CHECKS FOR FIRST NEW SPE BEING ADDED. IF SO, IT SAVES ITS*/
*   /* ADDRESS FOR LOCATING THE ORIGIN SPE FOR OPERATOR RESPECIFIED  */
*   /* SYSTEM PARAMETERS                                       Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1765
*   IF NP3NWSPE='1'B                /* IS THIS FIRST SPE ADDED Y02752*/
*     THEN                          /* NO, IT IS NOT FIRST SPE ADDED */
         TM    NP3NWSPE,B'00010000'                                1765
         BO    @RT01765                                            1765
*     GO TO NP3SPERS;               /* BRANCH TO SPE ADDRESS RESET   */
*   ELSE                            /* YES, IT IS FIRST SPE ADDED    */
*     DO;                                                          1767
*                                                                  1767
*/*                                                            Y02752*/
*                                                                  1768
*       NP3NWSPE='1'B;              /* SET FIRST NEW SPE FLAG ON     */
         OI    NP3NWSPE,B'00010000'                                1768
*/*                                                            Y02752*/
*                                                                  1769
*       NP3FSPE=NP3ADSPE;           /* SAVE ADDRESS OF FIRST SPE     */
         ST    @10,NP3FSPE                                         1769
*     END;                                                         1770
*NP3SPERS:                                                         1771
*   NP3DSPE=NP3ADSPE;               /* SET SPE MAPPING BASE ADDRESS
*                                      TO ADDRESS OF NEW SPE   Y02752*/
NP3SPERS L     @10,NP3ADSPE                                        1771
         ST    @10,NP3DSPE                                         1771
*/*                                                            Y02752*/
*                                                                  1772
*   SCANREG=NIPSPEA;                /* POINT TO OPERATOR REPLY Y02752*/
         L     SCANREG,NIPSPEA(,@10)                               1772
*/*                                                            Y02752*/
*                                                                  1773
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK OPERATOR REPLY FOR CONTINUATION OF PARAMETERS REQUESTED */
*   /* - "CONT". IF YES, THEN A BRANCH TO THE                  Y02752*/
*   /* NIPWTOR BRANCH INTERFACE IS TAKEN                       Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1773
*NP3RCYCL:                                                         1773
*   IF OPREPLY3=NP3RCONT            /* IS CONTINUATION REQUESTED     */
*     THEN                          /* YES,CONTINUATION OF SYSTEM  1773
*                                      PARAMETERS FROM THE OPERATOR
*                                      WAS REQUESTED           Y02752*/
NP3RCYCL CLC   OPREPLY3(4,SCANREG),NP3RCONT                        1773
         BE    @RT01773                                            1773
*     GO TO NPCSYSP;                /* BRANCH TO NIPWTOR INTERFACE 1774
*                                      CALL HANDLER            Y02752*/
*   ELSE                                                           1775
*     ;                             /* NOT "CONT", FALL THROUGH    1775
*                                                              Y02752*/
*                                                                  1775
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECKS FOR END OF OPERATOR RESPECIFIED SYSTEM           Y02752*/
*   /* PARAMETERS. IF THE CURRENT CHARACTER IN THE SCAN IS A         */
*   /* QUOTE,THEN END OF RESPECIFIED PARAMETERS IS ASSUMED           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1776
*   IF OPREPLY4=NP3QUOTE            /* IS THIS END OF PARAMETERS     */
*     THEN                          /* YES,(A QUOTE WAS FOUND) Y02752*/
         CLC   OPREPLY4(1,SCANREG),NP3QUOTE                        1776
         BE    @RT01776                                            1776
*     GO TO NP3SPEST;               /* BRANCH TO ORIGIN NEW SPE SETUP*/
*   ELSE                            /* NO, (A QUOTE WAS NOT FOUND)   */
*/*                                                            Y02752*/
*                                                                  1778
*     DO;                                                          1778
*                                                                  1778
*/*                                                            Y02752*/
*                                                                  1779
*       SCANREG=1+SCANREG;          /* UPDATE BASE ADDRESS BY ONE FOR
*                                      RESCAN                        */
         LA    SCANREG,1(,SCANREG)                                 1779
*/*                                                            Y02752*/
*                                                                  1780
*       GO TO NP3RCYCL;             /* BRANCH TO SCAN FOR "CONT"     */
         B     NP3RCYCL                                            1780
*     END;                          /*                         Y02752*/
*NP3SPEST:                                                         1782
*   NP3DSPE=NP3FSPE;                /* SET SPE MAPPING BASE ADDRESS
*                                      TO ADDRESS OF FIRST NEW SPE 1782
*                                      ADDED TO SPE CHAIN      Y02752*/
NP3SPEST MVC   NP3DSPE(4),NP3FSPE                                  1782
*/*                                                            Y02752*/
*                                                                  1783
*   NP3NWSPE='0'B;                  /* RESET FIRST NEW SPE FLAG,OFF  */
         NI    NP3NWSPE,B'11101111'                                1783
*   GO TO NPGETSAV;                 /* RETURN TO CALLER        Y02752*/
         L     @10,NPGETSAV                                        1784
         BR    @10                                                 1784
*/*                                                            Y02752*/
*                                                                  1785
*NPCSYSP:                           /* ISSUE CONTINUE MESSAGE IF THE
*                                      NIP PROMPT FUNCTION           */
*                                                                  1785
*   /*****************************************************************/
*   /*                                                               */
*   /* IS BEING EXECUTED                                       Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1785
*   IF NVTSYSP='1'B THEN                                           1785
NPCSYSP  TM    NVTSYSP(RNVT),B'01000000'                           1785
         BNO   @RF01785                                            1785
*     DO;                                                          1786
*       NP3PID04='        ';        /* BLANK OUT NAME AREA           */
         MVC   NP3PID04(8),@CC01891                                1787
*       NP3PID04(1:SLNWOE)=NPSYSP(1:SLNWOE);/* MOVE IN PARM NAME   1788
*                                                              Y02752*/
         SLR   @10,@10                                             1788
         IC    @10,SLNWOE                                          1788
         BCTR  @10,0                                               1788
         L     @05,NP3NPSBL                                        1788
         EX    @10,@SM02892                                        1788
*       RESPECIFY                                                  1789
*         RPARM RESTRICTED;         /* PARAMETER INTERFACE REG(1)    */
*                                                                  1789
*       /*************************************************************/
*       /*                                                           */
*       /* GENERATE A BRANCH INTERFACE CALL TO THE NIPWTOR     Y02752*/
*       /* SERVICE ROUTINE IN IEAVNIPM. SEND A MESSAGE TO      Y02752*/
*       /* THE OPERATOR TELLING HIM TO CONTINUE                Y02752*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1790
*       GENERATE DEFS(NPSYSPC);                                    1790
NPSYSPC DS 0H
        IEAPMNIP TYPE=WTOR,PARAM=NPPLIST4
*     END;                                                         1791
*   ELSE                                                           1792
*     DO;                                                          1792
*                                                                  1792
         B     @RC01785                                            1792
@RF01785 DS    0H                                                  1793
*       /*************************************************************/
*       /*                                                           */
*       /* GENERATE A BRANCH INTERFACE CALL TO THE NIPWTOR     Y02752*/
*       /* SERVICE ROUTINE IN IEAVNIPM. SEND A MESSAGE TO THE        */
*       /* OPERATOR TELLING HIM TO CONTINUE SYSTEM PARAMETERS        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1793
*       GENERATE REFS(NVTWTOR) DEFS(NP3CSYSP);                     1793
NP3CSYSP DS    0H
         IEAPMNIP   TYPE=WTOR,PARAM=PLIST02  CALL WTOR SERVICE ROUTINE
*     END;                          /*                         Y02752*/
*   NP3OPSV=RPARM;                  /* SAVE ADDRESS OF OPERATOR    1795
*                                      RESPECIFIED PARAMETERS  Y02752*/
@RC01785 ST    RPARM,NP3OPSV                                       1795
*   GO TO NP3GETMN;                 /* BRANCH TO SPE GETMAIN TO GET
*                                      AN SPE FOR TRACKING         1796
*                                      RESPECIFIED PARAMETERS  Y02752*/
         B     NP3GETMN                                            1796
*NP3CLRIT:                                                         1797
*   RESPECIFY                                                      1797
*    (RNVT,                                                        1797
*     SCANREG,                                                     1797
*     NP3BKADR,                                                    1797
*     NP3BKLN) RESTRICTED;          /*                         Y02752*/
NP3CLRIT DS    0H                                                  1798
*   NP3CLRSV=REXIT;                 /* SAVE RETURN ADDRESS     Y02752*/
*                                                                  1798
         ST    REXIT,NP3CLRSV                                      1798
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR STORAGE IN 256 BYTE BLOCKS                        Y02752*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1799
*   DO WHILE NP3BKLN>=256;                                         1799
*                                                                  1799
         B     @DE01799                                            1799
@DL01799 DS    0H                                                  1800
*     /***************************************************************/
*     /*                                                             */
*     /* CLEAR 256 BYTES OF STORAGE                            Y02752*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1800
*     NP3CLEAR(1:256)=NP3CLEAR(1:256)&&NP3CLEAR(1:256);            1800
         XC    NP3CLEAR(256,NP3BKADR),NP3CLEAR(NP3BKADR)           1800
*     NP3BKADR=NP3BKADR+256;        /* INCREMENT START ADDR          */
         LA    @10,256                                             1801
         ALR   NP3BKADR,@10                                        1801
*     NP3BKLN=NP3BKLN-256;          /* DECREMENT LENGTH COUNT  Y02752*/
         SLR   NP3BKLN,@10                                         1802
*   END;                            /* END DO WHILE GROUP      Y02752*/
@DE01799 CH    NP3BKLN,@CH01457                                    1803
         BNL   @DL01799                                            1803
*/*                                                            Y02752*/
*                                                                  1804
*   IF NP3BKLN>0 THEN                                              1804
         LTR   NP3BKLN,NP3BKLN                                     1804
         BNP   @RF01804                                            1804
*     NP3CLEAR(1:NP3BKLN)=NP3CLEAR(1:NP3BKLN)&&NP3CLEAR(1:NP3BKLN);
         LR    @10,NP3BKLN                                         1805
         BCTR  @10,0                                               1805
         EX    @10,@SX02894                                        1805
*   GO TO NP3CLRSV;                 /* RETURN TO CALLER        Y02752*/
@RF01804 L     @10,NP3CLRSV                                        1806
         BR    @10                                                 1806
*   RESPECIFY                                                      1807
*    (NP3BKADR,                                                    1807
*     NP3BKLN) UNRESTRICTED;        /*                         Y02752*/
*NP3EXIT:                                                          1808
*   RESPECIFY                                                      1808
*     RPARM RESTRICTED;             /*                         Y02752*/
NP3EXIT  DS    0H                                                  1809
*   RPARM=NP3SAV1;                  /*                         Y02752*/
         L     RPARM,NP3SAV1                                       1809
*   GENERATE REFS(NP3R13);                                         1810
          L     @13,NP3R13                                       Y02752
*   END IEAVNP03                    /* END OF PROCEDURE - IEAVNP03   */
*                                                                  1811
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */
*/*%INCLUDE SYSLIB  (IHAECB  )                                       */
*/*%INCLUDE SYSLIB  (IHANVT  )                                       */
*/*%INCLUDE SYSLIB  (IEAPMNIP)                                       */
*/*%INCLUDE SYSLIB  (IEAPPNIP)                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEAPSPIO)                                       */
*                                                                  1811
*       ;                                                          1811
@EL00001 DS    0H                                                  1811
@EF00001 DS    0H                                                  1811
@ER00001 LM    @14,@00,12(@13)                                     1811
         LM    @02,@12,28(@13)                                     1811
         BR    @14                                                 1811
@DATA    DS    0H
@CH00261 DC    H'3'
@CH00170 DC    H'5'
@CH00168 DC    H'7'
@CH00210 DC    H'15'
@CH02133 DC    H'44'
@CH02625 DC    H'51'
@CH02864 DC    H'64'
@CH02808 DC    H'72'
@CH01457 DC    H'256'
@CH02860 DC    H'640'
@CH02180 DC    H'2048'
@SM02878 MVC   0(0,@01),NP3FILL
@SC02880 CLC   NP3TABSB(0,SYMBLREG),NP3SCAN5(SCANREG)
@SM02885 MVC   NP3PID02(0),NPSYSP(@05)
@SM02887 MVC   NP3PID01(0),NPSYSP(@05)
@SC02889 CLC   NP3SCAN7(0,SCANREG),NPSYSP(@05)
@SM02892 MVC   NP3PID04(0),NPSYSP(@05)
@SX02894 XC    NP3CLEAR(0,NP3BKADR),NP3CLEAR(NP3BKADR)
         DS    0F
         DS    0F
@CF00034 DC    F'1'
@CH00034 EQU   @CF00034+2
@CF00371 DC    F'4'
@CH00371 EQU   @CF00371+2
@CF00156 DC    F'8'
@CH00156 EQU   @CF00156+2
@CF00036 DC    F'12'
@CF00173 DC    F'16'
@CF02834 DC    F'255'
@CF02726 DC    XL4'FFFFFFFF'
         DS    0D
NP3SAV1  DS    A
UCBPTR   DS    A
IOBSTPTR DS    A
ECBPTR   DS    A
NP3GBFR  DS    A
NP3DSPE  DS    A
NP3CTAB  DS    A
NP3CENT  DS    A
NP3NCHAR DS    A
NP3TSPE  DS    A
NP3OPSV  DS    A
NP3ADSPE DS    A
NP3PBFR  DS    A
NP3FSPE  DS    A
NP3RTRN  DS    A
NP3PRTRN DS    A
NP3CCHAR DS    A
NP3SYMLN DS    A
NP3EQADR DS    A
NP3BALCK DS    A
NP3SRTRN DS    A
NP3LKCNT DS    A
NP3PAREA DS    A
NP3PAREN DS    F
NP3LST03 DC    AL4(PLIST03)
NP3LST04 DC    AL4(PLIST04)
NP3LST05 DC    AL4(PLIST05)
NP3LST06 DC    AL4(PLIST06)
NP3LST07 DC    AL4(PLIST07)
NP3RTADR DS    A
NP3SYPAD DS    A
NP3POADR DS    A
PRENDPTR DS    A
PARMBASE DS    A
SAVESCAN DS    A
SAVEONE  DS    A
NP3MSG08 DC    AL4(MESG08)
PARMQPTR DS    A
PARMPTR  DS    A
ADPTR    DS    A
GETAREA  DS    A
GETPTR   DS    A
NP3R13   DS    A
NPMSAVE  DS    A
NP3MSAVR DS    A
NP3CLRSV DS    A
NPGETSAV DS    A
NPPMTSAV DS    A
NP3NPPRM DS    A
NP3RTNR  DS    A
NP3NPSBL DS    A
NP3SLR13 DS    A
RETCODE  DS    A
NPRMRTN1 DS    A
LCNAMPTR DC    AL4(LCNAM)
MSG08PT  DC    AL4(MESG08)
MSG12APT DC    AL4(MESG12A)
MSG14APT DC    AL4(MESG14A)
STRGLN   DS    F
PTRSAVE  DS    A
R2SAVE   DS    A
NIPPMADR DS    A
NIPPMKPR DS    A
NIPPMNEG DC    XL4'FFFFFFFF'
NIPPMBDL DS    A
NIPPMDCB DS    A
SAVMYBAS DS    F
I        DS    H
#MEMBERS DS    H
#PROCESD DS    H
INDXELMT DS    AL1
SLN      DS    AL1
NP3MELNG DS    AL1
SLNWOE   DS    AL1
NP3ERLNG DS    AL1
@TS00001 DS    CL1
@CC01891 DC    C'        '
@CC02498 DC    C'SYSP='
@CC01908 EQU   @CC02498
@CC02504 DC    C'(,L)'
@CC02723 DC    C'OPI='
@CC02486 DC    C'YES'
@CC02828 DC    C'()'''
@CC01867 DC    C' '''
@CC01913 DC    C'00'
@CC02448 DC    C'AA'
@CC02449 DC    C'99'
@CC02487 DC    C'NO'
@CC02547 EQU   @CC01891
@CC02718 DC    C'L,'
@CC02720 DC    C'L)'
@CB02424 DC    X'00000000000000000000000000000000'
@CB02796 EQU   @CB02424
@CB01889 DC    X'4DFFFF5D'
@CB02726 DC    X'FFFFFFFF'
@CB02729 EQU   @CB02726
@CB02317 EQU   @CB02424
@CB02728 EQU   @CB02726
NP3UQ    DC    CL2'U'''
NP3BLNKQ DC    CL2' '''
NP3UCLQ  DC    CL4'U,L'''
NP3RCONT DC    CL4'CONT'
NP3CLWU  DC    CL3',L'''
NP3QUOTE DC    CL1''''
NP3OPIMG DC    CL3'OPI'
NP3BLANK DC    CL1' '
NP3EQUAL DC    CL1'='
NP3COMMA DC    CL1','
RPAREN   DC    CL1')'
LPAREN   DC    CL1'('
NP3FILL  DC    CL8'        '
PARMLIB  DC    CL12'SYS1.PARMLIB'
LINKLIB  DC    CL12'SYS1.LINKLIB'
BLDLHEAD DC    X'0001000E'
CONTCHAR DC    CL5'CONT'''
IEASYS   DS    CL8
         ORG   IEASYS
@NM00083 DC    CL6'IEASYS'
LISTNAM  DS    CL2
         ORG   IEASYS+8
QUOTE    DC    CL1''''
SYSPCHAR DC    CL4'SYSP'
LNKLST   DS    CL8
         ORG   LNKLST
LNKLSTNM DC    CL6'LNKLST'
LNKLST00 DC    CL2'00'
         ORG   LNKLST+8
UNDKEY   DC    CL20'UNDEFINED KEYWORD  '
IMPDEL   DC    CL20'IMPROPER DELIMETER  '
INVCON   DC    CL20'INVALID CONTINUATION'
INVOPI   DC    CL20'INVALID OPI KEYWORD '
IMBPAR   DC    CL20'UNBALANCED PARENS   '
NP3FLAGS DS    CL3
         ORG   NP3FLAGS
NP3FLAG1 DS    CL1
         ORG   NP3FLAG1
NP3CONT  DS    BL1
NP3INVLD EQU   NP3FLAG1+0
NP3ADBFR EQU   NP3FLAG1+0
NP3NWSPE EQU   NP3FLAG1+0
NP3SUBCK EQU   NP3FLAG1+0
SYSPRTRY EQU   NP3FLAG1+0
NP3SYHDR EQU   NP3FLAG1+0
CONTDONE EQU   NP3FLAG1+0
         ORG   NP3FLAGS+1
NP3FLAG2 DS    CL1
         ORG   NP3FLAG2
NP3HDMSG DS    BL1
MULTSYSP EQU   NP3FLAG2+0
NP3SYLST EQU   NP3FLAG2+0
NP3SYSPD EQU   NP3FLAG2+0
@NM00086 EQU   NP3FLAG2+0
NPEOB    EQU   NP3FLAG2+0
@NM00087 EQU   NP3FLAG2+0
@NM00088 EQU   NP3FLAG2+0
         ORG   NP3FLAGS+2
NP3FLAG3 DS    CL1
         ORG   NP3FLAG3
NPEPRMT  DS    BL1
@NM00089 EQU   NP3FLAG3+0
         ORG   NP3FLAGS+3
         DS    CL2
OPTABLN  DS    CL640
         ORG   OPTABLN
@NM00090 DS    CL640
         ORG   OPTABLN+640
PTABLN   DS    CL640
         ORG   PTABLN
@NM00091 DS    CL640
         ORG   PTABLN+640
NP3INID  DS    CL2
         DS    CL2
NP3SZ01  DS    CL8
         ORG   NP3SZ01
SPESZ01  DS    CL4
         ORG   SPESZ01
SPESZ02  DC    X'80'
SPESZ03  DC    AL3(8)
         ORG   NP3SZ01+4
PAREA01  DS    CL4
         ORG   PAREA01
PAREA02  DC    X'80'
PAREA03  DC    AL3(2048)
*                                                                  *SKV
*  THEORY: PARAMETER FOLLOWED BY '='.  MAX LENGTH IS 7 CHARACTERS. *SKV
*          A ONE BYTE LENGTH FOLLOWS.                              *SKV
*   REFERENCES TO 320 OCCURS IN TWO PLACES                         *SKV
         ORG   NP3SZ01+8
NP3SYMBL DS    CL368         320 / 8 = 40   *WAS 320               *SKV
         ORG   NP3SYMBL
SYMBSTRT DC    X'FF00000000000001'
NP3APF   DC    CL7'APF=   '
@NM00095 DC    X'04'
NP3APG   DC    CL7'APG=   '
@NM00096 DC    X'04'
NP3BLDL  DC    CL7'BLDL=  '
@NM00097 DC    X'05'
NP3BLDLF DC    CL7'BLDLF= '
@NM00098 DC    X'06'
NP3CLPA  DC    CL7'CLPA   '
@NM00099 DC    X'04'
NP3CMD   DC    CL7'CMD=   '
@NM00100 DC    X'04'
NP3CNTN  DC    CL7'CONT   '
@NM00101 DC    X'04'
NP3CPQE  DC    CL7'CPQE=  '
@NM00102 DC    X'05'
NP3CSA   DC    CL7'CSA=   '
@NM00103 DC    X'04'
NP3CVAM  DC    CL7'CVIO   '
@NM00104 DC    X'04'
NP3DUMP  DC    CL7'DUMP=  '
@NM00105 DC    X'05'
NP3FIX   DC    CL7'FIX=   '
@NM00106 DC    X'04'
NP3HCPY  DC    CL8'HARDCPY='
NP3IPS   DC    CL7'IPS=   '
@NM00107 DC    X'04'
NP3LNK   DC    CL7'LNK=   '
@NM00108 DC    X'04'
NP3LOGC  DC    CL7'LOGCLS='
@NM00109 DC    X'07'
NP3LOGL  DC    CL7'LOGLMT='
@NM00110 DC    X'07'
NP3MAXUS DC    CL8'MAXUSER='
NP3MLPA  DC    CL7'MLPA=  '
@NM00111 DC    X'05'
NP3NUCM  DC    CL7'NUCMAP '
@NM00112 DC    X'06'
NP3OPI   DC    CL7'OPI=   '
@NM00113 DC    X'04'
NP3OPT   DC    CL7'OPT=   '
@NM00114 DC    X'04'
NP3PAGE  DC    CL7'PAGE=  '
@NM00115 DC    X'05'
NP3DP    DC    X'0000000000000001'
NP3REAL  DC    CL7'REAL=  '
@NM00116 DC    X'05'
NP3SMF   DC    CL7'SMF=   '
@NM00117 DC    X'04'
NP3SQA   DC    CL7'SQA=   '
@NM00118 DC    X'04'
NP3SYSX  DC    CL7'SYSP=  '
@NM00119 DC    X'05'
NP3VAP   DC    CL7'VAL=   '
@NM00120 DC    X'04'
NP3VRREG DC    CL7'VRREGN='
@NM00121 DC    X'07'
NP3WTOBF DC    CL8'WTOBFRS='
NP3WTORB DC    CL8'WTORPLY='
NP3PURGE DC    CL7'PURGE '
@NM00122 DC    X'05'
@NM00123 DC    X'00'
         DC    XL6'0'
@NM00124 DC    X'07'
NP3RSU   DC    CL7'RSU= '
@NM00125 DC    X'04'
NP3SWAP  DC    CL7'SWAP=  '
@NM00126 DC    X'05'
NP3PAGNU DC    CL7'PAGNUM='
@NM00127 DC    X'07'
NP3DUPLE DC    CL7'DUPLEX='
@NM00128 DC    X'07'
NP3SSN   DC    CL7'SSN=   '                                        *SKV
@NMS0129 DC    X'04'                                               *SKV
NP3MPF   DC    CL7'MPF=   '                                        *SKV
@NMS0130 DC    X'04'                                               *SKV
NP3LOGR  DC    CL7'LOGREC='                                       *SKV
@NMS0131 DC    X'07'                                              *SKV
NP3SVC   DC    CL7'SVC=   '                                        *SKV
@NMS0132 DC    X'04'                                               *SKV
NP3SYM   DC    CL7'SYM=   '                                        *SKV
@NMS0133 DC    X'04'                                               *SKV
NP3LPA   DC    CL7'LPA=   '                                        *SKV
@NMS0134 DC    X'04'                                               *SKV
NP3TSO   DC    CL7'TSO=   '                                        *SKV
@NMS0135 DC    X'04'                                               *SKV
NP3MSJC  DC    CL7'MSTJCL='                                        *SKV
@NMS0136 DC    X'07'                                               *SKV
SYMBEND  DC    X'FF00000000000001'
         ORG   NP3SYMBL+376      *WAS 320 & 368                    *SKV
NP3CCW   DS    CL32
         ORG   NP3CCW
@NM00129 DS    CL8
         ORG   @NM00129
SRCH     DC    X'31'
SRCHAD   DC    AL3(NIPPASID)
SRCHFLG  DC    X'4000'
SRCHCNT  DC    X'0005'
         ORG   NP3CCW+8
@NM00130 DS    CL8
         ORG   @NM00130
TIC      DC    X'08'
TICAD    DC    AL3(NP3CCW)
TICFLG   DC    X'0000'
TICCNT   DC    X'0000'
         ORG   NP3CCW+16
@NM00131 DS    CL8
         ORG   @NM00131
RDDAT    DC    X'06'
RDDATAD  DC    AL3(NIPPARCD)
RDDATFLG DC    X'6000'
RDDATCNT DC    X'0050'
         ORG   NP3CCW+24
@NM00132 DS    CL8
         ORG   @NM00132
RDCNT    DC    X'92'
RDCNTAD  DC    AL3(NIPPASID)
RDCNTFLG DC    X'0000'
RDCNTCNT DC    X'0008'
         ORG   NP3CCW+32
RPLYBUF  DS    CL80
STRINGSZ DS    CL2
CUROPT   DC    X'00'
         ORG   CUROPT
COPIOPT  DS    BL1
CLISTOPT EQU   CUROPT+0
CURCANOP EQU   CUROPT+0
@NM00133 EQU   CUROPT+0
         ORG   CUROPT+1
NPTPARM  DS    CL8
ALLDONE  DS    BL1
BADLNK   DC    CL8'LNK'
LNKMEM   DS    CL8
         ORG   LNKMEM
@NM00134 DS    CL6
NUMBER   DS    CL2
         ORG   LNKMEM+8
TRTTAB   DS    CL256
         ORG   TRTTAB
@NM00135 DC    77X'04'
@NM00136 DC    X'03'
@NM00137 DC    13X'04'
@NM00138 DC    X'00'
@NM00139 DC    X'04'
@NM00140 DC    X'08'
@NM00141 DC    13X'04'
@NM00142 DC    X'05'
@NM00143 DC    15X'04'
@NM00144 DC    2X'00'
@NM00145 DC    X'01'
@NM00146 DC    3X'04'
@NM00147 DC    9X'00'
@NM00148 DC    7X'04'
@NM00149 DC    9X'00'
@NM00150 DC    8X'04'
@NM00151 DC    8X'00'
@NM00152 DC    23X'04'
@NM00153 DC    9X'00'
@NM00154 DC    7X'04'
@NM00155 DC    9X'00'
@NM00156 DC    8X'04'
@NM00157 DC    8X'00'
@NM00158 DC    6X'04'
@NM00159 DC    10X'00'
@NM00160 DC    6X'04'
         ORG   TRTTAB+256
NIPPMMBC DS    CL8
         ORG   NIPPMMBC
NIPPMMBB DS    CL3
NIPPMCCH DS    CL5
         ORG   NIPPMMBC+8
NIPPMMK1 DC    B'11110010'
NIPPMMK2 DC    B'11110001'
NIPPMMK3 DC    B'00100000'
NIPPMNAM DC    CL8' '
         DS    CL1
NIPPMREG DS    16F
SAVEREGS DS    18F
IEAVNP03 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
IEAVNP03 CSECT
*                              /*
*NIPPMMS1 DS   0F                                               Y02752
NIPPMMS1 DS    0F                                               Y02752
         IEAPMNIP TYPE=HEADER,MSGST=NIPPMMS1,MSGEND=NIPPMED1    Y02752
         DC    CL34'IEA300I I/O ERROR DURING BLDL FOR '
*NIPPMMB1  EQU *                                                Y02752
NIPPMMB1 DC    CL8'        '
         DC    CL16' IN SYS1.PARMLIB'
*NIPPMED1 EQU   *                                               Y02752
NIPPMED1 EQU   *                                                Y02752
         SPACE 1
*NIPPMMS2 DS    0F                                              Y02752
NIPPMMS2 DS    0F                                               Y02752
         IEAPMNIP TYPE=HEADER,MSGST=NIPPMMS2,MSGEND=NIPPMED2
         DC    CL8'IEA301I '
*NIPPMMB2 EQU  *                                                Y02752
NIPPMMB2 DC    CL8'        '                                    Y02752
         DC    CL26' NOT FOUND IN SYS1.PARMLIB'
*NIPPMED2 EQU   *                                               Y02752
NIPPMED2 EQU   *                                                Y02752
IEAVNP03 CSECT
RMESG    DS    0F                  DUMMY REPLY BUFFER
PLIST01  EQU   *                   START OF PARAMETER LIST
         IEAPMNIP   TYPE=PLIST,RMSGST=SQARBUF,RMSGL=0,MSGST=MESG01,    X
               ASYNCH='NO'
         SPACE 1
PLIST02  DS    0F                  START OF PARAMETER LIST
         IEAPMNIP   TYPE=PLIST,RMSGST=SQARBUF,RMSGL=0,MSGST=MESG02,    X
               ASYNCH='NO'
         SPACE 1
PLIST03  DS    0F                  NIPMOUNT PARAMETER LIST START
         IEAPMNIP   TYPE=MOUNTPL,PARAM=SYS1.LINKLIB
         SPACE 1
PLIST04  DS    0F                  NIPOPEN PARAMETER LIST START
         IEAPMNIP   TYPE=OPENPL,PARAM=SYS1.LINKLIB
         SPACE 1
PLIST05  DS    0F
         IEAPMNIP   TYPE=OPENPL,PARAM=SYS1.PARMLIB
         SPACE 1
PLIST06  DS    0F         NIP MOUNT FOR LINKLIB CONCATENATION
         IEAPMNIP TYPE=MOUNTPL,OPT=PTR
         SPACE 1
PLIST07  DS    0F         NIP OPEN FOR LINKLIB CONCATENATION
         IEAPMNIP TYPE=OPENPL,OPT=PTR
         SPACE 1
PLIST10  DS    0F
         IEAPMNIP TYPE=PLIST,RMSGST=RPLYBUF,RMSGL=80,MSGST=MESG10,     X
               ASYNCH='NO'
         SPACE 1
MESG01   DS    0F                  MESSAGE START ADDRESS
         IEAPMNIP   TYPE=HEADER,MSGST=MESG01,MSGEND=MEND01
         DC    CL39'IEA320A  RESPECIFY PARAMETERS OR CANCEL'
MEND01   EQU   *                   MESSAGE END ADDRESS
         SPACE 1
MESG02   DS    0F                  MESSAGE STSRT ADDRESS
         IEAPMNIP   TYPE=HEADER,MSGST=MESG02,MSGEND=MEND02
         DC    CL35'IEA116A  CONTINUE SYSTEM PARAMETERS'
MEND02   EQU   *                   MESSAGE END ADDRESS
         SPACE 1
MESG03   DS    0F                  MESSAGE STSRT ADDRESS
         IEAPMNIP   TYPE=HEADER,MSGST=MESG03,MSGEND=MEND03
         DC    CL9'IEA107I  '
MESG03B  DC    CL7'       '
MESG03L  DC    CL1' '
         DC    CL8' IGNORED'
MEND03   EQU   *                   MESSAGE END ADDRESS
         SPACE 1
MESG04   DS    0F                  MESSAGE START ADDRESS
         IEAPMNIP   TYPE=HEADER,MSGST=MESG04,MSGEND=MEND04
         DC    CL34'IEA321I  INVALID PARAMETER SYNTAX '
MESG04B  DC    CL8'        '
         DC   CL3' - '
MESG04C  DC   CL20'                    '
MEND04   EQU   *                   MESSAGE END ADDRESS
         SPACE 1
MESG05   DS    0F                  MESSAGE START ADDRESS
         IEAPMNIP   TYPE=HEADER,MSGST=MESG05,MSGEND=MEND05
         DC    CL45'IEA216I  GETMAIN FAILED DURING INITIALIZATION'
MEND05   EQU   *                   MESSAGE END ADDRESS
         SPACE 1
MESG06   DS    0F                  MESSAGE START ADDRESS
         IEAPMNIP   TYPE=HEADER,MSGST=MESG06,MSGEND=MEND06
         DC    CL27'IEA326I  LOCATE FAILED FOR '
MESG06B  DC    CL12'            '
MEND06   EQU   *                   MESSAGE END ADDRESS
         SPACE 1
MESG07   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG07,MSGEND=MEND07
         DC    CL8'IEA324I '
MESG07A  DC    CL4'    '
         DC    CL21' INPUT TERMINATED IN '
MESG07B  DC    CL8'        '
MEND07   EQU   *
         SPACE 1
MESG08   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG08,MSGEND=MEND08
MESG08A  DC    CL30'                              '
         DC    CL41'                                         '
MEND08   EQU   *
         SPACE 1
MESG09   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG09,MSGEND=MEND09
         DC    CL23'IEA323I OPI INVALID IN '
MESG09A  DC    CL8'        '
MEND09   EQU   *
         SPACE 1
MESG10   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG10,MSGEND=MEND10
         DC    CL16'IEA322A INVALID '
MESG10A  DC    CL4'    '
         DC    CL27' PARM - RESPECIFY OR CANCEL'
MEND10   EQU   *
         SPACE 1
MESG11   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG11,MSGEND=MEND11
         DC    CL8'IEA208I '
MESG11A  DC    CL6'      '
         DC    CL21' FUNCTION INOPERATIVE'
MEND11   EQU   *
         SPACE 1
MESG12   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG12,MSGEND=MEND12
         DC    CL8'IEA328I '
MESG12B   DC     CL8'LNKLST00'
          DC     CL20' INPUT TRUNCATED AT '
MESG12A  DC    CL44'                                            '
MEND12   EQU   *
         SPACE 1
MESG13   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG13,MSGEND=MEND13
         DC    CL41'IEA327I LINK LIBRARY DATA SETS NOT FOUND'
MEND13   EQU   *
         SPACE 1
MESG14   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG14,MSGEND=MEND14
MESG14A  DC    CL44'                                            '
MEND14   EQU   *
         SPACE 1
MESG17   DS    0F
         IEAPMNIP TYPE=HEADER,MSGST=MESG17,MSGEND=MEND17
         DC    CL14'IEA325I IEASYS'
MESG17A  DC    CL2'  '
         DC    CL15' PARAMETER LIST'
MEND17   EQU   *
         SPACE 1
IEAVNP03 CSECT
LOCLIB   CAMLST     NAME,LCNAM,,LCDIR  LOCATE PARAMETER LIST
LCNAM    DC    CL44'SYS1.LINKLIB                                '
         DS    0D
LCDIR    DS    265C                    VOLUME LIST READIN AREA
IEAVNP03 CSECT
MESGNP01   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP  TYPE=HEADER,MSGST=MESGNP01,MSGEND=MENDNP01  Y02752
           DC  CL18'IEA906A RESPECIFY '                          Y02752
NP3PID01   DC  CL8'        '                                     Y02752
           DC  CL19'PARM OR ENTER EOB  '                         Y02752
MENDNP01   EQU *                                                 Y02752
           SPACE 1                                               Y02752
MESGNP02   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP  TYPE=HEADER,MSGST=MESGNP02,MSGEND=MENDNP02  Y02752
           DC  CL16'IEA332A SPECIFY '                            Y02752
NP3PID02   DC  CL8'        '                                     Y02752
MENDNP02   EQU *                                                 Y02752
           SPACE 1                                               Y02752
MESGNP03   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP  TYPE=HEADER,MSGST=MESGNP03,MSGEND=MENDNP03  Y02752
           DC  CL34'IEA310A INVALID REPLY - RESPECIFY '          Y02752
MENDNP03   EQU *                                                 Y02752
NP3PID03   DC  CL8'        '                                     Y02752
           SPACE 1                                               Y02752
MESGNP04   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP  TYPE=HEADER,MSGST=MESGNP04,MSGEND=MENDNP04  Y02752
           DC  CL17'IEA330A CONTINUE '                           Y02752
NP3PID04   DC  CL8'        '                                     Y02752
           DC  CL5'PARM '                                        Y02752
MENDNP04   EQU *                                                 Y02752
           SPACE 1                                               Y02752
NPPLIST1   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP TYPE=PLIST,RMSGST=SQARBUF,MSGST=MESGNP01     Y02752
           SPACE 1                                               Y02752
NPPLIST2   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP TYPE=PLIST,RMSGST=SQARBUF,MSGST=MESGNP02     Y02752
           SPACE 1                                               Y02752
NPPLIST3   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP TYPE=PLIST,RMSGST=SQARBUF,MSGST=MESGNP03     Y02752
           SPACE 1                                               Y02752
NPPLIST4   DS  0F                  MESSAGE START ADDR            Y02752
           IEAPMNIP TYPE=PLIST,RMSGST=SQARBUF,MSGST=MESGNP04     Y02752
IEAVNP03 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SCANREG  EQU   @08
RPARM    EQU   @01
RPARMNEG EQU   @01
RPRM1    EQU   @01
BFRADDR  EQU   @04
OPERREG  EQU   @07
PARMREG  EQU   @04
PLIBREG  EQU   @07
INDEXREG EQU   @05
COUNTREG EQU   @06
SYMBLREG EQU   @09
OFFSTREG EQU   @04
GETMRTCD EQU   @15
LOCREG   EQU   @15
CVTPTR   EQU   @03
DSNCTR   EQU   @06
IOBPRPTR EQU   @09
RNVT     EQU   @02
RCVT     EQU   @03
REXIT    EQU   @14
RENTRY   EQU   @15
NP3BKLN  EQU   @07
NP3BKADR EQU   @04
NIPPMR00 EQU   @00
NIPPMR01 EQU   @01
NIPPMR02 EQU   @02
NIPPMR13 EQU   @13
NIPPMR14 EQU   @14
NIPPMR15 EQU   @15
LNGTHFLD EQU   @07
NIPPMR06 EQU   @06
NIPPMR09 EQU   @09
NIPPMR12 EQU   @12
UCBDCPTR EQU   @09
IOBPREFX EQU   0
IOBCFLG1 EQU   IOBPREFX
IOBSTDRD EQU   0
IOBFLAG1 EQU   IOBSTDRD
IOBCYCCK EQU   IOBFLAG1
IOBRSTRT EQU   IOBFLAG1
IOBFLAG2 EQU   IOBSTDRD+1
IOBPURGE EQU   IOBFLAG2
IOBRDHA0 EQU   IOBFLAG2
IOBSENS0 EQU   IOBSTDRD+2
IOBS0B7  EQU   IOBSENS0
IOBSENS1 EQU   IOBSTDRD+3
IOBECBPT EQU   IOBSTDRD+4
IOBFLAG3 EQU   IOBSTDRD+8
IOBFL3   EQU   IOBFLAG3
IOBCNC   EQU   IOBFL3
IOBICL   EQU   IOBFL3
IOBCSW   EQU   IOBSTDRD+9
IOBIOCSW EQU   IOBCSW
IOBSTBYT EQU   IOBIOCSW+3
IOBUSTAT EQU   IOBSTBYT
IOBCSTAT EQU   IOBSTBYT+1
IOBSTART EQU   IOBSTDRD+16
IOBDCBPT EQU   IOBSTDRD+20
IOBFLAG4 EQU   IOBDCBPT
IOBRESTR EQU   IOBSTDRD+24
IOBINCAM EQU   IOBSTDRD+28
IOBBTAMF EQU   IOBINCAM
IOBERRCT EQU   IOBSTDRD+30
ECB      EQU   0
ECBRB    EQU   ECB
ECBEVTB  EQU   ECBRB
ECBEXTB  EQU   ECBEVTB
ECBCC    EQU   ECBEXTB
ECBCCCNT EQU   ECBEXTB+1
ECBRBA   EQU   ECBCCCNT
ECBEVTBA EQU   ECBRBA
ECBEXTBA EQU   ECBEVTBA
ECBBYTE3 EQU   ECBEXTBA+2
ECBEXTND EQU   ECBBYTE3
NVT      EQU   0
NVTNPATR EQU   NVT+54
NVTNPREN EQU   NVTNPATR
NVTFLLB  EQU   NVT+55
NVTABSAV EQU   NVT+140
NVTFLCN  EQU   NVT+211
NVTWTPSW EQU   NVT+224
NVTWPSW2 EQU   NVTWTPSW+4
NVTFLWSC EQU   NVTWPSW2+3
NVTLOAD  EQU   NVT+232
NVTSENSE EQU   NVT+236
NVTSWAIT EQU   NVT+240
NVTTIME  EQU   NVT+244
NVTUCBFN EQU   NVT+248
NVTWTO   EQU   NVT+252
NVTWTOR  EQU   NVT+256
NVTWTOR2 EQU   NVT+260
NVTOPEN  EQU   NVT+264
NVTMOUNT EQU   NVT+268
NVTVIRT  EQU   NVT+276
NVTREAL  EQU   NVT+280
NVTSCHED EQU   NVT+284
NVTOPIO  EQU   NVT+288
NVTSPE   EQU   NVT+344
NVTPAREA EQU   NVT+368
NVTPTAB  EQU   NVT+372
NVTSPUCB EQU   NVT+382
NVTXCTL  EQU   NVT+428
NVTLOCAT EQU   NVT+436
NVTFLPO  EQU   NVT+528
NVTFLLST EQU   NVTFLPO
NVTSYSP  EQU   NVTFLPO
NWTOHDR  EQU   0
NWTOLNG  EQU   NWTOHDR
NWTOFL   EQU   NWTOHDR+2
NWTORLST EQU   0
NWTORFL  EQU   NWTORLST+10
NIPSPE   EQU   0
NIPSPEQ  EQU   NIPSPE
NIPSPEA  EQU   NIPSPE+4
NIPMNTPL EQU   0
NMNTDS   EQU   NIPMNTPL
NMNTDSA  EQU   NMNTDS
NMNTVS   EQU   NIPMNTPL+12
NMNTDT   EQU   NIPMNTPL+18
NMNTFL   EQU   NIPMNTPL+20
NIPOPNPL EQU   0
NOPNDS   EQU   NIPOPNPL
NOPNDSA  EQU   NOPNDS
NOPNDCB  EQU   NIPOPNPL+12
NOPNUCB  EQU   NIPOPNPL+16
NOPNFL   EQU   NIPOPNPL+20
NIPSCHDL EQU   0
NIPPAHDR EQU   0
NIPPAQ   EQU   NIPPAHDR
NIPPABYT EQU   NIPPAHDR+4
NIPPAREA EQU   0
NIPPARC  EQU   NIPPAREA+8
NIPPABDL EQU   NIPPAREA+12
NIPPABDH EQU   NIPPABDL
NIPPA2BF EQU   NIPPABDH
NIPPANAM EQU   NIPPABDL+4
NIPPATTR EQU   NIPPABDL+12
NIPPAIOD EQU   NIPPAREA+32
NIPPATXT EQU   NIPPAIOD
NIPPASID EQU   NIPPAIOD+32
NIPPAIOB EQU   NIPPAIOD+40
NIPPADCB EQU   NIPPAIOD+80
NIPPAECB EQU   NIPPAIOD+84
NIPPAECC EQU   NIPPAECB
NIPPADEB EQU   NIPPAIOD+88
NIPPARCD EQU   NIPPAIOD+136
NIPPAPTB EQU   NIPPAREA+252
NIPPABUF EQU   NIPPAREA+572
PARMTAB  EQU   0
PTABSTRT EQU   PARMTAB
LNK      EQU   PARMTAB+120
@NM00068 EQU   PARMTAB+272
NIPPAFLG EQU   @NM00068
NIPPAFL1 EQU   NIPPAFLG
NIPPTE   EQU   0
NIPPTADR EQU   NIPPTE
NIPPTOPF EQU   NIPPTE+4
NIPPTOPI EQU   NIPPTOPF
NIPPTLST EQU   NIPPTOPF
NIPPTCAN EQU   NIPPTOPF
NIPPTATF EQU   NIPPTE+5
NIPPTMRG EQU   NIPPTATF
NIPPTSID EQU   NIPPTE+6
CVTMAP   EQU   0
CVTLINK  EQU   CVTMAP+8
CVTPCNVT EQU   CVTMAP+28
CVTSYSAD EQU   CVTMAP+48
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00082 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
NP3RTRN0 EQU   0
NP3SYPA0 EQU   0
NP3RTRN4 EQU   4
NP3RTRN8 EQU   8
NP3PRTR0 EQU   0
NP3SRTN0 EQU   0
NP3SRTN4 EQU   4
NP3SRTN8 EQU   8
NP3POAD0 EQU   0
NP3RTAD0 EQU   0
OPLIBTAB EQU   0
OPSPDUM1 EQU   OPLIBTAB
OPSPCONT EQU   OPLIBTAB+112
OPSPOPI  EQU   OPLIBTAB+336
OPSPPGPM EQU   OPLIBTAB+368
OPSPSYSP EQU   OPLIBTAB+448
OPLIBENT EQU   0
ORAD     EQU   OPLIBENT
OPFLAG   EQU   OPLIBENT+4
OPIOPT   EQU   OPFLAG
LISTOPT  EQU   OPFLAG
CANOPT   EQU   OPFLAG
ATTRFLAG EQU   OPLIBENT+5
MRGOP    EQU   ATTRFLAG
INSRCID  EQU   OPLIBENT+6
ORLN     EQU   OPLIBENT+8
CONTLN   EQU   OPLIBENT+10
CONTAD   EQU   OPLIBENT+12
DCBSTART EQU   0
OPREPLY1 EQU   0
OPREPLY2 EQU   0
OPREPLY3 EQU   0
OPREPLY4 EQU   0
OPERVAL  EQU   0
PARMTABC EQU   0
OPERTABC EQU   0
PARMTABO EQU   0
SYMBLID  EQU   0
NP3SCAN5 EQU   0
NP3SCAN4 EQU   NP3SCAN5
NP3SCAN3 EQU   NP3SCAN4
NP3SCAN2 EQU   NP3SCAN3
NP3SCANR EQU   NP3SCAN2
NP3SCAN7 EQU   0
NP3SCAN8 EQU   0
NP3LCHAR EQU   0
NP3TABSB EQU   0
NP3SUBSP EQU   0
SCNPAREN EQU   0
BALNCONT EQU   0
NP3ERCHR EQU   0
LNKLIB   EQU   0
MSGBUFF  EQU   0
MSGBUFF1 EQU   MSGBUFF
LNKNAME  EQU   0
LNKFLAG  EQU   LNKNAME
DSNAME   EQU   LNKNAME+1
LNKVOLID EQU   LNKNAME+45
LNKAREA  EQU   0
DSN      EQU   0
NP3SCANC EQU   0
NPSYSP   EQU   0
NP3CLEAR EQU   0
LNKPARMS EQU   0
NIPPMAD0 EQU   0
NIPPMAD4 EQU   0
NIPPMBYT EQU   0
NIPPMBUF EQU   0
NIPPMSID EQU   0
NIPPMCC  EQU   NIPPMSID
NIPPMHH  EQU   NIPPMSID+2
NIPPMR   EQU   NIPPMSID+4
NIPPMCSW EQU   0
NIPPMCS2 EQU   NIPPMCSW+3
NIPPMME1 EQU   0
NIPPMME2 EQU   0
ISYMBL   EQU   0
NP3BFRCL EQU   0
PARMVAL  EQU   0
UCBBGN   EQU   0
IOBORG01 EQU   IOBPREFX+8
IOBNIOBA EQU   IOBORG01
IOBNFLG1 EQU   IOBNIOBA
IOBPRTOV EQU   IOBNFLG1
IOBORG02 EQU   IOBPREFX+8
IOBDQADA EQU   IOBORG02
IOBDEQIN EQU   IOBDQADA
IOBORG03 EQU   IOBPREFX+12
IOBORG04 EQU   IOBINCAM
IOBORG12 EQU   IOBINCAM
IOBFL4   EQU   IOBORG12
IOBEXTEN EQU   IOBSTDRD+32
IOBSEEK  EQU   IOBEXTEN
IOBBB    EQU   IOBSEEK+1
IOBCC    EQU   IOBSEEK+3
IOBHH    EQU   IOBSEEK+5
IOBORG05 EQU   IOBEXTEN
IOBORG06 EQU   IOBEXTEN
IOBNXTPT EQU   IOBORG06+4
IOBSTATA EQU   IOBNXTPT
IOBORG07 EQU   IOBEXTEN+8
W1IEXTEN EQU   IOBORG07
IOBORG08 EQU   IOBEXTEN+8
IOBINDCT EQU   IOBORG08+4
IOBUNSQR EQU   IOBORG08+5
IOBFCHAD EQU   IOBORG08+8
IOBORG09 EQU   IOBEXTEN+8
IOBDPLAD EQU   IOBORG09+4
IOBDTYPE EQU   IOBORG09+8
IOBDTYP2 EQU   IOBORG09+9
IOBDSTAT EQU   IOBORG09+10
IOBSTAT1 EQU   IOBDSTAT
IOBORG10 EQU   IOBEXTEN+8
IOBSEEK2 EQU   IOBORG10
IOBORG11 EQU   IOBEXTEN
IOBERCT  EQU   IOBORG11
IOBUCBXV EQU   IOBERCT
IOBNAME  EQU   IOBORG11+4
IOBORG13 EQU   IOBEXTEN
IOBSKADR EQU   IOBORG13
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBUSER  EQU   UCBOBS01+14
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00081 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
DCB      EQU   NIPPADCB
DCBDEBAD EQU   DCB
NP3VLBLK EQU   LCDIR
NP3DVTYP EQU   NP3VLBLK+4
NP3VOLSR EQU   NP3VLBLK+6
OPREPLY5 EQU   MESG03B
PRMIGNOR EQU   MESG03B
SYMLNGTH EQU   MESG03L
SYMBREP  EQU   MESG03L
NP3ECHMV EQU   MESG04B
NP3ECHMI EQU   MESG04B+1
NP3LOCER EQU   MESG06B
NP3MSGCL EQU   MESG03B
PRMLIB   EQU   LCNAM
STRING   EQU   MESG08A
PARM     EQU   MESG07A
NAME     EQU   MESG07B
XX       EQU   MESG17A
SYSPNAME EQU   MESG10A
LKNAME   EQU   MESG11A
SYSNAME  EQU   MESG09A
CAUSE04  EQU   MESG04C
NP3PMCLR EQU   PTABLN
NP3PMCL0 EQU   PTABLN+256
NP3TBCLR EQU   OPTABLN
NP3TBCL0 EQU   OPTABLN+256
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00094 EQU   NP3VLBLK+12
@NM00093 EQU   NP3VLBLK+2
@NM00092 EQU   NP3VLBLK
DCBFLGS  EQU   DCB+4
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00081
UCBSKPFG EQU   @NM00081
UCBRIPND EQU   @NM00081
UCBRTIAC EQU   @NM00081
UCBRSV79 EQU   @NM00081
UCBRSV78 EQU   @NM00081
UCBRSV77 EQU   @NM00081
UCBOLTEP EQU   @NM00081
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00080 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
IOBSKSS  EQU   IOBSKADR+3
IOBSK0   EQU   IOBSKADR+2
IOBSKTT  EQU   IOBSKADR+1
IOBSKRV  EQU   IOBSKADR
IOBCSWSV EQU   IOBORG11+17
IOBSENSV EQU   IOBORG11+16
IOBRCD   EQU   IOBORG11+12
IOBMDREC EQU   IOBORG11+8
IOBNAMEA EQU   IOBNAME+1
IOBNAMSZ EQU   IOBNAME
IOBERCTA EQU   IOBERCT+1
IOBRTYPE EQU   IOBUCBXV
IOBRDCHP EQU   IOBORG10+20
IOBNEXTA EQU   IOBORG10+16
IOBREADA EQU   IOBORG10+12
IOBBUFC  EQU   IOBORG10+8
IOBSK2R  EQU   IOBSEEK2+7
IOBSK2HH EQU   IOBSEEK2+5
IOBSK2CC EQU   IOBSEEK2+3
IOBSK2BB EQU   IOBSEEK2+1
IOBSK2M  EQU   IOBSEEK2
IOBCHNPR EQU   IOBORG09+40
IOBDNCRF EQU   IOBORG09+32
IOBRSV35 EQU   IOBORG09+24
IOBDQPTR EQU   IOBORG09+20
IOBRSV34 EQU   IOBORG09+18
IOBDBYTN EQU   IOBORG09+16
IOBDCPND EQU   IOBORG09+12
IOBSTAT2 EQU   IOBDSTAT+1
IOBSIORT EQU   IOBSTAT1
IOBADDVU EQU   IOBSTAT1
IOBBUFF  EQU   IOBSTAT1
IOBENQUE EQU   IOBSTAT1
IOBPASS2 EQU   IOBSTAT1
IOBSYNCH EQU   IOBSTAT1
IOBNEWVL EQU   IOBSTAT1
IOBABNRM EQU   IOBSTAT1
IOBRELEX EQU   IOBDTYP2
IOBADDTY EQU   IOBDTYP2
IOBTYPE  EQU   IOBDTYP2
IOBRQUST EQU   IOBDTYP2
IOBSUFFX EQU   IOBDTYP2
IOBSBLKL EQU   IOBDTYP2
IOBSKEY  EQU   IOBDTYP2
IOBRELBL EQU   IOBDTYPE
IOBRDEXC EQU   IOBDTYPE
IOBDYNBF EQU   IOBDTYPE
IOBACTAD EQU   IOBDTYPE
IOBFDBCK EQU   IOBDTYPE
IOBEXTSC EQU   IOBDTYPE
IOBOVFLO EQU   IOBDTYPE
IOBVERFY EQU   IOBDTYPE
IOBDPLB  EQU   IOBDPLAD+1
IOBDAYLI EQU   IOBDPLAD
IOBDIOBS EQU   IOBORG09+2
IOBDBYTR EQU   IOBORG09
IOBBCHAD EQU   IOBORG08+12
IOBFCHNB EQU   IOBFCHAD+1
IOBCOUNT EQU   IOBFCHAD
IOBASYN  EQU   IOBORG08+7
IOBAPP   EQU   IOBORG08+6
IOBRSV32 EQU   IOBUNSQR
IOBRSV31 EQU   IOBUNSQR
IOBRSV30 EQU   IOBUNSQR
IOBKNRWR EQU   IOBUNSQR
IOBKNWR  EQU   IOBUNSQR
IOBNTAV2 EQU   IOBUNSQR
IOBNTAV1 EQU   IOBUNSQR
IOBCPBSY EQU   IOBUNSQR
IOBCHNNL EQU   IOBINDCT
IOBRSV29 EQU   IOBINDCT
IOBRSV28 EQU   IOBINDCT
IOBRSV27 EQU   IOBINDCT
IOBKEYAD EQU   IOBINDCT
IOBOVPTR EQU   IOBINDCT
IOBUNSCH EQU   IOBINDCT
IOBDEQCP EQU   IOBINDCT
IOBCCWAD EQU   IOBORG08
W1OEXTEN EQU   W1IEXTEN
IOBCCW   EQU   IOBORG06+8
IOBNXTPB EQU   IOBNXTPT+1
IOBRSV26 EQU   IOBSTATA
IOBRSV25 EQU   IOBSTATA
IOBRSV24 EQU   IOBSTATA
IOBRSV23 EQU   IOBSTATA
IOBRSV22 EQU   IOBSTATA
IOBRSV21 EQU   IOBSTATA
IOBRSV20 EQU   IOBSTATA
IOBAVLFL EQU   IOBSTATA
IOBRSV37 EQU   IOBORG06+1
IOBUCBXG EQU   IOBORG06
IOBCPA   EQU   IOBORG05+32
IOBERINF EQU   IOBORG05+16
IOBERCCW EQU   IOBORG05+8
IOBSNDPT EQU   IOBORG05+7
IOBRCVPT EQU   IOBORG05+6
IOBWORK  EQU   IOBORG05+1
IOBUCBX  EQU   IOBORG05
IOBR     EQU   IOBSEEK+7
IOBHH2   EQU   IOBHH+1
IOBHH1   EQU   IOBHH
IOBCC2   EQU   IOBCC+1
IOBCC1   EQU   IOBCC
IOBBB2   EQU   IOBBB+1
IOBBB1   EQU   IOBBB
IOBM     EQU   IOBSEEK
IOBRSV46 EQU   IOBFL4
IOBRSV47 EQU   IOBFL4
IOBENT   EQU   IOBFL4
IOBEQP   EQU   IOBFL4
IOBBUS   EQU   IOBFL4
IOBDCK   EQU   IOBFL4
IOBREJ   EQU   IOBFL4
IOBOVR   EQU   IOBFL4
IOBCRILC EQU   IOBORG04+1
IOBCRDCC EQU   IOBORG04
IOBGQECB EQU   IOBORG03
IOBSWAP  EQU   IOBORG02+4
IOBDQADB EQU   IOBDQADA+1
IOBRSV13 EQU   IOBDEQIN
IOBRSV12 EQU   IOBDEQIN
IOBRSV11 EQU   IOBDEQIN
IOBRSV10 EQU   IOBDEQIN
IOBRSV09 EQU   IOBDEQIN
IOBRSV08 EQU   IOBDEQIN
IOBRSV07 EQU   IOBDEQIN
IOBDEQ   EQU   IOBDEQIN
IOBNECB  EQU   IOBORG01+4
IOBNIOBB EQU   IOBNIOBA+1
IOBFIRST EQU   IOBNFLG1
IOBUPERR EQU   IOBNFLG1
IOBSPAN  EQU   IOBNFLG1
IOBBKSPC EQU   IOBNFLG1
IOBUPDAT EQU   IOBNFLG1
IOBREAD  EQU   IOBNFLG1
IOBWRITE EQU   IOBNFLG1
IOBSEGMT EQU   IOBPRTOV
@NM00162 EQU   NIPPMCSW+4
@NM00161 EQU   NIPPMCSW
MSGBUFF2 EQU   MSGBUFF+1
@NM00085 EQU   ATTRFLAG
@NM00084 EQU   OPFLAG
OPSPDUM2 EQU   OPLIBTAB+624
OPSPDUPL EQU   OPLIBTAB+608
OPSPPAGN EQU   OPLIBTAB+592
OPSPSWAP EQU   OPLIBTAB+576
OPSPRSU  EQU   OPLIBTAB+560
OPSPFLG  EQU   OPLIBTAB+544
OPSPPURG EQU   OPLIBTAB+528
OPSPWTOR EQU   OPLIBTAB+512
OPSPWTOB EQU   OPLIBTAB+496
OPSPVRRG EQU   OPLIBTAB+480
OPSPVAP  EQU   OPLIBTAB+464
OPSPSQA  EQU   OPLIBTAB+432
OPSPSMF  EQU   OPLIBTAB+416
OPSPREAL EQU   OPLIBTAB+400
OPSPPGOP EQU   OPLIBTAB+384
OPSPOPT  EQU   OPLIBTAB+352
OPSPNUCM EQU   OPLIBTAB+320
OPSPMLPA EQU   OPLIBTAB+304
OPSPMAXU EQU   OPLIBTAB+288
OPSPLOGL EQU   OPLIBTAB+272
OPSPLOGC EQU   OPLIBTAB+256
OPSPLNK  EQU   OPLIBTAB+240
OPSPIPS  EQU   OPLIBTAB+224
OPSPHDCP EQU   OPLIBTAB+208
OPSPFIX  EQU   OPLIBTAB+192
OPSPDUMP EQU   OPLIBTAB+176
OPSPCVAM EQU   OPLIBTAB+160
OPSPCSA  EQU   OPLIBTAB+144
OPSPCPQE EQU   OPLIBTAB+128
OPSPCMD  EQU   OPLIBTAB+96
OPSPCLPA EQU   OPLIBTAB+80
OPSPBLDF EQU   OPLIBTAB+64
OPSPBLDL EQU   OPLIBTAB+48
OPSPAPGP EQU   OPLIBTAB+32
OPSPAPF  EQU   OPLIBTAB+16
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00082
UCBHALI  EQU   @NM00082
UCBRSV09 EQU   @NM00082
UCBRSV08 EQU   @NM00082
UCBRSV07 EQU   @NM00082
UCBRSV06 EQU   @NM00082
UCBRSV05 EQU   @NM00082
UCBRSV04 EQU   @NM00082
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00079 EQU   UCB
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00078 EQU   CVTFIX+248
@NM00077 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00076 EQU   NIPPTATF
@NM00075 EQU   NIPPTOPF
PTABEND  EQU   PARMTAB+312
@NM00074 EQU   PARMTAB+308
DUPLEX   EQU   PARMTAB+304
@NM00073 EQU   PARMTAB+300
PAGNUM   EQU   PARMTAB+296
@NM00072 EQU   PARMTAB+292
SWAP     EQU   PARMTAB+288
@NM00071 EQU   PARMTAB+284
RSU      EQU   PARMTAB+280
@NM00070 EQU   @NM00068+1
@NM00069 EQU   NIPPAFLG
@NM00067 EQU   PARMTAB+268
PURGE    EQU   PARMTAB+264
@NM00066 EQU   PARMTAB+260
WTORPLY  EQU   PARMTAB+256
@NM00065 EQU   PARMTAB+252
WTOBFRS  EQU   PARMTAB+248
@NM00064 EQU   PARMTAB+244
VRREGN   EQU   PARMTAB+240
@NM00063 EQU   PARMTAB+236
VAL      EQU   PARMTAB+232
@NM00062 EQU   PARMTAB+228
SYSP     EQU   PARMTAB+224
@NM00061 EQU   PARMTAB+220
SQA      EQU   PARMTAB+216
@NM00060 EQU   PARMTAB+212
SMF      EQU   PARMTAB+208
@NM00059 EQU   PARMTAB+204
REAL     EQU   PARMTAB+200
@NM00058 EQU   PARMTAB+196
PAGEO    EQU   PARMTAB+192
@NM00057 EQU   PARMTAB+188
PAGEP    EQU   PARMTAB+184
@NM00056 EQU   PARMTAB+180
OPT      EQU   PARMTAB+176
@NM00055 EQU   PARMTAB+172
OPI      EQU   PARMTAB+168
@NM00054 EQU   PARMTAB+164
NUCMAP   EQU   PARMTAB+160
@NM00053 EQU   PARMTAB+156
MLPA     EQU   PARMTAB+152
@NM00052 EQU   PARMTAB+148
MAXUSER  EQU   PARMTAB+144
@NM00051 EQU   PARMTAB+140
LOGLMT   EQU   PARMTAB+136
@NM00050 EQU   PARMTAB+132
LOGCLS   EQU   PARMTAB+128
@NM00049 EQU   PARMTAB+124
@NM00048 EQU   PARMTAB+116
IPS      EQU   PARMTAB+112
@NM00047 EQU   PARMTAB+108
HARDCPY  EQU   PARMTAB+104
@NM00046 EQU   PARMTAB+100
FIX      EQU   PARMTAB+96
@NM00045 EQU   PARMTAB+92
DUMP     EQU   PARMTAB+88
@NM00044 EQU   PARMTAB+84
CVIO     EQU   PARMTAB+80
@NM00043 EQU   PARMTAB+76
CSA      EQU   PARMTAB+72
@NM00042 EQU   PARMTAB+68
CPQE     EQU   PARMTAB+64
@NM00041 EQU   PARMTAB+60
CONT     EQU   PARMTAB+56
@NM00040 EQU   PARMTAB+52
CMD      EQU   PARMTAB+48
@NM00039 EQU   PARMTAB+44
CLPA     EQU   PARMTAB+40
@NM00038 EQU   PARMTAB+36
BLDLF    EQU   PARMTAB+32
@NM00037 EQU   PARMTAB+28
BLDL     EQU   PARMTAB+24
@NM00036 EQU   PARMTAB+20
APG      EQU   PARMTAB+16
@NM00035 EQU   PARMTAB+12
APF      EQU   PARMTAB+8
@NM00034 EQU   NIPPAREA+248
@NM00033 EQU   NIPPAECB+1
@NM00032 EQU   NIPPAIOD+37
@NM00031 EQU   NIPPAREA+30
@NM00030 EQU   NIPPABDL+15
@NM00029 EQU   NIPPAREA
NSCHDCPU EQU   NIPSCHDL+8
NSCHDPRM EQU   NIPSCHDL+4
NSCHDPTR EQU   NIPSCHDL
@NM00028 EQU   NIPOPNPL+22
NOPNRC   EQU   NIPOPNPL+21
NOPNFLSX EQU   NOPNFL
NOPNFLLC EQU   NOPNFL
NOPNFLLB EQU   NOPNFL
NOPNFLNB EQU   NOPNFL
NOPNFLI  EQU   NOPNFL
NOPNFLM  EQU   NOPNFL
NOPNFAU  EQU   NOPNFL
NOPNFRS  EQU   NOPNFL
@NM00027 EQU   NIPMNTPL+21
NMNTFLB  EQU   NMNTFL
NMNTFLC  EQU   NMNTFL
NMNTFLI  EQU   NMNTFL
NMNTFUS  EQU   NMNTFL
@NM00026 EQU   NMNTFL
NMNTUCB  EQU   NMNTVS
NWTORMSG EQU   NWTORLST+12
@NM00025 EQU   NWTORLST+11
@NM00024 EQU   NWTORFL
NWTORFLB EQU   NWTORFL
@NM00023 EQU   NWTORFL
NWTORFLA EQU   NWTORFL
NMTORRDL EQU   NWTORLST+8
NWTORECB EQU   NWTORLST+4
NWTORRPA EQU   NWTORLST
@NM00022 EQU   NWTOFL
NWTOFLNC EQU   NWTOFL
NWTOFLNH EQU   NWTOFL
NVTLPAHA EQU   NVT+548
NVTLPALO EQU   NVT+544
NVTRMSG  EQU   NVT+540
NVTRLOCK EQU   NVT+536
NVTRCODE EQU   NVT+532
@NM00021 EQU   NVT+529
@NM00020 EQU   NVTFLPO
NVTFLWS  EQU   NVTFLPO
NVTFLQS  EQU   NVTFLPO
@NM00019 EQU   NVTFLPO
NVTRSV48 EQU   NVT+524
NVTRSV47 EQU   NVT+520
NVTRSV46 EQU   NVT+516
@NM00018 EQU   NVT+512
NVTREALR EQU   NVT+508
NVTFASVT EQU   NVT+504
NVTRSV45 EQU   NVT+496
NVTVRLNG EQU   NVT+492
NVTVRREG EQU   NVT+488
NVTLVIRT EQU   NVT+484
NVTRSV4A EQU   NVT+480
NVTLPAND EQU   NVT+476
NVTRMSS  EQU   NVT+472
NVTRPQE  EQU   NVT+468
NVTRLLE  EQU   NVT+464
NVTRJPQ  EQU   NVT+460
NVTVMSS  EQU   NVT+456
NVTVPQE  EQU   NVT+452
NVTVLLE  EQU   NVT+448
NVTVJPQ  EQU   NVT+444
NVTLSEC  EQU   NVTLOCAT+4
NVTLFST  EQU   NVTLOCAT
NVTXSEC  EQU   NVTXCTL+4
NVTXFST  EQU   NVTXCTL
@NM00017 EQU   NVT+425
NVTLPACT EQU   NVT+424
NVTCSLPG EQU   NVT+420
NVTCSIOB EQU   NVT+416
NVTCSLNM EQU   NVT+412
NVTCSLIB EQU   NVT+408
NVTBLDL  EQU   NVT+404
NVTVRBLD EQU   NVT+400
@NM00016 EQU   NVT+392
NVTVRTCB EQU   NVT+388
NVTVVTCB EQU   NVT+384
NVTRSV44 EQU   NVT+380
NVTQSBUF EQU   NVT+376
NVTRSV43 EQU   NVT+364
@NM00015 EQU   NVT+363
NVTABWS1 EQU   NVT+362
NVTABCD1 EQU   NVT+360
@NM00014 EQU   NVT+358
NVTCPUAD EQU   NVT+356
NVTTOD   EQU   NVT+352
NVTMBEND EQU   NVT+340
NVTMBUF  EQU   NVT+336
NVTDCBSN EQU   NVT+332
NVTDCBOC EQU   NVT+328
NVTDCBIC EQU   NVT+324
@NM00013 EQU   NVT+308
NVTNMBLD EQU   NVT+304
NVTNIPM  EQU   NVT+292
NVTPRMPT EQU   NVT+272
NVTIX    EQU   NVTFLWSC
NVTFLWS1 EQU   NVTWPSW2+2
NVTIDPSW EQU   NVTWPSW2
NVTWPSW1 EQU   NVTWTPSW
NVTMCPSW EQU   NVT+216
@NM00012 EQU   NVT+212
@NM00011 EQU   NVTFLCN
NVTFLRAC EQU   NVTFLCN
NVTFLNCK EQU   NVTFLCN
NVTFLNHC EQU   NVTFLCN
NVTFLASM EQU   NVTFLCN
NVTMP    EQU   NVTFLCN
NVTFLIOC EQU   NVTFLCN
NVTFLAC  EQU   NVTFLCN
NVTFLSG  EQU   NVT+210
NVTTRACE EQU   NVT+208
NVTNXPTR EQU   NVT+204
NVTNXSIZ EQU   NVT+202
@NM00010 EQU   NVT+200
NVTSGPSA EQU   NVT+196
NVTN0MSG EQU   NVT+192
NVTVVPG1 EQU   NVT+188
NVTNBFND EQU   NVT+184
NVTNUCND EQU   NVT+180
NVTSTMAP EQU   NVT+176
NVTRTMSA EQU   NVT+172
NVTMFASA EQU   NVT+168
NVTLSPQE EQU   NVT+164
NVTALSQA EQU   NVT+160
NVTPQSAV EQU   NVT+156
NVTSVC60 EQU   NVT+148
NVTABSEC EQU   NVTABSAV+4
NVTABFST EQU   NVTABSAV
NVTNVSQA EQU   NVT+138
NVTRSVMN EQU   NVT+136
NVTNBMIN EQU   NVT+134
NVTRGNAV EQU   NVT+132
NVTLSQNO EQU   NVT+130
NVTSQANO EQU   NVT+128
NVTLSQAS EQU   NVT+124
NVTLNGFX EQU   NVT+120
NVTIGXER EQU   NVT+116
@NM00009 EQU   NVT+112
NVTRSV49 EQU   NVT+108
NVTNVRSZ EQU   NVT+104
NVTMFA   EQU   NVT+100
NVTDSSNG EQU   NVT+96
NVTMSLNK EQU   NVT+92
NVTVVMDI EQU   NVT+88
NVTIGCER EQU   NVT+84
NVTVBLDL EQU   NVT+80
NVTSVCTB EQU   NVT+76
NVTRSV42 EQU   NVT+72
NVTRSV41 EQU   NVT+68
NVTMASCB EQU   NVT+64
NVTCMTCB EQU   NVT+60
NVTMSTCB EQU   NVT+56
@NM00008 EQU   NVTFLLB
NVTFLSLB EQU   NVTFLLB
@NM00007 EQU   NVTNPATR
NVTNPREU EQU   NVTNPREN
@NM00006 EQU   NVTNPREN
NVTNPSFX EQU   NVT+53
@NM00005 EQU   NVT+52
NVTNPSUF EQU   NVT
ECBEVNT  EQU   ECBEXTND
@NM00004 EQU   ECBEXTND
@NM00003 EQU   ECBBYTE3
@NM00002 EQU   ECBEXTBA
@NM00001 EQU   ECBCC
ECBPOSTB EQU   ECBCC
ECBWAITB EQU   ECBCC
IOBRSV19 EQU   IOBINCAM+1
IOBOLTST EQU   IOBBTAMF
IOBRFTMG EQU   IOBBTAMF
IOBRSV17 EQU   IOBBTAMF
IOBRSV16 EQU   IOBBTAMF
IOBRSV15 EQU   IOBBTAMF
IOBRSV14 EQU   IOBBTAMF
IOBINUSE EQU   IOBBTAMF
IOBPRMER EQU   IOBBTAMF
IOBRSTRB EQU   IOBRESTR+1
IOBREPOS EQU   IOBRESTR
IOBDCBPB EQU   IOBDCBPT+1
IOBRSV44 EQU   IOBFLAG4
IOBJES3I EQU   IOBFLAG4
IOBRSV42 EQU   IOBFLAG4
IOBRSV41 EQU   IOBFLAG4
IOBRSV40 EQU   IOBFLAG4
IOBPMERR EQU   IOBFLAG4
IOBCC3WE EQU   IOBFLAG4
IOBGDPOL EQU   IOBFLAG4
IOBSTRTB EQU   IOBSTART+1
IOBSIOCC EQU   IOBSTART
IOBCSB7  EQU   IOBCSTAT
IOBCSB6  EQU   IOBCSTAT
IOBCSB5  EQU   IOBCSTAT
IOBCSB4  EQU   IOBCSTAT
IOBCSB3  EQU   IOBCSTAT
IOBCSB2  EQU   IOBCSTAT
IOBCSB1  EQU   IOBCSTAT
IOBCSB0  EQU   IOBCSTAT
IOBUSB7  EQU   IOBUSTAT
IOBUSB6  EQU   IOBUSTAT
IOBUSB5  EQU   IOBUSTAT
IOBUSB4  EQU   IOBUSTAT
IOBUSB3  EQU   IOBUSTAT
IOBUSB2  EQU   IOBUSTAT
IOBUSB1  EQU   IOBUSTAT
IOBUSB0  EQU   IOBUSTAT
IOBCMDA  EQU   IOBIOCSW
IOBLOG   EQU   IOBFL3
IOBJAM   EQU   IOBICL
IOBMSG   EQU   IOBFL3
IOBSDR   EQU   IOBCNC
IOBACU   EQU   IOBFL3
IOBCDC   EQU   IOBFL3
IOBICC   EQU   IOBFL3
IOBCCC   EQU   IOBFL3
IOBECBPB EQU   IOBECBPT+1
IOBECBCC EQU   IOBECBPT
IOBS1B7  EQU   IOBSENS1
IOBS1B6  EQU   IOBSENS1
IOBS1B5  EQU   IOBSENS1
IOBS1B4  EQU   IOBSENS1
IOBS1B3  EQU   IOBSENS1
IOBS1B2  EQU   IOBSENS1
IOBS1B1  EQU   IOBSENS1
IOBS1B0  EQU   IOBSENS1
IOBSNSC9 EQU   IOBS0B7
IOBS0B6  EQU   IOBSENS0
IOBS0B5  EQU   IOBSENS0
IOBS0B4  EQU   IOBSENS0
IOBS0B3  EQU   IOBSENS0
IOBS0B2  EQU   IOBSENS0
IOBS0B1  EQU   IOBSENS0
IOBS0B0  EQU   IOBSENS0
IOBPNCH  EQU   IOBFLAG2
IOBSTATO EQU   IOBFLAG2
IOBSKUPD EQU   IOBFLAG2
IOBALTTR EQU   IOBFLAG2
IOBRRT2  EQU   IOBRDHA0
IOBRRT3  EQU   IOBPURGE
IOBSENSE EQU   IOBFLAG2
IOBHALT  EQU   IOBFLAG2
IOBSPSVC EQU   IOBRSTRT
IOBUNREL EQU   IOBFLAG1
IOBIOERR EQU   IOBFLAG1
IOBFCREX EQU   IOBCYCCK
IOBRPSTN EQU   IOBFLAG1
IOBERRTN EQU   IOBFLAG1
IOBCMDCH EQU   IOBFLAG1
IOBDATCH EQU   IOBFLAG1
IOBCNOPA EQU   IOBPREFX+12
IOBCICB  EQU   IOBPREFX+8
IOBCECB  EQU   IOBPREFX+4
IOBCONOP EQU   IOBPREFX+3
IOBCINOP EQU   IOBPREFX+2
IOBRSV05 EQU   IOBPREFX+1
IOBPCI   EQU   IOBCFLG1
IOBRSTCH EQU   IOBCFLG1
IOBABAPP EQU   IOBCFLG1
IOBPTST  EQU   IOBCFLG1
IOBRSV04 EQU   IOBCFLG1
IOBRSV03 EQU   IOBCFLG1
IOBRSV02 EQU   IOBCFLG1
IOBRSV01 EQU   IOBCFLG1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00378 EQU   NP3EXIT
@RT00424 EQU   NP3OPIA
@RT00441 EQU   NP3OPIA
@RT00519 EQU   NP3SYSDE
@RT00522 EQU   NP3SYXIT
@RT00529 EQU   NP3UPDAT
@RF00529 EQU   NP3ALPHA
@RF00538 EQU   NP3SYINV
@RF00536 EQU   NP3SETXX
@RF00534 EQU   NP3SYINV
@RT00581 EQU   NP3SYNXT
@RF00581 EQU   NP3SYTND
@RT00595 EQU   NP3SPAVL
@RT00631 EQU   NP3SYTXT
@RT00645 EQU   NP3SYNXT
@RT00647 EQU   NP3SYNXT
@RF00659 EQU   NP3NXOPI
@RT00665 EQU   NP3SYXIT
@RT00688 EQU   NP3SYXIT
@RT00693 EQU   NP3SYXIT
@RT00695 EQU   NP3SYINV
@RT00731 EQU   NP3IGNOP
@RF00719 EQU   NP3NXFLD
@RT00765 EQU   NP3IMSG
@RT00790 EQU   NP3PTINT
@RT00792 EQU   NP3PTINX
@RT00815 EQU   NP3PAFM
@RC00881 EQU   @RC00878
@RC00899 EQU   @RC00896
@RC00936 EQU   @RC00932
@RC00960 EQU   @RC00959
@RT00968 EQU   NP3SW38
@RT00975 EQU   NP3ENDFL
@RF00975 EQU   SCANRCD
@RT00980 EQU   NP3LCTFL
@RF00982 EQU   NP3LCNND
@RT00999 EQU   NP3LCNAM
@RT01001 EQU   NP3LCNAM
@RT01006 EQU   NP3LCNXT
@RT01008 EQU   NP3LCNXT
@RT01024 EQU   NP3LCTRN
@RT01033 EQU   NP3LCTXT
@RT01042 EQU   NP3LCEND
@RT01058 EQU   NP3LCLOC
@RT01061 EQU   NP3LCVXT
@RT01063 EQU   NP3LCVFL
@RT01070 EQU   NP3LCCAN
@RF01089 EQU   NP3IFLOC
@RT01096 EQU   NP3LCVL1
@RT01099 EQU   NP3LCMXT
@RT01101 EQU   NP3LCMNH
@RT01109 EQU   NP3LCMCK
@RT01134 EQU   NP3CHNDL
@RT01166 EQU   NP3EQUSB
@RT01185 EQU   NP3BALN
@RT01231 EQU   NP3SNDER
@RF01247 EQU   NP3ENDL
@RF01240 EQU   NP3RECNT
@RT01263 EQU   NP3RECNT
@RT01265 EQU   NP3PRINV
@RT01268 EQU   NP3OUT
@RF01286 EQU   NP3PRINV
@RF01283 EQU   NP3PRINV
@RT01296 EQU   NP3PCHCK
@RT01313 EQU   NP3POLST
@RT01315 EQU   NP3PONXT
@RT01322 EQU   NP3POXIT
@RT01327 EQU   NP3INVOP
@RF01337 EQU   NP3INVOP
@RT01409 EQU   NIPPMPRD
@RT01420 EQU   NIPPMPFN
@RT01422 EQU   NIPPMPER
@RT01431 EQU   NIPPMPRD
@RT01439 EQU   NIPPMPXT
@RF01470 EQU   NIPPMTER
@RF01477 EQU   NIPPMTER
@RT01497 EQU   NIPPMPRD
@RF01497 EQU   NIPPMTND
@RF01495 EQU   NIPPMPBK
@RT01513 EQU   NIPPMPXT
@RT01575 EQU   CONTCHK
@RF01575 EQU   NP3NULL
@RC01735 EQU   @RC01733
@RT01758 EQU   NP3SW38
@RT01765 EQU   NP3SPERS
@RT01773 EQU   NPCSYSP
@RT01776 EQU   NP3SPEST
@RC00900 EQU   @RC00899
@ENDDATA EQU   *
         END   IEAVNP03,(C'PLS2208',0701,76086)
/*
//SMPCNTL  DD *
  RECEIVE S(TSV0025) .
/*
//APP    EXEC SMP,
//           RVOL=MVSRES
//SYSLIB   DD  DSN=DSTONE.SYM101.F01,DISP=SHR
//         DD  DSN=SYS1.SMPMTS,DISP=SHR
//         DD  DSN=SYS1.MODGEN,DISP=SHR
//         DD  DSN=SYS1.AMACLIB,DISP=SHR
//         DD  DSN=SYS1.AMODGEN,DISP=SHR
//SMPCNTL  DD *
  APPLY S(TSV0025)
       ASSEM
       CHECK .
  APPLY S(TSV0025)
       ASSEM .
/*
