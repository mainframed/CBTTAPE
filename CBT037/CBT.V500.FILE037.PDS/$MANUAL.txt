 M

                    COPYCAT - OS CATALOG UTILITY PROGRAM
                                     BY
                             DOUGLAS E. ENGERT
                        APPLIED MATHEMATICS DIVISION
                        ARGONNE NATIONAL LABORATORY
                           9700 SOUTH CASS AVENUE
                          ARGONNE, ILLINOIS 60439


    THIS 12-77 VERSION CONTAINS SEVERAL MINOR FIXES FROM ARGONNE
    ("F00001" & "F00003") AND A MAJOR SPEED ENHANCEMENT TO THIS
    ALREADY FAST PROGRAM IN THAT THE CATALOG I/O IS NOW DONE AT
    EXCP LEVEL ("EXCP01").  A FIX FROM UCLA FOR A LITTLE MORE
    SPEED YET IS ALSO INCLUDED ("CCN").  THE HARDCODED BLKSIZES
    FOR SYSIN AND SYSPRINT HAVE BEEN CHANGED TO 3200 AND 605.
                              F. PAJERSKI   NASA/GSFC   01DEC77


                             TABLE OF CONTENTS

      ABSTRACT

      1.0 INTRODUCTION

      2.0 USER MANUAL

        2.1 FUNCTIONS

          2.1.1 REDISTRIBUTION
          2.1.2 RESTRUCTURING
          2.2.3 MASTER AND SECONDARY CATALOGS
          2.1.4 MASTER MODE
          2.1.5 SECONDARY MODE
          2.1.6 MODEL GENERATION DATA GROUP DSCBS
          2.1.7 ADDITIONAL CVOL PROCESSING
          2.1.8 ALIAS PROCESSING
          2.1.9 MULTIPLE INPUTS

        2.2 CONTROL CARDS

          2.2.1 CONTROL
          2.2.2 INPUT
          2.2.3 OUTPUT
          2.2.4 CVOL
          2.2.5 LEVEL

        2.3 JOB CONTROL STATEMENTS

        2.4 MESSAGES AND CODES

        2.5 EXAMPLES

          2.5.1 COPY A CATALOG FROM ONE VOLUME TO ANOTHER
          2.5.2 BACK UP A CATALOG
          2.5.3 REDISTRIBUTE A CATALOG

      3.0 PROGRAM LOGIC


                COPYCAT IS AN  OS  UTILITY  PROGRAM  DESIGNED  TO
           IMPROVE   PERFORMANCE  OF  OS  CATALOG  MANAGEMENT  BY
           PRODUCING A RESTRUCTURED COPY OF A CATALOG IN ORDER TO
           USE  THE  EXISTING  ACCESS  METHODS  MOST EFFECTIVELY.
           MULTIPLE INPUT AND OUTPUT CATALOGS ARE  PROCESSED  AND
           THE  REDISTRIBUTION  OF  THE  ENTRIES  IS  UNDER  USER
           CONTROL. MODEL DSCBS FOR GENERATION  DATA  GROUPS  AND
           ALIAS  ENTRIES  ARE  ALSO  PROCESSED.  CATALOGS ON ALL
           DIRECT  ACCESS  DEVICES,  INCLUDING  DATA  CELLS,  ARE
           SUPPORTED. BACKUP COPIES MAY ALSO BE MADE.


      1.0 INTRODUCTION

           COPYCAT IS AN OS UTILITY PROGRAM  DESIGNED  TO  PRODUCE  AN
      EFFICENT  SYSTEM  WIDE CATALOG WHICH MAY RESIDE ON MANY VOLUMES.
      SUBSTANTIAL IMPROVEMENT IN PERFORMANCE MAY ALSO BE OBTAINED ON A
      SYSTEM  WITH  ONLY  A  SINGLE CATALOG. THIS IS ACCOMPLISHED IN A
      NUMBER OF WAYS.  FIRST,  CATALOG  ENTRIES  FROM  MANY  DIFFERENT
      CATALOGS  MAY  BE  REDISTRIBUTED  TO  EQUALIZE  THE LOAD ON EACH
      INDIVIDUAL  CATALOG.  SECOND,   EACH   INDIVIDUAL   CATALOG   IS
      RESTRUCTURED IN A WAY DESIGNED TO MINIMIZE THE I/O TIME REQUIRED
      BOTH  FOR  SEARCHING  AND  UPDATING.  THE   REDISTRIBUTION   AND
      RESTRUCTURING  PARAMETERS  ARE UNDER THE CONTROL OF THE USER WHO
      SHOULD HAVE SOME KNOWLEDGE OF OS CATALOG MANAGEMENT.

           OUR INSTALLATION AT ARGONNE CONSISTS OF A 370/195, USED FOR
      BATCH  PROCESSING,  AND A 360/75 USED FOR TIME SHARING. THE TIME
      SHARING SYSTEM, TSO, SHARES ALL ITS ONLINE DEVICES WITH THE 195.
      SINCE  ALL  DATASETS  USED  BY  TSO  MUST BE CATALOGED, THEY ARE
      CATALOGED ON THE RESIDENT VOLUME FOR THE 75 TO ALLOW BATCH  JOBS
      TO  ACCESS TSO DATASETS. THIS HAS PLACED AN EXTREMELY HEAVY LOAD
      ON THIS SHARED CATALOG, WHICH OCCUPIES ABOUT 20 CYLINDERS  ON  A
      2314.  AFTER  SOME  STUDY OF THE SITUATION IT WAS FOUND THAT THE
      ORGANIZATION OF THE  SHARED  CATALOG  WAS  ONE  OF  OUR  BIGGEST
      BOTTLENECKS.  AFTER  RUNNING COPYCAT, SOFTWARE MONITORING SHOWED
      THE PERCENT OF UNIT BUSY TIME OF THE SYSTEM RESIDENT VOLUME  FOR
      THE  75  DROPPED  FROM  ABOUT  80%  TO ABOUT 20%, THE PERCENT OF
      ENQUEUE WAIT FOR THE CATALOG DROPPED FROM  ABOUT  10%  TO  ABOUT
      .1%,  AND  THE  NUMBER OF EXCPS REQUIRED TO LOGON TO TSO DROPPED
      FROM ABOUT 120 TO 70.

      2.0 USER MANUAL

      2.1 FUNCTIONS

           TWO DIFFERENT TYPES OF CATALOG SYSTEMS CAN BE PROCESSED  BY
      COPYCAT.  THE FIRST IS THE STANDARD OS CATALOG SYSTEM CONSISTING
      OF THE MASTER CATALOG ON THE SYSTEM RESIDENT VOLUME AND ZERO  OR
      MORE  CATALOGS  ON  OTHER  VOLUMES.  THE  SECOND TYPE OF CATALOG
      SYSTEM DOES NOT HAVE A MASTER CATALOG, BUT INSTEAD HAS  A  TABLE
      BUILT  INTO  THE  CATALOG MANAGEMENT ROUTINES USED TO SELECT THE
      FIRST CATALOG TO BE SEARCHED. THE CHANGES NEEDED FOR  THIS  TYPE
      OF CATALOG SYSTEM MUST BE LOCALLY WRITTEN.


      2.1.1 REDISTRIBUTION

           WHEN MORE THAN ONE CATALOG IS BEING CREATED, REDISTRIBUTION
      PARAMETERS  ARE  REQUIRED.  THESE PARAMETERS ARE SUPPLIED ON THE
      OUTPUT CARDS IN THE FORM OF A RANGE OF NAMES. THE UPPER BOUND IS
      DEFINED  ON  EACH  OUTPUT  CARD,  AND THE RANGE EXTENDS FROM THE
      UPPER BOUND OF THE PREVIOUS CARD TO THIS UPPER BOUND. AN  EBCDIC
      COLLATING SEQUENCE IS USED.

      2.1.2 RESTRUCTURING

           THE MAIN FUNCTION OF COPYCAT IS TO RESTRUCTURE A CATALOG SO
      AS  TO TAKE ADVANTAGE OF THE CATALOG MANAGEMENT I/O ROUTINES. TO
      DO THIS THREE PARAMETERS MAY BE SPECIFIED FOR EACH INDEX  LEVEL.
      THE  FIRST  IS  THE  NUMBER  OF BYTES TO LEAVE IN EACH BLOCK FOR
      EXPANSION.  BY  LEAVING  ENOUGH  ROOM,  THE  CATALOG  MANAGEMENT
      ROUTINES  WILL  BE ABLE TO ADD ENTRIES WITHOUT HAVING TO ADD NEW
      BLOCKS. EACH CVOL  POINTER  TAKES  TWENTY-TWO  (22)  BYTES,  AND
      SINGLE  VOLUME  DATASET  ENTRIES  TAKE  TWENTY-SIX  (26)  BYTES.
      SECOND, THE NUMBER OF DUMMY BLOCKS TO BE LEFT AFTER AN INDEX MAY
      BE SPECIFIED SO THE INDEX CAN EXPAND AND NEW LOWER LEVEL INDEXES
      CAN BE ADDED IN CLOSE PROXIMITY. THIRD,  THE  NUMBER  OF  BLOCKS
      THAT  MUST  BE  ON A TRACK BEFORE STARTING THE NEXT INDEX MAY BE
      GIVEN. SINCE INDEXES MAY REQUIRE MORE THEN  ONE  BLOCK,  AND  AN
      INDEX  CAN  BE  SEARCHED  IN  ONE  I/O OPERATION IF IT IS ON ONE
      TRACK, THIS NUMBER SHOULD BE SET LARGE ENOUGH SO MOST INDEXES AT
      A PARTICULAR LEVEL CAN FIT ON ONE TRACK.

      2.1.3 MASTER AND SECONDARY CATALOGS

           WHEN MORE THEN ONE  OUTPUT  CATALOG  IS  PRODUCED,  ONE  IS
      USUALLY  DEFINED  AS  THE  MASTER  CATALOG,  AND  THE  OTHERS AS
      SECONDARY CATALOGS. IN THE CASE OF ONLY ONE OUTPUT  CATALOG,  IT
      IS  ALWAYS A MASTER CATALOG. COPYCAT MUST BE RUN ONCE TO PRODUCE
      THE MASTER CATALOG IN MASTER MODE, AND IF  THERE  ARE  SECONDARY
      CATALOGS, ONCE IN SECONDARY MODE.

      2.1.4 MASTER MODE

           WHEN COPYCAT IS OPERATING IN MASTER MODE, ONLY  THE  MASTER
      CATALOG  IS  PRODUCED  BASED  ON THE OUTPUT MASTER CARD(S). CVOL
      POINTERS FOR INDEXES COVERED BY THE OUTPUT SECONDARY  CARDS,  IF
      ANY, ARE ALSO ADDED TO THE MASTER CATALOG.

      2.1.5 SECONDARY MODE

           SECONDARY MODE IS USED TO PRODUCE THE  SECONDARY  CATALOGS.
      THE  CHOICE  OF  WHICH  INDEXES ARE PLACED ON WHICH CATALOGS ARE
      DEFINED ON THE OUTPUT CARDS.

      2.1.6 MODEL GENERATION DATA GROUP DSCBS

           MODEL DSCBS FOR GENERATION DATA GROUPS  ARE  ALSO  HANDLED.
      SINCE THE MODEL DSCB MUST RESIDE ON THE VOLUME THAT CONTAINS THE
      GENERATION INDEX, COPYCAT WILL MOVE OR  COPY  THESE  DSCBS.  THE
      CHOICE  OF  WHETHER TO MOVE OR COPY THE DSCBS SHOULD BE BASED ON
      THE APPLICATION. WHEN A SINGLE CATALOG IS BEING REBUILT  ON  THE
      SAME PHYSICAL VOLUME, NOTHING NEED BE DONE, SINCE THE DSCBS WILL
      STILL BE ON THE VOLUME. WHEN A CATALOG  IS  BEING  COPIED  TO  A
      REPLACEMENT  VOLUME, SUCH AS A NEW RELEASE OF A SYSTEM, THEN THE
      DSCBS SHOULD BE COPIED. WHEN THE WHOLE CATALOG SYSTEM  IS  BEING
      REORGINIZED, THEN THE DSCBS SHOULD BE MOVED.

      2.1.7 ADDITIONAL CVOL PROCESSING

           SINCE EVERY DIRECT ACCESS VOLUME CAN HAVE A CATALOG, OR ONE
      SYSTEM MAY HAVE ACCESS TO ANOTHER SYSTEMS CATALOG, IT MAY BECOME
      NECESSARY TO CHANGE MANY CVOL POINTERS  ON  ONE  SYSTEM  IF  THE
      OTHER SYSTEMS CATALOG IS REDISTRIBULED. THE CVOL CARDS HAVE BEEN
      PROVIDED TO ACCOMPLISH THIS.

      2.1.8 ALIAS PROCESSING

           SPECIAL HANDLING OF ALIAS  ENTRIES  HAS  BEEN  INCLUDED  IN
      COPYCAT.  IN  A  MULTIPLE  CATALOG SYSTEM, AN ALIAS NAME AND ITS
      TRUE NAME SOMETIMES RESIDE IN DIFFERENT CATALOGS. CVOL  POINTERS
      WITH  THE  ALIAS  NAME ARE PLACED IN THE MASTER CATALOG DURING A
      MASTER OPERATION AND IN A SECONDARY CATALOG DURING  A  SECONDARY
      OPERATION, POINTING AT THE TRUE NAMES VOLUME. THE ALIAS ENTRY IS
      THEN PLACED IN THE TRUE NAMES CATALOG.

      2.1.9 MULTIPLE INPUTS

           THIRTY-TWO (32) CATALOGS MAY BE DEFINED AS  INPUT.  COPYCAT
      HAS BEEN DESIGNED TO WORK ON A CATALOG SYSTEM WHERE A HIGH LEVEL
      INDEX NAME, OTHER THAN A CVOL POINTER, MAY ONLY  APPEAR  IN  ONE
      CATALOG.  WHEN  A  CONFLICT  IS  FOUND, THE ENTRY FROM THE FIRST
      DEFINED INPUT CATALOG IS USED. AN EXAMPLE OF THIS WOULD BE IN  A
      TWO  CPU  SYSTEM,  AND  BOTH SYSTEM RESIDENT VOLUME CATALOGS ARE
      DEFINED AS INPUT TO COPYCAT. IF BOTH CATALOGS HAVE  ENTRIES  FOR
      SYS1, THEN ONLY THE ENTRIES FROM THE FIRST DEFINED CATALOG WOULD
      BE USED.

      2.2 CONTROL CARDS

           THE FORMAT FOR ALL CONTROL CARDS IS:

        ÝNAME¨ OPERATION OPERANDS COMMENTS

           THE NAME FIELD, IF PRESENT, MUST BEGIN IN COLUMN  ONE.  THE
      OPERATION  MUST  BE  SEPARATED  FROM THE NAME AND OPERANDS BY AT
      LEAST ONE BLANK, AND MAY START ANYWHERE AFTER  COLUMN  ONE.  THE
      OPERANDS MUST BE SEPARATED BY COMMAS WITH NO INTERVENING BLANKS.
      A NULL OPERAND MUST BE DELIMITED BY COMMAS UNLESS IT IS THE LAST
      OPERAND.  THE  COMMENTS  ARE  SEPARATED  FROM THE OPERANDS BY AT
      LEAST ONE BLANK, AND ANY CARD WITH AN ASTERISK '*' IN COLUMN ONE
      IS TREATED AS A COMMENT CARD.

      2.2.1 CONTROL

           THE  CONTROL  CARD  SPECIFIES  THE  MAIN  FUNCTIONS  TO  BE
      PERFORMED, AND MUST BE THE FIRST NON-COMMENT CARD.

        ÝNAME¨ CONTROL »MASTER|SECONDARYº,»GDGMOVE|GDGCOPYº,
                »KEEP|SPLIT|UNCATLGº

           MASTER|SECONDARY - COPYCAT IS TO BE EXECUTED IN THE  MASTER
                     MODE  TO  PRODUCE  THE  MASTER CATALOG, OR IN THE
                     SECONDARY MODE TO PRODUCE THE SECONDARY CATALOGS.

           GDGMOVE|GDGCOPY - GENERATION DATA GROUP MODEL DSCBS ARE  TO
                     BE  MOVED OR COPIED. IF THIS OPERAND IS NULL THEN
                     THEY ARE NOT PROCESSED.

           KEEP|SPLIT|UNCATLG - THE FUNCTION TO BE PERFORMED ON SINGLE
                     NAME  DATASETS.  THEY  MAY  BE KEPT IN THE MASTER
                     CATALOG (KEEP),  THEY  MAY  BE  REDISTRIBUTED  TO
                     SECONDARY   CATALOGS  (SPLIT),  OR  THEY  MAY  BE
                     UNCATALOGED (UNCATLG).

           WHEN  COPYCAT  IS  RUN  TWICE  FOR  A  MASTER  CATALOG  AND
      SECONDARY  CATALOGS,  THESE LAST TWO OPERANDS SHOULD BE THE SAME
      FOR BOTH RUNS. IF LOCAL MODIFICATIONS TO THE CATALOG  MANAGEMENT
      ROUTINES  HAVE  BEEN  ADDED SO A MASTER CATALOG IS NOT REQUIRED,
      COPYCAT NEED ONLY BE RUN ONCE IN SECONDARY MODE, AND  THE  THIRD
      CONTROL CARD PARAMETER MUST BE SPLIT.

      2.2.2 INPUT

           THE INPUT CARD DEFINES AN INPUT CATALOG  TO  BE  PROCESSED.
      THERE  MUST BE AT LEAST ONE AND AS MANY AS THIRTY-TWO (32) INPUT
      CARDS. THE INPUT DATASETS  DEFINED  BY  THESE  CARDS  ARE  NEVER
      CHANGED  BY THE PROGRAM. THEY MUST NOT BE THE SAME DATASETS USED
      FOR OUTPUT. THE INPUT CARD(S) MUST FOLLOW THE CONTROL CARD.

        ÝNAME¨ INPUT DDNAME,VOLID

           DDNAME - THE NAME OF A DD STATEMENT THAT DEFINES THIS INPUT
                     DATASET.

           VOLID - THE VOLUME NAME ON WHICH THIS CATALOG RESIDES  WHEN
                     USED  BY  THE SYSTEM. THIS VOLUME NEED NOT BE THE
                     SAME AS THAT DEFINED BY DDNAME.

      2.2.3 OUTPUT

           THE  OUTPUT  CARDS  DEFINE  THE  OUTPUT  DATASETS  AND  THE
      REDISTRIBUTION TABLE. THESE CARDS MUST FOLLOW THE INPUT CARDS.

        ÝNAME¨ OUTPUT »MASTER|SECONDARYº,DDNAME,VOLIDÝ,MAXNAME¨

           MASTER - THIS CARD DEFINES THE MASTER CATALOG, OR THE  ONLY
                     CATALOG IF ONLY ONE IS BEING PRODUCED.

           SECONDARY - THIS CARD DEFINES A SECONDARY CATALOG.

           DDNAME - THE NAME OF A DD STATEMENT THAT DEFINES THE OUTPUT
                     DATASET.

           VOLID - THE VOLUME NAME ON WHICH THIS CATALOG WILL BE  USED
                     BY  THE SYSTEM. THE CATALOG MAY BE PLACED ON SOME
                     OTHER   VOLUME   TEMPORARILY   FOR   BACKUP    OR
                     CONVENIENCE.

           MAXNAME - THE HIGHEST NAME IN EBCDIC COLLATING SEQUENCE  TO
                     WHICH THIS OUTPUT CARD APPLIES. THIS MAXNAME MUST
                     BE GREATER  THEN  THE  MAXNAME  ON  THE  PREVIOUS
                     OUTPUT  CARD, AND ON THE LAST OUTPUT CARD IT MUST
                     BE NULL.

           EACH OUTPUT CARD DEFINES A RANGE OF INDEX NAMES THAT ARE TO
      BE  PLACED  IN ITS CATALOG. THIS RANGE EXTENDS FROM THE PREVIOUS
      MAXNAME UP TO AND INCLUDING THE CURRENT MAXNAME. THE SAME DDNAME
      AND  VOLID  PAIR  MAY  APPEAR ON MORE THEN ONE CARD. THIS ALLOWS
      MORE THEN ONE RANGE OF INDEX NAMES TO BE PLACED ON ONE  CATALOG.
      ALL MASTER CARDS MUST HAVE THE SAME DDNAME AND VOLID SINCE THERE
      CAN ONLY BE ONE MASTER CATALOG. THE LAST OUTPUT CARD MUST HAVE A
      NULL MAXNAME.

      2.2.4 CVOL

           THE CVOL CARD MAY BE USED TO ALTER CONTROL  VOLUME  POINTER
      ENTRIES THAT POINT TO CATALOGS OUTSIDE THE CURRENT SYSTEM.

        ÝNAME¨ CVOL ÝVOLID¨,NEWVOL,ÝMAXNAME¨,DDNAME

           VOLID - THE VOLUME NAME THAT IS BEING CHANGED.

           NEWVOL - THE NEW VOLUME NAME FOR THE CVOL ENTRY.

           MAXNAME - THE HIGHEST NAME IN  THE  RANGE  OF  INDEX  NAMES
                     COVERED  BY THIS CVOL CARD. ALL THE CVOL POINTERS
                     THAT POINT AT THIS VOLUME, WHOSE NAME IS  GREATER
                     THAN  THE PREVIOUS MAXNAME AND LESS THEN OR EQUAL
                     TO THIS MAXNAME, WILL  BE  CHANGED  TO  POINT  AT
                     NEWVOL.  THE  LAST CVOL CARD IN A SET MUST HAVE A
                     NULL VALUE FOR MAXNAME, WHICH IS THE  HIGHEST  IN
                     THE COLLATING SEQUENCE.

           DDNAME - THE NAME OF A DD STATEMENT USED  FOR  DEVICE  TYPE
                     INFORMATION. THIS DD STATEMENT MUST DEFINE A UNIT
                     OF THE SAME TYPE AS NEWVOL.

           MANY SETS OF CVOL CARDS MAY BE DEFINED. EACH SET MUST  HAVE
      VOLID  SPECIFIED  ON THE FIRST CARD, AND MAXNAME MUST BE NULL ON
      THE LAST. CVOL CARDS MUST FOLLOW THE OUTPUT CARDS.

      2.2.5 LEVEL

           THE  LEVEL  CARD  IS  USED  TO  SPECIFY  THE  RESTRUCTURING
      INFORMATION.  THE GREATEST PERFORMANCE IMPROVEMENTS DERIVED FROM
      RUNNING COPYCAT DEPEND ON PROPERLY CHOOSING THESE PARAMETERS. UP
      TO TWENTY-TWO LEVEL CARDS MAY BE DEFINED.

        ÝNAME¨ LEVEL LEVEL,BYTES,DUMMIES,BLOCKS

           LEVEL - THE INDEX LEVEL BETWEEN ONE AND TWENTY-TWO TO WHICH
                     THIS CARD APPLIES.

           BTYES - THE NUMBER OF BYTES TO  LEAVE  IN  EACH  BLOCK  FOR
                     FUTURE EXPANSION, BETWEEN 0 AND 200.

           DUMMIES - THE NUMBER OF DUMMY BLOCKS TO  LEAVE  AFTER  THIS
                     INDEX FOR FUTURE EXPANSION.

           BLOCKS - THE NUMBER OF BLOCKS THAT MUST BE ON  THE  CURRENT
                     OUTPUT TRACK BEFORE STARTING THIS INDEX.

           THE LEVEL CARDS MUST FOLLOW  THE  CVOL  CARDS,  IF  ANY.  A
      DEFAULT VALUE OF ZERO IS APPLIED FOR ANY NULL OR MISSING VALUES.

      2.3 JOB CONTROL STATEMENTS

           A JOB CARD AND AN EXEC CARD ARE  REQUIRED.  A  SYSPRINT  DD
      STATEMENT  IS REQUIRED FOR A LISTING OF THE INPUT, INFORMATIONAL
      MESSAGES AND ERROR MESSAGES. THE DCB  PARAMETERS  ARE  FIXED  AT
      RECFM=FBA,LRECL=605,BLKSIZE=121. THE CONTROL CARDS ARE READ FROM
      THE   SYSIN   FILE   WHICH   HAS   FIXED   DCB   PARAMETERS   OF
      RECFM=FB,LRECL=80,BLKSIZE=3200.  ADDITIONAL  DD  STATEMENTS  ARE
      REQUIRED AS SPECIFIED BY THE INPUT, OUTPUT AND CVOL  CARDS.  THE
      DATASETS  DEFINED  BY  THESE  DD  STATEMENTS  NEED  NOT BE NAMED
      SYSCTLG, BUT THEY MUST BE  ON  A  DIRECT  ACCESS  VOLUME.  IF  A
      CATALOG  IS  CREATED  ON A VOLUME OTHER THEN THE ONE ON WHICH IT
      WILL BE USED BY THE SYSTEM, THE TEMPORARY VOLUME  SHOULD  BE  OF
      THE SAME DEVICE TYPE AS THE FINAL VOLUME.


      2.4 MESSAGES AND CODES

           AFTER A SUCCESSFUL RUN OF COPYCAT CERTAIN STATISTICS  ABOUT
      EACH  OUTPUT  DATASET  ARE  LISTED. THE LAST TTR PLUS ONE IN THE
      DATASET AND THE TTR OF THE LAST USED BLOCK PLUS ONE  ARE  LISTED
      IN  HEXADECIMAL.  THE  NUMBER OF CONTROL VOLUME POINTER ENTRIES,
      DUMMY BLOCKS,  BLOCKS  AT  LEVELS  ONE  AND  TWO,  AND  DATASETS
      CATALOGED ARE LISTED IN DECIMAL.

           THE FOLLOWING IS A LIST OF ERROR  MESSAGES  AND  COMPLETION
      CODES. THE MAXIMUM COMPLETION CODE FOUND DURING EXECUTION OF THE
      PROGRAM IS RETURNED TO OS.

      ERR01 ERROR FOUND IN PARAMETER AT '$'

           AN ERROR WAS FOUND IN A PARAMETER OR A  REQUIRED  PARAMETER
           WAS MISSING. THE PREVIOUS LINE WILL CONTAIN A '$' UNDER THE
           ERROR.
           (COMPLETION CODE = 8)

      ERR02 ERROR PROCESSING DDNAME='DDNAME'

           A PROBLEM WAS FOUND WITH A DD STATEMENT. EITHER IT WAS  NOT
           FOUND,  COULD  NOT BE OPENED, OR WAS NOT ON A DIRECT ACCESS
           VOLUME.
           (COMPLETION CODE = 8)

      ERR03 UNEXPECTED END OF FILE ON SYSIN

           MORE CONTROL CARDS WERE EXPECTED, BUT WERE NOT FOUND.
           (COMPLETION CODE = 8)

      ERR04 NAME=TRUENAME NOT FOUND FOR ALIAS=ALIASNAME

           WHILE PROCESSING AN ALIAS ENTRY,  THE  TRUE  NAME  FOR  THE
           ALIAS COULD NOT BE FOUND.
           (COMPLETION CODE = 12)

      ERR05 ALIAS COUNT ERROR FOUND FOR NAME=TRUENAME

           THE ALIAS COUNT FIELD IN THE NAMED INDEX IS  NOT  EQUAL  TO
           THE NUMBER OF ALIASES FOUND FOR THE NAME.
           (COMPLETION CODE = 12)

      ERR06 TOO MANY INPUT DATASETS

           MORE THEN 32 INPUT CARDS WERE FOUND.
           (COMPLETION CODE = 8)

      ERR07 INDEX=INDEX FOUND ON VOLS=(X,Y) THE ENTRY  ON  X  WILL  BE
      USED

           THE SAME HIGH  LEVEL  INDEX  WAS  FOUND  ON  TWO  DIFFERENT
           CATALOGS. THE ONE ON THE X VOLUME WILL BE USED.
           (COMPLETION CODE = 4)

      ERR08 NO INPUT CARDS FOUND

           NO INPUT CARDS WERE FOUND,  OR  THEY  DID  NOT  FOLLOW  THE
           CONTROL CARD.
           (COMPLETION CODE = 8)

      ERR09 FUNCTION FAILED  WITH  (CODE)  ON  VOLUME  FOR  GDG  MODEL
      DSCB=NAME

           WHILE MOVING OR COPYING MODEL DSCBS, AN OBTAIN, ALLOCATE OR
           SCRATCH  OPERATION  FAILED  WITH  THE RETURN CODE OF 'CODE'
           (DECIMAL).
           (COMPLETION CODE = 4)

      ERR10 MODEL DSCB FOR GDG DOES NOT HAVE ZERO EXTENTS DSN=NAME

           THE NAMED MODEL DSCB IS NOT COPIED BECAUSE IT DOES NOT HAVE
           ZERO EXTENTS.
           (COMPLETION CODE = 4)

      ERR11 MODEL DSCB FOR GDG EXISTS ON OUTPUT VOLUME WITH  DIFFERENT
      ATTRIBUTES FOR DSN=NAME

           WHILE MOVING OR COPYING MODEL DSCBS A DSCB  WITH  THE  SAME
           NAME  WAS  FOUND  ON  THE OUTPUT VOLUME, BUT THE ATTRIBUTES
           DEFINED BY THE TWELVE  BYTES  IN  THE  DSCB  AT  OFFSET  82
           (DECIMAL)  ARE  NOT  THE  SAME.  THE  DSCB  IS NOT MOVED OR
           COPIED.
           (COMPLETION CODE = 4)

      ERR12 ABEND - NNN - OCCURED. SEE SYSMSG. CURRENT OR LAST NAME IS
      NAME

           A D37, B37 OR 213 ABEND OCCURED. THE LAST  INDEX  STRUCTURE
           BEING PROCESSED IS GIVEN.
           (COMPLETION CODE = 16)

      ERR13 I/O ERROR - SYNAD MESSAGE
      ERR13 I/O ERROR CURRENT OR LAST NAME IS NAME

           AN I/O ERROR OCCURED. THE STANDARD MESSAGE  PRODUCED  BY  A
           SYNAD  MACRO  IS GIVEN, ALONG WITH THE LAST INDEX STRUCTURE
           PROCESSED.
           (COMPLETION CODE = 16)

      ERR14 NO OUTPUT MASTER CARD WAS FOUND

           WHEN IN MASTER MODE, AT LEAST ONE OUTPUT MASTER  CARD  MUST
           BE DEFINED.
           (COMPLETION CODE = 8)

      THE COMPLETION CODES ARE AS FOLLOWS:

          0 - NO ERRORS.

          4 - ALL CATALOGS ARE USEABLE, BUT DUPLICATE INDEXES HAVE
              BEEN  LEFT  OUT  OR  MODEL  DSCBS HAVE NOT BEEN MOVED OR
              COPIED.

          8 - ERRORS IN PROCESSING CONTROL CARDS. THE OUTPUT DATASETS
              HAVE NOT BEEN CHANGED.

   12 - ALL CATALOGS ARE USEABLE, BUT PROBLEMS EXIST WITH ALIAS
              ENTRIES.

   16 - OUTPUT CATALOGS HAVE BEEN PARTLY BUILT, AND ARE NOT
              USEABLE.

      2.5 EXAMPLES

      2.5.1 COPY A CATALOG FROM ONE VOLUME TO ANOTHER

           THIS FIRST EXAMPLE  ILLUSTRATES  THE  MOST  COMMON  USE  OF
      COPYCAT.  A  CATALOG  ON  ONE  VOLUME IS TO BE COPIED TO ANOTHER
      VOLUME, SUCH AS WHEN A NEW SYSTEM IS BEING INSTALLED.  THIS  JOB
      WOULD  BE RUN UNDER THE OLD SYSTEM TO COPY THE CATALOG ON SYSRES
      TO THE NEW SYSTEM PACK, NEWRES, WHICH WILL  LATER  BE  RELABELED
      SYSRES.

      //EX1    JOB   XXX
      //       EXEC  PGM=COPYCAT,REGION=60K
      //SYSPRINT DD  SYSOUT=A
      //OLDRES DD    DSN=SYSCTLG,VOL=SER=SYSRES,
      //             DISP=OLD,UNIT=DISK
      //NEWRES DD    DSN=SYSCTLG,VOL=SER=NEWRES,
      //             DISP=OLD,UNIT=DISK
      //SYSIN  DD    *
      *              EXAMPLE ONE
               CONTROL MASTER,GDGCOPY,KEEP
               INPUT OLDRES,SYSRES
               OUTPUT MASTER,NEWRES,SYSRES
               LEVEL 1,26,100
               LEVEL 2,52,5,5

           IN THIS EXAMPLE MODEL DSCBS FOR GENERATION DATA GROUPS  ARE
      COPIED. 100 DUMMY BLOCKS ARE LEFT AFTER THE HIGHEST LEVEL INDEX,
      WITH 26 BYTES LEFT IN EACH BLOCK FOR FUTURE EXPANSION. 52  BYTES
      ARE  LEFT  IN  EACH  SECOND LEVEL INDEX BLOCK, 5 BLOCKS ARE LEFT
      AFTER EACH INDEX, AND A SECOND LEVEL INDEX WILL NOT  BE  STARTED
      ON A TRACK WITHIN 5 BLOCKS OF THE END.

      2.5.2 BACK UP A CATALOG

           THIS EXAMPLE DEMONSTRATES THE USE OF COPYCAT FOR BACKING UP
      A  CATALOG.  NOTE  THAT  THE  BACKUP DATASET DOES NOT NEED TO BE
      CALLED SYSCTLG, THUS MANY CATALOGS COULD BE  BACKED  UP  ON  THE
      SAME VOLUME.

      //EX2    JOB   XXX,REGION=60K
      //       EXEC  PGM=COPYCAT
      //SYSPRINT DD  SYSOUT=A
      //CATALOG DD   DSNAME=SYSCTLG,VOL=SER=PACK01,
      //             UNIT=DISK,DISP=OLD
      //BACKUP DD    DSNAME=CAT.PACK01,VOL=SER=BACKUP,
      //             UNIT=DISK,SPACE=(CYL,(3,2)),DISP=(NEW,KEEP)
      //SYSIN  DD    *
      *              EXAMPLE 2
               CONTROL MASTER,GDGCOPY,KEEP
               INPUT CATALOG,PACK01
               OUTPUT MASTER,BACKUP,PACK01
      /*

      2.5.3 REDISTRIBUTE A CATALOG

           IN THIS EXAMPLE A SINGLE CATALOG IS TO  BE  SPLIT  UP  INTO
      FOUR  SEPARATE  CATALOGS.  THE FIRST STEP PRODUCES THE SECONDARY
      CATALOGS, AND THE SECOND STEP PRODUCES THE MASTER  CATALOG.  THE
      LAST  STEP IS EXECUTED ONLY IF THE FIRST TWO STEPS RAN PROPERLY,
      AND IT RENAMES THE DATASET ON RES075.

      //EX3    JOB   XXX
      //STEP1  EXEC  PGM=COPYCAT,REGION=60K
      //SYSPRINT DD  SYSOUT=A
      //INPUT  DD    VOL=SER=RES075,UNIT=DISK,DISP=OLD,
      //             DSNAME=SYSCTLG
      //OLDRES DD    VOL=SER=RES075,UNIT=DISK,
      //             DSNAME=NEWCAT,DISP=(NEW,KEEP),
      //             SPACE=(CYL,(5,2))
      //P87    DD    UNIT=DISK,VOL=SER=PACK87,
      //             DSNAME=SYSCTLG,DISP=(NEW,KEEP),
      //             SPACE=(CYL,(5,2))
      //P88    DD    UNIT=DISK,VOL=SER=PACK88,
      //             DSNAME=SYSCTLG,DISP=(NEW,KEEP),
      //             SPACE=(CYL,(5,2))
      //P89    DD    UNIT=DISK,VOL=SER=PACK89,
      //             DSNAME=SYSCTLG,DISP=(NEW,KEEP),
      //             SPACE=(CYL,(5,2))
      //SYSIN  DD    *
      *              EXAMPLE 3
      *              PRODUCE THE SECONDARY CATALOGS
               CONTROL SECONDARY,GDGMOVE,KEEP
               INPUT INPUT,RES075
               OUTPUT SECONDARY,P87,PACK87,B9999999
               OUTPUT SECONDARY,P88,PACK88,H9999999
               OUTPUT MASTER,OLDRES,RES075,K9999999
               OUTPUT SECONDARY,P89,PACK89,R9999999
               OUTPUT MASTER,OLDRES,RES075,S9999999
               OUTPUT SECONDARY,P88,PACK88
               LEVEL 1,26,100
               LEVEL 2,54,5,5
               LEVEL 3,,2,2
      /*
      //STEP2  EXEC  PGM=COPYCAT,REGION=60K
      //SYSPRINT DD  SYSOUT=A
      //INPUT  DD    VOL=SER=RES075,UNIT=DISK,DISP=OLD,
                     DSNAME=SYSCTLG
      //OLDRES DD    VOL=SER=RES075,UNIT=DISK,
                     DSNAME=NEWCAT,DISP=OLD
      //P87    DD    UNIT=DISK,VOL=SER=PACK87,
                     DSNAME=SYSCTLG,DISP=OLD
      //P88    DD    UNIT=DISK,VOL=SER=PACK88,
                     DSNAME=SYSCTLG,DISP=OLD
      //P89    DD    UNIT=DISK,VOL=SER=PACK89,
                     DSNAME=SYSCTLG,DISP=OLD
      //SYSIN  DD    *
      *              EXAMPLE 3
      *              PRODUCE THE MASTER CATALOG
               CONTROL MASTER,GDGMOVE,KEEP
               INPUT INPUT,RES075
               OUTPUT SECONDARY,P87,PACK87,B9999999
               OUTPUT SECONDARY,P88,PACK88,H9999999
               OUTPUT MASTER,OLDRES,RES075,K9999999
               OUTPUT SECONDARY,P89,PACK89,R9999999
               OUTPUT MASTER,OLDRES,RES075,S9999999
               OUTPUT SECONDARY,P88,PACK88
               LEVEL 1,26,50
               LEVEL 2,54,10,10
      /*
      //STEP3  EXEC  PGM=IEHPROGM,COND=(5,LT)
      //SYSPRINT DD  SYSOUT=A
      //OLDRES DD    UNIT=DISK,VOL=SER=RES075,DISP=OLD
      //SYSIN  DD    *
               RENAME VOL=2314=RES075,DSNAME=SYSCTLG,
                     NEWNAME=OLDCATLG
               RENAME VOL=2314=RES075,DSNAME=NEWCAT,
                     NEWNAME=SYSCTLG
      /*

           ALL INDEXES UP TO C WILL BE ON PACK87, INDEXES FROM C TO  I
      AND FROM T UPWARDS WILL BE ON PACK88, AND FROM L TO S WILL BE ON
      PACK89. CVOL POINTERS FOR THESE INDEXES WILL BE PLACED ON RES075
      ALONG  WITH  ALL  THE  OTHER INDEXES. STEP 3 WILL BE EXECUTED IF
      THERE ARE NO SEVERE ERRORS.

      3.0 PROGRAM LOGIC

           COPYCAT IS WRITTEN ENTIRELY IN ASSEMBLER LANGUAGE. QSAM  IS
      USED FOR SYSPRINT AND SYSIN, WHILE BSAM IN THE LOAD MODE IS USED
      FOR THE OUTPUT DATASETS. BDAM IS  USED  FOR  THE  INPUT  AND  TO
      ACCESS PREVIOUSLY WRITTEN OUTPUT BLOCKS.

           THE HEART OF THE PROGRAM CONSISTS OF  A  RECURSIVE  ROUTINE
      CALLED  RR, WHICH IS CALLED FOR EACH LEVEL. THE TTR OF THE FIRST
      BLOCK OF THE LEVEL IS PASSED TO RR. AFTER AN  INDEX  IS  WRITTEN
      WITH  THE OLD TTRS, IT IS REREAD AND FOR EACH ENTRY WITH A LOWER
      LEVEL, RR IS RECURSIVELY CALLED. UPON RETURN,  THE  NEW  TTR  IS
      PLACED IN THE ENTRY AND THE BLOCK IS REWRITTEN.

           WHEN PROCESSING THE HIGHEST  LEVEL  INDEX,  THE  ADDITIONAL
      INFORMATION  OF  WHICH  INPUT  DATASET THIS ENTRY CAME FROM MUST
      ALSO BE SAVED. THIS IS DONE BY CHANGING THE COUNT FIELD  OF  THE
      INDEX.  ONLY THREE TYPES OF ENTRIES NEED THIS INFORMATION SAVED:
      THE INDEX POINTER ENTRY, THE VOLUME CONTROL BLOCK POINTER ENTRY,
      AND THE GENERATION INDEX POINTER ENTRY. BY MAKING THE LAST THREE
      BITS OF THE VOLUME CONTROL BLOCK POINTER ENTRY '110',  ONLY  THE
      ENTRIES  WITH  A LAST BIT OF '0' CONTAIN ADDITIONAL INFORMATION.
      TWO BITS ARE USED TO DISTINGUISH  BETWEEN  THE  THREE  TYPES  OF
      ENTRIES,  AND  THE  OTHER FIVE BITS IN THE LENGTH FIELD ARE THEN
      USED TO LOCATE THE PROPER INPUT DATASET.

           WHEN PROCESSING  MODEL  DSCBS,  THE  OBTAIN,  ALLOCATE  AND
      SCRATCH   SVCS   ARE   USED.   BEFORE   RUNNING  COPYCAT,  LOCAL
      RESTRICTIONS ON ALLOCATING AND  SCRATCHING  DATASETS  SHOULD  BE
      CONSIDERED.  THESE  SVCS  ARE  ONLY  USED  IN THE ROUTINE CALLED
      GDSPROC.

           TWO OTHER IMPORTANT ROUTINES ARE INR AND  PUTC.  INR  FINDS
      THE  NEXT NAME IN THE HIGHEST LEVEL INDEXES TO BE PROCESSED FROM
      AMONG ALL THE INPUTS. IT IS CALLED BY  RR  AND  IT  HANDLES  THE
      PROBLEM  OF DUPLICATE INDEX NAMES. PUTC IS ALSO CALLED BY RR AND
      IT TAKES AN INDEX AND ADDS IT TO THE NEXT BLOCK FOR OUTPUT. PUTC
      PROCESSES THE PARAMETERS OF THE LEVEL CARDS.


